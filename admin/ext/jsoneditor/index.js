(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.jsoneditor = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],2:[function(require,module,exports){
(function (process,global){(function (){
"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.compileJSONPointerProp=exports.compileJSONPointer=exports.ValidationSeverity=exports.TransformModal=exports.TimestampTag=exports.SvelteComponentTyped=exports.SortModal=exports.SelectionType=exports.SearchField=exports.ReadonlyValue=exports.Mode=exports.JSONEditor=exports.EnumValue=exports.EditableValue=exports.ColorPicker=exports.CaretType=exports.BooleanToggle=void 0;exports.createAfterSelection=createAfterSelection;exports.createAjvValidator=createAjvValidator;exports.createInsideSelection=createInsideSelection;exports.createKeySelection=createKeySelection;exports.createMultiSelection=createMultiSelection;exports.createValueSelection=createValueSelection;exports.deleteIn=void 0;exports.estimateSerializedSize=estimateSerializedSize;exports.existsIn=void 0;exports.findEnum=findEnum;exports.findSchema=findSchema;exports.getIn=void 0;exports.getJSONSchemaOptions=getJSONSchemaOptions;exports.insertAt=exports.immutableJSONPatch=void 0;exports.isAfterSelection=isAfterSelection;exports.isEditingSelection=isEditingSelection;exports.isEqualParser=isEqualParser;exports.isInsideSelection=isInsideSelection;exports.isKeySelection=isKeySelection;exports.isLargeContent=isLargeContent;exports.isMultiSelection=isMultiSelection;exports.isTextContent=isTextContent;exports.isValueSelection=isValueSelection;exports.parseFrom=exports.lodashQueryLanguage=exports.jmespathQueryLanguage=exports.javascriptQueryLanguage=void 0;exports.parseJSONPath=parseJSONPath;exports.parsePath=exports.parseJSONPointer=void 0;exports.renderJSONSchemaEnum=renderJSONSchemaEnum;exports.renderValue=renderValue;exports.setIn=exports.revertJSONPatch=void 0;exports.stringifyJSONPath=stringifyJSONPath;exports.updateIn=void 0;var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23,_templateObject24,_templateObject25,_templateObject26,_templateObject27,_templateObject28,_templateObject29,_templateObject30,_templateObject31,_templateObject32,_templateObject33,_templateObject34,_templateObject35,_templateObject36,_templateObject37,_templateObject38,_templateObject39,_templateObject40,_templateObject41,_templateObject42,_templateObject43,_templateObject44,_templateObject45,_templateObject46,_templateObject47,_templateObject48,_templateObject49,_templateObject50,_templateObject51,_templateObject52,_templateObject53,_templateObject54,_templateObject55,_templateObject56,_templateObject57,_templateObject58,_templateObject59,_templateObject60,_templateObject61,_templateObject62,_templateObject63,_templateObject64,_templateObject65,_templateObject66,_templateObject67,_templateObject68,_templateObject69,_templateObject70,_templateObject71,_templateObject72,_templateObject73,_templateObject74,_templateObject75,_templateObject76,_templateObject77,_templateObject78,_templateObject79,_templateObject80,_templateObject81,_templateObject82,_templateObject83,_templateObject84,_templateObject85,_templateObject86,_templateObject87,_templateObject88,_templateObject89,_templateObject90,_templateObject91,_templateObject92,_templateObject93,_templateObject94,_templateObject95,_templateObject96,_templateObject97,_templateObject98,_templateObject99,_templateObject100,_templateObject101,_templateObject102,_templateObject103,_templateObject104,_templateObject105,_templateObject106,_templateObject107,_templateObject108,_templateObject109,_templateObject110,_templateObject111,_templateObject112,_templateObject113,_templateObject114,_templateObject115,_templateObject116,_templateObject117,_templateObject118,_templateObject119,_templateObject120,_templateObject121,_templateObject122,_templateObject123,_templateObject124,_templateObject125,_templateObject126,_templateObject127,_templateObject128,_templateObject129,_templateObject130,_templateObject131,_templateObject132,_templateObject133,_templateObject134,_templateObject135,_templateObject136,_templateObject137,_templateObject138,_templateObject139,_templateObject140,_templateObject141,_templateObject142,_templateObject143,_templateObject144,_templateObject145,_templateObject146,_templateObject147,_templateObject148,_templateObject149,_templateObject150,_templateObject151,_templateObject152,_templateObject153,_templateObject154,_templateObject155,_templateObject156,_templateObject157,_templateObject158,_templateObject159,_templateObject160,_templateObject161,_templateObject162,_templateObject163,_templateObject164,_templateObject165,_templateObject166,_templateObject167,_templateObject168,_templateObject169,_templateObject170,_templateObject171,_templateObject172,_templateObject173,_templateObject174,_templateObject175,_templateObject176,_templateObject177,_templateObject178,_templateObject179,_templateObject180,_templateObject181,_templateObject182,_templateObject183,_templateObject184,_templateObject185,_templateObject186,_templateObject187,_templateObject188,_templateObject189,_templateObject190,_templateObject191,_templateObject192,_templateObject193,_templateObject194,_templateObject195,_templateObject196,_templateObject197,_templateObject198,_templateObject199,_templateObject200,_templateObject201,_templateObject202,_templateObject203,_templateObject204,_templateObject205,_templateObject206,_templateObject207,_templateObject208,_templateObject209,_templateObject210,_templateObject211,_templateObject212,_templateObject213,_templateObject214,_templateObject215,_templateObject216,_templateObject217,_templateObject218,_templateObject219,_templateObject220,_templateObject221,_templateObject222,_templateObject223,_templateObject224,_templateObject225,_templateObject226,_templateObject227,_templateObject228,_templateObject229,_templateObject230,_templateObject231,_templateObject232,_templateObject233,_templateObject234,_templateObject235,_templateObject236,_templateObject237,_templateObject238,_templateObject239,_templateObject240,_templateObject241,_templateObject242,_templateObject243,_templateObject244,_templateObject245,_templateObject246,_templateObject247,_templateObject248,_templateObject249,_templateObject250,_templateObject251,_templateObject252,_templateObject253,_templateObject254,_templateObject255,_templateObject256,_templateObject257,_templateObject258,_templateObject259,_templateObject260,_templateObject261,_templateObject262,_templateObject263,_templateObject264,_templateObject265,_templateObject266,_templateObject267,_templateObject268,_templateObject269,_templateObject270,_templateObject271,_templateObject272,_templateObject273,_templateObject274,_templateObject275,_templateObject276,_templateObject277,_templateObject278,_templateObject279,_templateObject280,_templateObject281,_templateObject282;function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map():undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function");}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper);}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor);}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class);};return _wrapNativeSuper(Class);}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct.bind();}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor();if(Class)_setPrototypeOf(instance,Class.prototype);return instance;};}return _construct.apply(null,arguments);}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1;}function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},"");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg);}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg);}};}(innerFn,self,context),generator;}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)};}catch(err){return{type:"throw",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof2(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject);},function(err){invoke("throw",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke("throw",error,resolve,reject);});}reject(record.arg);}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();};}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(undefined===method){if(context.delegate=null,"throw"===context.method){if(delegate.iterator["return"]&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method))return ContinueSentinel;context.method="throw",context.arg=new TypeError("The iterator does not provide a 'throw' method");}return ContinueSentinel;}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;){if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;}return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,"toString",function(){return"[object Generator]";}),exports.keys=function(object){var keys=[];for(var key in object){keys.push(key);}return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this){"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);}},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},"catch":function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error("illegal catch attempt");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray2(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e29){throw _e29;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e30){didErr=true;err=_e30;},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]();}finally{if(didErr)throw err;}}};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray2(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty2(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _defineProperty2(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _get(){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get.bind();}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(arguments.length<3?target:receiver);}return desc.value;};}return _get.apply(this,arguments);}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof2(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _toConsumableArray2(arr){return _arrayWithoutHoles2(arr)||_iterableToArray2(arr)||_unsupportedIterableToArray2(arr)||_nonIterableSpread2();}function _nonIterableSpread2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray2(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray2(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray2(o,minLen);}function _iterableToArray2(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles2(arr){if(Array.isArray(arr))return _arrayLikeToArray2(arr);}function _arrayLikeToArray2(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _typeof2(obj){"@babel/helpers - typeof";return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof2(obj);}function noop$2(){}var identity$1=function identity$1(x){return x;};function assign$1(tar,src){// @ts-ignore
for(var k in src){tar[k]=src[k];}return tar;}function run(fn){return fn();}function blank_object(){return Object.create(null);}function run_all(fns){fns.forEach(run);}function is_function(thing){return typeof thing==='function';}function safe_not_equal(a,b){return a!=a?b==b:a!==b||a&&_typeof2(a)==='object'||typeof a==='function';}function not_equal(a,b){return a!=a?b==b:a!==b;}function is_empty(obj){return Object.keys(obj).length===0;}function create_slot(definition,ctx,$$scope,fn){if(definition){var slot_ctx=get_slot_context(definition,ctx,$$scope,fn);return definition[0](slot_ctx);}}function get_slot_context(definition,ctx,$$scope,fn){return definition[1]&&fn?assign$1($$scope.ctx.slice(),definition[1](fn(ctx))):$$scope.ctx;}function get_slot_changes(definition,$$scope,dirty,fn){if(definition[2]&&fn){var lets=definition[2](fn(dirty));if($$scope.dirty===undefined){return lets;}if(_typeof2(lets)==='object'){var merged=[];var len=Math.max($$scope.dirty.length,lets.length);for(var _i2=0;_i2<len;_i2+=1){merged[_i2]=$$scope.dirty[_i2]|lets[_i2];}return merged;}return $$scope.dirty|lets;}return $$scope.dirty;}function update_slot_base(slot,slot_definition,ctx,$$scope,slot_changes,get_slot_context_fn){if(slot_changes){var slot_context=get_slot_context(slot_definition,ctx,$$scope,get_slot_context_fn);slot.p(slot_context,slot_changes);}}function get_all_dirty_from_scope($$scope){if($$scope.ctx.length>32){var dirty=[];var length=$$scope.ctx.length/32;for(var _i3=0;_i3<length;_i3++){dirty[_i3]=-1;}return dirty;}return-1;}function null_to_empty(value){return value==null?'':value;}function action_destroyer(action_result){return action_result&&is_function(action_result.destroy)?action_result.destroy:noop$2;}var is_client=typeof window!=='undefined';var now$1=is_client?function(){return window.performance.now();}:function(){return Date.now();};var raf=is_client?function(cb){return requestAnimationFrame(cb);}:noop$2;var tasks=new Set();function run_tasks(now){tasks.forEach(function(task){if(!task.c(now)){tasks["delete"](task);task.f();}});if(tasks.size!==0)raf(run_tasks);}/**
 * Creates a new task that runs on each raf frame
 * until it returns a falsy value or is aborted
 */function loop(callback){var task;if(tasks.size===0)raf(run_tasks);return{promise:new Promise(function(fulfill){tasks.add(task={c:callback,f:fulfill});}),abort:function abort(){tasks["delete"](task);}};}function append$1(target,node){target.appendChild(node);}function append_styles(target,style_sheet_id,styles){var append_styles_to=get_root_for_style(target);if(!append_styles_to.getElementById(style_sheet_id)){var _style=element('style');_style.id=style_sheet_id;_style.textContent=styles;append_stylesheet(append_styles_to,_style);}}function get_root_for_style(node){if(!node)return document;var root=node.getRootNode?node.getRootNode():node.ownerDocument;if(root&&root.host){return root;}return node.ownerDocument;}function append_empty_stylesheet(node){var style_element=element('style');append_stylesheet(get_root_for_style(node),style_element);return style_element.sheet;}function append_stylesheet(node,style){append$1(node.head||node,style);return style.sheet;}function insert$2(target,node,anchor){target.insertBefore(node,anchor||null);}function detach(node){node.parentNode.removeChild(node);}function destroy_each(iterations,detaching){for(var _i4=0;_i4<iterations.length;_i4+=1){if(iterations[_i4])iterations[_i4].d(detaching);}}function element(name){return document.createElement(name);}function svg_element(name){return document.createElementNS('http://www.w3.org/2000/svg',name);}function text(data){return document.createTextNode(data);}function space(){return text(' ');}function empty$1(){return text('');}function listen(node,event,handler,options){node.addEventListener(event,handler,options);return function(){return node.removeEventListener(event,handler,options);};}function prevent_default(fn){return function(event){event.preventDefault();// @ts-ignore
return fn.call(this,event);};}function stop_propagation(fn){return function(event){event.stopPropagation();// @ts-ignore
return fn.call(this,event);};}function attr(node,attribute,value){if(value==null)node.removeAttribute(attribute);else if(node.getAttribute(attribute)!==value)node.setAttribute(attribute,value);}function set_attributes(node,attributes){// @ts-ignore
var descriptors=Object.getOwnPropertyDescriptors(node.__proto__);for(var key in attributes){if(attributes[key]==null){node.removeAttribute(key);}else if(key==='style'){node.style.cssText=attributes[key];}else if(key==='__value'){node.value=node[key]=attributes[key];}else if(descriptors[key]&&descriptors[key].set){node[key]=attributes[key];}else{attr(node,key,attributes[key]);}}}function set_svg_attributes(node,attributes){for(var key in attributes){attr(node,key,attributes[key]);}}function set_custom_element_data(node,prop,value){if(prop in node){node[prop]=typeof node[prop]==='boolean'&&value===''?true:value;}else{attr(node,prop,value);}}function children(element){return Array.from(element.childNodes);}function set_data(text,data){data=''+data;if(text.wholeText!==data)text.data=data;}function set_input_value(input,value){input.value=value==null?'':value;}function set_style(node,key,value,important){if(value===null){node.style.removeProperty(key);}else{node.style.setProperty(key,value,important?'important':'');}}function select_option(select,value){for(var _i5=0;_i5<select.options.length;_i5+=1){var option=select.options[_i5];if(option.__value===value){option.selected=true;return;}}select.selectedIndex=-1;// no option should be selected
}function select_value(select){var selected_option=select.querySelector(':checked')||select.options[0];return selected_option&&selected_option.__value;}// unfortunately this can't be a constant as that wouldn't be tree-shakeable
// so we cache the result instead
var crossorigin;function is_crossorigin(){if(crossorigin===undefined){crossorigin=false;try{if(typeof window!=='undefined'&&window.parent){void window.parent.document;}}catch(error){crossorigin=true;}}return crossorigin;}function add_resize_listener(node,fn){var computed_style=getComputedStyle(node);if(computed_style.position==='static'){node.style.position='relative';}var iframe=element('iframe');iframe.setAttribute('style','display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; '+'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');iframe.setAttribute('aria-hidden','true');iframe.tabIndex=-1;var crossorigin=is_crossorigin();var unsubscribe;if(crossorigin){iframe.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>";unsubscribe=listen(window,'message',function(event){if(event.source===iframe.contentWindow)fn();});}else{iframe.src='about:blank';iframe.onload=function(){unsubscribe=listen(iframe.contentWindow,'resize',fn);};}append$1(node,iframe);return function(){if(crossorigin){unsubscribe();}else if(unsubscribe&&iframe.contentWindow){unsubscribe();}detach(iframe);};}function toggle_class(element,name,toggle){element.classList[toggle?'add':'remove'](name);}function custom_event(type,detail){var _ref5=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref5$bubbles=_ref5.bubbles,bubbles=_ref5$bubbles===void 0?false:_ref5$bubbles,_ref5$cancelable=_ref5.cancelable,cancelable=_ref5$cancelable===void 0?false:_ref5$cancelable;var e=document.createEvent('CustomEvent');e.initCustomEvent(type,bubbles,cancelable,detail);return e;}var HtmlTag=/*#__PURE__*/function(){function HtmlTag(){var is_svg=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;_classCallCheck(this,HtmlTag);this.is_svg=false;this.is_svg=is_svg;this.e=this.n=null;}_createClass(HtmlTag,[{key:"c",value:function c(html){this.h(html);}},{key:"m",value:function m(html,target){var anchor=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!this.e){if(this.is_svg)this.e=svg_element(target.nodeName);else this.e=element(target.nodeName);this.t=target;this.c(html);}this.i(anchor);}},{key:"h",value:function h(html){this.e.innerHTML=html;this.n=Array.from(this.e.childNodes);}},{key:"i",value:function i(anchor){for(var _i6=0;_i6<this.n.length;_i6+=1){insert$2(this.t,this.n[_i6],anchor);}}},{key:"p",value:function p(html){this.d();this.h(html);this.i(this.a);}},{key:"d",value:function d(){this.n.forEach(detach);}}]);return HtmlTag;}();function construct_svelte_component(component,props){return new component(props);}// we need to store the information for multiple documents because a Svelte application could also contain iframes
// https://github.com/sveltejs/svelte/issues/3624
var managed_styles=new Map();var active=0;// https://github.com/darkskyapp/string-hash/blob/master/index.js
function hash(str){var hash=5381;var i=str.length;while(i--){hash=(hash<<5)-hash^str.charCodeAt(i);}return hash>>>0;}function create_style_information(doc,node){var info={stylesheet:append_empty_stylesheet(node),rules:{}};managed_styles.set(doc,info);return info;}function create_rule(node,a,b,duration,delay,ease,fn){var uid=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0;var step=16.666/duration;var keyframes='{\n';for(var p=0;p<=1;p+=step){var _t2=a+(b-a)*ease(p);keyframes+=p*100+"%{".concat(fn(_t2,1-_t2),"}\n");}var rule=keyframes+"100% {".concat(fn(b,1-b),"}\n}");var name="__svelte_".concat(hash(rule),"_").concat(uid);var doc=get_root_for_style(node);var _ref6=managed_styles.get(doc)||create_style_information(doc,node),stylesheet=_ref6.stylesheet,rules=_ref6.rules;if(!rules[name]){rules[name]=true;stylesheet.insertRule("@keyframes ".concat(name," ").concat(rule),stylesheet.cssRules.length);}var animation=node.style.animation||'';node.style.animation="".concat(animation?"".concat(animation,", "):'').concat(name," ").concat(duration,"ms linear ").concat(delay,"ms 1 both");active+=1;return name;}function delete_rule(node,name){var previous=(node.style.animation||'').split(', ');var next=previous.filter(name?function(anim){return anim.indexOf(name)<0;}// remove specific animation
:function(anim){return anim.indexOf('__svelte')===-1;}// remove all Svelte animations
);var deleted=previous.length-next.length;if(deleted){node.style.animation=next.join(', ');active-=deleted;if(!active)clear_rules();}}function clear_rules(){raf(function(){if(active)return;managed_styles.forEach(function(info){var ownerNode=info.stylesheet.ownerNode;// there is no ownerNode if it runs on jsdom.
if(ownerNode)detach(ownerNode);});managed_styles.clear();});}var current_component;function set_current_component(component){current_component=component;}function get_current_component(){if(!current_component)throw new Error('Function called outside component initialization');return current_component;}/**
 * Schedules a callback to run immediately before the component is updated after any state change.
 *
 * The first time the callback runs will be before the initial `onMount`
 *
 * https://svelte.dev/docs#run-time-svelte-beforeupdate
 */function beforeUpdate(fn){get_current_component().$$.before_update.push(fn);}/**
 * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.
 * It must be called during the component's initialisation (but doesn't need to live *inside* the component;
 * it can be called from an external module).
 *
 * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).
 *
 * https://svelte.dev/docs#run-time-svelte-onmount
 */function onMount(fn){get_current_component().$$.on_mount.push(fn);}/**
 * Schedules a callback to run immediately before the component is unmounted.
 *
 * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the
 * only one that runs inside a server-side component.
 *
 * https://svelte.dev/docs#run-time-svelte-ondestroy
 */function onDestroy(fn){get_current_component().$$.on_destroy.push(fn);}/**
 * Creates an event dispatcher that can be used to dispatch [component events](/docs#template-syntax-component-directives-on-eventname).
 * Event dispatchers are functions that can take two arguments: `name` and `detail`.
 *
 * Component events created with `createEventDispatcher` create a
 * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).
 * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).
 * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)
 * property and can contain any type of data.
 *
 * https://svelte.dev/docs#run-time-svelte-createeventdispatcher
 */function createEventDispatcher(){var component=get_current_component();return function(type,detail){var _ref7=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref7$cancelable=_ref7.cancelable,cancelable=_ref7$cancelable===void 0?false:_ref7$cancelable;var callbacks=component.$$.callbacks[type];if(callbacks){// TODO are there situations where events could be dispatched
// in a server (non-DOM) environment?
var event=custom_event(type,detail,{cancelable:cancelable});callbacks.slice().forEach(function(fn){fn.call(component,event);});return!event.defaultPrevented;}return true;};}/**
 * Associates an arbitrary `context` object with the current component and the specified `key`
 * and returns that object. The context is then available to children of the component
 * (including slotted content) with `getContext`.
 *
 * Like lifecycle functions, this must be called during component initialisation.
 *
 * https://svelte.dev/docs#run-time-svelte-setcontext
 */function setContext(key,context){get_current_component().$$.context.set(key,context);return context;}/**
 * Retrieves the context that belongs to the closest parent component with the specified `key`.
 * Must be called during component initialisation.
 *
 * https://svelte.dev/docs#run-time-svelte-getcontext
 */function getContext(key){return get_current_component().$$.context.get(key);}var dirty_components=[];var binding_callbacks=[];var render_callbacks=[];var flush_callbacks=[];var resolved_promise=Promise.resolve();var update_scheduled=false;function schedule_update(){if(!update_scheduled){update_scheduled=true;resolved_promise.then(flush);}}function tick(){schedule_update();return resolved_promise;}function add_render_callback(fn){render_callbacks.push(fn);}function add_flush_callback(fn){flush_callbacks.push(fn);}// flush() calls callbacks in this order:
// 1. All beforeUpdate callbacks, in order: parents before children
// 2. All bind:this callbacks, in reverse order: children before parents.
// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT
//    for afterUpdates called during the initial onMount, which are called in
//    reverse order: children before parents.
// Since callbacks might update component values, which could trigger another
// call to flush(), the following steps guard against this:
// 1. During beforeUpdate, any updated components will be added to the
//    dirty_components array and will cause a reentrant call to flush(). Because
//    the flush index is kept outside the function, the reentrant call will pick
//    up where the earlier call left off and go through all dirty components. The
//    current_component value is saved and restored so that the reentrant call will
//    not interfere with the "parent" flush() call.
// 2. bind:this callbacks cannot trigger new flush() calls.
// 3. During afterUpdate, any updated components will NOT have their afterUpdate
//    callback called a second time; the seen_callbacks set, outside the flush()
//    function, guarantees this behavior.
var seen_callbacks=new Set();var flushidx=0;// Do *not* move this inside the flush() function
function flush(){var saved_component=current_component;do{// first, call beforeUpdate functions
// and update components
while(flushidx<dirty_components.length){var component=dirty_components[flushidx];flushidx++;set_current_component(component);update$1(component.$$);}set_current_component(null);dirty_components.length=0;flushidx=0;while(binding_callbacks.length){binding_callbacks.pop()();}// then, once components are updated, call
// afterUpdate functions. This may cause
// subsequent updates...
for(var _i7=0;_i7<render_callbacks.length;_i7+=1){var callback=render_callbacks[_i7];if(!seen_callbacks.has(callback)){// ...so guard against infinite loops
seen_callbacks.add(callback);callback();}}render_callbacks.length=0;}while(dirty_components.length);while(flush_callbacks.length){flush_callbacks.pop()();}update_scheduled=false;seen_callbacks.clear();set_current_component(saved_component);}function update$1($$){if($$.fragment!==null){$$.update();run_all($$.before_update);var dirty=$$.dirty;$$.dirty=[-1];$$.fragment&&$$.fragment.p($$.ctx,dirty);$$.after_update.forEach(add_render_callback);}}var promise;function wait(){if(!promise){promise=Promise.resolve();promise.then(function(){promise=null;});}return promise;}function dispatch(node,direction,kind){node.dispatchEvent(custom_event("".concat(direction?'intro':'outro').concat(kind)));}var outroing=new Set();var outros;function group_outros(){outros={r:0,c:[],p:outros// parent group
};}function check_outros(){if(!outros.r){run_all(outros.c);}outros=outros.p;}function transition_in(block,local){if(block&&block.i){outroing["delete"](block);block.i(local);}}function transition_out(block,local,detach,callback){if(block&&block.o){if(outroing.has(block))return;outroing.add(block);outros.c.push(function(){outroing["delete"](block);if(callback){if(detach)block.d(1);callback();}});block.o(local);}else if(callback){callback();}}var null_transition={duration:0};function create_bidirectional_transition(node,fn,params,intro){var config=fn(node,params);var t=intro?0:1;var running_program=null;var pending_program=null;var animation_name=null;function clear_animation(){if(animation_name)delete_rule(node,animation_name);}function init(program,duration){var d=program.b-t;duration*=Math.abs(d);return{a:t,b:program.b,d:d,duration:duration,start:program.start,end:program.start+duration,group:program.group};}function go(b){var _ref8=config||null_transition,_ref8$delay=_ref8.delay,delay=_ref8$delay===void 0?0:_ref8$delay,_ref8$duration=_ref8.duration,duration=_ref8$duration===void 0?300:_ref8$duration,_ref8$easing=_ref8.easing,easing=_ref8$easing===void 0?identity$1:_ref8$easing,_ref8$tick=_ref8.tick,tick=_ref8$tick===void 0?noop$2:_ref8$tick,css=_ref8.css;var program={start:now$1()+delay,b:b};if(!b){// @ts-ignore todo: improve typings
program.group=outros;outros.r+=1;}if(running_program||pending_program){pending_program=program;}else{// if this is an intro, and there's a delay, we need to do
// an initial tick and/or apply CSS animation immediately
if(css){clear_animation();animation_name=create_rule(node,t,b,duration,delay,easing,css);}if(b)tick(0,1);running_program=init(program,duration);add_render_callback(function(){return dispatch(node,b,'start');});loop(function(now){if(pending_program&&now>pending_program.start){running_program=init(pending_program,duration);pending_program=null;dispatch(node,running_program.b,'start');if(css){clear_animation();animation_name=create_rule(node,t,running_program.b,running_program.duration,0,easing,config.css);}}if(running_program){if(now>=running_program.end){tick(t=running_program.b,1-t);dispatch(node,running_program.b,'end');if(!pending_program){// we're done
if(running_program.b){// intro  we can tidy up immediately
clear_animation();}else{// outro  needs to be coordinated
if(! --running_program.group.r)run_all(running_program.group.c);}}running_program=null;}else if(now>=running_program.start){var p=now-running_program.start;t=running_program.a+running_program.d*easing(p/running_program.duration);tick(t,1-t);}}return!!(running_program||pending_program);});}}return{run:function run(b){if(is_function(config)){wait().then(function(){// @ts-ignore
config=config();go(b);});}else{go(b);}},end:function end(){clear_animation();running_program=pending_program=null;}};}var globals=typeof window!=='undefined'?window:typeof globalThis!=='undefined'?globalThis:global;function destroy_block(block,lookup){block.d(1);lookup["delete"](block.key);}function outro_and_destroy_block(block,lookup){transition_out(block,1,1,function(){lookup["delete"](block.key);});}function update_keyed_each(old_blocks,dirty,get_key,dynamic,ctx,list,lookup,node,destroy,create_each_block,next,get_context){var o=old_blocks.length;var n=list.length;var i=o;var old_indexes={};while(i--){old_indexes[old_blocks[i].key]=i;}var new_blocks=[];var new_lookup=new Map();var deltas=new Map();i=n;while(i--){var child_ctx=get_context(ctx,list,i);var key=get_key(child_ctx);var block=lookup.get(key);if(!block){block=create_each_block(key,child_ctx);block.c();}else if(dynamic){block.p(child_ctx,dirty);}new_lookup.set(key,new_blocks[i]=block);if(key in old_indexes)deltas.set(key,Math.abs(i-old_indexes[key]));}var will_move=new Set();var did_move=new Set();function insert(block){transition_in(block,1);block.m(node,next);lookup.set(block.key,block);next=block.first;n--;}while(o&&n){var new_block=new_blocks[n-1];var old_block=old_blocks[o-1];var new_key=new_block.key;var old_key=old_block.key;if(new_block===old_block){// do nothing
next=new_block.first;o--;n--;}else if(!new_lookup.has(old_key)){// remove old block
destroy(old_block,lookup);o--;}else if(!lookup.has(new_key)||will_move.has(new_key)){insert(new_block);}else if(did_move.has(old_key)){o--;}else if(deltas.get(new_key)>deltas.get(old_key)){did_move.add(new_key);insert(new_block);}else{will_move.add(old_key);o--;}}while(o--){var _old_block=old_blocks[o];if(!new_lookup.has(_old_block.key))destroy(_old_block,lookup);}while(n){insert(new_blocks[n-1]);}return new_blocks;}function get_spread_update(levels,updates){var update={};var to_null_out={};var accounted_for={$$scope:1};var i=levels.length;while(i--){var o=levels[i];var n=updates[i];if(n){for(var key in o){if(!(key in n))to_null_out[key]=1;}for(var _key2 in n){if(!accounted_for[_key2]){update[_key2]=n[_key2];accounted_for[_key2]=1;}}levels[i]=n;}else{for(var _key3 in o){accounted_for[_key3]=1;}}}for(var _key4 in to_null_out){if(!(_key4 in update))update[_key4]=undefined;}return update;}function get_spread_object(spread_props){return _typeof2(spread_props)==='object'&&spread_props!==null?spread_props:{};}function bind$2(component,name,callback){var index=component.$$.props[name];if(index!==undefined){component.$$.bound[index]=callback;callback(component.$$.ctx[index]);}}function create_component(block){block&&block.c();}function mount_component(component,target,anchor,customElement){var _component$$$=component.$$,fragment=_component$$$.fragment,after_update=_component$$$.after_update;fragment&&fragment.m(target,anchor);if(!customElement){// onMount happens before the initial afterUpdate
add_render_callback(function(){var new_on_destroy=component.$$.on_mount.map(run).filter(is_function);// if the component was destroyed immediately
// it will update the `$$.on_destroy` reference to `null`.
// the destructured on_destroy may still reference to the old array
if(component.$$.on_destroy){var _component$$$$on_dest;(_component$$$$on_dest=component.$$.on_destroy).push.apply(_component$$$$on_dest,_toConsumableArray2(new_on_destroy));}else{// Edge case - component was destroyed immediately,
// most likely as a result of a binding initialising
run_all(new_on_destroy);}component.$$.on_mount=[];});}after_update.forEach(add_render_callback);}function destroy_component(component,detaching){var $$=component.$$;if($$.fragment!==null){run_all($$.on_destroy);$$.fragment&&$$.fragment.d(detaching);// TODO null out other refs, including component.$$ (but need to
// preserve final state?)
$$.on_destroy=$$.fragment=null;$$.ctx=[];}}function make_dirty(component,i){if(component.$$.dirty[0]===-1){dirty_components.push(component);schedule_update();component.$$.dirty.fill(0);}component.$$.dirty[i/31|0]|=1<<i%31;}function init(component,options,instance,create_fragment,not_equal,props,append_styles){var dirty=arguments.length>7&&arguments[7]!==undefined?arguments[7]:[-1];var parent_component=current_component;set_current_component(component);var $$=component.$$={fragment:null,ctx:[],// state
props:props,update:noop$2,not_equal:not_equal,bound:blank_object(),// lifecycle
on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(options.context||(parent_component?parent_component.$$.context:[])),// everything else
callbacks:blank_object(),dirty:dirty,skip_bound:false,root:options.target||parent_component.$$.root};append_styles&&append_styles($$.root);var ready=false;$$.ctx=instance?instance(component,options.props||{},function(i,ret){var value=(arguments.length<=2?0:arguments.length-2)?arguments.length<=2?undefined:arguments[2]:ret;if($$.ctx&&not_equal($$.ctx[i],$$.ctx[i]=value)){if(!$$.skip_bound&&$$.bound[i])$$.bound[i](value);if(ready)make_dirty(component,i);}return ret;}):[];$$.update();ready=true;run_all($$.before_update);// `false` as a special case of no DOM component
$$.fragment=create_fragment?create_fragment($$.ctx):false;if(options.target){if(options.hydrate){var nodes=children(options.target);// eslint-disable-next-line @typescript-eslint/no-non-null-assertion
$$.fragment&&$$.fragment.l(nodes);nodes.forEach(detach);}else{// eslint-disable-next-line @typescript-eslint/no-non-null-assertion
$$.fragment&&$$.fragment.c();}if(options.intro)transition_in(component.$$.fragment);mount_component(component,options.target,options.anchor,options.customElement);flush();}set_current_component(parent_component);}/**
 * Base class for Svelte components. Used when dev=false.
 */var SvelteComponent=/*#__PURE__*/function(){function SvelteComponent(){_classCallCheck(this,SvelteComponent);}_createClass(SvelteComponent,[{key:"$destroy",value:function $destroy(){destroy_component(this,1);this.$destroy=noop$2;}},{key:"$on",value:function $on(type,callback){if(!is_function(callback)){return noop$2;}var callbacks=this.$$.callbacks[type]||(this.$$.callbacks[type]=[]);callbacks.push(callback);return function(){var index=callbacks.indexOf(callback);if(index!==-1)callbacks.splice(index,1);};}},{key:"$set",value:function $set($$props){if(this.$$set&&!is_empty($$props)){this.$$.skip_bound=true;this.$$set($$props);this.$$.skip_bound=false;}}}]);return SvelteComponent;}();/**
 * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.
 */var SvelteComponentDev=/*#__PURE__*/function(_SvelteComponent){_inherits(SvelteComponentDev,_SvelteComponent);var _super=_createSuper(SvelteComponentDev);function SvelteComponentDev(options){_classCallCheck(this,SvelteComponentDev);if(!options||!options.target&&!options.$$inline){throw new Error("'target' is a required option");}return _super.call(this);}_createClass(SvelteComponentDev,[{key:"$destroy",value:function $destroy(){_get(_getPrototypeOf(SvelteComponentDev.prototype),"$destroy",this).call(this);this.$destroy=function(){console.warn('Component was already destroyed');// eslint-disable-line no-console
};}},{key:"$capture_state",value:function $capture_state(){}},{key:"$inject_state",value:function $inject_state(){}}]);return SvelteComponentDev;}(SvelteComponent);/**
 * Base class to create strongly typed Svelte components.
 * This only exists for typing purposes and should be used in `.d.ts` files.
 *
 * ### Example:
 *
 * You have component library on npm called `component-library`, from which
 * you export a component called `MyComponent`. For Svelte+TypeScript users,
 * you want to provide typings. Therefore you create a `index.d.ts`:
 * ```ts
 * import { SvelteComponentTyped } from "svelte";
 * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}
 * ```
 * Typing this makes it possible for IDEs like VS Code with the Svelte extension
 * to provide intellisense and to use the component like this in a Svelte file
 * with TypeScript:
 * ```svelte
 * <script lang="ts">
 * 	import { MyComponent } from "component-library";
 * </script>
 * <MyComponent foo={'bar'} />
 * ```
 *
 * #### Why not make this part of `SvelteComponent(Dev)`?
 * Because
 * ```ts
 * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}
 * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;
 * ```
 * will throw a type error, so we need to separate the more strictly typed class.
 */var SvelteComponentTyped=/*#__PURE__*/function(_SvelteComponentDev){_inherits(SvelteComponentTyped,_SvelteComponentDev);var _super2=_createSuper(SvelteComponentTyped);function SvelteComponentTyped(options){_classCallCheck(this,SvelteComponentTyped);return _super2.call(this,options);}return _createClass(SvelteComponentTyped);}(SvelteComponentDev);/**
 * Create a lightweight debug function to log output into the browser console.
 *
 * Inspired by https://github.com/visionmedia/debug (some code is copied below)
 *
 * Usage:
 *
 *     import { createDebug } from './debug.js'
 *
 *     const debug = createDebug('my:namespace')
 *
 *     debug('testing:', 2 + 2)
 *
 * By default, logging is only enabled when a property DEBUG is set in the
 * localStorage of your browser:
 *
 *     localStorage['debug'] = '*'
 *
 * The actual value of 'debug' is not used. You can choose other conditions to
 * enable/disable debugging if you want, for example some flag determining
 * whether in development or production.
 */exports.SvelteComponentTyped=SvelteComponentTyped;function createDebug(namespace){var enabled=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!!tryReadLocalStorage('debug');if(enabled){var color=selectColor(namespace);return function debug(){var _console;for(var _len=arguments.length,args=new Array(_len),_key5=0;_key5<_len;_key5++){args[_key5]=arguments[_key5];}(_console=console).log.apply(_console,["%c".concat(namespace),"color:".concat(color)].concat(args));};}else{return noop$1;}}function noop$1(){// no operation
}/**
 * Try read a specific key from localStorage
 */function tryReadLocalStorage(key){try{if(typeof window!=='undefined'&&typeof window.localStorage!=='undefined'){// reading local storage can fail for example because of security restrictions
return window.localStorage[key];}}catch(error){// we do nothing with the error, not needed in this specific case
}}/**
 * Selects a color for a debug namespace
 *
 * Code is copied from the following source: https://github.com/visionmedia/debug
 *
 * @param namespace The namespace string for the debug instance to be colored
 * @return An ANSI color code for the given namespace
 */function selectColor(namespace){var hash=0;for(var _i8=0;_i8<namespace.length;_i8++){hash=(hash<<5)-hash+namespace.charCodeAt(_i8);hash|=0;// Convert to 32bit integer
}return colors[Math.abs(hash)%colors.length];}var colors=['#0000CC','#0099FF','#009400','#8dd200','#CCCC00','#CC9933','#ae04e7','#ff35d7','#FF3333','#FF6600','#FF9933','#FFCC33'];function fade(node){var _ref9=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref9$delay=_ref9.delay,delay=_ref9$delay===void 0?0:_ref9$delay,_ref9$duration=_ref9.duration,duration=_ref9$duration===void 0?400:_ref9$duration,_ref9$easing=_ref9.easing,easing=_ref9$easing===void 0?identity$1:_ref9$easing;var o=+getComputedStyle(node).opacity;return{delay:delay,duration:duration,easing:easing,css:function css(t){return"opacity: ".concat(t*o);}};}/* node_modules/svelte-simple-modal/src/Modal.svelte generated by Svelte v3.51.0 */var window_1$2=globals.window;function add_css$K(target){append_styles(target,"svelte-g4wg3a",".svelte-g4wg3a{box-sizing:border-box}.bg.svelte-g4wg3a{position:fixed;z-index:1000;top:0;left:0;display:flex;flex-direction:column;justify-content:center;width:100vw;height:100vh;background:rgba(0, 0, 0, 0.66)}.wrap.svelte-g4wg3a{position:relative;margin:2rem;max-height:100%}.window.svelte-g4wg3a{position:relative;width:40rem;max-width:100%;max-height:100%;margin:2rem auto;color:black;border-radius:0.5rem;background:white}.content.svelte-g4wg3a{position:relative;padding:1rem;max-height:calc(100vh - 4rem);overflow:auto}.close.svelte-g4wg3a{display:block;box-sizing:border-box;position:absolute;z-index:1000;top:1rem;right:1rem;margin:0;padding:0;width:1.5rem;height:1.5rem;border:0;color:black;border-radius:1.5rem;background:white;box-shadow:0 0 0 1px black;transition:transform 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);-webkit-appearance:none}.close.svelte-g4wg3a:before,.close.svelte-g4wg3a:after{content:'';display:block;box-sizing:border-box;position:absolute;top:50%;width:1rem;height:1px;background:black;transform-origin:center;transition:height 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),\n      background 0.2s cubic-bezier(0.25, 0.1, 0.25, 1)}.close.svelte-g4wg3a:before{-webkit-transform:translate(0, -50%) rotate(45deg);-moz-transform:translate(0, -50%) rotate(45deg);transform:translate(0, -50%) rotate(45deg);left:0.25rem}.close.svelte-g4wg3a:after{-webkit-transform:translate(0, -50%) rotate(-45deg);-moz-transform:translate(0, -50%) rotate(-45deg);transform:translate(0, -50%) rotate(-45deg);left:0.25rem}.close.svelte-g4wg3a:hover{background:black}.close.svelte-g4wg3a:hover:before,.close.svelte-g4wg3a:hover:after{height:2px;background:white}.close.svelte-g4wg3a:focus{border-color:#3399ff;box-shadow:0 0 0 2px #3399ff}.close.svelte-g4wg3a:active{transform:scale(0.9)}.close.svelte-g4wg3a:hover,.close.svelte-g4wg3a:focus,.close.svelte-g4wg3a:active{outline:none}");}// (423:0) {#if Component}
function create_if_block$t(ctx){var div3;var div2;var div1;var t;var div0;var switch_instance;var div0_class_value;var div1_class_value;var div1_aria_label_value;var div1_aria_labelledby_value;var div1_transition;var div2_class_value;var div3_class_value;var div3_transition;var current;var mounted;var dispose;var if_block=/*state*/ctx[1].closeButton&&create_if_block_1$g(ctx);var switch_value=/*Component*/ctx[2];function switch_props(ctx){return{};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());}return{c:function c(){div3=element("div");div2=element("div");div1=element("div");if(if_block)if_block.c();t=space();div0=element("div");if(switch_instance)create_component(switch_instance.$$.fragment);attr(div0,"class",div0_class_value=""+(null_to_empty(/*state*/ctx[1].classContent)+" svelte-g4wg3a"));attr(div0,"style",/*cssContent*/ctx[9]);toggle_class(div0,"content",!/*unstyled*/ctx[0]);attr(div1,"class",div1_class_value=""+(null_to_empty(/*state*/ctx[1].classWindow)+" svelte-g4wg3a"));attr(div1,"role","dialog");attr(div1,"aria-modal","true");attr(div1,"aria-label",div1_aria_label_value=/*state*/ctx[1].ariaLabelledBy?null:/*state*/ctx[1].ariaLabel||null);attr(div1,"aria-labelledby",div1_aria_labelledby_value=/*state*/ctx[1].ariaLabelledBy||null);attr(div1,"style",/*cssWindow*/ctx[8]);toggle_class(div1,"window",!/*unstyled*/ctx[0]);attr(div2,"class",div2_class_value=""+(null_to_empty(/*state*/ctx[1].classWindowWrap)+" svelte-g4wg3a"));attr(div2,"style",/*cssWindowWrap*/ctx[7]);toggle_class(div2,"wrap",!/*unstyled*/ctx[0]);attr(div3,"class",div3_class_value=""+(null_to_empty(/*state*/ctx[1].classBg)+" svelte-g4wg3a"));attr(div3,"style",/*cssBg*/ctx[6]);toggle_class(div3,"bg",!/*unstyled*/ctx[0]);},m:function m(target,anchor){insert$2(target,div3,anchor);append$1(div3,div2);append$1(div2,div1);if(if_block)if_block.m(div1,null);append$1(div1,t);append$1(div1,div0);if(switch_instance)mount_component(switch_instance,div0,null);/*div1_binding*/ctx[49](div1);/*div2_binding*/ctx[50](div2);/*div3_binding*/ctx[51](div3);current=true;if(!mounted){dispose=[listen(div1,"introstart",function(){if(is_function(/*onOpen*/ctx[13]))/*onOpen*/ctx[13].apply(this,arguments);}),listen(div1,"outrostart",function(){if(is_function(/*onClose*/ctx[14]))/*onClose*/ctx[14].apply(this,arguments);}),listen(div1,"introend",function(){if(is_function(/*onOpened*/ctx[15]))/*onOpened*/ctx[15].apply(this,arguments);}),listen(div1,"outroend",function(){if(is_function(/*onClosed*/ctx[16]))/*onClosed*/ctx[16].apply(this,arguments);}),listen(div3,"mousedown",/*handleOuterMousedown*/ctx[20]),listen(div3,"mouseup",/*handleOuterMouseup*/ctx[21])];mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(/*state*/ctx[1].closeButton){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*state*/2){transition_in(if_block,1);}}else{if_block=create_if_block_1$g(ctx);if_block.c();transition_in(if_block,1);if_block.m(div1,t);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}if(switch_value!==(switch_value=/*Component*/ctx[2])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div0,null);}else{switch_instance=null;}}if(!current||dirty[0]&/*state*/2&&div0_class_value!==(div0_class_value=""+(null_to_empty(/*state*/ctx[1].classContent)+" svelte-g4wg3a"))){attr(div0,"class",div0_class_value);}if(!current||dirty[0]&/*cssContent*/512){attr(div0,"style",/*cssContent*/ctx[9]);}if(!current||dirty[0]&/*state, unstyled*/3){toggle_class(div0,"content",!/*unstyled*/ctx[0]);}if(!current||dirty[0]&/*state*/2&&div1_class_value!==(div1_class_value=""+(null_to_empty(/*state*/ctx[1].classWindow)+" svelte-g4wg3a"))){attr(div1,"class",div1_class_value);}if(!current||dirty[0]&/*state*/2&&div1_aria_label_value!==(div1_aria_label_value=/*state*/ctx[1].ariaLabelledBy?null:/*state*/ctx[1].ariaLabel||null)){attr(div1,"aria-label",div1_aria_label_value);}if(!current||dirty[0]&/*state*/2&&div1_aria_labelledby_value!==(div1_aria_labelledby_value=/*state*/ctx[1].ariaLabelledBy||null)){attr(div1,"aria-labelledby",div1_aria_labelledby_value);}if(!current||dirty[0]&/*cssWindow*/256){attr(div1,"style",/*cssWindow*/ctx[8]);}if(!current||dirty[0]&/*state, unstyled*/3){toggle_class(div1,"window",!/*unstyled*/ctx[0]);}if(!current||dirty[0]&/*state*/2&&div2_class_value!==(div2_class_value=""+(null_to_empty(/*state*/ctx[1].classWindowWrap)+" svelte-g4wg3a"))){attr(div2,"class",div2_class_value);}if(!current||dirty[0]&/*cssWindowWrap*/128){attr(div2,"style",/*cssWindowWrap*/ctx[7]);}if(!current||dirty[0]&/*state, unstyled*/3){toggle_class(div2,"wrap",!/*unstyled*/ctx[0]);}if(!current||dirty[0]&/*state*/2&&div3_class_value!==(div3_class_value=""+(null_to_empty(/*state*/ctx[1].classBg)+" svelte-g4wg3a"))){attr(div3,"class",div3_class_value);}if(!current||dirty[0]&/*cssBg*/64){attr(div3,"style",/*cssBg*/ctx[6]);}if(!current||dirty[0]&/*state, unstyled*/3){toggle_class(div3,"bg",!/*unstyled*/ctx[0]);}},i:function i(local){if(current)return;transition_in(if_block);if(switch_instance)transition_in(switch_instance.$$.fragment,local);add_render_callback(function(){if(!div1_transition)div1_transition=create_bidirectional_transition(div1,/*currentTransitionWindow*/ctx[12],/*state*/ctx[1].transitionWindowProps,true);div1_transition.run(1);});add_render_callback(function(){if(!div3_transition)div3_transition=create_bidirectional_transition(div3,/*currentTransitionBg*/ctx[11],/*state*/ctx[1].transitionBgProps,true);div3_transition.run(1);});current=true;},o:function o(local){transition_out(if_block);if(switch_instance)transition_out(switch_instance.$$.fragment,local);if(!div1_transition)div1_transition=create_bidirectional_transition(div1,/*currentTransitionWindow*/ctx[12],/*state*/ctx[1].transitionWindowProps,false);div1_transition.run(0);if(!div3_transition)div3_transition=create_bidirectional_transition(div3,/*currentTransitionBg*/ctx[11],/*state*/ctx[1].transitionBgProps,false);div3_transition.run(0);current=false;},d:function d(detaching){if(detaching)detach(div3);if(if_block)if_block.d();if(switch_instance)destroy_component(switch_instance);/*div1_binding*/ctx[49](null);if(detaching&&div1_transition)div1_transition.end();/*div2_binding*/ctx[50](null);/*div3_binding*/ctx[51](null);if(detaching&&div3_transition)div3_transition.end();mounted=false;run_all(dispose);}};}// (454:8) {#if state.closeButton}
function create_if_block_1$g(ctx){var show_if;var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block_2$c,create_else_block$g];var if_blocks=[];function select_block_type(ctx,dirty){if(dirty[0]&/*state*/2)show_if=null;if(show_if==null)show_if=!!/*isFunction*/ctx[17](/*state*/ctx[1].closeButton);if(show_if)return 0;return 1;}current_block_type_index=select_block_type(ctx,[-1,-1,-1]);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx,dirty);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (457:10) {:else}
function create_else_block$g(ctx){var button;var button_class_value;var mounted;var dispose;return{c:function c(){button=element("button");attr(button,"class",button_class_value=""+(null_to_empty(/*state*/ctx[1].classCloseButton)+" svelte-g4wg3a"));attr(button,"aria-label","Close modal");attr(button,"style",/*cssCloseButton*/ctx[10]);attr(button,"type","button");toggle_class(button,"close",!/*unstyled*/ctx[0]);},m:function m(target,anchor){insert$2(target,button,anchor);if(!mounted){dispose=listen(button,"click",/*close*/ctx[18]);mounted=true;}},p:function p(ctx,dirty){if(dirty[0]&/*state*/2&&button_class_value!==(button_class_value=""+(null_to_empty(/*state*/ctx[1].classCloseButton)+" svelte-g4wg3a"))){attr(button,"class",button_class_value);}if(dirty[0]&/*cssCloseButton*/1024){attr(button,"style",/*cssCloseButton*/ctx[10]);}if(dirty[0]&/*state, unstyled*/3){toggle_class(button,"close",!/*unstyled*/ctx[0]);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(button);mounted=false;dispose();}};}// (455:10) {#if isFunction(state.closeButton)}
function create_if_block_2$c(ctx){var switch_instance;var switch_instance_anchor;var current;var switch_value=/*state*/ctx[1].closeButton;function switch_props(ctx){return{props:{onClose:/*close*/ctx[18]}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){if(switch_value!==(switch_value=/*state*/ctx[1].closeButton)){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}function create_fragment$U(ctx){var t;var current;var mounted;var dispose;var if_block=/*Component*/ctx[2]&&create_if_block$t(ctx);var default_slot_template=/*#slots*/ctx[48]["default"];var default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[47],null);return{c:function c(){if(if_block)if_block.c();t=space();if(default_slot)default_slot.c();},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,t,anchor);if(default_slot){default_slot.m(target,anchor);}current=true;if(!mounted){dispose=listen(window_1$2,"keydown",/*handleKeydown*/ctx[19]);mounted=true;}},p:function p(ctx,dirty){if(/*Component*/ctx[2]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*Component*/4){transition_in(if_block,1);}}else{if_block=create_if_block$t(ctx);if_block.c();transition_in(if_block,1);if_block.m(t.parentNode,t);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}if(default_slot){if(default_slot.p&&(!current||dirty[1]&/*$$scope*/65536)){update_slot_base(default_slot,default_slot_template,ctx,/*$$scope*/ctx[47],!current?get_all_dirty_from_scope(/*$$scope*/ctx[47]):get_slot_changes(default_slot_template,/*$$scope*/ctx[47],dirty,null),null);}}},i:function i(local){if(current)return;transition_in(if_block);transition_in(default_slot,local);current=true;},o:function o(local){transition_out(if_block);transition_out(default_slot,local);current=false;},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(t);if(default_slot)default_slot.d(detaching);mounted=false;dispose();}};}function bind$1(Component){var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return function ModalComponent(options){return new Component(_objectSpread2(_objectSpread2({},options),{},{props:_objectSpread2(_objectSpread2({},props),options.props)}));};}function instance$U($$self,$$props,$$invalidate){var _$$props$$$slots=$$props.$$slots,slots=_$$props$$$slots===void 0?{}:_$$props$$$slots,$$scope=$$props.$$scope;var dispatch=createEventDispatcher();var baseSetContext=setContext;/**
 * A basic function that checks if a node is tabbale
 */var baseIsTabbable=function baseIsTabbable(node){return node.tabIndex>=0&&!node.hidden&&!node.disabled&&node.style.display!=='none'&&node.type!=='hidden'&&Boolean(node.offsetWidth||node.offsetHeight||node.getClientRects().length);};var _$$props$isTabbable=$$props.isTabbable,isTabbable=_$$props$isTabbable===void 0?baseIsTabbable:_$$props$isTabbable;var _$$props$show=$$props.show,show=_$$props$show===void 0?null:_$$props$show;var _$$props$key=$$props.key,key=_$$props$key===void 0?'simple-modal':_$$props$key;var _$$props$ariaLabel=$$props.ariaLabel,ariaLabel=_$$props$ariaLabel===void 0?null:_$$props$ariaLabel;var _$$props$ariaLabelled=$$props.ariaLabelledBy,ariaLabelledBy=_$$props$ariaLabelled===void 0?null:_$$props$ariaLabelled;var _$$props$closeButton=$$props.closeButton,closeButton=_$$props$closeButton===void 0?true:_$$props$closeButton;var _$$props$closeOnEsc=$$props.closeOnEsc,closeOnEsc=_$$props$closeOnEsc===void 0?true:_$$props$closeOnEsc;var _$$props$closeOnOuter=$$props.closeOnOuterClick,closeOnOuterClick=_$$props$closeOnOuter===void 0?true:_$$props$closeOnOuter;var _$$props$styleBg=$$props.styleBg,styleBg=_$$props$styleBg===void 0?{}:_$$props$styleBg;var _$$props$styleWindowW=$$props.styleWindowWrap,styleWindowWrap=_$$props$styleWindowW===void 0?{}:_$$props$styleWindowW;var _$$props$styleWindow=$$props.styleWindow,styleWindow=_$$props$styleWindow===void 0?{}:_$$props$styleWindow;var _$$props$styleContent=$$props.styleContent,styleContent=_$$props$styleContent===void 0?{}:_$$props$styleContent;var _$$props$styleCloseBu=$$props.styleCloseButton,styleCloseButton=_$$props$styleCloseBu===void 0?{}:_$$props$styleCloseBu;var _$$props$classBg=$$props.classBg,classBg=_$$props$classBg===void 0?null:_$$props$classBg;var _$$props$classWindowW=$$props.classWindowWrap,classWindowWrap=_$$props$classWindowW===void 0?null:_$$props$classWindowW;var _$$props$classWindow=$$props.classWindow,classWindow=_$$props$classWindow===void 0?null:_$$props$classWindow;var _$$props$classContent=$$props.classContent,classContent=_$$props$classContent===void 0?null:_$$props$classContent;var _$$props$classCloseBu=$$props.classCloseButton,classCloseButton=_$$props$classCloseBu===void 0?null:_$$props$classCloseBu;var _$$props$unstyled=$$props.unstyled,unstyled=_$$props$unstyled===void 0?false:_$$props$unstyled;var _$$props$setContext=$$props.setContext,setContext$1=_$$props$setContext===void 0?baseSetContext:_$$props$setContext;var _$$props$transitionBg=$$props.transitionBg,transitionBg=_$$props$transitionBg===void 0?fade:_$$props$transitionBg;var _$$props$transitionBg2=$$props.transitionBgProps,transitionBgProps=_$$props$transitionBg2===void 0?{duration:250}:_$$props$transitionBg2;var _$$props$transitionWi=$$props.transitionWindow,transitionWindow=_$$props$transitionWi===void 0?transitionBg:_$$props$transitionWi;var _$$props$transitionWi2=$$props.transitionWindowProps,transitionWindowProps=_$$props$transitionWi2===void 0?transitionBgProps:_$$props$transitionWi2;var _$$props$disableFocus=$$props.disableFocusTrap,disableFocusTrap=_$$props$disableFocus===void 0?false:_$$props$disableFocus;var defaultState={ariaLabel:ariaLabel,ariaLabelledBy:ariaLabelledBy,closeButton:closeButton,closeOnEsc:closeOnEsc,closeOnOuterClick:closeOnOuterClick,styleBg:styleBg,styleWindowWrap:styleWindowWrap,styleWindow:styleWindow,styleContent:styleContent,styleCloseButton:styleCloseButton,classBg:classBg,classWindowWrap:classWindowWrap,classWindow:classWindow,classContent:classContent,classCloseButton:classCloseButton,transitionBg:transitionBg,transitionBgProps:transitionBgProps,transitionWindow:transitionWindow,transitionWindowProps:transitionWindowProps,disableFocusTrap:disableFocusTrap,isTabbable:isTabbable,unstyled:unstyled};var state=_objectSpread2({},defaultState);var Component=null;var background;var wrap;var modalWindow;var scrollY;var cssBg;var cssWindowWrap;var cssWindow;var cssContent;var cssCloseButton;var currentTransitionBg;var currentTransitionWindow;var prevBodyPosition;var prevBodyOverflow;var prevBodyWidth;var outerClickTarget;var camelCaseToDash=function camelCaseToDash(str){return str.replace(/([a-zA-Z])(?=[A-Z])/g,'$1-').toLowerCase();};var toCssString=function toCssString(props){return props?Object.keys(props).reduce(function(str,key){return"".concat(str,"; ").concat(camelCaseToDash(key),": ").concat(props[key]);},''):'';};var isFunction=function isFunction(f){return!!(f&&f.constructor&&f.call&&f.apply);};var updateStyleTransition=function updateStyleTransition(){$$invalidate(6,cssBg=toCssString(Object.assign({},{width:window.innerWidth,height:window.innerHeight},state.styleBg)));$$invalidate(7,cssWindowWrap=toCssString(state.styleWindowWrap));$$invalidate(8,cssWindow=toCssString(state.styleWindow));$$invalidate(9,cssContent=toCssString(state.styleContent));$$invalidate(10,cssCloseButton=toCssString(state.styleCloseButton));$$invalidate(11,currentTransitionBg=state.transitionBg);$$invalidate(12,currentTransitionWindow=state.transitionWindow);};var toVoid=function toVoid(){};var onOpen=toVoid;var onClose=toVoid;var onOpened=toVoid;var onClosed=toVoid;var open=function open(NewComponent){var newProps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var callback=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};$$invalidate(2,Component=bind$1(NewComponent,newProps));$$invalidate(1,state=_objectSpread2(_objectSpread2({},defaultState),options));updateStyleTransition();disableScroll();$$invalidate(13,onOpen=function onOpen(event){if(callback.onOpen)callback.onOpen(event);/**
 * The open event is fired right before the modal opens
 * @event {void} open
 */dispatch('open');/**
 * The opening event is fired right before the modal opens
 * @event {void} opening
 * @deprecated Listen to the `open` event instead
 */dispatch('opening');// Deprecated. Do not use!
});$$invalidate(14,onClose=function onClose(event){if(callback.onClose)callback.onClose(event);/**
 * The close event is fired right before the modal closes
 * @event {void} close
 */dispatch('close');/**
 * The closing event is fired right before the modal closes
 * @event {void} closing
 * @deprecated Listen to the `close` event instead
 */dispatch('closing');// Deprecated. Do not use!
});$$invalidate(15,onOpened=function onOpened(event){if(callback.onOpened)callback.onOpened(event);/**
 * The opened event is fired after the modal's opening transition
 * @event {void} opened
 */dispatch('opened');});$$invalidate(16,onClosed=function onClosed(event){if(callback.onClosed)callback.onClosed(event);/**
 * The closed event is fired after the modal's closing transition
 * @event {void} closed
 */dispatch('closed');});};var close=function close(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!Component)return;$$invalidate(14,onClose=callback.onClose||onClose);$$invalidate(16,onClosed=callback.onClosed||onClosed);$$invalidate(2,Component=null);enableScroll();};var handleKeydown=function handleKeydown(event){if(state.closeOnEsc&&Component&&event.key==='Escape'){event.preventDefault();close();}if(Component&&event.key==='Tab'&&!state.disableFocusTrap){// trap focus
var nodes=modalWindow.querySelectorAll('*');var tabbable=Array.from(nodes).filter(state.isTabbable).sort(function(a,b){return a.tabIndex-b.tabIndex;});var index=tabbable.indexOf(document.activeElement);if(index===-1&&event.shiftKey)index=0;index+=tabbable.length+(event.shiftKey?-1:1);index%=tabbable.length;tabbable[index].focus();event.preventDefault();}};var handleOuterMousedown=function handleOuterMousedown(event){if(state.closeOnOuterClick&&(event.target===background||event.target===wrap))outerClickTarget=event.target;};var handleOuterMouseup=function handleOuterMouseup(event){if(state.closeOnOuterClick&&event.target===outerClickTarget){event.preventDefault();close();}};var disableScroll=function disableScroll(){scrollY=window.scrollY;prevBodyPosition=document.body.style.position;prevBodyOverflow=document.body.style.overflow;prevBodyWidth=document.body.style.width;document.body.style.position='fixed';document.body.style.top="-".concat(scrollY,"px");document.body.style.overflow='hidden';document.body.style.width='100%';};var enableScroll=function enableScroll(){document.body.style.position=prevBodyPosition||'';document.body.style.top='';document.body.style.overflow=prevBodyOverflow||'';document.body.style.width=prevBodyWidth||'';window.scrollTo(0,scrollY);};setContext$1(key,{open:open,close:close});var isMounted=false;onDestroy(function(){if(isMounted)close();});onMount(function(){$$invalidate(46,isMounted=true);});function div1_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){modalWindow=$$value;$$invalidate(5,modalWindow);});}function div2_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){wrap=$$value;$$invalidate(4,wrap);});}function div3_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){background=$$value;$$invalidate(3,background);});}$$self.$$set=function($$props){if('isTabbable'in $$props)$$invalidate(22,isTabbable=$$props.isTabbable);if('show'in $$props)$$invalidate(23,show=$$props.show);if('key'in $$props)$$invalidate(24,key=$$props.key);if('ariaLabel'in $$props)$$invalidate(25,ariaLabel=$$props.ariaLabel);if('ariaLabelledBy'in $$props)$$invalidate(26,ariaLabelledBy=$$props.ariaLabelledBy);if('closeButton'in $$props)$$invalidate(27,closeButton=$$props.closeButton);if('closeOnEsc'in $$props)$$invalidate(28,closeOnEsc=$$props.closeOnEsc);if('closeOnOuterClick'in $$props)$$invalidate(29,closeOnOuterClick=$$props.closeOnOuterClick);if('styleBg'in $$props)$$invalidate(30,styleBg=$$props.styleBg);if('styleWindowWrap'in $$props)$$invalidate(31,styleWindowWrap=$$props.styleWindowWrap);if('styleWindow'in $$props)$$invalidate(32,styleWindow=$$props.styleWindow);if('styleContent'in $$props)$$invalidate(33,styleContent=$$props.styleContent);if('styleCloseButton'in $$props)$$invalidate(34,styleCloseButton=$$props.styleCloseButton);if('classBg'in $$props)$$invalidate(35,classBg=$$props.classBg);if('classWindowWrap'in $$props)$$invalidate(36,classWindowWrap=$$props.classWindowWrap);if('classWindow'in $$props)$$invalidate(37,classWindow=$$props.classWindow);if('classContent'in $$props)$$invalidate(38,classContent=$$props.classContent);if('classCloseButton'in $$props)$$invalidate(39,classCloseButton=$$props.classCloseButton);if('unstyled'in $$props)$$invalidate(0,unstyled=$$props.unstyled);if('setContext'in $$props)$$invalidate(40,setContext$1=$$props.setContext);if('transitionBg'in $$props)$$invalidate(41,transitionBg=$$props.transitionBg);if('transitionBgProps'in $$props)$$invalidate(42,transitionBgProps=$$props.transitionBgProps);if('transitionWindow'in $$props)$$invalidate(43,transitionWindow=$$props.transitionWindow);if('transitionWindowProps'in $$props)$$invalidate(44,transitionWindowProps=$$props.transitionWindowProps);if('disableFocusTrap'in $$props)$$invalidate(45,disableFocusTrap=$$props.disableFocusTrap);if('$$scope'in $$props)$$invalidate(47,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*show*/8388608|$$self.$$.dirty[1]&/*isMounted*/32768){{if(isMounted){if(isFunction(show)){open(show);}else{close();}}}}};return[unstyled,state,Component,background,wrap,modalWindow,cssBg,cssWindowWrap,cssWindow,cssContent,cssCloseButton,currentTransitionBg,currentTransitionWindow,onOpen,onClose,onOpened,onClosed,isFunction,close,handleKeydown,handleOuterMousedown,handleOuterMouseup,isTabbable,show,key,ariaLabel,ariaLabelledBy,closeButton,closeOnEsc,closeOnOuterClick,styleBg,styleWindowWrap,styleWindow,styleContent,styleCloseButton,classBg,classWindowWrap,classWindow,classContent,classCloseButton,setContext$1,transitionBg,transitionBgProps,transitionWindow,transitionWindowProps,disableFocusTrap,isMounted,$$scope,slots,div1_binding,div2_binding,div3_binding];}var Modal=/*#__PURE__*/function(_SvelteComponent2){_inherits(Modal,_SvelteComponent2);var _super3=_createSuper(Modal);function Modal(options){var _this3;_classCallCheck(this,Modal);_this3=_super3.call(this);init(_assertThisInitialized(_this3),options,instance$U,create_fragment$U,safe_not_equal,{isTabbable:22,show:23,key:24,ariaLabel:25,ariaLabelledBy:26,closeButton:27,closeOnEsc:28,closeOnOuterClick:29,styleBg:30,styleWindowWrap:31,styleWindow:32,styleContent:33,styleCloseButton:34,classBg:35,classWindowWrap:36,classWindow:37,classContent:38,classCloseButton:39,unstyled:0,setContext:40,transitionBg:41,transitionBgProps:42,transitionWindow:43,transitionWindowProps:44,disableFocusTrap:45},add_css$K,[-1,-1,-1]);return _this3;}return _createClass(Modal);}(SvelteComponent);var SCROLL_DURATION=300;// ms
var DEBOUNCE_DELAY=300;// ms
var TEXT_MODE_ONCHANGE_DELAY=300;// ms
var SEARCH_UPDATE_THROTTLE=300;// ms
var AUTO_SCROLL_INTERVAL=50;// ms
var AUTO_SCROLL_SPEED_SLOW=200;// pixels per second
var AUTO_SCROLL_SPEED_NORMAL=400;// pixels per second
var AUTO_SCROLL_SPEED_FAST=1200;// pixels per second
var MAX_SEARCH_RESULTS=1000;var ARRAY_SECTION_SIZE=100;var MAX_CHARACTERS_TEXT_PREVIEW=20000;var DEFAULT_VISIBLE_SECTIONS=[{start:0,end:ARRAY_SECTION_SIZE}];var MAX_VALIDATABLE_SIZE=100*1024*1024;// 1 MB
var MAX_AUTO_REPAIRABLE_SIZE=1024*1024;// 1 MB
var MAX_DOCUMENT_SIZE_TEXT_MODE=10*1024*1024;// 10 MB
var MAX_DOCUMENT_SIZE_EXPAND_ALL=10*1024;// 10 KB
var SIMPLE_MODAL_OPTIONS={closeButton:false,classBg:'jse-modal-bg',classWindow:'jse-modal-window',classWindowWrap:'jse-modal-window-wrap',classContent:'jse-modal-content'};var SORT_MODAL_OPTIONS=_objectSpread2(_objectSpread2({},SIMPLE_MODAL_OPTIONS),{},{classWindow:'jse-modal-window jse-modal-window-sort'});var TRANSFORM_MODAL_OPTIONS=_objectSpread2(_objectSpread2({},SIMPLE_MODAL_OPTIONS),{},{classWindow:'jse-modal-window jse-modal-window-transform'});var INSERT_EXPLANATION='Insert or paste contents, '+'enter [ insert a new array, '+'enter { to insert a new object, '+'or start typing to insert a new value';var CONTEXT_MENU_EXPLANATION='Open context menu '+'(Click here, '+'right click on the selection, '+'or use the context menu button or Ctrl+Q)';var HOVER_INSERT_INSIDE='hover-insert-inside';var HOVER_INSERT_AFTER='hover-insert-after';var HOVER_COLLECTION='hover-collection';var JSON_STATUS_VALID='valid';var JSON_STATUS_REPAIRABLE='repairable';var JSON_STATUS_INVALID='invalid';// TODO: can we dynamically calculate the size?
var CONTEXT_MENU_HEIGHT=(40+2)*8;// px
var CONTEXT_MENU_WIDTH=260;// px
// TODO: change UPDATE_SELECTION into an enum
var UPDATE_SELECTION={NO:'NO',SELF:'SELF',NEXT_INSIDE:'NEXT_INSIDE'};var id=0;function uniqueId$1(){id++;return id;}var commonjsGlobal=typeof globalThis!=='undefined'?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,'default')?x['default']:x;}var immutableJSONPatch={exports:{}};(function(module,exports){(function(global,factory){factory(exports);})(commonjsGlobal,function(exports){function _typeof$1(obj){"@babel/helpers - typeof";return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof$1(obj);}function isJSONArray(value){return Array.isArray(value);}function isJSONObject(value){return value!==null&&_typeof$1(value)==='object'&&value.constructor===Object// do not match on classes or Array
;}function isJSONPatchOperation(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?typeof value.op==='string':false;}function isJSONPatchAdd(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='add':false;}function isJSONPatchRemove(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='remove':false;}function isJSONPatchReplace(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='replace':false;}function isJSONPatchCopy(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='copy':false;}function isJSONPatchMove(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='move':false;}function isJSONPatchTest(value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return value&&_typeof$1(value)==='object'?value.op==='test':false;}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}/**
	   * Test deep equality of two JSON values, objects, or arrays
	   */ // TODO: write unit tests
function isEqual(a,b){// FIXME: this function will return false for two objects with the same keys
//  but different order of keys
return JSON.stringify(a)===JSON.stringify(b);}/**
	   * Test whether two values are strictly equal
	   */function strictEqual(a,b){return a===b;}/**
	   * Get all but the last items from an array
	   */ // TODO: write unit tests
function initial(array){return array.slice(0,array.length-1);}/**
	   * Get the last item from an array
	   */ // TODO: write unit tests
function last(array){return array[array.length-1];}/**
	   * Test whether array1 starts with array2
	   * @param array1
	   * @param array2
	   * @param [isEqual] Optional function to check equality
	   */function startsWith(array1,array2){var isEqual=arguments.length>2&&arguments[2]!==undefined?arguments[2]:strictEqual;if(array1.length<array2.length){return false;}for(var i=0;i<array2.length;i++){if(!isEqual(array1[i],array2[i])){return false;}}return true;}/**
	   * Test whether a value is an Object or an Array (and not a primitive JSON value)
	   */ // TODO: write unit tests
function isObjectOrArray(value){return _typeof(value)==='object'&&value!==null;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}/**
	   * Shallow clone of an Object, Array, or value
	   * Symbols are cloned too.
	   */function shallowClone(value){if(isJSONArray(value)){// copy array items
var copy=value.slice();// copy all symbols
Object.getOwnPropertySymbols(value).forEach(function(symbol){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
copy[symbol]=value[symbol];});return copy;}else if(isJSONObject(value)){// copy object properties
var _copy=_objectSpread({},value);// copy all symbols
Object.getOwnPropertySymbols(value).forEach(function(symbol){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
_copy[symbol]=value[symbol];});return _copy;}else{return value;}}/**
	   * Update a value in an object in an immutable way.
	   * If the value is unchanged, the original object will be returned
	   */function applyProp(object,key,value){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
if(object[key]===value){// return original object unchanged when the new value is identical to the old one
return object;}else{var updatedObject=shallowClone(object);// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
updatedObject[key]=value;return updatedObject;}}/**
	   * helper function to get a nested property in an object or array
	   *
	   * @return Returns the field when found, or undefined when the path doesn't exist
	   */function getIn(object,path){var value=object;var i=0;while(i<path.length){if(isJSONObject(value)){value=value[path[i]];}else if(isJSONArray(value)){value=value[parseInt(path[i])];}else{value=undefined;}i++;}return value;}/**
	   * helper function to replace a nested property in an object with a new value
	   * without mutating the object itself.
	   *
	   * @param object
	   * @param path
	   * @param value
	   * @param [createPath=false]
	   *                    If true, `path` will be created when (partly) missing in
	   *                    the object. For correctly creating nested Arrays or
	   *                    Objects, the function relies on `path` containing number
	   *                    in case of array indexes.
	   *                    If false (default), an error will be thrown when the
	   *                    path doesn't exist.
	   * @return Returns a new, updated object or array
	   */function setIn(object,path,value){var createPath=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(path.length===0){return value;}var key=path[0];// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
var updatedValue=setIn(object?object[key]:undefined,path.slice(1),value,createPath);if(isJSONObject(object)||isJSONArray(object)){return applyProp(object,key,updatedValue);}else{if(createPath){var newObject=IS_INTEGER_REGEX.test(key)?[]:{};// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
newObject[key]=updatedValue;return newObject;}else{throw new Error('Path does not exist');}}}var IS_INTEGER_REGEX=/^\d+$/;/**
	   * helper function to replace a nested property in an object with a new value
	   * without mutating the object itself.
	   *
	   * @return  Returns a new, updated object or array
	   */function updateIn(object,path,callback){if(path.length===0){return callback(object);}if(!isObjectOrArray(object)){throw new Error('Path doesn\'t exist');}var key=path[0];// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
var updatedValue=updateIn(object[key],path.slice(1),callback);// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return applyProp(object,key,updatedValue);}/**
	   * helper function to delete a nested property in an object
	   * without mutating the object itself.
	   *
	   * @return Returns a new, updated object or array
	   */function deleteIn(object,path){if(path.length===0){return object;}if(!isObjectOrArray(object)){throw new Error('Path does not exist');}if(path.length===1){var _key=path[0];if(!(_key in object)){// key doesn't exist. return object unchanged
return object;}else{var updatedObject=shallowClone(object);if(isJSONArray(updatedObject)){updatedObject.splice(parseInt(_key),1);}if(isJSONObject(updatedObject)){delete updatedObject[_key];}return updatedObject;}}var key=path[0];// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
var updatedValue=deleteIn(object[key],path.slice(1));// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return applyProp(object,key,updatedValue);}/**
	   * Insert a new item in an array at a specific index.
	   * Example usage:
	   *
	   *     insertAt({arr: [1,2,3]}, ['arr', '2'], 'inserted')  // [1,2,'inserted',3]
	   */function insertAt(document,path,value){var parentPath=path.slice(0,path.length-1);var index=path[path.length-1];return updateIn(document,parentPath,function(items){if(!Array.isArray(items)){throw new TypeError('Array expected at path '+JSON.stringify(parentPath));}var updatedItems=shallowClone(items);updatedItems.splice(parseInt(index),0,value);return updatedItems;});}/**
	   * Transform a JSON object, traverse over the whole object,
	   * and allow replacing Objects/Arrays/values.
	   */function transform(document,callback){var path=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var updated1=callback(document,path);if(isJSONArray(updated1)){// array
var updated2;for(var i=0;i<updated1.length;i++){var before=updated1[i];// we stringify the index here, so the path only contains strings and can be safely
// stringified/parsed to JSONPointer without loosing information.
// We do not want to rely on path keys being numeric/string.
var after=transform(before,callback,path.concat(i+''));if(after!==before){if(!updated2){updated2=shallowClone(updated1);}updated2[i]=after;}}return updated2||updated1;}else if(isJSONObject(updated1)){// object
var _updated;for(var key in updated1){if(Object.hasOwnProperty.call(updated1,key)){var _before=updated1[key];var _after=transform(_before,callback,path.concat(key));if(_after!==_before){if(!_updated){_updated=shallowClone(updated1);}_updated[key]=_after;}}}return _updated||updated1;}else{// number, string, boolean, null
return updated1;}}/**
	   * Test whether a path exists in a JSON object
	   * @return Returns true if the path exists, else returns false
	   */function existsIn(document,path){if(document===undefined){return false;}if(path.length===0){return true;}// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return existsIn(document[path[0]],path.slice(1));}/**
	   * Parse a JSON Pointer
	   */function parseJSONPointer(pointer){var path=pointer.split('/');path.shift();// remove the first empty entry
return path.map(function(p){return p.replace(/~1/g,'/').replace(/~0/g,'~');});}/**
	   * Compile a JSON Pointer
	   */function compileJSONPointer(path){return path.map(compileJSONPointerProp).join('');}/**
	   * Compile a single path property from a JSONPath
	   */function compileJSONPointerProp(pathProp){return'/'+String(pathProp).replace(/~/g,'~0').replace(/\//g,'~1');}/**
	   * Append a path property to a JSONPointer
	   */function appendToJSONPointer(pointer,pathProp){return pointer+compileJSONPointerProp(pathProp);}/**
	   * Test whether `pointer` starts with `searchPointer`
	   */function startsWithJSONPointer(pointer,searchPointer){return pointer.startsWith(searchPointer)&&(pointer.length===searchPointer.length||pointer[searchPointer.length]==='/');}/**
	   * Apply a patch to a JSON object
	   * The original JSON object will not be changed,
	   * instead, the patch is applied in an immutable way
	   */function immutableJSONPatch(document,operations,options){var updatedDocument=document;for(var i=0;i<operations.length;i++){validateJSONPatchOperation(operations[i]);var operation=operations[i];// TODO: test before
if(options&&options.before){var result=options.before(updatedDocument,operation);if(result!==undefined){if(result.document!==undefined){updatedDocument=result.document;}// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
if(result.json!==undefined){// TODO: deprecated since v5.0.0. Cleanup this warning some day
throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"');}if(result.operation!==undefined){operation=result.operation;}}}var previousDocument=updatedDocument;var path=parsePath(updatedDocument,operation.path);if(operation.op==='add'){updatedDocument=add(updatedDocument,path,operation.value);}else if(operation.op==='remove'){updatedDocument=remove(updatedDocument,path);}else if(operation.op==='replace'){updatedDocument=replace(updatedDocument,path,operation.value);}else if(operation.op==='copy'){updatedDocument=copy(updatedDocument,path,parseFrom(operation.from));}else if(operation.op==='move'){updatedDocument=move(updatedDocument,path,parseFrom(operation.from));}else if(operation.op==='test'){test(updatedDocument,path,operation.value);}else{throw new Error('Unknown JSONPatch operation '+JSON.stringify(operation));}// TODO: test after
if(options&&options.after){var _result=options.after(updatedDocument,operation,previousDocument);if(_result!==undefined){updatedDocument=_result;}}}return updatedDocument;}/**
	   * Replace an existing item
	   */function replace(document,path,value){return setIn(document,path,value);}/**
	   * Remove an item or property
	   */function remove(document,path){return deleteIn(document,path);}/**
	   * Add an item or property
	   */function add(document,path,value){if(isArrayItem(document,path)){return insertAt(document,path,value);}else{return setIn(document,path,value);}}/**
	   * Copy a value
	   */function copy(document,path,from){var value=getIn(document,from);if(isArrayItem(document,path)){return insertAt(document,path,value);}else{var _value=getIn(document,from);return setIn(document,path,_value);}}/**
	   * Move a value
	   */function move(document,path,from){var value=getIn(document,from);// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
var removedJson=deleteIn(document,from);return isArrayItem(removedJson,path)?insertAt(removedJson,path,value):setIn(removedJson,path,value);}/**
	   * Test whether the data contains the provided value at the specified path.
	   * Throws an error when the test fails
	   */function test(document,path,value){if(value===undefined){throw new Error("Test failed: no value provided (path: \"".concat(compileJSONPointer(path),"\")"));}if(!existsIn(document,path)){throw new Error("Test failed: path not found (path: \"".concat(compileJSONPointer(path),"\")"));}var actualValue=getIn(document,path);if(!isEqual(actualValue,value)){throw new Error("Test failed, value differs (path: \"".concat(compileJSONPointer(path),"\")"));}}function isArrayItem(document,path){if(path.length===0){return false;}var parent=getIn(document,initial(path));return Array.isArray(parent);}/**
	   * Resolve the path index of an array, resolves indexes '-'
	   * @returns Returns the resolved path
	   */function resolvePathIndex(document,path){if(last(path)!=='-'){return path;}var parentPath=initial(path);var parent=getIn(document,parentPath);// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return parentPath.concat(parent.length);}/**
	   * Validate a JSONPatch operation.
	   * Throws an error when there is an issue
	   */function validateJSONPatchOperation(operation){// TODO: write unit tests
var ops=['add','remove','replace','copy','move','test'];if(!ops.includes(operation.op)){throw new Error('Unknown JSONPatch op '+JSON.stringify(operation.op));}if(typeof operation.path!=='string'){throw new Error('Required property "path" missing or not a string in operation '+JSON.stringify(operation));}if(operation.op==='copy'||operation.op==='move'){if(typeof operation.from!=='string'){throw new Error('Required property "from" missing or not a string in operation '+JSON.stringify(operation));}}}function parsePath(document,pointer){return resolvePathIndex(document,parseJSONPointer(pointer));}function parseFrom(fromPointer){return parseJSONPointer(fromPointer);}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}/**
	   * Create the inverse of a set of json patch operations
	   * @param document
	   * @param operations Array with JSON patch actions
	   * @param [options]
	   * @return Returns the operations to revert the changes
	   */function revertJSONPatch(document,operations,options){var allRevertOperations=[];immutableJSONPatch(document,operations,{before:function before(document,operation){var revertOperations;var path=parsePath(document,operation.path);if(operation.op==='add'){revertOperations=revertAdd(document,path);}else if(operation.op==='remove'){revertOperations=revertRemove(document,path);}else if(operation.op==='replace'){revertOperations=revertReplace(document,path);}else if(operation.op==='copy'){revertOperations=revertCopy(document,path);}else if(operation.op==='move'){revertOperations=revertMove(document,path,parseFrom(operation.from));}else if(operation.op==='test'){revertOperations=[];}else{throw new Error('Unknown JSONPatch operation '+JSON.stringify(operation));}var updatedJson;if(options&&options.before){var res=options.before(document,operation,revertOperations);if(res&&res.revertOperations){revertOperations=res.revertOperations;}if(res&&res.document){updatedJson=res.document;}// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
if(res&&res.json){// TODO: deprecated since v5.0.0. Cleanup this warning some day
throw new Error('Deprecation warning: returned object property ".json" has been renamed to ".document"');}}allRevertOperations=revertOperations.concat(allRevertOperations);if(updatedJson!==undefined){return{document:updatedJson};}}});return allRevertOperations;}function revertReplace(document,path){return[{op:'replace',path:compileJSONPointer(path),value:getIn(document,path)}];}function revertRemove(document,path){return[{op:'add',path:compileJSONPointer(path),value:getIn(document,path)}];}function revertAdd(document,path){if(isArrayItem(document,path)||!existsIn(document,path)){return[{op:'remove',path:compileJSONPointer(path)}];}else{return revertReplace(document,path);}}function revertCopy(document,path){return revertAdd(document,path);}function revertMove(document,path,from){if(path.length<from.length&&startsWith(from,path)){// replacing the parent with the child
return[{op:'replace',path:compileJSONPointer(path),value:document}];}var move={op:'move',from:compileJSONPointer(path),path:compileJSONPointer(from)};if(!isArrayItem(document,path)&&existsIn(document,path)){// the move replaces an existing value in an object
return[move].concat(_toConsumableArray(revertRemove(document,path)));}else{return[move];}}exports.appendToJSONPointer=appendToJSONPointer;exports.compileJSONPointer=compileJSONPointer;exports.compileJSONPointerProp=compileJSONPointerProp;exports.deleteIn=deleteIn;exports.existsIn=existsIn;exports.getIn=getIn;exports.immutableJSONPatch=immutableJSONPatch;exports.insertAt=insertAt;exports.isJSONArray=isJSONArray;exports.isJSONObject=isJSONObject;exports.isJSONPatchAdd=isJSONPatchAdd;exports.isJSONPatchCopy=isJSONPatchCopy;exports.isJSONPatchMove=isJSONPatchMove;exports.isJSONPatchOperation=isJSONPatchOperation;exports.isJSONPatchRemove=isJSONPatchRemove;exports.isJSONPatchReplace=isJSONPatchReplace;exports.isJSONPatchTest=isJSONPatchTest;exports.parseFrom=parseFrom;exports.parseJSONPointer=parseJSONPointer;exports.parsePath=parsePath;exports.revertJSONPatch=revertJSONPatch;exports.setIn=setIn;exports.startsWithJSONPointer=startsWithJSONPointer;exports.transform=transform;exports.updateIn=updateIn;Object.defineProperty(exports,'__esModule',{value:true});});})(immutableJSONPatch,immutableJSONPatch.exports);var jsonSourceMap={};var escapedChars={'b':'\b','f':'\f','n':'\n','r':'\r','t':'\t','"':'"','/':'/','\\':'\\'};var A_CODE='a'.charCodeAt();jsonSourceMap.parse=function(source,_,options){var pointers={};var line=0;var column=0;var pos=0;var bigint=options&&options.bigint&&typeof BigInt!='undefined';return{data:_parse('',true),pointers:pointers};function _parse(ptr,topLevel){whitespace();var data;map(ptr,'value');var _char=getChar();switch(_char){case't':read('rue');data=true;break;case'f':read('alse');data=false;break;case'n':read('ull');data=null;break;case'"':data=parseString();break;case'[':data=parseArray(ptr);break;case'{':data=parseObject(ptr);break;default:backChar();if('-0123456789'.indexOf(_char)>=0)data=parseNumber();else unexpectedToken();}map(ptr,'valueEnd');whitespace();if(topLevel&&pos<source.length)unexpectedToken();return data;}function whitespace(){loop:while(pos<source.length){switch(source[pos]){case' ':column++;break;case'\t':column+=4;break;case'\r':column=0;break;case'\n':column=0;line++;break;default:break loop;}pos++;}}function parseString(){var str='';var _char2;while(true){_char2=getChar();if(_char2=='"'){break;}else if(_char2=='\\'){_char2=getChar();if(_char2 in escapedChars)str+=escapedChars[_char2];else if(_char2=='u')str+=getCharCode();else wasUnexpectedToken();}else{str+=_char2;}}return str;}function parseNumber(){var numStr='';var integer=true;if(source[pos]=='-')numStr+=getChar();numStr+=source[pos]=='0'?getChar():getDigits();if(source[pos]=='.'){numStr+=getChar()+getDigits();integer=false;}if(source[pos]=='e'||source[pos]=='E'){numStr+=getChar();if(source[pos]=='+'||source[pos]=='-')numStr+=getChar();numStr+=getDigits();integer=false;}var result=+numStr;return bigint&&integer&&(result>Number.MAX_SAFE_INTEGER||result<Number.MIN_SAFE_INTEGER)?BigInt(numStr):result;}function parseArray(ptr){whitespace();var arr=[];var i=0;if(getChar()==']')return arr;backChar();while(true){var itemPtr=ptr+'/'+i;arr.push(_parse(itemPtr));whitespace();var _char3=getChar();if(_char3==']')break;if(_char3!=',')wasUnexpectedToken();whitespace();i++;}return arr;}function parseObject(ptr){whitespace();var obj={};if(getChar()=='}')return obj;backChar();while(true){var loc=getLoc();if(getChar()!='"')wasUnexpectedToken();var key=parseString();var propPtr=ptr+'/'+escapeJsonPointer(key);mapLoc(propPtr,'key',loc);map(propPtr,'keyEnd');whitespace();if(getChar()!=':')wasUnexpectedToken();whitespace();obj[key]=_parse(propPtr);whitespace();var _char4=getChar();if(_char4=='}')break;if(_char4!=',')wasUnexpectedToken();whitespace();}return obj;}function read(str){for(var i=0;i<str.length;i++){if(getChar()!==str[i])wasUnexpectedToken();}}function getChar(){checkUnexpectedEnd();var _char5=source[pos];pos++;column++;// new line?
return _char5;}function backChar(){pos--;column--;}function getCharCode(){var count=4;var code=0;while(count--){code<<=4;var _char6=getChar().toLowerCase();if(_char6>='a'&&_char6<='f')code+=_char6.charCodeAt()-A_CODE+10;else if(_char6>='0'&&_char6<='9')code+=+_char6;else wasUnexpectedToken();}return String.fromCharCode(code);}function getDigits(){var digits='';while(source[pos]>='0'&&source[pos]<='9'){digits+=getChar();}if(digits.length)return digits;checkUnexpectedEnd();unexpectedToken();}function map(ptr,prop){mapLoc(ptr,prop,getLoc());}function mapLoc(ptr,prop,loc){pointers[ptr]=pointers[ptr]||{};pointers[ptr][prop]=loc;}function getLoc(){return{line:line,column:column,pos:pos};}function unexpectedToken(){throw new SyntaxError('Unexpected token '+source[pos]+' in JSON at position '+pos);}function wasUnexpectedToken(){backChar();unexpectedToken();}function checkUnexpectedEnd(){if(pos>=source.length)throw new SyntaxError('Unexpected end of JSON input');}};jsonSourceMap.stringify=function(data,_,options){if(!validType(data))return;var wsLine=0;var wsPos,wsColumn;var whitespace=_typeof2(options)=='object'?options.space:options;switch(_typeof2(whitespace)){case'number':var len=whitespace>10?10:whitespace<0?0:Math.floor(whitespace);whitespace=len&&repeat(len,' ');wsPos=len;wsColumn=len;break;case'string':whitespace=whitespace.slice(0,10);wsPos=0;wsColumn=0;for(var j=0;j<whitespace.length;j++){var _char7=whitespace[j];switch(_char7){case' ':wsColumn++;break;case'\t':wsColumn+=4;break;case'\r':wsColumn=0;break;case'\n':wsColumn=0;wsLine++;break;default:throw new Error('whitespace characters not allowed in JSON');}wsPos++;}break;default:whitespace=undefined;}var json='';var pointers={};var line=0;var column=0;var pos=0;var es6=options&&options.es6&&typeof Map=='function';_stringify(data,0,'');return{json:json,pointers:pointers};function _stringify(_data,lvl,ptr){map(ptr,'value');switch(_typeof2(_data)){case'number':case'bigint':case'boolean':out(''+_data);break;case'string':out(quoted(_data));break;case'object':if(_data===null){out('null');}else if(typeof _data.toJSON=='function'){out(quoted(_data.toJSON()));}else if(Array.isArray(_data)){stringifyArray();}else if(es6){if(_data.constructor.BYTES_PER_ELEMENT)stringifyArray();else if(_data instanceof Map)stringifyMapSet();else if(_data instanceof Set)stringifyMapSet(true);else stringifyObject();}else{stringifyObject();}}map(ptr,'valueEnd');function stringifyArray(){if(_data.length){out('[');var itemLvl=lvl+1;for(var i=0;i<_data.length;i++){if(i)out(',');indent(itemLvl);var item=validType(_data[i])?_data[i]:null;var itemPtr=ptr+'/'+i;_stringify(item,itemLvl,itemPtr);}indent(lvl);out(']');}else{out('[]');}}function stringifyObject(){var keys=Object.keys(_data);if(keys.length){out('{');var propLvl=lvl+1;for(var i=0;i<keys.length;i++){var key=keys[i];var value=_data[key];if(validType(value)){if(i)out(',');var propPtr=ptr+'/'+escapeJsonPointer(key);indent(propLvl);map(propPtr,'key');out(quoted(key));map(propPtr,'keyEnd');out(':');if(whitespace)out(' ');_stringify(value,propLvl,propPtr);}}indent(lvl);out('}');}else{out('{}');}}function stringifyMapSet(isSet){if(_data.size){out('{');var propLvl=lvl+1;var first=true;var entries=_data.entries();var entry=entries.next();while(!entry.done){var item=entry.value;var key=item[0];var value=isSet?true:item[1];if(validType(value)){if(!first)out(',');first=false;var propPtr=ptr+'/'+escapeJsonPointer(key);indent(propLvl);map(propPtr,'key');out(quoted(key));map(propPtr,'keyEnd');out(':');if(whitespace)out(' ');_stringify(value,propLvl,propPtr);}entry=entries.next();}indent(lvl);out('}');}else{out('{}');}}}function out(str){column+=str.length;pos+=str.length;json+=str;}function indent(lvl){if(whitespace){json+='\n'+repeat(lvl,whitespace);line++;column=0;while(lvl--){if(wsLine){line+=wsLine;column=wsColumn;}else{column+=wsColumn;}pos+=wsPos;}pos+=1;// \n character
}}function map(ptr,prop){pointers[ptr]=pointers[ptr]||{};pointers[ptr][prop]={line:line,column:column,pos:pos};}function repeat(n,str){return Array(n+1).join(str);}};var VALID_TYPES=['number','bigint','boolean','string','object'];function validType(data){return VALID_TYPES.indexOf(_typeof2(data))>=0;}var ESC_QUOTE=/"|\\/g;var ESC_B=/[\b]/g;var ESC_F=/\f/g;var ESC_N=/\n/g;var ESC_R=/\r/g;var ESC_T=/\t/g;function quoted(str){str=str.replace(ESC_QUOTE,'\\$&').replace(ESC_F,'\\f').replace(ESC_B,'\\b').replace(ESC_N,'\\n').replace(ESC_R,'\\r').replace(ESC_T,'\\t');return'"'+str+'"';}var ESC_0=/~/g;var ESC_1=/\//g;function escapeJsonPointer(str){return str.replace(ESC_0,'~0').replace(ESC_1,'~1');}var jsonrepair_min={exports:{}};(function(module,exports){!function(e,n){module.exports=n();}(commonjsGlobal,function(){function f(e,n){if(!(this instanceof f))throw new SyntaxError("Constructor must be called with the new operator");this.message=e+" (char "+n+")",this["char"]=n,this.stack=new Error().stack;}(f.prototype=new Error()).constructor=Error;var o={"'":!0,"":!0,"":!0,"`":!0,"":!0},u={'"':!0,"":!0,"":!0};function c(e){return n.test(e);}var n=/^[a-zA-Z_]$/;var s=/^[0-9a-fA-F]$/;function a(e){return t.test(e);}var t=/^[0-9]$/;function l(e){return" "===e||"\t"===e||"\n"===e||"\r"===e;}function h(e){return""===e||""<=e&&e<=""||""===e||""===e||""===e;}function d(e){return!0===o[e];}function w(e){return!0===u[e];}function b(e){return!0===o[e]?"'":!0===u[e]?'"':e;}function e(e,n){n=e.lastIndexOf(n);return-1!==n?e.substring(0,n)+e.substring(n+1):e;}function r(e,n){var t=e.length;if(!l(e[t-1]))return e+n;for(;l(e[t-1]);){t--;}return e.substring(0,t)+n+e.substring(t);}var i=0,g=1,v=2,p=3,x=4,k=5,m=6,y={"":!0,"{":!0,"}":!0,"[":!0,"]":!0,":":!0,",":!0,"(":!0,")":!0,";":!0,"+":!0},I={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},E={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},A={"null":"null","true":"true","false":"false"},j={None:"null",True:"true",False:"false"},$="",O="",T=0,C="",F="",S=m;function U(){T++,C=$.charAt(T);}function z(){U(),"\\"===C&&U();}function N(){return S===i&&("["===F||"{"===F)||S===v||S===g||S===p;}function V(){O+=F,S=m,F="",y[C]?(S=i,F=C,U()):function(){if(a(C)||"-"===C){if(S=g,"-"===C){if(F+=C,U(),!a(C))throw new f("Invalid number, digit expected",T);}else"0"===C&&(F+=C,U());for(;a(C);){F+=C,U();}if("."===C){if(F+=C,U(),!a(C))throw new f("Invalid number, digit expected",T);for(;a(C);){F+=C,U();}}if("e"===C||"E"===C){if(F+=C,U(),"+"!==C&&"-"!==C||(F+=C,U()),!a(C))throw new f("Invalid number, digit expected",T);for(;a(C);){F+=C,U();}}}else"\\"===C&&'"'===$.charAt(T+1)?(U(),_(z)):_(U);}(),S===x&&(F=function(e){for(var n="",t=0;t<e.length;t++){var r=e[t];n+=h(r)?" ":r;}return n;}(F),V()),S===k&&(S=m,F="",V());}function Z(){","===F&&(F="",S=m,V());}function _(e){if(!0===o[n=C]||!0===u[n]){var n=b(C),t=d(C)?d:w;for(F+='"',S=v,e();""!==C&&!t(C);){if("\\"===C){if(e(),void 0!==I[C])F+="\\"+C,e();else if("u"===C){F+="\\u",e();for(var r=0;r<4;r++){if(i=C,!s.test(i))throw new f("Invalid unicode character",T-F.length);F+=C,e();}}else{if("'"!==C)throw new f('Invalid escape character "\\'+C+'"',T);F+="'",e();}}else E[C]?F+=E[C]:F+='"'===C?'\\"':C,e();}if(b(C)!==n)throw new f("End of string expected",T-F.length);return F+='"',void e();}var i,n;!function(){if(c(C))for(S=p;c(C)||a(C)||"$"===C;){F+=C,U();}else!function(){if(l(C)||h(C))for(S=x;l(C)||h(C);){F+=C,U();}else!function(){if("/"!==C||"*"!==$[T+1]){if("/"!==C||"/"!==$[T+1])!function(){S=m;for(;""!==C;){F+=C,U();}throw new f('Syntax error in part "'+F+'"',T-F.length);}();else for(S=k;""!==C&&"\n"!==C;){F+=C,U();}}else{for(S=k;""!==C&&("*"!==C||"*"===C&&"/"!==$[T+1]);){F+=C,U();}"*"===C&&"/"===$[T+1]&&(F+=C,U(),F+=C,U());}}();}();}();}function q(){if(S!==i||"{"!==F)!function(){if(S!==i||"["!==F)!function(){if(S!==v)(S!==g?function(){if(S!==p)!function(){throw new f(""===F?"Unexpected end of json string":"Value expected",T-F.length);}();else if(A[F])V();else{if(j[F])return F=j[F],V();var e=F,n=O.length;if(F="",V(),S===i&&"("===F)return F="",V(),q(),S===i&&")"===F&&(F="",V(),S===i&&";"===F&&(F="",V()));for(O=function(e,n,t){return e.substring(0,t)+n+e.substring(t);}(O,'"'.concat(e),n);S===p||S===g;){V();}O+='"';}}:V)();else for(V();S===i&&"+"===F;){var e;F="",V(),S===v&&(e=O.lastIndexOf('"'),O=O.substring(0,e)+F.substring(1),F="",V());}}();else if(V(),S!==i||"]"!==F){for(;;){if(q(),S===i&&","===F){if(V(),S===i&&"]"===F){O=e(O,",");break;}if(""===F){O=e(O,",");break;}}else{if(!N())break;O=r(O,",");}}S===i&&"]"===F?V():O=r(O,"]");}else V();}();else if(V(),S!==i||"}"!==F){for(;;){if(S!==p&&S!==g||(S=v,F='"'.concat(F,'"')),S!==v)throw new f("Object key expected",T-F.length);if(V(),S===i&&":"===F)V();else{if(!N())throw new f("Colon expected",T-F.length);O=r(O,":");}if(q(),S===i&&","===F){if(V(),S===i&&"}"===F){O=e(O,",");break;}if(""===F){O=e(O,",");break;}}else{if(S!==v&&S!==g&&S!==p)break;O=r(O,",");}}S===i&&"}"===F?V():O=r(O,"}");}else V();}return function(e){O="",T=0,C=($=e).charAt(0),F="",S=m,V();var n=S;if(q(),Z(),""===F)return O;if(n===S&&N()){for(var t="";n===S&&N();){t+=O=r(O,","),O="",q(),Z();}return"[\n".concat(t).concat(O,"\n]");}throw new f("Unexpected characters",T-F.length);};});})(jsonrepair_min);var jsonrepair=jsonrepair_min.exports;function _int(value){return parseInt(value,10);}function isDigit(_char8){return DIGIT_REGEX.test(_char8);}var DIGIT_REGEX=/^[0-9]$/;// TODO: unit test
function isNumber$1(value){return NUMBER_REGEX.test(value);}var NUMBER_REGEX=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;// TODO: unit test typeUtils.js
/**
 * Test whether a value is an Object (and not an Array or Class)
 */function isObject$1(value){return _typeof2(value)==='object'&&value!==null&&value.constructor===Object// do not match on classes or Array
;}/**
 * Test whether a value is an Object or an Array (and not a Class)
 */ // eslint-disable-next-line @typescript-eslint/ban-types
function isObjectOrArray(value){return _typeof2(value)==='object'&&value!==null&&(value.constructor===Object||value.constructor===Array);}/**
 * Test whether a value is a boolean
 *
 * @param {*} value
 * @return {boolean}
 */function isBoolean$1(value){return value===true||value===false;}/**
 * Test whether a value is a timestamp in milliseconds after the year 2000.
 */function isTimestamp(value){var YEAR_2000=946684800000;if(typeof value==='number'){return value>YEAR_2000&&isFinite(value)&&Math.floor(value)===value&&!isNaN(new Date(value).valueOf());}if(typeof value==='bigint'){return isTimestamp(Number(value));}// try getting the primitive value if that is different. For example when having a LosslessNumber
try{var _valueOf=value.valueOf();if(_valueOf!==value){return isTimestamp(_valueOf);}}catch(err){return false;}}/**
 * Get the applied color given a color name or code
 * Returns the color if the input is a valid color, and returns null otherwise.
 *
 * Example output:
 *
 *     'rgba(255,0,0,0.7)' or 'rgb(255,0,0)'
 *
 * Source: https://stackoverflow.com/questions/6386090/validating-css-color-names/33184805
 */function getColorCSS(color){// TODO: test performance impact of this function
var colorStyleElement=window.document.createElement('div');colorStyleElement.style.color=color;return colorStyleElement.style.color.split(/\s+/).join('').toLowerCase()||null;}/**
 * Test if a string contains a valid color name or code.
 * Returns true if a valid color, false otherwise
 */function isColor(value){return typeof value==='string'&&!!getColorCSS(value);}/**
 * Get the type of the value
 */function valueType(value,parser){// primitive types
if(typeof value==='number'||typeof value==='string'||typeof value==='boolean'||typeof value==='undefined'){return _typeof2(value);}if(typeof value==='bigint'){return'number';// we return number here, not bigint: all numeric types should return the same name
}if(value===null){return'null';}if(Array.isArray(value)){return'array';}if(isObject$1(value)){// plain object only
return'object';}// unknown type. Try out what stringfying results in
var valueStr=parser.stringify(value);if(valueStr&&isDigit(valueStr[0])){return'number';}if(valueStr==='true'||valueStr==='false'){return'boolean';}if(valueStr==='null'){return'null';}return'unknown';}/**
 * Test whether a text contains a url (matches when a string starts
 * with 'http://*' or 'https://*' and has no whitespace characters)
 */var isUrlRegex=/^https?:\/\/\S+$/;function isUrl(text){return typeof text==='string'&&isUrlRegex.test(text);}/**
 * Convert contents of a string to the correct JSON type. This can be a string,
 * a number, a boolean, etc
 */function stringConvert(str,parser){if(str===''){return'';}var strTrim=str.trim();if(strTrim==='null'){return null;}if(strTrim==='true'){return true;}if(strTrim==='false'){return false;}if(isNumber$1(strTrim)){return parser.parse(strTrim);}return str;}/**
 * Test whether a string contains a numeric, boolean, or null value.
 * Returns true when the string contains a number, boolean, or null.
 */function isStringContainingPrimitiveValue(str,parser){return typeof str==='string'&&typeof stringConvert(str,parser)!=='string';}/**
 * Test whether a string contains an integer number
 */function isInteger$1(value){return INTEGER_REGEX.test(value);}var INTEGER_REGEX=/^-?[0-9]+$/;/** Detect free variable `global` from Node.js. */var freeGlobal=(typeof global==="undefined"?"undefined":_typeof2(global))=='object'&&global&&global.Object===Object&&global;/** Detect free variable `self`. */var freeSelf=(typeof self==="undefined"?"undefined":_typeof2(self))=='object'&&self&&self.Object===Object&&self;/** Used as a reference to the global object. */var root=freeGlobal||freeSelf||Function('return this')();/** Built-in value references. */var Symbol$1=root.Symbol;/** Used for built-in method references. */var objectProto$s=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$p=objectProto$s.hasOwnProperty;/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */var nativeObjectToString$3=objectProto$s.toString;/** Built-in value references. */var symToStringTag$1=Symbol$1?Symbol$1.toStringTag:undefined;/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */function getRawTag(value){var isOwn=hasOwnProperty$p.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=undefined;var unmasked=true;}catch(e){}var result=nativeObjectToString$3.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag;}else{delete value[symToStringTag$1];}}return result;}/** Used for built-in method references. */var objectProto$r=Object.prototype;/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */var nativeObjectToString$2=objectProto$r.toString;/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */function objectToString(value){return nativeObjectToString$2.call(value);}/** `Object#toString` result references. */var nullTag='[object Null]',undefinedTag='[object Undefined]';/** Built-in value references. */var symToStringTag=Symbol$1?Symbol$1.toStringTag:undefined;/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag;}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value);}/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */function isObjectLike(value){return value!=null&&_typeof2(value)=='object';}/** `Object#toString` result references. */var symbolTag$3='[object Symbol]';/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */function isSymbol(value){return _typeof2(value)=='symbol'||isObjectLike(value)&&baseGetTag(value)==symbolTag$3;}/** Used as references for various `Number` constants. */var NAN$2=0/0;/**
 * The base implementation of `_.toNumber` which doesn't ensure correct
 * conversions of binary, hexadecimal, or octal string values.
 *
 * @private
 * @param {*} value The value to process.
 * @returns {number} Returns the number.
 */function baseToNumber(value){if(typeof value=='number'){return value;}if(isSymbol(value)){return NAN$2;}return+value;}/**
 * A specialized version of `_.map` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array);}return result;}/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */var isArray=Array.isArray;/** Used as references for various `Number` constants. */var INFINITY$5=1/0;/** Used to convert symbols to primitives and strings. */var symbolProto$2=Symbol$1?Symbol$1.prototype:undefined,symbolToString=symbolProto$2?symbolProto$2.toString:undefined;/**
 * The base implementation of `_.toString` which doesn't convert nullish
 * values to empty strings.
 *
 * @private
 * @param {*} value The value to process.
 * @returns {string} Returns the string.
 */function baseToString(value){// Exit early for strings to avoid a performance hit in some environments.
if(typeof value=='string'){return value;}if(isArray(value)){// Recursively convert values (susceptible to call stack limits).
return arrayMap(value,baseToString)+'';}if(isSymbol(value)){return symbolToString?symbolToString.call(value):'';}var result=value+'';return result=='0'&&1/value==-INFINITY$5?'-0':result;}/**
 * Creates a function that performs a mathematical operation on two values.
 *
 * @private
 * @param {Function} operator The function to perform the operation.
 * @param {number} [defaultValue] The value used for `undefined` arguments.
 * @returns {Function} Returns the new mathematical operation function.
 */function createMathOperation(operator,defaultValue){return function(value,other){var result;if(value===undefined&&other===undefined){return defaultValue;}if(value!==undefined){result=value;}if(other!==undefined){if(result===undefined){return other;}if(typeof value=='string'||typeof other=='string'){value=baseToString(value);other=baseToString(other);}else{value=baseToNumber(value);other=baseToNumber(other);}result=operator(value,other);}return result;};}/**
 * Adds two numbers.
 *
 * @static
 * @memberOf _
 * @since 3.4.0
 * @category Math
 * @param {number} augend The first number in an addition.
 * @param {number} addend The second number in an addition.
 * @returns {number} Returns the total.
 * @example
 *
 * _.add(6, 4);
 * // => 10
 */var add$1=createMathOperation(function(augend,addend){return augend+addend;},0);/** Used to match a single whitespace character. */var reWhitespace=/\s/;/**
 * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace
 * character of `string`.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {number} Returns the index of the last non-whitespace character.
 */function trimmedEndIndex(string){var index=string.length;while(index--&&reWhitespace.test(string.charAt(index))){}return index;}/** Used to match leading whitespace. */var reTrimStart$2=/^\s+/;/**
 * The base implementation of `_.trim`.
 *
 * @private
 * @param {string} string The string to trim.
 * @returns {string} Returns the trimmed string.
 */function baseTrim(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart$2,''):string;}/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */function isObject(value){var type=_typeof2(value);return value!=null&&(type=='object'||type=='function');}/** Used as references for various `Number` constants. */var NAN$1=0/0;/** Used to detect bad signed hexadecimal string values. */var reIsBadHex=/^[-+]0x[0-9a-f]+$/i;/** Used to detect binary string values. */var reIsBinary=/^0b[01]+$/i;/** Used to detect octal string values. */var reIsOctal=/^0o[0-7]+$/i;/** Built-in method references without a dependency on `root`. */var freeParseInt=parseInt;/**
 * Converts `value` to a number.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to process.
 * @returns {number} Returns the number.
 * @example
 *
 * _.toNumber(3.2);
 * // => 3.2
 *
 * _.toNumber(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toNumber(Infinity);
 * // => Infinity
 *
 * _.toNumber('3.2');
 * // => 3.2
 */function toNumber(value){if(typeof value=='number'){return value;}if(isSymbol(value)){return NAN$1;}if(isObject(value)){var other=typeof value.valueOf=='function'?value.valueOf():value;value=isObject(other)?other+'':other;}if(typeof value!='string'){return value===0?value:+value;}value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN$1:+value;}/** Used as references for various `Number` constants. */var INFINITY$4=1/0,MAX_INTEGER=1.7976931348623157e+308;/**
 * Converts `value` to a finite number.
 *
 * @static
 * @memberOf _
 * @since 4.12.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted number.
 * @example
 *
 * _.toFinite(3.2);
 * // => 3.2
 *
 * _.toFinite(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toFinite(Infinity);
 * // => 1.7976931348623157e+308
 *
 * _.toFinite('3.2');
 * // => 3.2
 */function toFinite(value){if(!value){return value===0?value:0;}value=toNumber(value);if(value===INFINITY$4||value===-INFINITY$4){var sign=value<0?-1:1;return sign*MAX_INTEGER;}return value===value?value:0;}/**
 * Converts `value` to an integer.
 *
 * **Note:** This method is loosely based on
 * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted integer.
 * @example
 *
 * _.toInteger(3.2);
 * // => 3
 *
 * _.toInteger(Number.MIN_VALUE);
 * // => 0
 *
 * _.toInteger(Infinity);
 * // => 1.7976931348623157e+308
 *
 * _.toInteger('3.2');
 * // => 3
 */function toInteger(value){var result=toFinite(value),remainder=result%1;return result===result?remainder?result-remainder:result:0;}/** Error message constants. */var FUNC_ERROR_TEXT$b='Expected a function';/**
 * The opposite of `_.before`; this method creates a function that invokes
 * `func` once it's called `n` or more times.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {number} n The number of calls before `func` is invoked.
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new restricted function.
 * @example
 *
 * var saves = ['profile', 'settings'];
 *
 * var done = _.after(saves.length, function() {
 *   console.log('done saving!');
 * });
 *
 * _.forEach(saves, function(type) {
 *   asyncSave({ 'type': type, 'complete': done });
 * });
 * // => Logs 'done saving!' after the two async saves have completed.
 */function after(n,func){if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$b);}n=toInteger(n);return function(){if(--n<1){return func.apply(this,arguments);}};}/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */function identity(value){return value;}/** `Object#toString` result references. */var asyncTag='[object AsyncFunction]',funcTag$2='[object Function]',genTag$1='[object GeneratorFunction]',proxyTag='[object Proxy]';/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */function isFunction(value){if(!isObject(value)){return false;}// The use of `Object#toString` avoids issues with the `typeof` operator
// in Safari 9 which returns 'object' for typed arrays and other constructors.
var tag=baseGetTag(value);return tag==funcTag$2||tag==genTag$1||tag==asyncTag||tag==proxyTag;}/** Used to detect overreaching core-js shims. */var coreJsData=root['__core-js_shared__'];/** Used to detect methods masquerading as native. */var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||'');return uid?'Symbol(src)_1.'+uid:'';}();/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */function isMasked(func){return!!maskSrcKey&&maskSrcKey in func;}/** Used for built-in method references. */var funcProto$2=Function.prototype;/** Used to resolve the decompiled source of functions. */var funcToString$2=funcProto$2.toString;/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to convert.
 * @returns {string} Returns the source code.
 */function toSource(func){if(func!=null){try{return funcToString$2.call(func);}catch(e){}try{return func+'';}catch(e){}}return'';}/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g;/** Used to detect host constructors (Safari). */var reIsHostCtor=/^\[object .+?Constructor\]$/;/** Used for built-in method references. */var funcProto$1=Function.prototype,objectProto$q=Object.prototype;/** Used to resolve the decompiled source of functions. */var funcToString$1=funcProto$1.toString;/** Used to check objects for own properties. */var hasOwnProperty$o=objectProto$q.hasOwnProperty;/** Used to detect if a method is native. */var reIsNative=RegExp('^'+funcToString$1.call(hasOwnProperty$o).replace(reRegExpChar$1,'\\$&').replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,'$1.*?')+'$');/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */function baseIsNative(value){if(!isObject(value)||isMasked(value)){return false;}var pattern=isFunction(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value));}/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */function getValue(object,key){return object==null?undefined:object[key];}/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:undefined;}/* Built-in method references that are verified to be native. */var WeakMap$1=getNative(root,'WeakMap');/** Used to store function metadata. */var metaMap=WeakMap$1&&new WeakMap$1();/**
 * The base implementation of `setData` without support for hot loop shorting.
 *
 * @private
 * @param {Function} func The function to associate metadata with.
 * @param {*} data The metadata.
 * @returns {Function} Returns `func`.
 */var baseSetData=!metaMap?identity:function(func,data){metaMap.set(func,data);return func;};/** Built-in value references. */var objectCreate=Object.create;/**
 * The base implementation of `_.create` without support for assigning
 * properties to the created object.
 *
 * @private
 * @param {Object} proto The object to inherit from.
 * @returns {Object} Returns the new object.
 */var baseCreate=function(){function object(){}return function(proto){if(!isObject(proto)){return{};}if(objectCreate){return objectCreate(proto);}object.prototype=proto;var result=new object();object.prototype=undefined;return result;};}();/**
 * Creates a function that produces an instance of `Ctor` regardless of
 * whether it was invoked as part of a `new` expression or by `call` or `apply`.
 *
 * @private
 * @param {Function} Ctor The constructor to wrap.
 * @returns {Function} Returns the new wrapped function.
 */function createCtor(Ctor){return function(){// Use a `switch` statement to work with class constructors. See
// http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist
// for more details.
var args=arguments;switch(args.length){case 0:return new Ctor();case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);// Mimic the constructor's `return` behavior.
// See https://es5.github.io/#x13.2.2 for more details.
return isObject(result)?result:thisBinding;};}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$8=1;/**
 * Creates a function that wraps `func` to invoke it with the optional `this`
 * binding of `thisArg`.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {*} [thisArg] The `this` binding of `func`.
 * @returns {Function} Returns the new wrapped function.
 */function createBind(func,bitmask,thisArg){var isBind=bitmask&WRAP_BIND_FLAG$8,Ctor=createCtor(func);function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,arguments);}return wrapper;}/**
 * A faster alternative to `Function#apply`, this function invokes `func`
 * with the `this` binding of `thisArg` and the arguments of `args`.
 *
 * @private
 * @param {Function} func The function to invoke.
 * @param {*} thisArg The `this` binding of `func`.
 * @param {Array} args The arguments to invoke `func` with.
 * @returns {*} Returns the result of `func`.
 */function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2]);}return func.apply(thisArg,args);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$g=Math.max;/**
 * Creates an array that is the composition of partially applied arguments,
 * placeholders, and provided arguments into a single array of arguments.
 *
 * @private
 * @param {Array} args The provided arguments.
 * @param {Array} partials The arguments to prepend to those provided.
 * @param {Array} holders The `partials` placeholder indexes.
 * @params {boolean} [isCurried] Specify composing for a curried function.
 * @returns {Array} Returns the new array of composed arguments.
 */function composeArgs(args,partials,holders,isCurried){var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax$g(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;while(++leftIndex<leftLength){result[leftIndex]=partials[leftIndex];}while(++argsIndex<holdersLength){if(isUncurried||argsIndex<argsLength){result[holders[argsIndex]]=args[argsIndex];}}while(rangeLength--){result[leftIndex++]=args[argsIndex++];}return result;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$f=Math.max;/**
 * This function is like `composeArgs` except that the arguments composition
 * is tailored for `_.partialRight`.
 *
 * @private
 * @param {Array} args The provided arguments.
 * @param {Array} partials The arguments to append to those provided.
 * @param {Array} holders The `partials` placeholder indexes.
 * @params {boolean} [isCurried] Specify composing for a curried function.
 * @returns {Array} Returns the new array of composed arguments.
 */function composeArgsRight(args,partials,holders,isCurried){var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax$f(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;while(++argsIndex<rangeLength){result[argsIndex]=args[argsIndex];}var offset=argsIndex;while(++rightIndex<rightLength){result[offset+rightIndex]=partials[rightIndex];}while(++holdersIndex<holdersLength){if(isUncurried||argsIndex<argsLength){result[offset+holders[holdersIndex]]=args[argsIndex++];}}return result;}/**
 * Gets the number of `placeholder` occurrences in `array`.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} placeholder The placeholder to search for.
 * @returns {number} Returns the placeholder count.
 */function countHolders(array,placeholder){var length=array.length,result=0;while(length--){if(array[length]===placeholder){++result;}}return result;}/**
 * The function whose prototype chain sequence wrappers inherit from.
 *
 * @private
 */function baseLodash(){// No operation performed.
}/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$6=4294967295;/**
 * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.
 *
 * @private
 * @constructor
 * @param {*} value The value to wrap.
 */function LazyWrapper(value){this.__wrapped__=value;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=MAX_ARRAY_LENGTH$6;this.__views__=[];}// Ensure `LazyWrapper` is an instance of `baseLodash`.
LazyWrapper.prototype=baseCreate(baseLodash.prototype);LazyWrapper.prototype.constructor=LazyWrapper;/**
 * This method returns `undefined`.
 *
 * @static
 * @memberOf _
 * @since 2.3.0
 * @category Util
 * @example
 *
 * _.times(2, _.noop);
 * // => [undefined, undefined]
 */function noop(){// No operation performed.
}/**
 * Gets metadata for `func`.
 *
 * @private
 * @param {Function} func The function to query.
 * @returns {*} Returns the metadata for `func`.
 */var getData=!metaMap?noop:function(func){return metaMap.get(func);};/** Used to lookup unminified function names. */var realNames={};/** Used for built-in method references. */var objectProto$p=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$n=objectProto$p.hasOwnProperty;/**
 * Gets the name of `func`.
 *
 * @private
 * @param {Function} func The function to query.
 * @returns {string} Returns the function name.
 */function getFuncName(func){var result=func.name+'',array=realNames[result],length=hasOwnProperty$n.call(realNames,result)?array.length:0;while(length--){var data=array[length],otherFunc=data.func;if(otherFunc==null||otherFunc==func){return data.name;}}return result;}/**
 * The base constructor for creating `lodash` wrapper objects.
 *
 * @private
 * @param {*} value The value to wrap.
 * @param {boolean} [chainAll] Enable explicit method chain sequences.
 */function LodashWrapper(value,chainAll){this.__wrapped__=value;this.__actions__=[];this.__chain__=!!chainAll;this.__index__=0;this.__values__=undefined;}LodashWrapper.prototype=baseCreate(baseLodash.prototype);LodashWrapper.prototype.constructor=LodashWrapper;/**
 * Copies the values of `source` to `array`.
 *
 * @private
 * @param {Array} source The array to copy values from.
 * @param {Array} [array=[]] The array to copy values to.
 * @returns {Array} Returns `array`.
 */function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index];}return array;}/**
 * Creates a clone of `wrapper`.
 *
 * @private
 * @param {Object} wrapper The wrapper to clone.
 * @returns {Object} Returns the cloned wrapper.
 */function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper){return wrapper.clone();}var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);result.__actions__=copyArray(wrapper.__actions__);result.__index__=wrapper.__index__;result.__values__=wrapper.__values__;return result;}/** Used for built-in method references. */var objectProto$o=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$m=objectProto$o.hasOwnProperty;/**
 * Creates a `lodash` object which wraps `value` to enable implicit method
 * chain sequences. Methods that operate on and return arrays, collections,
 * and functions can be chained together. Methods that retrieve a single value
 * or may return a primitive value will automatically end the chain sequence
 * and return the unwrapped value. Otherwise, the value must be unwrapped
 * with `_#value`.
 *
 * Explicit chain sequences, which must be unwrapped with `_#value`, may be
 * enabled using `_.chain`.
 *
 * The execution of chained methods is lazy, that is, it's deferred until
 * `_#value` is implicitly or explicitly called.
 *
 * Lazy evaluation allows several methods to support shortcut fusion.
 * Shortcut fusion is an optimization to merge iteratee calls; this avoids
 * the creation of intermediate arrays and can greatly reduce the number of
 * iteratee executions. Sections of a chain sequence qualify for shortcut
 * fusion if the section is applied to an array and iteratees accept only
 * one argument. The heuristic for whether a section qualifies for shortcut
 * fusion is subject to change.
 *
 * Chaining is supported in custom builds as long as the `_#value` method is
 * directly or indirectly included in the build.
 *
 * In addition to lodash methods, wrappers have `Array` and `String` methods.
 *
 * The wrapper `Array` methods are:
 * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`
 *
 * The wrapper `String` methods are:
 * `replace` and `split`
 *
 * The wrapper methods that support shortcut fusion are:
 * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,
 * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,
 * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`
 *
 * The chainable wrapper methods are:
 * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,
 * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,
 * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,
 * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,
 * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,
 * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,
 * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,
 * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,
 * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,
 * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,
 * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,
 * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,
 * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,
 * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,
 * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,
 * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,
 * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,
 * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,
 * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,
 * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,
 * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,
 * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,
 * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,
 * `zipObject`, `zipObjectDeep`, and `zipWith`
 *
 * The wrapper methods that are **not** chainable by default are:
 * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,
 * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,
 * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,
 * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,
 * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,
 * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,
 * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,
 * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,
 * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,
 * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,
 * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,
 * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,
 * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,
 * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,
 * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,
 * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,
 * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,
 * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,
 * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,
 * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,
 * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,
 * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,
 * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,
 * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,
 * `upperFirst`, `value`, and `words`
 *
 * @name _
 * @constructor
 * @category Seq
 * @param {*} value The value to wrap in a `lodash` instance.
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * var wrapped = _([1, 2, 3]);
 *
 * // Returns an unwrapped value.
 * wrapped.reduce(_.add);
 * // => 6
 *
 * // Returns a wrapped value.
 * var squares = wrapped.map(square);
 *
 * _.isArray(squares);
 * // => false
 *
 * _.isArray(squares.value());
 * // => true
 */function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper){return value;}if(hasOwnProperty$m.call(value,'__wrapped__')){return wrapperClone(value);}}return new LodashWrapper(value);}// Ensure wrappers are instances of `baseLodash`.
lodash.prototype=baseLodash.prototype;lodash.prototype.constructor=lodash;/**
 * Checks if `func` has a lazy counterpart.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` has a lazy counterpart,
 *  else `false`.
 */function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if(typeof other!='function'||!(funcName in LazyWrapper.prototype)){return false;}if(func===other){return true;}var data=getData(other);return!!data&&func===data[0];}/** Used to detect hot functions by number of calls within a span of milliseconds. */var HOT_COUNT=800,HOT_SPAN=16;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeNow=Date.now;/**
 * Creates a function that'll short out and invoke `identity` instead
 * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`
 * milliseconds.
 *
 * @private
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new shortable function.
 */function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return arguments[0];}}else{count=0;}return func.apply(undefined,arguments);};}/**
 * Sets metadata for `func`.
 *
 * **Note:** If this function becomes hot, i.e. is invoked a lot in a short
 * period of time, it will trip its breaker and transition to an identity
 * function to avoid garbage collection pauses in V8. See
 * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)
 * for more details.
 *
 * @private
 * @param {Function} func The function to associate metadata with.
 * @param {*} data The metadata.
 * @returns {Function} Returns `func`.
 */var setData=shortOut(baseSetData);/** Used to match wrap detail comments. */var reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;/**
 * Extracts wrapper details from the `source` body comment.
 *
 * @private
 * @param {string} source The source to inspect.
 * @returns {Array} Returns the wrapper details.
 */function getWrapDetails(source){var match=source.match(reWrapDetails);return match?match[1].split(reSplitDetails):[];}/** Used to match wrap detail comments. */var reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;/**
 * Inserts wrapper `details` in a comment at the top of the `source` body.
 *
 * @private
 * @param {string} source The source to modify.
 * @returns {Array} details The details to insert.
 * @returns {string} Returns the modified source.
 */function insertWrapDetails(source,details){var length=details.length;if(!length){return source;}var lastIndex=length-1;details[lastIndex]=(length>1?'& ':'')+details[lastIndex];details=details.join(length>2?', ':' ');return source.replace(reWrapComment,'{\n/* [wrapped with '+details+'] */\n');}/**
 * Creates a function that returns `value`.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {*} value The value to return from the new function.
 * @returns {Function} Returns the new constant function.
 * @example
 *
 * var objects = _.times(2, _.constant({ 'a': 1 }));
 *
 * console.log(objects);
 * // => [{ 'a': 1 }, { 'a': 1 }]
 *
 * console.log(objects[0] === objects[1]);
 * // => true
 */function constant(value){return function(){return value;};}var defineProperty=function(){try{var func=getNative(Object,'defineProperty');func({},'',{});return func;}catch(e){}}();/**
 * The base implementation of `setToString` without support for hot loop shorting.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */var baseSetToString=!defineProperty?identity:function(func,string){return defineProperty(func,'toString',{'configurable':true,'enumerable':false,'value':constant(string),'writable':true});};/**
 * Sets the `toString` method of `func` to return `string`.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */var setToString=shortOut(baseSetToString);/**
 * A specialized version of `_.forEach` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns `array`.
 */function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break;}}return array;}/**
 * The base implementation of `_.findIndex` and `_.findLastIndex` without
 * support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Function} predicate The function invoked per iteration.
 * @param {number} fromIndex The index to search from.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index;}}return-1;}/**
 * The base implementation of `_.isNaN` without support for number objects.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
 */function baseIsNaN(value){return value!==value;}/**
 * A specialized version of `_.indexOf` which performs strict equality
 * comparisons of values, i.e. `===`.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index;}}return-1;}/**
 * The base implementation of `_.indexOf` without `fromIndex` bounds checks.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex);}/**
 * A specialized version of `_.includes` for arrays without support for
 * specifying an index to search from.
 *
 * @private
 * @param {Array} [array] The array to inspect.
 * @param {*} target The value to search for.
 * @returns {boolean} Returns `true` if `target` is found, else `false`.
 */function arrayIncludes(array,value){var length=array==null?0:array.length;return!!length&&baseIndexOf(array,value,0)>-1;}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$7=1,WRAP_BIND_KEY_FLAG$6=2,WRAP_CURRY_FLAG$6=8,WRAP_CURRY_RIGHT_FLAG$3=16,WRAP_PARTIAL_FLAG$6=32,WRAP_PARTIAL_RIGHT_FLAG$3=64,WRAP_ARY_FLAG$4=128,WRAP_REARG_FLAG$3=256,WRAP_FLIP_FLAG$2=512;/** Used to associate wrap methods with their bit flags. */var wrapFlags=[['ary',WRAP_ARY_FLAG$4],['bind',WRAP_BIND_FLAG$7],['bindKey',WRAP_BIND_KEY_FLAG$6],['curry',WRAP_CURRY_FLAG$6],['curryRight',WRAP_CURRY_RIGHT_FLAG$3],['flip',WRAP_FLIP_FLAG$2],['partial',WRAP_PARTIAL_FLAG$6],['partialRight',WRAP_PARTIAL_RIGHT_FLAG$3],['rearg',WRAP_REARG_FLAG$3]];/**
 * Updates wrapper `details` based on `bitmask` flags.
 *
 * @private
 * @returns {Array} details The details to modify.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @returns {Array} Returns `details`.
 */function updateWrapDetails(details,bitmask){arrayEach(wrapFlags,function(pair){var value='_.'+pair[0];if(bitmask&pair[1]&&!arrayIncludes(details,value)){details.push(value);}});return details.sort();}/**
 * Sets the `toString` method of `wrapper` to mimic the source of `reference`
 * with wrapper details in a comment at the top of the source body.
 *
 * @private
 * @param {Function} wrapper The function to modify.
 * @param {Function} reference The reference function.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @returns {Function} Returns `wrapper`.
 */function setWrapToString(wrapper,reference,bitmask){var source=reference+'';return setToString(wrapper,insertWrapDetails(source,updateWrapDetails(getWrapDetails(source),bitmask)));}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$6=1,WRAP_BIND_KEY_FLAG$5=2,WRAP_CURRY_BOUND_FLAG$1=4,WRAP_CURRY_FLAG$5=8,WRAP_PARTIAL_FLAG$5=32,WRAP_PARTIAL_RIGHT_FLAG$2=64;/**
 * Creates a function that wraps `func` to continue currying.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {Function} wrapFunc The function to create the `func` wrapper.
 * @param {*} placeholder The placeholder value.
 * @param {*} [thisArg] The `this` binding of `func`.
 * @param {Array} [partials] The arguments to prepend to those provided to
 *  the new function.
 * @param {Array} [holders] The `partials` placeholder indexes.
 * @param {Array} [argPos] The argument positions of the new function.
 * @param {number} [ary] The arity cap of `func`.
 * @param {number} [arity] The arity of `func`.
 * @returns {Function} Returns the new wrapped function.
 */function createRecurry(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=bitmask&WRAP_CURRY_FLAG$5,newHolders=isCurry?holders:undefined,newHoldersRight=isCurry?undefined:holders,newPartials=isCurry?partials:undefined,newPartialsRight=isCurry?undefined:partials;bitmask|=isCurry?WRAP_PARTIAL_FLAG$5:WRAP_PARTIAL_RIGHT_FLAG$2;bitmask&=~(isCurry?WRAP_PARTIAL_RIGHT_FLAG$2:WRAP_PARTIAL_FLAG$5);if(!(bitmask&WRAP_CURRY_BOUND_FLAG$1)){bitmask&=~(WRAP_BIND_FLAG$6|WRAP_BIND_KEY_FLAG$5);}var newData=[func,bitmask,thisArg,newPartials,newHolders,newPartialsRight,newHoldersRight,argPos,ary,arity];var result=wrapFunc.apply(undefined,newData);if(isLaziable(func)){setData(result,newData);}result.placeholder=placeholder;return setWrapToString(result,func,bitmask);}/**
 * Gets the argument placeholder value for `func`.
 *
 * @private
 * @param {Function} func The function to inspect.
 * @returns {*} Returns the placeholder value.
 */function getHolder(func){var object=func;return object.placeholder;}/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER$5=9007199254740991;/** Used to detect unsigned integer values. */var reIsUint=/^(?:0|[1-9]\d*)$/;/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */function isIndex(value,length){var type=_typeof2(value);length=length==null?MAX_SAFE_INTEGER$5:length;return!!length&&(type=='number'||type!='symbol'&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$e=Math.min;/**
 * Reorder `array` according to the specified indexes where the element at
 * the first index is assigned as the first element, the element at
 * the second index is assigned as the second element, and so on.
 *
 * @private
 * @param {Array} array The array to reorder.
 * @param {Array} indexes The arranged array indexes.
 * @returns {Array} Returns `array`.
 */function reorder(array,indexes){var arrLength=array.length,length=nativeMin$e(indexes.length,arrLength),oldArray=copyArray(array);while(length--){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined;}return array;}/** Used as the internal argument placeholder. */var PLACEHOLDER$1='__lodash_placeholder__';/**
 * Replaces all `placeholder` elements in `array` with an internal placeholder
 * and returns an array of their indexes.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {*} placeholder The placeholder to replace.
 * @returns {Array} Returns the new array of placeholder indexes.
 */function replaceHolders(array,placeholder){var index=-1,length=array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(value===placeholder||value===PLACEHOLDER$1){array[index]=PLACEHOLDER$1;result[resIndex++]=index;}}return result;}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$5=1,WRAP_BIND_KEY_FLAG$4=2,WRAP_CURRY_FLAG$4=8,WRAP_CURRY_RIGHT_FLAG$2=16,WRAP_ARY_FLAG$3=128,WRAP_FLIP_FLAG$1=512;/**
 * Creates a function that wraps `func` to invoke it with optional `this`
 * binding of `thisArg`, partial application, and currying.
 *
 * @private
 * @param {Function|string} func The function or method name to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {*} [thisArg] The `this` binding of `func`.
 * @param {Array} [partials] The arguments to prepend to those provided to
 *  the new function.
 * @param {Array} [holders] The `partials` placeholder indexes.
 * @param {Array} [partialsRight] The arguments to append to those provided
 *  to the new function.
 * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.
 * @param {Array} [argPos] The argument positions of the new function.
 * @param {number} [ary] The arity cap of `func`.
 * @param {number} [arity] The arity of `func`.
 * @returns {Function} Returns the new wrapped function.
 */function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=bitmask&WRAP_ARY_FLAG$3,isBind=bitmask&WRAP_BIND_FLAG$5,isBindKey=bitmask&WRAP_BIND_KEY_FLAG$4,isCurried=bitmask&(WRAP_CURRY_FLAG$4|WRAP_CURRY_RIGHT_FLAG$2),isFlip=bitmask&WRAP_FLIP_FLAG$1,Ctor=isBindKey?undefined:createCtor(func);function wrapper(){var length=arguments.length,args=Array(length),index=length;while(index--){args[index]=arguments[index];}if(isCurried){var placeholder=getHolder(wrapper),holdersCount=countHolders(args,placeholder);}if(partials){args=composeArgs(args,partials,holders,isCurried);}if(partialsRight){args=composeArgsRight(args,partialsRight,holdersRight,isCurried);}length-=holdersCount;if(isCurried&&length<arity){var newHolders=replaceHolders(args,placeholder);return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,newHolders,argPos,ary,arity-length);}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;length=args.length;if(argPos){args=reorder(args,argPos);}else if(isFlip&&length>1){args.reverse();}if(isAry&&ary<length){args.length=ary;}if(this&&this!==root&&this instanceof wrapper){fn=Ctor||createCtor(fn);}return fn.apply(thisBinding,args);}return wrapper;}/**
 * Creates a function that wraps `func` to enable currying.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {number} arity The arity of `func`.
 * @returns {Function} Returns the new wrapped function.
 */function createCurry(func,bitmask,arity){var Ctor=createCtor(func);function wrapper(){var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);while(index--){args[index]=arguments[index];}var holders=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);length-=holders.length;if(length<arity){return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,undefined,args,holders,undefined,undefined,arity-length);}var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return apply(fn,this,args);}return wrapper;}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$4=1;/**
 * Creates a function that wraps `func` to invoke it with the `this` binding
 * of `thisArg` and `partials` prepended to the arguments it receives.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
 * @param {*} thisArg The `this` binding of `func`.
 * @param {Array} partials The arguments to prepend to those provided to
 *  the new function.
 * @returns {Function} Returns the new wrapped function.
 */function createPartial(func,bitmask,thisArg,partials){var isBind=bitmask&WRAP_BIND_FLAG$4,Ctor=createCtor(func);function wrapper(){var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;while(++leftIndex<leftLength){args[leftIndex]=partials[leftIndex];}while(argsLength--){args[leftIndex++]=arguments[++argsIndex];}return apply(fn,isBind?thisArg:this,args);}return wrapper;}/** Used as the internal argument placeholder. */var PLACEHOLDER='__lodash_placeholder__';/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$3=1,WRAP_BIND_KEY_FLAG$3=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG$3=8,WRAP_ARY_FLAG$2=128,WRAP_REARG_FLAG$2=256;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$d=Math.min;/**
 * Merges the function metadata of `source` into `data`.
 *
 * Merging metadata reduces the number of wrappers used to invoke a function.
 * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`
 * may be applied regardless of execution order. Methods like `_.ary` and
 * `_.rearg` modify function arguments, making the order in which they are
 * executed important, preventing the merging of metadata. However, we make
 * an exception for a safe combined case where curried functions have `_.ary`
 * and or `_.rearg` applied.
 *
 * @private
 * @param {Array} data The destination metadata.
 * @param {Array} source The source metadata.
 * @returns {Array} Returns `data`.
 */function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<(WRAP_BIND_FLAG$3|WRAP_BIND_KEY_FLAG$3|WRAP_ARY_FLAG$2);var isCombo=srcBitmask==WRAP_ARY_FLAG$2&&bitmask==WRAP_CURRY_FLAG$3||srcBitmask==WRAP_ARY_FLAG$2&&bitmask==WRAP_REARG_FLAG$2&&data[7].length<=source[8]||srcBitmask==(WRAP_ARY_FLAG$2|WRAP_REARG_FLAG$2)&&source[7].length<=source[8]&&bitmask==WRAP_CURRY_FLAG$3;// Exit early if metadata can't be merged.
if(!(isCommon||isCombo)){return data;}// Use source `thisArg` if available.
if(srcBitmask&WRAP_BIND_FLAG$3){data[2]=source[2];// Set when currying a bound function.
newBitmask|=bitmask&WRAP_BIND_FLAG$3?0:WRAP_CURRY_BOUND_FLAG;}// Compose partial arguments.
var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):value;data[4]=partials?replaceHolders(data[3],PLACEHOLDER):source[4];}// Compose partial right arguments.
value=source[5];if(value){partials=data[5];data[5]=partials?composeArgsRight(partials,value,source[6]):value;data[6]=partials?replaceHolders(data[5],PLACEHOLDER):source[6];}// Use source `argPos` if available.
value=source[7];if(value){data[7]=value;}// Use source `ary` if it's smaller.
if(srcBitmask&WRAP_ARY_FLAG$2){data[8]=data[8]==null?source[8]:nativeMin$d(data[8],source[8]);}// Use source `arity` if one is not provided.
if(data[9]==null){data[9]=source[9];}// Use source `func` and merge bitmasks.
data[0]=source[0];data[1]=newBitmask;return data;}/** Error message constants. */var FUNC_ERROR_TEXT$a='Expected a function';/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$2=1,WRAP_BIND_KEY_FLAG$2=2,WRAP_CURRY_FLAG$2=8,WRAP_CURRY_RIGHT_FLAG$1=16,WRAP_PARTIAL_FLAG$4=32,WRAP_PARTIAL_RIGHT_FLAG$1=64;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$e=Math.max;/**
 * Creates a function that either curries or invokes `func` with optional
 * `this` binding and partially applied arguments.
 *
 * @private
 * @param {Function|string} func The function or method name to wrap.
 * @param {number} bitmask The bitmask flags.
 *    1 - `_.bind`
 *    2 - `_.bindKey`
 *    4 - `_.curry` or `_.curryRight` of a bound function
 *    8 - `_.curry`
 *   16 - `_.curryRight`
 *   32 - `_.partial`
 *   64 - `_.partialRight`
 *  128 - `_.rearg`
 *  256 - `_.ary`
 *  512 - `_.flip`
 * @param {*} [thisArg] The `this` binding of `func`.
 * @param {Array} [partials] The arguments to be partially applied.
 * @param {Array} [holders] The `partials` placeholder indexes.
 * @param {Array} [argPos] The argument positions of the new function.
 * @param {number} [ary] The arity cap of `func`.
 * @param {number} [arity] The arity of `func`.
 * @returns {Function} Returns the new wrapped function.
 */function createWrap(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&WRAP_BIND_KEY_FLAG$2;if(!isBindKey&&typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$a);}var length=partials?partials.length:0;if(!length){bitmask&=~(WRAP_PARTIAL_FLAG$4|WRAP_PARTIAL_RIGHT_FLAG$1);partials=holders=undefined;}ary=ary===undefined?ary:nativeMax$e(toInteger(ary),0);arity=arity===undefined?arity:toInteger(arity);length-=holders?holders.length:0;if(bitmask&WRAP_PARTIAL_RIGHT_FLAG$1){var partialsRight=partials,holdersRight=holders;partials=holders=undefined;}var data=isBindKey?undefined:getData(func);var newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data){mergeData(newData,data);}func=newData[0];bitmask=newData[1];thisArg=newData[2];partials=newData[3];holders=newData[4];arity=newData[9]=newData[9]===undefined?isBindKey?0:func.length:nativeMax$e(newData[9]-length,0);if(!arity&&bitmask&(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1)){bitmask&=~(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1);}if(!bitmask||bitmask==WRAP_BIND_FLAG$2){var result=createBind(func,bitmask,thisArg);}else if(bitmask==WRAP_CURRY_FLAG$2||bitmask==WRAP_CURRY_RIGHT_FLAG$1){result=createCurry(func,bitmask,arity);}else if((bitmask==WRAP_PARTIAL_FLAG$4||bitmask==(WRAP_BIND_FLAG$2|WRAP_PARTIAL_FLAG$4))&&!holders.length){result=createPartial(func,bitmask,thisArg,partials);}else{result=createHybrid.apply(undefined,newData);}var setter=data?baseSetData:setData;return setWrapToString(setter(result,newData),func,bitmask);}/** Used to compose bitmasks for function metadata. */var WRAP_ARY_FLAG$1=128;/**
 * Creates a function that invokes `func`, with up to `n` arguments,
 * ignoring any additional arguments.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Function
 * @param {Function} func The function to cap arguments for.
 * @param {number} [n=func.length] The arity cap.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Function} Returns the new capped function.
 * @example
 *
 * _.map(['6', '8', '10'], _.ary(parseInt, 1));
 * // => [6, 8, 10]
 */function ary(func,n,guard){n=guard?undefined:n;n=func&&n==null?func.length:n;return createWrap(func,WRAP_ARY_FLAG$1,undefined,undefined,undefined,undefined,n);}/**
 * The base implementation of `assignValue` and `assignMergeValue` without
 * value checks.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */function baseAssignValue(object,key,value){if(key=='__proto__'&&defineProperty){defineProperty(object,key,{'configurable':true,'enumerable':true,'value':value,'writable':true});}else{object[key]=value;}}/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */function eq(value,other){return value===other||value!==value&&other!==other;}/** Used for built-in method references. */var objectProto$n=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$l=objectProto$n.hasOwnProperty;/**
 * Assigns `value` to `key` of `object` if the existing value is not equivalent
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty$l.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value);}}/**
 * Copies properties of `source` to `object`.
 *
 * @private
 * @param {Object} source The object to copy properties from.
 * @param {Array} props The property identifiers to copy.
 * @param {Object} [object={}] The object to copy properties to.
 * @param {Function} [customizer] The function to customize copied values.
 * @returns {Object} Returns `object`.
 */function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key];}if(isNew){baseAssignValue(object,key,newValue);}else{assignValue(object,key,newValue);}}return object;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$d=Math.max;/**
 * A specialized version of `baseRest` which transforms the rest array.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @param {Function} transform The rest array transform.
 * @returns {Function} Returns the new function.
 */function overRest(func,start,transform){start=nativeMax$d(start===undefined?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax$d(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index];}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index];}otherArgs[start]=transform(array);return apply(func,this,otherArgs);};}/**
 * The base implementation of `_.rest` which doesn't validate or coerce arguments.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @returns {Function} Returns the new function.
 */function baseRest(func,start){return setToString(overRest(func,start,identity),func+'');}/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER$4=9007199254740991;/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */function isLength(value){return typeof value=='number'&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER$4;}/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction(value);}/**
 * Checks if the given arguments are from an iteratee call.
 *
 * @private
 * @param {*} value The potential iteratee value argument.
 * @param {*} index The potential iteratee index or key argument.
 * @param {*} object The potential iteratee object argument.
 * @returns {boolean} Returns `true` if the arguments are from an iteratee call,
 *  else `false`.
 */function isIterateeCall(value,index,object){if(!isObject(object)){return false;}var type=_typeof2(index);if(type=='number'?isArrayLike(object)&&isIndex(index,object.length):type=='string'&&index in object){return eq(object[index],value);}return false;}/**
 * Creates a function like `_.assign`.
 *
 * @private
 * @param {Function} assigner The function to assign values.
 * @returns {Function} Returns the new assigner function.
 */function createAssigner(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;customizer=assigner.length>3&&typeof customizer=='function'?(length--,customizer):undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1;}object=Object(object);while(++index<length){var source=sources[index];if(source){assigner(object,source,index,customizer);}}return object;});}/** Used for built-in method references. */var objectProto$m=Object.prototype;/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=='function'&&Ctor.prototype||objectProto$m;return value===proto;}/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index);}return result;}/** `Object#toString` result references. */var argsTag$3='[object Arguments]';/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag$3;}/** Used for built-in method references. */var objectProto$l=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$k=objectProto$l.hasOwnProperty;/** Built-in value references. */var propertyIsEnumerable$1=objectProto$l.propertyIsEnumerable;/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */var isArguments=baseIsArguments(function(){return arguments;}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$k.call(value,'callee')&&!propertyIsEnumerable$1.call(value,'callee');};/**
 * This method returns `false`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `false`.
 * @example
 *
 * _.times(2, _.stubFalse);
 * // => [false, false]
 */function stubFalse(){return false;}/** Detect free variable `exports`. */var freeExports$2=(typeof exports==="undefined"?"undefined":_typeof2(exports))=='object'&&exports&&!exports.nodeType&&exports;/** Detect free variable `module`. */var freeModule$2=freeExports$2&&(typeof module==="undefined"?"undefined":_typeof2(module))=='object'&&module&&!module.nodeType&&module;/** Detect the popular CommonJS extension `module.exports`. */var moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2;/** Built-in value references. */var Buffer$1=moduleExports$2?root.Buffer:undefined;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined;/**
 * Checks if `value` is a buffer.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
 * @example
 *
 * _.isBuffer(new Buffer(2));
 * // => true
 *
 * _.isBuffer(new Uint8Array(2));
 * // => false
 */var isBuffer=nativeIsBuffer||stubFalse;/** `Object#toString` result references. */var argsTag$2='[object Arguments]',arrayTag$2='[object Array]',boolTag$4='[object Boolean]',dateTag$4='[object Date]',errorTag$3='[object Error]',funcTag$1='[object Function]',mapTag$9='[object Map]',numberTag$4='[object Number]',objectTag$4='[object Object]',regexpTag$4='[object RegExp]',setTag$9='[object Set]',stringTag$4='[object String]',weakMapTag$3='[object WeakMap]';var arrayBufferTag$4='[object ArrayBuffer]',dataViewTag$4='[object DataView]',float32Tag$2='[object Float32Array]',float64Tag$2='[object Float64Array]',int8Tag$2='[object Int8Array]',int16Tag$2='[object Int16Array]',int32Tag$2='[object Int32Array]',uint8Tag$2='[object Uint8Array]',uint8ClampedTag$2='[object Uint8ClampedArray]',uint16Tag$2='[object Uint16Array]',uint32Tag$2='[object Uint32Array]';/** Used to identify `toStringTag` values of typed arrays. */var typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=true;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$4]=typedArrayTags[boolTag$4]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$4]=typedArrayTags[errorTag$3]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$9]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$4]=typedArrayTags[setTag$9]=typedArrayTags[stringTag$4]=typedArrayTags[weakMapTag$3]=false;/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)];}/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */function baseUnary(func){return function(value){return func(value);};}/** Detect free variable `exports`. */var freeExports$1=(typeof exports==="undefined"?"undefined":_typeof2(exports))=='object'&&exports&&!exports.nodeType&&exports;/** Detect free variable `module`. */var freeModule$1=freeExports$1&&(typeof module==="undefined"?"undefined":_typeof2(module))=='object'&&module&&!module.nodeType&&module;/** Detect the popular CommonJS extension `module.exports`. */var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;/** Detect free variable `process` from Node.js. */var freeProcess=moduleExports$1&&freeGlobal.process;/** Used to access faster Node.js helpers. */var nodeUtil=function(){try{// Use `util.types` for Node.js 10+.
var types=freeModule$1&&freeModule$1.require&&freeModule$1.require('util').types;if(types){return types;}// Legacy `process.binding('util')` for Node.js < 10.
return freeProcess&&freeProcess.binding&&freeProcess.binding('util');}catch(e){}}();/* Node.js helper references. */var nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;/** Used for built-in method references. */var objectProto$k=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$j=objectProto$k.hasOwnProperty;/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$j.call(value,key))&&!(skipIndexes&&(// Safari 9 has enumerable `arguments.length` in strict mode.
key=='length'||// Node.js 0.10 has enumerable non-index properties on buffers.
isBuff&&(key=='offset'||key=='parent')||// PhantomJS 2 has enumerable non-index properties on typed arrays.
isType&&(key=='buffer'||key=='byteLength'||key=='byteOffset')||// Skip index properties.
isIndex(key,length)))){result.push(key);}}return result;}/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */function overArg(func,transform){return function(arg){return func(transform(arg));};}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeKeys=overArg(Object.keys,Object);/** Used for built-in method references. */var objectProto$j=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$i=objectProto$j.hasOwnProperty;/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object);}var result=[];for(var key in Object(object)){if(hasOwnProperty$i.call(object,key)&&key!='constructor'){result.push(key);}}return result;}/**
 * Creates an array of the own enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects. See the
 * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * for more details.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keys(new Foo);
 * // => ['a', 'b'] (iteration order is not guaranteed)
 *
 * _.keys('hi');
 * // => ['0', '1']
 */function keys$1(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object);}/** Used for built-in method references. */var objectProto$i=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$h=objectProto$i.hasOwnProperty;/**
 * Assigns own enumerable string keyed properties of source objects to the
 * destination object. Source objects are applied from left to right.
 * Subsequent sources overwrite property assignments of previous sources.
 *
 * **Note:** This method mutates `object` and is loosely based on
 * [`Object.assign`](https://mdn.io/Object/assign).
 *
 * @static
 * @memberOf _
 * @since 0.10.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @see _.assignIn
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * function Bar() {
 *   this.c = 3;
 * }
 *
 * Foo.prototype.b = 2;
 * Bar.prototype.d = 4;
 *
 * _.assign({ 'a': 0 }, new Foo, new Bar);
 * // => { 'a': 1, 'c': 3 }
 */var assign=createAssigner(function(object,source){if(isPrototype(source)||isArrayLike(source)){copyObject(source,keys$1(source),object);return;}for(var key in source){if(hasOwnProperty$h.call(source,key)){assignValue(object,key,source[key]);}}});/**
 * This function is like
 * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * except that it includes inherited enumerable properties.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key);}}return result;}/** Used for built-in method references. */var objectProto$h=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$g=objectProto$h.hasOwnProperty;/**
 * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */function baseKeysIn(object){if(!isObject(object)){return nativeKeysIn(object);}var isProto=isPrototype(object),result=[];for(var key in object){if(!(key=='constructor'&&(isProto||!hasOwnProperty$g.call(object,key)))){result.push(key);}}return result;}/**
 * Creates an array of the own and inherited enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keysIn(new Foo);
 * // => ['a', 'b', 'c'] (iteration order is not guaranteed)
 */function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object);}/**
 * This method is like `_.assign` except that it iterates over own and
 * inherited source properties.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @alias extend
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @see _.assign
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * function Bar() {
 *   this.c = 3;
 * }
 *
 * Foo.prototype.b = 2;
 * Bar.prototype.d = 4;
 *
 * _.assignIn({ 'a': 0 }, new Foo, new Bar);
 * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }
 */var assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object);});/**
 * This method is like `_.assignIn` except that it accepts `customizer`
 * which is invoked to produce the assigned values. If `customizer` returns
 * `undefined`, assignment is handled by the method instead. The `customizer`
 * is invoked with five arguments: (objValue, srcValue, key, object, source).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @alias extendWith
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} sources The source objects.
 * @param {Function} [customizer] The function to customize assigned values.
 * @returns {Object} Returns `object`.
 * @see _.assignWith
 * @example
 *
 * function customizer(objValue, srcValue) {
 *   return _.isUndefined(objValue) ? srcValue : objValue;
 * }
 *
 * var defaults = _.partialRight(_.assignInWith, customizer);
 *
 * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
 * // => { 'a': 1, 'b': 2 }
 */var assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer);});/**
 * This method is like `_.assign` except that it accepts `customizer`
 * which is invoked to produce the assigned values. If `customizer` returns
 * `undefined`, assignment is handled by the method instead. The `customizer`
 * is invoked with five arguments: (objValue, srcValue, key, object, source).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} sources The source objects.
 * @param {Function} [customizer] The function to customize assigned values.
 * @returns {Object} Returns `object`.
 * @see _.assignInWith
 * @example
 *
 * function customizer(objValue, srcValue) {
 *   return _.isUndefined(objValue) ? srcValue : objValue;
 * }
 *
 * var defaults = _.partialRight(_.assignWith, customizer);
 *
 * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
 * // => { 'a': 1, 'b': 2 }
 */var assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keys$1(source),object,customizer);});/** Used to match property names within property paths. */var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;/**
 * Checks if `value` is a property name and not a property path.
 *
 * @private
 * @param {*} value The value to check.
 * @param {Object} [object] The object to query keys on.
 * @returns {boolean} Returns `true` if `value` is a property name, else `false`.
 */function isKey(value,object){if(isArray(value)){return false;}var type=_typeof2(value);if(type=='number'||type=='symbol'||type=='boolean'||value==null||isSymbol(value)){return true;}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object);}/* Built-in method references that are verified to be native. */var nativeCreate=getNative(Object,'create');/**
 * Removes all key-value entries from the hash.
 *
 * @private
 * @name clear
 * @memberOf Hash
 */function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{};this.size=0;}/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result;}/** Used to stand-in for `undefined` hash values. */var HASH_UNDEFINED$2='__lodash_hash_undefined__';/** Used for built-in method references. */var objectProto$g=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$f=objectProto$g.hasOwnProperty;/**
 * Gets the hash value for `key`.
 *
 * @private
 * @name get
 * @memberOf Hash
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED$2?undefined:result;}return hasOwnProperty$f.call(data,key)?data[key]:undefined;}/** Used for built-in method references. */var objectProto$f=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$e=objectProto$f.hasOwnProperty;/**
 * Checks if a hash value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Hash
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */function hashHas(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty$e.call(data,key);}/** Used to stand-in for `undefined` hash values. */var HASH_UNDEFINED$1='__lodash_hash_undefined__';/**
 * Sets the hash `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Hash
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the hash instance.
 */function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED$1:value;return this;}/**
 * Creates a hash object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1]);}}// Add methods to `Hash`.
Hash.prototype.clear=hashClear;Hash.prototype['delete']=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;/**
 * Removes all key-value entries from the list cache.
 *
 * @private
 * @name clear
 * @memberOf ListCache
 */function listCacheClear(){this.__data__=[];this.size=0;}/**
 * Gets the index at which the `key` is found in `array` of key-value pairs.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} key The key to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length;}}return-1;}/** Used for built-in method references. */var arrayProto$5=Array.prototype;/** Built-in value references. */var splice$2=arrayProto$5.splice;/**
 * Removes `key` and its value from the list cache.
 *
 * @private
 * @name delete
 * @memberOf ListCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false;}var lastIndex=data.length-1;if(index==lastIndex){data.pop();}else{splice$2.call(data,index,1);}--this.size;return true;}/**
 * Gets the list cache value for `key`.
 *
 * @private
 * @name get
 * @memberOf ListCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1];}/**
 * Checks if a list cache value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf ListCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1;}/**
 * Sets the list cache `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf ListCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the list cache instance.
 */function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value]);}else{data[index][1]=value;}return this;}/**
 * Creates an list cache object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1]);}}// Add methods to `ListCache`.
ListCache.prototype.clear=listCacheClear;ListCache.prototype['delete']=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;/* Built-in method references that are verified to be native. */var Map$1=getNative(root,'Map');/**
 * Removes all key-value entries from the map.
 *
 * @private
 * @name clear
 * @memberOf MapCache
 */function mapCacheClear(){this.size=0;this.__data__={'hash':new Hash(),'map':new(Map$1||ListCache)(),'string':new Hash()};}/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */function isKeyable(value){var type=_typeof2(value);return type=='string'||type=='number'||type=='symbol'||type=='boolean'?value!=='__proto__':value===null;}/**
 * Gets the data for `map`.
 *
 * @private
 * @param {Object} map The map to query.
 * @param {string} key The reference key.
 * @returns {*} Returns the map data.
 */function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=='string'?'string':'hash']:data.map;}/**
 * Removes `key` and its value from the map.
 *
 * @private
 * @name delete
 * @memberOf MapCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */function mapCacheDelete(key){var result=getMapData(this,key)['delete'](key);this.size-=result?1:0;return result;}/**
 * Gets the map value for `key`.
 *
 * @private
 * @name get
 * @memberOf MapCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */function mapCacheGet(key){return getMapData(this,key).get(key);}/**
 * Checks if a map value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf MapCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */function mapCacheHas(key){return getMapData(this,key).has(key);}/**
 * Sets the map `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf MapCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the map cache instance.
 */function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this;}/**
 * Creates a map cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1]);}}// Add methods to `MapCache`.
MapCache.prototype.clear=mapCacheClear;MapCache.prototype['delete']=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;/** Error message constants. */var FUNC_ERROR_TEXT$9='Expected a function';/**
 * Creates a function that memoizes the result of `func`. If `resolver` is
 * provided, it determines the cache key for storing the result based on the
 * arguments provided to the memoized function. By default, the first argument
 * provided to the memoized function is used as the map cache key. The `func`
 * is invoked with the `this` binding of the memoized function.
 *
 * **Note:** The cache is exposed as the `cache` property on the memoized
 * function. Its creation may be customized by replacing the `_.memoize.Cache`
 * constructor with one whose instances implement the
 * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)
 * method interface of `clear`, `delete`, `get`, `has`, and `set`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to have its output memoized.
 * @param {Function} [resolver] The function to resolve the cache key.
 * @returns {Function} Returns the new memoized function.
 * @example
 *
 * var object = { 'a': 1, 'b': 2 };
 * var other = { 'c': 3, 'd': 4 };
 *
 * var values = _.memoize(_.values);
 * values(object);
 * // => [1, 2]
 *
 * values(other);
 * // => [3, 4]
 *
 * object.a = 2;
 * values(object);
 * // => [1, 2]
 *
 * // Modify the result cache.
 * values.cache.set(object, ['a', 'b']);
 * values(object);
 * // => ['a', 'b']
 *
 * // Replace `_.memoize.Cache`.
 * _.memoize.Cache = WeakMap;
 */function memoize(func,resolver){if(typeof func!='function'||resolver!=null&&typeof resolver!='function'){throw new TypeError(FUNC_ERROR_TEXT$9);}var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key);}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result;};memoized.cache=new(memoize.Cache||MapCache)();return memoized;}// Expose `MapCache`.
memoize.Cache=MapCache;/** Used as the maximum memoize cache size. */var MAX_MEMOIZE_SIZE=500;/**
 * A specialized version of `_.memoize` which clears the memoized function's
 * cache when it exceeds `MAX_MEMOIZE_SIZE`.
 *
 * @private
 * @param {Function} func The function to have its output memoized.
 * @returns {Function} Returns the new memoized function.
 */function memoizeCapped(func){var result=memoize(func,function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear();}return key;});var cache=result.cache;return result;}/** Used to match property names within property paths. */var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;/** Used to match backslashes in property paths. */var reEscapeChar=/\\(\\)?/g;/**
 * Converts `string` to a property path array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the property path array.
 */var stringToPath=memoizeCapped(function(string){var result=[];if(string.charCodeAt(0)===46/* . */){result.push('');}string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,'$1'):number||match);});return result;});/**
 * Converts `value` to a string. An empty string is returned for `null`
 * and `undefined` values. The sign of `-0` is preserved.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 * @example
 *
 * _.toString(null);
 * // => ''
 *
 * _.toString(-0);
 * // => '-0'
 *
 * _.toString([1, 2, 3]);
 * // => '1,2,3'
 */function toString(value){return value==null?'':baseToString(value);}/**
 * Casts `value` to a path array if it's not one.
 *
 * @private
 * @param {*} value The value to inspect.
 * @param {Object} [object] The object to query keys on.
 * @returns {Array} Returns the cast property path array.
 */function castPath(value,object){if(isArray(value)){return value;}return isKey(value,object)?[value]:stringToPath(toString(value));}/** Used as references for various `Number` constants. */var INFINITY$3=1/0;/**
 * Converts `value` to a string key if it's not a string or symbol.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {string|symbol} Returns the key.
 */function toKey(value){if(typeof value=='string'||isSymbol(value)){return value;}var result=value+'';return result=='0'&&1/value==-INFINITY$3?'-0':result;}/**
 * The base implementation of `_.get` without support for default values.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to get.
 * @returns {*} Returns the resolved value.
 */function baseGet(object,path){path=castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[toKey(path[index++])];}return index&&index==length?object:undefined;}/**
 * Gets the value at `path` of `object`. If the resolved value is
 * `undefined`, the `defaultValue` is returned in its place.
 *
 * @static
 * @memberOf _
 * @since 3.7.0
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to get.
 * @param {*} [defaultValue] The value returned for `undefined` resolved values.
 * @returns {*} Returns the resolved value.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
 *
 * _.get(object, 'a[0].b.c');
 * // => 3
 *
 * _.get(object, ['a', '0', 'b', 'c']);
 * // => 3
 *
 * _.get(object, 'a.b.c', 'default');
 * // => 'default'
 */function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,path);return result===undefined?defaultValue:result;}/**
 * The base implementation of `_.at` without support for individual paths.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {string[]} paths The property paths to pick.
 * @returns {Array} Returns the picked elements.
 */function baseAt(object,paths){var index=-1,length=paths.length,result=Array(length),skip=object==null;while(++index<length){result[index]=skip?undefined:get(object,paths[index]);}return result;}/**
 * Appends the elements of `values` to `array`.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {Array} values The values to append.
 * @returns {Array} Returns `array`.
 */function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index];}return array;}/** Built-in value references. */var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:undefined;/**
 * Checks if `value` is a flattenable `arguments` object or array.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.
 */function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol]);}/**
 * The base implementation of `_.flatten` with support for restricting flattening.
 *
 * @private
 * @param {Array} array The array to flatten.
 * @param {number} depth The maximum recursion depth.
 * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.
 * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.
 * @param {Array} [result=[]] The initial result value.
 * @returns {Array} Returns the new flattened array.
 */function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;predicate||(predicate=isFlattenable);result||(result=[]);while(++index<length){var value=array[index];if(depth>0&&predicate(value)){if(depth>1){// Recursively flatten arrays (susceptible to call stack limits).
baseFlatten(value,depth-1,predicate,isStrict,result);}else{arrayPush(result,value);}}else if(!isStrict){result[result.length]=value;}}return result;}/**
 * Flattens `array` a single level deep.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to flatten.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * _.flatten([1, [2, [3, [4]], 5]]);
 * // => [1, 2, [3, [4]], 5]
 */function flatten$1(array){var length=array==null?0:array.length;return length?baseFlatten(array,1):[];}/**
 * A specialized version of `baseRest` which flattens the rest array.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @returns {Function} Returns the new function.
 */function flatRest(func){return setToString(overRest(func,undefined,flatten$1),func+'');}/**
 * Creates an array of values corresponding to `paths` of `object`.
 *
 * @static
 * @memberOf _
 * @since 1.0.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {...(string|string[])} [paths] The property paths to pick.
 * @returns {Array} Returns the picked values.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };
 *
 * _.at(object, ['a[0].b.c', 'a[1]']);
 * // => [3, 4]
 */var at=flatRest(baseAt);/** Built-in value references. */var getPrototype=overArg(Object.getPrototypeOf,Object);/** `Object#toString` result references. */var objectTag$3='[object Object]';/** Used for built-in method references. */var funcProto=Function.prototype,objectProto$e=Object.prototype;/** Used to resolve the decompiled source of functions. */var funcToString=funcProto.toString;/** Used to check objects for own properties. */var hasOwnProperty$d=objectProto$e.hasOwnProperty;/** Used to infer the `Object` constructor. */var objectCtorString=funcToString.call(Object);/**
 * Checks if `value` is a plain object, that is, an object created by the
 * `Object` constructor or one with a `[[Prototype]]` of `null`.
 *
 * @static
 * @memberOf _
 * @since 0.8.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * _.isPlainObject(new Foo);
 * // => false
 *
 * _.isPlainObject([1, 2, 3]);
 * // => false
 *
 * _.isPlainObject({ 'x': 0, 'y': 0 });
 * // => true
 *
 * _.isPlainObject(Object.create(null));
 * // => true
 */function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag$3){return false;}var proto=getPrototype(value);if(proto===null){return true;}var Ctor=hasOwnProperty$d.call(proto,'constructor')&&proto.constructor;return typeof Ctor=='function'&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString;}/** `Object#toString` result references. */var domExcTag='[object DOMException]',errorTag$2='[object Error]';/**
 * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,
 * `SyntaxError`, `TypeError`, or `URIError` object.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an error object, else `false`.
 * @example
 *
 * _.isError(new Error);
 * // => true
 *
 * _.isError(Error);
 * // => false
 */function isError(value){if(!isObjectLike(value)){return false;}var tag=baseGetTag(value);return tag==errorTag$2||tag==domExcTag||typeof value.message=='string'&&typeof value.name=='string'&&!isPlainObject(value);}/**
 * Attempts to invoke `func`, returning either the result or the caught error
 * object. Any additional arguments are provided to `func` when it's invoked.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Util
 * @param {Function} func The function to attempt.
 * @param {...*} [args] The arguments to invoke `func` with.
 * @returns {*} Returns the `func` result or error object.
 * @example
 *
 * // Avoid throwing errors for invalid selectors.
 * var elements = _.attempt(function(selector) {
 *   return document.querySelectorAll(selector);
 * }, '>_>');
 *
 * if (_.isError(elements)) {
 *   elements = [];
 * }
 */var attempt=baseRest(function(func,args){try{return apply(func,undefined,args);}catch(e){return isError(e)?e:new Error(e);}});/** Error message constants. */var FUNC_ERROR_TEXT$8='Expected a function';/**
 * Creates a function that invokes `func`, with the `this` binding and arguments
 * of the created function, while it's called less than `n` times. Subsequent
 * calls to the created function return the result of the last `func` invocation.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Function
 * @param {number} n The number of calls at which `func` is no longer invoked.
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new restricted function.
 * @example
 *
 * jQuery(element).on('click', _.before(5, addContactToList));
 * // => Allows adding up to 4 contacts to the list.
 */function before(n,func){var result;if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$8);}n=toInteger(n);return function(){if(--n>0){result=func.apply(this,arguments);}if(n<=1){func=undefined;}return result;};}/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG$1=1,WRAP_PARTIAL_FLAG$3=32;/**
 * Creates a function that invokes `func` with the `this` binding of `thisArg`
 * and `partials` prepended to the arguments it receives.
 *
 * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,
 * may be used as a placeholder for partially applied arguments.
 *
 * **Note:** Unlike native `Function#bind`, this method doesn't set the "length"
 * property of bound functions.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to bind.
 * @param {*} thisArg The `this` binding of `func`.
 * @param {...*} [partials] The arguments to be partially applied.
 * @returns {Function} Returns the new bound function.
 * @example
 *
 * function greet(greeting, punctuation) {
 *   return greeting + ' ' + this.user + punctuation;
 * }
 *
 * var object = { 'user': 'fred' };
 *
 * var bound = _.bind(greet, object, 'hi');
 * bound('!');
 * // => 'hi fred!'
 *
 * // Bound with placeholders.
 * var bound = _.bind(greet, object, _, '!');
 * bound('hi');
 * // => 'hi fred!'
 */var bind=baseRest(function(func,thisArg,partials){var bitmask=WRAP_BIND_FLAG$1;if(partials.length){var holders=replaceHolders(partials,getHolder(bind));bitmask|=WRAP_PARTIAL_FLAG$3;}return createWrap(func,bitmask,thisArg,partials,holders);});// Assign default placeholders.
bind.placeholder={};/**
 * Binds methods of an object to the object itself, overwriting the existing
 * method.
 *
 * **Note:** This method doesn't set the "length" property of bound functions.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {Object} object The object to bind and assign the bound methods to.
 * @param {...(string|string[])} methodNames The object method names to bind.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var view = {
 *   'label': 'docs',
 *   'click': function() {
 *     console.log('clicked ' + this.label);
 *   }
 * };
 *
 * _.bindAll(view, ['click']);
 * jQuery(element).on('click', view.click);
 * // => Logs 'clicked docs' when clicked.
 */var bindAll=flatRest(function(object,methodNames){arrayEach(methodNames,function(key){key=toKey(key);baseAssignValue(object,key,bind(object[key],object));});return object;});/** Used to compose bitmasks for function metadata. */var WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG$1=2,WRAP_PARTIAL_FLAG$2=32;/**
 * Creates a function that invokes the method at `object[key]` with `partials`
 * prepended to the arguments it receives.
 *
 * This method differs from `_.bind` by allowing bound functions to reference
 * methods that may be redefined or don't yet exist. See
 * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)
 * for more details.
 *
 * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic
 * builds, may be used as a placeholder for partially applied arguments.
 *
 * @static
 * @memberOf _
 * @since 0.10.0
 * @category Function
 * @param {Object} object The object to invoke the method on.
 * @param {string} key The key of the method.
 * @param {...*} [partials] The arguments to be partially applied.
 * @returns {Function} Returns the new bound function.
 * @example
 *
 * var object = {
 *   'user': 'fred',
 *   'greet': function(greeting, punctuation) {
 *     return greeting + ' ' + this.user + punctuation;
 *   }
 * };
 *
 * var bound = _.bindKey(object, 'greet', 'hi');
 * bound('!');
 * // => 'hi fred!'
 *
 * object.greet = function(greeting, punctuation) {
 *   return greeting + 'ya ' + this.user + punctuation;
 * };
 *
 * bound('!');
 * // => 'hiya fred!'
 *
 * // Bound with placeholders.
 * var bound = _.bindKey(object, 'greet', _, '!');
 * bound('hi');
 * // => 'hiya fred!'
 */var bindKey=baseRest(function(object,key,partials){var bitmask=WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG$1;if(partials.length){var holders=replaceHolders(partials,getHolder(bindKey));bitmask|=WRAP_PARTIAL_FLAG$2;}return createWrap(key,bitmask,object,partials,holders);});// Assign default placeholders.
bindKey.placeholder={};/**
 * The base implementation of `_.slice` without an iteratee call guard.
 *
 * @private
 * @param {Array} array The array to slice.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the slice of `array`.
 */function baseSlice(array,start,end){var index=-1,length=array.length;if(start<0){start=-start>length?0:length+start;}end=end>length?length:end;if(end<0){end+=length;}length=start>end?0:end-start>>>0;start>>>=0;var result=Array(length);while(++index<length){result[index]=array[index+start];}return result;}/**
 * Casts `array` to a slice if it's needed.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {number} start The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the cast slice.
 */function castSlice(array,start,end){var length=array.length;end=end===undefined?length:end;return!start&&end>=length?array:baseSlice(array,start,end);}/** Used to compose unicode character classes. */var rsAstralRange$3="\\ud800-\\udfff",rsComboMarksRange$4="\\u0300-\\u036f",reComboHalfMarksRange$4="\\ufe20-\\ufe2f",rsComboSymbolsRange$4="\\u20d0-\\u20ff",rsComboRange$4=rsComboMarksRange$4+reComboHalfMarksRange$4+rsComboSymbolsRange$4,rsVarRange$3="\\ufe0e\\ufe0f";/** Used to compose unicode capture groups. */var rsZWJ$3="\\u200d";/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */var reHasUnicode=RegExp('['+rsZWJ$3+rsAstralRange$3+rsComboRange$4+rsVarRange$3+']');/**
 * Checks if `string` contains Unicode symbols.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {boolean} Returns `true` if a symbol is found, else `false`.
 */function hasUnicode(string){return reHasUnicode.test(string);}/**
 * Converts an ASCII `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */function asciiToArray(string){return string.split('');}/** Used to compose unicode character classes. */var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f";/** Used to compose unicode capture groups. */var rsAstral$1='['+rsAstralRange$2+']',rsCombo$3='['+rsComboRange$3+']',rsFitz$2="\\ud83c[\\udffb-\\udfff]",rsModifier$2='(?:'+rsCombo$3+'|'+rsFitz$2+')',rsNonAstral$2='[^'+rsAstralRange$2+']',rsRegional$2="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$2="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$2="\\u200d";/** Used to compose unicode regexes. */var reOptMod$2=rsModifier$2+'?',rsOptVar$2='['+rsVarRange$2+']?',rsOptJoin$2='(?:'+rsZWJ$2+'(?:'+[rsNonAstral$2,rsRegional$2,rsSurrPair$2].join('|')+')'+rsOptVar$2+reOptMod$2+')*',rsSeq$2=rsOptVar$2+reOptMod$2+rsOptJoin$2,rsSymbol$1='(?:'+[rsNonAstral$2+rsCombo$3+'?',rsCombo$3,rsRegional$2,rsSurrPair$2,rsAstral$1].join('|')+')';/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */var reUnicode$1=RegExp(rsFitz$2+'(?='+rsFitz$2+')|'+rsSymbol$1+rsSeq$2,'g');/**
 * Converts a Unicode `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */function unicodeToArray(string){return string.match(reUnicode$1)||[];}/**
 * Converts `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */function stringToArray(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string);}/**
 * Creates a function like `_.lowerFirst`.
 *
 * @private
 * @param {string} methodName The name of the `String` case method to use.
 * @returns {Function} Returns the new case function.
 */function createCaseFirst(methodName){return function(string){string=toString(string);var strSymbols=hasUnicode(string)?stringToArray(string):undefined;var chr=strSymbols?strSymbols[0]:string.charAt(0);var trailing=strSymbols?castSlice(strSymbols,1).join(''):string.slice(1);return chr[methodName]()+trailing;};}/**
 * Converts the first character of `string` to upper case.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the converted string.
 * @example
 *
 * _.upperFirst('fred');
 * // => 'Fred'
 *
 * _.upperFirst('FRED');
 * // => 'FRED'
 */var upperFirst=createCaseFirst('toUpperCase');/**
 * Converts the first character of `string` to upper case and the remaining
 * to lower case.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to capitalize.
 * @returns {string} Returns the capitalized string.
 * @example
 *
 * _.capitalize('FRED');
 * // => 'Fred'
 */function capitalize(string){return upperFirst(toString(string).toLowerCase());}/**
 * A specialized version of `_.reduce` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {*} [accumulator] The initial value.
 * @param {boolean} [initAccum] Specify using the first element of `array` as
 *  the initial value.
 * @returns {*} Returns the accumulated value.
 */function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=array==null?0:array.length;if(initAccum&&length){accumulator=array[++index];}while(++index<length){accumulator=iteratee(accumulator,array[index],index,array);}return accumulator;}/**
 * The base implementation of `_.propertyOf` without support for deep paths.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Function} Returns the new accessor function.
 */function basePropertyOf(object){return function(key){return object==null?undefined:object[key];};}/** Used to map Latin Unicode letters to basic Latin letters. */var deburredLetters={// Latin-1 Supplement block.
'\xc0':'A','\xc1':'A','\xc2':'A','\xc3':'A','\xc4':'A','\xc5':'A','\xe0':'a','\xe1':'a','\xe2':'a','\xe3':'a','\xe4':'a','\xe5':'a','\xc7':'C','\xe7':'c','\xd0':'D','\xf0':'d','\xc8':'E','\xc9':'E','\xca':'E','\xcb':'E','\xe8':'e','\xe9':'e','\xea':'e','\xeb':'e','\xcc':'I','\xcd':'I','\xce':'I','\xcf':'I','\xec':'i','\xed':'i','\xee':'i','\xef':'i','\xd1':'N','\xf1':'n','\xd2':'O','\xd3':'O','\xd4':'O','\xd5':'O','\xd6':'O','\xd8':'O','\xf2':'o','\xf3':'o','\xf4':'o','\xf5':'o','\xf6':'o','\xf8':'o','\xd9':'U','\xda':'U','\xdb':'U','\xdc':'U','\xf9':'u','\xfa':'u','\xfb':'u','\xfc':'u','\xdd':'Y','\xfd':'y','\xff':'y','\xc6':'Ae','\xe6':'ae','\xde':'Th','\xfe':'th','\xdf':'ss',// Latin Extended-A block.
"\u0100":'A',"\u0102":'A',"\u0104":'A',"\u0101":'a',"\u0103":'a',"\u0105":'a',"\u0106":'C',"\u0108":'C',"\u010A":'C',"\u010C":'C',"\u0107":'c',"\u0109":'c',"\u010B":'c',"\u010D":'c',"\u010E":'D',"\u0110":'D',"\u010F":'d',"\u0111":'d',"\u0112":'E',"\u0114":'E',"\u0116":'E',"\u0118":'E',"\u011A":'E',"\u0113":'e',"\u0115":'e',"\u0117":'e',"\u0119":'e',"\u011B":'e',"\u011C":'G',"\u011E":'G',"\u0120":'G',"\u0122":'G',"\u011D":'g',"\u011F":'g',"\u0121":'g',"\u0123":'g',"\u0124":'H',"\u0126":'H',"\u0125":'h',"\u0127":'h',"\u0128":'I',"\u012A":'I',"\u012C":'I',"\u012E":'I',"\u0130":'I',"\u0129":'i',"\u012B":'i',"\u012D":'i',"\u012F":'i',"\u0131":'i',"\u0134":'J',"\u0135":'j',"\u0136":'K',"\u0137":'k',"\u0138":'k',"\u0139":'L',"\u013B":'L',"\u013D":'L',"\u013F":'L',"\u0141":'L',"\u013A":'l',"\u013C":'l',"\u013E":'l',"\u0140":'l',"\u0142":'l',"\u0143":'N',"\u0145":'N',"\u0147":'N',"\u014A":'N',"\u0144":'n',"\u0146":'n',"\u0148":'n',"\u014B":'n',"\u014C":'O',"\u014E":'O',"\u0150":'O',"\u014D":'o',"\u014F":'o',"\u0151":'o',"\u0154":'R',"\u0156":'R',"\u0158":'R',"\u0155":'r',"\u0157":'r',"\u0159":'r',"\u015A":'S',"\u015C":'S',"\u015E":'S',"\u0160":'S',"\u015B":'s',"\u015D":'s',"\u015F":'s',"\u0161":'s',"\u0162":'T',"\u0164":'T',"\u0166":'T',"\u0163":'t',"\u0165":'t',"\u0167":'t',"\u0168":'U',"\u016A":'U',"\u016C":'U',"\u016E":'U',"\u0170":'U',"\u0172":'U',"\u0169":'u',"\u016B":'u',"\u016D":'u',"\u016F":'u',"\u0171":'u',"\u0173":'u',"\u0174":'W',"\u0175":'w',"\u0176":'Y',"\u0177":'y',"\u0178":'Y',"\u0179":'Z',"\u017B":'Z',"\u017D":'Z',"\u017A":'z',"\u017C":'z',"\u017E":'z',"\u0132":'IJ',"\u0133":'ij',"\u0152":'Oe',"\u0153":'oe',"\u0149":"'n","\u017F":'s'};/**
 * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A
 * letters to basic Latin letters.
 *
 * @private
 * @param {string} letter The matched letter to deburr.
 * @returns {string} Returns the deburred letter.
 */var deburrLetter=basePropertyOf(deburredLetters);/** Used to match Latin Unicode letters (excluding mathematical operators). */var reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;/** Used to compose unicode character classes. */var rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2;/** Used to compose unicode capture groups. */var rsCombo$2='['+rsComboRange$2+']';/**
 * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and
 * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).
 */var reComboMark=RegExp(rsCombo$2,'g');/**
 * Deburrs `string` by converting
 * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)
 * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)
 * letters to basic Latin letters and removing
 * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to deburr.
 * @returns {string} Returns the deburred string.
 * @example
 *
 * _.deburr('dj vu');
 * // => 'deja vu'
 */function deburr(string){string=toString(string);return string&&string.replace(reLatin,deburrLetter).replace(reComboMark,'');}/** Used to match words composed of alphanumeric characters. */var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;/**
 * Splits an ASCII `string` into an array of its words.
 *
 * @private
 * @param {string} The string to inspect.
 * @returns {Array} Returns the words of `string`.
 */function asciiWords(string){return string.match(reAsciiWord)||[];}/** Used to detect strings that need a more robust regexp to match words. */var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;/**
 * Checks if `string` contains a word composed of Unicode symbols.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {boolean} Returns `true` if a word is found, else `false`.
 */function hasUnicodeWord(string){return reHasUnicodeWord.test(string);}/** Used to compose unicode character classes. */var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange='a-z\\xdf-\\xf6\\xf8-\\xff',rsMathOpRange='\\xac\\xb1\\xd7\\xf7',rsNonCharRange='\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf',rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange='A-Z\\xc0-\\xd6\\xd8-\\xde',rsVarRange$1="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange;/** Used to compose unicode capture groups. */var rsApos$1="['\u2019]",rsBreak='['+rsBreakRange+']',rsCombo$1='['+rsComboRange$1+']',rsDigits='\\d+',rsDingbat='['+rsDingbatRange+']',rsLower='['+rsLowerRange+']',rsMisc='[^'+rsAstralRange$1+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+']',rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1='(?:'+rsCombo$1+'|'+rsFitz$1+')',rsNonAstral$1='[^'+rsAstralRange$1+']',rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper='['+rsUpperRange+']',rsZWJ$1="\\u200d";/** Used to compose unicode regexes. */var rsMiscLower='(?:'+rsLower+'|'+rsMisc+')',rsMiscUpper='(?:'+rsUpper+'|'+rsMisc+')',rsOptContrLower='(?:'+rsApos$1+'(?:d|ll|m|re|s|t|ve))?',rsOptContrUpper='(?:'+rsApos$1+'(?:D|LL|M|RE|S|T|VE))?',reOptMod$1=rsModifier$1+'?',rsOptVar$1='['+rsVarRange$1+']?',rsOptJoin$1='(?:'+rsZWJ$1+'(?:'+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join('|')+')'+rsOptVar$1+reOptMod$1+')*',rsOrdLower='\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])',rsOrdUpper='\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])',rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsEmoji='(?:'+[rsDingbat,rsRegional$1,rsSurrPair$1].join('|')+')'+rsSeq$1;/** Used to match complex or compound words. */var reUnicodeWord=RegExp([rsUpper+'?'+rsLower+'+'+rsOptContrLower+'(?='+[rsBreak,rsUpper,'$'].join('|')+')',rsMiscUpper+'+'+rsOptContrUpper+'(?='+[rsBreak,rsUpper+rsMiscLower,'$'].join('|')+')',rsUpper+'?'+rsMiscLower+'+'+rsOptContrLower,rsUpper+'+'+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join('|'),'g');/**
 * Splits a Unicode `string` into an array of its words.
 *
 * @private
 * @param {string} The string to inspect.
 * @returns {Array} Returns the words of `string`.
 */function unicodeWords(string){return string.match(reUnicodeWord)||[];}/**
 * Splits `string` into an array of its words.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to inspect.
 * @param {RegExp|string} [pattern] The pattern to match words.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the words of `string`.
 * @example
 *
 * _.words('fred, barney, & pebbles');
 * // => ['fred', 'barney', 'pebbles']
 *
 * _.words('fred, barney, & pebbles', /[^, ]+/g);
 * // => ['fred', 'barney', '&', 'pebbles']
 */function words(string,pattern,guard){string=toString(string);pattern=guard?undefined:pattern;if(pattern===undefined){return hasUnicodeWord(string)?unicodeWords(string):asciiWords(string);}return string.match(pattern)||[];}/** Used to compose unicode capture groups. */var rsApos="['\u2019]";/** Used to match apostrophes. */var reApos=RegExp(rsApos,'g');/**
 * Creates a function like `_.camelCase`.
 *
 * @private
 * @param {Function} callback The function to combine each word.
 * @returns {Function} Returns the new compounder function.
 */function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string).replace(reApos,'')),callback,'');};}/**
 * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the camel cased string.
 * @example
 *
 * _.camelCase('Foo Bar');
 * // => 'fooBar'
 *
 * _.camelCase('--foo-bar--');
 * // => 'fooBar'
 *
 * _.camelCase('__FOO_BAR__');
 * // => 'fooBar'
 */var camelCase=createCompounder(function(result,word,index){word=word.toLowerCase();return result+(index?capitalize(word):word);});/**
 * Casts `value` as an array if it's not one.
 *
 * @static
 * @memberOf _
 * @since 4.4.0
 * @category Lang
 * @param {*} value The value to inspect.
 * @returns {Array} Returns the cast array.
 * @example
 *
 * _.castArray(1);
 * // => [1]
 *
 * _.castArray({ 'a': 1 });
 * // => [{ 'a': 1 }]
 *
 * _.castArray('abc');
 * // => ['abc']
 *
 * _.castArray(null);
 * // => [null]
 *
 * _.castArray(undefined);
 * // => [undefined]
 *
 * _.castArray();
 * // => []
 *
 * var array = [1, 2, 3];
 * console.log(_.castArray(array) === array);
 * // => true
 */function castArray(){if(!arguments.length){return[];}var value=arguments[0];return isArray(value)?value:[value];}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeIsFinite$1=root.isFinite,nativeMin$c=Math.min;/**
 * Creates a function like `_.round`.
 *
 * @private
 * @param {string} methodName The name of the `Math` method to use when rounding.
 * @returns {Function} Returns the new round function.
 */function createRound(methodName){var func=Math[methodName];return function(number,precision){number=toNumber(number);precision=precision==null?0:nativeMin$c(toInteger(precision),292);if(precision&&nativeIsFinite$1(number)){// Shift with exponential notation to avoid floating-point issues.
// See [MDN](https://mdn.io/round#Examples) for more details.
var pair=(toString(number)+'e').split('e'),value=func(pair[0]+'e'+(+pair[1]+precision));pair=(toString(value)+'e').split('e');return+(pair[0]+'e'+(+pair[1]-precision));}return func(number);};}/**
 * Computes `number` rounded up to `precision`.
 *
 * @static
 * @memberOf _
 * @since 3.10.0
 * @category Math
 * @param {number} number The number to round up.
 * @param {number} [precision=0] The precision to round up to.
 * @returns {number} Returns the rounded up number.
 * @example
 *
 * _.ceil(4.006);
 * // => 5
 *
 * _.ceil(6.004, 2);
 * // => 6.01
 *
 * _.ceil(6040, -2);
 * // => 6100
 */var ceil=createRound('ceil');/**
 * Creates a `lodash` wrapper instance that wraps `value` with explicit method
 * chain sequences enabled. The result of such sequences must be unwrapped
 * with `_#value`.
 *
 * @static
 * @memberOf _
 * @since 1.3.0
 * @category Seq
 * @param {*} value The value to wrap.
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'age': 36 },
 *   { 'user': 'fred',    'age': 40 },
 *   { 'user': 'pebbles', 'age': 1 }
 * ];
 *
 * var youngest = _
 *   .chain(users)
 *   .sortBy('age')
 *   .map(function(o) {
 *     return o.user + ' is ' + o.age;
 *   })
 *   .head()
 *   .value();
 * // => 'pebbles is 1'
 */function chain(value){var result=lodash(value);result.__chain__=true;return result;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeCeil$3=Math.ceil,nativeMax$c=Math.max;/**
 * Creates an array of elements split into groups the length of `size`.
 * If `array` can't be split evenly, the final chunk will be the remaining
 * elements.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to process.
 * @param {number} [size=1] The length of each chunk
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the new array of chunks.
 * @example
 *
 * _.chunk(['a', 'b', 'c', 'd'], 2);
 * // => [['a', 'b'], ['c', 'd']]
 *
 * _.chunk(['a', 'b', 'c', 'd'], 3);
 * // => [['a', 'b', 'c'], ['d']]
 */function chunk(array,size,guard){if(guard?isIterateeCall(array,size,guard):size===undefined){size=1;}else{size=nativeMax$c(toInteger(size),0);}var length=array==null?0:array.length;if(!length||size<1){return[];}var index=0,resIndex=0,result=Array(nativeCeil$3(length/size));while(index<length){result[resIndex++]=baseSlice(array,index,index+=size);}return result;}/**
 * The base implementation of `_.clamp` which doesn't coerce arguments.
 *
 * @private
 * @param {number} number The number to clamp.
 * @param {number} [lower] The lower bound.
 * @param {number} upper The upper bound.
 * @returns {number} Returns the clamped number.
 */function baseClamp(number,lower,upper){if(number===number){if(upper!==undefined){number=number<=upper?number:upper;}if(lower!==undefined){number=number>=lower?number:lower;}}return number;}/**
 * Clamps `number` within the inclusive `lower` and `upper` bounds.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Number
 * @param {number} number The number to clamp.
 * @param {number} [lower] The lower bound.
 * @param {number} upper The upper bound.
 * @returns {number} Returns the clamped number.
 * @example
 *
 * _.clamp(-10, -5, 5);
 * // => -5
 *
 * _.clamp(10, -5, 5);
 * // => 5
 */function clamp(number,lower,upper){if(upper===undefined){upper=lower;lower=undefined;}if(upper!==undefined){upper=toNumber(upper);upper=upper===upper?upper:0;}if(lower!==undefined){lower=toNumber(lower);lower=lower===lower?lower:0;}return baseClamp(toNumber(number),lower,upper);}/**
 * Removes all key-value entries from the stack.
 *
 * @private
 * @name clear
 * @memberOf Stack
 */function stackClear(){this.__data__=new ListCache();this.size=0;}/**
 * Removes `key` and its value from the stack.
 *
 * @private
 * @name delete
 * @memberOf Stack
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */function stackDelete(key){var data=this.__data__,result=data['delete'](key);this.size=data.size;return result;}/**
 * Gets the stack value for `key`.
 *
 * @private
 * @name get
 * @memberOf Stack
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */function stackGet(key){return this.__data__.get(key);}/**
 * Checks if a stack value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Stack
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */function stackHas(key){return this.__data__.has(key);}/** Used as the size to enable large array optimizations. */var LARGE_ARRAY_SIZE$2=200;/**
 * Sets the stack `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Stack
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the stack cache instance.
 */function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map$1||pairs.length<LARGE_ARRAY_SIZE$2-1){pairs.push([key,value]);this.size=++data.size;return this;}data=this.__data__=new MapCache(pairs);}data.set(key,value);this.size=data.size;return this;}/**
 * Creates a stack cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */function Stack$1(entries){var data=this.__data__=new ListCache(entries);this.size=data.size;}// Add methods to `Stack`.
Stack$1.prototype.clear=stackClear;Stack$1.prototype['delete']=stackDelete;Stack$1.prototype.get=stackGet;Stack$1.prototype.has=stackHas;Stack$1.prototype.set=stackSet;/**
 * The base implementation of `_.assign` without support for multiple sources
 * or `customizer` functions.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @returns {Object} Returns `object`.
 */function baseAssign(object,source){return object&&copyObject(source,keys$1(source),object);}/**
 * The base implementation of `_.assignIn` without support for multiple sources
 * or `customizer` functions.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @returns {Object} Returns `object`.
 */function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object);}/** Detect free variable `exports`. */var freeExports=(typeof exports==="undefined"?"undefined":_typeof2(exports))=='object'&&exports&&!exports.nodeType&&exports;/** Detect free variable `module`. */var freeModule=freeExports&&(typeof module==="undefined"?"undefined":_typeof2(module))=='object'&&module&&!module.nodeType&&module;/** Detect the popular CommonJS extension `module.exports`. */var moduleExports=freeModule&&freeModule.exports===freeExports;/** Built-in value references. */var Buffer=moduleExports?root.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;/**
 * Creates a clone of  `buffer`.
 *
 * @private
 * @param {Buffer} buffer The buffer to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Buffer} Returns the cloned buffer.
 */function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice();}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result;}/**
 * A specialized version of `_.filter` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {Array} Returns the new filtered array.
 */function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value;}}return result;}/**
 * This method returns a new empty array.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {Array} Returns the new empty array.
 * @example
 *
 * var arrays = _.times(2, _.stubArray);
 *
 * console.log(arrays);
 * // => [[], []]
 *
 * console.log(arrays[0] === arrays[1]);
 * // => false
 */function stubArray(){return[];}/** Used for built-in method references. */var objectProto$d=Object.prototype;/** Built-in value references. */var propertyIsEnumerable=objectProto$d.propertyIsEnumerable;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeGetSymbols$1=Object.getOwnPropertySymbols;/**
 * Creates an array of the own enumerable symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of symbols.
 */var getSymbols=!nativeGetSymbols$1?stubArray:function(object){if(object==null){return[];}object=Object(object);return arrayFilter(nativeGetSymbols$1(object),function(symbol){return propertyIsEnumerable.call(object,symbol);});};/**
 * Copies own symbols of `source` to `object`.
 *
 * @private
 * @param {Object} source The object to copy symbols from.
 * @param {Object} [object={}] The object to copy symbols to.
 * @returns {Object} Returns `object`.
 */function copySymbols(source,object){return copyObject(source,getSymbols(source),object);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeGetSymbols=Object.getOwnPropertySymbols;/**
 * Creates an array of the own and inherited enumerable symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of symbols.
 */var getSymbolsIn=!nativeGetSymbols?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols(object));object=getPrototype(object);}return result;};/**
 * Copies own and inherited symbols of `source` to `object`.
 *
 * @private
 * @param {Object} source The object to copy symbols from.
 * @param {Object} [object={}] The object to copy symbols to.
 * @returns {Object} Returns `object`.
 */function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn(source),object);}/**
 * The base implementation of `getAllKeys` and `getAllKeysIn` which uses
 * `keysFunc` and `symbolsFunc` to get the enumerable property names and
 * symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @param {Function} symbolsFunc The function to get the symbols of `object`.
 * @returns {Array} Returns the array of property names and symbols.
 */function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object));}/**
 * Creates an array of own enumerable property names and symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names and symbols.
 */function getAllKeys(object){return baseGetAllKeys(object,keys$1,getSymbols);}/**
 * Creates an array of own and inherited enumerable property names and
 * symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names and symbols.
 */function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn);}/* Built-in method references that are verified to be native. */var DataView=getNative(root,'DataView');/* Built-in method references that are verified to be native. */var Promise$1=getNative(root,'Promise');/* Built-in method references that are verified to be native. */var Set$1=getNative(root,'Set');/** `Object#toString` result references. */var mapTag$8='[object Map]',objectTag$2='[object Object]',promiseTag='[object Promise]',setTag$8='[object Set]',weakMapTag$2='[object WeakMap]';var dataViewTag$3='[object DataView]';/** Used to detect maps, sets, and weakmaps. */var dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1);/**
 * Gets the `toStringTag` of `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */var getTag=baseGetTag;// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.
if(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag(new Map$1())!=mapTag$8||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1())!=setTag$8||WeakMap$1&&getTag(new WeakMap$1())!=weakMapTag$2){getTag=function getTag(value){var result=baseGetTag(value),Ctor=result==objectTag$2?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):'';if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$8;case promiseCtorString:return promiseTag;case setCtorString:return setTag$8;case weakMapCtorString:return weakMapTag$2;}}return result;};}var getTag$1=getTag;/** Used for built-in method references. */var objectProto$c=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$c=objectProto$c.hasOwnProperty;/**
 * Initializes an array clone.
 *
 * @private
 * @param {Array} array The array to clone.
 * @returns {Array} Returns the initialized clone.
 */function initCloneArray(array){var length=array.length,result=new array.constructor(length);// Add properties assigned by `RegExp#exec`.
if(length&&typeof array[0]=='string'&&hasOwnProperty$c.call(array,'index')){result.index=array.index;result.input=array.input;}return result;}/** Built-in value references. */var Uint8Array$1=root.Uint8Array;/**
 * Creates a clone of `arrayBuffer`.
 *
 * @private
 * @param {ArrayBuffer} arrayBuffer The array buffer to clone.
 * @returns {ArrayBuffer} Returns the cloned array buffer.
 */function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array$1(result).set(new Uint8Array$1(arrayBuffer));return result;}/**
 * Creates a clone of `dataView`.
 *
 * @private
 * @param {Object} dataView The data view to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Object} Returns the cloned data view.
 */function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength);}/** Used to match `RegExp` flags from their coerced string values. */var reFlags$1=/\w*$/;/**
 * Creates a clone of `regexp`.
 *
 * @private
 * @param {Object} regexp The regexp to clone.
 * @returns {Object} Returns the cloned regexp.
 */function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags$1.exec(regexp));result.lastIndex=regexp.lastIndex;return result;}/** Used to convert symbols to primitives and strings. */var symbolProto$1=Symbol$1?Symbol$1.prototype:undefined,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:undefined;/**
 * Creates a clone of the `symbol` object.
 *
 * @private
 * @param {Object} symbol The symbol object to clone.
 * @returns {Object} Returns the cloned symbol object.
 */function cloneSymbol(symbol){return symbolValueOf$1?Object(symbolValueOf$1.call(symbol)):{};}/**
 * Creates a clone of `typedArray`.
 *
 * @private
 * @param {Object} typedArray The typed array to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Object} Returns the cloned typed array.
 */function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length);}/** `Object#toString` result references. */var boolTag$3='[object Boolean]',dateTag$3='[object Date]',mapTag$7='[object Map]',numberTag$3='[object Number]',regexpTag$3='[object RegExp]',setTag$7='[object Set]',stringTag$3='[object String]',symbolTag$2='[object Symbol]';var arrayBufferTag$3='[object ArrayBuffer]',dataViewTag$2='[object DataView]',float32Tag$1='[object Float32Array]',float64Tag$1='[object Float64Array]',int8Tag$1='[object Int8Array]',int16Tag$1='[object Int16Array]',int32Tag$1='[object Int32Array]',uint8Tag$1='[object Uint8Array]',uint8ClampedTag$1='[object Uint8ClampedArray]',uint16Tag$1='[object Uint16Array]',uint32Tag$1='[object Uint32Array]';/**
 * Initializes an object clone based on its `toStringTag`.
 *
 * **Note:** This function only supports cloning values with tags of
 * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.
 *
 * @private
 * @param {Object} object The object to clone.
 * @param {string} tag The `toStringTag` of the object to clone.
 * @param {boolean} [isDeep] Specify a deep clone.
 * @returns {Object} Returns the initialized clone.
 */function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag$3:return cloneArrayBuffer(object);case boolTag$3:case dateTag$3:return new Ctor(+object);case dataViewTag$2:return cloneDataView(object,isDeep);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(object,isDeep);case mapTag$7:return new Ctor();case numberTag$3:case stringTag$3:return new Ctor(object);case regexpTag$3:return cloneRegExp(object);case setTag$7:return new Ctor();case symbolTag$2:return cloneSymbol(object);}}/**
 * Initializes an object clone.
 *
 * @private
 * @param {Object} object The object to clone.
 * @returns {Object} Returns the initialized clone.
 */function initCloneObject(object){return typeof object.constructor=='function'&&!isPrototype(object)?baseCreate(getPrototype(object)):{};}/** `Object#toString` result references. */var mapTag$6='[object Map]';/**
 * The base implementation of `_.isMap` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a map, else `false`.
 */function baseIsMap(value){return isObjectLike(value)&&getTag$1(value)==mapTag$6;}/* Node.js helper references. */var nodeIsMap=nodeUtil&&nodeUtil.isMap;/**
 * Checks if `value` is classified as a `Map` object.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a map, else `false`.
 * @example
 *
 * _.isMap(new Map);
 * // => true
 *
 * _.isMap(new WeakMap);
 * // => false
 */var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;/** `Object#toString` result references. */var setTag$6='[object Set]';/**
 * The base implementation of `_.isSet` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a set, else `false`.
 */function baseIsSet(value){return isObjectLike(value)&&getTag$1(value)==setTag$6;}/* Node.js helper references. */var nodeIsSet=nodeUtil&&nodeUtil.isSet;/**
 * Checks if `value` is classified as a `Set` object.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a set, else `false`.
 * @example
 *
 * _.isSet(new Set);
 * // => true
 *
 * _.isSet(new WeakSet);
 * // => false
 */var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$7=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$5=4;/** `Object#toString` result references. */var argsTag$1='[object Arguments]',arrayTag$1='[object Array]',boolTag$2='[object Boolean]',dateTag$2='[object Date]',errorTag$1='[object Error]',funcTag='[object Function]',genTag='[object GeneratorFunction]',mapTag$5='[object Map]',numberTag$2='[object Number]',objectTag$1='[object Object]',regexpTag$2='[object RegExp]',setTag$5='[object Set]',stringTag$2='[object String]',symbolTag$1='[object Symbol]',weakMapTag$1='[object WeakMap]';var arrayBufferTag$2='[object ArrayBuffer]',dataViewTag$1='[object DataView]',float32Tag='[object Float32Array]',float64Tag='[object Float64Array]',int8Tag='[object Int8Array]',int16Tag='[object Int16Array]',int32Tag='[object Int32Array]',uint8Tag='[object Uint8Array]',uint8ClampedTag='[object Uint8ClampedArray]',uint16Tag='[object Uint16Array]',uint32Tag='[object Uint32Array]';/** Used to identify `toStringTag` values supported by `_.clone`. */var cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$5]=cloneableTags[numberTag$2]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$5]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag$1]=false;/**
 * The base implementation of `_.clone` and `_.cloneDeep` which tracks
 * traversed objects.
 *
 * @private
 * @param {*} value The value to clone.
 * @param {boolean} bitmask The bitmask flags.
 *  1 - Deep clone
 *  2 - Flatten inherited properties
 *  4 - Clone symbols
 * @param {Function} [customizer] The function to customize cloning.
 * @param {string} [key] The key of `value`.
 * @param {Object} [object] The parent object of `value`.
 * @param {Object} [stack] Tracks traversed objects and their clone counterparts.
 * @returns {*} Returns the cloned value.
 */function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG$7,isFlat=bitmask&CLONE_FLAT_FLAG$1,isFull=bitmask&CLONE_SYMBOLS_FLAG$5;if(customizer){result=object?customizer(value,key,object,stack):customizer(value);}if(result!==undefined){return result;}if(!isObject(value)){return value;}var isArr=isArray(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result);}}else{var tag=getTag$1(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value)){return cloneBuffer(value,isDeep);}if(tag==objectTag$1||tag==argsTag$1||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value));}}else{if(!cloneableTags[tag]){return object?value:{};}result=initCloneByTag(value,tag,isDeep);}}// Check for circular references and return its corresponding clone.
stack||(stack=new Stack$1());var stacked=stack.get(value);if(stacked){return stacked;}stack.set(value,result);if(isSet(value)){value.forEach(function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack));});}else if(isMap(value)){value.forEach(function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack));});}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys$1;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,function(subValue,key){if(props){key=subValue;subValue=value[key];}// Recursively populate clone (susceptible to call stack limits).
assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack));});return result;}/** Used to compose bitmasks for cloning. */var CLONE_SYMBOLS_FLAG$4=4;/**
 * Creates a shallow clone of `value`.
 *
 * **Note:** This method is loosely based on the
 * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)
 * and supports cloning arrays, array buffers, booleans, date objects, maps,
 * numbers, `Object` objects, regexes, sets, strings, symbols, and typed
 * arrays. The own enumerable properties of `arguments` objects are cloned
 * as plain objects. An empty object is returned for uncloneable values such
 * as error objects, functions, DOM nodes, and WeakMaps.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to clone.
 * @returns {*} Returns the cloned value.
 * @see _.cloneDeep
 * @example
 *
 * var objects = [{ 'a': 1 }, { 'b': 2 }];
 *
 * var shallow = _.clone(objects);
 * console.log(shallow[0] === objects[0]);
 * // => true
 */function clone(value){return baseClone(value,CLONE_SYMBOLS_FLAG$4);}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$6=1,CLONE_SYMBOLS_FLAG$3=4;/**
 * This method is like `_.clone` except that it recursively clones `value`.
 *
 * @static
 * @memberOf _
 * @since 1.0.0
 * @category Lang
 * @param {*} value The value to recursively clone.
 * @returns {*} Returns the deep cloned value.
 * @see _.clone
 * @example
 *
 * var objects = [{ 'a': 1 }, { 'b': 2 }];
 *
 * var deep = _.cloneDeep(objects);
 * console.log(deep[0] === objects[0]);
 * // => false
 */function cloneDeep(value){return baseClone(value,CLONE_DEEP_FLAG$6|CLONE_SYMBOLS_FLAG$3);}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$5=1,CLONE_SYMBOLS_FLAG$2=4;/**
 * This method is like `_.cloneWith` except that it recursively clones `value`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to recursively clone.
 * @param {Function} [customizer] The function to customize cloning.
 * @returns {*} Returns the deep cloned value.
 * @see _.cloneWith
 * @example
 *
 * function customizer(value) {
 *   if (_.isElement(value)) {
 *     return value.cloneNode(true);
 *   }
 * }
 *
 * var el = _.cloneDeepWith(document.body, customizer);
 *
 * console.log(el === document.body);
 * // => false
 * console.log(el.nodeName);
 * // => 'BODY'
 * console.log(el.childNodes.length);
 * // => 20
 */function cloneDeepWith(value,customizer){customizer=typeof customizer=='function'?customizer:undefined;return baseClone(value,CLONE_DEEP_FLAG$5|CLONE_SYMBOLS_FLAG$2,customizer);}/** Used to compose bitmasks for cloning. */var CLONE_SYMBOLS_FLAG$1=4;/**
 * This method is like `_.clone` except that it accepts `customizer` which
 * is invoked to produce the cloned value. If `customizer` returns `undefined`,
 * cloning is handled by the method instead. The `customizer` is invoked with
 * up to four arguments; (value [, index|key, object, stack]).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to clone.
 * @param {Function} [customizer] The function to customize cloning.
 * @returns {*} Returns the cloned value.
 * @see _.cloneDeepWith
 * @example
 *
 * function customizer(value) {
 *   if (_.isElement(value)) {
 *     return value.cloneNode(false);
 *   }
 * }
 *
 * var el = _.cloneWith(document.body, customizer);
 *
 * console.log(el === document.body);
 * // => false
 * console.log(el.nodeName);
 * // => 'BODY'
 * console.log(el.childNodes.length);
 * // => 0
 */function cloneWith(value,customizer){customizer=typeof customizer=='function'?customizer:undefined;return baseClone(value,CLONE_SYMBOLS_FLAG$1,customizer);}/**
 * Executes the chain sequence and returns the wrapped result.
 *
 * @name commit
 * @memberOf _
 * @since 3.2.0
 * @category Seq
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * var array = [1, 2];
 * var wrapped = _(array).push(3);
 *
 * console.log(array);
 * // => [1, 2]
 *
 * wrapped = wrapped.commit();
 * console.log(array);
 * // => [1, 2, 3]
 *
 * wrapped.last();
 * // => 3
 *
 * console.log(array);
 * // => [1, 2, 3]
 */function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__);}/**
 * Creates an array with all falsey values removed. The values `false`, `null`,
 * `0`, `""`, `undefined`, and `NaN` are falsey.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to compact.
 * @returns {Array} Returns the new array of filtered values.
 * @example
 *
 * _.compact([0, 1, false, 2, '', 3]);
 * // => [1, 2, 3]
 */function compact(array){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(value){result[resIndex++]=value;}}return result;}/**
 * Creates a new array concatenating `array` with any additional arrays
 * and/or values.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to concatenate.
 * @param {...*} [values] The values to concatenate.
 * @returns {Array} Returns the new concatenated array.
 * @example
 *
 * var array = [1];
 * var other = _.concat(array, 2, [3], [[4]]);
 *
 * console.log(other);
 * // => [1, 2, 3, [4]]
 *
 * console.log(array);
 * // => [1]
 */function concat(){var length=arguments.length;if(!length){return[];}var args=Array(length-1),array=arguments[0],index=length;while(index--){args[index-1]=arguments[index];}return arrayPush(isArray(array)?copyArray(array):[array],baseFlatten(args,1));}/** Used to stand-in for `undefined` hash values. */var HASH_UNDEFINED='__lodash_hash_undefined__';/**
 * Adds `value` to the array cache.
 *
 * @private
 * @name add
 * @memberOf SetCache
 * @alias push
 * @param {*} value The value to cache.
 * @returns {Object} Returns the cache instance.
 */function setCacheAdd(value){this.__data__.set(value,HASH_UNDEFINED);return this;}/**
 * Checks if `value` is in the array cache.
 *
 * @private
 * @name has
 * @memberOf SetCache
 * @param {*} value The value to search for.
 * @returns {number} Returns `true` if `value` is found, else `false`.
 */function setCacheHas(value){return this.__data__.has(value);}/**
 *
 * Creates an array cache object to store unique values.
 *
 * @private
 * @constructor
 * @param {Array} [values] The values to cache.
 */function SetCache(values){var index=-1,length=values==null?0:values.length;this.__data__=new MapCache();while(++index<length){this.add(values[index]);}}// Add methods to `SetCache`.
SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;/**
 * A specialized version of `_.some` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if any element passes the predicate check,
 *  else `false`.
 */function arraySome(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(predicate(array[index],index,array)){return true;}}return false;}/**
 * Checks if a `cache` value for `key` exists.
 *
 * @private
 * @param {Object} cache The cache to query.
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */function cacheHas(cache,key){return cache.has(key);}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;/**
 * A specialized version of `baseIsEqualDeep` for arrays with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Array} array The array to compare.
 * @param {Array} other The other array to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `array` and `other` objects.
 * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.
 */function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$5,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength)){return false;}// Check that cyclic values are equal.
var arrStacked=stack.get(array);var othStacked=stack.get(other);if(arrStacked&&othStacked){return arrStacked==other&&othStacked==array;}var index=-1,result=true,seen=bitmask&COMPARE_UNORDERED_FLAG$3?new SetCache():undefined;stack.set(array,other);stack.set(other,array);// Ignore non-index properties.
while(++index<arrLength){var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);}if(compared!==undefined){if(compared){continue;}result=false;break;}// Recursively compare arrays (susceptible to call stack limits).
if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){return seen.push(othIndex);}})){result=false;break;}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){result=false;break;}}stack['delete'](array);stack['delete'](other);return result;}/**
 * Converts `map` to its key-value pairs.
 *
 * @private
 * @param {Object} map The map to convert.
 * @returns {Array} Returns the key-value pairs.
 */function mapToArray(map){var index=-1,result=Array(map.size);map.forEach(function(value,key){result[++index]=[key,value];});return result;}/**
 * Converts `set` to an array of its values.
 *
 * @private
 * @param {Object} set The set to convert.
 * @returns {Array} Returns the values.
 */function setToArray(set){var index=-1,result=Array(set.size);set.forEach(function(value){result[++index]=value;});return result;}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;/** `Object#toString` result references. */var boolTag$1='[object Boolean]',dateTag$1='[object Date]',errorTag='[object Error]',mapTag$4='[object Map]',numberTag$1='[object Number]',regexpTag$1='[object RegExp]',setTag$4='[object Set]',stringTag$1='[object String]',symbolTag='[object Symbol]';var arrayBufferTag$1='[object ArrayBuffer]',dataViewTag='[object DataView]';/** Used to convert symbols to primitives and strings. */var symbolProto=Symbol$1?Symbol$1.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined;/**
 * A specialized version of `baseIsEqualDeep` for comparing objects of
 * the same `toStringTag`.
 *
 * **Note:** This function only supports comparing values with tags of
 * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {string} tag The `toStringTag` of the objects to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset){return false;}object=object.buffer;other=other.buffer;case arrayBufferTag$1:if(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array$1(object),new Uint8Array$1(other))){return false;}return true;case boolTag$1:case dateTag$1:case numberTag$1:// Coerce booleans to `1` or `0` and dates to milliseconds.
// Invalid dates are coerced to `NaN`.
return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag$1:case stringTag$1:// Coerce regexes to strings and treat strings, primitives and objects,
// as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring
// for more details.
return object==other+'';case mapTag$4:var convert=mapToArray;case setTag$4:var isPartial=bitmask&COMPARE_PARTIAL_FLAG$4;convert||(convert=setToArray);if(object.size!=other.size&&!isPartial){return false;}// Assume cyclic values are equal.
var stacked=stack.get(object);if(stacked){return stacked==other;}bitmask|=COMPARE_UNORDERED_FLAG$2;// Recursively compare objects (susceptible to call stack limits).
stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);stack['delete'](object);return result;case symbolTag:if(symbolValueOf){return symbolValueOf.call(object)==symbolValueOf.call(other);}}return false;}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG$3=1;/** Used for built-in method references. */var objectProto$b=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$b=objectProto$b.hasOwnProperty;/**
 * A specialized version of `baseIsEqualDeep` for objects with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$3,objProps=getAllKeys(object),objLength=objProps.length,othProps=getAllKeys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial){return false;}var index=objLength;while(index--){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty$b.call(other,key))){return false;}}// Check that cyclic values are equal.
var objStacked=stack.get(object);var othStacked=stack.get(other);if(objStacked&&othStacked){return objStacked==other&&othStacked==object;}var result=true;stack.set(object,other);stack.set(other,object);var skipCtor=isPartial;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);}// Recursively compare objects (susceptible to call stack limits).
if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=false;break;}skipCtor||(skipCtor=key=='constructor');}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;// Non `Object` object instances with different constructors are not equal.
if(objCtor!=othCtor&&'constructor'in object&&'constructor'in other&&!(typeof objCtor=='function'&&objCtor instanceof objCtor&&typeof othCtor=='function'&&othCtor instanceof othCtor)){result=false;}}stack['delete'](object);stack['delete'](other);return result;}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG$2=1;/** `Object#toString` result references. */var argsTag='[object Arguments]',arrayTag='[object Array]',objectTag='[object Object]';/** Used for built-in method references. */var objectProto$a=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$a=objectProto$a.hasOwnProperty;/**
 * A specialized version of `baseIsEqual` for arrays and objects which performs
 * deep comparisons and tracks traversed objects enabling objects with circular
 * references to be compared.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} [stack] Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag$1(object),othTag=othIsArr?arrayTag:getTag$1(other);objTag=objTag==argsTag?objectTag:objTag;othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other)){return false;}objIsArr=true;objIsObj=false;}if(isSameTag&&!objIsObj){stack||(stack=new Stack$1());return objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);}if(!(bitmask&COMPARE_PARTIAL_FLAG$2)){var objIsWrapped=objIsObj&&hasOwnProperty$a.call(object,'__wrapped__'),othIsWrapped=othIsObj&&hasOwnProperty$a.call(other,'__wrapped__');if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;stack||(stack=new Stack$1());return equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack);}}if(!isSameTag){return false;}stack||(stack=new Stack$1());return equalObjects(object,other,bitmask,customizer,equalFunc,stack);}/**
 * The base implementation of `_.isEqual` which supports partial comparisons
 * and tracks traversed objects.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @param {boolean} bitmask The bitmask flags.
 *  1 - Unordered comparison
 *  2 - Partial comparison
 * @param {Function} [customizer] The function to customize comparisons.
 * @param {Object} [stack] Tracks traversed `value` and `other` objects.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 */function baseIsEqual(value,other,bitmask,customizer,stack){if(value===other){return true;}if(value==null||other==null||!isObjectLike(value)&&!isObjectLike(other)){return value!==value&&other!==other;}return baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack);}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;/**
 * The base implementation of `_.isMatch` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property values to match.
 * @param {Array} matchData The property names, values, and compare flags to match.
 * @param {Function} [customizer] The function to customize comparisons.
 * @returns {boolean} Returns `true` if `object` is a match, else `false`.
 */function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null){return!length;}object=Object(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object)){return false;}}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object)){return false;}}else{var stack=new Stack$1();if(customizer){var result=customizer(objValue,srcValue,key,object,source,stack);}if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,customizer,stack):result)){return false;}}}return true;}/**
 * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` if suitable for strict
 *  equality comparisons, else `false`.
 */function isStrictComparable(value){return value===value&&!isObject(value);}/**
 * Gets the property names, values, and compare flags of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the match data of `object`.
 */function getMatchData(object){var result=keys$1(object),length=result.length;while(length--){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)];}return result;}/**
 * A specialized version of `matchesProperty` for source values suitable
 * for strict equality comparisons, i.e. `===`.
 *
 * @private
 * @param {string} key The key of the property to get.
 * @param {*} srcValue The value to match.
 * @returns {Function} Returns the new spec function.
 */function matchesStrictComparable(key,srcValue){return function(object){if(object==null){return false;}return object[key]===srcValue&&(srcValue!==undefined||key in Object(object));};}/**
 * The base implementation of `_.matches` which doesn't clone `source`.
 *
 * @private
 * @param {Object} source The object of property values to match.
 * @returns {Function} Returns the new spec function.
 */function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){return matchesStrictComparable(matchData[0][0],matchData[0][1]);}return function(object){return object===source||baseIsMatch(object,source,matchData);};}/**
 * The base implementation of `_.hasIn` without support for deep paths.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {Array|string} key The key to check.
 * @returns {boolean} Returns `true` if `key` exists, else `false`.
 */function baseHasIn(object,key){return object!=null&&key in Object(object);}/**
 * Checks if `path` exists on `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path to check.
 * @param {Function} hasFunc The function to check properties.
 * @returns {boolean} Returns `true` if `path` exists, else `false`.
 */function hasPath(object,path,hasFunc){path=castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break;}object=object[key];}if(result||++index!=length){return result;}length=object==null?0:object.length;return!!length&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object));}/**
 * Checks if `path` is a direct or inherited property of `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path to check.
 * @returns {boolean} Returns `true` if `path` exists, else `false`.
 * @example
 *
 * var object = _.create({ 'a': _.create({ 'b': 2 }) });
 *
 * _.hasIn(object, 'a');
 * // => true
 *
 * _.hasIn(object, 'a.b');
 * // => true
 *
 * _.hasIn(object, ['a', 'b']);
 * // => true
 *
 * _.hasIn(object, 'b');
 * // => false
 */function hasIn(object,path){return object!=null&&hasPath(object,path,baseHasIn);}/** Used to compose bitmasks for value comparisons. */var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;/**
 * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.
 *
 * @private
 * @param {string} path The path of the property to get.
 * @param {*} srcValue The value to match.
 * @returns {Function} Returns the new spec function.
 */function baseMatchesProperty(path,srcValue){if(isKey(path)&&isStrictComparable(srcValue)){return matchesStrictComparable(toKey(path),srcValue);}return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG);};}/**
 * The base implementation of `_.property` without support for deep paths.
 *
 * @private
 * @param {string} key The key of the property to get.
 * @returns {Function} Returns the new accessor function.
 */function baseProperty(key){return function(object){return object==null?undefined:object[key];};}/**
 * A specialized version of `baseProperty` which supports deep paths.
 *
 * @private
 * @param {Array|string} path The path of the property to get.
 * @returns {Function} Returns the new accessor function.
 */function basePropertyDeep(path){return function(object){return baseGet(object,path);};}/**
 * Creates a function that returns the value at `path` of a given object.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {Array|string} path The path of the property to get.
 * @returns {Function} Returns the new accessor function.
 * @example
 *
 * var objects = [
 *   { 'a': { 'b': 2 } },
 *   { 'a': { 'b': 1 } }
 * ];
 *
 * _.map(objects, _.property('a.b'));
 * // => [2, 1]
 *
 * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');
 * // => [1, 2]
 */function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path);}/**
 * The base implementation of `_.iteratee`.
 *
 * @private
 * @param {*} [value=_.identity] The value to convert to an iteratee.
 * @returns {Function} Returns the iteratee.
 */function baseIteratee(value){// Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.
// See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.
if(typeof value=='function'){return value;}if(value==null){return identity;}if(_typeof2(value)=='object'){return isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value);}return property(value);}/** Error message constants. */var FUNC_ERROR_TEXT$7='Expected a function';/**
 * Creates a function that iterates over `pairs` and invokes the corresponding
 * function of the first predicate to return truthy. The predicate-function
 * pairs are invoked with the `this` binding and arguments of the created
 * function.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {Array} pairs The predicate-function pairs.
 * @returns {Function} Returns the new composite function.
 * @example
 *
 * var func = _.cond([
 *   [_.matches({ 'a': 1 }),           _.constant('matches A')],
 *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],
 *   [_.stubTrue,                      _.constant('no match')]
 * ]);
 *
 * func({ 'a': 1, 'b': 2 });
 * // => 'matches A'
 *
 * func({ 'a': 0, 'b': 1 });
 * // => 'matches B'
 *
 * func({ 'a': '1', 'b': '2' });
 * // => 'no match'
 */function cond(pairs){var length=pairs==null?0:pairs.length,toIteratee=baseIteratee;pairs=!length?[]:arrayMap(pairs,function(pair){if(typeof pair[1]!='function'){throw new TypeError(FUNC_ERROR_TEXT$7);}return[toIteratee(pair[0]),pair[1]];});return baseRest(function(args){var index=-1;while(++index<length){var pair=pairs[index];if(apply(pair[0],this,args)){return apply(pair[1],this,args);}}});}/**
 * The base implementation of `_.conformsTo` which accepts `props` to check.
 *
 * @private
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property predicates to conform to.
 * @returns {boolean} Returns `true` if `object` conforms, else `false`.
 */function baseConformsTo(object,source,props){var length=props.length;if(object==null){return!length;}object=Object(object);while(length--){var key=props[length],predicate=source[key],value=object[key];if(value===undefined&&!(key in object)||!predicate(value)){return false;}}return true;}/**
 * The base implementation of `_.conforms` which doesn't clone `source`.
 *
 * @private
 * @param {Object} source The object of property predicates to conform to.
 * @returns {Function} Returns the new spec function.
 */function baseConforms(source){var props=keys$1(source);return function(object){return baseConformsTo(object,source,props);};}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$4=1;/**
 * Creates a function that invokes the predicate properties of `source` with
 * the corresponding property values of a given object, returning `true` if
 * all predicates return truthy, else `false`.
 *
 * **Note:** The created function is equivalent to `_.conformsTo` with
 * `source` partially applied.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {Object} source The object of property predicates to conform to.
 * @returns {Function} Returns the new spec function.
 * @example
 *
 * var objects = [
 *   { 'a': 2, 'b': 1 },
 *   { 'a': 1, 'b': 2 }
 * ];
 *
 * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));
 * // => [{ 'a': 1, 'b': 2 }]
 */function conforms(source){return baseConforms(baseClone(source,CLONE_DEEP_FLAG$4));}/**
 * Checks if `object` conforms to `source` by invoking the predicate
 * properties of `source` with the corresponding property values of `object`.
 *
 * **Note:** This method is equivalent to `_.conforms` when `source` is
 * partially applied.
 *
 * @static
 * @memberOf _
 * @since 4.14.0
 * @category Lang
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property predicates to conform to.
 * @returns {boolean} Returns `true` if `object` conforms, else `false`.
 * @example
 *
 * var object = { 'a': 1, 'b': 2 };
 *
 * _.conformsTo(object, { 'b': function(n) { return n > 1; } });
 * // => true
 *
 * _.conformsTo(object, { 'b': function(n) { return n > 2; } });
 * // => false
 */function conformsTo(object,source){return source==null||baseConformsTo(object,source,keys$1(source));}/**
 * A specialized version of `baseAggregator` for arrays.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} setter The function to set `accumulator` values.
 * @param {Function} iteratee The iteratee to transform keys.
 * @param {Object} accumulator The initial aggregated object.
 * @returns {Function} Returns `accumulator`.
 */function arrayAggregator(array,setter,iteratee,accumulator){var index=-1,length=array==null?0:array.length;while(++index<length){var value=array[index];setter(accumulator,value,iteratee(value),array);}return accumulator;}/**
 * Creates a base function for methods like `_.forIn` and `_.forOwn`.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new base function.
 */function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===false){break;}}return object;};}/**
 * The base implementation of `baseForOwn` which iterates over `object`
 * properties returned by `keysFunc` and invokes `iteratee` for each property.
 * Iteratee functions may exit iteration early by explicitly returning `false`.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @returns {Object} Returns `object`.
 */var baseFor=createBaseFor();/**
 * The base implementation of `_.forOwn` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Object} Returns `object`.
 */function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys$1);}/**
 * Creates a `baseEach` or `baseEachRight` function.
 *
 * @private
 * @param {Function} eachFunc The function to iterate over a collection.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new base function.
 */function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(collection==null){return collection;}if(!isArrayLike(collection)){return eachFunc(collection,iteratee);}var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);while(fromRight?index--:++index<length){if(iteratee(iterable[index],index,iterable)===false){break;}}return collection;};}/**
 * The base implementation of `_.forEach` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array|Object} Returns `collection`.
 */var baseEach=createBaseEach(baseForOwn);/**
 * Aggregates elements of `collection` on `accumulator` with keys transformed
 * by `iteratee` and values set by `setter`.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} setter The function to set `accumulator` values.
 * @param {Function} iteratee The iteratee to transform keys.
 * @param {Object} accumulator The initial aggregated object.
 * @returns {Function} Returns `accumulator`.
 */function baseAggregator(collection,setter,iteratee,accumulator){baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection);});return accumulator;}/**
 * Creates a function like `_.groupBy`.
 *
 * @private
 * @param {Function} setter The function to set accumulator values.
 * @param {Function} [initializer] The accumulator object initializer.
 * @returns {Function} Returns the new aggregator function.
 */function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee),accumulator);};}/** Used for built-in method references. */var objectProto$9=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$9=objectProto$9.hasOwnProperty;/**
 * Creates an object composed of keys generated from the results of running
 * each element of `collection` thru `iteratee`. The corresponding value of
 * each key is the number of times the key was returned by `iteratee`. The
 * iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 0.5.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
 * @returns {Object} Returns the composed aggregate object.
 * @example
 *
 * _.countBy([6.1, 4.2, 6.3], Math.floor);
 * // => { '4': 1, '6': 2 }
 *
 * // The `_.property` iteratee shorthand.
 * _.countBy(['one', 'two', 'three'], 'length');
 * // => { '3': 2, '5': 1 }
 */var countBy=createAggregator(function(result,value,key){if(hasOwnProperty$9.call(result,key)){++result[key];}else{baseAssignValue(result,key,1);}});/**
 * Creates an object that inherits from the `prototype` object. If a
 * `properties` object is given, its own enumerable string keyed properties
 * are assigned to the created object.
 *
 * @static
 * @memberOf _
 * @since 2.3.0
 * @category Object
 * @param {Object} prototype The object to inherit from.
 * @param {Object} [properties] The properties to assign to the object.
 * @returns {Object} Returns the new object.
 * @example
 *
 * function Shape() {
 *   this.x = 0;
 *   this.y = 0;
 * }
 *
 * function Circle() {
 *   Shape.call(this);
 * }
 *
 * Circle.prototype = _.create(Shape.prototype, {
 *   'constructor': Circle
 * });
 *
 * var circle = new Circle;
 * circle instanceof Circle;
 * // => true
 *
 * circle instanceof Shape;
 * // => true
 */function create(prototype,properties){var result=baseCreate(prototype);return properties==null?result:baseAssign(result,properties);}/** Used to compose bitmasks for function metadata. */var WRAP_CURRY_FLAG$1=8;/**
 * Creates a function that accepts arguments of `func` and either invokes
 * `func` returning its result, if at least `arity` number of arguments have
 * been provided, or returns a function that accepts the remaining `func`
 * arguments, and so on. The arity of `func` may be specified if `func.length`
 * is not sufficient.
 *
 * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,
 * may be used as a placeholder for provided arguments.
 *
 * **Note:** This method doesn't set the "length" property of curried functions.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Function
 * @param {Function} func The function to curry.
 * @param {number} [arity=func.length] The arity of `func`.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Function} Returns the new curried function.
 * @example
 *
 * var abc = function(a, b, c) {
 *   return [a, b, c];
 * };
 *
 * var curried = _.curry(abc);
 *
 * curried(1)(2)(3);
 * // => [1, 2, 3]
 *
 * curried(1, 2)(3);
 * // => [1, 2, 3]
 *
 * curried(1, 2, 3);
 * // => [1, 2, 3]
 *
 * // Curried with placeholders.
 * curried(1)(_, 3)(2);
 * // => [1, 2, 3]
 */function curry(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_FLAG$1,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder=curry.placeholder;return result;}// Assign default placeholders.
curry.placeholder={};/** Used to compose bitmasks for function metadata. */var WRAP_CURRY_RIGHT_FLAG=16;/**
 * This method is like `_.curry` except that arguments are applied to `func`
 * in the manner of `_.partialRight` instead of `_.partial`.
 *
 * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic
 * builds, may be used as a placeholder for provided arguments.
 *
 * **Note:** This method doesn't set the "length" property of curried functions.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Function
 * @param {Function} func The function to curry.
 * @param {number} [arity=func.length] The arity of `func`.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Function} Returns the new curried function.
 * @example
 *
 * var abc = function(a, b, c) {
 *   return [a, b, c];
 * };
 *
 * var curried = _.curryRight(abc);
 *
 * curried(3)(2)(1);
 * // => [1, 2, 3]
 *
 * curried(2, 3)(1);
 * // => [1, 2, 3]
 *
 * curried(1, 2, 3);
 * // => [1, 2, 3]
 *
 * // Curried with placeholders.
 * curried(3)(1, _)(2);
 * // => [1, 2, 3]
 */function curryRight(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_RIGHT_FLAG,undefined,undefined,undefined,undefined,undefined,arity);result.placeholder=curryRight.placeholder;return result;}// Assign default placeholders.
curryRight.placeholder={};/**
 * Gets the timestamp of the number of milliseconds that have elapsed since
 * the Unix epoch (1 January 1970 00:00:00 UTC).
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Date
 * @returns {number} Returns the timestamp.
 * @example
 *
 * _.defer(function(stamp) {
 *   console.log(_.now() - stamp);
 * }, _.now());
 * // => Logs the number of milliseconds it took for the deferred invocation.
 */var now=function now(){return root.Date.now();};/** Error message constants. */var FUNC_ERROR_TEXT$6='Expected a function';/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$b=Math.max,nativeMin$b=Math.min;/**
 * Creates a debounced function that delays invoking `func` until after `wait`
 * milliseconds have elapsed since the last time the debounced function was
 * invoked. The debounced function comes with a `cancel` method to cancel
 * delayed `func` invocations and a `flush` method to immediately invoke them.
 * Provide `options` to indicate whether `func` should be invoked on the
 * leading and/or trailing edge of the `wait` timeout. The `func` is invoked
 * with the last arguments provided to the debounced function. Subsequent
 * calls to the debounced function return the result of the last `func`
 * invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the debounced function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until to the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `_.debounce` and `_.throttle`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to debounce.
 * @param {number} [wait=0] The number of milliseconds to delay.
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.leading=false]
 *  Specify invoking on the leading edge of the timeout.
 * @param {number} [options.maxWait]
 *  The maximum time `func` is allowed to be delayed before it's invoked.
 * @param {boolean} [options.trailing=true]
 *  Specify invoking on the trailing edge of the timeout.
 * @returns {Function} Returns the new debounced function.
 * @example
 *
 * // Avoid costly calculations while the window size is in flux.
 * jQuery(window).on('resize', _.debounce(calculateLayout, 150));
 *
 * // Invoke `sendMail` when clicked, debouncing subsequent calls.
 * jQuery(element).on('click', _.debounce(sendMail, 300, {
 *   'leading': true,
 *   'trailing': false
 * }));
 *
 * // Ensure `batchLog` is invoked once after 1 second of debounced calls.
 * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });
 * var source = new EventSource('/stream');
 * jQuery(source).on('message', debounced);
 *
 * // Cancel the trailing debounced invocation.
 * jQuery(window).on('popstate', debounced.cancel);
 */function debounce$1(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=false,maxing=false,trailing=true;if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$6);}wait=toNumber(wait)||0;if(isObject(options)){leading=!!options.leading;maxing='maxWait'in options;maxWait=maxing?nativeMax$b(toNumber(options.maxWait)||0,wait):maxWait;trailing='trailing'in options?!!options.trailing:trailing;}function invokeFunc(time){var args=lastArgs,thisArg=lastThis;lastArgs=lastThis=undefined;lastInvokeTime=time;result=func.apply(thisArg,args);return result;}function leadingEdge(time){// Reset any `maxWait` timer.
lastInvokeTime=time;// Start the timer for the trailing edge.
timerId=setTimeout(timerExpired,wait);// Invoke the leading edge.
return leading?invokeFunc(time):result;}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,timeWaiting=wait-timeSinceLastCall;return maxing?nativeMin$b(timeWaiting,maxWait-timeSinceLastInvoke):timeWaiting;}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;// Either this is the first call, activity has stopped and we're at the
// trailing edge, the system time has gone backwards and we're treating
// it as the trailing edge, or we've hit the `maxWait` limit.
return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&timeSinceLastInvoke>=maxWait;}function timerExpired(){var time=now();if(shouldInvoke(time)){return trailingEdge(time);}// Restart the timer.
timerId=setTimeout(timerExpired,remainingWait(time));}function trailingEdge(time){timerId=undefined;// Only invoke if we have `lastArgs` which means `func` has been
// debounced at least once.
if(trailing&&lastArgs){return invokeFunc(time);}lastArgs=lastThis=undefined;return result;}function cancel(){if(timerId!==undefined){clearTimeout(timerId);}lastInvokeTime=0;lastArgs=lastCallTime=lastThis=timerId=undefined;}function flush(){return timerId===undefined?result:trailingEdge(now());}function debounced(){var time=now(),isInvoking=shouldInvoke(time);lastArgs=arguments;lastThis=this;lastCallTime=time;if(isInvoking){if(timerId===undefined){return leadingEdge(lastCallTime);}if(maxing){// Handle invocations in a tight loop.
clearTimeout(timerId);timerId=setTimeout(timerExpired,wait);return invokeFunc(lastCallTime);}}if(timerId===undefined){timerId=setTimeout(timerExpired,wait);}return result;}debounced.cancel=cancel;debounced.flush=flush;return debounced;}/**
 * Checks `value` to determine whether a default value should be returned in
 * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,
 * or `undefined`.
 *
 * @static
 * @memberOf _
 * @since 4.14.0
 * @category Util
 * @param {*} value The value to check.
 * @param {*} defaultValue The default value.
 * @returns {*} Returns the resolved value.
 * @example
 *
 * _.defaultTo(1, 10);
 * // => 1
 *
 * _.defaultTo(undefined, 10);
 * // => 10
 */function defaultTo(value,defaultValue){return value==null||value!==value?defaultValue:value;}/** Used for built-in method references. */var objectProto$8=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$8=objectProto$8.hasOwnProperty;/**
 * Assigns own and inherited enumerable string keyed properties of source
 * objects to the destination object for all destination properties that
 * resolve to `undefined`. Source objects are applied from left to right.
 * Once a property is set, additional values of the same property are ignored.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @see _.defaultsDeep
 * @example
 *
 * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
 * // => { 'a': 1, 'b': 2 }
 */var defaults$2=baseRest(function(object,sources){object=Object(object);var index=-1;var length=sources.length;var guard=length>2?sources[2]:undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){length=1;}while(++index<length){var source=sources[index];var props=keysIn(source);var propsIndex=-1;var propsLength=props.length;while(++propsIndex<propsLength){var key=props[propsIndex];var value=object[key];if(value===undefined||eq(value,objectProto$8[key])&&!hasOwnProperty$8.call(object,key)){object[key]=source[key];}}}return object;});/**
 * This function is like `assignValue` except that it doesn't assign
 * `undefined` values.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */function assignMergeValue(object,key,value){if(value!==undefined&&!eq(object[key],value)||value===undefined&&!(key in object)){baseAssignValue(object,key,value);}}/**
 * This method is like `_.isArrayLike` except that it also checks if `value`
 * is an object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array-like object,
 *  else `false`.
 * @example
 *
 * _.isArrayLikeObject([1, 2, 3]);
 * // => true
 *
 * _.isArrayLikeObject(document.body.children);
 * // => true
 *
 * _.isArrayLikeObject('abc');
 * // => false
 *
 * _.isArrayLikeObject(_.noop);
 * // => false
 */function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value);}/**
 * Gets the value at `key`, unless `key` is "__proto__" or "constructor".
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */function safeGet(object,key){if(key==='constructor'&&typeof object[key]==='function'){return;}if(key=='__proto__'){return;}return object[key];}/**
 * Converts `value` to a plain object flattening inherited enumerable string
 * keyed properties of `value` to own properties of the plain object.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {Object} Returns the converted plain object.
 * @example
 *
 * function Foo() {
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.assign({ 'a': 1 }, new Foo);
 * // => { 'a': 1, 'b': 2 }
 *
 * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));
 * // => { 'a': 1, 'b': 2, 'c': 3 }
 */function toPlainObject(value){return copyObject(value,keysIn(value));}/**
 * A specialized version of `baseMerge` for arrays and objects which performs
 * deep merges and tracks traversed objects enabling objects with circular
 * references to be merged.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @param {string} key The key of the value to merge.
 * @param {number} srcIndex The index of `source`.
 * @param {Function} mergeFunc The function to merge values.
 * @param {Function} [customizer] The function to customize assigned values.
 * @param {Object} [stack] Tracks traversed source values and their merged
 *  counterparts.
 */function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked){assignMergeValue(object,key,stacked);return;}var newValue=customizer?customizer(objValue,srcValue,key+'',object,source,stack):undefined;var isCommon=newValue===undefined;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue;if(isArr||isBuff||isTyped){if(isArray(objValue)){newValue=objValue;}else if(isArrayLikeObject(objValue)){newValue=copyArray(objValue);}else if(isBuff){isCommon=false;newValue=cloneBuffer(srcValue,true);}else if(isTyped){isCommon=false;newValue=cloneTypedArray(srcValue,true);}else{newValue=[];}}else if(isPlainObject(srcValue)||isArguments(srcValue)){newValue=objValue;if(isArguments(objValue)){newValue=toPlainObject(objValue);}else if(!isObject(objValue)||isFunction(objValue)){newValue=initCloneObject(srcValue);}}else{isCommon=false;}}if(isCommon){// Recursively merge objects and arrays (susceptible to call stack limits).
stack.set(srcValue,newValue);mergeFunc(newValue,srcValue,srcIndex,customizer,stack);stack['delete'](srcValue);}assignMergeValue(object,key,newValue);}/**
 * The base implementation of `_.merge` without support for multiple sources.
 *
 * @private
 * @param {Object} object The destination object.
 * @param {Object} source The source object.
 * @param {number} srcIndex The index of `source`.
 * @param {Function} [customizer] The function to customize merged values.
 * @param {Object} [stack] Tracks traversed source values and their merged
 *  counterparts.
 */function baseMerge(object,source,srcIndex,customizer,stack){if(object===source){return;}baseFor(source,function(srcValue,key){stack||(stack=new Stack$1());if(isObject(srcValue)){baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);}else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+'',object,source,stack):undefined;if(newValue===undefined){newValue=srcValue;}assignMergeValue(object,key,newValue);}},keysIn);}/**
 * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source
 * objects into destination objects that are passed thru.
 *
 * @private
 * @param {*} objValue The destination value.
 * @param {*} srcValue The source value.
 * @param {string} key The key of the property to merge.
 * @param {Object} object The parent object of `objValue`.
 * @param {Object} source The parent object of `srcValue`.
 * @param {Object} [stack] Tracks traversed source values and their merged
 *  counterparts.
 * @returns {*} Returns the value to assign.
 */function customDefaultsMerge(objValue,srcValue,key,object,source,stack){if(isObject(objValue)&&isObject(srcValue)){// Recursively merge objects and arrays (susceptible to call stack limits).
stack.set(srcValue,objValue);baseMerge(objValue,srcValue,undefined,customDefaultsMerge,stack);stack['delete'](srcValue);}return objValue;}/**
 * This method is like `_.merge` except that it accepts `customizer` which
 * is invoked to produce the merged values of the destination and source
 * properties. If `customizer` returns `undefined`, merging is handled by the
 * method instead. The `customizer` is invoked with six arguments:
 * (objValue, srcValue, key, object, source, stack).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} sources The source objects.
 * @param {Function} customizer The function to customize assigned values.
 * @returns {Object} Returns `object`.
 * @example
 *
 * function customizer(objValue, srcValue) {
 *   if (_.isArray(objValue)) {
 *     return objValue.concat(srcValue);
 *   }
 * }
 *
 * var object = { 'a': [1], 'b': [2] };
 * var other = { 'a': [3], 'b': [4] };
 *
 * _.mergeWith(object, other, customizer);
 * // => { 'a': [1, 3], 'b': [2, 4] }
 */var mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer);});/**
 * This method is like `_.defaults` except that it recursively assigns
 * default properties.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 3.10.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @see _.defaults
 * @example
 *
 * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });
 * // => { 'a': { 'b': 2, 'c': 3 } }
 */var defaultsDeep=baseRest(function(args){args.push(undefined,customDefaultsMerge);return apply(mergeWith,undefined,args);});/** Error message constants. */var FUNC_ERROR_TEXT$5='Expected a function';/**
 * The base implementation of `_.delay` and `_.defer` which accepts `args`
 * to provide to `func`.
 *
 * @private
 * @param {Function} func The function to delay.
 * @param {number} wait The number of milliseconds to delay invocation.
 * @param {Array} args The arguments to provide to `func`.
 * @returns {number|Object} Returns the timer id or timeout object.
 */function baseDelay(func,wait,args){if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$5);}return setTimeout(function(){func.apply(undefined,args);},wait);}/**
 * Defers invoking the `func` until the current call stack has cleared. Any
 * additional arguments are provided to `func` when it's invoked.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to defer.
 * @param {...*} [args] The arguments to invoke `func` with.
 * @returns {number} Returns the timer id.
 * @example
 *
 * _.defer(function(text) {
 *   console.log(text);
 * }, 'deferred');
 * // => Logs 'deferred' after one millisecond.
 */var defer=baseRest(function(func,args){return baseDelay(func,1,args);});/**
 * Invokes `func` after `wait` milliseconds. Any additional arguments are
 * provided to `func` when it's invoked.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to delay.
 * @param {number} wait The number of milliseconds to delay invocation.
 * @param {...*} [args] The arguments to invoke `func` with.
 * @returns {number} Returns the timer id.
 * @example
 *
 * _.delay(function(text) {
 *   console.log(text);
 * }, 1000, 'later');
 * // => Logs 'later' after one second.
 */var delay=baseRest(function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args);});/**
 * This function is like `arrayIncludes` except that it accepts a comparator.
 *
 * @private
 * @param {Array} [array] The array to inspect.
 * @param {*} target The value to search for.
 * @param {Function} comparator The comparator invoked per element.
 * @returns {boolean} Returns `true` if `target` is found, else `false`.
 */function arrayIncludesWith(array,value,comparator){var index=-1,length=array==null?0:array.length;while(++index<length){if(comparator(value,array[index])){return true;}}return false;}/** Used as the size to enable large array optimizations. */var LARGE_ARRAY_SIZE$1=200;/**
 * The base implementation of methods like `_.difference` without support
 * for excluding multiple arrays or iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Array} values The values to exclude.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 */function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=true,length=array.length,result=[],valuesLength=values.length;if(!length){return result;}if(iteratee){values=arrayMap(values,baseUnary(iteratee));}if(comparator){includes=arrayIncludesWith;isCommon=false;}else if(values.length>=LARGE_ARRAY_SIZE$1){includes=cacheHas;isCommon=false;values=new SetCache(values);}outer:while(++index<length){var value=array[index],computed=iteratee==null?value:iteratee(value);value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var valuesIndex=valuesLength;while(valuesIndex--){if(values[valuesIndex]===computed){continue outer;}}result.push(value);}else if(!includes(values,computed,comparator)){result.push(value);}}return result;}/**
 * Creates an array of `array` values not included in the other given arrays
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons. The order and references of result values are
 * determined by the first array.
 *
 * **Note:** Unlike `_.pullAll`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {...Array} [values] The values to exclude.
 * @returns {Array} Returns the new array of filtered values.
 * @see _.without, _.xor
 * @example
 *
 * _.difference([2, 1], [2, 3]);
 * // => [1]
 */var difference=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true)):[];});/**
 * Gets the last element of `array`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to query.
 * @returns {*} Returns the last element of `array`.
 * @example
 *
 * _.last([1, 2, 3]);
 * // => 3
 */function last(array){var length=array==null?0:array.length;return length?array[length-1]:undefined;}/**
 * This method is like `_.difference` except that it accepts `iteratee` which
 * is invoked for each element of `array` and `values` to generate the criterion
 * by which they're compared. The order and references of result values are
 * determined by the first array. The iteratee is invoked with one argument:
 * (value).
 *
 * **Note:** Unlike `_.pullAllBy`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {...Array} [values] The values to exclude.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 * @example
 *
 * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);
 * // => [1.2]
 *
 * // The `_.property` iteratee shorthand.
 * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');
 * // => [{ 'x': 2 }]
 */var differenceBy=baseRest(function(array,values){var iteratee=last(values);if(isArrayLikeObject(iteratee)){iteratee=undefined;}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true),baseIteratee(iteratee)):[];});/**
 * This method is like `_.difference` except that it accepts `comparator`
 * which is invoked to compare elements of `array` to `values`. The order and
 * references of result values are determined by the first array. The comparator
 * is invoked with two arguments: (arrVal, othVal).
 *
 * **Note:** Unlike `_.pullAllWith`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {...Array} [values] The values to exclude.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 * @example
 *
 * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
 *
 * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);
 * // => [{ 'x': 2, 'y': 1 }]
 */var differenceWith=baseRest(function(array,values){var comparator=last(values);if(isArrayLikeObject(comparator)){comparator=undefined;}return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,true),undefined,comparator):[];});/**
 * Divide two numbers.
 *
 * @static
 * @memberOf _
 * @since 4.7.0
 * @category Math
 * @param {number} dividend The first number in a division.
 * @param {number} divisor The second number in a division.
 * @returns {number} Returns the quotient.
 * @example
 *
 * _.divide(6, 4);
 * // => 1.5
 */var divide=createMathOperation(function(dividend,divisor){return dividend/divisor;},1);/**
 * Creates a slice of `array` with `n` elements dropped from the beginning.
 *
 * @static
 * @memberOf _
 * @since 0.5.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {number} [n=1] The number of elements to drop.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.drop([1, 2, 3]);
 * // => [2, 3]
 *
 * _.drop([1, 2, 3], 2);
 * // => [3]
 *
 * _.drop([1, 2, 3], 5);
 * // => []
 *
 * _.drop([1, 2, 3], 0);
 * // => [1, 2, 3]
 */function drop(array,n,guard){var length=array==null?0:array.length;if(!length){return[];}n=guard||n===undefined?1:toInteger(n);return baseSlice(array,n<0?0:n,length);}/**
 * Creates a slice of `array` with `n` elements dropped from the end.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {number} [n=1] The number of elements to drop.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.dropRight([1, 2, 3]);
 * // => [1, 2]
 *
 * _.dropRight([1, 2, 3], 2);
 * // => [1]
 *
 * _.dropRight([1, 2, 3], 5);
 * // => []
 *
 * _.dropRight([1, 2, 3], 0);
 * // => [1, 2, 3]
 */function dropRight(array,n,guard){var length=array==null?0:array.length;if(!length){return[];}n=guard||n===undefined?1:toInteger(n);n=length-n;return baseSlice(array,0,n<0?0:n);}/**
 * The base implementation of methods like `_.dropWhile` and `_.takeWhile`
 * without support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to query.
 * @param {Function} predicate The function invoked per iteration.
 * @param {boolean} [isDrop] Specify dropping elements instead of taking them.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Array} Returns the slice of `array`.
 */function baseWhile(array,predicate,isDrop,fromRight){var length=array.length,index=fromRight?length:-1;while((fromRight?index--:++index<length)&&predicate(array[index],index,array)){}return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index);}/**
 * Creates a slice of `array` excluding elements dropped from the end.
 * Elements are dropped until `predicate` returns falsey. The predicate is
 * invoked with three arguments: (value, index, array).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': true },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': false }
 * ];
 *
 * _.dropRightWhile(users, function(o) { return !o.active; });
 * // => objects for ['barney']
 *
 * // The `_.matches` iteratee shorthand.
 * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });
 * // => objects for ['barney', 'fred']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.dropRightWhile(users, ['active', false]);
 * // => objects for ['barney']
 *
 * // The `_.property` iteratee shorthand.
 * _.dropRightWhile(users, 'active');
 * // => objects for ['barney', 'fred', 'pebbles']
 */function dropRightWhile(array,predicate){return array&&array.length?baseWhile(array,baseIteratee(predicate),true,true):[];}/**
 * Creates a slice of `array` excluding elements dropped from the beginning.
 * Elements are dropped until `predicate` returns falsey. The predicate is
 * invoked with three arguments: (value, index, array).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': false },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': true }
 * ];
 *
 * _.dropWhile(users, function(o) { return !o.active; });
 * // => objects for ['pebbles']
 *
 * // The `_.matches` iteratee shorthand.
 * _.dropWhile(users, { 'user': 'barney', 'active': false });
 * // => objects for ['fred', 'pebbles']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.dropWhile(users, ['active', false]);
 * // => objects for ['pebbles']
 *
 * // The `_.property` iteratee shorthand.
 * _.dropWhile(users, 'active');
 * // => objects for ['barney', 'fred', 'pebbles']
 */function dropWhile(array,predicate){return array&&array.length?baseWhile(array,baseIteratee(predicate),true):[];}/**
 * Casts `value` to `identity` if it's not a function.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {Function} Returns cast function.
 */function castFunction(value){return typeof value=='function'?value:identity;}/**
 * Iterates over elements of `collection` and invokes `iteratee` for each element.
 * The iteratee is invoked with three arguments: (value, index|key, collection).
 * Iteratee functions may exit iteration early by explicitly returning `false`.
 *
 * **Note:** As with other "Collections" methods, objects with a "length"
 * property are iterated like arrays. To avoid this behavior use `_.forIn`
 * or `_.forOwn` for object iteration.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @alias each
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array|Object} Returns `collection`.
 * @see _.forEachRight
 * @example
 *
 * _.forEach([1, 2], function(value) {
 *   console.log(value);
 * });
 * // => Logs `1` then `2`.
 *
 * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {
 *   console.log(key);
 * });
 * // => Logs 'a' then 'b' (iteration order is not guaranteed).
 */function forEach(collection,iteratee){var func=isArray(collection)?arrayEach:baseEach;return func(collection,castFunction(iteratee));}/**
 * A specialized version of `_.forEachRight` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns `array`.
 */function arrayEachRight(array,iteratee){var length=array==null?0:array.length;while(length--){if(iteratee(array[length],length,array)===false){break;}}return array;}/**
 * This function is like `baseFor` except that it iterates over properties
 * in the opposite order.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @returns {Object} Returns `object`.
 */var baseForRight=createBaseFor(true);/**
 * The base implementation of `_.forOwnRight` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Object} Returns `object`.
 */function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys$1);}/**
 * The base implementation of `_.forEachRight` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array|Object} Returns `collection`.
 */var baseEachRight=createBaseEach(baseForOwnRight,true);/**
 * This method is like `_.forEach` except that it iterates over elements of
 * `collection` from right to left.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @alias eachRight
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array|Object} Returns `collection`.
 * @see _.forEach
 * @example
 *
 * _.forEachRight([1, 2], function(value) {
 *   console.log(value);
 * });
 * // => Logs `2` then `1`.
 */function forEachRight(collection,iteratee){var func=isArray(collection)?arrayEachRight:baseEachRight;return func(collection,castFunction(iteratee));}/**
 * Checks if `string` ends with the given target string.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to inspect.
 * @param {string} [target] The string to search for.
 * @param {number} [position=string.length] The position to search up to.
 * @returns {boolean} Returns `true` if `string` ends with `target`,
 *  else `false`.
 * @example
 *
 * _.endsWith('abc', 'c');
 * // => true
 *
 * _.endsWith('abc', 'b');
 * // => false
 *
 * _.endsWith('abc', 'b', 2);
 * // => true
 */function endsWith(string,target,position){string=toString(string);target=baseToString(target);var length=string.length;position=position===undefined?length:baseClamp(toInteger(position),0,length);var end=position;position-=target.length;return position>=0&&string.slice(position,end)==target;}/**
 * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array
 * of key-value pairs for `object` corresponding to the property names of `props`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array} props The property names to get values for.
 * @returns {Object} Returns the key-value pairs.
 */function baseToPairs(object,props){return arrayMap(props,function(key){return[key,object[key]];});}/**
 * Converts `set` to its value-value pairs.
 *
 * @private
 * @param {Object} set The set to convert.
 * @returns {Array} Returns the value-value pairs.
 */function setToPairs(set){var index=-1,result=Array(set.size);set.forEach(function(value){result[++index]=[value,value];});return result;}/** `Object#toString` result references. */var mapTag$3='[object Map]',setTag$3='[object Set]';/**
 * Creates a `_.toPairs` or `_.toPairsIn` function.
 *
 * @private
 * @param {Function} keysFunc The function to get the keys of a given object.
 * @returns {Function} Returns the new pairs function.
 */function createToPairs(keysFunc){return function(object){var tag=getTag$1(object);if(tag==mapTag$3){return mapToArray(object);}if(tag==setTag$3){return setToPairs(object);}return baseToPairs(object,keysFunc(object));};}/**
 * Creates an array of own enumerable string keyed-value pairs for `object`
 * which can be consumed by `_.fromPairs`. If `object` is a map or set, its
 * entries are returned.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @alias entries
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the key-value pairs.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.toPairs(new Foo);
 * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)
 */var toPairs=createToPairs(keys$1);/**
 * Creates an array of own and inherited enumerable string keyed-value pairs
 * for `object` which can be consumed by `_.fromPairs`. If `object` is a map
 * or set, its entries are returned.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @alias entriesIn
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the key-value pairs.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.toPairsIn(new Foo);
 * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)
 */var toPairsIn=createToPairs(keysIn);/** Used to map characters to HTML entities. */var htmlEscapes={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'};/**
 * Used by `_.escape` to convert characters to HTML entities.
 *
 * @private
 * @param {string} chr The matched character to escape.
 * @returns {string} Returns the escaped character.
 */var escapeHtmlChar=basePropertyOf(htmlEscapes);/** Used to match HTML entities and HTML characters. */var reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);/**
 * Converts the characters "&", "<", ">", '"', and "'" in `string` to their
 * corresponding HTML entities.
 *
 * **Note:** No other characters are escaped. To escape additional
 * characters use a third-party library like [_he_](https://mths.be/he).
 *
 * Though the ">" character is escaped for symmetry, characters like
 * ">" and "/" don't need escaping in HTML and have no special meaning
 * unless they're part of a tag or unquoted attribute value. See
 * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)
 * (under "semi-related fun fact") for more details.
 *
 * When working with HTML you should always
 * [quote attribute values](http://wonko.com/post/html-escaping) to reduce
 * XSS vectors.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category String
 * @param {string} [string=''] The string to escape.
 * @returns {string} Returns the escaped string.
 * @example
 *
 * _.escape('fred, barney, & pebbles');
 * // => 'fred, barney, &amp; pebbles'
 */function escape(string){string=toString(string);return string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string;}/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);/**
 * Escapes the `RegExp` special characters "^", "$", "\", ".", "*", "+",
 * "?", "(", ")", "[", "]", "{", "}", and "|" in `string`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to escape.
 * @returns {string} Returns the escaped string.
 * @example
 *
 * _.escapeRegExp('[lodash](https://lodash.com/)');
 * // => '\[lodash\]\(https://lodash\.com/\)'
 */function escapeRegExp(string){string=toString(string);return string&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,'\\$&'):string;}/**
 * A specialized version of `_.every` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if all elements pass the predicate check,
 *  else `false`.
 */function arrayEvery(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(!predicate(array[index],index,array)){return false;}}return true;}/**
 * The base implementation of `_.every` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if all elements pass the predicate check,
 *  else `false`
 */function baseEvery(collection,predicate){var result=true;baseEach(collection,function(value,index,collection){result=!!predicate(value,index,collection);return result;});return result;}/**
 * Checks if `predicate` returns truthy for **all** elements of `collection`.
 * Iteration is stopped once `predicate` returns falsey. The predicate is
 * invoked with three arguments: (value, index|key, collection).
 *
 * **Note:** This method returns `true` for
 * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because
 * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of
 * elements of empty collections.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {boolean} Returns `true` if all elements pass the predicate check,
 *  else `false`.
 * @example
 *
 * _.every([true, 1, null, 'yes'], Boolean);
 * // => false
 *
 * var users = [
 *   { 'user': 'barney', 'age': 36, 'active': false },
 *   { 'user': 'fred',   'age': 40, 'active': false }
 * ];
 *
 * // The `_.matches` iteratee shorthand.
 * _.every(users, { 'user': 'barney', 'active': false });
 * // => false
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.every(users, ['active', false]);
 * // => true
 *
 * // The `_.property` iteratee shorthand.
 * _.every(users, 'active');
 * // => false
 */function every(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;if(guard&&isIterateeCall(collection,predicate,guard)){predicate=undefined;}return func(collection,baseIteratee(predicate));}/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$5=4294967295;/**
 * Converts `value` to an integer suitable for use as the length of an
 * array-like object.
 *
 * **Note:** This method is based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted integer.
 * @example
 *
 * _.toLength(3.2);
 * // => 3
 *
 * _.toLength(Number.MIN_VALUE);
 * // => 0
 *
 * _.toLength(Infinity);
 * // => 4294967295
 *
 * _.toLength('3.2');
 * // => 3
 */function toLength(value){return value?baseClamp(toInteger(value),0,MAX_ARRAY_LENGTH$5):0;}/**
 * The base implementation of `_.fill` without an iteratee call guard.
 *
 * @private
 * @param {Array} array The array to fill.
 * @param {*} value The value to fill `array` with.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns `array`.
 */function baseFill(array,value,start,end){var length=array.length;start=toInteger(start);if(start<0){start=-start>length?0:length+start;}end=end===undefined||end>length?length:toInteger(end);if(end<0){end+=length;}end=start>end?0:toLength(end);while(start<end){array[start++]=value;}return array;}/**
 * Fills elements of `array` with `value` from `start` up to, but not
 * including, `end`.
 *
 * **Note:** This method mutates `array`.
 *
 * @static
 * @memberOf _
 * @since 3.2.0
 * @category Array
 * @param {Array} array The array to fill.
 * @param {*} value The value to fill `array` with.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = [1, 2, 3];
 *
 * _.fill(array, 'a');
 * console.log(array);
 * // => ['a', 'a', 'a']
 *
 * _.fill(Array(3), 2);
 * // => [2, 2, 2]
 *
 * _.fill([4, 6, 8, 10], '*', 1, 3);
 * // => [4, '*', '*', 10]
 */function fill(array,value,start,end){var length=array==null?0:array.length;if(!length){return[];}if(start&&typeof start!='number'&&isIterateeCall(array,value,start)){start=0;end=length;}return baseFill(array,value,start,end);}/**
 * The base implementation of `_.filter` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {Array} Returns the new filtered array.
 */function baseFilter(collection,predicate){var result=[];baseEach(collection,function(value,index,collection){if(predicate(value,index,collection)){result.push(value);}});return result;}/**
 * Iterates over elements of `collection`, returning an array of all elements
 * `predicate` returns truthy for. The predicate is invoked with three
 * arguments: (value, index|key, collection).
 *
 * **Note:** Unlike `_.remove`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new filtered array.
 * @see _.reject
 * @example
 *
 * var users = [
 *   { 'user': 'barney', 'age': 36, 'active': true },
 *   { 'user': 'fred',   'age': 40, 'active': false }
 * ];
 *
 * _.filter(users, function(o) { return !o.active; });
 * // => objects for ['fred']
 *
 * // The `_.matches` iteratee shorthand.
 * _.filter(users, { 'age': 36, 'active': true });
 * // => objects for ['barney']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.filter(users, ['active', false]);
 * // => objects for ['fred']
 *
 * // The `_.property` iteratee shorthand.
 * _.filter(users, 'active');
 * // => objects for ['barney']
 *
 * // Combining several predicates using `_.overEvery` or `_.overSome`.
 * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));
 * // => objects for ['fred', 'barney']
 */function filter(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,baseIteratee(predicate));}/**
 * Creates a `_.find` or `_.findLast` function.
 *
 * @private
 * @param {Function} findIndexFunc The function to find the collection index.
 * @returns {Function} Returns the new find function.
 */function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=baseIteratee(predicate);collection=keys$1(collection);predicate=function predicate(key){return iteratee(iterable[key],key,iterable);};}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:undefined;};}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$a=Math.max;/**
 * This method is like `_.find` except that it returns the index of the first
 * element `predicate` returns truthy for instead of the element itself.
 *
 * @static
 * @memberOf _
 * @since 1.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param {number} [fromIndex=0] The index to search from.
 * @returns {number} Returns the index of the found element, else `-1`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': false },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': true }
 * ];
 *
 * _.findIndex(users, function(o) { return o.user == 'barney'; });
 * // => 0
 *
 * // The `_.matches` iteratee shorthand.
 * _.findIndex(users, { 'user': 'fred', 'active': false });
 * // => 1
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.findIndex(users, ['active', false]);
 * // => 0
 *
 * // The `_.property` iteratee shorthand.
 * _.findIndex(users, 'active');
 * // => 2
 */function findIndex(array,predicate,fromIndex){var length=array==null?0:array.length;if(!length){return-1;}var index=fromIndex==null?0:toInteger(fromIndex);if(index<0){index=nativeMax$a(length+index,0);}return baseFindIndex(array,baseIteratee(predicate),index);}/**
 * Iterates over elements of `collection`, returning the first element
 * `predicate` returns truthy for. The predicate is invoked with three
 * arguments: (value, index|key, collection).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param {number} [fromIndex=0] The index to search from.
 * @returns {*} Returns the matched element, else `undefined`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'age': 36, 'active': true },
 *   { 'user': 'fred',    'age': 40, 'active': false },
 *   { 'user': 'pebbles', 'age': 1,  'active': true }
 * ];
 *
 * _.find(users, function(o) { return o.age < 40; });
 * // => object for 'barney'
 *
 * // The `_.matches` iteratee shorthand.
 * _.find(users, { 'age': 1, 'active': true });
 * // => object for 'pebbles'
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.find(users, ['active', false]);
 * // => object for 'fred'
 *
 * // The `_.property` iteratee shorthand.
 * _.find(users, 'active');
 * // => object for 'barney'
 */var find$1=createFind(findIndex);/**
 * The base implementation of methods like `_.findKey` and `_.findLastKey`,
 * without support for iteratee shorthands, which iterates over `collection`
 * using `eachFunc`.
 *
 * @private
 * @param {Array|Object} collection The collection to inspect.
 * @param {Function} predicate The function invoked per iteration.
 * @param {Function} eachFunc The function to iterate over `collection`.
 * @returns {*} Returns the found element or its key, else `undefined`.
 */function baseFindKey(collection,predicate,eachFunc){var result;eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection)){result=key;return false;}});return result;}/**
 * This method is like `_.find` except that it returns the key of the first
 * element `predicate` returns truthy for instead of the element itself.
 *
 * @static
 * @memberOf _
 * @since 1.1.0
 * @category Object
 * @param {Object} object The object to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {string|undefined} Returns the key of the matched element,
 *  else `undefined`.
 * @example
 *
 * var users = {
 *   'barney':  { 'age': 36, 'active': true },
 *   'fred':    { 'age': 40, 'active': false },
 *   'pebbles': { 'age': 1,  'active': true }
 * };
 *
 * _.findKey(users, function(o) { return o.age < 40; });
 * // => 'barney' (iteration order is not guaranteed)
 *
 * // The `_.matches` iteratee shorthand.
 * _.findKey(users, { 'age': 1, 'active': true });
 * // => 'pebbles'
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.findKey(users, ['active', false]);
 * // => 'fred'
 *
 * // The `_.property` iteratee shorthand.
 * _.findKey(users, 'active');
 * // => 'barney'
 */function findKey(object,predicate){return baseFindKey(object,baseIteratee(predicate),baseForOwn);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$9=Math.max,nativeMin$a=Math.min;/**
 * This method is like `_.findIndex` except that it iterates over elements
 * of `collection` from right to left.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param {number} [fromIndex=array.length-1] The index to search from.
 * @returns {number} Returns the index of the found element, else `-1`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': true },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': false }
 * ];
 *
 * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });
 * // => 2
 *
 * // The `_.matches` iteratee shorthand.
 * _.findLastIndex(users, { 'user': 'barney', 'active': true });
 * // => 0
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.findLastIndex(users, ['active', false]);
 * // => 2
 *
 * // The `_.property` iteratee shorthand.
 * _.findLastIndex(users, 'active');
 * // => 0
 */function findLastIndex(array,predicate,fromIndex){var length=array==null?0:array.length;if(!length){return-1;}var index=length-1;if(fromIndex!==undefined){index=toInteger(fromIndex);index=fromIndex<0?nativeMax$9(length+index,0):nativeMin$a(index,length-1);}return baseFindIndex(array,baseIteratee(predicate),index,true);}/**
 * This method is like `_.find` except that it iterates over elements of
 * `collection` from right to left.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param {number} [fromIndex=collection.length-1] The index to search from.
 * @returns {*} Returns the matched element, else `undefined`.
 * @example
 *
 * _.findLast([1, 2, 3, 4], function(n) {
 *   return n % 2 == 1;
 * });
 * // => 3
 */var findLast=createFind(findLastIndex);/**
 * This method is like `_.findKey` except that it iterates over elements of
 * a collection in the opposite order.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Object
 * @param {Object} object The object to inspect.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {string|undefined} Returns the key of the matched element,
 *  else `undefined`.
 * @example
 *
 * var users = {
 *   'barney':  { 'age': 36, 'active': true },
 *   'fred':    { 'age': 40, 'active': false },
 *   'pebbles': { 'age': 1,  'active': true }
 * };
 *
 * _.findLastKey(users, function(o) { return o.age < 40; });
 * // => returns 'pebbles' assuming `_.findKey` returns 'barney'
 *
 * // The `_.matches` iteratee shorthand.
 * _.findLastKey(users, { 'age': 36, 'active': true });
 * // => 'barney'
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.findLastKey(users, ['active', false]);
 * // => 'fred'
 *
 * // The `_.property` iteratee shorthand.
 * _.findLastKey(users, 'active');
 * // => 'pebbles'
 */function findLastKey(object,predicate){return baseFindKey(object,baseIteratee(predicate),baseForOwnRight);}/**
 * Gets the first element of `array`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @alias first
 * @category Array
 * @param {Array} array The array to query.
 * @returns {*} Returns the first element of `array`.
 * @example
 *
 * _.head([1, 2, 3]);
 * // => 1
 *
 * _.head([]);
 * // => undefined
 */function head(array){return array&&array.length?array[0]:undefined;}/**
 * The base implementation of `_.map` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection);});return result;}/**
 * Creates an array of values by running each element in `collection` thru
 * `iteratee`. The iteratee is invoked with three arguments:
 * (value, index|key, collection).
 *
 * Many lodash methods are guarded to work as iteratees for methods like
 * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.
 *
 * The guarded methods are:
 * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,
 * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,
 * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,
 * `template`, `trim`, `trimEnd`, `trimStart`, and `words`
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 * @example
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * _.map([4, 8], square);
 * // => [16, 64]
 *
 * _.map({ 'a': 4, 'b': 8 }, square);
 * // => [16, 64] (iteration order is not guaranteed)
 *
 * var users = [
 *   { 'user': 'barney' },
 *   { 'user': 'fred' }
 * ];
 *
 * // The `_.property` iteratee shorthand.
 * _.map(users, 'user');
 * // => ['barney', 'fred']
 */function map(collection,iteratee){var func=isArray(collection)?arrayMap:baseMap;return func(collection,baseIteratee(iteratee));}/**
 * Creates a flattened array of values by running each element in `collection`
 * thru `iteratee` and flattening the mapped results. The iteratee is invoked
 * with three arguments: (value, index|key, collection).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * function duplicate(n) {
 *   return [n, n];
 * }
 *
 * _.flatMap([1, 2], duplicate);
 * // => [1, 1, 2, 2]
 */function flatMap(collection,iteratee){return baseFlatten(map(collection,iteratee),1);}/** Used as references for various `Number` constants. */var INFINITY$2=1/0;/**
 * This method is like `_.flatMap` except that it recursively flattens the
 * mapped results.
 *
 * @static
 * @memberOf _
 * @since 4.7.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * function duplicate(n) {
 *   return [[[n, n]]];
 * }
 *
 * _.flatMapDeep([1, 2], duplicate);
 * // => [1, 1, 2, 2]
 */function flatMapDeep(collection,iteratee){return baseFlatten(map(collection,iteratee),INFINITY$2);}/**
 * This method is like `_.flatMap` except that it recursively flattens the
 * mapped results up to `depth` times.
 *
 * @static
 * @memberOf _
 * @since 4.7.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @param {number} [depth=1] The maximum recursion depth.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * function duplicate(n) {
 *   return [[[n, n]]];
 * }
 *
 * _.flatMapDepth([1, 2], duplicate, 2);
 * // => [[1, 1], [2, 2]]
 */function flatMapDepth(collection,iteratee,depth){depth=depth===undefined?1:toInteger(depth);return baseFlatten(map(collection,iteratee),depth);}/** Used as references for various `Number` constants. */var INFINITY$1=1/0;/**
 * Recursively flattens `array`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to flatten.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * _.flattenDeep([1, [2, [3, [4]], 5]]);
 * // => [1, 2, 3, 4, 5]
 */function flattenDeep(array){var length=array==null?0:array.length;return length?baseFlatten(array,INFINITY$1):[];}/**
 * Recursively flatten `array` up to `depth` times.
 *
 * @static
 * @memberOf _
 * @since 4.4.0
 * @category Array
 * @param {Array} array The array to flatten.
 * @param {number} [depth=1] The maximum recursion depth.
 * @returns {Array} Returns the new flattened array.
 * @example
 *
 * var array = [1, [2, [3, [4]], 5]];
 *
 * _.flattenDepth(array, 1);
 * // => [1, 2, [3, [4]], 5]
 *
 * _.flattenDepth(array, 2);
 * // => [1, 2, 3, [4], 5]
 */function flattenDepth(array,depth){var length=array==null?0:array.length;if(!length){return[];}depth=depth===undefined?1:toInteger(depth);return baseFlatten(array,depth);}/** Used to compose bitmasks for function metadata. */var WRAP_FLIP_FLAG=512;/**
 * Creates a function that invokes `func` with arguments reversed.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Function
 * @param {Function} func The function to flip arguments for.
 * @returns {Function} Returns the new flipped function.
 * @example
 *
 * var flipped = _.flip(function() {
 *   return _.toArray(arguments);
 * });
 *
 * flipped('a', 'b', 'c', 'd');
 * // => ['d', 'c', 'b', 'a']
 */function flip(func){return createWrap(func,WRAP_FLIP_FLAG);}/**
 * Computes `number` rounded down to `precision`.
 *
 * @static
 * @memberOf _
 * @since 3.10.0
 * @category Math
 * @param {number} number The number to round down.
 * @param {number} [precision=0] The precision to round down to.
 * @returns {number} Returns the rounded down number.
 * @example
 *
 * _.floor(4.006);
 * // => 4
 *
 * _.floor(0.046, 2);
 * // => 0.04
 *
 * _.floor(4060, -2);
 * // => 4000
 */var floor=createRound('floor');/** Error message constants. */var FUNC_ERROR_TEXT$4='Expected a function';/** Used to compose bitmasks for function metadata. */var WRAP_CURRY_FLAG=8,WRAP_PARTIAL_FLAG$1=32,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG$1=256;/**
 * Creates a `_.flow` or `_.flowRight` function.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new flow function.
 */function createFlow(fromRight){return flatRest(function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;if(fromRight){funcs.reverse();}while(index--){var func=funcs[index];if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$4);}if(prereq&&!wrapper&&getFuncName(func)=='wrapper'){var wrapper=new LodashWrapper([],true);}}index=wrapper?index:length;while(++index<length){func=funcs[index];var funcName=getFuncName(func),data=funcName=='wrapper'?getData(func):undefined;if(data&&isLaziable(data[0])&&data[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG$1|WRAP_REARG_FLAG$1)&&!data[4].length&&data[9]==1){wrapper=wrapper[getFuncName(data[0])].apply(wrapper,data[3]);}else{wrapper=func.length==1&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func);}}return function(){var args=arguments,value=args[0];if(wrapper&&args.length==1&&isArray(value)){return wrapper.plant(value).value();}var index=0,result=length?funcs[index].apply(this,args):value;while(++index<length){result=funcs[index].call(this,result);}return result;};});}/**
 * Creates a function that returns the result of invoking the given functions
 * with the `this` binding of the created function, where each successive
 * invocation is supplied the return value of the previous.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Util
 * @param {...(Function|Function[])} [funcs] The functions to invoke.
 * @returns {Function} Returns the new composite function.
 * @see _.flowRight
 * @example
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * var addSquare = _.flow([_.add, square]);
 * addSquare(1, 2);
 * // => 9
 */var flow=createFlow();/**
 * This method is like `_.flow` except that it creates a function that
 * invokes the given functions from right to left.
 *
 * @static
 * @since 3.0.0
 * @memberOf _
 * @category Util
 * @param {...(Function|Function[])} [funcs] The functions to invoke.
 * @returns {Function} Returns the new composite function.
 * @see _.flow
 * @example
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * var addSquare = _.flowRight([square, _.add]);
 * addSquare(1, 2);
 * // => 9
 */var flowRight=createFlow(true);/**
 * Iterates over own and inherited enumerable string keyed properties of an
 * object and invokes `iteratee` for each property. The iteratee is invoked
 * with three arguments: (value, key, object). Iteratee functions may exit
 * iteration early by explicitly returning `false`.
 *
 * @static
 * @memberOf _
 * @since 0.3.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns `object`.
 * @see _.forInRight
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.forIn(new Foo, function(value, key) {
 *   console.log(key);
 * });
 * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).
 */function forIn(object,iteratee){return object==null?object:baseFor(object,castFunction(iteratee),keysIn);}/**
 * This method is like `_.forIn` except that it iterates over properties of
 * `object` in the opposite order.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns `object`.
 * @see _.forIn
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.forInRight(new Foo, function(value, key) {
 *   console.log(key);
 * });
 * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.
 */function forInRight(object,iteratee){return object==null?object:baseForRight(object,castFunction(iteratee),keysIn);}/**
 * Iterates over own enumerable string keyed properties of an object and
 * invokes `iteratee` for each property. The iteratee is invoked with three
 * arguments: (value, key, object). Iteratee functions may exit iteration
 * early by explicitly returning `false`.
 *
 * @static
 * @memberOf _
 * @since 0.3.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns `object`.
 * @see _.forOwnRight
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.forOwn(new Foo, function(value, key) {
 *   console.log(key);
 * });
 * // => Logs 'a' then 'b' (iteration order is not guaranteed).
 */function forOwn(object,iteratee){return object&&baseForOwn(object,castFunction(iteratee));}/**
 * This method is like `_.forOwn` except that it iterates over properties of
 * `object` in the opposite order.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns `object`.
 * @see _.forOwn
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.forOwnRight(new Foo, function(value, key) {
 *   console.log(key);
 * });
 * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.
 */function forOwnRight(object,iteratee){return object&&baseForOwnRight(object,castFunction(iteratee));}/**
 * The inverse of `_.toPairs`; this method returns an object composed
 * from key-value `pairs`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} pairs The key-value pairs.
 * @returns {Object} Returns the new object.
 * @example
 *
 * _.fromPairs([['a', 1], ['b', 2]]);
 * // => { 'a': 1, 'b': 2 }
 */function fromPairs(pairs){var index=-1,length=pairs==null?0:pairs.length,result={};while(++index<length){var pair=pairs[index];result[pair[0]]=pair[1];}return result;}/**
 * The base implementation of `_.functions` which creates an array of
 * `object` function property names filtered from `props`.
 *
 * @private
 * @param {Object} object The object to inspect.
 * @param {Array} props The property names to filter.
 * @returns {Array} Returns the function names.
 */function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key]);});}/**
 * Creates an array of function property names from own enumerable properties
 * of `object`.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to inspect.
 * @returns {Array} Returns the function names.
 * @see _.functionsIn
 * @example
 *
 * function Foo() {
 *   this.a = _.constant('a');
 *   this.b = _.constant('b');
 * }
 *
 * Foo.prototype.c = _.constant('c');
 *
 * _.functions(new Foo);
 * // => ['a', 'b']
 */function functions(object){return object==null?[]:baseFunctions(object,keys$1(object));}/**
 * Creates an array of function property names from own and inherited
 * enumerable properties of `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to inspect.
 * @returns {Array} Returns the function names.
 * @see _.functions
 * @example
 *
 * function Foo() {
 *   this.a = _.constant('a');
 *   this.b = _.constant('b');
 * }
 *
 * Foo.prototype.c = _.constant('c');
 *
 * _.functionsIn(new Foo);
 * // => ['a', 'b', 'c']
 */function functionsIn(object){return object==null?[]:baseFunctions(object,keysIn(object));}/** Used for built-in method references. */var objectProto$7=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$7=objectProto$7.hasOwnProperty;/**
 * Creates an object composed of keys generated from the results of running
 * each element of `collection` thru `iteratee`. The order of grouped values
 * is determined by the order they occur in `collection`. The corresponding
 * value of each key is an array of elements responsible for generating the
 * key. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
 * @returns {Object} Returns the composed aggregate object.
 * @example
 *
 * _.groupBy([6.1, 4.2, 6.3], Math.floor);
 * // => { '4': [4.2], '6': [6.1, 6.3] }
 *
 * // The `_.property` iteratee shorthand.
 * _.groupBy(['one', 'two', 'three'], 'length');
 * // => { '3': ['one', 'two'], '5': ['three'] }
 */var groupBy=createAggregator(function(result,value,key){if(hasOwnProperty$7.call(result,key)){result[key].push(value);}else{baseAssignValue(result,key,[value]);}});/**
 * The base implementation of `_.gt` which doesn't coerce arguments.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is greater than `other`,
 *  else `false`.
 */function baseGt(value,other){return value>other;}/**
 * Creates a function that performs a relational operation on two values.
 *
 * @private
 * @param {Function} operator The function to perform the operation.
 * @returns {Function} Returns the new relational operation function.
 */function createRelationalOperation(operator){return function(value,other){if(!(typeof value=='string'&&typeof other=='string')){value=toNumber(value);other=toNumber(other);}return operator(value,other);};}/**
 * Checks if `value` is greater than `other`.
 *
 * @static
 * @memberOf _
 * @since 3.9.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is greater than `other`,
 *  else `false`.
 * @see _.lt
 * @example
 *
 * _.gt(3, 1);
 * // => true
 *
 * _.gt(3, 3);
 * // => false
 *
 * _.gt(1, 3);
 * // => false
 */var gt=createRelationalOperation(baseGt);/**
 * Checks if `value` is greater than or equal to `other`.
 *
 * @static
 * @memberOf _
 * @since 3.9.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is greater than or equal to
 *  `other`, else `false`.
 * @see _.lte
 * @example
 *
 * _.gte(3, 1);
 * // => true
 *
 * _.gte(3, 3);
 * // => true
 *
 * _.gte(1, 3);
 * // => false
 */var gte=createRelationalOperation(function(value,other){return value>=other;});/** Used for built-in method references. */var objectProto$6=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$6=objectProto$6.hasOwnProperty;/**
 * The base implementation of `_.has` without support for deep paths.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {Array|string} key The key to check.
 * @returns {boolean} Returns `true` if `key` exists, else `false`.
 */function baseHas(object,key){return object!=null&&hasOwnProperty$6.call(object,key);}/**
 * Checks if `path` is a direct property of `object`.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path to check.
 * @returns {boolean} Returns `true` if `path` exists, else `false`.
 * @example
 *
 * var object = { 'a': { 'b': 2 } };
 * var other = _.create({ 'a': _.create({ 'b': 2 }) });
 *
 * _.has(object, 'a');
 * // => true
 *
 * _.has(object, 'a.b');
 * // => true
 *
 * _.has(object, ['a', 'b']);
 * // => true
 *
 * _.has(other, 'a');
 * // => false
 */function has(object,path){return object!=null&&hasPath(object,path,baseHas);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$8=Math.max,nativeMin$9=Math.min;/**
 * The base implementation of `_.inRange` which doesn't coerce arguments.
 *
 * @private
 * @param {number} number The number to check.
 * @param {number} start The start of the range.
 * @param {number} end The end of the range.
 * @returns {boolean} Returns `true` if `number` is in the range, else `false`.
 */function baseInRange(number,start,end){return number>=nativeMin$9(start,end)&&number<nativeMax$8(start,end);}/**
 * Checks if `n` is between `start` and up to, but not including, `end`. If
 * `end` is not specified, it's set to `start` with `start` then set to `0`.
 * If `start` is greater than `end` the params are swapped to support
 * negative ranges.
 *
 * @static
 * @memberOf _
 * @since 3.3.0
 * @category Number
 * @param {number} number The number to check.
 * @param {number} [start=0] The start of the range.
 * @param {number} end The end of the range.
 * @returns {boolean} Returns `true` if `number` is in the range, else `false`.
 * @see _.range, _.rangeRight
 * @example
 *
 * _.inRange(3, 2, 4);
 * // => true
 *
 * _.inRange(4, 8);
 * // => true
 *
 * _.inRange(4, 2);
 * // => false
 *
 * _.inRange(2, 2);
 * // => false
 *
 * _.inRange(1.2, 2);
 * // => true
 *
 * _.inRange(5.2, 4);
 * // => false
 *
 * _.inRange(-3, -2, -6);
 * // => true
 */function inRange(number,start,end){start=toFinite(start);if(end===undefined){end=start;start=0;}else{end=toFinite(end);}number=toNumber(number);return baseInRange(number,start,end);}/** `Object#toString` result references. */var stringTag='[object String]';/**
 * Checks if `value` is classified as a `String` primitive or object.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a string, else `false`.
 * @example
 *
 * _.isString('abc');
 * // => true
 *
 * _.isString(1);
 * // => false
 */function isString(value){return typeof value=='string'||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag;}/**
 * The base implementation of `_.values` and `_.valuesIn` which creates an
 * array of `object` property values corresponding to the property names
 * of `props`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array} props The property names to get values for.
 * @returns {Object} Returns the array of property values.
 */function baseValues(object,props){return arrayMap(props,function(key){return object[key];});}/**
 * Creates an array of the own enumerable string keyed property values of `object`.
 *
 * **Note:** Non-object values are coerced to objects.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property values.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.values(new Foo);
 * // => [1, 2] (iteration order is not guaranteed)
 *
 * _.values('hi');
 * // => ['h', 'i']
 */function values(object){return object==null?[]:baseValues(object,keys$1(object));}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$7=Math.max;/**
 * Checks if `value` is in `collection`. If `collection` is a string, it's
 * checked for a substring of `value`, otherwise
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * is used for equality comparisons. If `fromIndex` is negative, it's used as
 * the offset from the end of `collection`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object|string} collection The collection to inspect.
 * @param {*} value The value to search for.
 * @param {number} [fromIndex=0] The index to search from.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.
 * @returns {boolean} Returns `true` if `value` is found, else `false`.
 * @example
 *
 * _.includes([1, 2, 3], 1);
 * // => true
 *
 * _.includes([1, 2, 3], 1, 2);
 * // => false
 *
 * _.includes({ 'a': 1, 'b': 2 }, 1);
 * // => true
 *
 * _.includes('abcd', 'bc');
 * // => true
 */function includes(collection,value,fromIndex,guard){collection=isArrayLike(collection)?collection:values(collection);fromIndex=fromIndex&&!guard?toInteger(fromIndex):0;var length=collection.length;if(fromIndex<0){fromIndex=nativeMax$7(length+fromIndex,0);}return isString(collection)?fromIndex<=length&&collection.indexOf(value,fromIndex)>-1:!!length&&baseIndexOf(collection,value,fromIndex)>-1;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$6=Math.max;/**
 * Gets the index at which the first occurrence of `value` is found in `array`
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons. If `fromIndex` is negative, it's used as the
 * offset from the end of `array`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} [fromIndex=0] The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 * @example
 *
 * _.indexOf([1, 2, 1, 2], 2);
 * // => 1
 *
 * // Search from the `fromIndex`.
 * _.indexOf([1, 2, 1, 2], 2, 2);
 * // => 3
 */function indexOf(array,value,fromIndex){var length=array==null?0:array.length;if(!length){return-1;}var index=fromIndex==null?0:toInteger(fromIndex);if(index<0){index=nativeMax$6(length+index,0);}return baseIndexOf(array,value,index);}/**
 * Gets all but the last element of `array`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to query.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.initial([1, 2, 3]);
 * // => [1, 2]
 */function initial(array){var length=array==null?0:array.length;return length?baseSlice(array,0,-1):[];}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$8=Math.min;/**
 * The base implementation of methods like `_.intersection`, without support
 * for iteratee shorthands, that accepts an array of arrays to inspect.
 *
 * @private
 * @param {Array} arrays The arrays to inspect.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of shared values.
 */function baseIntersection(arrays,iteratee,comparator){var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=Infinity,result=[];while(othIndex--){var array=arrays[othIndex];if(othIndex&&iteratee){array=arrayMap(array,baseUnary(iteratee));}maxLength=nativeMin$8(array.length,maxLength);caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):undefined;}array=arrays[0];var index=-1,seen=caches[0];outer:while(++index<length&&result.length<maxLength){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){othIndex=othLength;while(--othIndex){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator))){continue outer;}}if(seen){seen.push(computed);}result.push(value);}}return result;}/**
 * Casts `value` to an empty array if it's not an array like object.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {Array|Object} Returns the cast array-like object.
 */function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[];}/**
 * Creates an array of unique values that are included in all given arrays
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons. The order and references of result values are
 * determined by the first array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @returns {Array} Returns the new array of intersecting values.
 * @example
 *
 * _.intersection([2, 1], [2, 3]);
 * // => [2]
 */var intersection=baseRest(function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[];});/**
 * This method is like `_.intersection` except that it accepts `iteratee`
 * which is invoked for each element of each `arrays` to generate the criterion
 * by which they're compared. The order and references of result values are
 * determined by the first array. The iteratee is invoked with one argument:
 * (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns the new array of intersecting values.
 * @example
 *
 * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);
 * // => [2.1]
 *
 * // The `_.property` iteratee shorthand.
 * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
 * // => [{ 'x': 1 }]
 */var intersectionBy=baseRest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);if(iteratee===last(mapped)){iteratee=undefined;}else{mapped.pop();}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,baseIteratee(iteratee)):[];});/**
 * This method is like `_.intersection` except that it accepts `comparator`
 * which is invoked to compare elements of `arrays`. The order and references
 * of result values are determined by the first array. The comparator is
 * invoked with two arguments: (arrVal, othVal).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of intersecting values.
 * @example
 *
 * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
 * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
 *
 * _.intersectionWith(objects, others, _.isEqual);
 * // => [{ 'x': 1, 'y': 2 }]
 */var intersectionWith=baseRest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);comparator=typeof comparator=='function'?comparator:undefined;if(comparator){mapped.pop();}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,undefined,comparator):[];});/**
 * The base implementation of `_.invert` and `_.invertBy` which inverts
 * `object` with values transformed by `iteratee` and set by `setter`.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} setter The function to set `accumulator` values.
 * @param {Function} iteratee The iteratee to transform values.
 * @param {Object} accumulator The initial inverted object.
 * @returns {Function} Returns `accumulator`.
 */function baseInverter(object,setter,iteratee,accumulator){baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object);});return accumulator;}/**
 * Creates a function like `_.invertBy`.
 *
 * @private
 * @param {Function} setter The function to set accumulator values.
 * @param {Function} toIteratee The function to resolve iteratees.
 * @returns {Function} Returns the new inverter function.
 */function createInverter(setter,toIteratee){return function(object,iteratee){return baseInverter(object,setter,toIteratee(iteratee),{});};}/** Used for built-in method references. */var objectProto$5=Object.prototype;/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */var nativeObjectToString$1=objectProto$5.toString;/**
 * Creates an object composed of the inverted keys and values of `object`.
 * If `object` contains duplicate values, subsequent values overwrite
 * property assignments of previous values.
 *
 * @static
 * @memberOf _
 * @since 0.7.0
 * @category Object
 * @param {Object} object The object to invert.
 * @returns {Object} Returns the new inverted object.
 * @example
 *
 * var object = { 'a': 1, 'b': 2, 'c': 1 };
 *
 * _.invert(object);
 * // => { '1': 'c', '2': 'b' }
 */var invert=createInverter(function(result,value,key){if(value!=null&&typeof value.toString!='function'){value=nativeObjectToString$1.call(value);}result[value]=key;},constant(identity));/** Used for built-in method references. */var objectProto$4=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$5=objectProto$4.hasOwnProperty;/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */var nativeObjectToString=objectProto$4.toString;/**
 * This method is like `_.invert` except that the inverted object is generated
 * from the results of running each element of `object` thru `iteratee`. The
 * corresponding inverted value of each inverted key is an array of keys
 * responsible for generating the inverted value. The iteratee is invoked
 * with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.1.0
 * @category Object
 * @param {Object} object The object to invert.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Object} Returns the new inverted object.
 * @example
 *
 * var object = { 'a': 1, 'b': 2, 'c': 1 };
 *
 * _.invertBy(object);
 * // => { '1': ['a', 'c'], '2': ['b'] }
 *
 * _.invertBy(object, function(value) {
 *   return 'group' + value;
 * });
 * // => { 'group1': ['a', 'c'], 'group2': ['b'] }
 */var invertBy=createInverter(function(result,value,key){if(value!=null&&typeof value.toString!='function'){value=nativeObjectToString.call(value);}if(hasOwnProperty$5.call(result,value)){result[value].push(key);}else{result[value]=[key];}},baseIteratee);/**
 * Gets the parent value at `path` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array} path The path to get the parent value of.
 * @returns {*} Returns the parent value.
 */function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1));}/**
 * The base implementation of `_.invoke` without support for individual
 * method arguments.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the method to invoke.
 * @param {Array} args The arguments to invoke the method with.
 * @returns {*} Returns the result of the invoked method.
 */function baseInvoke(object,path,args){path=castPath(path,object);object=parent(object,path);var func=object==null?object:object[toKey(last(path))];return func==null?undefined:apply(func,object,args);}/**
 * Invokes the method at `path` of `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the method to invoke.
 * @param {...*} [args] The arguments to invoke the method with.
 * @returns {*} Returns the result of the invoked method.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };
 *
 * _.invoke(object, 'a[0].b.c.slice', 1, 3);
 * // => [2, 3]
 */var invoke=baseRest(baseInvoke);/**
 * Invokes the method at `path` of each element in `collection`, returning
 * an array of the results of each invoked method. Any additional arguments
 * are provided to each invoked method. If `path` is a function, it's invoked
 * for, and `this` bound to, each element in `collection`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Array|Function|string} path The path of the method to invoke or
 *  the function invoked per iteration.
 * @param {...*} [args] The arguments to invoke each method with.
 * @returns {Array} Returns the array of results.
 * @example
 *
 * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');
 * // => [[1, 5, 7], [1, 2, 3]]
 *
 * _.invokeMap([123, 456], String.prototype.split, '');
 * // => [['1', '2', '3'], ['4', '5', '6']]
 */var invokeMap=baseRest(function(collection,path,args){var index=-1,isFunc=typeof path=='function',result=isArrayLike(collection)?Array(collection.length):[];baseEach(collection,function(value){result[++index]=isFunc?apply(path,value,args):baseInvoke(value,path,args);});return result;});var arrayBufferTag='[object ArrayBuffer]';/**
 * The base implementation of `_.isArrayBuffer` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.
 */function baseIsArrayBuffer(value){return isObjectLike(value)&&baseGetTag(value)==arrayBufferTag;}/* Node.js helper references. */var nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer;/**
 * Checks if `value` is classified as an `ArrayBuffer` object.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.
 * @example
 *
 * _.isArrayBuffer(new ArrayBuffer(2));
 * // => true
 *
 * _.isArrayBuffer(new Array(2));
 * // => false
 */var isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):baseIsArrayBuffer;/** `Object#toString` result references. */var boolTag='[object Boolean]';/**
 * Checks if `value` is classified as a boolean primitive or object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.
 * @example
 *
 * _.isBoolean(false);
 * // => true
 *
 * _.isBoolean(null);
 * // => false
 */function isBoolean(value){return value===true||value===false||isObjectLike(value)&&baseGetTag(value)==boolTag;}/** `Object#toString` result references. */var dateTag='[object Date]';/**
 * The base implementation of `_.isDate` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a date object, else `false`.
 */function baseIsDate(value){return isObjectLike(value)&&baseGetTag(value)==dateTag;}/* Node.js helper references. */var nodeIsDate=nodeUtil&&nodeUtil.isDate;/**
 * Checks if `value` is classified as a `Date` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a date object, else `false`.
 * @example
 *
 * _.isDate(new Date);
 * // => true
 *
 * _.isDate('Mon April 23 2012');
 * // => false
 */var isDate=nodeIsDate?baseUnary(nodeIsDate):baseIsDate;/**
 * Checks if `value` is likely a DOM element.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.
 * @example
 *
 * _.isElement(document.body);
 * // => true
 *
 * _.isElement('<body>');
 * // => false
 */function isElement(value){return isObjectLike(value)&&value.nodeType===1&&!isPlainObject(value);}/** `Object#toString` result references. */var mapTag$2='[object Map]',setTag$2='[object Set]';/** Used for built-in method references. */var objectProto$3=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$4=objectProto$3.hasOwnProperty;/**
 * Checks if `value` is an empty object, collection, map, or set.
 *
 * Objects are considered empty if they have no own enumerable string keyed
 * properties.
 *
 * Array-like values such as `arguments` objects, arrays, buffers, strings, or
 * jQuery-like collections are considered empty if they have a `length` of `0`.
 * Similarly, maps and sets are considered empty if they have a `size` of `0`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is empty, else `false`.
 * @example
 *
 * _.isEmpty(null);
 * // => true
 *
 * _.isEmpty(true);
 * // => true
 *
 * _.isEmpty(1);
 * // => true
 *
 * _.isEmpty([1, 2, 3]);
 * // => false
 *
 * _.isEmpty({ 'a': 1 });
 * // => false
 */function isEmpty(value){if(value==null){return true;}if(isArrayLike(value)&&(isArray(value)||typeof value=='string'||typeof value.splice=='function'||isBuffer(value)||isTypedArray(value)||isArguments(value))){return!value.length;}var tag=getTag$1(value);if(tag==mapTag$2||tag==setTag$2){return!value.size;}if(isPrototype(value)){return!baseKeys(value).length;}for(var key in value){if(hasOwnProperty$4.call(value,key)){return false;}}return true;}/**
 * Performs a deep comparison between two values to determine if they are
 * equivalent.
 *
 * **Note:** This method supports comparing arrays, array buffers, booleans,
 * date objects, error objects, maps, numbers, `Object` objects, regexes,
 * sets, strings, symbols, and typed arrays. `Object` objects are compared
 * by their own, not inherited, enumerable properties. Functions and DOM
 * nodes are compared by strict equality, i.e. `===`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.isEqual(object, other);
 * // => true
 *
 * object === other;
 * // => false
 */function isEqual$1(value,other){return baseIsEqual(value,other);}/**
 * This method is like `_.isEqual` except that it accepts `customizer` which
 * is invoked to compare values. If `customizer` returns `undefined`, comparisons
 * are handled by the method instead. The `customizer` is invoked with up to
 * six arguments: (objValue, othValue [, index|key, object, other, stack]).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @param {Function} [customizer] The function to customize comparisons.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * function isGreeting(value) {
 *   return /^h(?:i|ello)$/.test(value);
 * }
 *
 * function customizer(objValue, othValue) {
 *   if (isGreeting(objValue) && isGreeting(othValue)) {
 *     return true;
 *   }
 * }
 *
 * var array = ['hello', 'goodbye'];
 * var other = ['hi', 'goodbye'];
 *
 * _.isEqualWith(array, other, customizer);
 * // => true
 */function isEqualWith(value,other,customizer){customizer=typeof customizer=='function'?customizer:undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,undefined,customizer):!!result;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeIsFinite=root.isFinite;/**
 * Checks if `value` is a finite primitive number.
 *
 * **Note:** This method is based on
 * [`Number.isFinite`](https://mdn.io/Number/isFinite).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.
 * @example
 *
 * _.isFinite(3);
 * // => true
 *
 * _.isFinite(Number.MIN_VALUE);
 * // => true
 *
 * _.isFinite(Infinity);
 * // => false
 *
 * _.isFinite('3');
 * // => false
 */function isFinite$1(value){return typeof value=='number'&&nativeIsFinite(value);}/**
 * Checks if `value` is an integer.
 *
 * **Note:** This method is based on
 * [`Number.isInteger`](https://mdn.io/Number/isInteger).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an integer, else `false`.
 * @example
 *
 * _.isInteger(3);
 * // => true
 *
 * _.isInteger(Number.MIN_VALUE);
 * // => false
 *
 * _.isInteger(Infinity);
 * // => false
 *
 * _.isInteger('3');
 * // => false
 */function isInteger(value){return typeof value=='number'&&value==toInteger(value);}/**
 * Performs a partial deep comparison between `object` and `source` to
 * determine if `object` contains equivalent property values.
 *
 * **Note:** This method is equivalent to `_.matches` when `source` is
 * partially applied.
 *
 * Partial comparisons will match empty array and empty object `source`
 * values against any array or object value, respectively. See `_.isEqual`
 * for a list of supported value comparisons.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property values to match.
 * @returns {boolean} Returns `true` if `object` is a match, else `false`.
 * @example
 *
 * var object = { 'a': 1, 'b': 2 };
 *
 * _.isMatch(object, { 'b': 2 });
 * // => true
 *
 * _.isMatch(object, { 'b': 1 });
 * // => false
 */function isMatch(object,source){return object===source||baseIsMatch(object,source,getMatchData(source));}/**
 * This method is like `_.isMatch` except that it accepts `customizer` which
 * is invoked to compare values. If `customizer` returns `undefined`, comparisons
 * are handled by the method instead. The `customizer` is invoked with five
 * arguments: (objValue, srcValue, index|key, object, source).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property values to match.
 * @param {Function} [customizer] The function to customize comparisons.
 * @returns {boolean} Returns `true` if `object` is a match, else `false`.
 * @example
 *
 * function isGreeting(value) {
 *   return /^h(?:i|ello)$/.test(value);
 * }
 *
 * function customizer(objValue, srcValue) {
 *   if (isGreeting(objValue) && isGreeting(srcValue)) {
 *     return true;
 *   }
 * }
 *
 * var object = { 'greeting': 'hello' };
 * var source = { 'greeting': 'hi' };
 *
 * _.isMatchWith(object, source, customizer);
 * // => true
 */function isMatchWith(object,source,customizer){customizer=typeof customizer=='function'?customizer:undefined;return baseIsMatch(object,source,getMatchData(source),customizer);}/** `Object#toString` result references. */var numberTag='[object Number]';/**
 * Checks if `value` is classified as a `Number` primitive or object.
 *
 * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are
 * classified as numbers, use the `_.isFinite` method.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a number, else `false`.
 * @example
 *
 * _.isNumber(3);
 * // => true
 *
 * _.isNumber(Number.MIN_VALUE);
 * // => true
 *
 * _.isNumber(Infinity);
 * // => true
 *
 * _.isNumber('3');
 * // => false
 */function isNumber(value){return typeof value=='number'||isObjectLike(value)&&baseGetTag(value)==numberTag;}/**
 * Checks if `value` is `NaN`.
 *
 * **Note:** This method is based on
 * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as
 * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for
 * `undefined` and other non-number values.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
 * @example
 *
 * _.isNaN(NaN);
 * // => true
 *
 * _.isNaN(new Number(NaN));
 * // => true
 *
 * isNaN(undefined);
 * // => true
 *
 * _.isNaN(undefined);
 * // => false
 */function isNaN$1(value){// An `NaN` primitive is the only value that is not equal to itself.
// Perform the `toStringTag` check first to avoid errors with some
// ActiveX objects in IE.
return isNumber(value)&&value!=+value;}/**
 * Checks if `func` is capable of being masked.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `func` is maskable, else `false`.
 */var isMaskable=coreJsData?isFunction:stubFalse;/** Error message constants. */var CORE_ERROR_TEXT='Unsupported core-js use. Try https://npms.io/search?q=ponyfill.';/**
 * Checks if `value` is a pristine native function.
 *
 * **Note:** This method can't reliably detect native functions in the presence
 * of the core-js package because core-js circumvents this kind of detection.
 * Despite multiple requests, the core-js maintainer has made it clear: any
 * attempt to fix the detection will be obstructed. As a result, we're left
 * with little choice but to throw an error. Unfortunately, this also affects
 * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),
 * which rely on core-js.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 * @example
 *
 * _.isNative(Array.prototype.push);
 * // => true
 *
 * _.isNative(_);
 * // => false
 */function isNative(value){if(isMaskable(value)){throw new Error(CORE_ERROR_TEXT);}return baseIsNative(value);}/**
 * Checks if `value` is `null` or `undefined`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is nullish, else `false`.
 * @example
 *
 * _.isNil(null);
 * // => true
 *
 * _.isNil(void 0);
 * // => true
 *
 * _.isNil(NaN);
 * // => false
 */function isNil(value){return value==null;}/**
 * Checks if `value` is `null`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `null`, else `false`.
 * @example
 *
 * _.isNull(null);
 * // => true
 *
 * _.isNull(void 0);
 * // => false
 */function isNull(value){return value===null;}/** `Object#toString` result references. */var regexpTag='[object RegExp]';/**
 * The base implementation of `_.isRegExp` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.
 */function baseIsRegExp(value){return isObjectLike(value)&&baseGetTag(value)==regexpTag;}/* Node.js helper references. */var nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp;/**
 * Checks if `value` is classified as a `RegExp` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.
 * @example
 *
 * _.isRegExp(/abc/);
 * // => true
 *
 * _.isRegExp('/abc/');
 * // => false
 */var isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp;/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER$3=9007199254740991;/**
 * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754
 * double precision number which isn't the result of a rounded unsafe integer.
 *
 * **Note:** This method is based on
 * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.
 * @example
 *
 * _.isSafeInteger(3);
 * // => true
 *
 * _.isSafeInteger(Number.MIN_VALUE);
 * // => false
 *
 * _.isSafeInteger(Infinity);
 * // => false
 *
 * _.isSafeInteger('3');
 * // => false
 */function isSafeInteger(value){return isInteger(value)&&value>=-MAX_SAFE_INTEGER$3&&value<=MAX_SAFE_INTEGER$3;}/**
 * Checks if `value` is `undefined`.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.
 * @example
 *
 * _.isUndefined(void 0);
 * // => true
 *
 * _.isUndefined(null);
 * // => false
 */function isUndefined(value){return value===undefined;}/** `Object#toString` result references. */var weakMapTag='[object WeakMap]';/**
 * Checks if `value` is classified as a `WeakMap` object.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.
 * @example
 *
 * _.isWeakMap(new WeakMap);
 * // => true
 *
 * _.isWeakMap(new Map);
 * // => false
 */function isWeakMap(value){return isObjectLike(value)&&getTag$1(value)==weakMapTag;}/** `Object#toString` result references. */var weakSetTag='[object WeakSet]';/**
 * Checks if `value` is classified as a `WeakSet` object.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.
 * @example
 *
 * _.isWeakSet(new WeakSet);
 * // => true
 *
 * _.isWeakSet(new Set);
 * // => false
 */function isWeakSet(value){return isObjectLike(value)&&baseGetTag(value)==weakSetTag;}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$3=1;/**
 * Creates a function that invokes `func` with the arguments of the created
 * function. If `func` is a property name, the created function returns the
 * property value for a given element. If `func` is an array or object, the
 * created function returns `true` for elements that contain the equivalent
 * source properties, otherwise it returns `false`.
 *
 * @static
 * @since 4.0.0
 * @memberOf _
 * @category Util
 * @param {*} [func=_.identity] The value to convert to a callback.
 * @returns {Function} Returns the callback.
 * @example
 *
 * var users = [
 *   { 'user': 'barney', 'age': 36, 'active': true },
 *   { 'user': 'fred',   'age': 40, 'active': false }
 * ];
 *
 * // The `_.matches` iteratee shorthand.
 * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));
 * // => [{ 'user': 'barney', 'age': 36, 'active': true }]
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.filter(users, _.iteratee(['user', 'fred']));
 * // => [{ 'user': 'fred', 'age': 40 }]
 *
 * // The `_.property` iteratee shorthand.
 * _.map(users, _.iteratee('user'));
 * // => ['barney', 'fred']
 *
 * // Create custom iteratee shorthands.
 * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {
 *   return !_.isRegExp(func) ? iteratee(func) : function(string) {
 *     return func.test(string);
 *   };
 * });
 *
 * _.filter(['abc', 'def'], /ef/);
 * // => ['def']
 */function iteratee(func){return baseIteratee(typeof func=='function'?func:baseClone(func,CLONE_DEEP_FLAG$3));}/** Used for built-in method references. */var arrayProto$4=Array.prototype;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeJoin=arrayProto$4.join;/**
 * Converts all elements in `array` into a string separated by `separator`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to convert.
 * @param {string} [separator=','] The element separator.
 * @returns {string} Returns the joined string.
 * @example
 *
 * _.join(['a', 'b', 'c'], '~');
 * // => 'a~b~c'
 */function join(array,separator){return array==null?'':nativeJoin.call(array,separator);}/**
 * Converts `string` to
 * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the kebab cased string.
 * @example
 *
 * _.kebabCase('Foo Bar');
 * // => 'foo-bar'
 *
 * _.kebabCase('fooBar');
 * // => 'foo-bar'
 *
 * _.kebabCase('__FOO_BAR__');
 * // => 'foo-bar'
 */var kebabCase=createCompounder(function(result,word,index){return result+(index?'-':'')+word.toLowerCase();});/**
 * Creates an object composed of keys generated from the results of running
 * each element of `collection` thru `iteratee`. The corresponding value of
 * each key is the last element responsible for generating the key. The
 * iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
 * @returns {Object} Returns the composed aggregate object.
 * @example
 *
 * var array = [
 *   { 'dir': 'left', 'code': 97 },
 *   { 'dir': 'right', 'code': 100 }
 * ];
 *
 * _.keyBy(array, function(o) {
 *   return String.fromCharCode(o.code);
 * });
 * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
 *
 * _.keyBy(array, 'dir');
 * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }
 */var keyBy=createAggregator(function(result,value,key){baseAssignValue(result,key,value);});/**
 * A specialized version of `_.lastIndexOf` which performs strict equality
 * comparisons of values, i.e. `===`.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function strictLastIndexOf(array,value,fromIndex){var index=fromIndex+1;while(index--){if(array[index]===value){return index;}}return index;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$5=Math.max,nativeMin$7=Math.min;/**
 * This method is like `_.indexOf` except that it iterates over elements of
 * `array` from right to left.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} [fromIndex=array.length-1] The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 * @example
 *
 * _.lastIndexOf([1, 2, 1, 2], 2);
 * // => 3
 *
 * // Search from the `fromIndex`.
 * _.lastIndexOf([1, 2, 1, 2], 2, 2);
 * // => 1
 */function lastIndexOf(array,value,fromIndex){var length=array==null?0:array.length;if(!length){return-1;}var index=length;if(fromIndex!==undefined){index=toInteger(fromIndex);index=index<0?nativeMax$5(length+index,0):nativeMin$7(index,length-1);}return value===value?strictLastIndexOf(array,value,index):baseFindIndex(array,baseIsNaN,index,true);}/**
 * Converts `string`, as space separated words, to lower case.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the lower cased string.
 * @example
 *
 * _.lowerCase('--Foo-Bar--');
 * // => 'foo bar'
 *
 * _.lowerCase('fooBar');
 * // => 'foo bar'
 *
 * _.lowerCase('__FOO_BAR__');
 * // => 'foo bar'
 */var lowerCase=createCompounder(function(result,word,index){return result+(index?' ':'')+word.toLowerCase();});/**
 * Converts the first character of `string` to lower case.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the converted string.
 * @example
 *
 * _.lowerFirst('Fred');
 * // => 'fred'
 *
 * _.lowerFirst('FRED');
 * // => 'fRED'
 */var lowerFirst=createCaseFirst('toLowerCase');/**
 * The base implementation of `_.lt` which doesn't coerce arguments.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is less than `other`,
 *  else `false`.
 */function baseLt(value,other){return value<other;}/**
 * Checks if `value` is less than `other`.
 *
 * @static
 * @memberOf _
 * @since 3.9.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is less than `other`,
 *  else `false`.
 * @see _.gt
 * @example
 *
 * _.lt(1, 3);
 * // => true
 *
 * _.lt(3, 3);
 * // => false
 *
 * _.lt(3, 1);
 * // => false
 */var lt=createRelationalOperation(baseLt);/**
 * Checks if `value` is less than or equal to `other`.
 *
 * @static
 * @memberOf _
 * @since 3.9.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if `value` is less than or equal to
 *  `other`, else `false`.
 * @see _.gte
 * @example
 *
 * _.lte(1, 3);
 * // => true
 *
 * _.lte(3, 3);
 * // => true
 *
 * _.lte(3, 1);
 * // => false
 */var lte=createRelationalOperation(function(value,other){return value<=other;});/**
 * The opposite of `_.mapValues`; this method creates an object with the
 * same values as `object` and keys generated by running each own enumerable
 * string keyed property of `object` thru `iteratee`. The iteratee is invoked
 * with three arguments: (value, key, object).
 *
 * @static
 * @memberOf _
 * @since 3.8.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns the new mapped object.
 * @see _.mapValues
 * @example
 *
 * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {
 *   return key + value;
 * });
 * // => { 'a1': 1, 'b2': 2 }
 */function mapKeys(object,iteratee){var result={};iteratee=baseIteratee(iteratee);baseForOwn(object,function(value,key,object){baseAssignValue(result,iteratee(value,key,object),value);});return result;}/**
 * Creates an object with the same keys as `object` and values generated
 * by running each own enumerable string keyed property of `object` thru
 * `iteratee`. The iteratee is invoked with three arguments:
 * (value, key, object).
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Object} Returns the new mapped object.
 * @see _.mapKeys
 * @example
 *
 * var users = {
 *   'fred':    { 'user': 'fred',    'age': 40 },
 *   'pebbles': { 'user': 'pebbles', 'age': 1 }
 * };
 *
 * _.mapValues(users, function(o) { return o.age; });
 * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
 *
 * // The `_.property` iteratee shorthand.
 * _.mapValues(users, 'age');
 * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
 */function mapValues(object,iteratee){var result={};iteratee=baseIteratee(iteratee);baseForOwn(object,function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object));});return result;}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$2=1;/**
 * Creates a function that performs a partial deep comparison between a given
 * object and `source`, returning `true` if the given object has equivalent
 * property values, else `false`.
 *
 * **Note:** The created function is equivalent to `_.isMatch` with `source`
 * partially applied.
 *
 * Partial comparisons will match empty array and empty object `source`
 * values against any array or object value, respectively. See `_.isEqual`
 * for a list of supported value comparisons.
 *
 * **Note:** Multiple values can be checked by combining several matchers
 * using `_.overSome`
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Util
 * @param {Object} source The object of property values to match.
 * @returns {Function} Returns the new spec function.
 * @example
 *
 * var objects = [
 *   { 'a': 1, 'b': 2, 'c': 3 },
 *   { 'a': 4, 'b': 5, 'c': 6 }
 * ];
 *
 * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));
 * // => [{ 'a': 4, 'b': 5, 'c': 6 }]
 *
 * // Checking for several possible values
 * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));
 * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]
 */function matches(source){return baseMatches(baseClone(source,CLONE_DEEP_FLAG$2));}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG$1=1;/**
 * Creates a function that performs a partial deep comparison between the
 * value at `path` of a given object to `srcValue`, returning `true` if the
 * object value is equivalent, else `false`.
 *
 * **Note:** Partial comparisons will match empty array and empty object
 * `srcValue` values against any array or object value, respectively. See
 * `_.isEqual` for a list of supported value comparisons.
 *
 * **Note:** Multiple values can be checked by combining several matchers
 * using `_.overSome`
 *
 * @static
 * @memberOf _
 * @since 3.2.0
 * @category Util
 * @param {Array|string} path The path of the property to get.
 * @param {*} srcValue The value to match.
 * @returns {Function} Returns the new spec function.
 * @example
 *
 * var objects = [
 *   { 'a': 1, 'b': 2, 'c': 3 },
 *   { 'a': 4, 'b': 5, 'c': 6 }
 * ];
 *
 * _.find(objects, _.matchesProperty('a', 4));
 * // => { 'a': 4, 'b': 5, 'c': 6 }
 *
 * // Checking for several possible values
 * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));
 * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]
 */function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,CLONE_DEEP_FLAG$1));}/**
 * The base implementation of methods like `_.max` and `_.min` which accepts a
 * `comparator` to determine the extremum value.
 *
 * @private
 * @param {Array} array The array to iterate over.
 * @param {Function} iteratee The iteratee invoked per iteration.
 * @param {Function} comparator The comparator used to compare values.
 * @returns {*} Returns the extremum value.
 */function baseExtremum(array,iteratee,comparator){var index=-1,length=array.length;while(++index<length){var value=array[index],current=iteratee(value);if(current!=null&&(computed===undefined?current===current&&!isSymbol(current):comparator(current,computed))){var computed=current,result=value;}}return result;}/**
 * Computes the maximum value of `array`. If `array` is empty or falsey,
 * `undefined` is returned.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Math
 * @param {Array} array The array to iterate over.
 * @returns {*} Returns the maximum value.
 * @example
 *
 * _.max([4, 2, 8, 6]);
 * // => 8
 *
 * _.max([]);
 * // => undefined
 */function max(array){return array&&array.length?baseExtremum(array,identity,baseGt):undefined;}/**
 * This method is like `_.max` except that it accepts `iteratee` which is
 * invoked for each element in `array` to generate the criterion by which
 * the value is ranked. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {*} Returns the maximum value.
 * @example
 *
 * var objects = [{ 'n': 1 }, { 'n': 2 }];
 *
 * _.maxBy(objects, function(o) { return o.n; });
 * // => { 'n': 2 }
 *
 * // The `_.property` iteratee shorthand.
 * _.maxBy(objects, 'n');
 * // => { 'n': 2 }
 */function maxBy(array,iteratee){return array&&array.length?baseExtremum(array,baseIteratee(iteratee),baseGt):undefined;}/**
 * The base implementation of `_.sum` and `_.sumBy` without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {number} Returns the sum.
 */function baseSum(array,iteratee){var result,index=-1,length=array.length;while(++index<length){var current=iteratee(array[index]);if(current!==undefined){result=result===undefined?current:result+current;}}return result;}/** Used as references for various `Number` constants. */var NAN=0/0;/**
 * The base implementation of `_.mean` and `_.meanBy` without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {number} Returns the mean.
 */function baseMean(array,iteratee){var length=array==null?0:array.length;return length?baseSum(array,iteratee)/length:NAN;}/**
 * Computes the mean of the values in `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @returns {number} Returns the mean.
 * @example
 *
 * _.mean([4, 2, 8, 6]);
 * // => 5
 */function mean(array){return baseMean(array,identity);}/**
 * This method is like `_.mean` except that it accepts `iteratee` which is
 * invoked for each element in `array` to generate the value to be averaged.
 * The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.7.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {number} Returns the mean.
 * @example
 *
 * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];
 *
 * _.meanBy(objects, function(o) { return o.n; });
 * // => 5
 *
 * // The `_.property` iteratee shorthand.
 * _.meanBy(objects, 'n');
 * // => 5
 */function meanBy(array,iteratee){return baseMean(array,baseIteratee(iteratee));}/**
 * This method is like `_.assign` except that it recursively merges own and
 * inherited enumerable string keyed properties of source objects into the
 * destination object. Source properties that resolve to `undefined` are
 * skipped if a destination value exists. Array and plain object properties
 * are merged recursively. Other objects and value types are overridden by
 * assignment. Source objects are applied from left to right. Subsequent
 * sources overwrite property assignments of previous sources.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 0.5.0
 * @category Object
 * @param {Object} object The destination object.
 * @param {...Object} [sources] The source objects.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = {
 *   'a': [{ 'b': 2 }, { 'd': 4 }]
 * };
 *
 * var other = {
 *   'a': [{ 'c': 3 }, { 'e': 5 }]
 * };
 *
 * _.merge(object, other);
 * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }
 */var merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex);});/**
 * Creates a function that invokes the method at `path` of a given object.
 * Any additional arguments are provided to the invoked method.
 *
 * @static
 * @memberOf _
 * @since 3.7.0
 * @category Util
 * @param {Array|string} path The path of the method to invoke.
 * @param {...*} [args] The arguments to invoke the method with.
 * @returns {Function} Returns the new invoker function.
 * @example
 *
 * var objects = [
 *   { 'a': { 'b': _.constant(2) } },
 *   { 'a': { 'b': _.constant(1) } }
 * ];
 *
 * _.map(objects, _.method('a.b'));
 * // => [2, 1]
 *
 * _.map(objects, _.method(['a', 'b']));
 * // => [2, 1]
 */var method=baseRest(function(path,args){return function(object){return baseInvoke(object,path,args);};});/**
 * The opposite of `_.method`; this method creates a function that invokes
 * the method at a given path of `object`. Any additional arguments are
 * provided to the invoked method.
 *
 * @static
 * @memberOf _
 * @since 3.7.0
 * @category Util
 * @param {Object} object The object to query.
 * @param {...*} [args] The arguments to invoke the method with.
 * @returns {Function} Returns the new invoker function.
 * @example
 *
 * var array = _.times(3, _.constant),
 *     object = { 'a': array, 'b': array, 'c': array };
 *
 * _.map(['a[2]', 'c[0]'], _.methodOf(object));
 * // => [2, 0]
 *
 * _.map([['a', '2'], ['c', '0']], _.methodOf(object));
 * // => [2, 0]
 */var methodOf=baseRest(function(object,args){return function(path){return baseInvoke(object,path,args);};});/**
 * Computes the minimum value of `array`. If `array` is empty or falsey,
 * `undefined` is returned.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Math
 * @param {Array} array The array to iterate over.
 * @returns {*} Returns the minimum value.
 * @example
 *
 * _.min([4, 2, 8, 6]);
 * // => 2
 *
 * _.min([]);
 * // => undefined
 */function min(array){return array&&array.length?baseExtremum(array,identity,baseLt):undefined;}/**
 * This method is like `_.min` except that it accepts `iteratee` which is
 * invoked for each element in `array` to generate the criterion by which
 * the value is ranked. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {*} Returns the minimum value.
 * @example
 *
 * var objects = [{ 'n': 1 }, { 'n': 2 }];
 *
 * _.minBy(objects, function(o) { return o.n; });
 * // => { 'n': 1 }
 *
 * // The `_.property` iteratee shorthand.
 * _.minBy(objects, 'n');
 * // => { 'n': 1 }
 */function minBy(array,iteratee){return array&&array.length?baseExtremum(array,baseIteratee(iteratee),baseLt):undefined;}/**
 * Adds all own enumerable string keyed function properties of a source
 * object to the destination object. If `object` is a function, then methods
 * are added to its prototype as well.
 *
 * **Note:** Use `_.runInContext` to create a pristine `lodash` function to
 * avoid conflicts caused by modifying the original.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {Function|Object} [object=lodash] The destination object.
 * @param {Object} source The object of functions to add.
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.chain=true] Specify whether mixins are chainable.
 * @returns {Function|Object} Returns `object`.
 * @example
 *
 * function vowels(string) {
 *   return _.filter(string, function(v) {
 *     return /[aeiou]/i.test(v);
 *   });
 * }
 *
 * _.mixin({ 'vowels': vowels });
 * _.vowels('fred');
 * // => ['e']
 *
 * _('fred').vowels().value();
 * // => ['e']
 *
 * _.mixin({ 'vowels': vowels }, { 'chain': false });
 * _('fred').vowels();
 * // => ['e']
 */function mixin$1(object,source,options){var props=keys$1(source),methodNames=baseFunctions(source,props);var chain=!(isObject(options)&&'chain'in options)||!!options.chain,isFunc=isFunction(object);arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName]=func;if(isFunc){object.prototype[methodName]=function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=copyArray(this.__actions__);actions.push({'func':func,'args':arguments,'thisArg':object});result.__chain__=chainAll;return result;}return func.apply(object,arrayPush([this.value()],arguments));};}});return object;}/**
 * Multiply two numbers.
 *
 * @static
 * @memberOf _
 * @since 4.7.0
 * @category Math
 * @param {number} multiplier The first number in a multiplication.
 * @param {number} multiplicand The second number in a multiplication.
 * @returns {number} Returns the product.
 * @example
 *
 * _.multiply(6, 4);
 * // => 24
 */var multiply=createMathOperation(function(multiplier,multiplicand){return multiplier*multiplicand;},1);/** Error message constants. */var FUNC_ERROR_TEXT$3='Expected a function';/**
 * Creates a function that negates the result of the predicate `func`. The
 * `func` predicate is invoked with the `this` binding and arguments of the
 * created function.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Function
 * @param {Function} predicate The predicate to negate.
 * @returns {Function} Returns the new negated function.
 * @example
 *
 * function isEven(n) {
 *   return n % 2 == 0;
 * }
 *
 * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));
 * // => [1, 3, 5]
 */function negate(predicate){if(typeof predicate!='function'){throw new TypeError(FUNC_ERROR_TEXT$3);}return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2]);}return!predicate.apply(this,args);};}/**
 * Converts `iterator` to an array.
 *
 * @private
 * @param {Object} iterator The iterator to convert.
 * @returns {Array} Returns the converted array.
 */function iteratorToArray(iterator){var data,result=[];while(!(data=iterator.next()).done){result.push(data.value);}return result;}/** `Object#toString` result references. */var mapTag$1='[object Map]',setTag$1='[object Set]';/** Built-in value references. */var symIterator$1=Symbol$1?Symbol$1.iterator:undefined;/**
 * Converts `value` to an array.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {Array} Returns the converted array.
 * @example
 *
 * _.toArray({ 'a': 1, 'b': 2 });
 * // => [1, 2]
 *
 * _.toArray('abc');
 * // => ['a', 'b', 'c']
 *
 * _.toArray(1);
 * // => []
 *
 * _.toArray(null);
 * // => []
 */function toArray(value){if(!value){return[];}if(isArrayLike(value)){return isString(value)?stringToArray(value):copyArray(value);}if(symIterator$1&&value[symIterator$1]){return iteratorToArray(value[symIterator$1]());}var tag=getTag$1(value),func=tag==mapTag$1?mapToArray:tag==setTag$1?setToArray:values;return func(value);}/**
 * Gets the next value on a wrapped object following the
 * [iterator protocol](https://mdn.io/iteration_protocols#iterator).
 *
 * @name next
 * @memberOf _
 * @since 4.0.0
 * @category Seq
 * @returns {Object} Returns the next iterator value.
 * @example
 *
 * var wrapped = _([1, 2]);
 *
 * wrapped.next();
 * // => { 'done': false, 'value': 1 }
 *
 * wrapped.next();
 * // => { 'done': false, 'value': 2 }
 *
 * wrapped.next();
 * // => { 'done': true, 'value': undefined }
 */function wrapperNext(){if(this.__values__===undefined){this.__values__=toArray(this.value());}var done=this.__index__>=this.__values__.length,value=done?undefined:this.__values__[this.__index__++];return{'done':done,'value':value};}/**
 * The base implementation of `_.nth` which doesn't coerce arguments.
 *
 * @private
 * @param {Array} array The array to query.
 * @param {number} n The index of the element to return.
 * @returns {*} Returns the nth element of `array`.
 */function baseNth(array,n){var length=array.length;if(!length){return;}n+=n<0?length:0;return isIndex(n,length)?array[n]:undefined;}/**
 * Gets the element at index `n` of `array`. If `n` is negative, the nth
 * element from the end is returned.
 *
 * @static
 * @memberOf _
 * @since 4.11.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {number} [n=0] The index of the element to return.
 * @returns {*} Returns the nth element of `array`.
 * @example
 *
 * var array = ['a', 'b', 'c', 'd'];
 *
 * _.nth(array, 1);
 * // => 'b'
 *
 * _.nth(array, -2);
 * // => 'c';
 */function nth(array,n){return array&&array.length?baseNth(array,toInteger(n)):undefined;}/**
 * Creates a function that gets the argument at index `n`. If `n` is negative,
 * the nth argument from the end is returned.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {number} [n=0] The index of the argument to return.
 * @returns {Function} Returns the new pass-thru function.
 * @example
 *
 * var func = _.nthArg(1);
 * func('a', 'b', 'c', 'd');
 * // => 'b'
 *
 * var func = _.nthArg(-2);
 * func('a', 'b', 'c', 'd');
 * // => 'c'
 */function nthArg(n){n=toInteger(n);return baseRest(function(args){return baseNth(args,n);});}/**
 * The base implementation of `_.unset`.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {Array|string} path The property path to unset.
 * @returns {boolean} Returns `true` if the property is deleted, else `false`.
 */function baseUnset(object,path){path=castPath(path,object);object=parent(object,path);return object==null||delete object[toKey(last(path))];}/**
 * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain
 * objects.
 *
 * @private
 * @param {*} value The value to inspect.
 * @param {string} key The key of the property to inspect.
 * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.
 */function customOmitClone(value){return isPlainObject(value)?undefined:value;}/** Used to compose bitmasks for cloning. */var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4;/**
 * The opposite of `_.pick`; this method creates an object composed of the
 * own and inherited enumerable property paths of `object` that are not omitted.
 *
 * **Note:** This method is considerably slower than `_.pick`.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The source object.
 * @param {...(string|string[])} [paths] The property paths to omit.
 * @returns {Object} Returns the new object.
 * @example
 *
 * var object = { 'a': 1, 'b': '2', 'c': 3 };
 *
 * _.omit(object, ['a', 'c']);
 * // => { 'b': '2' }
 */var omit=flatRest(function(object,paths){var result={};if(object==null){return result;}var isDeep=false;paths=arrayMap(paths,function(path){path=castPath(path,object);isDeep||(isDeep=path.length>1);return path;});copyObject(object,getAllKeysIn(object),result);if(isDeep){result=baseClone(result,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone);}var length=paths.length;while(length--){baseUnset(result,paths[length]);}return result;});/**
 * The base implementation of `_.set`.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to set.
 * @param {*} value The value to set.
 * @param {Function} [customizer] The function to customize path creation.
 * @returns {Object} Returns `object`.
 */function baseSet(object,path,value,customizer){if(!isObject(object)){return object;}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key==='__proto__'||key==='constructor'||key==='prototype'){return object;}if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{};}}assignValue(nested,key,newValue);nested=nested[key];}return object;}/**
 * The base implementation of  `_.pickBy` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The source object.
 * @param {string[]} paths The property paths to pick.
 * @param {Function} predicate The function invoked per property.
 * @returns {Object} Returns the new object.
 */function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=baseGet(object,path);if(predicate(value,path)){baseSet(result,castPath(path,object),value);}}return result;}/**
 * Creates an object composed of the `object` properties `predicate` returns
 * truthy for. The predicate is invoked with two arguments: (value, key).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The source object.
 * @param {Function} [predicate=_.identity] The function invoked per property.
 * @returns {Object} Returns the new object.
 * @example
 *
 * var object = { 'a': 1, 'b': '2', 'c': 3 };
 *
 * _.pickBy(object, _.isNumber);
 * // => { 'a': 1, 'c': 3 }
 */function pickBy(object,predicate){if(object==null){return{};}var props=arrayMap(getAllKeysIn(object),function(prop){return[prop];});predicate=baseIteratee(predicate);return basePickBy(object,props,function(value,path){return predicate(value,path[0]);});}/**
 * The opposite of `_.pickBy`; this method creates an object composed of
 * the own and inherited enumerable string keyed properties of `object` that
 * `predicate` doesn't return truthy for. The predicate is invoked with two
 * arguments: (value, key).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The source object.
 * @param {Function} [predicate=_.identity] The function invoked per property.
 * @returns {Object} Returns the new object.
 * @example
 *
 * var object = { 'a': 1, 'b': '2', 'c': 3 };
 *
 * _.omitBy(object, _.isNumber);
 * // => { 'b': '2' }
 */function omitBy(object,predicate){return pickBy(object,negate(baseIteratee(predicate)));}/**
 * Creates a function that is restricted to invoking `func` once. Repeat calls
 * to the function return the value of the first invocation. The `func` is
 * invoked with the `this` binding and arguments of the created function.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new restricted function.
 * @example
 *
 * var initialize = _.once(createApplication);
 * initialize();
 * initialize();
 * // => `createApplication` is invoked once
 */function once(func){return before(2,func);}/**
 * The base implementation of `_.sortBy` which uses `comparer` to define the
 * sort order of `array` and replaces criteria objects with their corresponding
 * values.
 *
 * @private
 * @param {Array} array The array to sort.
 * @param {Function} comparer The function to define sort order.
 * @returns {Array} Returns `array`.
 */function baseSortBy(array,comparer){var length=array.length;array.sort(comparer);while(length--){array[length]=array[length].value;}return array;}/**
 * Compares values to sort them in ascending order.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {number} Returns the sort order indicator for `value`.
 */function compareAscending(value,other){if(value!==other){var valIsDefined=value!==undefined,valIsNull=value===null,valIsReflexive=value===value,valIsSymbol=isSymbol(value);var othIsDefined=other!==undefined,othIsNull=other===null,othIsReflexive=other===other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive){return 1;}if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive){return-1;}}return 0;}/**
 * Used by `_.orderBy` to compare multiple properties of a value to another
 * and stable sort them.
 *
 * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,
 * specify an order of "desc" for descending or "asc" for ascending sort order
 * of corresponding values.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {boolean[]|string[]} orders The order to sort by for each property.
 * @returns {number} Returns the sort order indicator for `object`.
 */function compareMultiple(object,other,orders){var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;while(++index<length){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength){return result;}var order=orders[index];return result*(order=='desc'?-1:1);}}// Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications
// that causes it, under certain circumstances, to provide the same value for
// `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247
// for more details.
//
// This also ensures a stable sort in V8 and other engines.
// See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.
return object.index-other.index;}/**
 * The base implementation of `_.orderBy` without param guards.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.
 * @param {string[]} orders The sort orders of `iteratees`.
 * @returns {Array} Returns the new sorted array.
 */function baseOrderBy(collection,iteratees,orders){if(iteratees.length){iteratees=arrayMap(iteratees,function(iteratee){if(isArray(iteratee)){return function(value){return baseGet(value,iteratee.length===1?iteratee[0]:iteratee);};}return iteratee;});}else{iteratees=[identity];}var index=-1;iteratees=arrayMap(iteratees,baseUnary(baseIteratee));var result=baseMap(collection,function(value,key,collection){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value);});return{'criteria':criteria,'index':++index,'value':value};});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders);});}/**
 * This method is like `_.sortBy` except that it allows specifying the sort
 * orders of the iteratees to sort by. If `orders` is unspecified, all values
 * are sorted in ascending order. Otherwise, specify an order of "desc" for
 * descending or "asc" for ascending sort order of corresponding values.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]
 *  The iteratees to sort by.
 * @param {string[]} [orders] The sort orders of `iteratees`.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.
 * @returns {Array} Returns the new sorted array.
 * @example
 *
 * var users = [
 *   { 'user': 'fred',   'age': 48 },
 *   { 'user': 'barney', 'age': 34 },
 *   { 'user': 'fred',   'age': 40 },
 *   { 'user': 'barney', 'age': 36 }
 * ];
 *
 * // Sort by `user` in ascending order and by `age` in descending order.
 * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);
 * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]
 */function orderBy(collection,iteratees,orders,guard){if(collection==null){return[];}if(!isArray(iteratees)){iteratees=iteratees==null?[]:[iteratees];}orders=guard?undefined:orders;if(!isArray(orders)){orders=orders==null?[]:[orders];}return baseOrderBy(collection,iteratees,orders);}/**
 * Creates a function like `_.over`.
 *
 * @private
 * @param {Function} arrayFunc The function to iterate over iteratees.
 * @returns {Function} Returns the new over function.
 */function createOver(arrayFunc){return flatRest(function(iteratees){iteratees=arrayMap(iteratees,baseUnary(baseIteratee));return baseRest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args);});});});}/**
 * Creates a function that invokes `iteratees` with the arguments it receives
 * and returns their results.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {...(Function|Function[])} [iteratees=[_.identity]]
 *  The iteratees to invoke.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var func = _.over([Math.max, Math.min]);
 *
 * func(1, 2, 3, 4);
 * // => [4, 1]
 */var over=createOver(arrayMap);/**
 * A `baseRest` alias which can be replaced with `identity` by module
 * replacement plugins.
 *
 * @private
 * @type {Function}
 * @param {Function} func The function to apply a rest parameter to.
 * @returns {Function} Returns the new function.
 */var castRest=baseRest;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$6=Math.min;/**
 * Creates a function that invokes `func` with its arguments transformed.
 *
 * @static
 * @since 4.0.0
 * @memberOf _
 * @category Function
 * @param {Function} func The function to wrap.
 * @param {...(Function|Function[])} [transforms=[_.identity]]
 *  The argument transforms.
 * @returns {Function} Returns the new function.
 * @example
 *
 * function doubled(n) {
 *   return n * 2;
 * }
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * var func = _.overArgs(function(x, y) {
 *   return [x, y];
 * }, [square, doubled]);
 *
 * func(9, 3);
 * // => [81, 6]
 *
 * func(10, 5);
 * // => [100, 10]
 */var overArgs=castRest(function(func,transforms){transforms=transforms.length==1&&isArray(transforms[0])?arrayMap(transforms[0],baseUnary(baseIteratee)):arrayMap(baseFlatten(transforms,1),baseUnary(baseIteratee));var funcsLength=transforms.length;return baseRest(function(args){var index=-1,length=nativeMin$6(args.length,funcsLength);while(++index<length){args[index]=transforms[index].call(this,args[index]);}return apply(func,this,args);});});/**
 * Creates a function that checks if **all** of the `predicates` return
 * truthy when invoked with the arguments it receives.
 *
 * Following shorthands are possible for providing predicates.
 * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.
 * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {...(Function|Function[])} [predicates=[_.identity]]
 *  The predicates to check.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var func = _.overEvery([Boolean, isFinite]);
 *
 * func('1');
 * // => true
 *
 * func(null);
 * // => false
 *
 * func(NaN);
 * // => false
 */var overEvery=createOver(arrayEvery);/**
 * Creates a function that checks if **any** of the `predicates` return
 * truthy when invoked with the arguments it receives.
 *
 * Following shorthands are possible for providing predicates.
 * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.
 * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {...(Function|Function[])} [predicates=[_.identity]]
 *  The predicates to check.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var func = _.overSome([Boolean, isFinite]);
 *
 * func('1');
 * // => true
 *
 * func(null);
 * // => true
 *
 * func(NaN);
 * // => false
 *
 * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])
 * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])
 */var overSome=createOver(arraySome);/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER$2=9007199254740991;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeFloor$3=Math.floor;/**
 * The base implementation of `_.repeat` which doesn't coerce arguments.
 *
 * @private
 * @param {string} string The string to repeat.
 * @param {number} n The number of times to repeat the string.
 * @returns {string} Returns the repeated string.
 */function baseRepeat(string,n){var result='';if(!string||n<1||n>MAX_SAFE_INTEGER$2){return result;}// Leverage the exponentiation by squaring algorithm for a faster repeat.
// See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.
do{if(n%2){result+=string;}n=nativeFloor$3(n/2);if(n){string+=string;}}while(n);return result;}/**
 * Gets the size of an ASCII `string`.
 *
 * @private
 * @param {string} string The string inspect.
 * @returns {number} Returns the string size.
 */var asciiSize=baseProperty('length');/** Used to compose unicode character classes. */var rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f";/** Used to compose unicode capture groups. */var rsAstral='['+rsAstralRange+']',rsCombo='['+rsComboRange+']',rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier='(?:'+rsCombo+'|'+rsFitz+')',rsNonAstral='[^'+rsAstralRange+']',rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d";/** Used to compose unicode regexes. */var reOptMod=rsModifier+'?',rsOptVar='['+rsVarRange+']?',rsOptJoin='(?:'+rsZWJ+'(?:'+[rsNonAstral,rsRegional,rsSurrPair].join('|')+')'+rsOptVar+reOptMod+')*',rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol='(?:'+[rsNonAstral+rsCombo+'?',rsCombo,rsRegional,rsSurrPair,rsAstral].join('|')+')';/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */var reUnicode=RegExp(rsFitz+'(?='+rsFitz+')|'+rsSymbol+rsSeq,'g');/**
 * Gets the size of a Unicode `string`.
 *
 * @private
 * @param {string} string The string inspect.
 * @returns {number} Returns the string size.
 */function unicodeSize(string){var result=reUnicode.lastIndex=0;while(reUnicode.test(string)){++result;}return result;}/**
 * Gets the number of symbols in `string`.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {number} Returns the string size.
 */function stringSize(string){return hasUnicode(string)?unicodeSize(string):asciiSize(string);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeCeil$2=Math.ceil;/**
 * Creates the padding for `string` based on `length`. The `chars` string
 * is truncated if the number of characters exceeds `length`.
 *
 * @private
 * @param {number} length The padding length.
 * @param {string} [chars=' '] The string used as padding.
 * @returns {string} Returns the padding for `string`.
 */function createPadding(length,chars){chars=chars===undefined?' ':baseToString(chars);var charsLength=chars.length;if(charsLength<2){return charsLength?baseRepeat(chars,length):chars;}var result=baseRepeat(chars,nativeCeil$2(length/stringSize(chars)));return hasUnicode(chars)?castSlice(stringToArray(result),0,length).join(''):result.slice(0,length);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeCeil$1=Math.ceil,nativeFloor$2=Math.floor;/**
 * Pads `string` on the left and right sides if it's shorter than `length`.
 * Padding characters are truncated if they can't be evenly divided by `length`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to pad.
 * @param {number} [length=0] The padding length.
 * @param {string} [chars=' '] The string used as padding.
 * @returns {string} Returns the padded string.
 * @example
 *
 * _.pad('abc', 8);
 * // => '  abc   '
 *
 * _.pad('abc', 8, '_-');
 * // => '_-abc_-_'
 *
 * _.pad('abc', 3);
 * // => 'abc'
 */function pad(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;if(!length||strLength>=length){return string;}var mid=(length-strLength)/2;return createPadding(nativeFloor$2(mid),chars)+string+createPadding(nativeCeil$1(mid),chars);}/**
 * Pads `string` on the right side if it's shorter than `length`. Padding
 * characters are truncated if they exceed `length`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to pad.
 * @param {number} [length=0] The padding length.
 * @param {string} [chars=' '] The string used as padding.
 * @returns {string} Returns the padded string.
 * @example
 *
 * _.padEnd('abc', 6);
 * // => 'abc   '
 *
 * _.padEnd('abc', 6, '_-');
 * // => 'abc_-_'
 *
 * _.padEnd('abc', 3);
 * // => 'abc'
 */function padEnd(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?string+createPadding(length-strLength,chars):string;}/**
 * Pads `string` on the left side if it's shorter than `length`. Padding
 * characters are truncated if they exceed `length`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to pad.
 * @param {number} [length=0] The padding length.
 * @param {string} [chars=' '] The string used as padding.
 * @returns {string} Returns the padded string.
 * @example
 *
 * _.padStart('abc', 6);
 * // => '   abc'
 *
 * _.padStart('abc', 6, '_-');
 * // => '_-_abc'
 *
 * _.padStart('abc', 3);
 * // => 'abc'
 */function padStart(string,length,chars){string=toString(string);length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?createPadding(length-strLength,chars)+string:string;}/** Used to match leading whitespace. */var reTrimStart$1=/^\s+/;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeParseInt=root.parseInt;/**
 * Converts `string` to an integer of the specified radix. If `radix` is
 * `undefined` or `0`, a `radix` of `10` is used unless `value` is a
 * hexadecimal, in which case a `radix` of `16` is used.
 *
 * **Note:** This method aligns with the
 * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.
 *
 * @static
 * @memberOf _
 * @since 1.1.0
 * @category String
 * @param {string} string The string to convert.
 * @param {number} [radix=10] The radix to interpret `value` by.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {number} Returns the converted integer.
 * @example
 *
 * _.parseInt('08');
 * // => 8
 *
 * _.map(['6', '08', '10'], _.parseInt);
 * // => [6, 8, 10]
 */function parseInt$1(string,radix,guard){if(guard||radix==null){radix=0;}else if(radix){radix=+radix;}return nativeParseInt(toString(string).replace(reTrimStart$1,''),radix||0);}/** Used to compose bitmasks for function metadata. */var WRAP_PARTIAL_FLAG=32;/**
 * Creates a function that invokes `func` with `partials` prepended to the
 * arguments it receives. This method is like `_.bind` except it does **not**
 * alter the `this` binding.
 *
 * The `_.partial.placeholder` value, which defaults to `_` in monolithic
 * builds, may be used as a placeholder for partially applied arguments.
 *
 * **Note:** This method doesn't set the "length" property of partially
 * applied functions.
 *
 * @static
 * @memberOf _
 * @since 0.2.0
 * @category Function
 * @param {Function} func The function to partially apply arguments to.
 * @param {...*} [partials] The arguments to be partially applied.
 * @returns {Function} Returns the new partially applied function.
 * @example
 *
 * function greet(greeting, name) {
 *   return greeting + ' ' + name;
 * }
 *
 * var sayHelloTo = _.partial(greet, 'hello');
 * sayHelloTo('fred');
 * // => 'hello fred'
 *
 * // Partially applied with placeholders.
 * var greetFred = _.partial(greet, _, 'fred');
 * greetFred('hi');
 * // => 'hi fred'
 */var partial=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partial));return createWrap(func,WRAP_PARTIAL_FLAG,undefined,partials,holders);});// Assign default placeholders.
partial.placeholder={};/** Used to compose bitmasks for function metadata. */var WRAP_PARTIAL_RIGHT_FLAG=64;/**
 * This method is like `_.partial` except that partially applied arguments
 * are appended to the arguments it receives.
 *
 * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic
 * builds, may be used as a placeholder for partially applied arguments.
 *
 * **Note:** This method doesn't set the "length" property of partially
 * applied functions.
 *
 * @static
 * @memberOf _
 * @since 1.0.0
 * @category Function
 * @param {Function} func The function to partially apply arguments to.
 * @param {...*} [partials] The arguments to be partially applied.
 * @returns {Function} Returns the new partially applied function.
 * @example
 *
 * function greet(greeting, name) {
 *   return greeting + ' ' + name;
 * }
 *
 * var greetFred = _.partialRight(greet, 'fred');
 * greetFred('hi');
 * // => 'hi fred'
 *
 * // Partially applied with placeholders.
 * var sayHelloTo = _.partialRight(greet, 'hello', _);
 * sayHelloTo('fred');
 * // => 'hello fred'
 */var partialRight=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partialRight));return createWrap(func,WRAP_PARTIAL_RIGHT_FLAG,undefined,partials,holders);});// Assign default placeholders.
partialRight.placeholder={};/**
 * Creates an array of elements split into two groups, the first of which
 * contains elements `predicate` returns truthy for, the second of which
 * contains elements `predicate` returns falsey for. The predicate is
 * invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the array of grouped elements.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'age': 36, 'active': false },
 *   { 'user': 'fred',    'age': 40, 'active': true },
 *   { 'user': 'pebbles', 'age': 1,  'active': false }
 * ];
 *
 * _.partition(users, function(o) { return o.active; });
 * // => objects for [['fred'], ['barney', 'pebbles']]
 *
 * // The `_.matches` iteratee shorthand.
 * _.partition(users, { 'age': 1, 'active': false });
 * // => objects for [['pebbles'], ['barney', 'fred']]
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.partition(users, ['active', false]);
 * // => objects for [['barney', 'pebbles'], ['fred']]
 *
 * // The `_.property` iteratee shorthand.
 * _.partition(users, 'active');
 * // => objects for [['fred'], ['barney', 'pebbles']]
 */var partition=createAggregator(function(result,value,key){result[key?0:1].push(value);},function(){return[[],[]];});/**
 * The base implementation of `_.pick` without support for individual
 * property identifiers.
 *
 * @private
 * @param {Object} object The source object.
 * @param {string[]} paths The property paths to pick.
 * @returns {Object} Returns the new object.
 */function basePick(object,paths){return basePickBy(object,paths,function(value,path){return hasIn(object,path);});}/**
 * Creates an object composed of the picked `object` properties.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The source object.
 * @param {...(string|string[])} [paths] The property paths to pick.
 * @returns {Object} Returns the new object.
 * @example
 *
 * var object = { 'a': 1, 'b': '2', 'c': 3 };
 *
 * _.pick(object, ['a', 'c']);
 * // => { 'a': 1, 'c': 3 }
 */var pick=flatRest(function(object,paths){return object==null?{}:basePick(object,paths);});/**
 * Creates a clone of the chain sequence planting `value` as the wrapped value.
 *
 * @name plant
 * @memberOf _
 * @since 3.2.0
 * @category Seq
 * @param {*} value The value to plant.
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * function square(n) {
 *   return n * n;
 * }
 *
 * var wrapped = _([1, 2]).map(square);
 * var other = wrapped.plant([3, 4]);
 *
 * other.value();
 * // => [9, 16]
 *
 * wrapped.value();
 * // => [1, 4]
 */function wrapperPlant(value){var result,parent=this;while(parent instanceof baseLodash){var clone=wrapperClone(parent);clone.__index__=0;clone.__values__=undefined;if(result){previous.__wrapped__=clone;}else{result=clone;}var previous=clone;parent=parent.__wrapped__;}previous.__wrapped__=value;return result;}/**
 * The opposite of `_.property`; this method creates a function that returns
 * the value at a given path of `object`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Util
 * @param {Object} object The object to query.
 * @returns {Function} Returns the new accessor function.
 * @example
 *
 * var array = [0, 1, 2],
 *     object = { 'a': array, 'b': array, 'c': array };
 *
 * _.map(['a[2]', 'c[0]'], _.propertyOf(object));
 * // => [2, 0]
 *
 * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));
 * // => [2, 0]
 */function propertyOf(object){return function(path){return object==null?undefined:baseGet(object,path);};}/**
 * This function is like `baseIndexOf` except that it accepts a comparator.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @param {Function} comparator The comparator invoked per element.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */function baseIndexOfWith(array,value,fromIndex,comparator){var index=fromIndex-1,length=array.length;while(++index<length){if(comparator(array[index],value)){return index;}}return-1;}/** Used for built-in method references. */var arrayProto$3=Array.prototype;/** Built-in value references. */var splice$1=arrayProto$3.splice;/**
 * The base implementation of `_.pullAllBy` without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {Array} values The values to remove.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns `array`.
 */function basePullAll(array,values,iteratee,comparator){var indexOf=comparator?baseIndexOfWith:baseIndexOf,index=-1,length=values.length,seen=array;if(array===values){values=copyArray(values);}if(iteratee){seen=arrayMap(array,baseUnary(iteratee));}while(++index<length){var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;while((fromIndex=indexOf(seen,computed,fromIndex,comparator))>-1){if(seen!==array){splice$1.call(seen,fromIndex,1);}splice$1.call(array,fromIndex,1);}}return array;}/**
 * This method is like `_.pull` except that it accepts an array of values to remove.
 *
 * **Note:** Unlike `_.difference`, this method mutates `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {Array} values The values to remove.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = ['a', 'b', 'c', 'a', 'b', 'c'];
 *
 * _.pullAll(array, ['a', 'c']);
 * console.log(array);
 * // => ['b', 'b']
 */function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array;}/**
 * Removes all given values from `array` using
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons.
 *
 * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`
 * to remove elements from an array by predicate.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {...*} [values] The values to remove.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = ['a', 'b', 'c', 'a', 'b', 'c'];
 *
 * _.pull(array, 'a', 'c');
 * console.log(array);
 * // => ['b', 'b']
 */var pull=baseRest(pullAll);/**
 * This method is like `_.pullAll` except that it accepts `iteratee` which is
 * invoked for each element of `array` and `values` to generate the criterion
 * by which they're compared. The iteratee is invoked with one argument: (value).
 *
 * **Note:** Unlike `_.differenceBy`, this method mutates `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {Array} values The values to remove.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];
 *
 * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');
 * console.log(array);
 * // => [{ 'x': 2 }]
 */function pullAllBy(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAll(array,values,baseIteratee(iteratee)):array;}/**
 * This method is like `_.pullAll` except that it accepts `comparator` which
 * is invoked to compare elements of `array` to `values`. The comparator is
 * invoked with two arguments: (arrVal, othVal).
 *
 * **Note:** Unlike `_.differenceWith`, this method mutates `array`.
 *
 * @static
 * @memberOf _
 * @since 4.6.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {Array} values The values to remove.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];
 *
 * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);
 * console.log(array);
 * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]
 */function pullAllWith(array,values,comparator){return array&&array.length&&values&&values.length?basePullAll(array,values,undefined,comparator):array;}/** Used for built-in method references. */var arrayProto$2=Array.prototype;/** Built-in value references. */var splice=arrayProto$2.splice;/**
 * The base implementation of `_.pullAt` without support for individual
 * indexes or capturing the removed elements.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {number[]} indexes The indexes of elements to remove.
 * @returns {Array} Returns `array`.
 */function basePullAt(array,indexes){var length=array?indexes.length:0,lastIndex=length-1;while(length--){var index=indexes[length];if(length==lastIndex||index!==previous){var previous=index;if(isIndex(index)){splice.call(array,index,1);}else{baseUnset(array,index);}}}return array;}/**
 * Removes elements from `array` corresponding to `indexes` and returns an
 * array of removed elements.
 *
 * **Note:** Unlike `_.at`, this method mutates `array`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {...(number|number[])} [indexes] The indexes of elements to remove.
 * @returns {Array} Returns the new array of removed elements.
 * @example
 *
 * var array = ['a', 'b', 'c', 'd'];
 * var pulled = _.pullAt(array, [1, 3]);
 *
 * console.log(array);
 * // => ['a', 'c']
 *
 * console.log(pulled);
 * // => ['b', 'd']
 */var pullAt=flatRest(function(array,indexes){var length=array==null?0:array.length,result=baseAt(array,indexes);basePullAt(array,arrayMap(indexes,function(index){return isIndex(index,length)?+index:index;}).sort(compareAscending));return result;});/* Built-in method references for those with the same name as other `lodash` methods. */var nativeFloor$1=Math.floor,nativeRandom$1=Math.random;/**
 * The base implementation of `_.random` without support for returning
 * floating-point numbers.
 *
 * @private
 * @param {number} lower The lower bound.
 * @param {number} upper The upper bound.
 * @returns {number} Returns the random number.
 */function baseRandom(lower,upper){return lower+nativeFloor$1(nativeRandom$1()*(upper-lower+1));}/** Built-in method references without a dependency on `root`. */var freeParseFloat=parseFloat;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$5=Math.min,nativeRandom=Math.random;/**
 * Produces a random number between the inclusive `lower` and `upper` bounds.
 * If only one argument is provided a number between `0` and the given number
 * is returned. If `floating` is `true`, or either `lower` or `upper` are
 * floats, a floating-point number is returned instead of an integer.
 *
 * **Note:** JavaScript follows the IEEE-754 standard for resolving
 * floating-point values which can produce unexpected results.
 *
 * @static
 * @memberOf _
 * @since 0.7.0
 * @category Number
 * @param {number} [lower=0] The lower bound.
 * @param {number} [upper=1] The upper bound.
 * @param {boolean} [floating] Specify returning a floating-point number.
 * @returns {number} Returns the random number.
 * @example
 *
 * _.random(0, 5);
 * // => an integer between 0 and 5
 *
 * _.random(5);
 * // => also an integer between 0 and 5
 *
 * _.random(5, true);
 * // => a floating-point number between 0 and 5
 *
 * _.random(1.2, 5.2);
 * // => a floating-point number between 1.2 and 5.2
 */function random(lower,upper,floating){if(floating&&typeof floating!='boolean'&&isIterateeCall(lower,upper,floating)){upper=floating=undefined;}if(floating===undefined){if(typeof upper=='boolean'){floating=upper;upper=undefined;}else if(typeof lower=='boolean'){floating=lower;lower=undefined;}}if(lower===undefined&&upper===undefined){lower=0;upper=1;}else{lower=toFinite(lower);if(upper===undefined){upper=lower;lower=0;}else{upper=toFinite(upper);}}if(lower>upper){var temp=lower;lower=upper;upper=temp;}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin$5(lower+rand*(upper-lower+freeParseFloat('1e-'+((rand+'').length-1))),upper);}return baseRandom(lower,upper);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeCeil=Math.ceil,nativeMax$4=Math.max;/**
 * The base implementation of `_.range` and `_.rangeRight` which doesn't
 * coerce arguments.
 *
 * @private
 * @param {number} start The start of the range.
 * @param {number} end The end of the range.
 * @param {number} step The value to increment or decrement by.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Array} Returns the range of numbers.
 */function baseRange(start,end,step,fromRight){var index=-1,length=nativeMax$4(nativeCeil((end-start)/(step||1)),0),result=Array(length);while(length--){result[fromRight?length:++index]=start;start+=step;}return result;}/**
 * Creates a `_.range` or `_.rangeRight` function.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new range function.
 */function createRange(fromRight){return function(start,end,step){if(step&&typeof step!='number'&&isIterateeCall(start,end,step)){end=step=undefined;}// Ensure the sign of `-0` is preserved.
start=toFinite(start);if(end===undefined){end=start;start=0;}else{end=toFinite(end);}step=step===undefined?start<end?1:-1:toFinite(step);return baseRange(start,end,step,fromRight);};}/**
 * Creates an array of numbers (positive and/or negative) progressing from
 * `start` up to, but not including, `end`. A step of `-1` is used if a negative
 * `start` is specified without an `end` or `step`. If `end` is not specified,
 * it's set to `start` with `start` then set to `0`.
 *
 * **Note:** JavaScript follows the IEEE-754 standard for resolving
 * floating-point values which can produce unexpected results.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {number} [start=0] The start of the range.
 * @param {number} end The end of the range.
 * @param {number} [step=1] The value to increment or decrement by.
 * @returns {Array} Returns the range of numbers.
 * @see _.inRange, _.rangeRight
 * @example
 *
 * _.range(4);
 * // => [0, 1, 2, 3]
 *
 * _.range(-4);
 * // => [0, -1, -2, -3]
 *
 * _.range(1, 5);
 * // => [1, 2, 3, 4]
 *
 * _.range(0, 20, 5);
 * // => [0, 5, 10, 15]
 *
 * _.range(0, -4, -1);
 * // => [0, -1, -2, -3]
 *
 * _.range(1, 4, 0);
 * // => [1, 1, 1]
 *
 * _.range(0);
 * // => []
 */var range=createRange();/**
 * This method is like `_.range` except that it populates values in
 * descending order.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {number} [start=0] The start of the range.
 * @param {number} end The end of the range.
 * @param {number} [step=1] The value to increment or decrement by.
 * @returns {Array} Returns the range of numbers.
 * @see _.inRange, _.range
 * @example
 *
 * _.rangeRight(4);
 * // => [3, 2, 1, 0]
 *
 * _.rangeRight(-4);
 * // => [-3, -2, -1, 0]
 *
 * _.rangeRight(1, 5);
 * // => [4, 3, 2, 1]
 *
 * _.rangeRight(0, 20, 5);
 * // => [15, 10, 5, 0]
 *
 * _.rangeRight(0, -4, -1);
 * // => [-3, -2, -1, 0]
 *
 * _.rangeRight(1, 4, 0);
 * // => [1, 1, 1]
 *
 * _.rangeRight(0);
 * // => []
 */var rangeRight=createRange(true);/** Used to compose bitmasks for function metadata. */var WRAP_REARG_FLAG=256;/**
 * Creates a function that invokes `func` with arguments arranged according
 * to the specified `indexes` where the argument value at the first index is
 * provided as the first argument, the argument value at the second index is
 * provided as the second argument, and so on.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Function
 * @param {Function} func The function to rearrange arguments for.
 * @param {...(number|number[])} indexes The arranged argument indexes.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var rearged = _.rearg(function(a, b, c) {
 *   return [a, b, c];
 * }, [2, 0, 1]);
 *
 * rearged('b', 'c', 'a')
 * // => ['a', 'b', 'c']
 */var rearg=flatRest(function(func,indexes){return createWrap(func,WRAP_REARG_FLAG,undefined,undefined,undefined,indexes);});/**
 * The base implementation of `_.reduce` and `_.reduceRight`, without support
 * for iteratee shorthands, which iterates over `collection` using `eachFunc`.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {*} accumulator The initial value.
 * @param {boolean} initAccum Specify using the first or last element of
 *  `collection` as the initial value.
 * @param {Function} eachFunc The function to iterate over `collection`.
 * @returns {*} Returns the accumulated value.
 */function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=false,value):iteratee(accumulator,value,index,collection);});return accumulator;}/**
 * Reduces `collection` to a value which is the accumulated result of running
 * each element in `collection` thru `iteratee`, where each successive
 * invocation is supplied the return value of the previous. If `accumulator`
 * is not given, the first element of `collection` is used as the initial
 * value. The iteratee is invoked with four arguments:
 * (accumulator, value, index|key, collection).
 *
 * Many lodash methods are guarded to work as iteratees for methods like
 * `_.reduce`, `_.reduceRight`, and `_.transform`.
 *
 * The guarded methods are:
 * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,
 * and `sortBy`
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @param {*} [accumulator] The initial value.
 * @returns {*} Returns the accumulated value.
 * @see _.reduceRight
 * @example
 *
 * _.reduce([1, 2], function(sum, n) {
 *   return sum + n;
 * }, 0);
 * // => 3
 *
 * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {
 *   (result[value] || (result[value] = [])).push(key);
 *   return result;
 * }, {});
 * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)
 */function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,baseIteratee(iteratee),accumulator,initAccum,baseEach);}/**
 * A specialized version of `_.reduceRight` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {*} [accumulator] The initial value.
 * @param {boolean} [initAccum] Specify using the last element of `array` as
 *  the initial value.
 * @returns {*} Returns the accumulated value.
 */function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=array==null?0:array.length;if(initAccum&&length){accumulator=array[--length];}while(length--){accumulator=iteratee(accumulator,array[length],length,array);}return accumulator;}/**
 * This method is like `_.reduce` except that it iterates over elements of
 * `collection` from right to left.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @param {*} [accumulator] The initial value.
 * @returns {*} Returns the accumulated value.
 * @see _.reduce
 * @example
 *
 * var array = [[0, 1], [2, 3], [4, 5]];
 *
 * _.reduceRight(array, function(flattened, other) {
 *   return flattened.concat(other);
 * }, []);
 * // => [4, 5, 2, 3, 0, 1]
 */function reduceRight(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,baseIteratee(iteratee),accumulator,initAccum,baseEachRight);}/**
 * The opposite of `_.filter`; this method returns the elements of `collection`
 * that `predicate` does **not** return truthy for.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new filtered array.
 * @see _.filter
 * @example
 *
 * var users = [
 *   { 'user': 'barney', 'age': 36, 'active': false },
 *   { 'user': 'fred',   'age': 40, 'active': true }
 * ];
 *
 * _.reject(users, function(o) { return !o.active; });
 * // => objects for ['fred']
 *
 * // The `_.matches` iteratee shorthand.
 * _.reject(users, { 'age': 40, 'active': true });
 * // => objects for ['barney']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.reject(users, ['active', false]);
 * // => objects for ['fred']
 *
 * // The `_.property` iteratee shorthand.
 * _.reject(users, 'active');
 * // => objects for ['barney']
 */function reject(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,negate(baseIteratee(predicate)));}/**
 * Removes all elements from `array` that `predicate` returns truthy for
 * and returns an array of the removed elements. The predicate is invoked
 * with three arguments: (value, index, array).
 *
 * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`
 * to pull elements from an array by value.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the new array of removed elements.
 * @example
 *
 * var array = [1, 2, 3, 4];
 * var evens = _.remove(array, function(n) {
 *   return n % 2 == 0;
 * });
 *
 * console.log(array);
 * // => [1, 3]
 *
 * console.log(evens);
 * // => [2, 4]
 */function remove$1(array,predicate){var result=[];if(!(array&&array.length)){return result;}var index=-1,indexes=[],length=array.length;predicate=baseIteratee(predicate);while(++index<length){var value=array[index];if(predicate(value,index,array)){result.push(value);indexes.push(index);}}basePullAt(array,indexes);return result;}/**
 * Repeats the given string `n` times.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to repeat.
 * @param {number} [n=1] The number of times to repeat the string.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {string} Returns the repeated string.
 * @example
 *
 * _.repeat('*', 3);
 * // => '***'
 *
 * _.repeat('abc', 2);
 * // => 'abcabc'
 *
 * _.repeat('abc', 0);
 * // => ''
 */function repeat(string,n,guard){if(guard?isIterateeCall(string,n,guard):n===undefined){n=1;}else{n=toInteger(n);}return baseRepeat(toString(string),n);}/**
 * Replaces matches for `pattern` in `string` with `replacement`.
 *
 * **Note:** This method is based on
 * [`String#replace`](https://mdn.io/String/replace).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to modify.
 * @param {RegExp|string} pattern The pattern to replace.
 * @param {Function|string} replacement The match replacement.
 * @returns {string} Returns the modified string.
 * @example
 *
 * _.replace('Hi Fred', 'Fred', 'Barney');
 * // => 'Hi Barney'
 */function replace$1(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2]);}/** Error message constants. */var FUNC_ERROR_TEXT$2='Expected a function';/**
 * Creates a function that invokes `func` with the `this` binding of the
 * created function and arguments from `start` and beyond provided as
 * an array.
 *
 * **Note:** This method is based on the
 * [rest parameter](https://mdn.io/rest_parameters).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Function
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var say = _.rest(function(what, names) {
 *   return what + ' ' + _.initial(names).join(', ') +
 *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);
 * });
 *
 * say('hello', 'fred', 'barney', 'pebbles');
 * // => 'hello fred, barney, & pebbles'
 */function rest(func,start){if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$2);}start=start===undefined?start:toInteger(start);return baseRest(func,start);}/**
 * This method is like `_.get` except that if the resolved value is a
 * function it's invoked with the `this` binding of its parent object and
 * its result is returned.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to resolve.
 * @param {*} [defaultValue] The value returned for `undefined` resolved values.
 * @returns {*} Returns the resolved value.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };
 *
 * _.result(object, 'a[0].b.c1');
 * // => 3
 *
 * _.result(object, 'a[0].b.c2');
 * // => 4
 *
 * _.result(object, 'a[0].b.c3', 'default');
 * // => 'default'
 *
 * _.result(object, 'a[0].b.c3', _.constant('default'));
 * // => 'default'
 */function result(object,path,defaultValue){path=castPath(path,object);var index=-1,length=path.length;// Ensure the loop is entered when path is empty.
if(!length){length=1;object=undefined;}while(++index<length){var value=object==null?undefined:object[toKey(path[index])];if(value===undefined){index=length;value=defaultValue;}object=isFunction(value)?value.call(object):value;}return object;}/** Used for built-in method references. */var arrayProto$1=Array.prototype;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeReverse=arrayProto$1.reverse;/**
 * Reverses `array` so that the first element becomes the last, the second
 * element becomes the second to last, and so on.
 *
 * **Note:** This method mutates `array` and is based on
 * [`Array#reverse`](https://mdn.io/Array/reverse).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @returns {Array} Returns `array`.
 * @example
 *
 * var array = [1, 2, 3];
 *
 * _.reverse(array);
 * // => [3, 2, 1]
 *
 * console.log(array);
 * // => [3, 2, 1]
 */function reverse(array){return array==null?array:nativeReverse.call(array);}/**
 * Computes `number` rounded to `precision`.
 *
 * @static
 * @memberOf _
 * @since 3.10.0
 * @category Math
 * @param {number} number The number to round.
 * @param {number} [precision=0] The precision to round to.
 * @returns {number} Returns the rounded number.
 * @example
 *
 * _.round(4.006);
 * // => 4
 *
 * _.round(4.006, 2);
 * // => 4.01
 *
 * _.round(4060, -2);
 * // => 4100
 */var round=createRound('round');/**
 * A specialized version of `_.sample` for arrays.
 *
 * @private
 * @param {Array} array The array to sample.
 * @returns {*} Returns the random element.
 */function arraySample(array){var length=array.length;return length?array[baseRandom(0,length-1)]:undefined;}/**
 * The base implementation of `_.sample`.
 *
 * @private
 * @param {Array|Object} collection The collection to sample.
 * @returns {*} Returns the random element.
 */function baseSample(collection){return arraySample(values(collection));}/**
 * Gets a random element from `collection`.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to sample.
 * @returns {*} Returns the random element.
 * @example
 *
 * _.sample([1, 2, 3, 4]);
 * // => 2
 */function sample(collection){var func=isArray(collection)?arraySample:baseSample;return func(collection);}/**
 * A specialized version of `_.shuffle` which mutates and sets the size of `array`.
 *
 * @private
 * @param {Array} array The array to shuffle.
 * @param {number} [size=array.length] The size of `array`.
 * @returns {Array} Returns `array`.
 */function shuffleSelf(array,size){var index=-1,length=array.length,lastIndex=length-1;size=size===undefined?length:size;while(++index<size){var rand=baseRandom(index,lastIndex),value=array[rand];array[rand]=array[index];array[index]=value;}array.length=size;return array;}/**
 * A specialized version of `_.sampleSize` for arrays.
 *
 * @private
 * @param {Array} array The array to sample.
 * @param {number} n The number of elements to sample.
 * @returns {Array} Returns the random elements.
 */function arraySampleSize(array,n){return shuffleSelf(copyArray(array),baseClamp(n,0,array.length));}/**
 * The base implementation of `_.sampleSize` without param guards.
 *
 * @private
 * @param {Array|Object} collection The collection to sample.
 * @param {number} n The number of elements to sample.
 * @returns {Array} Returns the random elements.
 */function baseSampleSize(collection,n){var array=values(collection);return shuffleSelf(array,baseClamp(n,0,array.length));}/**
 * Gets `n` random elements at unique keys from `collection` up to the
 * size of `collection`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Collection
 * @param {Array|Object} collection The collection to sample.
 * @param {number} [n=1] The number of elements to sample.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the random elements.
 * @example
 *
 * _.sampleSize([1, 2, 3], 2);
 * // => [3, 1]
 *
 * _.sampleSize([1, 2, 3], 4);
 * // => [2, 3, 1]
 */function sampleSize(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):n===undefined){n=1;}else{n=toInteger(n);}var func=isArray(collection)?arraySampleSize:baseSampleSize;return func(collection,n);}/**
 * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,
 * it's created. Arrays are created for missing index properties while objects
 * are created for all other missing properties. Use `_.setWith` to customize
 * `path` creation.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 3.7.0
 * @category Object
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
 *
 * _.set(object, 'a[0].b.c', 4);
 * console.log(object.a[0].b.c);
 * // => 4
 *
 * _.set(object, ['x', '0', 'y', 'z'], 5);
 * console.log(object.x[0].y.z);
 * // => 5
 */function set(object,path,value){return object==null?object:baseSet(object,path,value);}/**
 * This method is like `_.set` except that it accepts `customizer` which is
 * invoked to produce the objects of `path`.  If `customizer` returns `undefined`
 * path creation is handled by the method instead. The `customizer` is invoked
 * with three arguments: (nsValue, key, nsObject).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to set.
 * @param {*} value The value to set.
 * @param {Function} [customizer] The function to customize assigned values.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = {};
 *
 * _.setWith(object, '[0][1]', 'a', Object);
 * // => { '0': { '1': 'a' } }
 */function setWith(object,path,value,customizer){customizer=typeof customizer=='function'?customizer:undefined;return object==null?object:baseSet(object,path,value,customizer);}/**
 * A specialized version of `_.shuffle` for arrays.
 *
 * @private
 * @param {Array} array The array to shuffle.
 * @returns {Array} Returns the new shuffled array.
 */function arrayShuffle(array){return shuffleSelf(copyArray(array));}/**
 * The base implementation of `_.shuffle`.
 *
 * @private
 * @param {Array|Object} collection The collection to shuffle.
 * @returns {Array} Returns the new shuffled array.
 */function baseShuffle(collection){return shuffleSelf(values(collection));}/**
 * Creates an array of shuffled values, using a version of the
 * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to shuffle.
 * @returns {Array} Returns the new shuffled array.
 * @example
 *
 * _.shuffle([1, 2, 3, 4]);
 * // => [4, 1, 3, 2]
 */function shuffle(collection){var func=isArray(collection)?arrayShuffle:baseShuffle;return func(collection);}/** `Object#toString` result references. */var mapTag='[object Map]',setTag='[object Set]';/**
 * Gets the size of `collection` by returning its length for array-like
 * values or the number of own enumerable string keyed properties for objects.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object|string} collection The collection to inspect.
 * @returns {number} Returns the collection size.
 * @example
 *
 * _.size([1, 2, 3]);
 * // => 3
 *
 * _.size({ 'a': 1, 'b': 2 });
 * // => 2
 *
 * _.size('pebbles');
 * // => 7
 */function size(collection){if(collection==null){return 0;}if(isArrayLike(collection)){return isString(collection)?stringSize(collection):collection.length;}var tag=getTag$1(collection);if(tag==mapTag||tag==setTag){return collection.size;}return baseKeys(collection).length;}/**
 * Creates a slice of `array` from `start` up to, but not including, `end`.
 *
 * **Note:** This method is used instead of
 * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are
 * returned.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to slice.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the slice of `array`.
 */function slice(array,start,end){var length=array==null?0:array.length;if(!length){return[];}if(end&&typeof end!='number'&&isIterateeCall(array,start,end)){start=0;end=length;}else{start=start==null?0:toInteger(start);end=end===undefined?length:toInteger(end);}return baseSlice(array,start,end);}/**
 * Converts `string` to
 * [snake case](https://en.wikipedia.org/wiki/Snake_case).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the snake cased string.
 * @example
 *
 * _.snakeCase('Foo Bar');
 * // => 'foo_bar'
 *
 * _.snakeCase('fooBar');
 * // => 'foo_bar'
 *
 * _.snakeCase('--FOO-BAR--');
 * // => 'foo_bar'
 */var snakeCase=createCompounder(function(result,word,index){return result+(index?'_':'')+word.toLowerCase();});/**
 * The base implementation of `_.some` without support for iteratee shorthands.
 *
 * @private
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if any element passes the predicate check,
 *  else `false`.
 */function baseSome(collection,predicate){var result;baseEach(collection,function(value,index,collection){result=predicate(value,index,collection);return!result;});return!!result;}/**
 * Checks if `predicate` returns truthy for **any** element of `collection`.
 * Iteration is stopped once `predicate` returns truthy. The predicate is
 * invoked with three arguments: (value, index|key, collection).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {boolean} Returns `true` if any element passes the predicate check,
 *  else `false`.
 * @example
 *
 * _.some([null, 0, 'yes', false], Boolean);
 * // => true
 *
 * var users = [
 *   { 'user': 'barney', 'active': true },
 *   { 'user': 'fred',   'active': false }
 * ];
 *
 * // The `_.matches` iteratee shorthand.
 * _.some(users, { 'user': 'barney', 'active': false });
 * // => false
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.some(users, ['active', false]);
 * // => true
 *
 * // The `_.property` iteratee shorthand.
 * _.some(users, 'active');
 * // => true
 */function some(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;if(guard&&isIterateeCall(collection,predicate,guard)){predicate=undefined;}return func(collection,baseIteratee(predicate));}/**
 * Creates an array of elements, sorted in ascending order by the results of
 * running each element in a collection thru each iteratee. This method
 * performs a stable sort, that is, it preserves the original sort order of
 * equal elements. The iteratees are invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Collection
 * @param {Array|Object} collection The collection to iterate over.
 * @param {...(Function|Function[])} [iteratees=[_.identity]]
 *  The iteratees to sort by.
 * @returns {Array} Returns the new sorted array.
 * @example
 *
 * var users = [
 *   { 'user': 'fred',   'age': 48 },
 *   { 'user': 'barney', 'age': 36 },
 *   { 'user': 'fred',   'age': 30 },
 *   { 'user': 'barney', 'age': 34 }
 * ];
 *
 * _.sortBy(users, [function(o) { return o.user; }]);
 * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]
 *
 * _.sortBy(users, ['user', 'age']);
 * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]
 */var sortBy=baseRest(function(collection,iteratees){if(collection==null){return[];}var length=iteratees.length;if(length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])){iteratees=[];}else if(length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])){iteratees=[iteratees[0]];}return baseOrderBy(collection,baseFlatten(iteratees,1),[]);});/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$4=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH$4-1;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeFloor=Math.floor,nativeMin$4=Math.min;/**
 * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`
 * which invokes `iteratee` for `value` and each element of `array` to compute
 * their sort ranking. The iteratee is invoked with one argument; (value).
 *
 * @private
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {Function} iteratee The iteratee invoked per element.
 * @param {boolean} [retHighest] Specify returning the highest qualified index.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 */function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=array==null?0:array.length;if(high===0){return 0;}value=iteratee(value);var valIsNaN=value!==value,valIsNull=value===null,valIsSymbol=isSymbol(value),valIsUndefined=value===undefined;while(low<high){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=computed!==undefined,othIsNull=computed===null,othIsReflexive=computed===computed,othIsSymbol=isSymbol(computed);if(valIsNaN){var setLow=retHighest||othIsReflexive;}else if(valIsUndefined){setLow=othIsReflexive&&(retHighest||othIsDefined);}else if(valIsNull){setLow=othIsReflexive&&othIsDefined&&(retHighest||!othIsNull);}else if(valIsSymbol){setLow=othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol);}else if(othIsNull||othIsSymbol){setLow=false;}else{setLow=retHighest?computed<=value:computed<value;}if(setLow){low=mid+1;}else{high=mid;}}return nativeMin$4(high,MAX_ARRAY_INDEX);}/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$3=4294967295,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH$3>>>1;/**
 * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which
 * performs a binary search of `array` to determine the index at which `value`
 * should be inserted into `array` in order to maintain its sort order.
 *
 * @private
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {boolean} [retHighest] Specify returning the highest qualified index.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 */function baseSortedIndex(array,value,retHighest){var low=0,high=array==null?low:array.length;if(typeof value=='number'&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){while(low<high){var mid=low+high>>>1,computed=array[mid];if(computed!==null&&!isSymbol(computed)&&(retHighest?computed<=value:computed<value)){low=mid+1;}else{high=mid;}}return high;}return baseSortedIndexBy(array,value,identity,retHighest);}/**
 * Uses a binary search to determine the lowest index at which `value`
 * should be inserted into `array` in order to maintain its sort order.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 * @example
 *
 * _.sortedIndex([30, 50], 40);
 * // => 1
 */function sortedIndex(array,value){return baseSortedIndex(array,value);}/**
 * This method is like `_.sortedIndex` except that it accepts `iteratee`
 * which is invoked for `value` and each element of `array` to compute their
 * sort ranking. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 * @example
 *
 * var objects = [{ 'x': 4 }, { 'x': 5 }];
 *
 * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });
 * // => 0
 *
 * // The `_.property` iteratee shorthand.
 * _.sortedIndexBy(objects, { 'x': 4 }, 'x');
 * // => 0
 */function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,baseIteratee(iteratee));}/**
 * This method is like `_.indexOf` except that it performs a binary
 * search on a sorted `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 * @example
 *
 * _.sortedIndexOf([4, 5, 5, 5, 6], 5);
 * // => 1
 */function sortedIndexOf(array,value){var length=array==null?0:array.length;if(length){var index=baseSortedIndex(array,value);if(index<length&&eq(array[index],value)){return index;}}return-1;}/**
 * This method is like `_.sortedIndex` except that it returns the highest
 * index at which `value` should be inserted into `array` in order to
 * maintain its sort order.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 * @example
 *
 * _.sortedLastIndex([4, 5, 5, 5, 6], 5);
 * // => 4
 */function sortedLastIndex(array,value){return baseSortedIndex(array,value,true);}/**
 * This method is like `_.sortedLastIndex` except that it accepts `iteratee`
 * which is invoked for `value` and each element of `array` to compute their
 * sort ranking. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 * @example
 *
 * var objects = [{ 'x': 4 }, { 'x': 5 }];
 *
 * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });
 * // => 1
 *
 * // The `_.property` iteratee shorthand.
 * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');
 * // => 1
 */function sortedLastIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,baseIteratee(iteratee),true);}/**
 * This method is like `_.lastIndexOf` except that it performs a binary
 * search on a sorted `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 * @example
 *
 * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);
 * // => 3
 */function sortedLastIndexOf(array,value){var length=array==null?0:array.length;if(length){var index=baseSortedIndex(array,value,true)-1;if(eq(array[index],value)){return index;}}return-1;}/**
 * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without
 * support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @returns {Array} Returns the new duplicate free array.
 */function baseSortedUniq(array,iteratee){var index=-1,length=array.length,resIndex=0,result=[];while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;if(!index||!eq(computed,seen)){var seen=computed;result[resIndex++]=value===0?0:value;}}return result;}/**
 * This method is like `_.uniq` except that it's designed and optimized
 * for sorted arrays.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @returns {Array} Returns the new duplicate free array.
 * @example
 *
 * _.sortedUniq([1, 1, 2]);
 * // => [1, 2]
 */function sortedUniq(array){return array&&array.length?baseSortedUniq(array):[];}/**
 * This method is like `_.uniqBy` except that it's designed and optimized
 * for sorted arrays.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @returns {Array} Returns the new duplicate free array.
 * @example
 *
 * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);
 * // => [1.1, 2.3]
 */function sortedUniqBy(array,iteratee){return array&&array.length?baseSortedUniq(array,baseIteratee(iteratee)):[];}/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$2=4294967295;/**
 * Splits `string` by `separator`.
 *
 * **Note:** This method is based on
 * [`String#split`](https://mdn.io/String/split).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to split.
 * @param {RegExp|string} separator The separator pattern to split by.
 * @param {number} [limit] The length to truncate results to.
 * @returns {Array} Returns the string segments.
 * @example
 *
 * _.split('a-b-c', '-', 2);
 * // => ['a', 'b']
 */function split(string,separator,limit){if(limit&&typeof limit!='number'&&isIterateeCall(string,separator,limit)){separator=limit=undefined;}limit=limit===undefined?MAX_ARRAY_LENGTH$2:limit>>>0;if(!limit){return[];}string=toString(string);if(string&&(typeof separator=='string'||separator!=null&&!isRegExp(separator))){separator=baseToString(separator);if(!separator&&hasUnicode(string)){return castSlice(stringToArray(string),0,limit);}}return string.split(separator,limit);}/** Error message constants. */var FUNC_ERROR_TEXT$1='Expected a function';/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$3=Math.max;/**
 * Creates a function that invokes `func` with the `this` binding of the
 * create function and an array of arguments much like
 * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).
 *
 * **Note:** This method is based on the
 * [spread operator](https://mdn.io/spread_operator).
 *
 * @static
 * @memberOf _
 * @since 3.2.0
 * @category Function
 * @param {Function} func The function to spread arguments over.
 * @param {number} [start=0] The start position of the spread.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var say = _.spread(function(who, what) {
 *   return who + ' says ' + what;
 * });
 *
 * say(['fred', 'hello']);
 * // => 'fred says hello'
 *
 * var numbers = Promise.all([
 *   Promise.resolve(40),
 *   Promise.resolve(36)
 * ]);
 *
 * numbers.then(_.spread(function(x, y) {
 *   return x + y;
 * }));
 * // => a Promise of 76
 */function spread(func,start){if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT$1);}start=start==null?0:nativeMax$3(toInteger(start),0);return baseRest(function(args){var array=args[start],otherArgs=castSlice(args,0,start);if(array){arrayPush(otherArgs,array);}return apply(func,this,otherArgs);});}/**
 * Converts `string` to
 * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).
 *
 * @static
 * @memberOf _
 * @since 3.1.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the start cased string.
 * @example
 *
 * _.startCase('--foo-bar--');
 * // => 'Foo Bar'
 *
 * _.startCase('fooBar');
 * // => 'Foo Bar'
 *
 * _.startCase('__FOO_BAR__');
 * // => 'FOO BAR'
 */var startCase=createCompounder(function(result,word,index){return result+(index?' ':'')+upperFirst(word);});/**
 * Checks if `string` starts with the given target string.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to inspect.
 * @param {string} [target] The string to search for.
 * @param {number} [position=0] The position to search from.
 * @returns {boolean} Returns `true` if `string` starts with `target`,
 *  else `false`.
 * @example
 *
 * _.startsWith('abc', 'a');
 * // => true
 *
 * _.startsWith('abc', 'b');
 * // => false
 *
 * _.startsWith('abc', 'b', 1);
 * // => true
 */function startsWith(string,target,position){string=toString(string);position=position==null?0:baseClamp(toInteger(position),0,string.length);target=baseToString(target);return string.slice(position,position+target.length)==target;}/**
 * This method returns a new empty object.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {Object} Returns the new empty object.
 * @example
 *
 * var objects = _.times(2, _.stubObject);
 *
 * console.log(objects);
 * // => [{}, {}]
 *
 * console.log(objects[0] === objects[1]);
 * // => false
 */function stubObject(){return{};}/**
 * This method returns an empty string.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {string} Returns the empty string.
 * @example
 *
 * _.times(2, _.stubString);
 * // => ['', '']
 */function stubString(){return'';}/**
 * This method returns `true`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `true`.
 * @example
 *
 * _.times(2, _.stubTrue);
 * // => [true, true]
 */function stubTrue(){return true;}/**
 * Subtract two numbers.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Math
 * @param {number} minuend The first number in a subtraction.
 * @param {number} subtrahend The second number in a subtraction.
 * @returns {number} Returns the difference.
 * @example
 *
 * _.subtract(6, 4);
 * // => 2
 */var subtract=createMathOperation(function(minuend,subtrahend){return minuend-subtrahend;},0);/**
 * Computes the sum of the values in `array`.
 *
 * @static
 * @memberOf _
 * @since 3.4.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @returns {number} Returns the sum.
 * @example
 *
 * _.sum([4, 2, 8, 6]);
 * // => 20
 */function sum(array){return array&&array.length?baseSum(array,identity):0;}/**
 * This method is like `_.sum` except that it accepts `iteratee` which is
 * invoked for each element in `array` to generate the value to be summed.
 * The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Math
 * @param {Array} array The array to iterate over.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {number} Returns the sum.
 * @example
 *
 * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];
 *
 * _.sumBy(objects, function(o) { return o.n; });
 * // => 20
 *
 * // The `_.property` iteratee shorthand.
 * _.sumBy(objects, 'n');
 * // => 20
 */function sumBy(array,iteratee){return array&&array.length?baseSum(array,baseIteratee(iteratee)):0;}/**
 * Gets all but the first element of `array`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.tail([1, 2, 3]);
 * // => [2, 3]
 */function tail(array){var length=array==null?0:array.length;return length?baseSlice(array,1,length):[];}/**
 * Creates a slice of `array` with `n` elements taken from the beginning.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {number} [n=1] The number of elements to take.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.take([1, 2, 3]);
 * // => [1]
 *
 * _.take([1, 2, 3], 2);
 * // => [1, 2]
 *
 * _.take([1, 2, 3], 5);
 * // => [1, 2, 3]
 *
 * _.take([1, 2, 3], 0);
 * // => []
 */function take(array,n,guard){if(!(array&&array.length)){return[];}n=guard||n===undefined?1:toInteger(n);return baseSlice(array,0,n<0?0:n);}/**
 * Creates a slice of `array` with `n` elements taken from the end.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {number} [n=1] The number of elements to take.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * _.takeRight([1, 2, 3]);
 * // => [3]
 *
 * _.takeRight([1, 2, 3], 2);
 * // => [2, 3]
 *
 * _.takeRight([1, 2, 3], 5);
 * // => [1, 2, 3]
 *
 * _.takeRight([1, 2, 3], 0);
 * // => []
 */function takeRight(array,n,guard){var length=array==null?0:array.length;if(!length){return[];}n=guard||n===undefined?1:toInteger(n);n=length-n;return baseSlice(array,n<0?0:n,length);}/**
 * Creates a slice of `array` with elements taken from the end. Elements are
 * taken until `predicate` returns falsey. The predicate is invoked with
 * three arguments: (value, index, array).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': true },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': false }
 * ];
 *
 * _.takeRightWhile(users, function(o) { return !o.active; });
 * // => objects for ['fred', 'pebbles']
 *
 * // The `_.matches` iteratee shorthand.
 * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });
 * // => objects for ['pebbles']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.takeRightWhile(users, ['active', false]);
 * // => objects for ['fred', 'pebbles']
 *
 * // The `_.property` iteratee shorthand.
 * _.takeRightWhile(users, 'active');
 * // => []
 */function takeRightWhile(array,predicate){return array&&array.length?baseWhile(array,baseIteratee(predicate),false,true):[];}/**
 * Creates a slice of `array` with elements taken from the beginning. Elements
 * are taken until `predicate` returns falsey. The predicate is invoked with
 * three arguments: (value, index, array).
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to query.
 * @param {Function} [predicate=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the slice of `array`.
 * @example
 *
 * var users = [
 *   { 'user': 'barney',  'active': false },
 *   { 'user': 'fred',    'active': false },
 *   { 'user': 'pebbles', 'active': true }
 * ];
 *
 * _.takeWhile(users, function(o) { return !o.active; });
 * // => objects for ['barney', 'fred']
 *
 * // The `_.matches` iteratee shorthand.
 * _.takeWhile(users, { 'user': 'barney', 'active': false });
 * // => objects for ['barney']
 *
 * // The `_.matchesProperty` iteratee shorthand.
 * _.takeWhile(users, ['active', false]);
 * // => objects for ['barney', 'fred']
 *
 * // The `_.property` iteratee shorthand.
 * _.takeWhile(users, 'active');
 * // => []
 */function takeWhile(array,predicate){return array&&array.length?baseWhile(array,baseIteratee(predicate)):[];}/**
 * This method invokes `interceptor` and returns `value`. The interceptor
 * is invoked with one argument; (value). The purpose of this method is to
 * "tap into" a method chain sequence in order to modify intermediate results.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Seq
 * @param {*} value The value to provide to `interceptor`.
 * @param {Function} interceptor The function to invoke.
 * @returns {*} Returns `value`.
 * @example
 *
 * _([1, 2, 3])
 *  .tap(function(array) {
 *    // Mutate input array.
 *    array.pop();
 *  })
 *  .reverse()
 *  .value();
 * // => [2, 1]
 */function tap(value,interceptor){interceptor(value);return value;}/** Used for built-in method references. */var objectProto$2=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$3=objectProto$2.hasOwnProperty;/**
 * Used by `_.defaults` to customize its `_.assignIn` use to assign properties
 * of source objects to the destination object for all destination properties
 * that resolve to `undefined`.
 *
 * @private
 * @param {*} objValue The destination value.
 * @param {*} srcValue The source value.
 * @param {string} key The key of the property to assign.
 * @param {Object} object The parent object of `objValue`.
 * @returns {*} Returns the value to assign.
 */function customDefaultsAssignIn(objValue,srcValue,key,object){if(objValue===undefined||eq(objValue,objectProto$2[key])&&!hasOwnProperty$3.call(object,key)){return srcValue;}return objValue;}/** Used to escape characters for inclusion in compiled string literals. */var stringEscapes={'\\':'\\',"'":"'",'\n':'n','\r':'r',"\u2028":'u2028',"\u2029":'u2029'};/**
 * Used by `_.template` to escape characters for inclusion in compiled string literals.
 *
 * @private
 * @param {string} chr The matched character to escape.
 * @returns {string} Returns the escaped character.
 */function escapeStringChar(chr){return'\\'+stringEscapes[chr];}/** Used to match template delimiters. */var reInterpolate=/<%=([\s\S]+?)%>/g;/** Used to match template delimiters. */var reEscape=/<%-([\s\S]+?)%>/g;/** Used to match template delimiters. */var reEvaluate=/<%([\s\S]+?)%>/g;/**
 * By default, the template delimiters used by lodash are like those in
 * embedded Ruby (ERB) as well as ES2015 template strings. Change the
 * following template settings to use alternative delimiters.
 *
 * @static
 * @memberOf _
 * @type {Object}
 */var templateSettings={/**
   * Used to detect `data` property values to be HTML-escaped.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */'escape':reEscape,/**
   * Used to detect code to be evaluated.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */'evaluate':reEvaluate,/**
   * Used to detect `data` property values to inject.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */'interpolate':reInterpolate,/**
   * Used to reference the data object in the template text.
   *
   * @memberOf _.templateSettings
   * @type {string}
   */'variable':'',/**
   * Used to import variables into the compiled template.
   *
   * @memberOf _.templateSettings
   * @type {Object}
   */'imports':{/**
     * A reference to the `lodash` function.
     *
     * @memberOf _.templateSettings.imports
     * @type {Function}
     */'_':{'escape':escape}}};/** Error message constants. */var INVALID_TEMPL_VAR_ERROR_TEXT='Invalid `variable` option passed into `_.template`';/** Used to match empty string literals in compiled template source. */var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;/**
 * Used to validate the `validate` option in `_.template` variable.
 *
 * Forbids characters which could potentially change the meaning of the function argument definition:
 * - "()," (modification of function parameters)
 * - "=" (default value)
 * - "[]{}" (destructuring of function parameters)
 * - "/" (beginning of a comment)
 * - whitespace
 */var reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/;/**
 * Used to match
 * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).
 */var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;/** Used to ensure capturing order of template delimiters. */var reNoMatch=/($^)/;/** Used to match unescaped characters in compiled string literals. */var reUnescapedString=/['\n\r\u2028\u2029\\]/g;/** Used for built-in method references. */var objectProto$1=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$2=objectProto$1.hasOwnProperty;/**
 * Creates a compiled template function that can interpolate data properties
 * in "interpolate" delimiters, HTML-escape interpolated data properties in
 * "escape" delimiters, and execute JavaScript in "evaluate" delimiters. Data
 * properties may be accessed as free variables in the template. If a setting
 * object is given, it takes precedence over `_.templateSettings` values.
 *
 * **Note:** In the development build `_.template` utilizes
 * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)
 * for easier debugging.
 *
 * For more information on precompiling templates see
 * [lodash's custom builds documentation](https://lodash.com/custom-builds).
 *
 * For more information on Chrome extension sandboxes see
 * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category String
 * @param {string} [string=''] The template string.
 * @param {Object} [options={}] The options object.
 * @param {RegExp} [options.escape=_.templateSettings.escape]
 *  The HTML "escape" delimiter.
 * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]
 *  The "evaluate" delimiter.
 * @param {Object} [options.imports=_.templateSettings.imports]
 *  An object to import into the template as free variables.
 * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]
 *  The "interpolate" delimiter.
 * @param {string} [options.sourceURL='templateSources[n]']
 *  The sourceURL of the compiled template.
 * @param {string} [options.variable='obj']
 *  The data object variable name.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Function} Returns the compiled template function.
 * @example
 *
 * // Use the "interpolate" delimiter to create a compiled template.
 * var compiled = _.template('hello <%= user %>!');
 * compiled({ 'user': 'fred' });
 * // => 'hello fred!'
 *
 * // Use the HTML "escape" delimiter to escape data property values.
 * var compiled = _.template('<b><%- value %></b>');
 * compiled({ 'value': '<script>' });
 * // => '<b>&lt;script&gt;</b>'
 *
 * // Use the "evaluate" delimiter to execute JavaScript and generate HTML.
 * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');
 * compiled({ 'users': ['fred', 'barney'] });
 * // => '<li>fred</li><li>barney</li>'
 *
 * // Use the internal `print` function in "evaluate" delimiters.
 * var compiled = _.template('<% print("hello " + user); %>!');
 * compiled({ 'user': 'barney' });
 * // => 'hello barney!'
 *
 * // Use the ES template literal delimiter as an "interpolate" delimiter.
 * // Disable support by replacing the "interpolate" delimiter.
 * var compiled = _.template('hello ${ user }!');
 * compiled({ 'user': 'pebbles' });
 * // => 'hello pebbles!'
 *
 * // Use backslashes to treat delimiters as plain text.
 * var compiled = _.template('<%= "\\<%- value %\\>" %>');
 * compiled({ 'value': 'ignored' });
 * // => '<%- value %>'
 *
 * // Use the `imports` option to import `jQuery` as `jq`.
 * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';
 * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });
 * compiled({ 'users': ['fred', 'barney'] });
 * // => '<li>fred</li><li>barney</li>'
 *
 * // Use the `sourceURL` option to specify a custom sourceURL for the template.
 * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });
 * compiled(data);
 * // => Find the source of "greeting.jst" under the Sources tab or Resources panel of the web inspector.
 *
 * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.
 * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });
 * compiled.source;
 * // => function(data) {
 * //   var __t, __p = '';
 * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';
 * //   return __p;
 * // }
 *
 * // Use custom template delimiters.
 * _.templateSettings.interpolate = /{{([\s\S]+?)}}/g;
 * var compiled = _.template('hello {{ user }}!');
 * compiled({ 'user': 'mustache' });
 * // => 'hello mustache!'
 *
 * // Use the `source` property to inline compiled templates for meaningful
 * // line numbers in error messages and stack traces.
 * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\
 *   var JST = {\
 *     "main": ' + _.template(mainText).source + '\
 *   };\
 * ');
 */function template(string,options,guard){// Based on John Resig's `tmpl` implementation
// (http://ejohn.org/blog/javascript-micro-templating/)
// and Laura Doktorova's doT.js (https://github.com/olado/doT).
var settings=templateSettings.imports._.templateSettings||templateSettings;if(guard&&isIterateeCall(string,options,guard)){options=undefined;}string=toString(string);options=assignInWith({},options,settings,customDefaultsAssignIn);var imports=assignInWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys$1(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";// Compile the regexp to match each delimiter.
var reDelimiters=RegExp((options.escape||reNoMatch).source+'|'+interpolate.source+'|'+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+'|'+(options.evaluate||reNoMatch).source+'|$','g');// Use a sourceURL for easier debugging.
// The sourceURL gets injected into the source that's eval-ed, so be careful
// to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in
// and escape the comment, thus injecting code that gets evaled.
var sourceURL=hasOwnProperty$2.call(options,'sourceURL')?'//# sourceURL='+(options.sourceURL+'').replace(/\s/g,' ')+'\n':'';string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);// Escape characters that can't be included in string literals.
source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar);// Replace delimiters with snippets.
if(escapeValue){isEscaping=true;source+="' +\n__e("+escapeValue+") +\n'";}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '";}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'";}index=offset+match.length;// The JS engine embedded in Adobe products needs `match` returned in
// order to produce the correct `offset` value.
return match;});source+="';\n";// If `variable` is not specified wrap a with-statement around the generated
// code to add the data object to the top of the scope chain.
var variable=hasOwnProperty$2.call(options,'variable')&&options.variable;if(!variable){source='with (obj) {\n'+source+'\n}\n';}// Throw an error if a forbidden character was found in `variable`, to prevent
// potential command injection attacks.
else if(reForbiddenIdentifierChars.test(variable)){throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);}// Cleanup code by stripping empty strings.
source=(isEvaluating?source.replace(reEmptyStringLeading,''):source).replace(reEmptyStringMiddle,'$1').replace(reEmptyStringTrailing,'$1;');// Frame code as the function body.
source='function('+(variable||'obj')+') {\n'+(variable?'':'obj || (obj = {});\n')+"var __t, __p = ''"+(isEscaping?', __e = _.escape':'')+(isEvaluating?', __j = Array.prototype.join;\n'+"function print() { __p += __j.call(arguments, '') }\n":';\n')+source+'return __p\n}';var result=attempt(function(){return Function(importsKeys,sourceURL+'return '+source).apply(undefined,importsValues);});// Provide the compiled function's source by its `toString` method or
// the `source` property as a convenience for inlining compiled templates.
result.source=source;if(isError(result)){throw result;}return result;}/** Error message constants. */var FUNC_ERROR_TEXT='Expected a function';/**
 * Creates a throttled function that only invokes `func` at most once per
 * every `wait` milliseconds. The throttled function comes with a `cancel`
 * method to cancel delayed `func` invocations and a `flush` method to
 * immediately invoke them. Provide `options` to indicate whether `func`
 * should be invoked on the leading and/or trailing edge of the `wait`
 * timeout. The `func` is invoked with the last arguments provided to the
 * throttled function. Subsequent calls to the throttled function return the
 * result of the last `func` invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the throttled function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until to the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `_.throttle` and `_.debounce`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to throttle.
 * @param {number} [wait=0] The number of milliseconds to throttle invocations to.
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.leading=true]
 *  Specify invoking on the leading edge of the timeout.
 * @param {boolean} [options.trailing=true]
 *  Specify invoking on the trailing edge of the timeout.
 * @returns {Function} Returns the new throttled function.
 * @example
 *
 * // Avoid excessively updating the position while scrolling.
 * jQuery(window).on('scroll', _.throttle(updatePosition, 100));
 *
 * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.
 * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });
 * jQuery(element).on('click', throttled);
 *
 * // Cancel the trailing throttled invocation.
 * jQuery(window).on('popstate', throttled.cancel);
 */function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!='function'){throw new TypeError(FUNC_ERROR_TEXT);}if(isObject(options)){leading='leading'in options?!!options.leading:leading;trailing='trailing'in options?!!options.trailing:trailing;}return debounce$1(func,wait,{'leading':leading,'maxWait':wait,'trailing':trailing});}/**
 * This method is like `_.tap` except that it returns the result of `interceptor`.
 * The purpose of this method is to "pass thru" values replacing intermediate
 * results in a method chain sequence.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Seq
 * @param {*} value The value to provide to `interceptor`.
 * @param {Function} interceptor The function to invoke.
 * @returns {*} Returns the result of `interceptor`.
 * @example
 *
 * _('  abc  ')
 *  .chain()
 *  .trim()
 *  .thru(function(value) {
 *    return [value];
 *  })
 *  .value();
 * // => ['abc']
 */function thru(value,interceptor){return interceptor(value);}/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER$1=9007199254740991;/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH$1=4294967295;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$3=Math.min;/**
 * Invokes the iteratee `n` times, returning an array of the results of
 * each invocation. The iteratee is invoked with one argument; (index).
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 * @example
 *
 * _.times(3, String);
 * // => ['0', '1', '2']
 *
 *  _.times(4, _.constant(0));
 * // => [0, 0, 0, 0]
 */function times(n,iteratee){n=toInteger(n);if(n<1||n>MAX_SAFE_INTEGER$1){return[];}var index=MAX_ARRAY_LENGTH$1,length=nativeMin$3(n,MAX_ARRAY_LENGTH$1);iteratee=castFunction(iteratee);n-=MAX_ARRAY_LENGTH$1;var result=baseTimes(length,iteratee);while(++index<n){iteratee(index);}return result;}/**
 * Enables the wrapper to be iterable.
 *
 * @name Symbol.iterator
 * @memberOf _
 * @since 4.0.0
 * @category Seq
 * @returns {Object} Returns the wrapper object.
 * @example
 *
 * var wrapped = _([1, 2]);
 *
 * wrapped[Symbol.iterator]() === wrapped;
 * // => true
 *
 * Array.from(wrapped);
 * // => [1, 2]
 */function wrapperToIterator(){return this;}/**
 * The base implementation of `wrapperValue` which returns the result of
 * performing a sequence of actions on the unwrapped `value`, where each
 * successive action is supplied the return value of the previous.
 *
 * @private
 * @param {*} value The unwrapped value.
 * @param {Array} actions Actions to perform to resolve the unwrapped value.
 * @returns {*} Returns the resolved value.
 */function baseWrapperValue(value,actions){var result=value;if(result instanceof LazyWrapper){result=result.value();}return arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args));},result);}/**
 * Executes the chain sequence to resolve the unwrapped value.
 *
 * @name value
 * @memberOf _
 * @since 0.1.0
 * @alias toJSON, valueOf
 * @category Seq
 * @returns {*} Returns the resolved unwrapped value.
 * @example
 *
 * _([1, 2, 3]).value();
 * // => [1, 2, 3]
 */function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__);}/**
 * Converts `string`, as a whole, to lower case just like
 * [String#toLowerCase](https://mdn.io/toLowerCase).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the lower cased string.
 * @example
 *
 * _.toLower('--Foo-Bar--');
 * // => '--foo-bar--'
 *
 * _.toLower('fooBar');
 * // => 'foobar'
 *
 * _.toLower('__FOO_BAR__');
 * // => '__foo_bar__'
 */function toLower(value){return toString(value).toLowerCase();}/**
 * Converts `value` to a property path array.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Util
 * @param {*} value The value to convert.
 * @returns {Array} Returns the new property path array.
 * @example
 *
 * _.toPath('a.b.c');
 * // => ['a', 'b', 'c']
 *
 * _.toPath('a[0].b.c');
 * // => ['a', '0', 'b', 'c']
 */function toPath(value){if(isArray(value)){return arrayMap(value,toKey);}return isSymbol(value)?[value]:copyArray(stringToPath(toString(value)));}/** Used as references for various `Number` constants. */var MAX_SAFE_INTEGER=9007199254740991;/**
 * Converts `value` to a safe integer. A safe integer can be compared and
 * represented correctly.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted integer.
 * @example
 *
 * _.toSafeInteger(3.2);
 * // => 3
 *
 * _.toSafeInteger(Number.MIN_VALUE);
 * // => 0
 *
 * _.toSafeInteger(Infinity);
 * // => 9007199254740991
 *
 * _.toSafeInteger('3.2');
 * // => 3
 */function toSafeInteger(value){return value?baseClamp(toInteger(value),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER):value===0?value:0;}/**
 * Converts `string`, as a whole, to upper case just like
 * [String#toUpperCase](https://mdn.io/toUpperCase).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the upper cased string.
 * @example
 *
 * _.toUpper('--foo-bar--');
 * // => '--FOO-BAR--'
 *
 * _.toUpper('fooBar');
 * // => 'FOOBAR'
 *
 * _.toUpper('__foo_bar__');
 * // => '__FOO_BAR__'
 */function toUpper(value){return toString(value).toUpperCase();}/**
 * An alternative to `_.reduce`; this method transforms `object` to a new
 * `accumulator` object which is the result of running each of its own
 * enumerable string keyed properties thru `iteratee`, with each invocation
 * potentially mutating the `accumulator` object. If `accumulator` is not
 * provided, a new object with the same `[[Prototype]]` will be used. The
 * iteratee is invoked with four arguments: (accumulator, value, key, object).
 * Iteratee functions may exit iteration early by explicitly returning `false`.
 *
 * @static
 * @memberOf _
 * @since 1.3.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @param {*} [accumulator] The custom accumulator value.
 * @returns {*} Returns the accumulated value.
 * @example
 *
 * _.transform([2, 3, 4], function(result, n) {
 *   result.push(n *= n);
 *   return n % 2 == 0;
 * }, []);
 * // => [4, 9]
 *
 * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {
 *   (result[value] || (result[value] = [])).push(key);
 * }, {});
 * // => { '1': ['a', 'c'], '2': ['b'] }
 */function transform(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);iteratee=baseIteratee(iteratee);if(accumulator==null){var Ctor=object&&object.constructor;if(isArrLike){accumulator=isArr?new Ctor():[];}else if(isObject(object)){accumulator=isFunction(Ctor)?baseCreate(getPrototype(object)):{};}else{accumulator={};}}(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object);});return accumulator;}/**
 * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol
 * that is not found in the character symbols.
 *
 * @private
 * @param {Array} strSymbols The string symbols to inspect.
 * @param {Array} chrSymbols The character symbols to find.
 * @returns {number} Returns the index of the last unmatched string symbol.
 */function charsEndIndex(strSymbols,chrSymbols){var index=strSymbols.length;while(index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1){}return index;}/**
 * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol
 * that is not found in the character symbols.
 *
 * @private
 * @param {Array} strSymbols The string symbols to inspect.
 * @param {Array} chrSymbols The character symbols to find.
 * @returns {number} Returns the index of the first unmatched string symbol.
 */function charsStartIndex(strSymbols,chrSymbols){var index=-1,length=strSymbols.length;while(++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1){}return index;}/**
 * Removes leading and trailing whitespace or specified characters from `string`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to trim.
 * @param {string} [chars=whitespace] The characters to trim.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {string} Returns the trimmed string.
 * @example
 *
 * _.trim('  abc  ');
 * // => 'abc'
 *
 * _.trim('-_-abc-_-', '_-');
 * // => 'abc'
 *
 * _.map(['  foo  ', '  bar  '], _.trim);
 * // => ['foo', 'bar']
 */function trim(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return baseTrim(string);}if(!string||!(chars=baseToString(chars))){return string;}var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars),start=charsStartIndex(strSymbols,chrSymbols),end=charsEndIndex(strSymbols,chrSymbols)+1;return castSlice(strSymbols,start,end).join('');}/**
 * Removes trailing whitespace or specified characters from `string`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to trim.
 * @param {string} [chars=whitespace] The characters to trim.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {string} Returns the trimmed string.
 * @example
 *
 * _.trimEnd('  abc  ');
 * // => '  abc'
 *
 * _.trimEnd('-_-abc-_-', '_-');
 * // => '-_-abc'
 */function trimEnd(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return string.slice(0,trimmedEndIndex(string)+1);}if(!string||!(chars=baseToString(chars))){return string;}var strSymbols=stringToArray(string),end=charsEndIndex(strSymbols,stringToArray(chars))+1;return castSlice(strSymbols,0,end).join('');}/** Used to match leading whitespace. */var reTrimStart=/^\s+/;/**
 * Removes leading whitespace or specified characters from `string`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to trim.
 * @param {string} [chars=whitespace] The characters to trim.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {string} Returns the trimmed string.
 * @example
 *
 * _.trimStart('  abc  ');
 * // => 'abc  '
 *
 * _.trimStart('-_-abc-_-', '_-');
 * // => 'abc-_-'
 */function trimStart(string,chars,guard){string=toString(string);if(string&&(guard||chars===undefined)){return string.replace(reTrimStart,'');}if(!string||!(chars=baseToString(chars))){return string;}var strSymbols=stringToArray(string),start=charsStartIndex(strSymbols,stringToArray(chars));return castSlice(strSymbols,start).join('');}/** Used as default options for `_.truncate`. */var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION='...';/** Used to match `RegExp` flags from their coerced string values. */var reFlags=/\w*$/;/**
 * Truncates `string` if it's longer than the given maximum string length.
 * The last characters of the truncated string are replaced with the omission
 * string which defaults to "...".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to truncate.
 * @param {Object} [options={}] The options object.
 * @param {number} [options.length=30] The maximum string length.
 * @param {string} [options.omission='...'] The string to indicate text is omitted.
 * @param {RegExp|string} [options.separator] The separator pattern to truncate to.
 * @returns {string} Returns the truncated string.
 * @example
 *
 * _.truncate('hi-diddly-ho there, neighborino');
 * // => 'hi-diddly-ho there, neighbo...'
 *
 * _.truncate('hi-diddly-ho there, neighborino', {
 *   'length': 24,
 *   'separator': ' '
 * });
 * // => 'hi-diddly-ho there,...'
 *
 * _.truncate('hi-diddly-ho there, neighborino', {
 *   'length': 24,
 *   'separator': /,? +/
 * });
 * // => 'hi-diddly-ho there...'
 *
 * _.truncate('hi-diddly-ho there, neighborino', {
 *   'omission': ' [...]'
 * });
 * // => 'hi-diddly-ho there, neig [...]'
 */function truncate$1(string,options){var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(isObject(options)){var separator='separator'in options?options.separator:separator;length='length'in options?toInteger(options.length):length;omission='omission'in options?baseToString(options.omission):omission;}string=toString(string);var strLength=string.length;if(hasUnicode(string)){var strSymbols=stringToArray(string);strLength=strSymbols.length;}if(length>=strLength){return string;}var end=length-stringSize(omission);if(end<1){return omission;}var result=strSymbols?castSlice(strSymbols,0,end).join(''):string.slice(0,end);if(separator===undefined){return result+omission;}if(strSymbols){end+=result.length-end;}if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;if(!separator.global){separator=RegExp(separator.source,toString(reFlags.exec(separator))+'g');}separator.lastIndex=0;while(match=separator.exec(substring)){var newEnd=match.index;}result=result.slice(0,newEnd===undefined?end:newEnd);}}else if(string.indexOf(baseToString(separator),end)!=end){var index=result.lastIndexOf(separator);if(index>-1){result=result.slice(0,index);}}return result+omission;}/**
 * Creates a function that accepts up to one argument, ignoring any
 * additional arguments.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Function
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 * @example
 *
 * _.map(['6', '8', '10'], _.unary(parseInt));
 * // => [6, 8, 10]
 */function unary(func){return ary(func,1);}/** Used to map HTML entities to characters. */var htmlUnescapes={'&amp;':'&','&lt;':'<','&gt;':'>','&quot;':'"','&#39;':"'"};/**
 * Used by `_.unescape` to convert HTML entities to characters.
 *
 * @private
 * @param {string} chr The matched character to unescape.
 * @returns {string} Returns the unescaped character.
 */var unescapeHtmlChar=basePropertyOf(htmlUnescapes);/** Used to match HTML entities and HTML characters. */var reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reHasEscapedHtml=RegExp(reEscapedHtml.source);/**
 * The inverse of `_.escape`; this method converts the HTML entities
 * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to
 * their corresponding characters.
 *
 * **Note:** No other HTML entities are unescaped. To unescape additional
 * HTML entities use a third-party library like [_he_](https://mths.be/he).
 *
 * @static
 * @memberOf _
 * @since 0.6.0
 * @category String
 * @param {string} [string=''] The string to unescape.
 * @returns {string} Returns the unescaped string.
 * @example
 *
 * _.unescape('fred, barney, &amp; pebbles');
 * // => 'fred, barney, & pebbles'
 */function unescape(string){string=toString(string);return string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string;}/** Used as references for various `Number` constants. */var INFINITY=1/0;/**
 * Creates a set object of `values`.
 *
 * @private
 * @param {Array} values The values to add to the set.
 * @returns {Object} Returns the new set.
 */var createSet=!(Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY)?noop:function(values){return new Set$1(values);};/** Used as the size to enable large array optimizations. */var LARGE_ARRAY_SIZE=200;/**
 * The base implementation of `_.uniqBy` without support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new duplicate free array.
 */function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=true,result=[],seen=result;if(comparator){isCommon=false;includes=arrayIncludesWith;}else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set){return setToArray(set);}isCommon=false;includes=cacheHas;seen=new SetCache();}else{seen=iteratee?[]:result;}outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var seenIndex=seen.length;while(seenIndex--){if(seen[seenIndex]===computed){continue outer;}}if(iteratee){seen.push(computed);}result.push(value);}else if(!includes(seen,computed,comparator)){if(seen!==result){seen.push(computed);}result.push(value);}}return result;}/**
 * Creates an array of unique values, in order, from all given arrays using
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @returns {Array} Returns the new array of combined values.
 * @example
 *
 * _.union([2], [1, 2]);
 * // => [2, 1]
 */var union=baseRest(function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true));});/**
 * This method is like `_.union` except that it accepts `iteratee` which is
 * invoked for each element of each `arrays` to generate the criterion by
 * which uniqueness is computed. Result values are chosen from the first
 * array in which the value occurs. The iteratee is invoked with one argument:
 * (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns the new array of combined values.
 * @example
 *
 * _.unionBy([2.1], [1.2, 2.3], Math.floor);
 * // => [2.1, 1.2]
 *
 * // The `_.property` iteratee shorthand.
 * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
 * // => [{ 'x': 1 }, { 'x': 2 }]
 */var unionBy=baseRest(function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined;}return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),baseIteratee(iteratee));});/**
 * This method is like `_.union` except that it accepts `comparator` which
 * is invoked to compare elements of `arrays`. Result values are chosen from
 * the first array in which the value occurs. The comparator is invoked
 * with two arguments: (arrVal, othVal).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of combined values.
 * @example
 *
 * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
 * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
 *
 * _.unionWith(objects, others, _.isEqual);
 * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]
 */var unionWith=baseRest(function(arrays){var comparator=last(arrays);comparator=typeof comparator=='function'?comparator:undefined;return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),undefined,comparator);});/**
 * Creates a duplicate-free version of an array, using
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons, in which only the first occurrence of each element
 * is kept. The order of result values is determined by the order they occur
 * in the array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @returns {Array} Returns the new duplicate free array.
 * @example
 *
 * _.uniq([2, 1, 2]);
 * // => [2, 1]
 */function uniq(array){return array&&array.length?baseUniq(array):[];}/**
 * This method is like `_.uniq` except that it accepts `iteratee` which is
 * invoked for each element in `array` to generate the criterion by which
 * uniqueness is computed. The order of result values is determined by the
 * order they occur in the array. The iteratee is invoked with one argument:
 * (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns the new duplicate free array.
 * @example
 *
 * _.uniqBy([2.1, 1.2, 2.3], Math.floor);
 * // => [2.1, 1.2]
 *
 * // The `_.property` iteratee shorthand.
 * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');
 * // => [{ 'x': 1 }, { 'x': 2 }]
 */function uniqBy(array,iteratee){return array&&array.length?baseUniq(array,baseIteratee(iteratee)):[];}/**
 * This method is like `_.uniq` except that it accepts `comparator` which
 * is invoked to compare elements of `array`. The order of result values is
 * determined by the order they occur in the array.The comparator is invoked
 * with two arguments: (arrVal, othVal).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new duplicate free array.
 * @example
 *
 * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];
 *
 * _.uniqWith(objects, _.isEqual);
 * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]
 */function uniqWith(array,comparator){comparator=typeof comparator=='function'?comparator:undefined;return array&&array.length?baseUniq(array,undefined,comparator):[];}/** Used to generate unique IDs. */var idCounter=0;/**
 * Generates a unique ID. If `prefix` is given, the ID is appended to it.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {string} [prefix=''] The value to prefix the ID with.
 * @returns {string} Returns the unique ID.
 * @example
 *
 * _.uniqueId('contact_');
 * // => 'contact_104'
 *
 * _.uniqueId();
 * // => '105'
 */function uniqueId(prefix){var id=++idCounter;return toString(prefix)+id;}/**
 * Removes the property at `path` of `object`.
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to unset.
 * @returns {boolean} Returns `true` if the property is deleted, else `false`.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 7 } }] };
 * _.unset(object, 'a[0].b.c');
 * // => true
 *
 * console.log(object);
 * // => { 'a': [{ 'b': {} }] };
 *
 * _.unset(object, ['a', '0', 'b', 'c']);
 * // => true
 *
 * console.log(object);
 * // => { 'a': [{ 'b': {} }] };
 */function unset(object,path){return object==null?true:baseUnset(object,path);}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$2=Math.max;/**
 * This method is like `_.zip` except that it accepts an array of grouped
 * elements and creates an array regrouping the elements to their pre-zip
 * configuration.
 *
 * @static
 * @memberOf _
 * @since 1.2.0
 * @category Array
 * @param {Array} array The array of grouped elements to process.
 * @returns {Array} Returns the new array of regrouped elements.
 * @example
 *
 * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);
 * // => [['a', 1, true], ['b', 2, false]]
 *
 * _.unzip(zipped);
 * // => [['a', 'b'], [1, 2], [true, false]]
 */function unzip(array){if(!(array&&array.length)){return[];}var length=0;array=arrayFilter(array,function(group){if(isArrayLikeObject(group)){length=nativeMax$2(group.length,length);return true;}});return baseTimes(length,function(index){return arrayMap(array,baseProperty(index));});}/**
 * This method is like `_.unzip` except that it accepts `iteratee` to specify
 * how regrouped values should be combined. The iteratee is invoked with the
 * elements of each group: (...group).
 *
 * @static
 * @memberOf _
 * @since 3.8.0
 * @category Array
 * @param {Array} array The array of grouped elements to process.
 * @param {Function} [iteratee=_.identity] The function to combine
 *  regrouped values.
 * @returns {Array} Returns the new array of regrouped elements.
 * @example
 *
 * var zipped = _.zip([1, 2], [10, 20], [100, 200]);
 * // => [[1, 10, 100], [2, 20, 200]]
 *
 * _.unzipWith(zipped, _.add);
 * // => [3, 30, 300]
 */function unzipWith(array,iteratee){if(!(array&&array.length)){return[];}var result=unzip(array);if(iteratee==null){return result;}return arrayMap(result,function(group){return apply(iteratee,undefined,group);});}/**
 * The base implementation of `_.update`.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to update.
 * @param {Function} updater The function to produce the updated value.
 * @param {Function} [customizer] The function to customize path creation.
 * @returns {Object} Returns `object`.
 */function baseUpdate(object,path,updater,customizer){return baseSet(object,path,updater(baseGet(object,path)),customizer);}/**
 * This method is like `_.set` except that accepts `updater` to produce the
 * value to set. Use `_.updateWith` to customize `path` creation. The `updater`
 * is invoked with one argument: (value).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.6.0
 * @category Object
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to set.
 * @param {Function} updater The function to produce the updated value.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
 *
 * _.update(object, 'a[0].b.c', function(n) { return n * n; });
 * console.log(object.a[0].b.c);
 * // => 9
 *
 * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });
 * console.log(object.x[0].y.z);
 * // => 0
 */function update(object,path,updater){return object==null?object:baseUpdate(object,path,castFunction(updater));}/**
 * This method is like `_.update` except that it accepts `customizer` which is
 * invoked to produce the objects of `path`.  If `customizer` returns `undefined`
 * path creation is handled by the method instead. The `customizer` is invoked
 * with three arguments: (nsValue, key, nsObject).
 *
 * **Note:** This method mutates `object`.
 *
 * @static
 * @memberOf _
 * @since 4.6.0
 * @category Object
 * @param {Object} object The object to modify.
 * @param {Array|string} path The path of the property to set.
 * @param {Function} updater The function to produce the updated value.
 * @param {Function} [customizer] The function to customize assigned values.
 * @returns {Object} Returns `object`.
 * @example
 *
 * var object = {};
 *
 * _.updateWith(object, '[0][1]', _.constant('a'), Object);
 * // => { '0': { '1': 'a' } }
 */function updateWith(object,path,updater,customizer){customizer=typeof customizer=='function'?customizer:undefined;return object==null?object:baseUpdate(object,path,castFunction(updater),customizer);}/**
 * Converts `string`, as space separated words, to upper case.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category String
 * @param {string} [string=''] The string to convert.
 * @returns {string} Returns the upper cased string.
 * @example
 *
 * _.upperCase('--foo-bar');
 * // => 'FOO BAR'
 *
 * _.upperCase('fooBar');
 * // => 'FOO BAR'
 *
 * _.upperCase('__foo_bar__');
 * // => 'FOO BAR'
 */var upperCase=createCompounder(function(result,word,index){return result+(index?' ':'')+word.toUpperCase();});/**
 * Creates an array of the own and inherited enumerable string keyed property
 * values of `object`.
 *
 * **Note:** Non-object values are coerced to objects.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property values.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.valuesIn(new Foo);
 * // => [1, 2, 3] (iteration order is not guaranteed)
 */function valuesIn(object){return object==null?[]:baseValues(object,keysIn(object));}/**
 * Creates an array excluding all given values using
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons.
 *
 * **Note:** Unlike `_.pull`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {...*} [values] The values to exclude.
 * @returns {Array} Returns the new array of filtered values.
 * @see _.difference, _.xor
 * @example
 *
 * _.without([2, 1, 2, 3], 1, 2);
 * // => [3]
 */var without=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[];});/**
 * Creates a function that provides `value` to `wrapper` as its first
 * argument. Any additional arguments provided to the function are appended
 * to those provided to the `wrapper`. The wrapper is invoked with the `this`
 * binding of the created function.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {*} value The value to wrap.
 * @param {Function} [wrapper=identity] The wrapper function.
 * @returns {Function} Returns the new function.
 * @example
 *
 * var p = _.wrap(_.escape, function(func, text) {
 *   return '<p>' + func(text) + '</p>';
 * });
 *
 * p('fred, barney, & pebbles');
 * // => '<p>fred, barney, &amp; pebbles</p>'
 */function wrap(value,wrapper){return partial(castFunction(wrapper),value);}/**
 * This method is the wrapper version of `_.at`.
 *
 * @name at
 * @memberOf _
 * @since 1.0.0
 * @category Seq
 * @param {...(string|string[])} [paths] The property paths to pick.
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };
 *
 * _(object).at(['a[0].b.c', 'a[1]']).value();
 * // => [3, 4]
 */var wrapperAt=flatRest(function(paths){var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function interceptor(object){return baseAt(object,paths);};if(length>1||this.__actions__.length||!(value instanceof LazyWrapper)||!isIndex(start)){return this.thru(interceptor);}value=value.slice(start,+start+(length?1:0));value.__actions__.push({'func':thru,'args':[interceptor],'thisArg':undefined});return new LodashWrapper(value,this.__chain__).thru(function(array){if(length&&!array.length){array.push(undefined);}return array;});});/**
 * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.
 *
 * @name chain
 * @memberOf _
 * @since 0.1.0
 * @category Seq
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * var users = [
 *   { 'user': 'barney', 'age': 36 },
 *   { 'user': 'fred',   'age': 40 }
 * ];
 *
 * // A sequence without explicit chaining.
 * _(users).head();
 * // => { 'user': 'barney', 'age': 36 }
 *
 * // A sequence with explicit chaining.
 * _(users)
 *   .chain()
 *   .head()
 *   .pick('user')
 *   .value();
 * // => { 'user': 'barney' }
 */function wrapperChain(){return chain(this);}/**
 * This method is the wrapper version of `_.reverse`.
 *
 * **Note:** This method mutates the wrapped array.
 *
 * @name reverse
 * @memberOf _
 * @since 0.1.0
 * @category Seq
 * @returns {Object} Returns the new `lodash` wrapper instance.
 * @example
 *
 * var array = [1, 2, 3];
 *
 * _(array).reverse().value()
 * // => [3, 2, 1]
 *
 * console.log(array);
 * // => [3, 2, 1]
 */function wrapperReverse(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;if(this.__actions__.length){wrapped=new LazyWrapper(this);}wrapped=wrapped.reverse();wrapped.__actions__.push({'func':thru,'args':[reverse],'thisArg':undefined});return new LodashWrapper(wrapped,this.__chain__);}return this.thru(reverse);}/**
 * The base implementation of methods like `_.xor`, without support for
 * iteratee shorthands, that accepts an array of arrays to inspect.
 *
 * @private
 * @param {Array} arrays The arrays to inspect.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of values.
 */function baseXor(arrays,iteratee,comparator){var length=arrays.length;if(length<2){return length?baseUniq(arrays[0]):[];}var index=-1,result=Array(length);while(++index<length){var array=arrays[index],othIndex=-1;while(++othIndex<length){if(othIndex!=index){result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator);}}}return baseUniq(baseFlatten(result,1),iteratee,comparator);}/**
 * Creates an array of unique values that is the
 * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)
 * of the given arrays. The order of result values is determined by the order
 * they occur in the arrays.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @returns {Array} Returns the new array of filtered values.
 * @see _.difference, _.without
 * @example
 *
 * _.xor([2, 1], [2, 3]);
 * // => [1, 3]
 */var xor=baseRest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject));});/**
 * This method is like `_.xor` except that it accepts `iteratee` which is
 * invoked for each element of each `arrays` to generate the criterion by
 * which by which they're compared. The order of result values is determined
 * by the order they occur in the arrays. The iteratee is invoked with one
 * argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 * @example
 *
 * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);
 * // => [1.2, 3.4]
 *
 * // The `_.property` iteratee shorthand.
 * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
 * // => [{ 'x': 2 }]
 */var xorBy=baseRest(function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined;}return baseXor(arrayFilter(arrays,isArrayLikeObject),baseIteratee(iteratee));});/**
 * This method is like `_.xor` except that it accepts `comparator` which is
 * invoked to compare elements of `arrays`. The order of result values is
 * determined by the order they occur in the arrays. The comparator is invoked
 * with two arguments: (arrVal, othVal).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {...Array} [arrays] The arrays to inspect.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 * @example
 *
 * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
 * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
 *
 * _.xorWith(objects, others, _.isEqual);
 * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]
 */var xorWith=baseRest(function(arrays){var comparator=last(arrays);comparator=typeof comparator=='function'?comparator:undefined;return baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator);});/**
 * Creates an array of grouped elements, the first of which contains the
 * first elements of the given arrays, the second of which contains the
 * second elements of the given arrays, and so on.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {...Array} [arrays] The arrays to process.
 * @returns {Array} Returns the new array of grouped elements.
 * @example
 *
 * _.zip(['a', 'b'], [1, 2], [true, false]);
 * // => [['a', 1, true], ['b', 2, false]]
 */var zip=baseRest(unzip);/**
 * This base implementation of `_.zipObject` which assigns values using `assignFunc`.
 *
 * @private
 * @param {Array} props The property identifiers.
 * @param {Array} values The property values.
 * @param {Function} assignFunc The function to assign values.
 * @returns {Object} Returns the new object.
 */function baseZipObject(props,values,assignFunc){var index=-1,length=props.length,valsLength=values.length,result={};while(++index<length){var value=index<valsLength?values[index]:undefined;assignFunc(result,props[index],value);}return result;}/**
 * This method is like `_.fromPairs` except that it accepts two arrays,
 * one of property identifiers and one of corresponding values.
 *
 * @static
 * @memberOf _
 * @since 0.4.0
 * @category Array
 * @param {Array} [props=[]] The property identifiers.
 * @param {Array} [values=[]] The property values.
 * @returns {Object} Returns the new object.
 * @example
 *
 * _.zipObject(['a', 'b'], [1, 2]);
 * // => { 'a': 1, 'b': 2 }
 */function zipObject(props,values){return baseZipObject(props||[],values||[],assignValue);}/**
 * This method is like `_.zipObject` except that it supports property paths.
 *
 * @static
 * @memberOf _
 * @since 4.1.0
 * @category Array
 * @param {Array} [props=[]] The property identifiers.
 * @param {Array} [values=[]] The property values.
 * @returns {Object} Returns the new object.
 * @example
 *
 * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);
 * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }
 */function zipObjectDeep(props,values){return baseZipObject(props||[],values||[],baseSet);}/**
 * This method is like `_.zip` except that it accepts `iteratee` to specify
 * how grouped values should be combined. The iteratee is invoked with the
 * elements of each group: (...group).
 *
 * @static
 * @memberOf _
 * @since 3.8.0
 * @category Array
 * @param {...Array} [arrays] The arrays to process.
 * @param {Function} [iteratee=_.identity] The function to combine
 *  grouped values.
 * @returns {Array} Returns the new array of grouped elements.
 * @example
 *
 * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {
 *   return a + b + c;
 * });
 * // => [111, 222]
 */var zipWith=baseRest(function(arrays){var length=arrays.length,iteratee=length>1?arrays[length-1]:undefined;iteratee=typeof iteratee=='function'?(arrays.pop(),iteratee):undefined;return unzipWith(arrays,iteratee);});var array={chunk:chunk,compact:compact,concat:concat,difference:difference,differenceBy:differenceBy,differenceWith:differenceWith,drop:drop,dropRight:dropRight,dropRightWhile:dropRightWhile,dropWhile:dropWhile,fill:fill,findIndex:findIndex,findLastIndex:findLastIndex,first:head,flatten:flatten$1,flattenDeep:flattenDeep,flattenDepth:flattenDepth,fromPairs:fromPairs,head:head,indexOf:indexOf,initial:initial,intersection:intersection,intersectionBy:intersectionBy,intersectionWith:intersectionWith,join:join,last:last,lastIndexOf:lastIndexOf,nth:nth,pull:pull,pullAll:pullAll,pullAllBy:pullAllBy,pullAllWith:pullAllWith,pullAt:pullAt,remove:remove$1,reverse:reverse,slice:slice,sortedIndex:sortedIndex,sortedIndexBy:sortedIndexBy,sortedIndexOf:sortedIndexOf,sortedLastIndex:sortedLastIndex,sortedLastIndexBy:sortedLastIndexBy,sortedLastIndexOf:sortedLastIndexOf,sortedUniq:sortedUniq,sortedUniqBy:sortedUniqBy,tail:tail,take:take,takeRight:takeRight,takeRightWhile:takeRightWhile,takeWhile:takeWhile,union:union,unionBy:unionBy,unionWith:unionWith,uniq:uniq,uniqBy:uniqBy,uniqWith:uniqWith,unzip:unzip,unzipWith:unzipWith,without:without,xor:xor,xorBy:xorBy,xorWith:xorWith,zip:zip,zipObject:zipObject,zipObjectDeep:zipObjectDeep,zipWith:zipWith};var collection={countBy:countBy,each:forEach,eachRight:forEachRight,every:every,filter:filter,find:find$1,findLast:findLast,flatMap:flatMap,flatMapDeep:flatMapDeep,flatMapDepth:flatMapDepth,forEach:forEach,forEachRight:forEachRight,groupBy:groupBy,includes:includes,invokeMap:invokeMap,keyBy:keyBy,map:map,orderBy:orderBy,partition:partition,reduce:reduce,reduceRight:reduceRight,reject:reject,sample:sample,sampleSize:sampleSize,shuffle:shuffle,size:size,some:some,sortBy:sortBy};var date={now:now};var func={after:after,ary:ary,before:before,bind:bind,bindKey:bindKey,curry:curry,curryRight:curryRight,debounce:debounce$1,defer:defer,delay:delay,flip:flip,memoize:memoize,negate:negate,once:once,overArgs:overArgs,partial:partial,partialRight:partialRight,rearg:rearg,rest:rest,spread:spread,throttle:throttle,unary:unary,wrap:wrap};var lang={castArray:castArray,clone:clone,cloneDeep:cloneDeep,cloneDeepWith:cloneDeepWith,cloneWith:cloneWith,conformsTo:conformsTo,eq:eq,gt:gt,gte:gte,isArguments:isArguments,isArray:isArray,isArrayBuffer:isArrayBuffer,isArrayLike:isArrayLike,isArrayLikeObject:isArrayLikeObject,isBoolean:isBoolean,isBuffer:isBuffer,isDate:isDate,isElement:isElement,isEmpty:isEmpty,isEqual:isEqual$1,isEqualWith:isEqualWith,isError:isError,isFinite:isFinite$1,isFunction:isFunction,isInteger:isInteger,isLength:isLength,isMap:isMap,isMatch:isMatch,isMatchWith:isMatchWith,isNaN:isNaN$1,isNative:isNative,isNil:isNil,isNull:isNull,isNumber:isNumber,isObject:isObject,isObjectLike:isObjectLike,isPlainObject:isPlainObject,isRegExp:isRegExp,isSafeInteger:isSafeInteger,isSet:isSet,isString:isString,isSymbol:isSymbol,isTypedArray:isTypedArray,isUndefined:isUndefined,isWeakMap:isWeakMap,isWeakSet:isWeakSet,lt:lt,lte:lte,toArray:toArray,toFinite:toFinite,toInteger:toInteger,toLength:toLength,toNumber:toNumber,toPlainObject:toPlainObject,toSafeInteger:toSafeInteger,toString:toString};var math={add:add$1,ceil:ceil,divide:divide,floor:floor,max:max,maxBy:maxBy,mean:mean,meanBy:meanBy,min:min,minBy:minBy,multiply:multiply,round:round,subtract:subtract,sum:sum,sumBy:sumBy};var number$1={clamp:clamp,inRange:inRange,random:random};var object={assign:assign,assignIn:assignIn,assignInWith:assignInWith,assignWith:assignWith,at:at,create:create,defaults:defaults$2,defaultsDeep:defaultsDeep,entries:toPairs,entriesIn:toPairsIn,extend:assignIn,extendWith:assignInWith,findKey:findKey,findLastKey:findLastKey,forIn:forIn,forInRight:forInRight,forOwn:forOwn,forOwnRight:forOwnRight,functions:functions,functionsIn:functionsIn,get:get,has:has,hasIn:hasIn,invert:invert,invertBy:invertBy,invoke:invoke,keys:keys$1,keysIn:keysIn,mapKeys:mapKeys,mapValues:mapValues,merge:merge,mergeWith:mergeWith,omit:omit,omitBy:omitBy,pick:pick,pickBy:pickBy,result:result,set:set,setWith:setWith,toPairs:toPairs,toPairsIn:toPairsIn,transform:transform,unset:unset,update:update,updateWith:updateWith,values:values,valuesIn:valuesIn};var seq={at:wrapperAt,chain:chain,commit:wrapperCommit,lodash:lodash,next:wrapperNext,plant:wrapperPlant,reverse:wrapperReverse,tap:tap,thru:thru,toIterator:wrapperToIterator,toJSON:wrapperValue,value:wrapperValue,valueOf:wrapperValue,wrapperChain:wrapperChain};var string$1={camelCase:camelCase,capitalize:capitalize,deburr:deburr,endsWith:endsWith,escape:escape,escapeRegExp:escapeRegExp,kebabCase:kebabCase,lowerCase:lowerCase,lowerFirst:lowerFirst,pad:pad,padEnd:padEnd,padStart:padStart,parseInt:parseInt$1,repeat:repeat,replace:replace$1,snakeCase:snakeCase,split:split,startCase:startCase,startsWith:startsWith,template:template,templateSettings:templateSettings,toLower:toLower,toUpper:toUpper,trim:trim,trimEnd:trimEnd,trimStart:trimStart,truncate:truncate$1,unescape:unescape,upperCase:upperCase,upperFirst:upperFirst,words:words};var util={attempt:attempt,bindAll:bindAll,cond:cond,conforms:conforms,constant:constant,defaultTo:defaultTo,flow:flow,flowRight:flowRight,identity:identity,iteratee:iteratee,matches:matches,matchesProperty:matchesProperty,method:method,methodOf:methodOf,mixin:mixin$1,noop:noop,nthArg:nthArg,over:over,overEvery:overEvery,overSome:overSome,property:property,propertyOf:propertyOf,range:range,rangeRight:rangeRight,stubArray:stubArray,stubFalse:stubFalse,stubObject:stubObject,stubString:stubString,stubTrue:stubTrue,times:times,toPath:toPath,uniqueId:uniqueId};/**
 * Creates a clone of the lazy wrapper object.
 *
 * @private
 * @name clone
 * @memberOf LazyWrapper
 * @returns {Object} Returns the cloned `LazyWrapper` object.
 */function lazyClone(){var result=new LazyWrapper(this.__wrapped__);result.__actions__=copyArray(this.__actions__);result.__dir__=this.__dir__;result.__filtered__=this.__filtered__;result.__iteratees__=copyArray(this.__iteratees__);result.__takeCount__=this.__takeCount__;result.__views__=copyArray(this.__views__);return result;}/**
 * Reverses the direction of lazy iteration.
 *
 * @private
 * @name reverse
 * @memberOf LazyWrapper
 * @returns {Object} Returns the new reversed `LazyWrapper` object.
 */function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1;result.__filtered__=true;}else{result=this.clone();result.__dir__*=-1;}return result;}/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax$1=Math.max,nativeMin$2=Math.min;/**
 * Gets the view, applying any `transforms` to the `start` and `end` positions.
 *
 * @private
 * @param {number} start The start of the view.
 * @param {number} end The end of the view.
 * @param {Array} transforms The transformations to apply to the view.
 * @returns {Object} Returns an object containing the `start` and `end`
 *  positions of the view.
 */function getView(start,end,transforms){var index=-1,length=transforms.length;while(++index<length){var data=transforms[index],size=data.size;switch(data.type){case'drop':start+=size;break;case'dropRight':end-=size;break;case'take':end=nativeMin$2(end,start+size);break;case'takeRight':start=nativeMax$1(start,end-size);break;}}return{'start':start,'end':end};}/** Used to indicate the type of lazy iteratees. */var LAZY_FILTER_FLAG$1=1,LAZY_MAP_FLAG=2;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMin$1=Math.min;/**
 * Extracts the unwrapped value from its lazy wrapper.
 *
 * @private
 * @name value
 * @memberOf LazyWrapper
 * @returns {*} Returns the unwrapped value.
 */function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin$1(length,this.__takeCount__);if(!isArr||!isRight&&arrLength==length&&takeCount==length){return baseWrapperValue(array,this.__actions__);}var result=[];outer:while(length--&&resIndex<takeCount){index+=dir;var iterIndex=-1,value=array[index];while(++iterIndex<iterLength){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG){value=computed;}else if(!computed){if(type==LAZY_FILTER_FLAG$1){continue outer;}else{break outer;}}}result[resIndex++]=value;}return result;}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */ /** Used as the semantic version number. */var VERSION='4.17.21';/** Used to compose bitmasks for function metadata. */var WRAP_BIND_KEY_FLAG=2;/** Used to indicate the type of lazy iteratees. */var LAZY_FILTER_FLAG=1,LAZY_WHILE_FLAG=3;/** Used as references for the maximum length and index of an array. */var MAX_ARRAY_LENGTH=4294967295;/** Used for built-in method references. */var arrayProto=Array.prototype,objectProto=Object.prototype;/** Used to check objects for own properties. */var hasOwnProperty$1=objectProto.hasOwnProperty;/** Built-in value references. */var symIterator=Symbol$1?Symbol$1.iterator:undefined;/* Built-in method references for those with the same name as other `lodash` methods. */var nativeMax=Math.max,nativeMin=Math.min;// wrap `_.mixin` so it works when provided only one argument
var mixin=function(func){return function(object,source,options){if(options==null){var isObj=isObject(source),props=isObj&&keys$1(source),methodNames=props&&props.length&&baseFunctions(source,props);if(!(methodNames?methodNames.length:isObj)){options=source;source=object;object=this;}}return func(object,source,options);};}(mixin$1);// Add methods that return wrapped values in chain sequences.
lodash.after=func.after;lodash.ary=func.ary;lodash.assign=object.assign;lodash.assignIn=object.assignIn;lodash.assignInWith=object.assignInWith;lodash.assignWith=object.assignWith;lodash.at=object.at;lodash.before=func.before;lodash.bind=func.bind;lodash.bindAll=util.bindAll;lodash.bindKey=func.bindKey;lodash.castArray=lang.castArray;lodash.chain=seq.chain;lodash.chunk=array.chunk;lodash.compact=array.compact;lodash.concat=array.concat;lodash.cond=util.cond;lodash.conforms=util.conforms;lodash.constant=util.constant;lodash.countBy=collection.countBy;lodash.create=object.create;lodash.curry=func.curry;lodash.curryRight=func.curryRight;lodash.debounce=func.debounce;lodash.defaults=object.defaults;lodash.defaultsDeep=object.defaultsDeep;lodash.defer=func.defer;lodash.delay=func.delay;lodash.difference=array.difference;lodash.differenceBy=array.differenceBy;lodash.differenceWith=array.differenceWith;lodash.drop=array.drop;lodash.dropRight=array.dropRight;lodash.dropRightWhile=array.dropRightWhile;lodash.dropWhile=array.dropWhile;lodash.fill=array.fill;lodash.filter=collection.filter;lodash.flatMap=collection.flatMap;lodash.flatMapDeep=collection.flatMapDeep;lodash.flatMapDepth=collection.flatMapDepth;lodash.flatten=array.flatten;lodash.flattenDeep=array.flattenDeep;lodash.flattenDepth=array.flattenDepth;lodash.flip=func.flip;lodash.flow=util.flow;lodash.flowRight=util.flowRight;lodash.fromPairs=array.fromPairs;lodash.functions=object.functions;lodash.functionsIn=object.functionsIn;lodash.groupBy=collection.groupBy;lodash.initial=array.initial;lodash.intersection=array.intersection;lodash.intersectionBy=array.intersectionBy;lodash.intersectionWith=array.intersectionWith;lodash.invert=object.invert;lodash.invertBy=object.invertBy;lodash.invokeMap=collection.invokeMap;lodash.iteratee=util.iteratee;lodash.keyBy=collection.keyBy;lodash.keys=keys$1;lodash.keysIn=object.keysIn;lodash.map=collection.map;lodash.mapKeys=object.mapKeys;lodash.mapValues=object.mapValues;lodash.matches=util.matches;lodash.matchesProperty=util.matchesProperty;lodash.memoize=func.memoize;lodash.merge=object.merge;lodash.mergeWith=object.mergeWith;lodash.method=util.method;lodash.methodOf=util.methodOf;lodash.mixin=mixin;lodash.negate=negate;lodash.nthArg=util.nthArg;lodash.omit=object.omit;lodash.omitBy=object.omitBy;lodash.once=func.once;lodash.orderBy=collection.orderBy;lodash.over=util.over;lodash.overArgs=func.overArgs;lodash.overEvery=util.overEvery;lodash.overSome=util.overSome;lodash.partial=func.partial;lodash.partialRight=func.partialRight;lodash.partition=collection.partition;lodash.pick=object.pick;lodash.pickBy=object.pickBy;lodash.property=util.property;lodash.propertyOf=util.propertyOf;lodash.pull=array.pull;lodash.pullAll=array.pullAll;lodash.pullAllBy=array.pullAllBy;lodash.pullAllWith=array.pullAllWith;lodash.pullAt=array.pullAt;lodash.range=util.range;lodash.rangeRight=util.rangeRight;lodash.rearg=func.rearg;lodash.reject=collection.reject;lodash.remove=array.remove;lodash.rest=func.rest;lodash.reverse=array.reverse;lodash.sampleSize=collection.sampleSize;lodash.set=object.set;lodash.setWith=object.setWith;lodash.shuffle=collection.shuffle;lodash.slice=array.slice;lodash.sortBy=collection.sortBy;lodash.sortedUniq=array.sortedUniq;lodash.sortedUniqBy=array.sortedUniqBy;lodash.split=string$1.split;lodash.spread=func.spread;lodash.tail=array.tail;lodash.take=array.take;lodash.takeRight=array.takeRight;lodash.takeRightWhile=array.takeRightWhile;lodash.takeWhile=array.takeWhile;lodash.tap=seq.tap;lodash.throttle=func.throttle;lodash.thru=thru;lodash.toArray=lang.toArray;lodash.toPairs=object.toPairs;lodash.toPairsIn=object.toPairsIn;lodash.toPath=util.toPath;lodash.toPlainObject=lang.toPlainObject;lodash.transform=object.transform;lodash.unary=func.unary;lodash.union=array.union;lodash.unionBy=array.unionBy;lodash.unionWith=array.unionWith;lodash.uniq=array.uniq;lodash.uniqBy=array.uniqBy;lodash.uniqWith=array.uniqWith;lodash.unset=object.unset;lodash.unzip=array.unzip;lodash.unzipWith=array.unzipWith;lodash.update=object.update;lodash.updateWith=object.updateWith;lodash.values=object.values;lodash.valuesIn=object.valuesIn;lodash.without=array.without;lodash.words=string$1.words;lodash.wrap=func.wrap;lodash.xor=array.xor;lodash.xorBy=array.xorBy;lodash.xorWith=array.xorWith;lodash.zip=array.zip;lodash.zipObject=array.zipObject;lodash.zipObjectDeep=array.zipObjectDeep;lodash.zipWith=array.zipWith;// Add aliases.
lodash.entries=object.toPairs;lodash.entriesIn=object.toPairsIn;lodash.extend=object.assignIn;lodash.extendWith=object.assignInWith;// Add methods to `lodash.prototype`.
mixin(lodash,lodash);// Add methods that return unwrapped values in chain sequences.
lodash.add=math.add;lodash.attempt=util.attempt;lodash.camelCase=string$1.camelCase;lodash.capitalize=string$1.capitalize;lodash.ceil=math.ceil;lodash.clamp=number$1.clamp;lodash.clone=lang.clone;lodash.cloneDeep=lang.cloneDeep;lodash.cloneDeepWith=lang.cloneDeepWith;lodash.cloneWith=lang.cloneWith;lodash.conformsTo=lang.conformsTo;lodash.deburr=string$1.deburr;lodash.defaultTo=util.defaultTo;lodash.divide=math.divide;lodash.endsWith=string$1.endsWith;lodash.eq=lang.eq;lodash.escape=string$1.escape;lodash.escapeRegExp=string$1.escapeRegExp;lodash.every=collection.every;lodash.find=collection.find;lodash.findIndex=array.findIndex;lodash.findKey=object.findKey;lodash.findLast=collection.findLast;lodash.findLastIndex=array.findLastIndex;lodash.findLastKey=object.findLastKey;lodash.floor=math.floor;lodash.forEach=collection.forEach;lodash.forEachRight=collection.forEachRight;lodash.forIn=object.forIn;lodash.forInRight=object.forInRight;lodash.forOwn=object.forOwn;lodash.forOwnRight=object.forOwnRight;lodash.get=object.get;lodash.gt=lang.gt;lodash.gte=lang.gte;lodash.has=object.has;lodash.hasIn=object.hasIn;lodash.head=array.head;lodash.identity=identity;lodash.includes=collection.includes;lodash.indexOf=array.indexOf;lodash.inRange=number$1.inRange;lodash.invoke=object.invoke;lodash.isArguments=lang.isArguments;lodash.isArray=isArray;lodash.isArrayBuffer=lang.isArrayBuffer;lodash.isArrayLike=lang.isArrayLike;lodash.isArrayLikeObject=lang.isArrayLikeObject;lodash.isBoolean=lang.isBoolean;lodash.isBuffer=lang.isBuffer;lodash.isDate=lang.isDate;lodash.isElement=lang.isElement;lodash.isEmpty=lang.isEmpty;lodash.isEqual=lang.isEqual;lodash.isEqualWith=lang.isEqualWith;lodash.isError=lang.isError;lodash.isFinite=lang.isFinite;lodash.isFunction=lang.isFunction;lodash.isInteger=lang.isInteger;lodash.isLength=lang.isLength;lodash.isMap=lang.isMap;lodash.isMatch=lang.isMatch;lodash.isMatchWith=lang.isMatchWith;lodash.isNaN=lang.isNaN;lodash.isNative=lang.isNative;lodash.isNil=lang.isNil;lodash.isNull=lang.isNull;lodash.isNumber=lang.isNumber;lodash.isObject=isObject;lodash.isObjectLike=lang.isObjectLike;lodash.isPlainObject=lang.isPlainObject;lodash.isRegExp=lang.isRegExp;lodash.isSafeInteger=lang.isSafeInteger;lodash.isSet=lang.isSet;lodash.isString=lang.isString;lodash.isSymbol=lang.isSymbol;lodash.isTypedArray=lang.isTypedArray;lodash.isUndefined=lang.isUndefined;lodash.isWeakMap=lang.isWeakMap;lodash.isWeakSet=lang.isWeakSet;lodash.join=array.join;lodash.kebabCase=string$1.kebabCase;lodash.last=last;lodash.lastIndexOf=array.lastIndexOf;lodash.lowerCase=string$1.lowerCase;lodash.lowerFirst=string$1.lowerFirst;lodash.lt=lang.lt;lodash.lte=lang.lte;lodash.max=math.max;lodash.maxBy=math.maxBy;lodash.mean=math.mean;lodash.meanBy=math.meanBy;lodash.min=math.min;lodash.minBy=math.minBy;lodash.stubArray=util.stubArray;lodash.stubFalse=util.stubFalse;lodash.stubObject=util.stubObject;lodash.stubString=util.stubString;lodash.stubTrue=util.stubTrue;lodash.multiply=math.multiply;lodash.nth=array.nth;lodash.noop=util.noop;lodash.now=date.now;lodash.pad=string$1.pad;lodash.padEnd=string$1.padEnd;lodash.padStart=string$1.padStart;lodash.parseInt=string$1.parseInt;lodash.random=number$1.random;lodash.reduce=collection.reduce;lodash.reduceRight=collection.reduceRight;lodash.repeat=string$1.repeat;lodash.replace=string$1.replace;lodash.result=object.result;lodash.round=math.round;lodash.sample=collection.sample;lodash.size=collection.size;lodash.snakeCase=string$1.snakeCase;lodash.some=collection.some;lodash.sortedIndex=array.sortedIndex;lodash.sortedIndexBy=array.sortedIndexBy;lodash.sortedIndexOf=array.sortedIndexOf;lodash.sortedLastIndex=array.sortedLastIndex;lodash.sortedLastIndexBy=array.sortedLastIndexBy;lodash.sortedLastIndexOf=array.sortedLastIndexOf;lodash.startCase=string$1.startCase;lodash.startsWith=string$1.startsWith;lodash.subtract=math.subtract;lodash.sum=math.sum;lodash.sumBy=math.sumBy;lodash.template=string$1.template;lodash.times=util.times;lodash.toFinite=lang.toFinite;lodash.toInteger=toInteger;lodash.toLength=lang.toLength;lodash.toLower=string$1.toLower;lodash.toNumber=lang.toNumber;lodash.toSafeInteger=lang.toSafeInteger;lodash.toString=lang.toString;lodash.toUpper=string$1.toUpper;lodash.trim=string$1.trim;lodash.trimEnd=string$1.trimEnd;lodash.trimStart=string$1.trimStart;lodash.truncate=string$1.truncate;lodash.unescape=string$1.unescape;lodash.uniqueId=util.uniqueId;lodash.upperCase=string$1.upperCase;lodash.upperFirst=string$1.upperFirst;// Add aliases.
lodash.each=collection.forEach;lodash.eachRight=collection.forEachRight;lodash.first=array.head;mixin(lodash,function(){var source={};baseForOwn(lodash,function(func,methodName){if(!hasOwnProperty$1.call(lodash.prototype,methodName)){source[methodName]=func;}});return source;}(),{'chain':false});/**
 * The semantic version number.
 *
 * @static
 * @memberOf _
 * @type {string}
 */lodash.VERSION=VERSION;(lodash.templateSettings=string$1.templateSettings).imports._=lodash;// Assign default placeholders.
arrayEach(['bind','bindKey','curry','curryRight','partial','partialRight'],function(methodName){lodash[methodName].placeholder=lodash;});// Add `LazyWrapper` methods for `_.drop` and `_.take` variants.
arrayEach(['drop','take'],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){n=n===undefined?1:nativeMax(toInteger(n),0);var result=this.__filtered__&&!index?new LazyWrapper(this):this.clone();if(result.__filtered__){result.__takeCount__=nativeMin(n,result.__takeCount__);}else{result.__views__.push({'size':nativeMin(n,MAX_ARRAY_LENGTH),'type':methodName+(result.__dir__<0?'Right':'')});}return result;};LazyWrapper.prototype[methodName+'Right']=function(n){return this.reverse()[methodName](n).reverse();};});// Add `LazyWrapper` methods that accept an `iteratee` value.
arrayEach(['filter','map','takeWhile'],function(methodName,index){var type=index+1,isFilter=type==LAZY_FILTER_FLAG||type==LAZY_WHILE_FLAG;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();result.__iteratees__.push({'iteratee':baseIteratee(iteratee),'type':type});result.__filtered__=result.__filtered__||isFilter;return result;};});// Add `LazyWrapper` methods for `_.head` and `_.last`.
arrayEach(['head','last'],function(methodName,index){var takeName='take'+(index?'Right':'');LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0];};});// Add `LazyWrapper` methods for `_.initial` and `_.tail`.
arrayEach(['initial','tail'],function(methodName,index){var dropName='drop'+(index?'':'Right');LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1);};});LazyWrapper.prototype.compact=function(){return this.filter(identity);};LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head();};LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate);};LazyWrapper.prototype.invokeMap=baseRest(function(path,args){if(typeof path=='function'){return new LazyWrapper(this);}return this.map(function(value){return baseInvoke(value,path,args);});});LazyWrapper.prototype.reject=function(predicate){return this.filter(negate(baseIteratee(predicate)));};LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;if(result.__filtered__&&(start>0||end<0)){return new LazyWrapper(result);}if(start<0){result=result.takeRight(-start);}else if(start){result=result.drop(start);}if(end!==undefined){end=toInteger(end);result=end<0?result.dropRight(-end):result.take(end-start);}return result;};LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse();};LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH);};// Add `LazyWrapper` methods to `lodash.prototype`.
baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?'take'+(methodName=='last'?'Right':''):methodName],retUnwrapped=isTaker||/^find/.test(methodName);if(!lodashFunc){return;}lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);var interceptor=function interceptor(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker&&chainAll?result[0]:result;};if(useLazy&&checkIteratee&&typeof iteratee=='function'&&iteratee.length!=1){// Avoid lazy use if the iteratee has a "length" value other than `1`.
isLazy=useLazy=false;}var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,onlyLazy=isLazy&&!isHybrid;if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);result.__actions__.push({'func':thru,'args':[interceptor],'thisArg':undefined});return new LodashWrapper(result,chainAll);}if(isUnwrapped&&onlyLazy){return func.apply(this,args);}result=this.thru(interceptor);return isUnwrapped?isTaker?result.value()[0]:result.value():result;};});// Add `Array` methods to `lodash.prototype`.
arrayEach(['pop','push','shift','sort','splice','unshift'],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?'tap':'thru',retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;if(retUnwrapped&&!this.__chain__){var value=this.value();return func.apply(isArray(value)?value:[],args);}return this[chainName](function(value){return func.apply(isArray(value)?value:[],args);});};});// Map minified method names to their real names.
baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+'';if(!hasOwnProperty$1.call(realNames,key)){realNames[key]=[];}realNames[key].push({'name':methodName,'func':lodashFunc});}});realNames[createHybrid(undefined,WRAP_BIND_KEY_FLAG).name]=[{'name':'wrapper','func':undefined}];// Add methods to `LazyWrapper`.
LazyWrapper.prototype.clone=lazyClone;LazyWrapper.prototype.reverse=lazyReverse;LazyWrapper.prototype.value=lazyValue;// Add chain sequence methods to the `lodash` wrapper.
lodash.prototype.at=seq.at;lodash.prototype.chain=seq.wrapperChain;lodash.prototype.commit=seq.commit;lodash.prototype.next=seq.next;lodash.prototype.plant=seq.plant;lodash.prototype.reverse=seq.reverse;lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=seq.value;// Add lazy aliases.
lodash.prototype.first=lodash.prototype.head;if(symIterator){lodash.prototype[symIterator]=seq.toIterator;}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var _=/*#__PURE__*/Object.freeze({__proto__:null,add:add$1,after:after,ary:ary,assign:assign,assignIn:assignIn,assignInWith:assignInWith,assignWith:assignWith,at:at,attempt:attempt,before:before,bind:bind,bindAll:bindAll,bindKey:bindKey,camelCase:camelCase,capitalize:capitalize,castArray:castArray,ceil:ceil,chain:chain,chunk:chunk,clamp:clamp,clone:clone,cloneDeep:cloneDeep,cloneDeepWith:cloneDeepWith,cloneWith:cloneWith,commit:wrapperCommit,compact:compact,concat:concat,cond:cond,conforms:conforms,conformsTo:conformsTo,constant:constant,countBy:countBy,create:create,curry:curry,curryRight:curryRight,debounce:debounce$1,deburr:deburr,defaultTo:defaultTo,defaults:defaults$2,defaultsDeep:defaultsDeep,defer:defer,delay:delay,difference:difference,differenceBy:differenceBy,differenceWith:differenceWith,divide:divide,drop:drop,dropRight:dropRight,dropRightWhile:dropRightWhile,dropWhile:dropWhile,each:forEach,eachRight:forEachRight,endsWith:endsWith,entries:toPairs,entriesIn:toPairsIn,eq:eq,escape:escape,escapeRegExp:escapeRegExp,every:every,extend:assignIn,extendWith:assignInWith,fill:fill,filter:filter,find:find$1,findIndex:findIndex,findKey:findKey,findLast:findLast,findLastIndex:findLastIndex,findLastKey:findLastKey,first:head,flatMap:flatMap,flatMapDeep:flatMapDeep,flatMapDepth:flatMapDepth,flatten:flatten$1,flattenDeep:flattenDeep,flattenDepth:flattenDepth,flip:flip,floor:floor,flow:flow,flowRight:flowRight,forEach:forEach,forEachRight:forEachRight,forIn:forIn,forInRight:forInRight,forOwn:forOwn,forOwnRight:forOwnRight,fromPairs:fromPairs,functions:functions,functionsIn:functionsIn,get:get,groupBy:groupBy,gt:gt,gte:gte,has:has,hasIn:hasIn,head:head,identity:identity,inRange:inRange,includes:includes,indexOf:indexOf,initial:initial,intersection:intersection,intersectionBy:intersectionBy,intersectionWith:intersectionWith,invert:invert,invertBy:invertBy,invoke:invoke,invokeMap:invokeMap,isArguments:isArguments,isArray:isArray,isArrayBuffer:isArrayBuffer,isArrayLike:isArrayLike,isArrayLikeObject:isArrayLikeObject,isBoolean:isBoolean,isBuffer:isBuffer,isDate:isDate,isElement:isElement,isEmpty:isEmpty,isEqual:isEqual$1,isEqualWith:isEqualWith,isError:isError,isFinite:isFinite$1,isFunction:isFunction,isInteger:isInteger,isLength:isLength,isMap:isMap,isMatch:isMatch,isMatchWith:isMatchWith,isNaN:isNaN$1,isNative:isNative,isNil:isNil,isNull:isNull,isNumber:isNumber,isObject:isObject,isObjectLike:isObjectLike,isPlainObject:isPlainObject,isRegExp:isRegExp,isSafeInteger:isSafeInteger,isSet:isSet,isString:isString,isSymbol:isSymbol,isTypedArray:isTypedArray,isUndefined:isUndefined,isWeakMap:isWeakMap,isWeakSet:isWeakSet,iteratee:iteratee,join:join,kebabCase:kebabCase,keyBy:keyBy,keys:keys$1,keysIn:keysIn,last:last,lastIndexOf:lastIndexOf,lodash:lodash,lowerCase:lowerCase,lowerFirst:lowerFirst,lt:lt,lte:lte,map:map,mapKeys:mapKeys,mapValues:mapValues,matches:matches,matchesProperty:matchesProperty,max:max,maxBy:maxBy,mean:mean,meanBy:meanBy,memoize:memoize,merge:merge,mergeWith:mergeWith,method:method,methodOf:methodOf,min:min,minBy:minBy,mixin:mixin$1,multiply:multiply,negate:negate,next:wrapperNext,noop:noop,now:now,nth:nth,nthArg:nthArg,omit:omit,omitBy:omitBy,once:once,orderBy:orderBy,over:over,overArgs:overArgs,overEvery:overEvery,overSome:overSome,pad:pad,padEnd:padEnd,padStart:padStart,parseInt:parseInt$1,partial:partial,partialRight:partialRight,partition:partition,pick:pick,pickBy:pickBy,plant:wrapperPlant,property:property,propertyOf:propertyOf,pull:pull,pullAll:pullAll,pullAllBy:pullAllBy,pullAllWith:pullAllWith,pullAt:pullAt,random:random,range:range,rangeRight:rangeRight,rearg:rearg,reduce:reduce,reduceRight:reduceRight,reject:reject,remove:remove$1,repeat:repeat,replace:replace$1,rest:rest,result:result,reverse:reverse,round:round,sample:sample,sampleSize:sampleSize,set:set,setWith:setWith,shuffle:shuffle,size:size,slice:slice,snakeCase:snakeCase,some:some,sortBy:sortBy,sortedIndex:sortedIndex,sortedIndexBy:sortedIndexBy,sortedIndexOf:sortedIndexOf,sortedLastIndex:sortedLastIndex,sortedLastIndexBy:sortedLastIndexBy,sortedLastIndexOf:sortedLastIndexOf,sortedUniq:sortedUniq,sortedUniqBy:sortedUniqBy,split:split,spread:spread,startCase:startCase,startsWith:startsWith,stubArray:stubArray,stubFalse:stubFalse,stubObject:stubObject,stubString:stubString,stubTrue:stubTrue,subtract:subtract,sum:sum,sumBy:sumBy,tail:tail,take:take,takeRight:takeRight,takeRightWhile:takeRightWhile,takeWhile:takeWhile,tap:tap,template:template,templateSettings:templateSettings,throttle:throttle,thru:thru,times:times,toArray:toArray,toFinite:toFinite,toInteger:toInteger,toIterator:wrapperToIterator,toJSON:wrapperValue,toLength:toLength,toLower:toLower,toNumber:toNumber,toPairs:toPairs,toPairsIn:toPairsIn,toPath:toPath,toPlainObject:toPlainObject,toSafeInteger:toSafeInteger,toString:toString,toUpper:toUpper,transform:transform,trim:trim,trimEnd:trimEnd,trimStart:trimStart,truncate:truncate$1,unary:unary,unescape:unescape,union:union,unionBy:unionBy,unionWith:unionWith,uniq:uniq,uniqBy:uniqBy,uniqWith:uniqWith,uniqueId:uniqueId,unset:unset,unzip:unzip,unzipWith:unzipWith,update:update,updateWith:updateWith,upperCase:upperCase,upperFirst:upperFirst,value:wrapperValue,valueOf:wrapperValue,values:values,valuesIn:valuesIn,without:without,words:words,wrap:wrap,wrapperAt:wrapperAt,wrapperChain:wrapperChain,wrapperCommit:wrapperCommit,wrapperLodash:lodash,wrapperNext:wrapperNext,wrapperPlant:wrapperPlant,wrapperReverse:wrapperReverse,wrapperToIterator:wrapperToIterator,wrapperValue:wrapperValue,xor:xor,xorBy:xorBy,xorWith:xorWith,zip:zip,zipObject:zipObject,zipObjectDeep:zipObjectDeep,zipWith:zipWith,'default':lodash});var MAX_ITEM_PATHS_COLLECTION=10000;var EMPTY_ARRAY=[];/**
 * Get the paths of all nested properties in the items of an array
 * @param {JSONValue} array
 * @param {boolean} [includeObjects=false] If true, object and array paths are returned as well
 * @return {Path[]}
 */function getNestedPaths(array){var includeObjects=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var pointersMap={};if(!Array.isArray(array)){throw new TypeError('Array expected');}function recurseNestedPaths(obj,path){var isValue=!Array.isArray(obj)&&!isObject$1(obj);if(isValue||includeObjects&&path.length>0){pointersMap[immutableJSONPatch.exports.compileJSONPointer(path)]=true;}if(isObject$1(obj)){Object.keys(obj).forEach(function(key){recurseNestedPaths(obj[key],path.concat(key));});}}var max=Math.min(array.length,MAX_ITEM_PATHS_COLLECTION);for(var _i9=0;_i9<max;_i9++){var item=array[_i9];recurseNestedPaths(item,EMPTY_ARRAY);}var pathsArray=Object.keys(pointersMap).sort();return pathsArray.map(immutableJSONPatch.exports.parseJSONPointer);}/**
 * Invoke the callback with
 * @param start   Included start index
 * @param end       Excluded end index. End must be larger or equal to start
 * @param iteratee
 */ // TODO: write tests
function forEachIndex(start,end,iteratee){if(end<=start){return;}for(var index=start;index<end;index++){iteratee(index);}}/**
 * Limit the number of items in an array
 */ // TODO: write unit test
function limit(array,max){return array.length>max?array.slice(0,max):array;}/**
 * Convert an array into an object having the array indices as keys
 */function arrayToObject(array){return _objectSpread2({},array);}/**
 * Get the values of an object as an array
 */function objectToArray(object){return Object.values(object);}/**
 * Move a set of items inside an array
 */function moveItems(array,index,count,offset){// TODO: check boundaries: index+offset >= 0, index+offset+count<array.length, index+count<array.length, etc
var copy=array.slice(0);var moving=copy.splice(index,count);// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
copy.splice.apply(copy,[index+offset,0].concat(_toConsumableArray2(moving)));return copy;}/**
 * Parse the JSON. if this fails, try to repair and parse.
 * Throws an exception when the JSON is invalid and could not be parsed.
 */function parseAndRepair(jsonText,parser){try{return parser.parse(jsonText);}catch(err){// this can also throw
return parser.parse(jsonrepair(jsonText));}}/**
 * Parse the JSON and if needed repair it.
 * When not valid, undefined is returned.
 */function parseAndRepairOrUndefined(partialJson,parser){try{return parseAndRepair(partialJson,parser);}catch(err){return undefined;}}// TODO: deduplicate the logic in repairPartialJson and parseAndRepairPartialJson ?
function parsePartialJson(partialJson,parse){// for now: dumb brute force approach: simply try out a few things...
// remove trailing comma
partialJson=partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX,'');try{return parse(partialJson);}catch(err){// we ignore the error on purpose
}try{return parse('['+partialJson+']');}catch(err){// we ignore the error on purpose
}try{return parse('{'+partialJson+'}');}catch(err){// we ignore the error on purpose
}throw new Error('Failed to parse partial JSON');}/**
 * Repair partial JSON
 */function repairPartialJson(partialJson){// for now: dumb brute force approach: simply try out a few things...
// remove trailing comma
partialJson=partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX,'');try{return jsonrepair(partialJson);}catch(err){// we ignore the error on purpose
}try{var repaired=jsonrepair('['+partialJson+']');return repaired.substring(1,repaired.length-1);// remove the outer [...] again
}catch(err){// we ignore the error on purpose
}try{var _repaired=jsonrepair('{'+partialJson+'}');return _repaired.substring(1,_repaired.length-1);// remove the outer {...} again
}catch(err){// we ignore the error on purpose
}throw new Error('Failed to repair partial JSON');}// test whether a string ends with a comma, followed by zero or more white space characters
var END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX=/,\s*$/;/**
 * Normalize a parse error message like
 *     "Unexpected token i in JSON at position 4"
 * or
 *     "JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data"
 * and return the line and column numbers in an object
 *
 * Note that the returned line and column number in the object are zero-based,
 * and in the message are one based (human-readable)
 */function normalizeJsonParseError(jsonText,parseErrorMessage){var positionMatch=POSITION_REGEX.exec(parseErrorMessage);if(positionMatch){// a message from Chrome, like "Unexpected token i in JSON at line 2 column 3"
var position=_int(positionMatch[2]);var line=countCharacterOccurrences(jsonText,'\n',0,position);var lastIndex=jsonText.lastIndexOf('\n',position);var column=position-lastIndex-1;return{position:position,line:line,column:column,message:parseErrorMessage.replace(POSITION_REGEX,function(){return"line ".concat(line+1," column ").concat(column+1);})};}else{// a message from Firefox, like "JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data"
var lineMatch=LINE_REGEX.exec(parseErrorMessage);var lineOneBased=lineMatch?_int(lineMatch[1]):null;var _line=lineOneBased!==null?lineOneBased-1:null;var columnMatch=COLUMN_REGEX.exec(parseErrorMessage);var columnOneBased=columnMatch?_int(columnMatch[1]):null;var _column=columnOneBased!==null?columnOneBased-1:null;var _position=_line!==null&&_column!==null?calculatePosition(jsonText,_line,_column):null;// line and column are one based in the message
return{position:_position,line:_line,column:_column,message:parseErrorMessage.replace(/^JSON.parse: /,'').replace(/ of the JSON data$/,'')};}}/**
 * Calculate the position in the text based on a line and column number
 * @param text
 * @param line     Zero-based line number
 * @param column   Zero-based column number
 */function calculatePosition(text,line,column){var index=text.indexOf('\n');var i=1;while(i<line&&index!==-1){index=text.indexOf('\n',index+1);i++;}return index!==-1?index+column+1// +1 for the return character itself
:null;}function countCharacterOccurrences(text,character){var start=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var end=arguments.length>3&&arguments[3]!==undefined?arguments[3]:text.length;var count=0;for(var _i10=start;_i10<end;_i10++){if(text.charAt(_i10)===character){count++;}}return count;}/**
 * Find the text location of a JSON path
 */ // TODO: write unit tests
function findTextLocation(text,path){try{var jsmap=jsonSourceMap.parse(text);var pointerName=immutableJSONPatch.exports.compileJSONPointer(path);var pointer=jsmap.pointers[pointerName];if(pointer){return{path:path,line:pointer.key?pointer.key.line:pointer.value?pointer.value.line:0,column:pointer.key?pointer.key.column:pointer.value?pointer.value.column:0,from:pointer.key?pointer.key.pos:pointer.value?pointer.value.pos:0,to:pointer.keyEnd?pointer.keyEnd.pos:pointer.valueEnd?pointer.valueEnd.pos:0};}}catch(err){console.error(err);}return null;}/**
 * Convert a JSON object, array, or value to another type
 * If it cannot be converted, an error is thrown
 */function convertValue(value,type,parser){// FIXME: improve the TypeScript here, there are a couple of conversions
if(type==='array'){if(Array.isArray(value)){// nothing to do
return value;}if(isObject$1(value)){return objectToArray(value);}if(typeof value==='string'){var parsedValue=parser.parse(value);if(Array.isArray(parsedValue)){return parsedValue;}if(isObject$1(parsedValue)){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return objectToArray(parsedValue);}}}if(type==='object'){if(Array.isArray(value)){return arrayToObject(value);}if(isObject$1(value)){// nothing to do
return value;}if(typeof value==='string'){var _parsedValue=parser.parse(value);if(isObject$1(_parsedValue)){return _parsedValue;}if(Array.isArray(_parsedValue)){return arrayToObject(_parsedValue);}}}if(type==='value'){if(isObjectOrArray(value)){return parser.stringify(value);}// nothing to do
return value;}throw new Error("Cannot convert ".concat(valueType(value,parser)," to ").concat(type));}/**
 * Check whether provided value is valid a content type for JSONEditor
 * Returns a string with validation error message when there is an issue,
 * or null otherwise
 */function validateContentType(content){if(!isObject$1(content)){return'Content must be an object';}if(content.json!==undefined){if(content.text!==undefined){return'Content must contain either a property "json" or a property "text" but not both';}else{return null;}}else{if(content.text===undefined){return'Content must contain either a property "json" or a property "text"';}else if(typeof content.text!=='string'){return'Content "text" property must be string';}else{return null;}}}/**
 * Check whether content contains text (and not JSON)
 */function isTextContent(content){return typeof content.text==='string';}/**
 * Get the contents as Text. If the contents is JSON, the JSON will be parsed.
 */function getText(content,indentation,parser){return isTextContent(content)?content.text:parser.stringify(content.json,null,indentation);}/**
 * Returns true when the (estimated) size of the contents exceeds the
 * provided maxSize.
 * @param content
 * @param maxSize  Maximum content size in bytes
 */function isLargeContent(content,maxSize){return estimateSerializedSize(content,maxSize)>maxSize;}/**
 * A rough, fast estimation on whether a document is larger than given size
 * when serialized.
 *
 * maxSize is an optional max size in bytes. When reached, size estimation will
 * be cancelled. This is useful when you're only interested in knowing whether
 * the size exceeds a certain maximum size.
 */function estimateSerializedSize(content){var maxSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;if(isTextContent(content)){return content.text.length;}var json=content.json;var estimatedSize=0;function recurse(json){if(Array.isArray(json)){// open and close bracket, commas between items
estimatedSize+=2+(json.length-1);if(estimatedSize>maxSize){return estimatedSize;}for(var _i11=0;_i11<json.length;_i11++){var item=json[_i11];recurse(item);if(estimatedSize>maxSize){return estimatedSize;}}}else if(isObject$1(json)){var _keys=Object.keys(json);// open and close brackets, separators between all keys and values, comma's between key/value pairs
estimatedSize+=2+_keys.length+(_keys.length-1);for(var k=0;k<_keys.length;k++){var key=_keys[k];var value=json[key];// key length and double quotes around it
estimatedSize+=key.length+2;recurse(value);}}else if(typeof json==='string'){estimatedSize+=json.length+2;// string length plus two for the double quote characters
}else{// true, false, null, number
estimatedSize+=String(json).length;}}recurse(json);return estimatedSize;}var POSITION_REGEX=/(position|char) (\d+)/;var LINE_REGEX=/line (\d+)/;var COLUMN_REGEX=/column (\d+)/;/**
 * Check whether the actual functions of parse and stringify are strictly equal.
 * The object holding the functions may be a differing instance.
 */function isEqualParser(a,b){return a.parse===b.parse&&a.stringify===b.stringify;}var Mode;exports.Mode=Mode;(function(Mode){Mode["text"]="text";Mode["tree"]="tree";})(Mode||(exports.Mode=Mode={}));var SelectionType;exports.SelectionType=SelectionType;(function(SelectionType){SelectionType["after"]="after";SelectionType["inside"]="inside";SelectionType["key"]="key";SelectionType["value"]="value";SelectionType["multi"]="multi";})(SelectionType||(exports.SelectionType=SelectionType={}));var CaretType;exports.CaretType=CaretType;(function(CaretType){CaretType["after"]="after";CaretType["key"]="key";CaretType["value"]="value";CaretType["inside"]="inside";})(CaretType||(exports.CaretType=CaretType={}));var ValidationSeverity;exports.ValidationSeverity=ValidationSeverity;(function(ValidationSeverity){ValidationSeverity["info"]="info";ValidationSeverity["warning"]="warning";ValidationSeverity["error"]="error";})(ValidationSeverity||(exports.ValidationSeverity=ValidationSeverity={}));var SearchField;exports.SearchField=SearchField;(function(SearchField){SearchField["key"]="key";SearchField["value"]="value";})(SearchField||(exports.SearchField=SearchField={}));/**
 * Create serialization functions to escape and stringify text,
 * and the other way around: to parse and unescape text.
 */function createNormalizationFunctions(_ref10){var escapeControlCharacters=_ref10.escapeControlCharacters,escapeUnicodeCharacters=_ref10.escapeUnicodeCharacters;if(escapeControlCharacters){if(escapeUnicodeCharacters){return normalizeControlAndUnicode;}else{return normalizeControl;}}else{if(escapeUnicodeCharacters){return normalizeUnicode;}else{return normalizeNothing;}}}var normalizeControlAndUnicode={escapeValue:function escapeValue(value){return jsonEscapeUnicode(jsonEscapeControl(String(value)));},unescapeValue:function unescapeValue(value){return jsonUnescapeControl(jsonUnescapeUnicode(value));}};var normalizeControl={escapeValue:function escapeValue(value){return jsonEscapeControl(String(value));},unescapeValue:function unescapeValue(value){return jsonUnescapeControl(value);}};var normalizeUnicode={escapeValue:function escapeValue(value){return jsonEscapeUnicode(String(value));},unescapeValue:function unescapeValue(value){return jsonUnescapeUnicode(value);}};var normalizeNothing={escapeValue:function escapeValue(value){return String(value);},unescapeValue:function unescapeValue(value){return value;}};/**
 * Source:  https://stackoverflow.com/questions/12271547/shouldnt-json-stringify-escape-unicode-characters
 */function jsonEscapeUnicode(value){return value.replace(/[^\x20-\x7F]/g,function(x){if(x==='\b'||x==='\f'||x==='\n'||x==='\r'||x==='\t'){return x;}return"\\u"+('000'+x.codePointAt(0).toString(16)).slice(-4);});}function jsonUnescapeUnicode(value){return value.replace(/\\u[a-fA-F0-9]{4}/g,function(x){try{var unescaped=JSON.parse('"'+x+'"');// the resolved character can be a control character like " or \n,
// that would result in invalid JSON, so we need to keep that escaped
return controlCharacters[unescaped]||unescaped;}catch(err){return x;}});}var controlCharacters={'"':'\\"','\\':'\\\\',// escaped forward slash '\/' is the same as '/', we can't escape/unescape it
'\b':'\\b','\f':'\\f','\n':'\\n','\r':'\\r','\t':'\\t'// unicode is handled separately
};var escapedControlCharacters={'\\"':'"','\\\\':'\\',// escaped forward slash '\/' is the same as '/', we can't escape/unescape it
'\\/':'/','\\b':'\b','\\f':'\f','\\n':'\n','\\r':'\r','\\t':'\t'// unicode is handled separately
};function jsonEscapeControl(value){return value.replace(/["\b\f\n\r\t\\]/g,function(x){return controlCharacters[x]||x;});}function jsonUnescapeControl(value){return value.replace(/\\["bfnrt\\]/g,function(x){return escapedControlCharacters[x]||x;});}function addNewLineSuffix(value){if(typeof value!=='string'){return String(value);}if(value.endsWith('\n')){// DOM innerText strips the last \n, therefore we add an extra \n here
return value+'\n';}return value;}/**
 * Remove a newline suffix from text returned by element.innerText, it adds
 * one return too much.
 */function removeNewLineSuffix(text){return text.replace(/\n$/,'');}function isChildOfNodeName(element,nodeName){return isChildOf(element,function(e){return e.nodeName.toUpperCase()===nodeName.toUpperCase();});}function isChildOfAttribute(element,name,value){return isChildOf(element,function(e){return hasAttribute(e,name,value);});}// test whether a DOM element is a content editable div
function isContentEditableDiv(element){return element.nodeName==='DIV'&&element.contentEditable==='true';}function hasAttribute(element,name,value){return typeof element.getAttribute==='function'&&element.getAttribute(name)===value;}/**
 * Test if the element or one of it's parents has a certain predicate
 * Can be use for example to check whether the element or it's parent has
 * a specific attribute or nodeName.
 * @param {HTMLElement} element
 * @param {function (element: HTMLElement) : boolean} predicate
 * @returns {*}
 */function isChildOf(element,predicate){return!!findParent(element,predicate);}/**
 * Test if the element or one of its parents has a certain predicate
 * Can be use for example to check whether the element or it's parent has
 * a specific attribute or nodeName.
 * @param {HTMLElement} element
 * @param {function (element: HTMLElement) : boolean} predicate
 * @returns {HTMLElement | undefined}
 */function findParent(element,predicate){var e=element;while(e&&!predicate(e)){e=e.parentNode;}return e||undefined;}/**
 * Set the cursor to the end of a content editable div
 * Source: https://stackoverflow.com/questions/13513329/set-cursor-to-the-end-of-contenteditable-div
 * @param {HTMLElement} element
 */function setCursorToEnd(element){if(element.firstChild==null){element.focus();return;}var range=document.createRange();var selection=window.getSelection();range.setStart(element,1);range.collapse(true);selection.removeAllRanges();selection.addRange(range);}/**
 * Gets a DOM element's Window.  This is normally just the global `window`
 * variable, but if we opened a child window, it may be different.
 * @param {HTMLElement} element
 * @return {Window}
 */function _getWindow(element){return element&&element.ownerDocument&&element.ownerDocument.defaultView;}/**
 * @param {HTMLElement} element
 * @return {boolean}
 */function activeElementIsChildOf(element){var window=_getWindow(element);return isChildOf(window.document.activeElement,function(e){return e===element;});}/**
 * Traverse over the parents of the element until a node is found with the
 * searched for node name. If the element itself contains the nodeName, the
 * element itself will be returned
 * @param {HTMLElement} element
 * @param {string} nodeName
 * @return {HTMLElement | undefined}
 */function findParentWithNodeName(element,nodeName){return findParent(element,function(e){return e.nodeName===nodeName;});}/**
 * @param {HTMLElement} target
 * @returns {string | null}
 */function getSelectionTypeFromTarget(target){if(isChildOfAttribute(target,'data-type','selectable-key')){return SelectionType.key;}if(isChildOfAttribute(target,'data-type','selectable-value')){return SelectionType.value;}if(isChildOfAttribute(target,'data-type','insert-selection-area-inside')){return SelectionType.inside;}if(isChildOfAttribute(target,'data-type','insert-selection-area-after')){return SelectionType.after;}return SelectionType.multi;}/**
 * Encode a path into a string that can be used as attribute in HTML
 */function encodeDataPath(path){return encodeURIComponent(immutableJSONPatch.exports.compileJSONPointer(path));}/**
 * Decode a path that was stringified for use as an HTML attribute
 */function decodeDataPath(pathStr){return immutableJSONPatch.exports.parseJSONPointer(decodeURIComponent(pathStr));}/**
 * Find the data path of the given element. Traverses the parent nodes until find
 */function getDataPathFromTarget(target){var parent=findParent(target,function(element){return element.hasAttribute('data-path');});return parent?decodeDataPath(parent.getAttribute('data-path')):null;}/**
 * Find the nearest element in a given context menu with buttons or inputs
 */ // TODO: unit test
function findNearestElement(_ref11){var allElements=_ref11.allElements,currentElement=_ref11.currentElement,direction=_ref11.direction,_ref11$hasPrio=_ref11.hasPrio,hasPrio=_ref11$hasPrio===void 0?function(){return true;}:_ref11$hasPrio,_ref11$margin=_ref11.margin,margin=_ref11$margin===void 0?10:_ref11$margin;var all=map(allElements.filter(isVisible),calculateCenter);var current=calculateCenter(currentElement);function isVisible(element){var rect=element.getBoundingClientRect();return rect.width>0&&rect.height>0;}function calculateCenter(element){var rect=element.getBoundingClientRect();return{x:rect.left+rect.width/2,y:rect.top+rect.height/2,rect:rect,element:element};}var isOnSameRow=function isOnSameRow(a,b){return Math.abs(a.y-b.y)<margin;};var isLeft=function isLeft(a,b){return a.rect.left+margin<b.rect.left;};var isRight=function isRight(a,b){return a.rect.right>b.rect.right+margin;};var isAbove=function isAbove(a,b){return a.y+margin<b.y;};var isBelow=function isBelow(a,b){return a.y>b.y+margin;};function distance(a,b){var weightY=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var diffX=a.x-b.x;var diffY=(a.y-b.y)*weightY;return Math.sqrt(diffX*diffX+diffY*diffY);}var distanceToCurrent=function distanceToCurrent(candidate){return distance(candidate,current);};var distanceToCurrentWeighted=function distanceToCurrentWeighted(candidate){return distance(candidate,current,10);};if(direction==='Left'||direction==='Right'){// First we find the first button left from the current button on the same row
// if not found, search the closest button left/right from current button
var candidatesLeft=direction==='Left'?all.filter(function(button){return isLeft(button,current);}):all.filter(function(button){return isRight(button,current);});var candidatesLeftOnRow=candidatesLeft.filter(function(button){return isOnSameRow(button,current);});var nearest=minBy(candidatesLeftOnRow,distanceToCurrent)||minBy(candidatesLeft,distanceToCurrentWeighted);return nearest===null||nearest===void 0?void 0:nearest.element;}if(direction==='Up'||direction==='Down'){// first we only search through the prio buttons
// if there were no matching prio buttons, search all matching buttons
var candidates=direction==='Up'?all.filter(function(button){return isAbove(button,current);}):all.filter(function(button){return isBelow(button,current);});var prioCandidates=candidates.filter(function(button){return hasPrio(button.element);});var _nearest=minBy(prioCandidates,distanceToCurrent)||minBy(candidates,distanceToCurrent);return _nearest===null||_nearest===void 0?void 0:_nearest.element;}return undefined;}var IS_MAC=typeof navigator!=='undefined'?navigator.platform.toUpperCase().indexOf('MAC')>=0:false;// inspiration: https://github.com/andrepolischuk/keycomb
/**
 * Get a named key from a key code.
 * For example:
 *     keyFromCode(65) returns 'A'
 *     keyFromCode(13) returns 'Enter'
 */function nameFromKeyCode(code){return codes[code]||'';}/**
 * Get the active key combination from a keyboard event.
 * For example returns "Ctrl+Shift+Up" or "Ctrl+A"
 * @param {KeyboardEvent} event
 * @return {string}
 */function keyComboFromEvent(event){var combi=[];if(event.ctrlKey){combi.push('Ctrl');}if(event.metaKey){combi.push('Command');}if(event.altKey){combi.push(IS_MAC?'Option':'Alt');}if(event.shiftKey){combi.push('Shift');}var keyName=nameFromKeyCode(event.which);if(!metaCodes[keyName]){// prevent output like 'Ctrl+Ctrl'
combi.push(keyName);}return combi.join('+');}var metaCodes={Ctrl:true,Command:true,Alt:true,Option:true,Shift:true};var codes={8:'Backspace',9:'Tab',13:'Enter',16:'Shift',17:'Ctrl',18:'Alt',19:'Pause_Break',20:'Caps_Lock',27:'Escape',33:'Page_Up',34:'Page_Down',35:'End',36:'Home',37:'Left',38:'Up',39:'Right',40:'Down',45:'Insert',46:'Delete',48:'0',49:'1',50:'2',51:'3',52:'4',53:'5',54:'6',55:'7',56:'8',57:'9',65:'A',66:'B',67:'C',68:'D',69:'E',70:'F',71:'G',72:'H',73:'I',74:'J',75:'K',76:'L',77:'M',78:'N',79:'O',80:'P',81:'Q',82:'R',83:'S',84:'T',85:'U',86:'V',87:'W',88:'X',89:'Y',90:'Z',91:'Left_Window_Key',92:'Right_Window_Key',93:'Select_Key',96:'Numpad_0',97:'Numpad_1',98:'Numpad_2',99:'Numpad_3',100:'Numpad_4',101:'Numpad_5',102:'Numpad_6',103:'Numpad_7',104:'Numpad_8',105:'Numpad_9',106:'Numpad_*',107:'Numpad_+',109:'Numpad_-',110:'Numpad_.',111:'Numpad_/',112:'F1',113:'F2',114:'F3',115:'F4',116:'F5',117:'F6',118:'F7',119:'F8',120:'F9',121:'F10',122:'F11',123:'F12',144:'Num_Lock',145:'Scroll_Lock',186:';',187:'=',188:',',189:'-',190:'.',191:'/',192:'`',219:'[',220:'\\',221:']',222:"'"};/* src/lib/components/modals/popup/AbsolutePopupEntry.svelte generated by Svelte v3.51.0 */var window_1$1=globals.window;function add_css$J(target){append_styles(target,"svelte-1r8q3m8",".jse-absolute-popup.svelte-1r8q3m8.svelte-1r8q3m8{position:relative;left:0;top:0;width:0;height:0;z-index:1001}.jse-absolute-popup.svelte-1r8q3m8 .jse-hidden-input.svelte-1r8q3m8{position:fixed;left:0;top:0;width:0;height:0;padding:0;margin:0;border:none;outline:none;overflow:hidden}.jse-absolute-popup.svelte-1r8q3m8 .jse-absolute-popup-content.svelte-1r8q3m8{position:absolute}");}// (89:2) {#if refRootPopup}
function create_if_block$s(ctx){var div;var input;var t;var switch_instance;var div_style_value;var current;var switch_instance_spread_levels=[/*popup*/ctx[0].props];var switch_value=/*popup*/ctx[0].component;function switch_props(ctx){var switch_instance_props={};for(var _i12=0;_i12<switch_instance_spread_levels.length;_i12+=1){switch_instance_props=assign$1(switch_instance_props,switch_instance_spread_levels[_i12]);}return{props:switch_instance_props};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());}return{c:function c(){div=element("div");input=element("input");t=space();if(switch_instance)create_component(switch_instance.$$.fragment);attr(input,"type","text");input.readOnly="readonly";attr(input,"tabindex","-1");attr(input,"class","jse-hidden-input svelte-1r8q3m8");attr(div,"class","jse-absolute-popup-content svelte-1r8q3m8");attr(div,"style",div_style_value=calculateStyle(/*refRootPopup*/ctx[1],/*popup*/ctx[0].options));},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,input);/*input_binding*/ctx[7](input);append$1(div,t);if(switch_instance)mount_component(switch_instance,div,null);current=true;},p:function p(ctx,dirty){var switch_instance_changes=dirty&/*popup*/1?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*popup*/ctx[0].props)]):{};if(switch_value!==(switch_value=/*popup*/ctx[0].component)){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,null);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}if(!current||dirty&/*refRootPopup, popup*/3&&div_style_value!==(div_style_value=calculateStyle(/*refRootPopup*/ctx[1],/*popup*/ctx[0].options))){attr(div,"style",div_style_value);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);/*input_binding*/ctx[7](null);if(switch_instance)destroy_component(switch_instance);}};}function create_fragment$T(ctx){var div;var current;var mounted;var dispose;var if_block=/*refRootPopup*/ctx[1]&&create_if_block$s(ctx);return{c:function c(){div=element("div");if(if_block)if_block.c();attr(div,"class","jse-absolute-popup svelte-1r8q3m8");},m:function m(target,anchor){insert$2(target,div,anchor);if(if_block)if_block.m(div,null);/*div_binding*/ctx[8](div);current=true;if(!mounted){dispose=[listen(window_1$1,"mousedown",/*handleWindowMouseDown*/ctx[3],true),listen(window_1$1,"keydown",/*handleKeyDown*/ctx[4],true),listen(window_1$1,"wheel",/*handleScrollWheel*/ctx[5],true),listen(div,"mousedown",handleMouseDownInside),listen(div,"keydown",/*handleKeyDown*/ctx[4])];mounted=true;}},p:function p(ctx,_ref12){var _ref13=_slicedToArray(_ref12,1),dirty=_ref13[0];if(/*refRootPopup*/ctx[1]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*refRootPopup*/2){transition_in(if_block,1);}}else{if_block=create_if_block$s(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);if(if_block)if_block.d();/*div_binding*/ctx[8](null);mounted=false;run_all(dispose);}};}function handleMouseDownInside(event){event.stopPropagation();}function calculateStyle(refRootPopup,options){function calculatePosition(){if(options.anchor){var anchor=options.anchor,_options$width=options.width,width=_options$width===void 0?0:_options$width,_options$height=options.height,height=_options$height===void 0?0:_options$height,_options$offsetTop=options.offsetTop,offsetTop=_options$offsetTop===void 0?0:_options$offsetTop,_options$offsetLeft=options.offsetLeft,offsetLeft=_options$offsetLeft===void 0?0:_options$offsetLeft,position=options.position;var _anchor$getBoundingCl=anchor.getBoundingClientRect(),_left=_anchor$getBoundingCl.left,_top=_anchor$getBoundingCl.top,bottom=_anchor$getBoundingCl.bottom,right=_anchor$getBoundingCl.right;var _positionAbove=position==='top'||_top+height>window.innerHeight&&_top>height;var _positionLeft=position==='left'||_left+width>window.innerWidth&&_left>width;return{left:_positionLeft?right-offsetLeft:_left+offsetLeft,top:_positionAbove?_top-offsetTop:bottom+offsetTop,positionAbove:_positionAbove,positionLeft:_positionLeft};}else if(typeof options.left==='number'&&typeof options.top==='number'){var _left2=options.left,_top2=options.top,_options$width2=options.width,_width=_options$width2===void 0?0:_options$width2,_options$height2=options.height,_height2=_options$height2===void 0?0:_options$height2;var _positionAbove2=_top2+_height2>window.innerHeight&&_top2>_height2;var _positionLeft2=_left2+_width>window.innerWidth&&_left2>_width;return{left:_left2,top:_top2,positionAbove:_positionAbove2,positionLeft:_positionLeft2};}else{throw new Error('Invalid config: pass either "left" and "top", or pass "anchor"');}}var rootRect=refRootPopup.getBoundingClientRect();var _calculatePosition=calculatePosition(),left=_calculatePosition.left,top=_calculatePosition.top,positionAbove=_calculatePosition.positionAbove,positionLeft=_calculatePosition.positionLeft;var verticalStyling=positionAbove?"bottom: ".concat(rootRect.top-top,"px;"):"top: ".concat(top-rootRect.top,"px;");var horizontalStyling=positionLeft?"right: ".concat(rootRect.left-left,"px;"):"left: ".concat(left-rootRect.left,"px;");return verticalStyling+horizontalStyling;}function instance$T($$self,$$props,$$invalidate){var popup=$$props.popup;var closeAbsolutePopup=$$props.closeAbsolutePopup;var refRootPopup;var refHiddenInput;onMount(focus);function closeWhenOutside(event){if(popup.options&&popup.options.closeOnOuterClick&&!isChildOf(event.target,function(e){return e===refRootPopup;})){closeAbsolutePopup(popup.id);}}function handleWindowMouseDown(event){closeWhenOutside(event);}function handleKeyDown(event){var combo=keyComboFromEvent(event);if(combo==='Escape'){closeAbsolutePopup(popup.id);}}function handleScrollWheel(event){closeWhenOutside(event);}function focus(){if(refHiddenInput){refHiddenInput.focus();}}function input_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refHiddenInput=$$value;$$invalidate(2,refHiddenInput);});}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refRootPopup=$$value;$$invalidate(1,refRootPopup);});}$$self.$$set=function($$props){if('popup'in $$props)$$invalidate(0,popup=$$props.popup);if('closeAbsolutePopup'in $$props)$$invalidate(6,closeAbsolutePopup=$$props.closeAbsolutePopup);};return[popup,refRootPopup,refHiddenInput,handleWindowMouseDown,handleKeyDown,handleScrollWheel,closeAbsolutePopup,input_binding,div_binding];}var AbsolutePopupEntry=/*#__PURE__*/function(_SvelteComponent3){_inherits(AbsolutePopupEntry,_SvelteComponent3);var _super4=_createSuper(AbsolutePopupEntry);function AbsolutePopupEntry(options){var _this4;_classCallCheck(this,AbsolutePopupEntry);_this4=_super4.call(this);init(_assertThisInitialized(_this4),options,instance$T,create_fragment$T,safe_not_equal,{popup:0,closeAbsolutePopup:6},add_css$J);return _this4;}return _createClass(AbsolutePopupEntry);}(SvelteComponent);var AbsolutePopupEntry$1=AbsolutePopupEntry;/* src/lib/components/modals/popup/AbsolutePopup.svelte generated by Svelte v3.51.0 */function get_each_context$h(ctx,list,i){var child_ctx=ctx.slice();child_ctx[6]=list[i];return child_ctx;}// (34:0) {#each popups as popup}
function create_each_block$h(ctx){var absolutepopupentry;var current;absolutepopupentry=new AbsolutePopupEntry$1({props:{popup:/*popup*/ctx[6],closeAbsolutePopup:/*closeAbsolutePopup*/ctx[1]}});return{c:function c(){create_component(absolutepopupentry.$$.fragment);},m:function m(target,anchor){mount_component(absolutepopupentry,target,anchor);current=true;},p:function p(ctx,dirty){var absolutepopupentry_changes={};if(dirty&/*popups*/1)absolutepopupentry_changes.popup=/*popup*/ctx[6];absolutepopupentry.$set(absolutepopupentry_changes);},i:function i(local){if(current)return;transition_in(absolutepopupentry.$$.fragment,local);current=true;},o:function o(local){transition_out(absolutepopupentry.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(absolutepopupentry,detaching);}};}function create_fragment$S(ctx){var t;var current;var each_value=/*popups*/ctx[0];var each_blocks=[];for(var _i13=0;_i13<each_value.length;_i13+=1){each_blocks[_i13]=create_each_block$h(get_each_context$h(ctx,each_value,_i13));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};var default_slot_template=/*#slots*/ctx[3]["default"];var default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[2],null);return{c:function c(){for(var _i14=0;_i14<each_blocks.length;_i14+=1){each_blocks[_i14].c();}t=space();if(default_slot)default_slot.c();},m:function m(target,anchor){for(var _i15=0;_i15<each_blocks.length;_i15+=1){each_blocks[_i15].m(target,anchor);}insert$2(target,t,anchor);if(default_slot){default_slot.m(target,anchor);}current=true;},p:function p(ctx,_ref14){var _ref15=_slicedToArray(_ref14,1),dirty=_ref15[0];if(dirty&/*popups, closeAbsolutePopup*/3){each_value=/*popups*/ctx[0];var _i16;for(_i16=0;_i16<each_value.length;_i16+=1){var child_ctx=get_each_context$h(ctx,each_value,_i16);if(each_blocks[_i16]){each_blocks[_i16].p(child_ctx,dirty);transition_in(each_blocks[_i16],1);}else{each_blocks[_i16]=create_each_block$h(child_ctx);each_blocks[_i16].c();transition_in(each_blocks[_i16],1);each_blocks[_i16].m(t.parentNode,t);}}group_outros();for(_i16=each_value.length;_i16<each_blocks.length;_i16+=1){out(_i16);}check_outros();}if(default_slot){if(default_slot.p&&(!current||dirty&/*$$scope*/4)){update_slot_base(default_slot,default_slot_template,ctx,/*$$scope*/ctx[2],!current?get_all_dirty_from_scope(/*$$scope*/ctx[2]):get_slot_changes(default_slot_template,/*$$scope*/ctx[2],dirty,null),null);}}},i:function i(local){if(current)return;for(var _i17=0;_i17<each_value.length;_i17+=1){transition_in(each_blocks[_i17]);}transition_in(default_slot,local);current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i18=0;_i18<each_blocks.length;_i18+=1){transition_out(each_blocks[_i18]);}transition_out(default_slot,local);current=false;},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(t);if(default_slot)default_slot.d(detaching);}};}function instance$S($$self,$$props,$$invalidate){var _$$props$$$slots2=$$props.$$slots,slots=_$$props$$$slots2===void 0?{}:_$$props$$$slots2,$$scope=$$props.$$scope;var debug=createDebug('jsoneditor:AbsolutePopup');var popups=[];function openAbsolutePopup(component,props,options){debug('open...',props,options);var popup={id:uniqueId$1(),component:component,props:props||{},options:options||{}};$$invalidate(0,popups=[].concat(_toConsumableArray2(popups),[popup]));return popup.id;}function closeAbsolutePopup(popupId){var popupIndex=popups.findIndex(function(popup){return popup.id===popupId;});if(popupIndex!==-1){var popup=popups[popupIndex];if(popup.options.onClose){popup.options.onClose();}$$invalidate(0,popups=popups.filter(function(popup){return popup.id!==popupId;}));}}setContext('absolute-popup',{openAbsolutePopup:openAbsolutePopup,closeAbsolutePopup:closeAbsolutePopup});$$self.$$set=function($$props){if('$$scope'in $$props)$$invalidate(2,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty&/*popups*/1){debug('popups',popups);}};return[popups,closeAbsolutePopup,$$scope,slots];}var AbsolutePopup=/*#__PURE__*/function(_SvelteComponent4){_inherits(AbsolutePopup,_SvelteComponent4);var _super5=_createSuper(AbsolutePopup);function AbsolutePopup(options){var _this5;_classCallCheck(this,AbsolutePopup);_this5=_super5.call(this);init(_assertThisInitialized(_this5),options,instance$S,create_fragment$S,not_equal,{});return _this5;}return _createClass(AbsolutePopup);}(SvelteComponent);var AbsolutePopup$1=AbsolutePopup;var faCaretRight={prefix:'fas',iconName:'caret-right',icon:[256,512,[],"f0da","M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"]};var faPaste={prefix:'fas',iconName:'paste',icon:[512,512,["file-clipboard"],"f0ea","M160 0c-23.7 0-44.4 12.9-55.4 32H48C21.5 32 0 53.5 0 80V400c0 26.5 21.5 48 48 48H192V176c0-44.2 35.8-80 80-80h48V80c0-26.5-21.5-48-48-48H215.4C204.4 12.9 183.7 0 160 0zM272 128c-26.5 0-48 21.5-48 48V448v16c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V256H416c-17.7 0-32-14.3-32-32V128H320 272zM160 88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24zm256 40v96h96l-96-96z"]};var faCircleNotch={prefix:'fas',iconName:'circle-notch',icon:[512,512,[],"f1ce","M222.7 32.1c5 16.9-4.6 34.8-21.5 39.8C121.8 95.6 64 169.1 64 256c0 106 86 192 192 192s192-86 192-192c0-86.9-57.8-160.4-137.1-184.1c-16.9-5-26.6-22.9-21.5-39.8s22.9-26.6 39.8-21.5C434.9 42.1 512 140 512 256c0 141.4-114.6 256-256 256S0 397.4 0 256C0 140 77.1 42.1 182.9 10.6c16.9-5 34.8 4.6 39.8 21.5z"]};var faScissors={prefix:'fas',iconName:'scissors',icon:[512,512,[9984,9986,9988,"cut"],"f0c4","M256 192l-39.5-39.5c4.9-12.6 7.5-26.2 7.5-40.5C224 50.1 173.9 0 112 0S0 50.1 0 112s50.1 112 112 112c14.3 0 27.9-2.7 40.5-7.5L192 256l-39.5 39.5c-12.6-4.9-26.2-7.5-40.5-7.5C50.1 288 0 338.1 0 400s50.1 112 112 112s112-50.1 112-112c0-14.3-2.7-27.9-7.5-40.5L499.2 76.8c7.1-7.1 7.1-18.5 0-25.6c-28.3-28.3-74.1-28.3-102.4 0L256 192zm22.6 150.6L396.8 460.8c28.3 28.3 74.1 28.3 102.4 0c7.1-7.1 7.1-18.5 0-25.6L342.6 278.6l-64 64zM160 112c0 26.5-21.5 48-48 48s-48-21.5-48-48s21.5-48 48-48s48 21.5 48 48zM112 448c-26.5 0-48-21.5-48-48s21.5-48 48-48s48 21.5 48 48s-21.5 48-48 48z"]};var faCut=faScissors;var faSquareCaretDown={prefix:'fas',iconName:'square-caret-down',icon:[448,512,["caret-square-down"],"f150","M384 480c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0zM224 352c-6.7 0-13-2.8-17.6-7.7l-104-112c-6.5-7-8.2-17.2-4.4-25.9s12.5-14.4 22-14.4l208 0c9.5 0 18.2 5.7 22 14.4s2.1 18.9-4.4 25.9l-104 112c-4.5 4.9-10.9 7.7-17.6 7.7z"]};var faCaretSquareDown=faSquareCaretDown;var faPenToSquare={prefix:'fas',iconName:'pen-to-square',icon:[512,512,["edit"],"f044","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.8 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"]};var faEdit=faPenToSquare;var faChevronUp={prefix:'fas',iconName:'chevron-up',icon:[512,512,[],"f077","M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"]};var faAngleRight={prefix:'fas',iconName:'angle-right',icon:[320,512,[8250],"f105","M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"]};var faSquareCaretUp={prefix:'fas',iconName:'square-caret-up',icon:[448,512,["caret-square-up"],"f151","M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM224 160c6.7 0 13 2.8 17.6 7.7l104 112c6.5 7 8.2 17.2 4.4 25.9s-12.5 14.4-22 14.4H120c-9.5 0-18.2-5.7-22-14.4s-2.1-18.9 4.4-25.9l104-112c4.5-4.9 10.9-7.7 17.6-7.7z"]};var faCaretSquareUp=faSquareCaretUp;var faFilter={prefix:'fas',iconName:'filter',icon:[512,512,[],"f0b0","M3.9 54.9C10.5 40.9 24.5 32 40 32H472c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9V448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6V320.9L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"]};var faCode={prefix:'fas',iconName:'code',icon:[640,512,[],"f121","M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"]};var faWrench={prefix:'fas',iconName:'wrench',icon:[512,512,[128295],"f0ad","M352 320c88.4 0 160-71.6 160-160c0-15.3-2.2-30.1-6.2-44.2c-3.1-10.8-16.4-13.2-24.3-5.3l-76.8 76.8c-3 3-7.1 4.7-11.3 4.7H336c-8.8 0-16-7.2-16-16V118.6c0-4.2 1.7-8.3 4.7-11.3l76.8-76.8c7.9-7.9 5.4-21.2-5.3-24.3C382.1 2.2 367.3 0 352 0C263.6 0 192 71.6 192 160c0 19.1 3.4 37.5 9.5 54.5L19.9 396.1C7.2 408.8 0 426.1 0 444.1C0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9L297.5 310.5c17 6.2 35.4 9.5 54.5 9.5zM80 456c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"]};var faPen={prefix:'fas',iconName:'pen',icon:[512,512,[128394],"f304","M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"]};var faArrowRotateRight={prefix:'fas',iconName:'arrow-rotate-right',icon:[512,512,[8635,"arrow-right-rotate","arrow-rotate-forward","redo"],"f01e","M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32H464c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z"]};var faRedo=faArrowRotateRight;var faArrowRotateLeft={prefix:'fas',iconName:'arrow-rotate-left',icon:[512,512,[8634,"arrow-left-rotate","arrow-rotate-back","arrow-rotate-backward","undo"],"f0e2","M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"]};var faUndo=faArrowRotateLeft;var faCropSimple={prefix:'fas',iconName:'crop-simple',icon:[512,512,["crop-alt"],"f565","M128 32c0-17.7-14.3-32-32-32S64 14.3 64 32V64H32C14.3 64 0 78.3 0 96s14.3 32 32 32H64V384c0 35.3 28.7 64 64 64H352V384H128V32zM384 480c0 17.7 14.3 32 32 32s32-14.3 32-32V448h32c17.7 0 32-14.3 32-32s-14.3-32-32-32H448l0-256c0-35.3-28.7-64-64-64L160 64v64l224 0 0 352z"]};var faCropAlt=faCropSimple;var faGear={prefix:'fas',iconName:'gear',icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]};var faCog=faGear;var faCaretDown={prefix:'fas',iconName:'caret-down',icon:[320,512,[],"f0d7","M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"]};var faEllipsisVertical={prefix:'fas',iconName:'ellipsis-vertical',icon:[128,512,["ellipsis-v"],"f142","M64 360c30.9 0 56 25.1 56 56s-25.1 56-56 56s-56-25.1-56-56s25.1-56 56-56zm0-160c30.9 0 56 25.1 56 56s-25.1 56-56 56s-56-25.1-56-56s25.1-56 56-56zM120 96c0 30.9-25.1 56-56 56S8 126.9 8 96S33.1 40 64 40s56 25.1 56 56z"]};var faEllipsisV=faEllipsisVertical;var faArrowDownShortWide={prefix:'fas',iconName:'arrow-down-short-wide',icon:[576,512,["sort-amount-desc","sort-amount-down-alt"],"f884","M151.6 469.6C145.5 476.2 137 480 128 480s-17.5-3.8-23.6-10.4l-88-96c-11.9-13-11.1-33.3 2-45.2s33.3-11.1 45.2 2L96 365.7V64c0-17.7 14.3-32 32-32s32 14.3 32 32V365.7l32.4-35.4c11.9-13 32.2-13.9 45.2-2s13.9 32.2 2 45.2l-88 96zM320 32h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 128H544c17.7 0 32 14.3 32 32s-14.3 32-32 32H320c-17.7 0-32-14.3-32-32s14.3-32 32-32z"]};var faSortAmountDownAlt=faArrowDownShortWide;var faAngleDown={prefix:'fas',iconName:'angle-down',icon:[448,512,[8964],"f107","M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]};var faArrowDown={prefix:'fas',iconName:'arrow-down',icon:[384,512,[8595],"f063","M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]};var faMagnifyingGlass={prefix:'fas',iconName:'magnifying-glass',icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"]};var faSearch=faMagnifyingGlass;var faChevronDown={prefix:'fas',iconName:'chevron-down',icon:[512,512,[],"f078","M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"]};var faCopy={prefix:'fas',iconName:'copy',icon:[512,512,[],"f0c5","M224 0c-35.3 0-64 28.7-64 64V288c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H224zM64 160c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H288c35.3 0 64-28.7 64-64V384H288v64H64V224h64V160H64z"]};var faXmark={prefix:'fas',iconName:'xmark',icon:[320,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"]};var faClose=faXmark;var faTimes=faXmark;var faClone={prefix:'fas',iconName:'clone',icon:[512,512,[],"f24d","M0 448c0 35.3 28.7 64 64 64H288c35.3 0 64-28.7 64-64V384H224c-53 0-96-43-96-96V160H64c-35.3 0-64 28.7-64 64V448zm224-96H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H224c-35.3 0-64 28.7-64 64V288c0 35.3 28.7 64 64 64z"]};var faCheck={prefix:'fas',iconName:'check',icon:[512,512,[10003,10004],"f00c","M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"]};var faTriangleExclamation={prefix:'fas',iconName:'triangle-exclamation',icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z"]};var faExclamationTriangle=faTriangleExclamation;/**
 * Return a human readable document size
 * For example formatSize(7570718) outputs '7.6 MB'
 * @param size
 * @param kilo Is 1000 by default, you can specify 1024 if you
 *                             want the output in KiB
 * @return Returns a human readable size
 */function formatSize(size){var kilo=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1000;if(size<0.9*kilo){return size.toFixed()+' B';}var KB=size/kilo;if(KB<0.9*kilo){return KB.toFixed(1)+' KB';}var MB=KB/kilo;if(MB<0.9*kilo){return MB.toFixed(1)+' MB';}var GB=MB/kilo;if(GB<0.9*kilo){return GB.toFixed(1)+' GB';}var TB=GB/kilo;return TB.toFixed(1)+' TB';}var debug$3=createDebug('jsoneditor:FocusTracker');function createFocusTracker(_ref16){var onMount=_ref16.onMount,onDestroy=_ref16.onDestroy,getWindow=_ref16.getWindow,hasFocus=_ref16.hasFocus,onFocus=_ref16.onFocus,onBlur=_ref16.onBlur;var blurTimeoutHandle;var focus=false;function handleFocusIn(){var newFocus=hasFocus();if(newFocus){clearTimeout(blurTimeoutHandle);if(!focus){debug$3('focus');onFocus();focus=newFocus;}}}function handleFocusOut(){if(focus){// We set focus to false after timeout. Often, you get a blur and directly
// another focus when moving focus from one button to another.
// The focusIn handler will cancel any pending blur timer in those cases
clearTimeout(blurTimeoutHandle);blurTimeoutHandle=setTimeout(function(){debug$3('blur');focus=false;onBlur();});}}onMount(function(){debug$3('mount FocusTracker');var window=getWindow();if(window){window.addEventListener('focusin',handleFocusIn,true);window.addEventListener('focusout',handleFocusOut,true);}});onDestroy(function(){debug$3('destroy FocusTracker');var window=getWindow();if(window){window.removeEventListener('focusin',handleFocusIn,true);window.removeEventListener('focusout',handleFocusOut,true);}});}/* node_modules/svelte-awesome/components/svg/Path.svelte generated by Svelte v3.51.0 */function create_fragment$R(ctx){var path;var path_id_value;var path_levels=[{id:path_id_value="path-"+/*id*/ctx[0]},/*data*/ctx[1]];var path_data={};for(var _i19=0;_i19<path_levels.length;_i19+=1){path_data=assign$1(path_data,path_levels[_i19]);}return{c:function c(){path=svg_element("path");set_svg_attributes(path,path_data);},m:function m(target,anchor){insert$2(target,path,anchor);},p:function p(ctx,_ref17){var _ref18=_slicedToArray(_ref17,1),dirty=_ref18[0];set_svg_attributes(path,path_data=get_spread_update(path_levels,[dirty&/*id*/1&&path_id_value!==(path_id_value="path-"+/*id*/ctx[0])&&{id:path_id_value},dirty&/*data*/2&&/*data*/ctx[1]]));},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(path);}};}function instance$R($$self,$$props,$$invalidate){var id=$$props.id;var _$$props$data=$$props.data,data=_$$props$data===void 0?{}:_$$props$data;$$self.$$set=function($$props){if('id'in $$props)$$invalidate(0,id=$$props.id);if('data'in $$props)$$invalidate(1,data=$$props.data);};return[id,data];}var Path=/*#__PURE__*/function(_SvelteComponent5){_inherits(Path,_SvelteComponent5);var _super6=_createSuper(Path);function Path(options){var _this6;_classCallCheck(this,Path);_this6=_super6.call(this);init(_assertThisInitialized(_this6),options,instance$R,create_fragment$R,safe_not_equal,{id:0,data:1});return _this6;}return _createClass(Path);}(SvelteComponent);/* node_modules/svelte-awesome/components/svg/Polygon.svelte generated by Svelte v3.51.0 */function create_fragment$Q(ctx){var polygon;var polygon_id_value;var polygon_levels=[{id:polygon_id_value="polygon-"+/*id*/ctx[0]},/*data*/ctx[1]];var polygon_data={};for(var _i20=0;_i20<polygon_levels.length;_i20+=1){polygon_data=assign$1(polygon_data,polygon_levels[_i20]);}return{c:function c(){polygon=svg_element("polygon");set_svg_attributes(polygon,polygon_data);},m:function m(target,anchor){insert$2(target,polygon,anchor);},p:function p(ctx,_ref19){var _ref20=_slicedToArray(_ref19,1),dirty=_ref20[0];set_svg_attributes(polygon,polygon_data=get_spread_update(polygon_levels,[dirty&/*id*/1&&polygon_id_value!==(polygon_id_value="polygon-"+/*id*/ctx[0])&&{id:polygon_id_value},dirty&/*data*/2&&/*data*/ctx[1]]));},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(polygon);}};}function instance$Q($$self,$$props,$$invalidate){var id=$$props.id;var _$$props$data2=$$props.data,data=_$$props$data2===void 0?{}:_$$props$data2;$$self.$$set=function($$props){if('id'in $$props)$$invalidate(0,id=$$props.id);if('data'in $$props)$$invalidate(1,data=$$props.data);};return[id,data];}var Polygon=/*#__PURE__*/function(_SvelteComponent6){_inherits(Polygon,_SvelteComponent6);var _super7=_createSuper(Polygon);function Polygon(options){var _this7;_classCallCheck(this,Polygon);_this7=_super7.call(this);init(_assertThisInitialized(_this7),options,instance$Q,create_fragment$Q,safe_not_equal,{id:0,data:1});return _this7;}return _createClass(Polygon);}(SvelteComponent);/* node_modules/svelte-awesome/components/svg/Raw.svelte generated by Svelte v3.51.0 */function create_fragment$P(ctx){var g;return{c:function c(){g=svg_element("g");},m:function m(target,anchor){insert$2(target,g,anchor);g.innerHTML=/*raw*/ctx[0];},p:function p(ctx,_ref21){var _ref22=_slicedToArray(_ref21,1),dirty=_ref22[0];if(dirty&/*raw*/1)g.innerHTML=/*raw*/ctx[0];},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(g);}};}function instance$P($$self,$$props,$$invalidate){var cursor=0xd4937;function getId(){cursor+=1;return"fa-".concat(cursor.toString(16));}var raw;var data=$$props.data;function getRaw(data){if(!data||!data.raw){return null;}var rawData=data.raw;var ids={};rawData=rawData.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,function(match,id){var uniqueId=getId();ids[id]=uniqueId;return" id=\"".concat(uniqueId,"\"");});rawData=rawData.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,function(match,rawId,_,pointerId){var id=rawId||pointerId;if(!id||!ids[id]){return match;}return"#".concat(ids[id]);});return rawData;}$$self.$$set=function($$props){if('data'in $$props)$$invalidate(1,data=$$props.data);};$$self.$$.update=function(){if($$self.$$.dirty&/*data*/2){$$invalidate(0,raw=getRaw(data));}};return[raw,data];}var Raw=/*#__PURE__*/function(_SvelteComponent7){_inherits(Raw,_SvelteComponent7);var _super8=_createSuper(Raw);function Raw(options){var _this8;_classCallCheck(this,Raw);_this8=_super8.call(this);init(_assertThisInitialized(_this8),options,instance$P,create_fragment$P,safe_not_equal,{data:1});return _this8;}return _createClass(Raw);}(SvelteComponent);/* node_modules/svelte-awesome/components/svg/Svg.svelte generated by Svelte v3.51.0 */function add_css$I(target){append_styles(target,"svelte-1dof0an",".fa-icon.svelte-1dof0an{display:inline-block;fill:currentColor}.fa-flip-horizontal.svelte-1dof0an{transform:scale(-1, 1)}.fa-flip-vertical.svelte-1dof0an{transform:scale(1, -1)}.fa-spin.svelte-1dof0an{animation:svelte-1dof0an-fa-spin 1s 0s infinite linear}.fa-inverse.svelte-1dof0an{color:#fff}.fa-pulse.svelte-1dof0an{animation:svelte-1dof0an-fa-spin 1s infinite steps(8)}@keyframes svelte-1dof0an-fa-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}");}function create_fragment$O(ctx){var svg;var svg_class_value;var svg_role_value;var current;var default_slot_template=/*#slots*/ctx[13]["default"];var default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[12],null);return{c:function c(){svg=svg_element("svg");if(default_slot)default_slot.c();attr(svg,"version","1.1");attr(svg,"class",svg_class_value="fa-icon "+/*className*/ctx[0]+" svelte-1dof0an");attr(svg,"x",/*x*/ctx[8]);attr(svg,"y",/*y*/ctx[9]);attr(svg,"width",/*width*/ctx[1]);attr(svg,"height",/*height*/ctx[2]);attr(svg,"aria-label",/*label*/ctx[11]);attr(svg,"role",svg_role_value=/*label*/ctx[11]?'img':'presentation');attr(svg,"viewBox",/*box*/ctx[3]);attr(svg,"style",/*style*/ctx[10]);toggle_class(svg,"fa-spin",/*spin*/ctx[4]);toggle_class(svg,"fa-pulse",/*pulse*/ctx[6]);toggle_class(svg,"fa-inverse",/*inverse*/ctx[5]);toggle_class(svg,"fa-flip-horizontal",/*flip*/ctx[7]==='horizontal');toggle_class(svg,"fa-flip-vertical",/*flip*/ctx[7]==='vertical');},m:function m(target,anchor){insert$2(target,svg,anchor);if(default_slot){default_slot.m(svg,null);}current=true;},p:function p(ctx,_ref23){var _ref24=_slicedToArray(_ref23,1),dirty=_ref24[0];if(default_slot){if(default_slot.p&&(!current||dirty&/*$$scope*/4096)){update_slot_base(default_slot,default_slot_template,ctx,/*$$scope*/ctx[12],!current?get_all_dirty_from_scope(/*$$scope*/ctx[12]):get_slot_changes(default_slot_template,/*$$scope*/ctx[12],dirty,null),null);}}if(!current||dirty&/*className*/1&&svg_class_value!==(svg_class_value="fa-icon "+/*className*/ctx[0]+" svelte-1dof0an")){attr(svg,"class",svg_class_value);}if(!current||dirty&/*x*/256){attr(svg,"x",/*x*/ctx[8]);}if(!current||dirty&/*y*/512){attr(svg,"y",/*y*/ctx[9]);}if(!current||dirty&/*width*/2){attr(svg,"width",/*width*/ctx[1]);}if(!current||dirty&/*height*/4){attr(svg,"height",/*height*/ctx[2]);}if(!current||dirty&/*label*/2048){attr(svg,"aria-label",/*label*/ctx[11]);}if(!current||dirty&/*label*/2048&&svg_role_value!==(svg_role_value=/*label*/ctx[11]?'img':'presentation')){attr(svg,"role",svg_role_value);}if(!current||dirty&/*box*/8){attr(svg,"viewBox",/*box*/ctx[3]);}if(!current||dirty&/*style*/1024){attr(svg,"style",/*style*/ctx[10]);}if(!current||dirty&/*className, spin*/17){toggle_class(svg,"fa-spin",/*spin*/ctx[4]);}if(!current||dirty&/*className, pulse*/65){toggle_class(svg,"fa-pulse",/*pulse*/ctx[6]);}if(!current||dirty&/*className, inverse*/33){toggle_class(svg,"fa-inverse",/*inverse*/ctx[5]);}if(!current||dirty&/*className, flip*/129){toggle_class(svg,"fa-flip-horizontal",/*flip*/ctx[7]==='horizontal');}if(!current||dirty&/*className, flip*/129){toggle_class(svg,"fa-flip-vertical",/*flip*/ctx[7]==='vertical');}},i:function i(local){if(current)return;transition_in(default_slot,local);current=true;},o:function o(local){transition_out(default_slot,local);current=false;},d:function d(detaching){if(detaching)detach(svg);if(default_slot)default_slot.d(detaching);}};}function instance$O($$self,$$props,$$invalidate){var _$$props$$$slots3=$$props.$$slots,slots=_$$props$$$slots3===void 0?{}:_$$props$$$slots3,$$scope=$$props.$$scope;var className=$$props["class"];var width=$$props.width;var height=$$props.height;var box=$$props.box;var _$$props$spin=$$props.spin,spin=_$$props$spin===void 0?false:_$$props$spin;var _$$props$inverse=$$props.inverse,inverse=_$$props$inverse===void 0?false:_$$props$inverse;var _$$props$pulse=$$props.pulse,pulse=_$$props$pulse===void 0?false:_$$props$pulse;var _$$props$flip=$$props.flip,flip=_$$props$flip===void 0?null:_$$props$flip;var _$$props$x=$$props.x,x=_$$props$x===void 0?undefined:_$$props$x;var _$$props$y=$$props.y,y=_$$props$y===void 0?undefined:_$$props$y;var _$$props$style=$$props.style,style=_$$props$style===void 0?undefined:_$$props$style;var _$$props$label=$$props.label,label=_$$props$label===void 0?undefined:_$$props$label;$$self.$$set=function($$props){if('class'in $$props)$$invalidate(0,className=$$props["class"]);if('width'in $$props)$$invalidate(1,width=$$props.width);if('height'in $$props)$$invalidate(2,height=$$props.height);if('box'in $$props)$$invalidate(3,box=$$props.box);if('spin'in $$props)$$invalidate(4,spin=$$props.spin);if('inverse'in $$props)$$invalidate(5,inverse=$$props.inverse);if('pulse'in $$props)$$invalidate(6,pulse=$$props.pulse);if('flip'in $$props)$$invalidate(7,flip=$$props.flip);if('x'in $$props)$$invalidate(8,x=$$props.x);if('y'in $$props)$$invalidate(9,y=$$props.y);if('style'in $$props)$$invalidate(10,style=$$props.style);if('label'in $$props)$$invalidate(11,label=$$props.label);if('$$scope'in $$props)$$invalidate(12,$$scope=$$props.$$scope);};return[className,width,height,box,spin,inverse,pulse,flip,x,y,style,label,$$scope,slots];}var Svg=/*#__PURE__*/function(_SvelteComponent8){_inherits(Svg,_SvelteComponent8);var _super9=_createSuper(Svg);function Svg(options){var _this9;_classCallCheck(this,Svg);_this9=_super9.call(this);init(_assertThisInitialized(_this9),options,instance$O,create_fragment$O,safe_not_equal,{"class":0,width:1,height:2,box:3,spin:4,inverse:5,pulse:6,flip:7,x:8,y:9,style:10,label:11},add_css$I);return _this9;}return _createClass(Svg);}(SvelteComponent);/* node_modules/svelte-awesome/components/Icon.svelte generated by Svelte v3.51.0 */function get_each_context$g(ctx,list,i){var child_ctx=ctx.slice();child_ctx[24]=list[i];child_ctx[26]=i;return child_ctx;}function get_each_context_1$1(ctx,list,i){var child_ctx=ctx.slice();child_ctx[27]=list[i];child_ctx[26]=i;return child_ctx;}// (4:4) {#if self}
function create_if_block$r(ctx){var t0;var t1;var if_block2_anchor;var current;var if_block0=/*self*/ctx[6].paths&&create_if_block_3$7(ctx);var if_block1=/*self*/ctx[6].polygons&&create_if_block_2$b(ctx);var if_block2=/*self*/ctx[6].raw&&create_if_block_1$f(ctx);return{c:function c(){if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if(if_block2)if_block2.c();if_block2_anchor=empty$1();},m:function m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert$2(target,t0,anchor);if(if_block1)if_block1.m(target,anchor);insert$2(target,t1,anchor);if(if_block2)if_block2.m(target,anchor);insert$2(target,if_block2_anchor,anchor);current=true;},p:function p(ctx,dirty){if(/*self*/ctx[6].paths){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*self*/64){transition_in(if_block0,1);}}else{if_block0=create_if_block_3$7(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(/*self*/ctx[6].polygons){if(if_block1){if_block1.p(ctx,dirty);if(dirty&/*self*/64){transition_in(if_block1,1);}}else{if_block1=create_if_block_2$b(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(t1.parentNode,t1);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(/*self*/ctx[6].raw){if(if_block2){if_block2.p(ctx,dirty);if(dirty&/*self*/64){transition_in(if_block2,1);}}else{if_block2=create_if_block_1$f(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(if_block2_anchor.parentNode,if_block2_anchor);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,function(){if_block2=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);current=false;},d:function d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(if_block1)if_block1.d(detaching);if(detaching)detach(t1);if(if_block2)if_block2.d(detaching);if(detaching)detach(if_block2_anchor);}};}// (5:6) {#if self.paths}
function create_if_block_3$7(ctx){var each_1_anchor;var current;var each_value_1=/*self*/ctx[6].paths;var each_blocks=[];for(var _i21=0;_i21<each_value_1.length;_i21+=1){each_blocks[_i21]=create_each_block_1$1(get_each_context_1$1(ctx,each_value_1,_i21));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){for(var _i22=0;_i22<each_blocks.length;_i22+=1){each_blocks[_i22].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i23=0;_i23<each_blocks.length;_i23+=1){each_blocks[_i23].m(target,anchor);}insert$2(target,each_1_anchor,anchor);current=true;},p:function p(ctx,dirty){if(dirty&/*self*/64){each_value_1=/*self*/ctx[6].paths;var _i24;for(_i24=0;_i24<each_value_1.length;_i24+=1){var child_ctx=get_each_context_1$1(ctx,each_value_1,_i24);if(each_blocks[_i24]){each_blocks[_i24].p(child_ctx,dirty);transition_in(each_blocks[_i24],1);}else{each_blocks[_i24]=create_each_block_1$1(child_ctx);each_blocks[_i24].c();transition_in(each_blocks[_i24],1);each_blocks[_i24].m(each_1_anchor.parentNode,each_1_anchor);}}group_outros();for(_i24=each_value_1.length;_i24<each_blocks.length;_i24+=1){out(_i24);}check_outros();}},i:function i(local){if(current)return;for(var _i25=0;_i25<each_value_1.length;_i25+=1){transition_in(each_blocks[_i25]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i26=0;_i26<each_blocks.length;_i26+=1){transition_out(each_blocks[_i26]);}current=false;},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}// (6:8) {#each self.paths as path, i}
function create_each_block_1$1(ctx){var path;var current;path=new Path({props:{id:/*i*/ctx[26],data:/*path*/ctx[27]}});return{c:function c(){create_component(path.$$.fragment);},m:function m(target,anchor){mount_component(path,target,anchor);current=true;},p:function p(ctx,dirty){var path_changes={};if(dirty&/*self*/64)path_changes.data=/*path*/ctx[27];path.$set(path_changes);},i:function i(local){if(current)return;transition_in(path.$$.fragment,local);current=true;},o:function o(local){transition_out(path.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(path,detaching);}};}// (10:6) {#if self.polygons}
function create_if_block_2$b(ctx){var each_1_anchor;var current;var each_value=/*self*/ctx[6].polygons;var each_blocks=[];for(var _i27=0;_i27<each_value.length;_i27+=1){each_blocks[_i27]=create_each_block$g(get_each_context$g(ctx,each_value,_i27));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){for(var _i28=0;_i28<each_blocks.length;_i28+=1){each_blocks[_i28].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i29=0;_i29<each_blocks.length;_i29+=1){each_blocks[_i29].m(target,anchor);}insert$2(target,each_1_anchor,anchor);current=true;},p:function p(ctx,dirty){if(dirty&/*self*/64){each_value=/*self*/ctx[6].polygons;var _i30;for(_i30=0;_i30<each_value.length;_i30+=1){var child_ctx=get_each_context$g(ctx,each_value,_i30);if(each_blocks[_i30]){each_blocks[_i30].p(child_ctx,dirty);transition_in(each_blocks[_i30],1);}else{each_blocks[_i30]=create_each_block$g(child_ctx);each_blocks[_i30].c();transition_in(each_blocks[_i30],1);each_blocks[_i30].m(each_1_anchor.parentNode,each_1_anchor);}}group_outros();for(_i30=each_value.length;_i30<each_blocks.length;_i30+=1){out(_i30);}check_outros();}},i:function i(local){if(current)return;for(var _i31=0;_i31<each_value.length;_i31+=1){transition_in(each_blocks[_i31]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i32=0;_i32<each_blocks.length;_i32+=1){transition_out(each_blocks[_i32]);}current=false;},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}// (11:8) {#each self.polygons as polygon, i}
function create_each_block$g(ctx){var polygon;var current;polygon=new Polygon({props:{id:/*i*/ctx[26],data:/*polygon*/ctx[24]}});return{c:function c(){create_component(polygon.$$.fragment);},m:function m(target,anchor){mount_component(polygon,target,anchor);current=true;},p:function p(ctx,dirty){var polygon_changes={};if(dirty&/*self*/64)polygon_changes.data=/*polygon*/ctx[24];polygon.$set(polygon_changes);},i:function i(local){if(current)return;transition_in(polygon.$$.fragment,local);current=true;},o:function o(local){transition_out(polygon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(polygon,detaching);}};}// (15:6) {#if self.raw}
function create_if_block_1$f(ctx){var raw;var updating_data;var current;function raw_data_binding(value){/*raw_data_binding*/ctx[15](value);}var raw_props={};if(/*self*/ctx[6]!==void 0){raw_props.data=/*self*/ctx[6];}raw=new Raw({props:raw_props});binding_callbacks.push(function(){return bind$2(raw,'data',raw_data_binding);});return{c:function c(){create_component(raw.$$.fragment);},m:function m(target,anchor){mount_component(raw,target,anchor);current=true;},p:function p(ctx,dirty){var raw_changes={};if(!updating_data&&dirty&/*self*/64){updating_data=true;raw_changes.data=/*self*/ctx[6];add_flush_callback(function(){return updating_data=false;});}raw.$set(raw_changes);},i:function i(local){if(current)return;transition_in(raw.$$.fragment,local);current=true;},o:function o(local){transition_out(raw.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(raw,detaching);}};}// (3:8)      
function fallback_block$1(ctx){var if_block_anchor;var current;var if_block=/*self*/ctx[6]&&create_if_block$r(ctx);return{c:function c(){if(if_block)if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){if(/*self*/ctx[6]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*self*/64){transition_in(if_block,1);}}else{if_block=create_if_block$r(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (1:0) <Svg label={label} width={width} height={height} box={box} style={combinedStyle}   spin={spin} flip={flip} inverse={inverse} pulse={pulse} class={className}>
function create_default_slot$3(ctx){var current;var default_slot_template=/*#slots*/ctx[14]["default"];var default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[16],null);var default_slot_or_fallback=default_slot||fallback_block$1(ctx);return{c:function c(){if(default_slot_or_fallback)default_slot_or_fallback.c();},m:function m(target,anchor){if(default_slot_or_fallback){default_slot_or_fallback.m(target,anchor);}current=true;},p:function p(ctx,dirty){if(default_slot){if(default_slot.p&&(!current||dirty&/*$$scope*/65536)){update_slot_base(default_slot,default_slot_template,ctx,/*$$scope*/ctx[16],!current?get_all_dirty_from_scope(/*$$scope*/ctx[16]):get_slot_changes(default_slot_template,/*$$scope*/ctx[16],dirty,null),null);}}else{if(default_slot_or_fallback&&default_slot_or_fallback.p&&(!current||dirty&/*self*/64)){default_slot_or_fallback.p(ctx,!current?-1:dirty);}}},i:function i(local){if(current)return;transition_in(default_slot_or_fallback,local);current=true;},o:function o(local){transition_out(default_slot_or_fallback,local);current=false;},d:function d(detaching){if(default_slot_or_fallback)default_slot_or_fallback.d(detaching);}};}function create_fragment$N(ctx){var svg;var current;svg=new Svg({props:{label:/*label*/ctx[5],width:/*width*/ctx[7],height:/*height*/ctx[8],box:/*box*/ctx[10],style:/*combinedStyle*/ctx[9],spin:/*spin*/ctx[1],flip:/*flip*/ctx[4],inverse:/*inverse*/ctx[2],pulse:/*pulse*/ctx[3],"class":/*className*/ctx[0],$$slots:{"default":[create_default_slot$3]},$$scope:{ctx:ctx}}});return{c:function c(){create_component(svg.$$.fragment);},m:function m(target,anchor){mount_component(svg,target,anchor);current=true;},p:function p(ctx,_ref25){var _ref26=_slicedToArray(_ref25,1),dirty=_ref26[0];var svg_changes={};if(dirty&/*label*/32)svg_changes.label=/*label*/ctx[5];if(dirty&/*width*/128)svg_changes.width=/*width*/ctx[7];if(dirty&/*height*/256)svg_changes.height=/*height*/ctx[8];if(dirty&/*box*/1024)svg_changes.box=/*box*/ctx[10];if(dirty&/*combinedStyle*/512)svg_changes.style=/*combinedStyle*/ctx[9];if(dirty&/*spin*/2)svg_changes.spin=/*spin*/ctx[1];if(dirty&/*flip*/16)svg_changes.flip=/*flip*/ctx[4];if(dirty&/*inverse*/4)svg_changes.inverse=/*inverse*/ctx[2];if(dirty&/*pulse*/8)svg_changes.pulse=/*pulse*/ctx[3];if(dirty&/*className*/1)svg_changes["class"]=/*className*/ctx[0];if(dirty&/*$$scope, self*/65600){svg_changes.$$scope={dirty:dirty,ctx:ctx};}svg.$set(svg_changes);},i:function i(local){if(current)return;transition_in(svg.$$.fragment,local);current=true;},o:function o(local){transition_out(svg.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(svg,detaching);}};}var outerScale=1;function normaliseData(data){if('iconName'in data&&'icon'in data){var normalisedData={};var faIcon=data.icon;var _name=data.iconName;var width=faIcon[0];var height=faIcon[1];var paths=faIcon[4];var iconData={width:width,height:height,paths:[{d:paths}]};normalisedData[_name]=iconData;return normalisedData;}return data;}function instance$N($$self,$$props,$$invalidate){var _$$props$$$slots4=$$props.$$slots,slots=_$$props$$$slots4===void 0?{}:_$$props$$$slots4,$$scope=$$props.$$scope;var _$$props$class=$$props["class"],className=_$$props$class===void 0?"":_$$props$class;var data=$$props.data;var _$$props$scale=$$props.scale,scale=_$$props$scale===void 0?1:_$$props$scale;var _$$props$spin2=$$props.spin,spin=_$$props$spin2===void 0?false:_$$props$spin2;var _$$props$inverse2=$$props.inverse,inverse=_$$props$inverse2===void 0?false:_$$props$inverse2;var _$$props$pulse2=$$props.pulse,pulse=_$$props$pulse2===void 0?false:_$$props$pulse2;var _$$props$flip2=$$props.flip,flip=_$$props$flip2===void 0?null:_$$props$flip2;var _$$props$label2=$$props.label,label=_$$props$label2===void 0?null:_$$props$label2;var self=null;var _$$props$style2=$$props.style,style=_$$props$style2===void 0?null:_$$props$style2;var width;var height;var combinedStyle;var box;function init(){if(typeof data==='undefined'){return;}var normalisedData=normaliseData(data);var _Object$keys=Object.keys(normalisedData),_Object$keys2=_slicedToArray(_Object$keys,1),name=_Object$keys2[0];var icon=normalisedData[name];if(!icon.paths){icon.paths=[];}if(icon.d){icon.paths.push({d:icon.d});}if(!icon.polygons){icon.polygons=[];}if(icon.points){icon.polygons.push({points:icon.points});}$$invalidate(6,self=icon);}function normalisedScale(){var numScale=1;if(typeof scale!=='undefined'){numScale=Number(scale);}if(isNaN(numScale)||numScale<=0){// eslint-disable-line no-restricted-globals
console.warn('Invalid prop: prop "scale" should be a number over 0.');// eslint-disable-line no-console
return outerScale;}return numScale*outerScale;}function calculateBox(){if(self){return"0 0 ".concat(self.width," ").concat(self.height);}return"0 0 ".concat(width," ").concat(height);}function calculateRatio(){if(!self){return 1;}return Math.max(self.width,self.height)/16;}function calculateWidth(){if(self){return self.width/calculateRatio()*normalisedScale();}return 0;}function calculateHeight(){if(self){return self.height/calculateRatio()*normalisedScale();}return 0;}function calculateStyle(){var combined="";if(style!==null){combined+=style;}var size=normalisedScale();if(size===1){if(combined.length===0){return undefined;}return combined;}if(combined!==""&&!combined.endsWith(';')){combined+='; ';}return"".concat(combined,"font-size: ").concat(size,"em");}function raw_data_binding(value){self=value;$$invalidate(6,self);}$$self.$$set=function($$props){if('class'in $$props)$$invalidate(0,className=$$props["class"]);if('data'in $$props)$$invalidate(11,data=$$props.data);if('scale'in $$props)$$invalidate(12,scale=$$props.scale);if('spin'in $$props)$$invalidate(1,spin=$$props.spin);if('inverse'in $$props)$$invalidate(2,inverse=$$props.inverse);if('pulse'in $$props)$$invalidate(3,pulse=$$props.pulse);if('flip'in $$props)$$invalidate(4,flip=$$props.flip);if('label'in $$props)$$invalidate(5,label=$$props.label);if('style'in $$props)$$invalidate(13,style=$$props.style);if('$$scope'in $$props)$$invalidate(16,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty&/*data, style, scale*/14336){{init();$$invalidate(7,width=calculateWidth());$$invalidate(8,height=calculateHeight());$$invalidate(9,combinedStyle=calculateStyle());$$invalidate(10,box=calculateBox());}}};return[className,spin,inverse,pulse,flip,label,self,width,height,combinedStyle,box,data,scale,style,slots,raw_data_binding,$$scope];}var Icon=/*#__PURE__*/function(_SvelteComponent9){_inherits(Icon,_SvelteComponent9);var _super10=_createSuper(Icon);function Icon(options){var _this10;_classCallCheck(this,Icon);_this10=_super10.call(this);init(_assertThisInitialized(_this10),options,instance$N,create_fragment$N,safe_not_equal,{"class":0,data:11,scale:12,spin:1,inverse:2,pulse:3,flip:4,label:5,style:13});return _this10;}return _createClass(Icon);}(SvelteComponent);/* src/lib/components/controls/Message.svelte generated by Svelte v3.51.0 */function add_css$H(target){append_styles(target,"svelte-kvi5ls",".jse-message.svelte-kvi5ls.svelte-kvi5ls{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);padding:var(--jse-padding);display:flex;gap:var(--jse-padding);flex-wrap:wrap;align-items:center}.jse-message.jse-success.svelte-kvi5ls.svelte-kvi5ls{background:var(--jse-message-success-background);color:var(--jse-message-success-color)}.jse-message.svelte-kvi5ls .jse-text.svelte-kvi5ls{flex:1;min-width:60%}.jse-message.svelte-kvi5ls .jse-text.jse-clickable.svelte-kvi5ls{cursor:pointer}.jse-message.svelte-kvi5ls .jse-text.jse-clickable.svelte-kvi5ls:hover{background-color:rgba(255, 255, 255, 0.1)}.jse-message.jse-error.svelte-kvi5ls.svelte-kvi5ls{background:var(--jse-message-error-background);color:var(--jse-message-error-color)}.jse-message.jse-warning.svelte-kvi5ls.svelte-kvi5ls{background:var(--jse-message-warning-background);color:var(--jse-message-warning-color)}.jse-message.jse-info.svelte-kvi5ls.svelte-kvi5ls{background:var(--jse-message-info-background);color:var(--jse-message-info-color)}.jse-message.svelte-kvi5ls .jse-actions.svelte-kvi5ls{display:flex;gap:var(--jse-padding)}.jse-message.svelte-kvi5ls .jse-actions button.jse-action.svelte-kvi5ls{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-message-action-background);color:inherit;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding)}.jse-message.svelte-kvi5ls .jse-actions button.jse-action.svelte-kvi5ls:hover{background:var(--jse-message-action-background-highlight)}");}function get_each_context$f(ctx,list,i){var child_ctx=ctx.slice();child_ctx[8]=list[i];return child_ctx;}// (18:4) {#if icon}
function create_if_block_1$e(ctx){var icon_1;var current;icon_1=new Icon({props:{data:/*icon*/ctx[1]}});return{c:function c(){create_component(icon_1.$$.fragment);},m:function m(target,anchor){mount_component(icon_1,target,anchor);current=true;},p:function p(ctx,dirty){var icon_1_changes={};if(dirty&/*icon*/2)icon_1_changes.data=/*icon*/ctx[1];icon_1.$set(icon_1_changes);},i:function i(local){if(current)return;transition_in(icon_1.$$.fragment,local);current=true;},o:function o(local){transition_out(icon_1.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon_1,detaching);}};}// (41:8) {#if action.icon}
function create_if_block$q(ctx){var icon_1;var current;icon_1=new Icon({props:{data:/*action*/ctx[8].icon}});return{c:function c(){create_component(icon_1.$$.fragment);},m:function m(target,anchor){mount_component(icon_1,target,anchor);current=true;},p:function p(ctx,dirty){var icon_1_changes={};if(dirty&/*actions*/8)icon_1_changes.data=/*action*/ctx[8].icon;icon_1.$set(icon_1_changes);},i:function i(local){if(current)return;transition_in(icon_1.$$.fragment,local);current=true;},o:function o(local){transition_out(icon_1.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon_1,detaching);}};}// (24:4) {#each actions as action}
function create_each_block$f(ctx){var button;var t0;var t1_value=/*action*/ctx[8].text+"";var t1;var t2;var button_title_value;var button_disabled_value;var current;var mounted;var dispose;var if_block=/*action*/ctx[8].icon&&create_if_block$q(ctx);function click_handler(){return(/*click_handler*/ctx[6](/*action*/ctx[8]));}function mousedown_handler(){return(/*mousedown_handler*/ctx[7](/*action*/ctx[8]));}return{c:function c(){button=element("button");if(if_block)if_block.c();t0=space();t1=text(t1_value);t2=space();attr(button,"type","button");attr(button,"class","jse-button jse-action jse-primary svelte-kvi5ls");attr(button,"title",button_title_value=/*action*/ctx[8].title);button.disabled=button_disabled_value=/*action*/ctx[8].disabled;},m:function m(target,anchor){insert$2(target,button,anchor);if(if_block)if_block.m(button,null);append$1(button,t0);append$1(button,t1);append$1(button,t2);current=true;if(!mounted){dispose=[listen(button,"click",click_handler),listen(button,"mousedown",mousedown_handler)];mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(/*action*/ctx[8].icon){if(if_block){if_block.p(ctx,dirty);if(dirty&/*actions*/8){transition_in(if_block,1);}}else{if_block=create_if_block$q(ctx);if_block.c();transition_in(if_block,1);if_block.m(button,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}if((!current||dirty&/*actions*/8)&&t1_value!==(t1_value=/*action*/ctx[8].text+""))set_data(t1,t1_value);if(!current||dirty&/*actions*/8&&button_title_value!==(button_title_value=/*action*/ctx[8].title)){attr(button,"title",button_title_value);}if(!current||dirty&/*actions*/8&&button_disabled_value!==(button_disabled_value=/*action*/ctx[8].disabled)){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(button);if(if_block)if_block.d();mounted=false;run_all(dispose);}};}function create_fragment$M(ctx){var div2;var div0;var t0;var t1;var t2;var div1;var div2_class_value;var current;var mounted;var dispose;var if_block=/*icon*/ctx[1]&&create_if_block_1$e(ctx);var each_value=/*actions*/ctx[3];var each_blocks=[];for(var _i33=0;_i33<each_value.length;_i33+=1){each_blocks[_i33]=create_each_block$f(get_each_context$f(ctx,each_value,_i33));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){div2=element("div");div0=element("div");if(if_block)if_block.c();t0=space();t1=text(/*message*/ctx[2]);t2=space();div1=element("div");for(var _i34=0;_i34<each_blocks.length;_i34+=1){each_blocks[_i34].c();}attr(div0,"class","jse-text svelte-kvi5ls");toggle_class(div0,"jse-clickable",/*onClick*/ctx[4]!==null);attr(div1,"class","jse-actions svelte-kvi5ls");attr(div2,"class",div2_class_value="jse-message jse-"+/*type*/ctx[0]+" svelte-kvi5ls");},m:function m(target,anchor){insert$2(target,div2,anchor);append$1(div2,div0);if(if_block)if_block.m(div0,null);append$1(div0,t0);append$1(div0,t1);append$1(div2,t2);append$1(div2,div1);for(var _i35=0;_i35<each_blocks.length;_i35+=1){each_blocks[_i35].m(div1,null);}current=true;if(!mounted){dispose=listen(div0,"click",/*handleClick*/ctx[5]);mounted=true;}},p:function p(ctx,_ref27){var _ref28=_slicedToArray(_ref27,1),dirty=_ref28[0];if(/*icon*/ctx[1]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*icon*/2){transition_in(if_block,1);}}else{if_block=create_if_block_1$e(ctx);if_block.c();transition_in(if_block,1);if_block.m(div0,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}if(!current||dirty&/*message*/4)set_data(t1,/*message*/ctx[2]);if(!current||dirty&/*onClick*/16){toggle_class(div0,"jse-clickable",/*onClick*/ctx[4]!==null);}if(dirty&/*actions*/8){each_value=/*actions*/ctx[3];var _i36;for(_i36=0;_i36<each_value.length;_i36+=1){var child_ctx=get_each_context$f(ctx,each_value,_i36);if(each_blocks[_i36]){each_blocks[_i36].p(child_ctx,dirty);transition_in(each_blocks[_i36],1);}else{each_blocks[_i36]=create_each_block$f(child_ctx);each_blocks[_i36].c();transition_in(each_blocks[_i36],1);each_blocks[_i36].m(div1,null);}}group_outros();for(_i36=each_value.length;_i36<each_blocks.length;_i36+=1){out(_i36);}check_outros();}if(!current||dirty&/*type*/1&&div2_class_value!==(div2_class_value="jse-message jse-"+/*type*/ctx[0]+" svelte-kvi5ls")){attr(div2,"class",div2_class_value);}},i:function i(local){if(current)return;transition_in(if_block);for(var _i37=0;_i37<each_value.length;_i37+=1){transition_in(each_blocks[_i37]);}current=true;},o:function o(local){transition_out(if_block);each_blocks=each_blocks.filter(Boolean);for(var _i38=0;_i38<each_blocks.length;_i38+=1){transition_out(each_blocks[_i38]);}current=false;},d:function d(detaching){if(detaching)detach(div2);if(if_block)if_block.d();destroy_each(each_blocks,detaching);mounted=false;dispose();}};}function instance$M($$self,$$props,$$invalidate){var _$$props$type=$$props.type,type=_$$props$type===void 0?'success':_$$props$type;var _$$props$icon=$$props.icon,icon=_$$props$icon===void 0?undefined:_$$props$icon;var _$$props$message=$$props.message,message=_$$props$message===void 0?undefined:_$$props$message;var _$$props$actions=$$props.actions,actions=_$$props$actions===void 0?[]:_$$props$actions;var _$$props$onClick=$$props.onClick,onClick=_$$props$onClick===void 0?undefined:_$$props$onClick;function handleClick(){if(onClick){onClick();}}var click_handler=function click_handler(action){if(action.onClick){action.onClick();}};var mousedown_handler=function mousedown_handler(action){if(action.onMouseDown){action.onMouseDown();}};$$self.$$set=function($$props){if('type'in $$props)$$invalidate(0,type=$$props.type);if('icon'in $$props)$$invalidate(1,icon=$$props.icon);if('message'in $$props)$$invalidate(2,message=$$props.message);if('actions'in $$props)$$invalidate(3,actions=$$props.actions);if('onClick'in $$props)$$invalidate(4,onClick=$$props.onClick);};return[type,icon,message,actions,onClick,handleClick,click_handler,mousedown_handler];}var Message=/*#__PURE__*/function(_SvelteComponent10){_inherits(Message,_SvelteComponent10);var _super11=_createSuper(Message);function Message(options){var _this11;_classCallCheck(this,Message);_this11=_super11.call(this);init(_assertThisInitialized(_this11),options,instance$M,create_fragment$M,not_equal,{type:0,icon:1,message:2,actions:3,onClick:4},add_css$H);return _this11;}return _createClass(Message);}(SvelteComponent);var Message$1=Message;/**
 * Stringify a path like:
 *
 *     ["data", "2", "nested property", "name"]
 *
 * into a JSON path string like:
 *
 *     "$.data[2]['nested property'].name"
 */function stringifyJSONPath(path){return'$'+path.map(stringifyJSONPathProp).join('');}/**
 * Stringify a single property of a JSON path. See also stringifyJSONPath
 */function stringifyJSONPathProp(prop){if(integerNumberRegex.test(prop)){return'['+prop+']';}else if(javaScriptPropertyRegex.test(prop)){return'.'+prop;}else{var propStr=JSON.stringify(prop);// remove enclosing double quotes, and unescape escaped double qoutes \"
var jsonPathStr=propStr.substring(1,propStr.length-1).replace(/\\"/g,'"');return"['"+jsonPathStr+"']";}}/**
 * Strip the leading '$' and '.' from a JSONPath, for example:
 *
 *   "$.data[2].nested.property"
 *
 * will be changed into:
 *
 *   "data[2].nested.property"
 *
 * See also prependRootObject
 */function stripRootObject(path){return path.replace(/^\$/,'')// remove any leading $ character
.replace(/^\./,'');// remove any leading dot
}/**
 * Add $ and . at the start of a JSON path when missing
 * This is the opposite of stripRootObject
 */function prependRootObject(path){if(path.startsWith('$')){return path;}return!path.startsWith('[')&&!path.startsWith('.')?'$.'+path:'$'+path;}/**
 * Parse a string into a JSONPath. For example the input:
 *
 *   "$.data[2]['nested property'].name"
 *
 * will return:
 *
 *   ["data", "2", "nested property", "name"]
 *
 */function parseJSONPath(path){var remainder=prependRootObject(path.trim()).substring(1);// strip the leading $
var jsonPath=[];while(remainder.length>0){var match=remainder.match(regexJsonPathProp);if(!match){throw new SyntaxError("Cannot parse path: unexpected part \"".concat(remainder,"\" at position ").concat(path.length-remainder.length));}jsonPath.push(match[1]||match[2]||match[3]);remainder=remainder.substring(match[0].length);}return jsonPath;}var regexJsonPathDotProp='^\\.([A-zA-Z$_][a-zA-Z$_0-9]*)';// matches ".foo" at the start
var regexJsonPathArrayIndex='^\\[([0-9]+)]';// matches "[123]" at the start
var regexJsonPathArrayProp="^\\['(.*)']";// matches "['foo-bar baz']" at the start
var regexJsonPathProp=new RegExp([regexJsonPathDotProp,regexJsonPathArrayIndex,regexJsonPathArrayProp].join('|'));/**
 * Convert a JSONPath into an option for use in a select box
 */function pathToOption(path){return{value:path,label:isEmpty(path)?'(whole item)':stripRootObject(stringifyJSONPath(path))};}/**
 * Stringify a JSON path into a lodash path like:
 *
 *     "data[2].nested.name"
 *
 * or
 *
 *     ["data", 2, "nested property", "name"]
 */function createLodashPropertySelector(path){return path.every(function(prop){return integerNumberRegex.test(prop)||javaScriptPropertyRegex.test(prop);})?"'"+path.map(stringifyJSONPathProp).join('').replace(/^\./,'')+"'":JSON.stringify(path);}/**
 * Create a JavaScript property selector
 *
 * Turn a paths like:
 *
 *   ['location', 'latitude']
 *   ['address', 'full name']
 *
 * into a JavaScript selector (string) like:
 *
 *   '?.location?.latitude'
 *   '?.address?.["full name"]'
 */function createPropertySelector(path){return path.map(function(prop){if(integerNumberRegex.test(prop)){// an index
return"?.[".concat(prop,"]");}else if(javaScriptPropertyRegex.test(prop)){// a key without special characters
return"?.".concat(prop);}else{// a key that may have special characters (like spaces or so)
return"?.[".concat(JSON.stringify(prop),"]");}}).join('');}// https://developer.mozilla.org/en-US/docs/Glossary/Identifier
// Note: We can extend this regex to allow unicode characters too.
// I'm too lazy to figure that out right now
var javaScriptPropertyRegex=/^[a-zA-Z$_][a-zA-Z$_\d]*$/;var integerNumberRegex=/^\d+$/;/**
 * Create a memoized function that will memoize the input path, and return
 * the memoized instance of the path when the stringified version is the same.
 */function createMemoizePath(){return memoize(function(path){return path;},stringifyJSONPath);}/* src/lib/components/controls/ValidationErrorsOverview.svelte generated by Svelte v3.51.0 */function add_css$G(target){append_styles(target,"svelte-1oe8e8r",".jse-validation-errors-overview.svelte-1oe8e8r.svelte-1oe8e8r{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-message-warning-background);color:var(--jse-message-warning-color);overflow:auto;max-height:25%}.jse-validation-errors-overview.svelte-1oe8e8r table.svelte-1oe8e8r{border-collapse:collapse;width:100%}.jse-validation-errors-overview.svelte-1oe8e8r table tr.svelte-1oe8e8r{cursor:pointer}.jse-validation-errors-overview.svelte-1oe8e8r table tr.svelte-1oe8e8r:hover{background-color:rgba(255, 255, 255, 0.1)}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.svelte-1oe8e8r{padding:4px var(--jse-padding);vertical-align:middle}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-icon.svelte-1oe8e8r{width:36px;box-sizing:border-box}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action.svelte-1oe8e8r{width:36px;box-sizing:border-box;padding:0}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action button.jse-validation-errors-collapse.svelte-1oe8e8r{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:36px;height:26px;cursor:pointer}.jse-validation-errors-overview.svelte-1oe8e8r table tr td.jse-validation-error-action button.jse-validation-errors-collapse.svelte-1oe8e8r:hover{background-color:rgba(255, 255, 255, 0.2)}.jse-validation-errors-overview.svelte-1oe8e8r table tr td div.jse-validation-errors-expand.svelte-1oe8e8r{display:inline-block;position:relative;top:3px}");}function get_each_context$e(ctx,list,i){var child_ctx=ctx.slice();child_ctx[6]=list[i];child_ctx[8]=i;return child_ctx;}// (19:0) {#if !isEmpty(validationErrors)}
function create_if_block$p(ctx){var div;var current_block_type_index;var if_block;var current;var if_block_creators=[create_if_block_1$d,create_else_block$f];var if_blocks=[];function select_block_type(ctx,dirty){if(/*expanded*/ctx[2]||/*validationErrors*/ctx[0].length===1)return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if_block.c();attr(div,"class","jse-validation-errors-overview svelte-1oe8e8r");},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,null);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();}};}// (57:4) {:else}
function create_else_block$f(ctx){var table;var tbody;var tr;var td0;var icon0;var t0;var td1;var t1_value=/*validationErrors*/ctx[0].length+"";var t1;var t2;var div;var icon1;var current;var mounted;var dispose;icon0=new Icon({props:{data:faExclamationTriangle}});icon1=new Icon({props:{data:faAngleRight}});return{c:function c(){table=element("table");tbody=element("tbody");tr=element("tr");td0=element("td");create_component(icon0.$$.fragment);t0=space();td1=element("td");t1=text(t1_value);t2=text(" validation errors\n              ");div=element("div");create_component(icon1.$$.fragment);attr(td0,"class","jse-validation-error-icon svelte-1oe8e8r");attr(div,"class","jse-validation-errors-expand svelte-1oe8e8r");attr(td1,"class","svelte-1oe8e8r");attr(tr,"class","jse-validation-error svelte-1oe8e8r");attr(table,"class","svelte-1oe8e8r");},m:function m(target,anchor){insert$2(target,table,anchor);append$1(table,tbody);append$1(tbody,tr);append$1(tr,td0);mount_component(icon0,td0,null);append$1(tr,t0);append$1(tr,td1);append$1(td1,t1);append$1(td1,t2);append$1(td1,div);mount_component(icon1,div,null);current=true;if(!mounted){dispose=listen(tr,"click",/*expand*/ctx[4]);mounted=true;}},p:function p(ctx,dirty){if((!current||dirty&/*validationErrors*/1)&&t1_value!==(t1_value=/*validationErrors*/ctx[0].length+""))set_data(t1,t1_value);},i:function i(local){if(current)return;transition_in(icon0.$$.fragment,local);transition_in(icon1.$$.fragment,local);current=true;},o:function o(local){transition_out(icon0.$$.fragment,local);transition_out(icon1.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(table);destroy_component(icon0);destroy_component(icon1);mounted=false;dispose();}};}// (21:4) {#if expanded || validationErrors.length === 1}
function create_if_block_1$d(ctx){var table;var tbody;var current;var each_value=/*validationErrors*/ctx[0];var each_blocks=[];for(var _i39=0;_i39<each_value.length;_i39+=1){each_blocks[_i39]=create_each_block$e(get_each_context$e(ctx,each_value,_i39));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){table=element("table");tbody=element("tbody");for(var _i40=0;_i40<each_blocks.length;_i40+=1){each_blocks[_i40].c();}attr(table,"class","svelte-1oe8e8r");},m:function m(target,anchor){insert$2(target,table,anchor);append$1(table,tbody);for(var _i41=0;_i41<each_blocks.length;_i41+=1){each_blocks[_i41].m(tbody,null);}current=true;},p:function p(ctx,dirty){if(dirty&/*setTimeout, selectError, validationErrors, collapse, faAngleDown, stripRootObject, stringifyJSONPath, faExclamationTriangle*/11){each_value=/*validationErrors*/ctx[0];var _i42;for(_i42=0;_i42<each_value.length;_i42+=1){var child_ctx=get_each_context$e(ctx,each_value,_i42);if(each_blocks[_i42]){each_blocks[_i42].p(child_ctx,dirty);transition_in(each_blocks[_i42],1);}else{each_blocks[_i42]=create_each_block$e(child_ctx);each_blocks[_i42].c();transition_in(each_blocks[_i42],1);each_blocks[_i42].m(tbody,null);}}group_outros();for(_i42=each_value.length;_i42<each_blocks.length;_i42+=1){out(_i42);}check_outros();}},i:function i(local){if(current)return;for(var _i43=0;_i43<each_value.length;_i43+=1){transition_in(each_blocks[_i43]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i44=0;_i44<each_blocks.length;_i44+=1){transition_out(each_blocks[_i44]);}current=false;},d:function d(detaching){if(detaching)detach(table);destroy_each(each_blocks,detaching);}};}// (42:16) {#if index === 0 && validationErrors.length > 1}
function create_if_block_2$a(ctx){var button;var icon;var current;var mounted;var dispose;icon=new Icon({props:{data:faAngleDown}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-validation-errors-collapse svelte-1oe8e8r");attr(button,"title","Collapse validation errors");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);current=true;if(!mounted){dispose=listen(button,"click",stop_propagation(/*collapse*/ctx[3]));mounted=true;}},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (24:10) {#each validationErrors as validationError, index}
function create_each_block$e(ctx){var tr;var td0;var icon;var t0;var td1;var t1_value=stripRootObject(stringifyJSONPath(/*validationError*/ctx[6].path))+"";var t1;var t2;var td2;var t3_value=/*validationError*/ctx[6].message+"";var t3;var t4;var td3;var t5;var current;var mounted;var dispose;icon=new Icon({props:{data:faExclamationTriangle}});var if_block=/*index*/ctx[8]===0&&/*validationErrors*/ctx[0].length>1&&create_if_block_2$a(ctx);function click_handler(){return(/*click_handler*/ctx[5](/*validationError*/ctx[6]));}return{c:function c(){tr=element("tr");td0=element("td");create_component(icon.$$.fragment);t0=space();td1=element("td");t1=text(t1_value);t2=space();td2=element("td");t3=text(t3_value);t4=space();td3=element("td");if(if_block)if_block.c();t5=space();attr(td0,"class","jse-validation-error-icon svelte-1oe8e8r");attr(td1,"class","svelte-1oe8e8r");attr(td2,"class","svelte-1oe8e8r");attr(td3,"class","jse-validation-error-action svelte-1oe8e8r");attr(tr,"class","jse-validation-error svelte-1oe8e8r");},m:function m(target,anchor){insert$2(target,tr,anchor);append$1(tr,td0);mount_component(icon,td0,null);append$1(tr,t0);append$1(tr,td1);append$1(td1,t1);append$1(tr,t2);append$1(tr,td2);append$1(td2,t3);append$1(tr,t4);append$1(tr,td3);if(if_block)if_block.m(td3,null);append$1(tr,t5);current=true;if(!mounted){dispose=listen(tr,"click",click_handler);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if((!current||dirty&/*validationErrors*/1)&&t1_value!==(t1_value=stripRootObject(stringifyJSONPath(/*validationError*/ctx[6].path))+""))set_data(t1,t1_value);if((!current||dirty&/*validationErrors*/1)&&t3_value!==(t3_value=/*validationError*/ctx[6].message+""))set_data(t3,t3_value);if(/*index*/ctx[8]===0&&/*validationErrors*/ctx[0].length>1){if(if_block){if_block.p(ctx,dirty);if(dirty&/*validationErrors*/1){transition_in(if_block,1);}}else{if_block=create_if_block_2$a(ctx);if_block.c();transition_in(if_block,1);if_block.m(td3,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);transition_in(if_block);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(tr);destroy_component(icon);if(if_block)if_block.d();mounted=false;dispose();}};}function create_fragment$L(ctx){var show_if=!isEmpty(/*validationErrors*/ctx[0]);var if_block_anchor;var current;var if_block=show_if&&create_if_block$p(ctx);return{c:function c(){if(if_block)if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,_ref29){var _ref30=_slicedToArray(_ref29,1),dirty=_ref30[0];if(dirty&/*validationErrors*/1)show_if=!isEmpty(/*validationErrors*/ctx[0]);if(show_if){if(if_block){if_block.p(ctx,dirty);if(dirty&/*validationErrors*/1){transition_in(if_block,1);}}else{if_block=create_if_block$p(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}function instance$L($$self,$$props,$$invalidate){var validationErrors=$$props.validationErrors;var selectError=$$props.selectError;var expanded=true;function collapse(){$$invalidate(2,expanded=false);}function expand(){$$invalidate(2,expanded=true);}var click_handler=function click_handler(validationError){// trigger on the next tick to prevent the editor not getting focus
setTimeout(function(){return selectError(validationError);});};$$self.$$set=function($$props){if('validationErrors'in $$props)$$invalidate(0,validationErrors=$$props.validationErrors);if('selectError'in $$props)$$invalidate(1,selectError=$$props.selectError);};return[validationErrors,selectError,expanded,collapse,expand,click_handler];}var ValidationErrorsOverview=/*#__PURE__*/function(_SvelteComponent11){_inherits(ValidationErrorsOverview,_SvelteComponent11);var _super12=_createSuper(ValidationErrorsOverview);function ValidationErrorsOverview(options){var _this12;_classCallCheck(this,ValidationErrorsOverview);_this12=_super12.call(this);init(_assertThisInitialized(_this12),options,instance$L,create_fragment$L,not_equal,{validationErrors:0,selectError:1},add_css$G);return _this12;}return _createClass(ValidationErrorsOverview);}(SvelteComponent);var ValidationErrorsOverview$1=ValidationErrorsOverview;var faJSONEditorExpand={prefix:'fas',iconName:'jsoneditor-expand',icon:[512,512,[],null,'M 0,448 V 512 h 512 v -64 z '+'M 0,0 V 64 H 512 V 0 Z '+'M 256,96 128,224 h 256 z '+'M 256,416 384,288 H 128 Z']};var faJSONEditorCollapse={prefix:'fas',iconName:'jsoneditor-collapse',icon:[512,512,[],null,'m 0,224 v 64 h 512 v -64 z '+'M 256,192 384,64 H 128 Z '+'M 256,320 128,448 h 256 z']};var faJSONEditorFormat={prefix:'fas',iconName:'jsoneditor-format',icon:[512,512,[],null,'M 0,32 v 64 h 416 v -64 z '+'M 160,160 v 64 h 352 v -64 z '+'M 160,288 v 64 h 288 v -64 z '+'M 0,416 v 64 h 320 v -64 z']};var faJSONEditorCompact={prefix:'fas',iconName:'jsoneditor-compact',icon:[512,512,[],null,'M 0,32 v 64 h 512 v -64 z '+'M 0,160 v 64 h 512 v -64 z '+'M 0,288 v 64 h 352 v -64 z']};/* src/lib/components/controls/Menu.svelte generated by Svelte v3.51.0 */function add_css$F(target){append_styles(target,"svelte-v4jelk",".jse-menu.svelte-v4jelk.svelte-v4jelk{background:var(--jse-theme-color);border-bottom:1px solid var(--jse-theme-color);color:var(--jse-menu-color);display:flex;flex-wrap:wrap;align-items:center;position:relative}.jse-menu.svelte-v4jelk .jse-button.svelte-v4jelk{width:var(--jse-menu-button-size);height:var(--jse-menu-button-size);border:none;background:transparent;color:inherit;cursor:pointer;padding:calc(0.5 * var(--jse-padding));margin:0;border-radius:0}.jse-menu.svelte-v4jelk .jse-button.svelte-v4jelk:hover,.jse-menu.svelte-v4jelk .jse-button.svelte-v4jelk:focus{background:var(--jse-theme-color-highlight)}.jse-menu.svelte-v4jelk .jse-button.svelte-v4jelk:disabled{color:var(--jse-menu-color);opacity:0.5;background:transparent}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.svelte-v4jelk{border:1px solid var(--jse-menu-color);padding:0;margin:calc(0.5 * var(--jse-padding)) 0;height:calc(var(--jse-menu-button-size) - var(--jse-padding));width:40px}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.svelte-v4jelk:not(.jse-last){border-right:none}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.jse-first.svelte-v4jelk{margin-left:calc(0.5 * var(--jse-padding))}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.jse-last.svelte-v4jelk{margin-right:calc(0.5 * var(--jse-padding))}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.svelte-v4jelk:hover,.jse-menu.svelte-v4jelk .jse-button.jse-group-button.svelte-v4jelk:focus{background:var(--jse-theme-color-highlight)}.jse-menu.svelte-v4jelk .jse-button.jse-group-button.jse-selected.svelte-v4jelk{background:var(--jse-menu-color);color:var(--jse-theme-color)}.jse-menu.svelte-v4jelk .jse-space.svelte-v4jelk{flex:1}.jse-menu.svelte-v4jelk .jse-separator.svelte-v4jelk{background:var(--jse-menu-color);opacity:0.3;box-sizing:border-box;width:1px;height:calc(var(--jse-menu-button-size) - 6px);margin:3px}");}var get_right_slot_changes=function get_right_slot_changes(dirty){return{};};var get_right_slot_context=function get_right_slot_context(ctx){return{};};function get_each_context$d(ctx,list,i){var child_ctx=ctx.slice();child_ctx[3]=list[i];return child_ctx;}var get_left_slot_changes=function get_left_slot_changes(dirty){return{};};var get_left_slot_context=function get_left_slot_context(ctx){return{};};// (15:4) {:else}
function create_else_block$e(ctx){var button;var t;var button_class_value;var button_title_value;var button_disabled_value;var current;var mounted;var dispose;var if_block0=/*item*/ctx[3].icon&&create_if_block_3$6(ctx);var if_block1=/*item*/ctx[3].text&&create_if_block_2$9(ctx);return{c:function c(){button=element("button");if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();attr(button,"type","button");attr(button,"class",button_class_value="jse-button "+/*item*/ctx[3].className+" svelte-v4jelk");attr(button,"title",button_title_value=/*item*/ctx[3].title);button.disabled=button_disabled_value=/*item*/ctx[3].disabled||false;},m:function m(target,anchor){insert$2(target,button,anchor);if(if_block0)if_block0.m(button,null);append$1(button,t);if(if_block1)if_block1.m(button,null);current=true;if(!mounted){dispose=listen(button,"click",function(){if(is_function(/*item*/ctx[3].onClick))/*item*/ctx[3].onClick.apply(this,arguments);});mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(/*item*/ctx[3].icon){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*items*/1){transition_in(if_block0,1);}}else{if_block0=create_if_block_3$6(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(button,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(/*item*/ctx[3].text){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_2$9(ctx);if_block1.c();if_block1.m(button,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty&/*items*/1&&button_class_value!==(button_class_value="jse-button "+/*item*/ctx[3].className+" svelte-v4jelk")){attr(button,"class",button_class_value);}if(!current||dirty&/*items*/1&&button_title_value!==(button_title_value=/*item*/ctx[3].title)){attr(button,"title",button_title_value);}if(!current||dirty&/*items*/1&&button_disabled_value!==(button_disabled_value=/*item*/ctx[3].disabled||false)){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(if_block0);current=true;},o:function o(local){transition_out(if_block0);current=false;},d:function d(detaching){if(detaching)detach(button);if(if_block0)if_block0.d();if(if_block1)if_block1.d();mounted=false;dispose();}};}// (13:34) 
function create_if_block_1$c(ctx){var div;return{c:function c(){div=element("div");attr(div,"class","jse-space svelte-v4jelk");},m:function m(target,anchor){insert$2(target,div,anchor);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (11:4) {#if item.separator === true}
function create_if_block$o(ctx){var div;return{c:function c(){div=element("div");attr(div,"class","jse-separator svelte-v4jelk");},m:function m(target,anchor){insert$2(target,div,anchor);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (23:8) {#if item.icon}
function create_if_block_3$6(ctx){var icon;var current;icon=new Icon({props:{data:/*item*/ctx[3].icon}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:function p(ctx,dirty){var icon_changes={};if(dirty&/*items*/1)icon_changes.data=/*item*/ctx[3].icon;icon.$set(icon_changes);},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (26:8) {#if item.text}
function create_if_block_2$9(ctx){var t_value=/*item*/ctx[3].text+"";var t;return{c:function c(){t=text(t_value);},m:function m(target,anchor){insert$2(target,t,anchor);},p:function p(ctx,dirty){if(dirty&/*items*/1&&t_value!==(t_value=/*item*/ctx[3].text+""))set_data(t,t_value);},d:function d(detaching){if(detaching)detach(t);}};}// (10:2) {#each items as item}
function create_each_block$d(ctx){var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block$o,create_if_block_1$c,create_else_block$e];var if_blocks=[];function select_block_type(ctx,dirty){if(/*item*/ctx[3].separator===true)return 0;if(/*item*/ctx[3].space===true)return 1;return 2;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}function create_fragment$K(ctx){var div;var t0;var t1;var current;var left_slot_template=/*#slots*/ctx[2].left;var left_slot=create_slot(left_slot_template,ctx,/*$$scope*/ctx[1],get_left_slot_context);var each_value=/*items*/ctx[0];var each_blocks=[];for(var _i45=0;_i45<each_value.length;_i45+=1){each_blocks[_i45]=create_each_block$d(get_each_context$d(ctx,each_value,_i45));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};var right_slot_template=/*#slots*/ctx[2].right;var right_slot=create_slot(right_slot_template,ctx,/*$$scope*/ctx[1],get_right_slot_context);return{c:function c(){div=element("div");if(left_slot)left_slot.c();t0=space();for(var _i46=0;_i46<each_blocks.length;_i46+=1){each_blocks[_i46].c();}t1=space();if(right_slot)right_slot.c();attr(div,"class","jse-menu svelte-v4jelk");},m:function m(target,anchor){insert$2(target,div,anchor);if(left_slot){left_slot.m(div,null);}append$1(div,t0);for(var _i47=0;_i47<each_blocks.length;_i47+=1){each_blocks[_i47].m(div,null);}append$1(div,t1);if(right_slot){right_slot.m(div,null);}current=true;},p:function p(ctx,_ref31){var _ref32=_slicedToArray(_ref31,1),dirty=_ref32[0];if(left_slot){if(left_slot.p&&(!current||dirty&/*$$scope*/2)){update_slot_base(left_slot,left_slot_template,ctx,/*$$scope*/ctx[1],!current?get_all_dirty_from_scope(/*$$scope*/ctx[1]):get_slot_changes(left_slot_template,/*$$scope*/ctx[1],dirty,get_left_slot_changes),get_left_slot_context);}}if(dirty&/*items*/1){each_value=/*items*/ctx[0];var _i48;for(_i48=0;_i48<each_value.length;_i48+=1){var child_ctx=get_each_context$d(ctx,each_value,_i48);if(each_blocks[_i48]){each_blocks[_i48].p(child_ctx,dirty);transition_in(each_blocks[_i48],1);}else{each_blocks[_i48]=create_each_block$d(child_ctx);each_blocks[_i48].c();transition_in(each_blocks[_i48],1);each_blocks[_i48].m(div,t1);}}group_outros();for(_i48=each_value.length;_i48<each_blocks.length;_i48+=1){out(_i48);}check_outros();}if(right_slot){if(right_slot.p&&(!current||dirty&/*$$scope*/2)){update_slot_base(right_slot,right_slot_template,ctx,/*$$scope*/ctx[1],!current?get_all_dirty_from_scope(/*$$scope*/ctx[1]):get_slot_changes(right_slot_template,/*$$scope*/ctx[1],dirty,get_right_slot_changes),get_right_slot_context);}}},i:function i(local){if(current)return;transition_in(left_slot,local);for(var _i49=0;_i49<each_value.length;_i49+=1){transition_in(each_blocks[_i49]);}transition_in(right_slot,local);current=true;},o:function o(local){transition_out(left_slot,local);each_blocks=each_blocks.filter(Boolean);for(var _i50=0;_i50<each_blocks.length;_i50+=1){transition_out(each_blocks[_i50]);}transition_out(right_slot,local);current=false;},d:function d(detaching){if(detaching)detach(div);if(left_slot)left_slot.d(detaching);destroy_each(each_blocks,detaching);if(right_slot)right_slot.d(detaching);}};}function instance$K($$self,$$props,$$invalidate){var _$$props$$$slots5=$$props.$$slots,slots=_$$props$$$slots5===void 0?{}:_$$props$$$slots5,$$scope=$$props.$$scope;var _$$props$items=$$props.items,items=_$$props$items===void 0?[]:_$$props$items;$$self.$$set=function($$props){if('items'in $$props)$$invalidate(0,items=$$props.items);if('$$scope'in $$props)$$invalidate(1,$$scope=$$props.$$scope);};return[items,$$scope,slots];}var Menu=/*#__PURE__*/function(_SvelteComponent12){_inherits(Menu,_SvelteComponent12);var _super13=_createSuper(Menu);function Menu(options){var _this13;_classCallCheck(this,Menu);_this13=_super13.call(this);init(_assertThisInitialized(_this13),options,instance$K,create_fragment$K,not_equal,{items:0},add_css$F);return _this13;}return _createClass(Menu);}(SvelteComponent);var Menu$1=Menu;/* src/lib/components/modes/textmode/menu/TextMenu.svelte generated by Svelte v3.51.0 */function create_fragment$J(ctx){var menu;var current;menu=new Menu$1({props:{items:/*items*/ctx[0]}});return{c:function c(){create_component(menu.$$.fragment);},m:function m(target,anchor){mount_component(menu,target,anchor);current=true;},p:function p(ctx,_ref33){var _ref34=_slicedToArray(_ref33,1),dirty=_ref34[0];var menu_changes={};if(dirty&/*items*/1)menu_changes.items=/*items*/ctx[0];menu.$set(menu_changes);},i:function i(local){if(current)return;transition_in(menu.$$.fragment,local);current=true;},o:function o(local){transition_out(menu.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(menu,detaching);}};}function instance$J($$self,$$props,$$invalidate){var defaultItems;var items;var _$$props$readOnly=$$props.readOnly,readOnly=_$$props$readOnly===void 0?false:_$$props$readOnly;var onFormat=$$props.onFormat;var onCompact=$$props.onCompact;var onSort=$$props.onSort;var onTransform=$$props.onTransform;var onToggleSearch=$$props.onToggleSearch;var onUndo=$$props.onUndo;var onRedo=$$props.onRedo;var canUndo=$$props.canUndo;var canRedo=$$props.canRedo;var canFormat=$$props.canFormat;var canCompact=$$props.canCompact;var canSort=$$props.canSort;var canTransform=$$props.canTransform;var _$$props$onRenderMenu=$$props.onRenderMenu,onRenderMenu=_$$props$onRenderMenu===void 0?noop:_$$props$onRenderMenu;$$self.$$set=function($$props){if('readOnly'in $$props)$$invalidate(1,readOnly=$$props.readOnly);if('onFormat'in $$props)$$invalidate(2,onFormat=$$props.onFormat);if('onCompact'in $$props)$$invalidate(3,onCompact=$$props.onCompact);if('onSort'in $$props)$$invalidate(4,onSort=$$props.onSort);if('onTransform'in $$props)$$invalidate(5,onTransform=$$props.onTransform);if('onToggleSearch'in $$props)$$invalidate(6,onToggleSearch=$$props.onToggleSearch);if('onUndo'in $$props)$$invalidate(7,onUndo=$$props.onUndo);if('onRedo'in $$props)$$invalidate(8,onRedo=$$props.onRedo);if('canUndo'in $$props)$$invalidate(9,canUndo=$$props.canUndo);if('canRedo'in $$props)$$invalidate(10,canRedo=$$props.canRedo);if('canFormat'in $$props)$$invalidate(11,canFormat=$$props.canFormat);if('canCompact'in $$props)$$invalidate(12,canCompact=$$props.canCompact);if('canSort'in $$props)$$invalidate(13,canSort=$$props.canSort);if('canTransform'in $$props)$$invalidate(14,canTransform=$$props.canTransform);if('onRenderMenu'in $$props)$$invalidate(15,onRenderMenu=$$props.onRenderMenu);};$$self.$$.update=function(){if($$self.$$.dirty&/*readOnly, onFormat, canFormat, onCompact, canCompact, onSort, canSort, onTransform, canTransform, onToggleSearch, onUndo, canUndo, onRedo, canRedo*/32766){/* @type {MenuItem[]} */$$invalidate(16,defaultItems=!readOnly?[{icon:faJSONEditorFormat,title:'Format JSON: add proper indentation and new lines (Ctrl+I)',className:'jse-format',onClick:onFormat,disabled:readOnly||!canFormat},{icon:faJSONEditorCompact,title:'Compact JSON: remove all white spacing and new lines (Ctrl+Shift+I)',className:'jse-compact',onClick:onCompact,disabled:readOnly||!canCompact},{separator:true},{icon:faSortAmountDownAlt,title:'Sort',className:'jse-sort',onClick:onSort,disabled:readOnly||!canSort},{icon:faFilter,title:'Transform contents (filter, sort, project)',className:'jse-transform',onClick:onTransform,disabled:readOnly||!canTransform},{icon:faSearch,title:'Search (Ctrl+F)',className:'jse-search',onClick:onToggleSearch},{separator:true},{icon:faUndo,title:'Undo (Ctrl+Z)',className:'jse-undo',onClick:onUndo,disabled:!canUndo},{icon:faRedo,title:'Redo (Ctrl+Shift+Z)',className:'jse-redo',onClick:onRedo,disabled:!canRedo},{space:true}]:[{space:true}]);}if($$self.$$.dirty&/*onRenderMenu, defaultItems*/98304){$$invalidate(0,items=onRenderMenu('text',defaultItems)||defaultItems);}};return[items,readOnly,onFormat,onCompact,onSort,onTransform,onToggleSearch,onUndo,onRedo,canUndo,canRedo,canFormat,canCompact,canSort,canTransform,onRenderMenu,defaultItems];}var TextMenu=/*#__PURE__*/function(_SvelteComponent13){_inherits(TextMenu,_SvelteComponent13);var _super14=_createSuper(TextMenu);function TextMenu(options){var _this14;_classCallCheck(this,TextMenu);_this14=_super14.call(this);init(_assertThisInitialized(_this14),options,instance$J,create_fragment$J,not_equal,{readOnly:1,onFormat:2,onCompact:3,onSort:4,onTransform:5,onToggleSearch:6,onUndo:7,onRedo:8,canUndo:9,canRedo:10,canFormat:11,canCompact:12,canSort:13,canTransform:14,onRenderMenu:15});return _this14;}return _createClass(TextMenu);}(SvelteComponent);var TextMenu$1=TextMenu;/**
The data structure for documents. @nonabstract
*/var Text=/*#__PURE__*/function(){/**
    @internal
    */function Text(){_classCallCheck(this,Text);}/**
    Get the line description around the given position.
    */_createClass(Text,[{key:"lineAt",value:function lineAt(pos){if(pos<0||pos>this.length)throw new RangeError("Invalid position ".concat(pos," in document of length ").concat(this.length));return this.lineInner(pos,false,1,0);}/**
    Get the description for the given (1-based) line number.
    */},{key:"line",value:function line(n){if(n<1||n>this.lines)throw new RangeError("Invalid line number ".concat(n," in ").concat(this.lines,"-line document"));return this.lineInner(n,true,1,0);}/**
    Replace a range of the text with the given content.
    */},{key:"replace",value:function replace(from,to,text){var parts=[];this.decompose(0,from,parts,2/* Open.To */);if(text.length)text.decompose(0,text.length,parts,1/* Open.From */|2/* Open.To */);this.decompose(to,this.length,parts,1/* Open.From */);return TextNode.from(parts,this.length-(to-from)+text.length);}/**
    Append another document to this one.
    */},{key:"append",value:function append(other){return this.replace(this.length,this.length,other);}/**
    Retrieve the text between the given points.
    */},{key:"slice",value:function slice(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var parts=[];this.decompose(from,to,parts,0);return TextNode.from(parts,to-from);}/**
    Test whether this text is equal to another instance.
    */},{key:"eq",value:function eq(other){if(other==this)return true;if(other.length!=this.length||other.lines!=this.lines)return false;var start=this.scanIdentical(other,1),end=this.length-this.scanIdentical(other,-1);var a=new RawTextCursor(this),b=new RawTextCursor(other);for(var skip=start,pos=start;;){a.next(skip);b.next(skip);skip=0;if(a.lineBreak!=b.lineBreak||a.done!=b.done||a.value!=b.value)return false;pos+=a.value.length;if(a.done||pos>=end)return true;}}/**
    Iterate over the text. When `dir` is `-1`, iteration happens
    from end to start. This will return lines and the breaks between
    them as separate strings.
    */},{key:"iter",value:function iter(){var dir=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;return new RawTextCursor(this,dir);}/**
    Iterate over a range of the text. When `from` > `to`, the
    iterator will run in reverse.
    */},{key:"iterRange",value:function iterRange(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;return new PartialTextCursor(this,from,to);}/**
    Return a cursor that iterates over the given range of lines,
    _without_ returning the line breaks between, and yielding empty
    strings for empty lines.
    
    When `from` and `to` are given, they should be 1-based line numbers.
    */},{key:"iterLines",value:function iterLines(from,to){var inner;if(from==null){inner=this.iter();}else{if(to==null)to=this.lines+1;var start=this.line(from).from;inner=this.iterRange(start,Math.max(start,to==this.lines+1?this.length:to<=1?0:this.line(to-1).to));}return new LineCursor(inner);}/**
    @internal
    */},{key:"toString",value:function toString(){return this.sliceString(0);}/**
    Convert the document to an array of lines (which can be
    deserialized again via [`Text.of`](https://codemirror.net/6/docs/ref/#state.Text^of)).
    */},{key:"toJSON",value:function toJSON(){var lines=[];this.flatten(lines);return lines;}/**
    Create a `Text` instance for the given array of lines.
    */}],[{key:"of",value:function of(text){if(text.length==0)throw new RangeError("A document must have at least one line");if(text.length==1&&!text[0])return Text.empty;return text.length<=32/* Tree.Branch */?new TextLeaf(text):TextNode.from(TextLeaf.split(text,[]));}}]);return Text;}();// Leaves store an array of line strings. There are always line breaks
// between these strings. Leaves are limited in size and have to be
// contained in TextNode instances for bigger documents.
var TextLeaf=/*#__PURE__*/function(_Text){_inherits(TextLeaf,_Text);var _super15=_createSuper(TextLeaf);function TextLeaf(text){var _this15;var length=arguments.length>1&&arguments[1]!==undefined?arguments[1]:textLength(text);_classCallCheck(this,TextLeaf);_this15=_super15.call(this);_this15.text=text;_this15.length=length;return _this15;}_createClass(TextLeaf,[{key:"lines",get:function get(){return this.text.length;}},{key:"children",get:function get(){return null;}},{key:"lineInner",value:function lineInner(target,isLine,line,offset){for(var _i51=0;;_i51++){var _string=this.text[_i51],end=offset+_string.length;if((isLine?line:end)>=target)return new Line(offset,end,line,_string);offset=end+1;line++;}}},{key:"decompose",value:function decompose(from,to,target,open){var text=from<=0&&to>=this.length?this:new TextLeaf(sliceText(this.text,from,to),Math.min(to,this.length)-Math.max(0,from));if(open&1/* Open.From */){var prev=target.pop();var joined=appendText(text.text,prev.text.slice(),0,text.length);if(joined.length<=32/* Tree.Branch */){target.push(new TextLeaf(joined,prev.length+text.length));}else{var mid=joined.length>>1;target.push(new TextLeaf(joined.slice(0,mid)),new TextLeaf(joined.slice(mid)));}}else{target.push(text);}}},{key:"replace",value:function replace(from,to,text){if(!(text instanceof TextLeaf))return _get(_getPrototypeOf(TextLeaf.prototype),"replace",this).call(this,from,to,text);var lines=appendText(this.text,appendText(text.text,sliceText(this.text,0,from)),to);var newLen=this.length+text.length-(to-from);if(lines.length<=32/* Tree.Branch */)return new TextLeaf(lines,newLen);return TextNode.from(TextLeaf.split(lines,[]),newLen);}},{key:"sliceString",value:function sliceString(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var lineSep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"\n";var result="";for(var pos=0,_i52=0;pos<=to&&_i52<this.text.length;_i52++){var line=this.text[_i52],end=pos+line.length;if(pos>from&&_i52)result+=lineSep;if(from<end&&to>pos)result+=line.slice(Math.max(0,from-pos),to-pos);pos=end+1;}return result;}},{key:"flatten",value:function flatten(target){var _iterator=_createForOfIteratorHelper(this.text),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var line=_step.value;target.push(line);}}catch(err){_iterator.e(err);}finally{_iterator.f();}}},{key:"scanIdentical",value:function scanIdentical(){return 0;}}],[{key:"split",value:function split(text,target){var part=[],len=-1;var _iterator2=_createForOfIteratorHelper(text),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var line=_step2.value;part.push(line);len+=line.length+1;if(part.length==32/* Tree.Branch */){target.push(new TextLeaf(part,len));part=[];len=-1;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}if(len>-1)target.push(new TextLeaf(part,len));return target;}}]);return TextLeaf;}(Text);// Nodes provide the tree structure of the `Text` type. They store a
// number of other nodes or leaves, taking care to balance themselves
// on changes. There are implied line breaks _between_ the children of
// a node (but not before the first or after the last child).
var TextNode=/*#__PURE__*/function(_Text2){_inherits(TextNode,_Text2);var _super16=_createSuper(TextNode);function TextNode(children,length){var _this16;_classCallCheck(this,TextNode);_this16=_super16.call(this);_this16.children=children;_this16.length=length;_this16.lines=0;var _iterator3=_createForOfIteratorHelper(children),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var child=_step3.value;_this16.lines+=child.lines;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return _this16;}_createClass(TextNode,[{key:"lineInner",value:function lineInner(target,isLine,line,offset){for(var _i53=0;;_i53++){var child=this.children[_i53],end=offset+child.length,endLine=line+child.lines-1;if((isLine?endLine:end)>=target)return child.lineInner(target,isLine,line,offset);offset=end+1;line=endLine+1;}}},{key:"decompose",value:function decompose(from,to,target,open){for(var _i54=0,pos=0;pos<=to&&_i54<this.children.length;_i54++){var child=this.children[_i54],end=pos+child.length;if(from<=end&&to>=pos){var childOpen=open&((pos<=from?1/* Open.From */:0)|(end>=to?2/* Open.To */:0));if(pos>=from&&end<=to&&!childOpen)target.push(child);else child.decompose(from-pos,to-pos,target,childOpen);}pos=end+1;}}},{key:"replace",value:function replace(from,to,text){if(text.lines<this.lines)for(var _i55=0,pos=0;_i55<this.children.length;_i55++){var child=this.children[_i55],end=pos+child.length;// Fast path: if the change only affects one child and the
// child's size remains in the acceptable range, only update
// that child
if(from>=pos&&to<=end){var updated=child.replace(from-pos,to-pos,text);var totalLines=this.lines-child.lines+updated.lines;if(updated.lines<totalLines>>5/* Tree.BranchShift */-1&&updated.lines>totalLines>>5/* Tree.BranchShift */+1){var copy=this.children.slice();copy[_i55]=updated;return new TextNode(copy,this.length-(to-from)+text.length);}return _get(_getPrototypeOf(TextNode.prototype),"replace",this).call(this,pos,end,updated);}pos=end+1;}return _get(_getPrototypeOf(TextNode.prototype),"replace",this).call(this,from,to,text);}},{key:"sliceString",value:function sliceString(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var lineSep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"\n";var result="";for(var _i56=0,pos=0;_i56<this.children.length&&pos<=to;_i56++){var child=this.children[_i56],end=pos+child.length;if(pos>from&&_i56)result+=lineSep;if(from<end&&to>pos)result+=child.sliceString(from-pos,to-pos,lineSep);pos=end+1;}return result;}},{key:"flatten",value:function flatten(target){var _iterator4=_createForOfIteratorHelper(this.children),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var child=_step4.value;child.flatten(target);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}},{key:"scanIdentical",value:function scanIdentical(other,dir){if(!(other instanceof TextNode))return 0;var length=0;var _ref35=dir>0?[0,0,this.children.length,other.children.length]:[this.children.length-1,other.children.length-1,-1,-1],_ref36=_slicedToArray(_ref35,4),iA=_ref36[0],iB=_ref36[1],eA=_ref36[2],eB=_ref36[3];for(;;iA+=dir,iB+=dir){if(iA==eA||iB==eB)return length;var chA=this.children[iA],chB=other.children[iB];if(chA!=chB)return length+chA.scanIdentical(chB,dir);length+=chA.length+1;}}}],[{key:"from",value:function from(children){var length=arguments.length>1&&arguments[1]!==undefined?arguments[1]:children.reduce(function(l,ch){return l+ch.length+1;},-1);var lines=0;var _iterator5=_createForOfIteratorHelper(children),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _ch=_step5.value;lines+=_ch.lines;}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}if(lines<32/* Tree.Branch */){var flat=[];var _iterator6=_createForOfIteratorHelper(children),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var ch=_step6.value;ch.flatten(flat);}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}return new TextLeaf(flat,length);}var chunk=Math.max(32/* Tree.Branch */,lines>>5/* Tree.BranchShift */),maxChunk=chunk<<1,minChunk=chunk>>1;var chunked=[],currentLines=0,currentLen=-1,currentChunk=[];function add(child){var last;if(child.lines>maxChunk&&child instanceof TextNode){var _iterator7=_createForOfIteratorHelper(child.children),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var node=_step7.value;add(node);}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}else if(child.lines>minChunk&&(currentLines>minChunk||!currentLines)){flush();chunked.push(child);}else if(child instanceof TextLeaf&&currentLines&&(last=currentChunk[currentChunk.length-1])instanceof TextLeaf&&child.lines+last.lines<=32/* Tree.Branch */){currentLines+=child.lines;currentLen+=child.length+1;currentChunk[currentChunk.length-1]=new TextLeaf(last.text.concat(child.text),last.length+1+child.length);}else{if(currentLines+child.lines>chunk)flush();currentLines+=child.lines;currentLen+=child.length+1;currentChunk.push(child);}}function flush(){if(currentLines==0)return;chunked.push(currentChunk.length==1?currentChunk[0]:TextNode.from(currentChunk,currentLen));currentLen=-1;currentLines=currentChunk.length=0;}var _iterator8=_createForOfIteratorHelper(children),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var child=_step8.value;add(child);}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}flush();return chunked.length==1?chunked[0]:new TextNode(chunked,length);}}]);return TextNode;}(Text);Text.empty=/*@__PURE__*/new TextLeaf([""],0);function textLength(text){var length=-1;var _iterator9=_createForOfIteratorHelper(text),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var line=_step9.value;length+=line.length+1;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return length;}function appendText(text,target){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1e9;for(var pos=0,_i57=0,first=true;_i57<text.length&&pos<=to;_i57++){var line=text[_i57],end=pos+line.length;if(end>=from){if(end>to)line=line.slice(0,to-pos);if(pos<from)line=line.slice(from-pos);if(first){target[target.length-1]+=line;first=false;}else target.push(line);}pos=end+1;}return target;}function sliceText(text,from,to){return appendText(text,[""],from,to);}var RawTextCursor=/*#__PURE__*/function(){function RawTextCursor(text){var dir=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;_classCallCheck(this,RawTextCursor);this.dir=dir;this.done=false;this.lineBreak=false;this.value="";this.nodes=[text];this.offsets=[dir>0?1:(text instanceof TextLeaf?text.text.length:text.children.length)<<1];}_createClass(RawTextCursor,[{key:"nextInner",value:function nextInner(skip,dir){this.done=this.lineBreak=false;for(;;){var _last=this.nodes.length-1;var _top3=this.nodes[_last],offsetValue=this.offsets[_last],offset=offsetValue>>1;var _size=_top3 instanceof TextLeaf?_top3.text.length:_top3.children.length;if(offset==(dir>0?_size:0)){if(_last==0){this.done=true;this.value="";return this;}if(dir>0)this.offsets[_last-1]++;this.nodes.pop();this.offsets.pop();}else if((offsetValue&1)==(dir>0?0:1)){this.offsets[_last]+=dir;if(skip==0){this.lineBreak=true;this.value="\n";return this;}skip--;}else if(_top3 instanceof TextLeaf){// Move to the next string
var next=_top3.text[offset+(dir<0?-1:0)];this.offsets[_last]+=dir;if(next.length>Math.max(0,skip)){this.value=skip==0?next:dir>0?next.slice(skip):next.slice(0,next.length-skip);return this;}skip-=next.length;}else{var _next=_top3.children[offset+(dir<0?-1:0)];if(skip>_next.length){skip-=_next.length;this.offsets[_last]+=dir;}else{if(dir<0)this.offsets[_last]--;this.nodes.push(_next);this.offsets.push(dir>0?1:(_next instanceof TextLeaf?_next.text.length:_next.children.length)<<1);}}}}},{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(skip<0){this.nextInner(-skip,-this.dir);skip=this.value.length;}return this.nextInner(skip,this.dir);}}]);return RawTextCursor;}();var PartialTextCursor=/*#__PURE__*/function(){function PartialTextCursor(text,start,end){_classCallCheck(this,PartialTextCursor);this.value="";this.done=false;this.cursor=new RawTextCursor(text,start>end?-1:1);this.pos=start>end?text.length:0;this.from=Math.min(start,end);this.to=Math.max(start,end);}_createClass(PartialTextCursor,[{key:"nextInner",value:function nextInner(skip,dir){if(dir<0?this.pos<=this.from:this.pos>=this.to){this.value="";this.done=true;return this;}skip+=Math.max(0,dir<0?this.pos-this.to:this.from-this.pos);var limit=dir<0?this.pos-this.from:this.to-this.pos;if(skip>limit)skip=limit;limit-=skip;var _this$cursor$next=this.cursor.next(skip),value=_this$cursor$next.value;this.pos+=(value.length+skip)*dir;this.value=value.length<=limit?value:dir<0?value.slice(value.length-limit):value.slice(0,limit);this.done=!this.value;return this;}},{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(skip<0)skip=Math.max(skip,this.from-this.pos);else if(skip>0)skip=Math.min(skip,this.to-this.pos);return this.nextInner(skip,this.cursor.dir);}},{key:"lineBreak",get:function get(){return this.cursor.lineBreak&&this.value!="";}}]);return PartialTextCursor;}();var LineCursor=/*#__PURE__*/function(){function LineCursor(inner){_classCallCheck(this,LineCursor);this.inner=inner;this.afterBreak=true;this.value="";this.done=false;}_createClass(LineCursor,[{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var _this$inner$next=this.inner.next(skip),done=_this$inner$next.done,lineBreak=_this$inner$next.lineBreak,value=_this$inner$next.value;if(done){this.done=true;this.value="";}else if(lineBreak){if(this.afterBreak){this.value="";}else{this.afterBreak=true;this.next();}}else{this.value=value;this.afterBreak=false;}return this;}},{key:"lineBreak",get:function get(){return false;}}]);return LineCursor;}();if(typeof Symbol!="undefined"){Text.prototype[Symbol.iterator]=function(){return this.iter();};RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this;};}/**
This type describes a line in the document. It is created
on-demand when lines are [queried](https://codemirror.net/6/docs/ref/#state.Text.lineAt).
*/var Line=/*#__PURE__*/function(){/**
    @internal
    */function Line(/**
    The position of the start of the line.
    */from,/**
    The position at the end of the line (_before_ the line break,
    or at the end of document for the last line).
    */to,/**
    This line's line number (1-based).
    */number,/**
    The line's content.
    */text){_classCallCheck(this,Line);this.from=from;this.to=to;this.number=number;this.text=text;}/**
    The length of the line (not including any line break after it).
    */_createClass(Line,[{key:"length",get:function get(){return this.to-this.from;}}]);return Line;}();// Compressed representation of the Grapheme_Cluster_Break=Extend
// information from
// http://www.unicode.org/Public/13.0.0/ucd/auxiliary/GraphemeBreakProperty.txt.
// Each pair of elements represents a range, as an offet from the
// previous range and a length. Numbers are in base-36, with the empty
// string being a shorthand for 1.
var extend=/*@__PURE__*/"lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(function(s){return s?parseInt(s,36):1;});// Convert offsets into absolute values
for(var _i58=1;_i58<extend.length;_i58++){extend[_i58]+=extend[_i58-1];}function isExtendingChar(code){for(var _i59=1;_i59<extend.length;_i59+=2){if(extend[_i59]>code)return extend[_i59-1]<=code;}return false;}function isRegionalIndicator(code){return code>=0x1F1E6&&code<=0x1F1FF;}var ZWJ=0x200d;/**
Returns a next grapheme cluster break _after_ (not equal to)
`pos`, if `forward` is true, or before otherwise. Returns `pos`
itself if no further cluster break is available in the string.
Moves across surrogate pairs, extending characters (when
`includeExtending` is true), characters joined with zero-width
joiners, and flag emoji.
*/function findClusterBreak(str,pos){var forward=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var includeExtending=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;return(forward?nextClusterBreak:prevClusterBreak)(str,pos,includeExtending);}function nextClusterBreak(str,pos,includeExtending){if(pos==str.length)return pos;// If pos is in the middle of a surrogate pair, move to its start
if(pos&&surrogateLow(str.charCodeAt(pos))&&surrogateHigh(str.charCodeAt(pos-1)))pos--;var prev=codePointAt(str,pos);pos+=codePointSize(prev);while(pos<str.length){var next=codePointAt(str,pos);if(prev==ZWJ||next==ZWJ||includeExtending&&isExtendingChar(next)){pos+=codePointSize(next);prev=next;}else if(isRegionalIndicator(next)){var countBefore=0,_i60=pos-2;while(_i60>=0&&isRegionalIndicator(codePointAt(str,_i60))){countBefore++;_i60-=2;}if(countBefore%2==0)break;else pos+=2;}else{break;}}return pos;}function prevClusterBreak(str,pos,includeExtending){while(pos>0){var found=nextClusterBreak(str,pos-2,includeExtending);if(found<pos)return found;pos--;}return 0;}function surrogateLow(ch){return ch>=0xDC00&&ch<0xE000;}function surrogateHigh(ch){return ch>=0xD800&&ch<0xDC00;}/**
Find the code point at the given position in a string (like the
[`codePointAt`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt)
string method).
*/function codePointAt(str,pos){var code0=str.charCodeAt(pos);if(!surrogateHigh(code0)||pos+1==str.length)return code0;var code1=str.charCodeAt(pos+1);if(!surrogateLow(code1))return code0;return(code0-0xd800<<10)+(code1-0xdc00)+0x10000;}/**
Given a Unicode codepoint, return the JavaScript string that
respresents it (like
[`String.fromCodePoint`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint)).
*/function fromCodePoint(code){if(code<=0xffff)return String.fromCharCode(code);code-=0x10000;return String.fromCharCode((code>>10)+0xd800,(code&1023)+0xdc00);}/**
The amount of positions a character takes up a JavaScript string.
*/function codePointSize(code){return code<0x10000?1:2;}var DefaultSplit=/\r\n?|\n/;/**
Distinguishes different ways in which positions can be mapped.
*/var MapMode=/*@__PURE__*/function(MapMode){/**
    Map a position to a valid new position, even when its context
    was deleted.
    */MapMode[MapMode["Simple"]=0]="Simple";/**
    Return null if deletion happens across the position.
    */MapMode[MapMode["TrackDel"]=1]="TrackDel";/**
    Return null if the character _before_ the position is deleted.
    */MapMode[MapMode["TrackBefore"]=2]="TrackBefore";/**
    Return null if the character _after_ the position is deleted.
    */MapMode[MapMode["TrackAfter"]=3]="TrackAfter";return MapMode;}(MapMode||(MapMode={}));/**
A change description is a variant of [change set](https://codemirror.net/6/docs/ref/#state.ChangeSet)
that doesn't store the inserted text. As such, it can't be
applied, but is cheaper to store and manipulate.
*/var ChangeDesc=/*#__PURE__*/function(){// Sections are encoded as pairs of integers. The first is the
// length in the current document, and the second is -1 for
// unaffected sections, and the length of the replacement content
// otherwise. So an insertion would be (0, n>0), a deletion (n>0,
// 0), and a replacement two positive numbers.
/**
    @internal
    */function ChangeDesc(/**
    @internal
    */sections){_classCallCheck(this,ChangeDesc);this.sections=sections;}/**
    The length of the document before the change.
    */_createClass(ChangeDesc,[{key:"length",get:function get(){var result=0;for(var _i61=0;_i61<this.sections.length;_i61+=2){result+=this.sections[_i61];}return result;}/**
    The length of the document after the change.
    */},{key:"newLength",get:function get(){var result=0;for(var _i62=0;_i62<this.sections.length;_i62+=2){var ins=this.sections[_i62+1];result+=ins<0?this.sections[_i62]:ins;}return result;}/**
    False when there are actual changes in this set.
    */},{key:"empty",get:function get(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0;}/**
    Iterate over the unchanged parts left by these changes. `posA`
    provides the position of the range in the old document, `posB`
    the new position in the changed document.
    */},{key:"iterGaps",value:function iterGaps(f){for(var _i63=0,posA=0,posB=0;_i63<this.sections.length;){var len=this.sections[_i63++],ins=this.sections[_i63++];if(ins<0){f(posA,posB,len);posB+=len;}else{posB+=ins;}posA+=len;}}/**
    Iterate over the ranges changed by these changes. (See
    [`ChangeSet.iterChanges`](https://codemirror.net/6/docs/ref/#state.ChangeSet.iterChanges) for a
    variant that also provides you with the inserted text.)
    `fromA`/`toA` provides the extent of the change in the starting
    document, `fromB`/`toB` the extent of the replacement in the
    changed document.
    
    When `individual` is true, adjacent changes (which are kept
    separate for [position mapping](https://codemirror.net/6/docs/ref/#state.ChangeDesc.mapPos)) are
    reported separately.
    */},{key:"iterChangedRanges",value:function iterChangedRanges(f){var individual=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_iterChanges(this,f,individual);}/**
    Get a description of the inverted form of these changes.
    */},{key:"invertedDesc",get:function get(){var sections=[];for(var _i64=0;_i64<this.sections.length;){var len=this.sections[_i64++],ins=this.sections[_i64++];if(ins<0)sections.push(len,ins);else sections.push(ins,len);}return new ChangeDesc(sections);}/**
    Compute the combined effect of applying another set of changes
    after this one. The length of the document after this set should
    match the length before `other`.
    */},{key:"composeDesc",value:function composeDesc(other){return this.empty?other:other.empty?this:composeSets(this,other);}/**
    Map this description, which should start with the same document
    as `other`, over another set of changes, so that it can be
    applied after it. When `before` is true, map as if the changes
    in `other` happened before the ones in `this`.
    */},{key:"mapDesc",value:function mapDesc(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return other.empty?this:mapSet(this,other,before);}},{key:"mapPos",value:function mapPos(pos){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:MapMode.Simple;var posA=0,posB=0;for(var _i65=0;_i65<this.sections.length;){var len=this.sections[_i65++],ins=this.sections[_i65++],endA=posA+len;if(ins<0){if(endA>pos)return posB+(pos-posA);posB+=len;}else{if(mode!=MapMode.Simple&&endA>=pos&&(mode==MapMode.TrackDel&&posA<pos&&endA>pos||mode==MapMode.TrackBefore&&posA<pos||mode==MapMode.TrackAfter&&endA>pos))return null;if(endA>pos||endA==pos&&assoc<0&&!len)return pos==posA||assoc<0?posB:posB+ins;posB+=ins;}posA=endA;}if(pos>posA)throw new RangeError("Position ".concat(pos," is out of range for changeset of length ").concat(posA));return posB;}/**
    Check whether these changes touch a given range. When one of the
    changes entirely covers the range, the string `"cover"` is
    returned.
    */},{key:"touchesRange",value:function touchesRange(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;for(var _i66=0,pos=0;_i66<this.sections.length&&pos<=to;){var len=this.sections[_i66++],ins=this.sections[_i66++],end=pos+len;if(ins>=0&&pos<=to&&end>=from)return pos<from&&end>to?"cover":true;pos=end;}return false;}/**
    @internal
    */},{key:"toString",value:function toString(){var result="";for(var _i67=0;_i67<this.sections.length;){var len=this.sections[_i67++],ins=this.sections[_i67++];result+=(result?" ":"")+len+(ins>=0?":"+ins:"");}return result;}/**
    Serialize this change desc to a JSON-representable value.
    */},{key:"toJSON",value:function toJSON(){return this.sections;}/**
    Create a change desc from its JSON representation (as produced
    by [`toJSON`](https://codemirror.net/6/docs/ref/#state.ChangeDesc.toJSON).
    */}],[{key:"fromJSON",value:function fromJSON(json){if(!Array.isArray(json)||json.length%2||json.some(function(a){return typeof a!="number";}))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(json);}/**
    @internal
    */},{key:"create",value:function create(sections){return new ChangeDesc(sections);}}]);return ChangeDesc;}();/**
A change set represents a group of modifications to a document. It
stores the document length, and can only be applied to documents
with exactly that length.
*/var ChangeSet=/*#__PURE__*/function(_ChangeDesc){_inherits(ChangeSet,_ChangeDesc);var _super17=_createSuper(ChangeSet);function ChangeSet(sections,/**
    @internal
    */inserted){var _this17;_classCallCheck(this,ChangeSet);_this17=_super17.call(this,sections);_this17.inserted=inserted;return _this17;}/**
    Apply the changes to a document, returning the modified
    document.
    */_createClass(ChangeSet,[{key:"apply",value:function apply(doc){if(this.length!=doc.length)throw new RangeError("Applying change set to a document with the wrong length");_iterChanges(this,function(fromA,toA,fromB,_toB,text){return doc=doc.replace(fromB,fromB+(toA-fromA),text);},false);return doc;}},{key:"mapDesc",value:function mapDesc(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return mapSet(this,other,before,true);}/**
    Given the document as it existed _before_ the changes, return a
    change set that represents the inverse of this set, which could
    be used to go from the document created by the changes back to
    the document as it existed before the changes.
    */},{key:"invert",value:function invert(doc){var sections=this.sections.slice(),inserted=[];for(var _i68=0,pos=0;_i68<sections.length;_i68+=2){var len=sections[_i68],ins=sections[_i68+1];if(ins>=0){sections[_i68]=ins;sections[_i68+1]=len;var index=_i68>>1;while(inserted.length<index){inserted.push(Text.empty);}inserted.push(len?doc.slice(pos,pos+len):Text.empty);}pos+=len;}return new ChangeSet(sections,inserted);}/**
    Combine two subsequent change sets into a single set. `other`
    must start in the document produced by `this`. If `this` goes
    `docA`  `docB` and `other` represents `docB`  `docC`, the
    returned value will represent the change `docA`  `docC`.
    */},{key:"compose",value:function compose(other){return this.empty?other:other.empty?this:composeSets(this,other,true);}/**
    Given another change set starting in the same document, maps this
    change set over the other, producing a new change set that can be
    applied to the document produced by applying `other`. When
    `before` is `true`, order changes as if `this` comes before
    `other`, otherwise (the default) treat `other` as coming first.
    
    Given two changes `A` and `B`, `A.compose(B.map(A))` and
    `B.compose(A.map(B, true))` will produce the same document. This
    provides a basic form of [operational
    transformation](https://en.wikipedia.org/wiki/Operational_transformation),
    and can be used for collaborative editing.
    */},{key:"map",value:function map(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return other.empty?this:mapSet(this,other,before,true);}/**
    Iterate over the changed ranges in the document, calling `f` for
    each, with the range in the original document (`fromA`-`toA`)
    and the range that replaces it in the new document
    (`fromB`-`toB`).
    
    When `individual` is true, adjacent changes are reported
    separately.
    */},{key:"iterChanges",value:function iterChanges(f){var individual=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_iterChanges(this,f,individual);}/**
    Get a [change description](https://codemirror.net/6/docs/ref/#state.ChangeDesc) for this change
    set.
    */},{key:"desc",get:function get(){return ChangeDesc.create(this.sections);}/**
    @internal
    */},{key:"filter",value:function filter(ranges){var resultSections=[],resultInserted=[],filteredSections=[];var iter=new SectionIter(this);done:for(var _i69=0,pos=0;;){var next=_i69==ranges.length?1e9:ranges[_i69++];while(pos<next||pos==next&&iter.len==0){if(iter.done)break done;var len=Math.min(iter.len,next-pos);addSection(filteredSections,len,-1);var ins=iter.ins==-1?-1:iter.off==0?iter.ins:0;addSection(resultSections,len,ins);if(ins>0)addInsert(resultInserted,resultSections,iter.text);iter.forward(len);pos+=len;}var end=ranges[_i69++];while(pos<end){if(iter.done)break done;var _len2=Math.min(iter.len,end-pos);addSection(resultSections,_len2,-1);addSection(filteredSections,_len2,iter.ins==-1?-1:iter.off==0?iter.ins:0);iter.forward(_len2);pos+=_len2;}}return{changes:new ChangeSet(resultSections,resultInserted),filtered:ChangeDesc.create(filteredSections)};}/**
    Serialize this change set to a JSON-representable value.
    */},{key:"toJSON",value:function toJSON(){var parts=[];for(var _i70=0;_i70<this.sections.length;_i70+=2){var len=this.sections[_i70],ins=this.sections[_i70+1];if(ins<0)parts.push(len);else if(ins==0)parts.push([len]);else parts.push([len].concat(this.inserted[_i70>>1].toJSON()));}return parts;}/**
    Create a change set for the given changes, for a document of the
    given length, using `lineSep` as line separator.
    */}],[{key:"of",value:function of(changes,length,lineSep){var sections=[],inserted=[],pos=0;var total=null;function flush(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!force&&!sections.length)return;if(pos<length)addSection(sections,length-pos,-1);var set=new ChangeSet(sections,inserted);total=total?total.compose(set.map(total)):set;sections=[];inserted=[];pos=0;}function process(spec){if(Array.isArray(spec)){var _iterator10=_createForOfIteratorHelper(spec),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var sub=_step10.value;process(sub);}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}}else if(spec instanceof ChangeSet){if(spec.length!=length)throw new RangeError("Mismatched change set length (got ".concat(spec.length,", expected ").concat(length,")"));flush();total=total?total.compose(spec.map(total)):spec;}else{var from=spec.from,_spec$to=spec.to,to=_spec$to===void 0?from:_spec$to,_insert=spec.insert;if(from>to||from<0||to>length)throw new RangeError("Invalid change range ".concat(from," to ").concat(to," (in doc of length ").concat(length,")"));var insText=!_insert?Text.empty:typeof _insert=="string"?Text.of(_insert.split(lineSep||DefaultSplit)):_insert;var insLen=insText.length;if(from==to&&insLen==0)return;if(from<pos)flush();if(from>pos)addSection(sections,from-pos,-1);addSection(sections,to-from,insLen);addInsert(inserted,sections,insText);pos=to;}}process(changes);flush(!total);return total;}/**
    Create an empty changeset of the given length.
    */},{key:"empty",value:function empty(length){return new ChangeSet(length?[length,-1]:[],[]);}/**
    Create a changeset from its JSON representation (as produced by
    [`toJSON`](https://codemirror.net/6/docs/ref/#state.ChangeSet.toJSON).
    */},{key:"fromJSON",value:function fromJSON(json){if(!Array.isArray(json))throw new RangeError("Invalid JSON representation of ChangeSet");var sections=[],inserted=[];for(var _i71=0;_i71<json.length;_i71++){var part=json[_i71];if(typeof part=="number"){sections.push(part,-1);}else if(!Array.isArray(part)||typeof part[0]!="number"||part.some(function(e,i){return i&&typeof e!="string";})){throw new RangeError("Invalid JSON representation of ChangeSet");}else if(part.length==1){sections.push(part[0],0);}else{while(inserted.length<_i71){inserted.push(Text.empty);}inserted[_i71]=Text.of(part.slice(1));sections.push(part[0],inserted[_i71].length);}}return new ChangeSet(sections,inserted);}/**
    @internal
    */},{key:"createSet",value:function createSet(sections,inserted){return new ChangeSet(sections,inserted);}}]);return ChangeSet;}(ChangeDesc);function addSection(sections,len,ins){var forceJoin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(len==0&&ins<=0)return;var last=sections.length-2;if(last>=0&&ins<=0&&ins==sections[last+1])sections[last]+=len;else if(len==0&&sections[last]==0)sections[last+1]+=ins;else if(forceJoin){sections[last]+=len;sections[last+1]+=ins;}else sections.push(len,ins);}function addInsert(values,sections,value){if(value.length==0)return;var index=sections.length-2>>1;if(index<values.length){values[values.length-1]=values[values.length-1].append(value);}else{while(values.length<index){values.push(Text.empty);}values.push(value);}}function _iterChanges(desc,f,individual){var inserted=desc.inserted;for(var posA=0,posB=0,_i72=0;_i72<desc.sections.length;){var len=desc.sections[_i72++],ins=desc.sections[_i72++];if(ins<0){posA+=len;posB+=len;}else{var endA=posA,endB=posB,_text=Text.empty;for(;;){endA+=len;endB+=ins;if(ins&&inserted)_text=_text.append(inserted[_i72-2>>1]);if(individual||_i72==desc.sections.length||desc.sections[_i72+1]<0)break;len=desc.sections[_i72++];ins=desc.sections[_i72++];}f(posA,endA,posB,endB,_text);posA=endA;posB=endB;}}}function mapSet(setA,setB,before){var mkSet=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;// Produce a copy of setA that applies to the document after setB
// has been applied (assuming both start at the same document).
var sections=[],insert=mkSet?[]:null;var a=new SectionIter(setA),b=new SectionIter(setB);// Iterate over both sets in parallel. inserted tracks, for changes
// in A that have to be processed piece-by-piece, whether their
// content has been inserted already, and refers to the section
// index.
for(var inserted=-1;;){if(a.ins==-1&&b.ins==-1){// Move across ranges skipped by both sets.
var len=Math.min(a.len,b.len);addSection(sections,len,-1);a.forward(len);b.forward(len);}else if(b.ins>=0&&(a.ins<0||inserted==a.i||a.off==0&&(b.len<a.len||b.len==a.len&&!before))){// If there's a change in B that comes before the next change in
// A (ordered by start pos, then len, then before flag), skip
// that (and process any changes in A it covers).
var _len3=b.len;addSection(sections,b.ins,-1);while(_len3){var piece=Math.min(a.len,_len3);if(a.ins>=0&&inserted<a.i&&a.len<=piece){addSection(sections,0,a.ins);if(insert)addInsert(insert,sections,a.text);inserted=a.i;}a.forward(piece);_len3-=piece;}b.next();}else if(a.ins>=0){// Process the part of a change in A up to the start of the next
// non-deletion change in B (if overlapping).
var _len4=0,left=a.len;while(left){if(b.ins==-1){var _piece=Math.min(left,b.len);_len4+=_piece;left-=_piece;b.forward(_piece);}else if(b.ins==0&&b.len<left){left-=b.len;b.next();}else{break;}}addSection(sections,_len4,inserted<a.i?a.ins:0);if(insert&&inserted<a.i)addInsert(insert,sections,a.text);inserted=a.i;a.forward(a.len-left);}else if(a.done&&b.done){return insert?ChangeSet.createSet(sections,insert):ChangeDesc.create(sections);}else{throw new Error("Mismatched change set lengths");}}}function composeSets(setA,setB){var mkSet=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var sections=[];var insert=mkSet?[]:null;var a=new SectionIter(setA),b=new SectionIter(setB);for(var open=false;;){if(a.done&&b.done){return insert?ChangeSet.createSet(sections,insert):ChangeDesc.create(sections);}else if(a.ins==0){// Deletion in A
addSection(sections,a.len,0,open);a.next();}else if(b.len==0&&!b.done){// Insertion in B
addSection(sections,0,b.ins,open);if(insert)addInsert(insert,sections,b.text);b.next();}else if(a.done||b.done){throw new Error("Mismatched change set lengths");}else{var len=Math.min(a.len2,b.len),sectionLen=sections.length;if(a.ins==-1){var insB=b.ins==-1?-1:b.off?0:b.ins;addSection(sections,len,insB,open);if(insert&&insB)addInsert(insert,sections,b.text);}else if(b.ins==-1){addSection(sections,a.off?0:a.len,len,open);if(insert)addInsert(insert,sections,a.textBit(len));}else{addSection(sections,a.off?0:a.len,b.off?0:b.ins,open);if(insert&&!b.off)addInsert(insert,sections,b.text);}open=(a.ins>len||b.ins>=0&&b.len>len)&&(open||sections.length>sectionLen);a.forward2(len);b.forward(len);}}}var SectionIter=/*#__PURE__*/function(){function SectionIter(set){_classCallCheck(this,SectionIter);this.set=set;this.i=0;this.next();}_createClass(SectionIter,[{key:"next",value:function next(){var sections=this.set.sections;if(this.i<sections.length){this.len=sections[this.i++];this.ins=sections[this.i++];}else{this.len=0;this.ins=-2;}this.off=0;}},{key:"done",get:function get(){return this.ins==-2;}},{key:"len2",get:function get(){return this.ins<0?this.len:this.ins;}},{key:"text",get:function get(){var inserted=this.set.inserted,index=this.i-2>>1;return index>=inserted.length?Text.empty:inserted[index];}},{key:"textBit",value:function textBit(len){var inserted=this.set.inserted,index=this.i-2>>1;return index>=inserted.length&&!len?Text.empty:inserted[index].slice(this.off,len==null?undefined:this.off+len);}},{key:"forward",value:function forward(len){if(len==this.len)this.next();else{this.len-=len;this.off+=len;}}},{key:"forward2",value:function forward2(len){if(this.ins==-1)this.forward(len);else if(len==this.ins)this.next();else{this.ins-=len;this.off+=len;}}}]);return SectionIter;}();/**
A single selection range. When
[`allowMultipleSelections`](https://codemirror.net/6/docs/ref/#state.EditorState^allowMultipleSelections)
is enabled, a [selection](https://codemirror.net/6/docs/ref/#state.EditorSelection) may hold
multiple ranges. By default, selections hold exactly one range.
*/var SelectionRange=/*#__PURE__*/function(){function SelectionRange(/**
    The lower boundary of the range.
    */from,/**
    The upper boundary of the range.
    */to,flags){_classCallCheck(this,SelectionRange);this.from=from;this.to=to;this.flags=flags;}/**
    The anchor of the rangethe side that doesn't move when you
    extend it.
    */_createClass(SelectionRange,[{key:"anchor",get:function get(){return this.flags&16/* RangeFlag.Inverted */?this.to:this.from;}/**
    The head of the range, which is moved when the range is
    [extended](https://codemirror.net/6/docs/ref/#state.SelectionRange.extend).
    */},{key:"head",get:function get(){return this.flags&16/* RangeFlag.Inverted */?this.from:this.to;}/**
    True when `anchor` and `head` are at the same position.
    */},{key:"empty",get:function get(){return this.from==this.to;}/**
    If this is a cursor that is explicitly associated with the
    character on one of its sides, this returns the side. -1 means
    the character before its position, 1 the character after, and 0
    means no association.
    */},{key:"assoc",get:function get(){return this.flags&4/* RangeFlag.AssocBefore */?-1:this.flags&8/* RangeFlag.AssocAfter */?1:0;}/**
    The bidirectional text level associated with this cursor, if
    any.
    */},{key:"bidiLevel",get:function get(){var level=this.flags&3/* RangeFlag.BidiLevelMask */;return level==3?null:level;}/**
    The goal column (stored vertical offset) associated with a
    cursor. This is used to preserve the vertical position when
    [moving](https://codemirror.net/6/docs/ref/#view.EditorView.moveVertically) across
    lines of different length.
    */},{key:"goalColumn",get:function get(){var value=this.flags>>5/* RangeFlag.GoalColumnOffset */;return value==33554431/* RangeFlag.NoGoalColumn */?undefined:value;}/**
    Map this range through a change, producing a valid range in the
    updated document.
    */},{key:"map",value:function map(change){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var from,to;if(this.empty){from=to=change.mapPos(this.from,assoc);}else{from=change.mapPos(this.from,1);to=change.mapPos(this.to,-1);}return from==this.from&&to==this.to?this:new SelectionRange(from,to,this.flags);}/**
    Extend this range to cover at least `from` to `to`.
    */},{key:"extend",value:function extend(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(from<=this.anchor&&to>=this.anchor)return EditorSelection.range(from,to);var head=Math.abs(from-this.anchor)>Math.abs(to-this.anchor)?from:to;return EditorSelection.range(this.anchor,head);}/**
    Compare this range to another range.
    */},{key:"eq",value:function eq(other){return this.anchor==other.anchor&&this.head==other.head;}/**
    Return a JSON-serializable object representing the range.
    */},{key:"toJSON",value:function toJSON(){return{anchor:this.anchor,head:this.head};}/**
    Convert a JSON representation of a range to a `SelectionRange`
    instance.
    */}],[{key:"fromJSON",value:function fromJSON(json){if(!json||typeof json.anchor!="number"||typeof json.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(json.anchor,json.head);}/**
    @internal
    */},{key:"create",value:function create(from,to,flags){return new SelectionRange(from,to,flags);}}]);return SelectionRange;}();/**
An editor selection holds one or more selection ranges.
*/var EditorSelection=/*#__PURE__*/function(){function EditorSelection(/**
    The ranges in the selection, sorted by position. Ranges cannot
    overlap (but they may touch, if they aren't empty).
    */ranges,/**
    The index of the _main_ range in the selection (which is
    usually the range that was added last).
    */mainIndex){_classCallCheck(this,EditorSelection);this.ranges=ranges;this.mainIndex=mainIndex;}/**
    Map a selection through a change. Used to adjust the selection
    position for changes.
    */_createClass(EditorSelection,[{key:"map",value:function map(change){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;if(change.empty)return this;return EditorSelection.create(this.ranges.map(function(r){return r.map(change,assoc);}),this.mainIndex);}/**
    Compare this selection to another selection.
    */},{key:"eq",value:function eq(other){if(this.ranges.length!=other.ranges.length||this.mainIndex!=other.mainIndex)return false;for(var _i73=0;_i73<this.ranges.length;_i73++){if(!this.ranges[_i73].eq(other.ranges[_i73]))return false;}return true;}/**
    Get the primary selection range. Usually, you should make sure
    your code applies to _all_ ranges, by using methods like
    [`changeByRange`](https://codemirror.net/6/docs/ref/#state.EditorState.changeByRange).
    */},{key:"main",get:function get(){return this.ranges[this.mainIndex];}/**
    Make sure the selection only has one range. Returns a selection
    holding only the main range from this selection.
    */},{key:"asSingle",value:function asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0);}/**
    Extend this selection with an extra range.
    */},{key:"addRange",value:function addRange(range){var main=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return EditorSelection.create([range].concat(this.ranges),main?0:this.mainIndex+1);}/**
    Replace a given range with another range, and then normalize the
    selection to merge and sort ranges if necessary.
    */},{key:"replaceRange",value:function replaceRange(range){var which=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.mainIndex;var ranges=this.ranges.slice();ranges[which]=range;return EditorSelection.create(ranges,this.mainIndex);}/**
    Convert this selection to an object that can be serialized to
    JSON.
    */},{key:"toJSON",value:function toJSON(){return{ranges:this.ranges.map(function(r){return r.toJSON();}),main:this.mainIndex};}/**
    Create a selection from a JSON representation.
    */}],[{key:"fromJSON",value:function fromJSON(json){if(!json||!Array.isArray(json.ranges)||typeof json.main!="number"||json.main>=json.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(json.ranges.map(function(r){return SelectionRange.fromJSON(r);}),json.main);}/**
    Create a selection holding a single range.
    */},{key:"single",value:function single(anchor){var head=arguments.length>1&&arguments[1]!==undefined?arguments[1]:anchor;return new EditorSelection([EditorSelection.range(anchor,head)],0);}/**
    Sort and merge the given set of ranges, creating a valid
    selection.
    */},{key:"create",value:function create(ranges){var mainIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(ranges.length==0)throw new RangeError("A selection needs at least one range");for(var pos=0,_i74=0;_i74<ranges.length;_i74++){var _range=ranges[_i74];if(_range.empty?_range.from<=pos:_range.from<pos)return EditorSelection.normalized(ranges.slice(),mainIndex);pos=_range.to;}return new EditorSelection(ranges,mainIndex);}/**
    Create a cursor selection range at the given position. You can
    safely ignore the optional arguments in most situations.
    */},{key:"cursor",value:function cursor(pos){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var bidiLevel=arguments.length>2?arguments[2]:undefined;var goalColumn=arguments.length>3?arguments[3]:undefined;return SelectionRange.create(pos,pos,(assoc==0?0:assoc<0?4/* RangeFlag.AssocBefore */:8/* RangeFlag.AssocAfter */)|(bidiLevel==null?3:Math.min(2,bidiLevel))|(goalColumn!==null&&goalColumn!==void 0?goalColumn:33554431/* RangeFlag.NoGoalColumn */)<<5/* RangeFlag.GoalColumnOffset */);}/**
    Create a selection range.
    */},{key:"range",value:function range(anchor,head,goalColumn){var goal=(goalColumn!==null&&goalColumn!==void 0?goalColumn:33554431/* RangeFlag.NoGoalColumn */)<<5/* RangeFlag.GoalColumnOffset */;return head<anchor?SelectionRange.create(head,anchor,16/* RangeFlag.Inverted */|goal|8/* RangeFlag.AssocAfter */):SelectionRange.create(anchor,head,goal|(head>anchor?4/* RangeFlag.AssocBefore */:0));}/**
    @internal
    */},{key:"normalized",value:function normalized(ranges){var mainIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var main=ranges[mainIndex];ranges.sort(function(a,b){return a.from-b.from;});mainIndex=ranges.indexOf(main);for(var _i75=1;_i75<ranges.length;_i75++){var _range2=ranges[_i75],prev=ranges[_i75-1];if(_range2.empty?_range2.from<=prev.to:_range2.from<prev.to){var from=prev.from,to=Math.max(_range2.to,prev.to);if(_i75<=mainIndex)mainIndex--;ranges.splice(--_i75,2,_range2.anchor>_range2.head?EditorSelection.range(to,from):EditorSelection.range(from,to));}}return new EditorSelection(ranges,mainIndex);}}]);return EditorSelection;}();function checkSelection(selection,docLength){var _iterator11=_createForOfIteratorHelper(selection.ranges),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _range3=_step11.value;if(_range3.to>docLength)throw new RangeError("Selection points outside of document");}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}var nextID=0;/**
A facet is a labeled value that is associated with an editor
state. It takes inputs from any number of extensions, and combines
those into a single output value.

Examples of uses of facets are the [tab
size](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize), [editor
attributes](https://codemirror.net/6/docs/ref/#view.EditorView^editorAttributes), and [update
listeners](https://codemirror.net/6/docs/ref/#view.EditorView^updateListener).
*/var Facet=/*#__PURE__*/function(){function Facet(/**
    @internal
    */combine,/**
    @internal
    */compareInput,/**
    @internal
    */compare,isStatic,enables){_classCallCheck(this,Facet);this.combine=combine;this.compareInput=compareInput;this.compare=compare;this.isStatic=isStatic;/**
        @internal
        */this.id=nextID++;this["default"]=combine([]);this.extensions=typeof enables=="function"?enables(this):enables;}/**
    Define a new facet.
    */_createClass(Facet,[{key:"of",value:/**
    Returns an extension that adds the given value to this facet.
    */function of(value){return new FacetProvider([],this,0/* Provider.Static */,value);}/**
    Create an extension that computes a value for the facet from a
    state. You must take care to declare the parts of the state that
    this value depends on, since your function is only called again
    for a new state when one of those parts changed.
    
    In cases where your value depends only on a single field, you'll
    want to use the [`from`](https://codemirror.net/6/docs/ref/#state.Facet.from) method instead.
    */},{key:"compute",value:function compute(deps,get){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,1/* Provider.Single */,get);}/**
    Create an extension that computes zero or more values for this
    facet from a state.
    */},{key:"computeN",value:function computeN(deps,get){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,2/* Provider.Multi */,get);}},{key:"from",value:function from(field,get){if(!get)get=function get(x){return x;};return this.compute([field],function(state){return get(state.field(field));});}}],[{key:"define",value:function define(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new Facet(config.combine||function(a){return a;},config.compareInput||function(a,b){return a===b;},config.compare||(!config.combine?sameArray$1:function(a,b){return a===b;}),!!config["static"],config.enables);}}]);return Facet;}();function sameArray$1(a,b){return a==b||a.length==b.length&&a.every(function(e,i){return e===b[i];});}var FacetProvider=/*#__PURE__*/function(){function FacetProvider(dependencies,facet,type,value){_classCallCheck(this,FacetProvider);this.dependencies=dependencies;this.facet=facet;this.type=type;this.value=value;this.id=nextID++;}_createClass(FacetProvider,[{key:"dynamicSlot",value:function dynamicSlot(addresses){var _this18=this;var _a;var getter=this.value;var compare=this.facet.compareInput;var id=this.id,idx=addresses[id]>>1,multi=this.type==2/* Provider.Multi */;var depDoc=false,depSel=false,depAddrs=[];var _iterator12=_createForOfIteratorHelper(this.dependencies),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var dep=_step12.value;if(dep=="doc")depDoc=true;else if(dep=="selection")depSel=true;else if((((_a=addresses[dep.id])!==null&&_a!==void 0?_a:1)&1)==0)depAddrs.push(addresses[dep.id]);}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}return{create:function create(state){state.values[idx]=getter(state);return 1/* SlotStatus.Changed */;},update:function update(state,tr){if(depDoc&&tr.docChanged||depSel&&(tr.docChanged||tr.selection)||ensureAll(state,depAddrs)){var newVal=getter(state);if(multi?!compareArray(newVal,state.values[idx],compare):!compare(newVal,state.values[idx])){state.values[idx]=newVal;return 1/* SlotStatus.Changed */;}}return 0;},reconfigure:function reconfigure(state,oldState){var newVal=getter(state);var oldAddr=oldState.config.address[id];if(oldAddr!=null){var oldVal=getAddr(oldState,oldAddr);if(_this18.dependencies.every(function(dep){return dep instanceof Facet?oldState.facet(dep)===state.facet(dep):dep instanceof StateField?oldState.field(dep,false)==state.field(dep,false):true;})||(multi?compareArray(newVal,oldVal,compare):compare(newVal,oldVal))){state.values[idx]=oldVal;return 0;}}state.values[idx]=newVal;return 1/* SlotStatus.Changed */;}};}}]);return FacetProvider;}();function compareArray(a,b,compare){if(a.length!=b.length)return false;for(var _i76=0;_i76<a.length;_i76++){if(!compare(a[_i76],b[_i76]))return false;}return true;}function ensureAll(state,addrs){var changed=false;var _iterator13=_createForOfIteratorHelper(addrs),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var addr=_step13.value;if(ensureAddr(state,addr)&1/* SlotStatus.Changed */)changed=true;}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}return changed;}function dynamicFacetSlot(addresses,facet,providers){var providerAddrs=providers.map(function(p){return addresses[p.id];});var providerTypes=providers.map(function(p){return p.type;});var dynamic=providerAddrs.filter(function(p){return!(p&1);});var idx=addresses[facet.id]>>1;function get(state){var values=[];for(var _i77=0;_i77<providerAddrs.length;_i77++){var value=getAddr(state,providerAddrs[_i77]);if(providerTypes[_i77]==2/* Provider.Multi */){var _iterator14=_createForOfIteratorHelper(value),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var val=_step14.value;values.push(val);}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}}else values.push(value);}return facet.combine(values);}return{create:function create(state){var _iterator15=_createForOfIteratorHelper(providerAddrs),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var addr=_step15.value;ensureAddr(state,addr);}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}state.values[idx]=get(state);return 1/* SlotStatus.Changed */;},update:function update(state,tr){if(!ensureAll(state,dynamic))return 0;var value=get(state);if(facet.compare(value,state.values[idx]))return 0;state.values[idx]=value;return 1/* SlotStatus.Changed */;},reconfigure:function reconfigure(state,oldState){var depChanged=ensureAll(state,providerAddrs);var oldProviders=oldState.config.facets[facet.id],oldValue=oldState.facet(facet);if(oldProviders&&!depChanged&&sameArray$1(providers,oldProviders)){state.values[idx]=oldValue;return 0;}var value=get(state);if(facet.compare(value,oldValue)){state.values[idx]=oldValue;return 0;}state.values[idx]=value;return 1/* SlotStatus.Changed */;}};}var initField=/*@__PURE__*/Facet.define({"static":true});/**
Fields can store additional information in an editor state, and
keep it in sync with the rest of the state.
*/var StateField=/*#__PURE__*/function(){function StateField(/**
    @internal
    */id,createF,updateF,compareF,/**
    @internal
    */spec){_classCallCheck(this,StateField);this.id=id;this.createF=createF;this.updateF=updateF;this.compareF=compareF;this.spec=spec;/**
        @internal
        */this.provides=undefined;}/**
    Define a state field.
    */_createClass(StateField,[{key:"create",value:function create(state){var _this19=this;var init=state.facet(initField).find(function(i){return i.field==_this19;});return((init===null||init===void 0?void 0:init.create)||this.createF)(state);}/**
    @internal
    */},{key:"slot",value:function slot(addresses){var _this20=this;var idx=addresses[this.id]>>1;return{create:function create(state){state.values[idx]=_this20.create(state);return 1/* SlotStatus.Changed */;},update:function update(state,tr){var oldVal=state.values[idx];var value=_this20.updateF(oldVal,tr);if(_this20.compareF(oldVal,value))return 0;state.values[idx]=value;return 1/* SlotStatus.Changed */;},reconfigure:function reconfigure(state,oldState){if(oldState.config.address[_this20.id]!=null){state.values[idx]=oldState.field(_this20);return 0;}state.values[idx]=_this20.create(state);return 1/* SlotStatus.Changed */;}};}/**
    Returns an extension that enables this field and overrides the
    way it is initialized. Can be useful when you need to provide a
    non-default starting value for the field.
    */},{key:"init",value:function init(create){return[this,initField.of({field:this,create:create})];}/**
    State field instances can be used as
    [`Extension`](https://codemirror.net/6/docs/ref/#state.Extension) values to enable the field in a
    given state.
    */},{key:"extension",get:function get(){return this;}}],[{key:"define",value:function define(config){var field=new StateField(nextID++,config.create,config.update,config.compare||function(a,b){return a===b;},config);if(config.provide)field.provides=config.provide(field);return field;}}]);return StateField;}();var Prec_={lowest:4,low:3,"default":2,high:1,highest:0};function prec(value){return function(ext){return new PrecExtension(ext,value);};}/**
By default extensions are registered in the order they are found
in the flattened form of nested array that was provided.
Individual extension values can be assigned a precedence to
override this. Extensions that do not have a precedence set get
the precedence of the nearest parent with a precedence, or
[`default`](https://codemirror.net/6/docs/ref/#state.Prec.default) if there is no such parent. The
final ordering of extensions is determined by first sorting by
precedence and then by order within each precedence.
*/var Prec={/**
    The highest precedence level, for extensions that should end up
    near the start of the precedence ordering.
    */highest:/*@__PURE__*/prec(Prec_.highest),/**
    A higher-than-default precedence, for extensions that should
    come before those with default precedence.
    */high:/*@__PURE__*/prec(Prec_.high),/**
    The default precedence, which is also used for extensions
    without an explicit precedence.
    */"default":/*@__PURE__*/prec(Prec_["default"]),/**
    A lower-than-default precedence.
    */low:/*@__PURE__*/prec(Prec_.low),/**
    The lowest precedence level. Meant for things that should end up
    near the end of the extension order.
    */lowest:/*@__PURE__*/prec(Prec_.lowest)};var PrecExtension=/*#__PURE__*/_createClass(function PrecExtension(inner,prec){_classCallCheck(this,PrecExtension);this.inner=inner;this.prec=prec;});/**
Extension compartments can be used to make a configuration
dynamic. By [wrapping](https://codemirror.net/6/docs/ref/#state.Compartment.of) part of your
configuration in a compartment, you can later
[replace](https://codemirror.net/6/docs/ref/#state.Compartment.reconfigure) that part through a
transaction.
*/var Compartment=/*#__PURE__*/function(){function Compartment(){_classCallCheck(this,Compartment);}_createClass(Compartment,[{key:"of",value:/**
    Create an instance of this compartment to add to your [state
    configuration](https://codemirror.net/6/docs/ref/#state.EditorStateConfig.extensions).
    */function of(ext){return new CompartmentInstance(this,ext);}/**
    Create an [effect](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) that
    reconfigures this compartment.
    */},{key:"reconfigure",value:function reconfigure(content){return Compartment.reconfigure.of({compartment:this,extension:content});}/**
    Get the current content of the compartment in the state, or
    `undefined` if it isn't present.
    */},{key:"get",value:function get(state){return state.config.compartments.get(this);}}]);return Compartment;}();var CompartmentInstance=/*#__PURE__*/_createClass(function CompartmentInstance(compartment,inner){_classCallCheck(this,CompartmentInstance);this.compartment=compartment;this.inner=inner;});var Configuration=/*#__PURE__*/function(){function Configuration(base,compartments,dynamicSlots,address,staticValues,facets){_classCallCheck(this,Configuration);this.base=base;this.compartments=compartments;this.dynamicSlots=dynamicSlots;this.address=address;this.staticValues=staticValues;this.facets=facets;this.statusTemplate=[];while(this.statusTemplate.length<dynamicSlots.length){this.statusTemplate.push(0/* SlotStatus.Unresolved */);}}_createClass(Configuration,[{key:"staticFacet",value:function staticFacet(facet){var addr=this.address[facet.id];return addr==null?facet["default"]:this.staticValues[addr>>1];}}],[{key:"resolve",value:function resolve(base,compartments,oldState){var fields=[];var facets=Object.create(null);var newCompartments=new Map();var _iterator16=_createForOfIteratorHelper(flatten(base,compartments,newCompartments)),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var ext=_step16.value;if(ext instanceof StateField)fields.push(ext);else(facets[ext.facet.id]||(facets[ext.facet.id]=[])).push(ext);}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}var address=Object.create(null);var staticValues=[];var dynamicSlots=[];var _loop=function _loop(){var field=_fields[_i78];address[field.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return field.slot(a);});};for(var _i78=0,_fields=fields;_i78<_fields.length;_i78++){_loop();}var oldFacets=oldState===null||oldState===void 0?void 0:oldState.config.facets;var _loop2=function _loop2(_id){var providers=facets[_id],facet=providers[0].facet;var oldProviders=oldFacets&&oldFacets[_id]||[];if(providers.every(function(p){return p.type==0;}/* Provider.Static */)){address[facet.id]=staticValues.length<<1|1;if(sameArray$1(oldProviders,providers)){staticValues.push(oldState.facet(facet));}else{var value=facet.combine(providers.map(function(p){return p.value;}));staticValues.push(oldState&&facet.compare(value,oldState.facet(facet))?oldState.facet(facet):value);}}else{var _iterator17=_createForOfIteratorHelper(providers),_step17;try{var _loop3=function _loop3(){var p=_step17.value;if(p.type==0/* Provider.Static */){address[p.id]=staticValues.length<<1|1;staticValues.push(p.value);}else{address[p.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return p.dynamicSlot(a);});}};for(_iterator17.s();!(_step17=_iterator17.n()).done;){_loop3();}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}address[facet.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return dynamicFacetSlot(a,facet,providers);});}};for(var _id in facets){_loop2(_id);}var dynamic=dynamicSlots.map(function(f){return f(address);});return new Configuration(base,newCompartments,dynamic,address,staticValues,facets);}}]);return Configuration;}();function flatten(extension,compartments,newCompartments){var result=[[],[],[],[],[]];var seen=new Map();function inner(ext,prec){var known=seen.get(ext);if(known!=null){if(known<=prec)return;var found=result[known].indexOf(ext);if(found>-1)result[known].splice(found,1);if(ext instanceof CompartmentInstance)newCompartments["delete"](ext.compartment);}seen.set(ext,prec);if(Array.isArray(ext)){var _iterator18=_createForOfIteratorHelper(ext),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var e=_step18.value;inner(e,prec);}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}else if(ext instanceof CompartmentInstance){if(newCompartments.has(ext.compartment))throw new RangeError("Duplicate use of compartment in extensions");var _content=compartments.get(ext.compartment)||ext.inner;newCompartments.set(ext.compartment,_content);inner(_content,prec);}else if(ext instanceof PrecExtension){inner(ext.inner,ext.prec);}else if(ext instanceof StateField){result[prec].push(ext);if(ext.provides)inner(ext.provides,prec);}else if(ext instanceof FacetProvider){result[prec].push(ext);if(ext.facet.extensions)inner(ext.facet.extensions,Prec_["default"]);}else{var _content2=ext.extension;if(!_content2)throw new Error("Unrecognized extension value in extension set (".concat(ext,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));inner(_content2,prec);}}inner(extension,Prec_["default"]);return result.reduce(function(a,b){return a.concat(b);});}function ensureAddr(state,addr){if(addr&1)return 2/* SlotStatus.Computed */;var idx=addr>>1;var status=state.status[idx];if(status==4/* SlotStatus.Computing */)throw new Error("Cyclic dependency between fields and/or facets");if(status&2/* SlotStatus.Computed */)return status;state.status[idx]=4/* SlotStatus.Computing */;var changed=state.computeSlot(state,state.config.dynamicSlots[idx]);return state.status[idx]=2/* SlotStatus.Computed */|changed;}function getAddr(state,addr){return addr&1?state.config.staticValues[addr>>1]:state.values[addr>>1];}var languageData=/*@__PURE__*/Facet.define();var allowMultipleSelections=/*@__PURE__*/Facet.define({combine:function combine(values){return values.some(function(v){return v;});},"static":true});var lineSeparator=/*@__PURE__*/Facet.define({combine:function combine(values){return values.length?values[0]:undefined;},"static":true});var changeFilter=/*@__PURE__*/Facet.define();var transactionFilter=/*@__PURE__*/Facet.define();var transactionExtender=/*@__PURE__*/Facet.define();var readOnly=/*@__PURE__*/Facet.define({combine:function combine(values){return values.length?values[0]:false;}});/**
Annotations are tagged values that are used to add metadata to
transactions in an extensible way. They should be used to model
things that effect the entire transaction (such as its [time
stamp](https://codemirror.net/6/docs/ref/#state.Transaction^time) or information about its
[origin](https://codemirror.net/6/docs/ref/#state.Transaction^userEvent)). For effects that happen
_alongside_ the other changes made by the transaction, [state
effects](https://codemirror.net/6/docs/ref/#state.StateEffect) are more appropriate.
*/var Annotation=/*#__PURE__*/function(){/**
    @internal
    */function Annotation(/**
    The annotation type.
    */type,/**
    The value of this annotation.
    */value){_classCallCheck(this,Annotation);this.type=type;this.value=value;}/**
    Define a new type of annotation.
    */_createClass(Annotation,null,[{key:"define",value:function define(){return new AnnotationType();}}]);return Annotation;}();/**
Marker that identifies a type of [annotation](https://codemirror.net/6/docs/ref/#state.Annotation).
*/var AnnotationType=/*#__PURE__*/function(){function AnnotationType(){_classCallCheck(this,AnnotationType);}_createClass(AnnotationType,[{key:"of",value:/**
    Create an instance of this annotation.
    */function of(value){return new Annotation(this,value);}}]);return AnnotationType;}();/**
Representation of a type of state effect. Defined with
[`StateEffect.define`](https://codemirror.net/6/docs/ref/#state.StateEffect^define).
*/var StateEffectType=/*#__PURE__*/function(){/**
    @internal
    */function StateEffectType(// The `any` types in these function types are there to work
// around TypeScript issue #37631, where the type guard on
// `StateEffect.is` mysteriously stops working when these properly
// have type `Value`.
/**
    @internal
    */map){_classCallCheck(this,StateEffectType);this.map=map;}/**
    Create a [state effect](https://codemirror.net/6/docs/ref/#state.StateEffect) instance of this
    type.
    */_createClass(StateEffectType,[{key:"of",value:function of(value){return new StateEffect(this,value);}}]);return StateEffectType;}();/**
State effects can be used to represent additional effects
associated with a [transaction](https://codemirror.net/6/docs/ref/#state.Transaction.effects). They
are often useful to model changes to custom [state
fields](https://codemirror.net/6/docs/ref/#state.StateField), when those changes aren't implicit in
document or selection changes.
*/var StateEffect=/*#__PURE__*/function(){/**
    @internal
    */function StateEffect(/**
    @internal
    */type,/**
    The value of this effect.
    */value){_classCallCheck(this,StateEffect);this.type=type;this.value=value;}/**
    Map this effect through a position mapping. Will return
    `undefined` when that ends up deleting the effect.
    */_createClass(StateEffect,[{key:"map",value:function map(mapping){var mapped=this.type.map(this.value,mapping);return mapped===undefined?undefined:mapped==this.value?this:new StateEffect(this.type,mapped);}/**
    Tells you whether this effect object is of a given
    [type](https://codemirror.net/6/docs/ref/#state.StateEffectType).
    */},{key:"is",value:function is(type){return this.type==type;}/**
    Define a new effect type. The type parameter indicates the type
    of values that his effect holds.
    */}],[{key:"define",value:function define(){var spec=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new StateEffectType(spec.map||function(v){return v;});}/**
    Map an array of effects through a change set.
    */},{key:"mapEffects",value:function mapEffects(effects,mapping){if(!effects.length)return effects;var result=[];var _iterator19=_createForOfIteratorHelper(effects),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var effect=_step19.value;var mapped=effect.map(mapping);if(mapped)result.push(mapped);}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}return result;}}]);return StateEffect;}();/**
This effect can be used to reconfigure the root extensions of
the editor. Doing this will discard any extensions
[appended](https://codemirror.net/6/docs/ref/#state.StateEffect^appendConfig), but does not reset
the content of [reconfigured](https://codemirror.net/6/docs/ref/#state.Compartment.reconfigure)
compartments.
*/StateEffect.reconfigure=/*@__PURE__*/StateEffect.define();/**
Append extensions to the top-level configuration of the editor.
*/StateEffect.appendConfig=/*@__PURE__*/StateEffect.define();/**
Changes to the editor state are grouped into transactions.
Typically, a user action creates a single transaction, which may
contain any number of document changes, may change the selection,
or have other effects. Create a transaction by calling
[`EditorState.update`](https://codemirror.net/6/docs/ref/#state.EditorState.update), or immediately
dispatch one by calling
[`EditorView.dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch).
*/var Transaction=/*#__PURE__*/function(){function Transaction(/**
    The state from which the transaction starts.
    */startState,/**
    The document changes made by this transaction.
    */changes,/**
    The selection set by this transaction, or undefined if it
    doesn't explicitly set a selection.
    */selection,/**
    The effects added to the transaction.
    */effects,/**
    @internal
    */annotations,/**
    Whether the selection should be scrolled into view after this
    transaction is dispatched.
    */scrollIntoView){_classCallCheck(this,Transaction);this.startState=startState;this.changes=changes;this.selection=selection;this.effects=effects;this.annotations=annotations;this.scrollIntoView=scrollIntoView;/**
        @internal
        */this._doc=null;/**
        @internal
        */this._state=null;if(selection)checkSelection(selection,changes.newLength);if(!annotations.some(function(a){return a.type==Transaction.time;}))this.annotations=annotations.concat(Transaction.time.of(Date.now()));}/**
    @internal
    */_createClass(Transaction,[{key:"newDoc",get:/**
    The new document produced by the transaction. Contrary to
    [`.state`](https://codemirror.net/6/docs/ref/#state.Transaction.state)`.doc`, accessing this won't
    force the entire new state to be computed right away, so it is
    recommended that [transaction
    filters](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter) use this getter
    when they need to look at the new document.
    */function get(){return this._doc||(this._doc=this.changes.apply(this.startState.doc));}/**
    The new selection produced by the transaction. If
    [`this.selection`](https://codemirror.net/6/docs/ref/#state.Transaction.selection) is undefined,
    this will [map](https://codemirror.net/6/docs/ref/#state.EditorSelection.map) the start state's
    current selection through the changes made by the transaction.
    */},{key:"newSelection",get:function get(){return this.selection||this.startState.selection.map(this.changes);}/**
    The new state created by the transaction. Computed on demand
    (but retained for subsequent access), so it is recommended not to
    access it in [transaction
    filters](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter) when possible.
    */},{key:"state",get:function get(){if(!this._state)this.startState.applyTransaction(this);return this._state;}/**
    Get the value of the given annotation type, if any.
    */},{key:"annotation",value:function annotation(type){var _iterator20=_createForOfIteratorHelper(this.annotations),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var ann=_step20.value;if(ann.type==type)return ann.value;}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}return undefined;}/**
    Indicates whether the transaction changed the document.
    */},{key:"docChanged",get:function get(){return!this.changes.empty;}/**
    Indicates whether this transaction reconfigures the state
    (through a [configuration compartment](https://codemirror.net/6/docs/ref/#state.Compartment) or
    with a top-level configuration
    [effect](https://codemirror.net/6/docs/ref/#state.StateEffect^reconfigure).
    */},{key:"reconfigured",get:function get(){return this.startState.config!=this.state.config;}/**
    Returns true if the transaction has a [user
    event](https://codemirror.net/6/docs/ref/#state.Transaction^userEvent) annotation that is equal to
    or more specific than `event`. For example, if the transaction
    has `"select.pointer"` as user event, `"select"` and
    `"select.pointer"` will match it.
    */},{key:"isUserEvent",value:function isUserEvent(event){var e=this.annotation(Transaction.userEvent);return!!(e&&(e==event||e.length>event.length&&e.slice(0,event.length)==event&&e[event.length]=="."));}}],[{key:"create",value:function create(startState,changes,selection,effects,annotations,scrollIntoView){return new Transaction(startState,changes,selection,effects,annotations,scrollIntoView);}}]);return Transaction;}();/**
Annotation used to store transaction timestamps. Automatically
added to every transaction, holding `Date.now()`.
*/Transaction.time=/*@__PURE__*/Annotation.define();/**
Annotation used to associate a transaction with a user interface
event. Holds a string identifying the event, using a
dot-separated format to support attaching more specific
information. The events used by the core libraries are:

 - `"input"` when content is entered
   - `"input.type"` for typed input
     - `"input.type.compose"` for composition
   - `"input.paste"` for pasted input
   - `"input.drop"` when adding content with drag-and-drop
   - `"input.complete"` when autocompleting
 - `"delete"` when the user deletes content
   - `"delete.selection"` when deleting the selection
   - `"delete.forward"` when deleting forward from the selection
   - `"delete.backward"` when deleting backward from the selection
   - `"delete.cut"` when cutting to the clipboard
 - `"move"` when content is moved
   - `"move.drop"` when content is moved within the editor through drag-and-drop
 - `"select"` when explicitly changing the selection
   - `"select.pointer"` when selecting with a mouse or other pointing device
 - `"undo"` and `"redo"` for history actions

Use [`isUserEvent`](https://codemirror.net/6/docs/ref/#state.Transaction.isUserEvent) to check
whether the annotation matches a given event.
*/Transaction.userEvent=/*@__PURE__*/Annotation.define();/**
Annotation indicating whether a transaction should be added to
the undo history or not.
*/Transaction.addToHistory=/*@__PURE__*/Annotation.define();/**
Annotation indicating (when present and true) that a transaction
represents a change made by some other actor, not the user. This
is used, for example, to tag other people's changes in
collaborative editing.
*/Transaction.remote=/*@__PURE__*/Annotation.define();function joinRanges(a,b){var result=[];for(var iA=0,iB=0;;){var from=void 0,to=void 0;if(iA<a.length&&(iB==b.length||b[iB]>=a[iA])){from=a[iA++];to=a[iA++];}else if(iB<b.length){from=b[iB++];to=b[iB++];}else return result;if(!result.length||result[result.length-1]<from)result.push(from,to);else if(result[result.length-1]<to)result[result.length-1]=to;}}function mergeTransaction(a,b,sequential){var _a;var mapForA,mapForB,changes;if(sequential){mapForA=b.changes;mapForB=ChangeSet.empty(b.changes.length);changes=a.changes.compose(b.changes);}else{mapForA=b.changes.map(a.changes);mapForB=a.changes.mapDesc(b.changes,true);changes=a.changes.compose(mapForA);}return{changes:changes,selection:b.selection?b.selection.map(mapForB):(_a=a.selection)===null||_a===void 0?void 0:_a.map(mapForA),effects:StateEffect.mapEffects(a.effects,mapForA).concat(StateEffect.mapEffects(b.effects,mapForB)),annotations:a.annotations.length?a.annotations.concat(b.annotations):b.annotations,scrollIntoView:a.scrollIntoView||b.scrollIntoView};}function resolveTransactionInner(state,spec,docSize){var sel=spec.selection,annotations=asArray$1(spec.annotations);if(spec.userEvent)annotations=annotations.concat(Transaction.userEvent.of(spec.userEvent));return{changes:spec.changes instanceof ChangeSet?spec.changes:ChangeSet.of(spec.changes||[],docSize,state.facet(lineSeparator)),selection:sel&&(sel instanceof EditorSelection?sel:EditorSelection.single(sel.anchor,sel.head)),effects:asArray$1(spec.effects),annotations:annotations,scrollIntoView:!!spec.scrollIntoView};}function resolveTransaction(state,specs,filter){var s=resolveTransactionInner(state,specs.length?specs[0]:{},state.doc.length);if(specs.length&&specs[0].filter===false)filter=false;for(var _i79=1;_i79<specs.length;_i79++){if(specs[_i79].filter===false)filter=false;var _seq=!!specs[_i79].sequential;s=mergeTransaction(s,resolveTransactionInner(state,specs[_i79],_seq?s.changes.newLength:state.doc.length),_seq);}var tr=Transaction.create(state,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return extendTransaction(filter?filterTransaction(tr):tr);}// Finish a transaction by applying filters if necessary.
function filterTransaction(tr){var state=tr.startState;// Change filters
var result=true;var _iterator21=_createForOfIteratorHelper(state.facet(changeFilter)),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var _filter=_step21.value;var value=_filter(tr);if(value===false){result=false;break;}if(Array.isArray(value))result=result===true?value:joinRanges(result,value);}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}if(result!==true){var changes,back;if(result===false){back=tr.changes.invertedDesc;changes=ChangeSet.empty(state.doc.length);}else{var filtered=tr.changes.filter(result);changes=filtered.changes;back=filtered.filtered.mapDesc(filtered.changes).invertedDesc;}tr=Transaction.create(state,changes,tr.selection&&tr.selection.map(back),StateEffect.mapEffects(tr.effects,back),tr.annotations,tr.scrollIntoView);}// Transaction filters
var filters=state.facet(transactionFilter);for(var _i80=filters.length-1;_i80>=0;_i80--){var _filtered=filters[_i80](tr);if(_filtered instanceof Transaction)tr=_filtered;else if(Array.isArray(_filtered)&&_filtered.length==1&&_filtered[0]instanceof Transaction)tr=_filtered[0];else tr=resolveTransaction(state,asArray$1(_filtered),false);}return tr;}function extendTransaction(tr){var state=tr.startState,extenders=state.facet(transactionExtender),spec=tr;for(var _i81=extenders.length-1;_i81>=0;_i81--){var extension=extenders[_i81](tr);if(extension&&Object.keys(extension).length)spec=mergeTransaction(spec,resolveTransactionInner(state,extension,tr.changes.newLength),true);}return spec==tr?tr:Transaction.create(state,tr.changes,tr.selection,spec.effects,spec.annotations,spec.scrollIntoView);}var none$2=[];function asArray$1(value){return value==null?none$2:Array.isArray(value)?value:[value];}/**
The categories produced by a [character
categorizer](https://codemirror.net/6/docs/ref/#state.EditorState.charCategorizer). These are used
do things like selecting by word.
*/var CharCategory=/*@__PURE__*/function(CharCategory){/**
    Word characters.
    */CharCategory[CharCategory["Word"]=0]="Word";/**
    Whitespace.
    */CharCategory[CharCategory["Space"]=1]="Space";/**
    Anything else.
    */CharCategory[CharCategory["Other"]=2]="Other";return CharCategory;}(CharCategory||(CharCategory={}));var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var wordChar;try{wordChar=/*@__PURE__*/new RegExp("[\\p{Alphabetic}\\p{Number}_]","u");}catch(_){}function hasWordChar(str){if(wordChar)return wordChar.test(str);for(var _i82=0;_i82<str.length;_i82++){var ch=str[_i82];if(/\w/.test(ch)||ch>"\x80"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch)))return true;}return false;}function makeCategorizer(wordChars){return function(_char9){if(!/\S/.test(_char9))return CharCategory.Space;if(hasWordChar(_char9))return CharCategory.Word;for(var _i83=0;_i83<wordChars.length;_i83++){if(_char9.indexOf(wordChars[_i83])>-1)return CharCategory.Word;}return CharCategory.Other;};}/**
The editor state class is a persistent (immutable) data structure.
To update a state, you [create](https://codemirror.net/6/docs/ref/#state.EditorState.update) a
[transaction](https://codemirror.net/6/docs/ref/#state.Transaction), which produces a _new_ state
instance, without modifying the original object.

As such, _never_ mutate properties of a state directly. That'll
just break things.
*/var EditorState=/*#__PURE__*/function(){function EditorState(/**
    @internal
    */config,/**
    The current document.
    */doc,/**
    The current selection.
    */selection,/**
    @internal
    */values,computeSlot,tr){_classCallCheck(this,EditorState);this.config=config;this.doc=doc;this.selection=selection;this.values=values;this.status=config.statusTemplate.slice();this.computeSlot=computeSlot;// Fill in the computed state immediately, so that further queries
// for it made during the update return this state
if(tr)tr._state=this;for(var _i84=0;_i84<this.config.dynamicSlots.length;_i84++){ensureAddr(this,_i84<<1);}this.computeSlot=null;}_createClass(EditorState,[{key:"field",value:function field(_field){var require=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var addr=this.config.address[_field.id];if(addr==null){if(require)throw new RangeError("Field is not present in this state");return undefined;}ensureAddr(this,addr);return getAddr(this,addr);}/**
    Create a [transaction](https://codemirror.net/6/docs/ref/#state.Transaction) that updates this
    state. Any number of [transaction specs](https://codemirror.net/6/docs/ref/#state.TransactionSpec)
    can be passed. Unless
    [`sequential`](https://codemirror.net/6/docs/ref/#state.TransactionSpec.sequential) is set, the
    [changes](https://codemirror.net/6/docs/ref/#state.TransactionSpec.changes) (if any) of each spec
    are assumed to start in the _current_ document (not the document
    produced by previous specs), and its
    [selection](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection) and
    [effects](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) are assumed to refer
    to the document created by its _own_ changes. The resulting
    transaction contains the combined effect of all the different
    specs. For [selection](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection), later
    specs take precedence over earlier ones.
    */},{key:"update",value:function update(){for(var _len5=arguments.length,specs=new Array(_len5),_key6=0;_key6<_len5;_key6++){specs[_key6]=arguments[_key6];}return resolveTransaction(this,specs,true);}/**
    @internal
    */},{key:"applyTransaction",value:function applyTransaction(tr){var _this21=this;var conf=this.config,_conf=conf,base=_conf.base,compartments=_conf.compartments;var _iterator22=_createForOfIteratorHelper(tr.effects),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var effect=_step22.value;if(effect.is(Compartment.reconfigure)){if(conf){compartments=new Map();conf.compartments.forEach(function(val,key){return compartments.set(key,val);});conf=null;}compartments.set(effect.value.compartment,effect.value.extension);}else if(effect.is(StateEffect.reconfigure)){conf=null;base=effect.value;}else if(effect.is(StateEffect.appendConfig)){conf=null;base=asArray$1(base).concat(effect.value);}}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}var startValues;if(!conf){conf=Configuration.resolve(base,compartments,this);var intermediateState=new EditorState(conf,this.doc,this.selection,conf.dynamicSlots.map(function(){return null;}),function(state,slot){return slot.reconfigure(state,_this21);},null);startValues=intermediateState.values;}else{startValues=tr.startState.values.slice();}new EditorState(conf,tr.newDoc,tr.newSelection,startValues,function(state,slot){return slot.update(state,tr);},tr);}/**
    Create a [transaction spec](https://codemirror.net/6/docs/ref/#state.TransactionSpec) that
    replaces every selection range with the given content.
    */},{key:"replaceSelection",value:function replaceSelection(text){if(typeof text=="string")text=this.toText(text);return this.changeByRange(function(range){return{changes:{from:range.from,to:range.to,insert:text},range:EditorSelection.cursor(range.from+text.length)};});}/**
    Create a set of changes and a new selection by running the given
    function for each range in the active selection. The function
    can return an optional set of changes (in the coordinate space
    of the start document), plus an updated range (in the coordinate
    space of the document produced by the call's own changes). This
    method will merge all the changes and ranges into a single
    changeset and selection, and return it as a [transaction
    spec](https://codemirror.net/6/docs/ref/#state.TransactionSpec), which can be passed to
    [`update`](https://codemirror.net/6/docs/ref/#state.EditorState.update).
    */},{key:"changeByRange",value:function changeByRange(f){var sel=this.selection;var result1=f(sel.ranges[0]);var changes=this.changes(result1.changes),ranges=[result1.range];var effects=asArray$1(result1.effects);for(var _i85=1;_i85<sel.ranges.length;_i85++){var _result2=f(sel.ranges[_i85]);var newChanges=this.changes(_result2.changes),newMapped=newChanges.map(changes);for(var j=0;j<_i85;j++){ranges[j]=ranges[j].map(newMapped);}var mapBy=changes.mapDesc(newChanges,true);ranges.push(_result2.range.map(mapBy));changes=changes.compose(newMapped);effects=StateEffect.mapEffects(effects,newMapped).concat(StateEffect.mapEffects(asArray$1(_result2.effects),mapBy));}return{changes:changes,selection:EditorSelection.create(ranges,sel.mainIndex),effects:effects};}/**
    Create a [change set](https://codemirror.net/6/docs/ref/#state.ChangeSet) from the given change
    description, taking the state's document length and line
    separator into account.
    */},{key:"changes",value:function changes(){var spec=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(spec instanceof ChangeSet)return spec;return ChangeSet.of(spec,this.doc.length,this.facet(EditorState.lineSeparator));}/**
    Using the state's [line
    separator](https://codemirror.net/6/docs/ref/#state.EditorState^lineSeparator), create a
    [`Text`](https://codemirror.net/6/docs/ref/#state.Text) instance from the given string.
    */},{key:"toText",value:function toText(string){return Text.of(string.split(this.facet(EditorState.lineSeparator)||DefaultSplit));}/**
    Return the given range of the document as a string.
    */},{key:"sliceDoc",value:function sliceDoc(){var from=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.doc.length;return this.doc.sliceString(from,to,this.lineBreak);}/**
    Get the value of a state [facet](https://codemirror.net/6/docs/ref/#state.Facet).
    */},{key:"facet",value:function facet(_facet){var addr=this.config.address[_facet.id];if(addr==null)return _facet["default"];ensureAddr(this,addr);return getAddr(this,addr);}/**
    Convert this state to a JSON-serializable object. When custom
    fields should be serialized, you can pass them in as an object
    mapping property names (in the resulting object, which should
    not use `doc` or `selection`) to fields.
    */},{key:"toJSON",value:function toJSON(fields){var result={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(fields)for(var prop in fields){var value=fields[prop];if(value instanceof StateField&&this.config.address[value.id]!=null)result[prop]=value.spec.toJSON(this.field(fields[prop]),this);}return result;}/**
    Deserialize a state from its JSON representation. When custom
    fields should be deserialized, pass the same object you passed
    to [`toJSON`](https://codemirror.net/6/docs/ref/#state.EditorState.toJSON) when serializing as
    third argument.
    */},{key:"tabSize",get:/**
    The size (in columns) of a tab in the document, determined by
    the [`tabSize`](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize) facet.
    */function get(){return this.facet(EditorState.tabSize);}/**
    Get the proper [line-break](https://codemirror.net/6/docs/ref/#state.EditorState^lineSeparator)
    string for this state.
    */},{key:"lineBreak",get:function get(){return this.facet(EditorState.lineSeparator)||"\n";}/**
    Returns true when the editor is
    [configured](https://codemirror.net/6/docs/ref/#state.EditorState^readOnly) to be read-only.
    */},{key:"readOnly",get:function get(){return this.facet(readOnly);}/**
    Look up a translation for the given phrase (via the
    [`phrases`](https://codemirror.net/6/docs/ref/#state.EditorState^phrases) facet), or return the
    original string if no translation is found.
    
    If additional arguments are passed, they will be inserted in
    place of markers like `$1` (for the first value) and `$2`, etc.
    A single `$` is equivalent to `$1`, and `$$` will produce a
    literal dollar sign.
    */},{key:"phrase",value:function phrase(_phrase){for(var _len6=arguments.length,insert=new Array(_len6>1?_len6-1:0),_key7=1;_key7<_len6;_key7++){insert[_key7-1]=arguments[_key7];}var _iterator23=_createForOfIteratorHelper(this.facet(EditorState.phrases)),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var _map=_step23.value;if(Object.prototype.hasOwnProperty.call(_map,_phrase)){_phrase=_map[_phrase];break;}}}catch(err){_iterator23.e(err);}finally{_iterator23.f();}if(insert.length)_phrase=_phrase.replace(/\$(\$|\d*)/g,function(m,i){if(i=="$")return"$";var n=+(i||1);return!n||n>insert.length?m:insert[n-1];});return _phrase;}/**
    Find the values for a given language data field, provided by the
    the [`languageData`](https://codemirror.net/6/docs/ref/#state.EditorState^languageData) facet.
    */},{key:"languageDataAt",value:function languageDataAt(name,pos){var side=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;var values=[];var _iterator24=_createForOfIteratorHelper(this.facet(languageData)),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var provider=_step24.value;var _iterator25=_createForOfIteratorHelper(provider(this,pos,side)),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var _result3=_step25.value;if(Object.prototype.hasOwnProperty.call(_result3,name))values.push(_result3[name]);}}catch(err){_iterator25.e(err);}finally{_iterator25.f();}}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}return values;}/**
    Return a function that can categorize strings (expected to
    represent a single [grapheme cluster](https://codemirror.net/6/docs/ref/#state.findClusterBreak))
    into one of:
    
     - Word (contains an alphanumeric character or a character
       explicitly listed in the local language's `"wordChars"`
       language data, which should be a string)
     - Space (contains only whitespace)
     - Other (anything else)
    */},{key:"charCategorizer",value:function charCategorizer(at){return makeCategorizer(this.languageDataAt("wordChars",at).join(""));}/**
    Find the word at the given position, meaning the range
    containing all [word](https://codemirror.net/6/docs/ref/#state.CharCategory.Word) characters
    around it. If no word characters are adjacent to the position,
    this returns null.
    */},{key:"wordAt",value:function wordAt(pos){var _this$doc$lineAt=this.doc.lineAt(pos),text=_this$doc$lineAt.text,from=_this$doc$lineAt.from,length=_this$doc$lineAt.length;var cat=this.charCategorizer(pos);var start=pos-from,end=pos-from;while(start>0){var prev=findClusterBreak(text,start,false);if(cat(text.slice(prev,start))!=CharCategory.Word)break;start=prev;}while(end<length){var next=findClusterBreak(text,end);if(cat(text.slice(end,next))!=CharCategory.Word)break;end=next;}return start==end?null:EditorSelection.range(start+from,end+from);}}],[{key:"fromJSON",value:function fromJSON(json){var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var fields=arguments.length>2?arguments[2]:undefined;if(!json||typeof json.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");var fieldInit=[];if(fields)for(var prop in fields){if(Object.prototype.hasOwnProperty.call(json,prop)){(function(){var field=fields[prop],value=json[prop];fieldInit.push(field.init(function(state){return field.spec.fromJSON(value,state);}));})();}}return EditorState.create({doc:json.doc,selection:EditorSelection.fromJSON(json.selection),extensions:config.extensions?fieldInit.concat([config.extensions]):fieldInit});}/**
    Create a new state. You'll usually only need this when
    initializing an editorupdated states are created by applying
    transactions.
    */},{key:"create",value:function create(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var configuration=Configuration.resolve(config.extensions||[],new Map());var doc=config.doc instanceof Text?config.doc:Text.of((config.doc||"").split(configuration.staticFacet(EditorState.lineSeparator)||DefaultSplit));var selection=!config.selection?EditorSelection.single(0):config.selection instanceof EditorSelection?config.selection:EditorSelection.single(config.selection.anchor,config.selection.head);checkSelection(selection,doc.length);if(!configuration.staticFacet(allowMultipleSelections))selection=selection.asSingle();return new EditorState(configuration,doc,selection,configuration.dynamicSlots.map(function(){return null;}),function(state,slot){return slot.create(state);},null);}}]);return EditorState;}();/**
A facet that, when enabled, causes the editor to allow multiple
ranges to be selected. Be careful though, because by default the
editor relies on the native DOM selection, which cannot handle
multiple selections. An extension like
[`drawSelection`](https://codemirror.net/6/docs/ref/#view.drawSelection) can be used to make
secondary selections visible to the user.
*/EditorState.allowMultipleSelections=allowMultipleSelections;/**
Configures the tab size to use in this state. The first
(highest-precedence) value of the facet is used. If no value is
given, this defaults to 4.
*/EditorState.tabSize=/*@__PURE__*/Facet.define({combine:function combine(values){return values.length?values[0]:4;}});/**
The line separator to use. By default, any of `"\n"`, `"\r\n"`
and `"\r"` is treated as a separator when splitting lines, and
lines are joined with `"\n"`.

When you configure a value here, only that precise separator
will be used, allowing you to round-trip documents through the
editor without normalizing line separators.
*/EditorState.lineSeparator=lineSeparator;/**
This facet controls the value of the
[`readOnly`](https://codemirror.net/6/docs/ref/#state.EditorState.readOnly) getter, which is
consulted by commands and extensions that implement editing
functionality to determine whether they should apply. It
defaults to false, but when its highest-precedence value is
`true`, such functionality disables itself.

Not to be confused with
[`EditorView.editable`](https://codemirror.net/6/docs/ref/#view.EditorView^editable), which
controls whether the editor's DOM is set to be editable (and
thus focusable).
*/EditorState.readOnly=readOnly;/**
Registers translation phrases. The
[`phrase`](https://codemirror.net/6/docs/ref/#state.EditorState.phrase) method will look through
all objects registered with this facet to find translations for
its argument.
*/EditorState.phrases=/*@__PURE__*/Facet.define({compare:function compare(a,b){var kA=Object.keys(a),kB=Object.keys(b);return kA.length==kB.length&&kA.every(function(k){return a[k]==b[k];});}});/**
A facet used to register [language
data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt) providers.
*/EditorState.languageData=languageData;/**
Facet used to register change filters, which are called for each
transaction (unless explicitly
[disabled](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter)), and can suppress
part of the transaction's changes.

Such a function can return `true` to indicate that it doesn't
want to do anything, `false` to completely stop the changes in
the transaction, or a set of ranges in which changes should be
suppressed. Such ranges are represented as an array of numbers,
with each pair of two numbers indicating the start and end of a
range. So for example `[10, 20, 100, 110]` suppresses changes
between 10 and 20, and between 100 and 110.
*/EditorState.changeFilter=changeFilter;/**
Facet used to register a hook that gets a chance to update or
replace transaction specs before they are applied. This will
only be applied for transactions that don't have
[`filter`](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter) set to `false`. You
can either return a single transaction spec (possibly the input
transaction), or an array of specs (which will be combined in
the same way as the arguments to
[`EditorState.update`](https://codemirror.net/6/docs/ref/#state.EditorState.update)).

When possible, it is recommended to avoid accessing
[`Transaction.state`](https://codemirror.net/6/docs/ref/#state.Transaction.state) in a filter,
since it will force creation of a state that will then be
discarded again, if the transaction is actually filtered.

(This functionality should be used with care. Indiscriminately
modifying transaction is likely to break something or degrade
the user experience.)
*/EditorState.transactionFilter=transactionFilter;/**
This is a more limited form of
[`transactionFilter`](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter),
which can only add
[annotations](https://codemirror.net/6/docs/ref/#state.TransactionSpec.annotations) and
[effects](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects). _But_, this type
of filter runs even if the transaction has disabled regular
[filtering](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter), making it suitable
for effects that don't need to touch the changes or selection,
but do want to process every transaction.

Extenders run _after_ filters, when both are present.
*/EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=/*@__PURE__*/StateEffect.define();/**
Utility function for combining behaviors to fill in a config
object from an array of provided configs. `defaults` should hold
default values for all optional fields in `Config`.

The function will, by default, error
when a field gets two values that aren't `===`-equal, but you can
provide combine functions per field to do something else.
*/function combineConfig(configs,defaults){var combine=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var result={};var _iterator26=_createForOfIteratorHelper(configs),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _config=_step26.value;for(var _i86=0,_Object$keys3=Object.keys(_config);_i86<_Object$keys3.length;_i86++){var _key8=_Object$keys3[_i86];var value=_config[_key8],current=result[_key8];if(current===undefined)result[_key8]=value;else if(current===value||value===undefined);// No conflict
else if(Object.hasOwnProperty.call(combine,_key8))result[_key8]=combine[_key8](current,value);else throw new Error("Config merge conflict for field "+_key8);}}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}for(var key in defaults){if(result[key]===undefined)result[key]=defaults[key];}return result;}/**
Each range is associated with a value, which must inherit from
this class.
*/var RangeValue=/*#__PURE__*/function(){function RangeValue(){_classCallCheck(this,RangeValue);}_createClass(RangeValue,[{key:"eq",value:/**
    Compare this value with another value. Used when comparing
    rangesets. The default implementation compares by identity.
    Unless you are only creating a fixed number of unique instances
    of your value type, it is a good idea to implement this
    properly.
    */function eq(other){return this==other;}/**
    Create a [range](https://codemirror.net/6/docs/ref/#state.Range) with this value.
    */},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;return Range$1.create(from,to,this);}}]);return RangeValue;}();RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=false;RangeValue.prototype.mapMode=MapMode.TrackDel;/**
A range associates a value with a range of positions.
*/var Range$1=/*#__PURE__*/function(){function Range$1(/**
    The range's start position.
    */from,/**
    Its end position.
    */to,/**
    The value associated with this range.
    */value){_classCallCheck(this,Range$1);this.from=from;this.to=to;this.value=value;}/**
    @internal
    */_createClass(Range$1,null,[{key:"create",value:function create(from,to,value){return new Range$1(from,to,value);}}]);return Range$1;}();function cmpRange(a,b){return a.from-b.from||a.value.startSide-b.value.startSide;}var Chunk=/*#__PURE__*/function(){function Chunk(from,to,value,// Chunks are marked with the largest point that occurs
// in them (or -1 for no points), so that scans that are
// only interested in points (such as the
// heightmap-related logic) can skip range-only chunks.
maxPoint){_classCallCheck(this,Chunk);this.from=from;this.to=to;this.value=value;this.maxPoint=maxPoint;}_createClass(Chunk,[{key:"length",get:function get(){return this.to[this.to.length-1];}// Find the index of the given position and side. Use the ranges'
// `from` pos when `end == false`, `to` when `end == true`.
},{key:"findIndex",value:function findIndex(pos,side,end){var startAt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var arr=end?this.to:this.from;for(var lo=startAt,hi=arr.length;;){if(lo==hi)return lo;var mid=lo+hi>>1;var diff=arr[mid]-pos||(end?this.value[mid].endSide:this.value[mid].startSide)-side;if(mid==lo)return diff>=0?lo:hi;if(diff>=0)hi=mid;else lo=mid+1;}}},{key:"between",value:function between(offset,from,to,f){for(var _i87=this.findIndex(from,-1000000000/* C.Far */,true),e=this.findIndex(to,1000000000/* C.Far */,false,_i87);_i87<e;_i87++){if(f(this.from[_i87]+offset,this.to[_i87]+offset,this.value[_i87])===false)return false;}}},{key:"map",value:function map(offset,changes){var value=[],from=[],to=[],newPos=-1,maxPoint=-1;for(var _i88=0;_i88<this.value.length;_i88++){var val=this.value[_i88],curFrom=this.from[_i88]+offset,curTo=this.to[_i88]+offset,newFrom=void 0,newTo=void 0;if(curFrom==curTo){var mapped=changes.mapPos(curFrom,val.startSide,val.mapMode);if(mapped==null)continue;newFrom=newTo=mapped;if(val.startSide!=val.endSide){newTo=changes.mapPos(curFrom,val.endSide);if(newTo<newFrom)continue;}}else{newFrom=changes.mapPos(curFrom,val.startSide);newTo=changes.mapPos(curTo,val.endSide);if(newFrom>newTo||newFrom==newTo&&val.startSide>0&&val.endSide<=0)continue;}if((newTo-newFrom||val.endSide-val.startSide)<0)continue;if(newPos<0)newPos=newFrom;if(val.point)maxPoint=Math.max(maxPoint,newTo-newFrom);value.push(val);from.push(newFrom-newPos);to.push(newTo-newPos);}return{mapped:value.length?new Chunk(from,to,value,maxPoint):null,pos:newPos};}}]);return Chunk;}();/**
A range set stores a collection of [ranges](https://codemirror.net/6/docs/ref/#state.Range) in a
way that makes them efficient to [map](https://codemirror.net/6/docs/ref/#state.RangeSet.map) and
[update](https://codemirror.net/6/docs/ref/#state.RangeSet.update). This is an immutable data
structure.
*/var RangeSet=/*#__PURE__*/function(){function RangeSet(/**
    @internal
    */chunkPos,/**
    @internal
    */chunk,/**
    @internal
    */nextLayer,/**
    @internal
    */maxPoint){_classCallCheck(this,RangeSet);this.chunkPos=chunkPos;this.chunk=chunk;this.nextLayer=nextLayer;this.maxPoint=maxPoint;}/**
    @internal
    */_createClass(RangeSet,[{key:"length",get:/**
    @internal
    */function get(){var last=this.chunk.length-1;return last<0?0:Math.max(this.chunkEnd(last),this.nextLayer.length);}/**
    The number of ranges in the set.
    */},{key:"size",get:function get(){if(this.isEmpty)return 0;var size=this.nextLayer.size;var _iterator27=_createForOfIteratorHelper(this.chunk),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var _chunk=_step27.value;size+=_chunk.value.length;}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}return size;}/**
    @internal
    */},{key:"chunkEnd",value:function chunkEnd(index){return this.chunkPos[index]+this.chunk[index].length;}/**
    Update the range set, optionally adding new ranges or filtering
    out existing ones.
    
    (Note: The type parameter is just there as a kludge to work
    around TypeScript variance issues that prevented `RangeSet<X>`
    from being a subtype of `RangeSet<Y>` when `X` is a subtype of
    `Y`.)
    */},{key:"update",value:function update(updateSpec){var _updateSpec$add=updateSpec.add,add=_updateSpec$add===void 0?[]:_updateSpec$add,_updateSpec$sort=updateSpec.sort,sort=_updateSpec$sort===void 0?false:_updateSpec$sort,_updateSpec$filterFro=updateSpec.filterFrom,filterFrom=_updateSpec$filterFro===void 0?0:_updateSpec$filterFro,_updateSpec$filterTo=updateSpec.filterTo,filterTo=_updateSpec$filterTo===void 0?this.length:_updateSpec$filterTo;var filter=updateSpec.filter;if(add.length==0&&!filter)return this;if(sort)add=add.slice().sort(cmpRange);if(this.isEmpty)return add.length?RangeSet.of(add):this;var cur=new LayerCursor(this,null,-1)["goto"](0),i=0,spill=[];var builder=new RangeSetBuilder();while(cur.value||i<add.length){if(i<add.length&&(cur.from-add[i].from||cur.startSide-add[i].value.startSide)>=0){var _range4=add[i++];if(!builder.addInner(_range4.from,_range4.to,_range4.value))spill.push(_range4);}else if(cur.rangeIndex==1&&cur.chunkIndex<this.chunk.length&&(i==add.length||this.chunkEnd(cur.chunkIndex)<add[i].from)&&(!filter||filterFrom>this.chunkEnd(cur.chunkIndex)||filterTo<this.chunkPos[cur.chunkIndex])&&builder.addChunk(this.chunkPos[cur.chunkIndex],this.chunk[cur.chunkIndex])){cur.nextChunk();}else{if(!filter||filterFrom>cur.to||filterTo<cur.from||filter(cur.from,cur.to,cur.value)){if(!builder.addInner(cur.from,cur.to,cur.value))spill.push(Range$1.create(cur.from,cur.to,cur.value));}cur.next();}}return builder.finishInner(this.nextLayer.isEmpty&&!spill.length?RangeSet.empty:this.nextLayer.update({add:spill,filter:filter,filterFrom:filterFrom,filterTo:filterTo}));}/**
    Map this range set through a set of changes, return the new set.
    */},{key:"map",value:function map(changes){if(changes.empty||this.isEmpty)return this;var chunks=[],chunkPos=[],maxPoint=-1;for(var _i89=0;_i89<this.chunk.length;_i89++){var start=this.chunkPos[_i89],_chunk2=this.chunk[_i89];var touch=changes.touchesRange(start,start+_chunk2.length);if(touch===false){maxPoint=Math.max(maxPoint,_chunk2.maxPoint);chunks.push(_chunk2);chunkPos.push(changes.mapPos(start));}else if(touch===true){var _chunk2$map=_chunk2.map(start,changes),mapped=_chunk2$map.mapped,pos=_chunk2$map.pos;if(mapped){maxPoint=Math.max(maxPoint,mapped.maxPoint);chunks.push(mapped);chunkPos.push(pos);}}}var next=this.nextLayer.map(changes);return chunks.length==0?next:new RangeSet(chunkPos,chunks,next||RangeSet.empty,maxPoint);}/**
    Iterate over the ranges that touch the region `from` to `to`,
    calling `f` for each. There is no guarantee that the ranges will
    be reported in any specific order. When the callback returns
    `false`, iteration stops.
    */},{key:"between",value:function between(from,to,f){if(this.isEmpty)return;for(var _i90=0;_i90<this.chunk.length;_i90++){var start=this.chunkPos[_i90],_chunk3=this.chunk[_i90];if(to>=start&&from<=start+_chunk3.length&&_chunk3.between(start,from-start,to-start,f)===false)return;}this.nextLayer.between(from,to,f);}/**
    Iterate over the ranges in this set, in order, including all
    ranges that end at or after `from`.
    */},{key:"iter",value:function iter(){var from=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return HeapCursor.from([this])["goto"](from);}/**
    @internal
    */},{key:"isEmpty",get:function get(){return this.nextLayer==this;}/**
    Iterate over the ranges in a collection of sets, in order,
    starting from `from`.
    */}],[{key:"create",value:function create(chunkPos,chunk,nextLayer,maxPoint){return new RangeSet(chunkPos,chunk,nextLayer,maxPoint);}},{key:"iter",value:function iter(sets){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return HeapCursor.from(sets)["goto"](from);}/**
    Iterate over two groups of sets, calling methods on `comparator`
    to notify it of possible differences.
    */},{key:"compare",value:function compare(oldSets,newSets,/**
    This indicates how the underlying data changed between these
    ranges, and is needed to synchronize the iteration. `from` and
    `to` are coordinates in the _new_ space, after these changes.
    */textDiff,comparator){var minPointSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1;var a=oldSets.filter(function(set){return set.maxPoint>0||!set.isEmpty&&set.maxPoint>=minPointSize;});var b=newSets.filter(function(set){return set.maxPoint>0||!set.isEmpty&&set.maxPoint>=minPointSize;});var sharedChunks=findSharedChunks(a,b,textDiff);var sideA=new SpanCursor(a,sharedChunks,minPointSize);var sideB=new SpanCursor(b,sharedChunks,minPointSize);textDiff.iterGaps(function(fromA,fromB,length){return _compare(sideA,fromA,sideB,fromB,length,comparator);});if(textDiff.empty&&textDiff.length==0)_compare(sideA,0,sideB,0,0,comparator);}/**
    Compare the contents of two groups of range sets, returning true
    if they are equivalent in the given range.
    */},{key:"eq",value:function eq(oldSets,newSets){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3?arguments[3]:undefined;if(to==null)to=1000000000/* C.Far */;var a=oldSets.filter(function(set){return!set.isEmpty&&newSets.indexOf(set)<0;});var b=newSets.filter(function(set){return!set.isEmpty&&oldSets.indexOf(set)<0;});if(a.length!=b.length)return false;if(!a.length)return true;var sharedChunks=findSharedChunks(a,b);var sideA=new SpanCursor(a,sharedChunks,0)["goto"](from),sideB=new SpanCursor(b,sharedChunks,0)["goto"](from);for(;;){if(sideA.to!=sideB.to||!sameValues(sideA.active,sideB.active)||sideA.point&&(!sideB.point||!sideA.point.eq(sideB.point)))return false;if(sideA.to>to)return true;sideA.next();sideB.next();}}/**
    Iterate over a group of range sets at the same time, notifying
    the iterator about the ranges covering every given piece of
    content. Returns the open count (see
    [`SpanIterator.span`](https://codemirror.net/6/docs/ref/#state.SpanIterator.span)) at the end
    of the iteration.
    */},{key:"spans",value:function spans(sets,from,to,iterator){var minPointSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1;var cursor=new SpanCursor(sets,null,minPointSize)["goto"](from),pos=from;var open=cursor.openStart;for(;;){var curTo=Math.min(cursor.to,to);if(cursor.point){iterator.point(pos,curTo,cursor.point,cursor.activeForPoint(cursor.to),open,cursor.pointRank);open=cursor.openEnd(curTo)+(cursor.to>curTo?1:0);}else if(curTo>pos){iterator.span(pos,curTo,cursor.active,open);open=cursor.openEnd(curTo);}if(cursor.to>to)break;pos=cursor.to;cursor.next();}return open;}/**
    Create a range set for the given range or array of ranges. By
    default, this expects the ranges to be _sorted_ (by start
    position and, if two start at the same position,
    `value.startSide`). You can pass `true` as second argument to
    cause the method to sort them.
    */},{key:"of",value:function of(ranges){var sort=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var build=new RangeSetBuilder();var _iterator28=_createForOfIteratorHelper(ranges instanceof Range$1?[ranges]:sort?lazySort(ranges):ranges),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var _range5=_step28.value;build.add(_range5.from,_range5.to,_range5.value);}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}return build.finish();}}]);return RangeSet;}();/**
The empty set of ranges.
*/RangeSet.empty=/*@__PURE__*/new RangeSet([],[],null,-1);function lazySort(ranges){if(ranges.length>1)for(var prev=ranges[0],_i91=1;_i91<ranges.length;_i91++){var _cur=ranges[_i91];if(cmpRange(prev,_cur)>0)return ranges.slice().sort(cmpRange);prev=_cur;}return ranges;}RangeSet.empty.nextLayer=RangeSet.empty;/**
A range set builder is a data structure that helps build up a
[range set](https://codemirror.net/6/docs/ref/#state.RangeSet) directly, without first allocating
an array of [`Range`](https://codemirror.net/6/docs/ref/#state.Range) objects.
*/var RangeSetBuilder=/*#__PURE__*/function(){/**
    Create an empty builder.
    */function RangeSetBuilder(){_classCallCheck(this,RangeSetBuilder);this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastFrom=-1000000000/* C.Far */;this.lastTo=-1000000000/* C.Far */;this.from=[];this.to=[];this.value=[];this.maxPoint=-1;this.setMaxPoint=-1;this.nextLayer=null;}_createClass(RangeSetBuilder,[{key:"finishChunk",value:function finishChunk(newArrays){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;if(newArrays){this.from=[];this.to=[];this.value=[];}}/**
    Add a range. Ranges should be added in sorted (by `from` and
    `value.startSide`) order.
    */},{key:"add",value:function add(from,to,value){if(!this.addInner(from,to,value))(this.nextLayer||(this.nextLayer=new RangeSetBuilder())).add(from,to,value);}/**
    @internal
    */},{key:"addInner",value:function addInner(from,to,value){var diff=from-this.lastTo||value.startSide-this.last.endSide;if(diff<=0&&(from-this.lastFrom||value.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");if(diff<0)return false;if(this.from.length==250/* C.ChunkSize */)this.finishChunk(true);if(this.chunkStart<0)this.chunkStart=from;this.from.push(from-this.chunkStart);this.to.push(to-this.chunkStart);this.last=value;this.lastFrom=from;this.lastTo=to;this.value.push(value);if(value.point)this.maxPoint=Math.max(this.maxPoint,to-from);return true;}/**
    @internal
    */},{key:"addChunk",value:function addChunk(from,chunk){if((from-this.lastTo||chunk.value[0].startSide-this.last.endSide)<0)return false;if(this.from.length)this.finishChunk(true);this.setMaxPoint=Math.max(this.setMaxPoint,chunk.maxPoint);this.chunks.push(chunk);this.chunkPos.push(from);var last=chunk.value.length-1;this.last=chunk.value[last];this.lastFrom=chunk.from[last]+from;this.lastTo=chunk.to[last]+from;return true;}/**
    Finish the range set. Returns the new set. The builder can't be
    used anymore after this has been called.
    */},{key:"finish",value:function finish(){return this.finishInner(RangeSet.empty);}/**
    @internal
    */},{key:"finishInner",value:function finishInner(next){if(this.from.length)this.finishChunk(false);if(this.chunks.length==0)return next;var result=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(next):next,this.setMaxPoint);this.from=null;// Make sure further `add` calls produce errors
return result;}}]);return RangeSetBuilder;}();function findSharedChunks(a,b,textDiff){var inA=new Map();var _iterator29=_createForOfIteratorHelper(a),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _set=_step29.value;for(var _i92=0;_i92<_set.chunk.length;_i92++){if(_set.chunk[_i92].maxPoint<=0)inA.set(_set.chunk[_i92],_set.chunkPos[_i92]);}}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}var shared=new Set();var _iterator30=_createForOfIteratorHelper(b),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _set2=_step30.value;for(var _i93=0;_i93<_set2.chunk.length;_i93++){var known=inA.get(_set2.chunk[_i93]);if(known!=null&&(textDiff?textDiff.mapPos(known):known)==_set2.chunkPos[_i93]&&!(textDiff===null||textDiff===void 0?void 0:textDiff.touchesRange(known,known+_set2.chunk[_i93].length)))shared.add(_set2.chunk[_i93]);}}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}return shared;}var LayerCursor=/*#__PURE__*/function(){function LayerCursor(layer,skip,minPoint){var rank=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,LayerCursor);this.layer=layer;this.skip=skip;this.minPoint=minPoint;this.rank=rank;}_createClass(LayerCursor,[{key:"startSide",get:function get(){return this.value?this.value.startSide:0;}},{key:"endSide",get:function get(){return this.value?this.value.endSide:0;}},{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1000000000;this.chunkIndex=this.rangeIndex=0;this.gotoInner(pos,side,false);return this;}},{key:"gotoInner",value:function gotoInner(pos,side,forward){while(this.chunkIndex<this.layer.chunk.length){var next=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(next)||this.layer.chunkEnd(this.chunkIndex)<pos||next.maxPoint<this.minPoint))break;this.chunkIndex++;forward=false;}if(this.chunkIndex<this.layer.chunk.length){var rangeIndex=this.layer.chunk[this.chunkIndex].findIndex(pos-this.layer.chunkPos[this.chunkIndex],side,true);if(!forward||this.rangeIndex<rangeIndex)this.setRangeIndex(rangeIndex);}this.next();}},{key:"forward",value:function forward(pos,side){if((this.to-pos||this.endSide-side)<0)this.gotoInner(pos,side,true);}},{key:"next",value:function next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1000000000/* C.Far */;this.value=null;break;}else{var chunkPos=this.layer.chunkPos[this.chunkIndex],_chunk4=this.layer.chunk[this.chunkIndex];var from=chunkPos+_chunk4.from[this.rangeIndex];this.from=from;this.to=chunkPos+_chunk4.to[this.rangeIndex];this.value=_chunk4.value[this.rangeIndex];this.setRangeIndex(this.rangeIndex+1);if(this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break;}}}},{key:"setRangeIndex",value:function setRangeIndex(index){if(index==this.layer.chunk[this.chunkIndex].value.length){this.chunkIndex++;if(this.skip){while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex])){this.chunkIndex++;}}this.rangeIndex=0;}else{this.rangeIndex=index;}}},{key:"nextChunk",value:function nextChunk(){this.chunkIndex++;this.rangeIndex=0;this.next();}},{key:"compare",value:function compare(other){return this.from-other.from||this.startSide-other.startSide||this.rank-other.rank||this.to-other.to||this.endSide-other.endSide;}}]);return LayerCursor;}();var HeapCursor=/*#__PURE__*/function(){function HeapCursor(heap){_classCallCheck(this,HeapCursor);this.heap=heap;}_createClass(HeapCursor,[{key:"startSide",get:function get(){return this.value?this.value.startSide:0;}},{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1000000000;var _iterator31=_createForOfIteratorHelper(this.heap),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var _cur2=_step31.value;_cur2["goto"](pos,side);}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}for(var _i94=this.heap.length>>1;_i94>=0;_i94--){heapBubble(this.heap,_i94);}this.next();return this;}},{key:"forward",value:function forward(pos,side){var _iterator32=_createForOfIteratorHelper(this.heap),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _cur3=_step32.value;_cur3.forward(pos,side);}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}for(var _i95=this.heap.length>>1;_i95>=0;_i95--){heapBubble(this.heap,_i95);}if((this.to-pos||this.value.endSide-side)<0)this.next();}},{key:"next",value:function next(){if(this.heap.length==0){this.from=this.to=1000000000/* C.Far */;this.value=null;this.rank=-1;}else{var _top4=this.heap[0];this.from=_top4.from;this.to=_top4.to;this.value=_top4.value;this.rank=_top4.rank;if(_top4.value)_top4.next();heapBubble(this.heap,0);}}}],[{key:"from",value:function from(sets){var skip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var minPoint=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;var heap=[];for(var _i96=0;_i96<sets.length;_i96++){for(var _cur4=sets[_i96];!_cur4.isEmpty;_cur4=_cur4.nextLayer){if(_cur4.maxPoint>=minPoint)heap.push(new LayerCursor(_cur4,skip,minPoint,_i96));}}return heap.length==1?heap[0]:new HeapCursor(heap);}}]);return HeapCursor;}();function heapBubble(heap,index){for(var _cur5=heap[index];;){var childIndex=(index<<1)+1;if(childIndex>=heap.length)break;var child=heap[childIndex];if(childIndex+1<heap.length&&child.compare(heap[childIndex+1])>=0){child=heap[childIndex+1];childIndex++;}if(_cur5.compare(child)<0)break;heap[childIndex]=_cur5;heap[index]=child;index=childIndex;}}var SpanCursor=/*#__PURE__*/function(){function SpanCursor(sets,skip,minPoint){_classCallCheck(this,SpanCursor);this.minPoint=minPoint;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;// A currently active point range, if any
this.point=null;this.pointFrom=0;this.pointRank=0;this.to=-1000000000/* C.Far */;this.endSide=0;this.openStart=-1;this.cursor=HeapCursor.from(sets,skip,minPoint);}_createClass(SpanCursor,[{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1000000000;this.cursor["goto"](pos,side);this.active.length=this.activeTo.length=this.activeRank.length=0;this.minActive=-1;this.to=pos;this.endSide=side;this.openStart=-1;this.next();return this;}},{key:"forward",value:function forward(pos,side){while(this.minActive>-1&&(this.activeTo[this.minActive]-pos||this.active[this.minActive].endSide-side)<0){this.removeActive(this.minActive);}this.cursor.forward(pos,side);}},{key:"removeActive",value:function removeActive(index){remove(this.active,index);remove(this.activeTo,index);remove(this.activeRank,index);this.minActive=findMinIndex(this.active,this.activeTo);}},{key:"addActive",value:function addActive(trackOpen){var i=0,_this$cursor=this.cursor,value=_this$cursor.value,to=_this$cursor.to,rank=_this$cursor.rank;while(i<this.activeRank.length&&this.activeRank[i]<=rank){i++;}insert$1(this.active,i,value);insert$1(this.activeTo,i,to);insert$1(this.activeRank,i,rank);if(trackOpen)insert$1(trackOpen,i,this.cursor.from);this.minActive=findMinIndex(this.active,this.activeTo);}// After calling this, if `this.point` != null, the next range is a
// point. Otherwise, it's a regular range, covered by `this.active`.
},{key:"next",value:function next(){var from=this.to,wasPoint=this.point;this.point=null;var trackOpen=this.openStart<0?[]:null,trackExtra=0;for(;;){var a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>from){this.to=this.activeTo[a];this.endSide=this.active[a].endSide;break;}this.removeActive(a);if(trackOpen)remove(trackOpen,a);}else if(!this.cursor.value){this.to=this.endSide=1000000000/* C.Far */;break;}else if(this.cursor.from>from){this.to=this.cursor.from;this.endSide=this.cursor.startSide;break;}else{var nextVal=this.cursor.value;if(!nextVal.point){// Opening a range
this.addActive(trackOpen);if(this.cursor.from<from&&this.cursor.to>from)trackExtra++;this.cursor.next();}else if(wasPoint&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to){// Ignore any non-empty points that end precisely at the end of the prev point
this.cursor.next();}else{// New point
this.point=nextVal;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=nextVal.endSide;if(this.cursor.from<from)trackExtra=1;this.cursor.next();this.forward(this.to,this.endSide);break;}}}if(trackOpen){var openStart=0;while(openStart<trackOpen.length&&trackOpen[openStart]<from){openStart++;}this.openStart=openStart+trackExtra;}}},{key:"activeForPoint",value:function activeForPoint(to){if(!this.active.length)return this.active;var active=[];for(var _i97=this.active.length-1;_i97>=0;_i97--){if(this.activeRank[_i97]<this.pointRank)break;if(this.activeTo[_i97]>to||this.activeTo[_i97]==to&&this.active[_i97].endSide>=this.point.endSide)active.push(this.active[_i97]);}return active.reverse();}},{key:"openEnd",value:function openEnd(to){var open=0;for(var _i98=this.activeTo.length-1;_i98>=0&&this.activeTo[_i98]>to;_i98--){open++;}return open;}}]);return SpanCursor;}();function _compare(a,startA,b,startB,length,comparator){a["goto"](startA);b["goto"](startB);var endB=startB+length;var pos=startB,dPos=startB-startA;for(;;){var diff=a.to+dPos-b.to||a.endSide-b.endSide;var end=diff<0?a.to+dPos:b.to,clipEnd=Math.min(end,endB);if(a.point||b.point){if(!(a.point&&b.point&&(a.point==b.point||a.point.eq(b.point))&&sameValues(a.activeForPoint(a.to+dPos),b.activeForPoint(b.to))))comparator.comparePoint(pos,clipEnd,a.point,b.point);}else{if(clipEnd>pos&&!sameValues(a.active,b.active))comparator.compareRange(pos,clipEnd,a.active,b.active);}if(end>endB)break;pos=end;if(diff<=0)a.next();if(diff>=0)b.next();}}function sameValues(a,b){if(a.length!=b.length)return false;for(var _i99=0;_i99<a.length;_i99++){if(a[_i99]!=b[_i99]&&!a[_i99].eq(b[_i99]))return false;}return true;}function remove(array,index){for(var _i100=index,e=array.length-1;_i100<e;_i100++){array[_i100]=array[_i100+1];}array.pop();}function insert$1(array,index,value){for(var _i101=array.length-1;_i101>=index;_i101--){array[_i101+1]=array[_i101];}array[index]=value;}function findMinIndex(value,array){var found=-1,foundPos=1000000000/* C.Far */;for(var _i102=0;_i102<array.length;_i102++){if((array[_i102]-foundPos||value[_i102].endSide-value[found].endSide)<0){found=_i102;foundPos=array[_i102];}}return found;}/**
Count the column position at the given offset into the string,
taking extending characters and tab size into account.
*/function _countColumn(string,tabSize){var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:string.length;var n=0;for(var _i103=0;_i103<to;){if(string.charCodeAt(_i103)==9){n+=tabSize-n%tabSize;_i103++;}else{n++;_i103=findClusterBreak(string,_i103);}}return n;}/**
Find the offset that corresponds to the given column position in a
string, taking extending characters and tab size into account. By
default, the string length is returned when it is too short to
reach the column. Pass `strict` true to make it return -1 in that
situation.
*/function findColumn(string,col,tabSize,strict){for(var _i104=0,n=0;;){if(n>=col)return _i104;if(_i104==string.length)break;n+=string.charCodeAt(_i104)==9?tabSize-n%tabSize:1;_i104=findClusterBreak(string,_i104);}return strict===true?-1:string.length;}var C="\u037C";var COUNT=typeof Symbol=="undefined"?"__"+C:Symbol["for"](C);var SET=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet");var top=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};// :: - Style modules encapsulate a set of CSS rules defined from
// JavaScript. Their definitions are only available in a given DOM
// root after it has been _mounted_ there with `StyleModule.mount`.
//
// Style modules should be created once and stored somewhere, as
// opposed to re-creating them every time you need them. The amount of
// CSS rules generated for a given DOM root is bounded by the amount
// of style modules that were used. So to avoid leaking rules, don't
// create these dynamically, but treat them as one-time allocations.
var StyleModule=/*#__PURE__*/function(){// :: (Object<Style>, ?{finish: ?(string)  string})
// Create a style module from the given spec.
//
// When `finish` is given, it is called on regular (non-`@`)
// selectors (after `&` expansion) to compute the final selector.
function StyleModule(spec,options){_classCallCheck(this,StyleModule);this.rules=[];var _ref37=options||{},finish=_ref37.finish;function splitSelector(selector){return /^@/.test(selector)?[selector]:selector.split(/,\s*/);}function render(selectors,spec,target,isKeyframes){var local=[],isAt=/^@(\w+)\b/.exec(selectors[0]),keyframes=isAt&&isAt[1]=="keyframes";if(isAt&&spec==null)return target.push(selectors[0]+";");for(var prop in spec){var value=spec[prop];if(/&/.test(prop)){render(prop.split(/,\s*/).map(function(part){return selectors.map(function(sel){return part.replace(/&/,sel);});}).reduce(function(a,b){return a.concat(b);}),value,target);}else if(value&&_typeof2(value)=="object"){if(!isAt)throw new RangeError("The value of a property ("+prop+") should be a primitive value.");render(splitSelector(prop),value,local,keyframes);}else if(value!=null){local.push(prop.replace(/_.*/,"").replace(/[A-Z]/g,function(l){return"-"+l.toLowerCase();})+": "+value+";");}}if(local.length||keyframes){target.push((finish&&!isAt&&!isKeyframes?selectors.map(finish):selectors).join(", ")+" {"+local.join(" ")+"}");}}for(var prop in spec){render(splitSelector(prop),spec[prop],this.rules);}}// :: ()  string
// Returns a string containing the module's CSS rules.
_createClass(StyleModule,[{key:"getRules",value:function getRules(){return this.rules.join("\n");}// :: ()  string
// Generate a new unique CSS class name.
}],[{key:"newName",value:function newName(){var id=top[COUNT]||1;top[COUNT]=id+1;return C+id.toString(36);}// :: (union<Document, ShadowRoot>, union<[StyleModule], StyleModule>)
//
// Mount the given set of modules in the given DOM root, which ensures
// that the CSS rules defined by the module are available in that
// context.
//
// Rules are only added to the document once per root.
//
// Rule order will follow the order of the modules, so that rules from
// modules later in the array take precedence of those from earlier
// modules. If you call this function multiple times for the same root
// in a way that changes the order of already mounted modules, the old
// order will be changed.
},{key:"mount",value:function mount(root,modules){(root[SET]||new StyleSet(root)).mount(Array.isArray(modules)?modules:[modules]);}}]);return StyleModule;}();var adoptedSet=null;var StyleSet=/*#__PURE__*/function(){function StyleSet(root){_classCallCheck(this,StyleSet);if(!root.head&&root.adoptedStyleSheets&&typeof CSSStyleSheet!="undefined"){if(adoptedSet){root.adoptedStyleSheets=[adoptedSet.sheet].concat(root.adoptedStyleSheets);return root[SET]=adoptedSet;}this.sheet=new CSSStyleSheet();root.adoptedStyleSheets=[this.sheet].concat(root.adoptedStyleSheets);adoptedSet=this;}else{this.styleTag=(root.ownerDocument||root).createElement("style");var target=root.head||root;target.insertBefore(this.styleTag,target.firstChild);}this.modules=[];root[SET]=this;}_createClass(StyleSet,[{key:"mount",value:function mount(modules){var sheet=this.sheet;var pos=0/* Current rule offset */,j=0;/* Index into this.modules */for(var _i105=0;_i105<modules.length;_i105++){var mod=modules[_i105],index=this.modules.indexOf(mod);if(index<j&&index>-1){// Ordering conflict
this.modules.splice(index,1);j--;index=-1;}if(index==-1){this.modules.splice(j++,0,mod);if(sheet)for(var k=0;k<mod.rules.length;k++){sheet.insertRule(mod.rules[k],pos++);}}else{while(j<index){pos+=this.modules[j++].rules.length;}pos+=mod.rules.length;j++;}}if(!sheet){var _text2="";for(var _i106=0;_i106<this.modules.length;_i106++){_text2+=this.modules[_i106].getRules()+"\n";}this.styleTag.textContent=_text2;}}}]);return StyleSet;}();// Style::Object<union<Style,string>>
//
// A style is an object that, in the simple case, maps CSS property
// names to strings holding their values, as in `{color: "red",
// fontWeight: "bold"}`. The property names can be given in
// camel-casethe library will insert a dash before capital letters
// when converting them to CSS.
//
// If you include an underscore in a property name, it and everything
// after it will be removed from the output, which can be useful when
// providing a property multiple times, for browser compatibility
// reasons.
//
// A property in a style object can also be a sub-selector, which
// extends the current context to add a pseudo-selector or a child
// selector. Such a property should contain a `&` character, which
// will be replaced by the current selector. For example `{"&:before":
// {content: '"hi"'}}`. Sub-selectors and regular properties can
// freely be mixed in a given object. Any property containing a `&` is
// assumed to be a sub-selector.
//
// Finally, a property can specify an @-block to be wrapped around the
// styles defined inside the object that's the property's value. For
// example to create a media query you can do `{"@media screen and
// (min-width: 400px)": {...}}`.
var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};var shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:"\""};var chrome$1=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent);var mac=typeof navigator!="undefined"&&/Mac/.test(navigator.platform);var ie$1=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var brokenModifierNames=mac||chrome$1&&+chrome$1[1]<57;// Fill in the digit keys
for(var i=0;i<10;i++){base[48+i]=base[96+i]=String(i);}// The function keys
for(var i=1;i<=24;i++){base[i+111]="F"+i;}// And the alphabetic keys
for(var i=65;i<=90;i++){base[i]=String.fromCharCode(i+32);shift[i]=String.fromCharCode(i);}// For each code that doesn't have a shift-equivalent, copy the base name
for(var code in base){if(!shift.hasOwnProperty(code))shift[code]=base[code];}function keyName(event){var ignoreKey=brokenModifierNames&&(event.ctrlKey||event.altKey||event.metaKey)||ie$1&&event.shiftKey&&event.key&&event.key.length==1||event.key=="Unidentified";var name=!ignoreKey&&event.key||(event.shiftKey?shift:base)[event.keyCode]||event.key||"Unidentified";// Edge sometimes produces wrong names (Issue #3)
if(name=="Esc")name="Escape";if(name=="Del")name="Delete";// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/
if(name=="Left")name="ArrowLeft";if(name=="Up")name="ArrowUp";if(name=="Right")name="ArrowRight";if(name=="Down")name="ArrowDown";return name;}function getSelection(root){var target;// Browsers differ on whether shadow roots have a getSelection
// method. If it exists, use that, otherwise, call it on the
// document.
if(root.nodeType==11){// Shadow root
target=root.getSelection?root:root.ownerDocument;}else{target=root;}return target.getSelection();}function contains(dom,node){return node?dom==node||dom.contains(node.nodeType!=1?node.parentNode:node):false;}function deepActiveElement(doc){var elt=doc.activeElement;while(elt&&elt.shadowRoot){elt=elt.shadowRoot.activeElement;}return elt;}function hasSelection(dom,selection){if(!selection.anchorNode)return false;try{// Firefox will raise 'permission denied' errors when accessing
// properties of `sel.anchorNode` when it's in a generated CSS
// element.
return contains(dom,selection.anchorNode);}catch(_){return false;}}function clientRectsFor(dom){if(dom.nodeType==3)return textRange(dom,0,dom.nodeValue.length).getClientRects();else if(dom.nodeType==1)return dom.getClientRects();else return[];}// Scans forward and backward through DOM positions equivalent to the
// given one to see if the two are in the same place (i.e. after a
// text node vs at the end of that text node)
function isEquivalentPosition(node,off,targetNode,targetOff){return targetNode?scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1):false;}function domIndex(node){for(var index=0;;index++){node=node.previousSibling;if(!node)return index;}}function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return true;if(off==(dir<0?0:maxOffset(node))){if(node.nodeName=="DIV")return false;var _parent2=node.parentNode;if(!_parent2||_parent2.nodeType!=1)return false;off=domIndex(node)+(dir<0?0:1);node=_parent2;}else if(node.nodeType==1){node=node.childNodes[off+(dir<0?-1:0)];if(node.nodeType==1&&node.contentEditable=="false")return false;off=dir<0?maxOffset(node):0;}else{return false;}}}function maxOffset(node){return node.nodeType==3?node.nodeValue.length:node.childNodes.length;}var Rect0={left:0,right:0,top:0,bottom:0};function flattenRect(rect,left){var x=left?rect.left:rect.right;return{left:x,right:x,top:rect.top,bottom:rect.bottom};}function windowRect(win){return{left:0,right:win.innerWidth,top:0,bottom:win.innerHeight};}function scrollRectIntoView(dom,rect,side,x,y,xMargin,yMargin,ltr){var doc=dom.ownerDocument,win=doc.defaultView||window;for(var _cur6=dom;_cur6;){if(_cur6.nodeType==1){// Element
var bounding=void 0,_top5=_cur6==doc.body;if(_top5){bounding=windowRect(win);}else{if(_cur6.scrollHeight<=_cur6.clientHeight&&_cur6.scrollWidth<=_cur6.clientWidth){_cur6=_cur6.assignedSlot||_cur6.parentNode;continue;}var _rect=_cur6.getBoundingClientRect();// Make sure scrollbar width isn't included in the rectangle
bounding={left:_rect.left,right:_rect.left+_cur6.clientWidth,top:_rect.top,bottom:_rect.top+_cur6.clientHeight};}var moveX=0,moveY=0;if(y=="nearest"){if(rect.top<bounding.top){moveY=-(bounding.top-rect.top+yMargin);if(side>0&&rect.bottom>bounding.bottom+moveY)moveY=rect.bottom-bounding.bottom+moveY+yMargin;}else if(rect.bottom>bounding.bottom){moveY=rect.bottom-bounding.bottom+yMargin;if(side<0&&rect.top-moveY<bounding.top)moveY=-(bounding.top+moveY-rect.top+yMargin);}}else{var rectHeight=rect.bottom-rect.top,boundingHeight=bounding.bottom-bounding.top;var targetTop=y=="center"&&rectHeight<=boundingHeight?rect.top+rectHeight/2-boundingHeight/2:y=="start"||y=="center"&&side<0?rect.top-yMargin:rect.bottom-boundingHeight+yMargin;moveY=targetTop-bounding.top;}if(x=="nearest"){if(rect.left<bounding.left){moveX=-(bounding.left-rect.left+xMargin);if(side>0&&rect.right>bounding.right+moveX)moveX=rect.right-bounding.right+moveX+xMargin;}else if(rect.right>bounding.right){moveX=rect.right-bounding.right+xMargin;if(side<0&&rect.left<bounding.left+moveX)moveX=-(bounding.left+moveX-rect.left+xMargin);}}else{var targetLeft=x=="center"?rect.left+(rect.right-rect.left)/2-(bounding.right-bounding.left)/2:x=="start"==ltr?rect.left-xMargin:rect.right-(bounding.right-bounding.left)+xMargin;moveX=targetLeft-bounding.left;}if(moveX||moveY){if(_top5){win.scrollBy(moveX,moveY);}else{var movedX=0,movedY=0;if(moveY){var start=_cur6.scrollTop;_cur6.scrollTop+=moveY;movedY=_cur6.scrollTop-start;}if(moveX){var _start2=_cur6.scrollLeft;_cur6.scrollLeft+=moveX;movedX=_cur6.scrollLeft-_start2;}rect={left:rect.left-movedX,top:rect.top-movedY,right:rect.right-movedX,bottom:rect.bottom-movedY};if(movedX&&Math.abs(movedX-moveX)<1)x="nearest";if(movedY&&Math.abs(movedY-moveY)<1)y="nearest";}}if(_top5)break;_cur6=_cur6.assignedSlot||_cur6.parentNode;}else if(_cur6.nodeType==11){// A shadow root
_cur6=_cur6.host;}else{break;}}}var DOMSelectionState=/*#__PURE__*/function(){function DOMSelectionState(){_classCallCheck(this,DOMSelectionState);this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0;}_createClass(DOMSelectionState,[{key:"eq",value:function eq(domSel){return this.anchorNode==domSel.anchorNode&&this.anchorOffset==domSel.anchorOffset&&this.focusNode==domSel.focusNode&&this.focusOffset==domSel.focusOffset;}},{key:"setRange",value:function setRange(range){this.set(range.anchorNode,range.anchorOffset,range.focusNode,range.focusOffset);}},{key:"set",value:function set(anchorNode,anchorOffset,focusNode,focusOffset){this.anchorNode=anchorNode;this.anchorOffset=anchorOffset;this.focusNode=focusNode;this.focusOffset=focusOffset;}}]);return DOMSelectionState;}();var preventScrollSupported=null;// Feature-detects support for .focus({preventScroll: true}), and uses
// a fallback kludge when not supported.
function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();// in IE
if(preventScrollSupported)return dom.focus(preventScrollSupported);var stack=[];for(var _cur7=dom;_cur7;_cur7=_cur7.parentNode){stack.push(_cur7,_cur7.scrollTop,_cur7.scrollLeft);if(_cur7==_cur7.ownerDocument)break;}dom.focus(preventScrollSupported==null?{get preventScroll(){preventScrollSupported={preventScroll:true};return true;}}:undefined);if(!preventScrollSupported){preventScrollSupported=false;for(var _i107=0;_i107<stack.length;){var elt=stack[_i107++],_top6=stack[_i107++],left=stack[_i107++];if(elt.scrollTop!=_top6)elt.scrollTop=_top6;if(elt.scrollLeft!=left)elt.scrollLeft=left;}}}var scratchRange;function textRange(node,from){var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:from;var range=scratchRange||(scratchRange=document.createRange());range.setEnd(node,to);range.setStart(node,from);return range;}function dispatchKey(elt,name,code){var options={key:name,code:name,keyCode:code,which:code,cancelable:true};var down=new KeyboardEvent("keydown",options);down.synthetic=true;elt.dispatchEvent(down);var up=new KeyboardEvent("keyup",options);up.synthetic=true;elt.dispatchEvent(up);return down.defaultPrevented||up.defaultPrevented;}function getRoot(node){while(node){if(node&&(node.nodeType==9||node.nodeType==11&&node.host))return node;node=node.assignedSlot||node.parentNode;}return null;}function clearAttributes(node){while(node.attributes.length){node.removeAttributeNode(node.attributes[0]);}}function atElementStart(doc,selection){var node=selection.focusNode,offset=selection.focusOffset;if(!node||selection.anchorNode!=node||selection.anchorOffset!=offset)return false;for(;;){if(offset){if(node.nodeType!=1)return false;var prev=node.childNodes[offset-1];if(prev.contentEditable=="false")offset--;else{node=prev;offset=maxOffset(node);}}else if(node==doc){return true;}else{offset=domIndex(node);node=node.parentNode;}}}var DOMPos=/*#__PURE__*/function(){function DOMPos(node,offset){var precise=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;_classCallCheck(this,DOMPos);this.node=node;this.offset=offset;this.precise=precise;}_createClass(DOMPos,null,[{key:"before",value:function before(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom),precise);}},{key:"after",value:function after(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom)+1,precise);}}]);return DOMPos;}();var noChildren=[];var ContentView=/*#__PURE__*/function(){function ContentView(){_classCallCheck(this,ContentView);this.parent=null;this.dom=null;this.dirty=2/* Dirty.Node */;}_createClass(ContentView,[{key:"editorView",get:function get(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView;}},{key:"overrideDOMText",get:function get(){return null;}},{key:"posAtStart",get:function get(){return this.parent?this.parent.posBefore(this):0;}},{key:"posAtEnd",get:function get(){return this.posAtStart+this.length;}},{key:"posBefore",value:function posBefore(view){var pos=this.posAtStart;var _iterator33=_createForOfIteratorHelper(this.children),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var child=_step33.value;if(child==view)return pos;pos+=child.length+child.breakAfter;}}catch(err){_iterator33.e(err);}finally{_iterator33.f();}throw new RangeError("Invalid child in posBefore");}},{key:"posAfter",value:function posAfter(view){return this.posBefore(view)+view.length;}// Will return a rectangle directly before (when side < 0), after
// (side > 0) or directly on (when the browser supports it) the
// given position.
},{key:"coordsAt",value:function coordsAt(_pos,_side){return null;}},{key:"sync",value:function sync(track){if(this.dirty&2/* Dirty.Node */){var _parent3=this.dom;var prev=null,next;var _iterator34=_createForOfIteratorHelper(this.children),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var child=_step34.value;if(child.dirty){if(!child.dom&&(next=prev?prev.nextSibling:_parent3.firstChild)){var contentView=ContentView.get(next);if(!contentView||!contentView.parent&&contentView.canReuseDOM(child))child.reuseDOM(next);}child.sync(track);child.dirty=0/* Dirty.Not */;}next=prev?prev.nextSibling:_parent3.firstChild;if(track&&!track.written&&track.node==_parent3&&next!=child.dom)track.written=true;if(child.dom.parentNode==_parent3){while(next&&next!=child.dom){next=rm$1(next);}}else{_parent3.insertBefore(child.dom,next);}prev=child.dom;}}catch(err){_iterator34.e(err);}finally{_iterator34.f();}next=prev?prev.nextSibling:_parent3.firstChild;if(next&&track&&track.node==_parent3)track.written=true;while(next){next=rm$1(next);}}else if(this.dirty&1/* Dirty.Child */){var _iterator35=_createForOfIteratorHelper(this.children),_step35;try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var _child=_step35.value;if(_child.dirty){_child.sync(track);_child.dirty=0/* Dirty.Not */;}}}catch(err){_iterator35.e(err);}finally{_iterator35.f();}}}},{key:"reuseDOM",value:function reuseDOM(_dom){}},{key:"localPosFromDOM",value:function localPosFromDOM(node,offset){var after;if(node==this.dom){after=this.dom.childNodes[offset];}else{var bias=maxOffset(node)==0?0:offset==0?-1:1;for(;;){var _parent4=node.parentNode;if(_parent4==this.dom)break;if(bias==0&&_parent4.firstChild!=_parent4.lastChild){if(node==_parent4.firstChild)bias=-1;else bias=1;}node=_parent4;}if(bias<0)after=node;else after=node.nextSibling;}if(after==this.dom.firstChild)return 0;while(after&&!ContentView.get(after)){after=after.nextSibling;}if(!after)return this.length;for(var _i108=0,pos=0;;_i108++){var child=this.children[_i108];if(child.dom==after)return pos;pos+=child.length+child.breakAfter;}}},{key:"domBoundsAround",value:function domBoundsAround(from,to){var offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var fromI=-1,fromStart=-1,toI=-1,toEnd=-1;for(var _i109=0,pos=offset,prevEnd=offset;_i109<this.children.length;_i109++){var child=this.children[_i109],end=pos+child.length;if(pos<from&&end>to)return child.domBoundsAround(from,to,pos);if(end>=from&&fromI==-1){fromI=_i109;fromStart=pos;}if(pos>to&&child.dom.parentNode==this.dom){toI=_i109;toEnd=prevEnd;break;}prevEnd=end;pos=end+child.breakAfter;}return{from:fromStart,to:toEnd<0?offset+this.length:toEnd,startDOM:(fromI?this.children[fromI-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:toI<this.children.length&&toI>=0?this.children[toI].dom:null};}},{key:"markDirty",value:function markDirty(){var andParent=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.dirty|=2/* Dirty.Node */;this.markParentsDirty(andParent);}},{key:"markParentsDirty",value:function markParentsDirty(childList){for(var _parent5=this.parent;_parent5;_parent5=_parent5.parent){if(childList)_parent5.dirty|=2/* Dirty.Node */;if(_parent5.dirty&1/* Dirty.Child */)return;_parent5.dirty|=1/* Dirty.Child */;childList=false;}}},{key:"setParent",value:function setParent(parent){if(this.parent!=parent){this.parent=parent;if(this.dirty)this.markParentsDirty(true);}}},{key:"setDOM",value:function setDOM(dom){if(this.dom)this.dom.cmView=null;this.dom=dom;dom.cmView=this;}},{key:"rootView",get:function get(){for(var v=this;;){var _parent6=v.parent;if(!_parent6)return v;v=_parent6;}}},{key:"replaceChildren",value:function replaceChildren(from,to){var _this$children;var children=arguments.length>2&&arguments[2]!==undefined?arguments[2]:noChildren;this.markDirty();for(var _i110=from;_i110<to;_i110++){var child=this.children[_i110];if(child.parent==this)child.destroy();}(_this$children=this.children).splice.apply(_this$children,[from,to-from].concat(_toConsumableArray2(children)));for(var _i111=0;_i111<children.length;_i111++){children[_i111].setParent(this);}}},{key:"ignoreMutation",value:function ignoreMutation(_rec){return false;}},{key:"ignoreEvent",value:function ignoreEvent(_event){return false;}},{key:"childCursor",value:function childCursor(){var pos=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.length;return new ChildCursor(this.children,pos,this.children.length);}},{key:"childPos",value:function childPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return this.childCursor().findPos(pos,bias);}},{key:"toString",value:function toString(){var name=this.constructor.name.replace("View","");return name+(this.children.length?"("+this.children.join()+")":this.length?"["+(name=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"");}},{key:"isEditable",get:function get(){return true;}},{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){return false;}},{key:"become",value:function become(other){return false;}},{key:"canReuseDOM",value:function canReuseDOM(other){return other.constructor==this.constructor;}// When this is a zero-length view with a side, this should return a
// number <= 0 to indicate it is before its position, or a
// number > 0 when after its position.
},{key:"getSide",value:function getSide(){return 0;}},{key:"destroy",value:function destroy(){this.parent=null;}}],[{key:"get",value:function get(node){return node.cmView;}}]);return ContentView;}();ContentView.prototype.breakAfter=0;// Remove a DOM node and return its next sibling.
function rm$1(dom){var next=dom.nextSibling;dom.parentNode.removeChild(dom);return next;}var ChildCursor=/*#__PURE__*/function(){function ChildCursor(children,pos,i){_classCallCheck(this,ChildCursor);this.children=children;this.pos=pos;this.i=i;this.off=0;}_createClass(ChildCursor,[{key:"findPos",value:function findPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;for(;;){if(pos>this.pos||pos==this.pos&&(bias>0||this.i==0||this.children[this.i-1].breakAfter)){this.off=pos-this.pos;return this;}var next=this.children[--this.i];this.pos-=next.length+next.breakAfter;}}}]);return ChildCursor;}();function replaceRange(parent,fromI,fromOff,toI,toOff,insert,breakAtStart,openStart,openEnd){var children=parent.children;var before=children.length?children[fromI]:null;var last=insert.length?insert[insert.length-1]:null;var breakAtEnd=last?last.breakAfter:breakAtStart;// Change within a single child
if(fromI==toI&&before&&!breakAtStart&&!breakAtEnd&&insert.length<2&&before.merge(fromOff,toOff,insert.length?last:null,fromOff==0,openStart,openEnd))return;if(toI<children.length){var _after2=children[toI];// Make sure the end of the child after the update is preserved in `after`
if(_after2&&toOff<_after2.length){// If we're splitting a child, separate part of it to avoid that
// being mangled when updating the child before the update.
if(fromI==toI){_after2=_after2.split(toOff);toOff=0;}// If the element after the replacement should be merged with
// the last replacing element, update `content`
if(!breakAtEnd&&last&&_after2.merge(0,toOff,last,true,0,openEnd)){insert[insert.length-1]=_after2;}else{// Remove the start of the after element, if necessary, and
// add it to `content`.
if(toOff)_after2.merge(0,toOff,null,false,0,openEnd);insert.push(_after2);}}else if(_after2===null||_after2===void 0?void 0:_after2.breakAfter){// The element at `toI` is entirely covered by this range.
// Preserve its line break, if any.
if(last)last.breakAfter=1;else breakAtStart=1;}// Since we've handled the next element from the current elements
// now, make sure `toI` points after that.
toI++;}if(before){before.breakAfter=breakAtStart;if(fromOff>0){if(!breakAtStart&&insert.length&&before.merge(fromOff,before.length,insert[0],false,openStart,0)){before.breakAfter=insert.shift().breakAfter;}else if(fromOff<before.length||before.children.length&&before.children[before.children.length-1].length==0){before.merge(fromOff,before.length,null,false,openStart,0);}fromI++;}}// Try to merge widgets on the boundaries of the replacement
while(fromI<toI&&insert.length){if(children[toI-1].become(insert[insert.length-1])){toI--;insert.pop();openEnd=insert.length?0:openStart;}else if(children[fromI].become(insert[0])){fromI++;insert.shift();openStart=insert.length?0:openEnd;}else{break;}}if(!insert.length&&fromI&&toI<children.length&&!children[fromI-1].breakAfter&&children[toI].merge(0,0,children[fromI-1],false,openStart,openEnd))fromI--;if(fromI<toI||insert.length)parent.replaceChildren(fromI,toI,insert);}function mergeChildrenInto(parent,from,to,insert,openStart,openEnd){var cur=parent.childCursor();var _cur$findPos=cur.findPos(to,1),toI=_cur$findPos.i,toOff=_cur$findPos.off;var _cur$findPos2=cur.findPos(from,-1),fromI=_cur$findPos2.i,fromOff=_cur$findPos2.off;var dLen=from-to;var _iterator36=_createForOfIteratorHelper(insert),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var view=_step36.value;dLen+=view.length;}}catch(err){_iterator36.e(err);}finally{_iterator36.f();}parent.length+=dLen;replaceRange(parent,fromI,fromOff,toI,toOff,insert,0,openStart,openEnd);}var nav=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""};var doc=typeof document!="undefined"?document:{documentElement:{style:{}}};var ie_edge=/*@__PURE__*/ /Edge\/(\d+)/.exec(nav.userAgent);var ie_upto10=/*@__PURE__*/ /MSIE \d/.test(nav.userAgent);var ie_11up=/*@__PURE__*/ /Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent);var ie=!!(ie_upto10||ie_11up||ie_edge);var gecko=!ie&&/*@__PURE__*/ /gecko\/(\d+)/i.test(nav.userAgent);var chrome=!ie&&/*@__PURE__*/ /Chrome\/(\d+)/.exec(nav.userAgent);var webkit=("webkitFontSmoothing"in doc.documentElement.style);var safari=!ie&&/*@__PURE__*/ /Apple Computer/.test(nav.vendor);var ios=safari&&(/*@__PURE__*/ /Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/*@__PURE__*/ /Mac/.test(nav.platform),windows:/*@__PURE__*/ /Win/.test(nav.platform),linux:/*@__PURE__*/ /Linux|X11/.test(nav.platform),ie:ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko:gecko,gecko_version:gecko?+(/*@__PURE__*/ /Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios:ios,android:/*@__PURE__*/ /Android\b/.test(nav.userAgent),webkit:webkit,safari:safari,webkit_version:webkit?+(/*@__PURE__*/ /\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};var MaxJoinLen=256;var TextView=/*#__PURE__*/function(_ContentView){_inherits(TextView,_ContentView);var _super18=_createSuper(TextView);function TextView(text){var _this22;_classCallCheck(this,TextView);_this22=_super18.call(this);_this22.text=text;return _this22;}_createClass(TextView,[{key:"length",get:function get(){return this.text.length;}},{key:"createDOM",value:function createDOM(textDOM){this.setDOM(textDOM||document.createTextNode(this.text));}},{key:"sync",value:function sync(track){if(!this.dom)this.createDOM();if(this.dom.nodeValue!=this.text){if(track&&track.node==this.dom)track.written=true;this.dom.nodeValue=this.text;}}},{key:"reuseDOM",value:function reuseDOM(dom){if(dom.nodeType==3)this.createDOM(dom);}},{key:"merge",value:function merge(from,to,source){if(source&&(!(source instanceof TextView)||this.length-(to-from)+source.length>MaxJoinLen))return false;this.text=this.text.slice(0,from)+(source?source.text:"")+this.text.slice(to);this.markDirty();return true;}},{key:"split",value:function split(from){var result=new TextView(this.text.slice(from));this.text=this.text.slice(0,from);this.markDirty();return result;}},{key:"localPosFromDOM",value:function localPosFromDOM(node,offset){return node==this.dom?offset:offset?this.text.length:0;}},{key:"domAtPos",value:function domAtPos(pos){return new DOMPos(this.dom,pos);}},{key:"domBoundsAround",value:function domBoundsAround(_from,_to,offset){return{from:offset,to:offset+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling};}},{key:"coordsAt",value:function coordsAt(pos,side){return textCoords(this.dom,pos,side);}}]);return TextView;}(ContentView);var MarkView=/*#__PURE__*/function(_ContentView2){_inherits(MarkView,_ContentView2);var _super19=_createSuper(MarkView);function MarkView(mark){var _this23;var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var length=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck(this,MarkView);_this23=_super19.call(this);_this23.mark=mark;_this23.children=children;_this23.length=length;var _iterator37=_createForOfIteratorHelper(children),_step37;try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var ch=_step37.value;ch.setParent(_assertThisInitialized(_this23));}}catch(err){_iterator37.e(err);}finally{_iterator37.f();}return _this23;}_createClass(MarkView,[{key:"setAttrs",value:function setAttrs(dom){clearAttributes(dom);if(this.mark["class"])dom.className=this.mark["class"];if(this.mark.attrs)for(var _name2 in this.mark.attrs){dom.setAttribute(_name2,this.mark.attrs[_name2]);}return dom;}},{key:"reuseDOM",value:function reuseDOM(node){if(node.nodeName==this.mark.tagName.toUpperCase()){this.setDOM(node);this.dirty|=4/* Dirty.Attrs */|2/* Dirty.Node */;}}},{key:"sync",value:function sync(track){if(!this.dom)this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));else if(this.dirty&4/* Dirty.Attrs */)this.setAttrs(this.dom);_get(_getPrototypeOf(MarkView.prototype),"sync",this).call(this,track);}},{key:"merge",value:function merge(from,to,source,_hasStart,openStart,openEnd){if(source&&(!(source instanceof MarkView&&source.mark.eq(this.mark))||from&&openStart<=0||to<this.length&&openEnd<=0))return false;mergeChildrenInto(this,from,to,source?source.children:[],openStart-1,openEnd-1);this.markDirty();return true;}},{key:"split",value:function split(from){var result=[],off=0,detachFrom=-1,i=0;var _iterator38=_createForOfIteratorHelper(this.children),_step38;try{for(_iterator38.s();!(_step38=_iterator38.n()).done;){var elt=_step38.value;var end=off+elt.length;if(end>from)result.push(off<from?elt.split(from-off):elt);if(detachFrom<0&&off>=from)detachFrom=i;off=end;i++;}}catch(err){_iterator38.e(err);}finally{_iterator38.f();}var length=this.length-from;this.length=from;if(detachFrom>-1){this.children.length=detachFrom;this.markDirty();}return new MarkView(this.mark,result,length);}},{key:"domAtPos",value:function domAtPos(pos){return inlineDOMAtPos(this,pos);}},{key:"coordsAt",value:function coordsAt(pos,side){return coordsInChildren(this,pos,side);}}]);return MarkView;}(ContentView);function textCoords(text,pos,side){var length=text.nodeValue.length;if(pos>length)pos=length;var from=pos,to=pos,flatten=0;if(pos==0&&side<0||pos==length&&side>=0){if(!(browser.chrome||browser.gecko)){// These browsers reliably return valid rectangles for empty ranges
if(pos){from--;flatten=1;}// FIXME this is wrong in RTL text
else if(to<length){to++;flatten=-1;}}}else{if(side<0)from--;else if(to<length)to++;}var rects=textRange(text,from,to).getClientRects();if(!rects.length)return Rect0;var rect=rects[(flatten?flatten<0:side>=0)?0:rects.length-1];if(browser.safari&&!flatten&&rect.width==0)rect=Array.prototype.find.call(rects,function(r){return r.width;})||rect;return flatten?flattenRect(rect,flatten<0):rect||null;}// Also used for collapsed ranges that don't have a placeholder widget!
var WidgetView=/*#__PURE__*/function(_ContentView3){_inherits(WidgetView,_ContentView3);var _super20=_createSuper(WidgetView);function WidgetView(widget,length,side){var _this24;_classCallCheck(this,WidgetView);_this24=_super20.call(this);_this24.widget=widget;_this24.length=length;_this24.side=side;_this24.prevWidget=null;return _this24;}_createClass(WidgetView,[{key:"split",value:function split(from){var result=WidgetView.create(this.widget,this.length-from,this.side);this.length-=from;return result;}},{key:"sync",value:function sync(){if(!this.dom||!this.widget.updateDOM(this.dom)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false";}}},{key:"getSide",value:function getSide(){return this.side;}},{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){if(source&&(!(source instanceof WidgetView)||!this.widget.compare(source.widget)||from>0&&openStart<=0||to<this.length&&openEnd<=0))return false;this.length=from+(source?source.length:0)+(this.length-to);return true;}},{key:"become",value:function become(other){if(other.length==this.length&&other instanceof WidgetView&&other.side==this.side){if(this.widget.constructor==other.widget.constructor){if(!this.widget.eq(other.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=other.widget;return true;}}return false;}},{key:"ignoreMutation",value:function ignoreMutation(){return true;}},{key:"ignoreEvent",value:function ignoreEvent(event){return this.widget.ignoreEvent(event);}},{key:"overrideDOMText",get:function get(){if(this.length==0)return Text.empty;var top=this;while(top.parent){top=top.parent;}var view=top.editorView,text=view&&view.state.doc,start=this.posAtStart;return text?text.slice(start,start+this.length):Text.empty;}},{key:"domAtPos",value:function domAtPos(pos){return pos==0?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length);}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"coordsAt",value:function coordsAt(pos,side){var rects=this.dom.getClientRects(),rect=null;if(!rects.length)return Rect0;for(var _i112=pos>0?rects.length-1:0;;_i112+=pos>0?-1:1){rect=rects[_i112];if(pos>0?_i112==0:_i112==rects.length-1||rect.top<rect.bottom)break;}return flattenRect(rect,this.side>0);}},{key:"isEditable",get:function get(){return false;}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(WidgetView.prototype),"destroy",this).call(this);if(this.dom)this.widget.destroy(this.dom);}}],[{key:"create",value:function create(widget,length,side){return new(widget.customView||WidgetView)(widget,length,side);}}]);return WidgetView;}(ContentView);var CompositionView=/*#__PURE__*/function(_WidgetView){_inherits(CompositionView,_WidgetView);var _super21=_createSuper(CompositionView);function CompositionView(){_classCallCheck(this,CompositionView);return _super21.apply(this,arguments);}_createClass(CompositionView,[{key:"domAtPos",value:function domAtPos(pos){var _this$widget=this.widget,topView=_this$widget.topView,text=_this$widget.text;if(!topView)return new DOMPos(text,Math.min(pos,text.nodeValue.length));return scanCompositionTree(pos,0,topView,text,function(v,p){return v.domAtPos(p);},function(p){return new DOMPos(text,Math.min(p,text.nodeValue.length));});}},{key:"sync",value:function sync(){this.setDOM(this.widget.toDOM());}},{key:"localPosFromDOM",value:function localPosFromDOM(node,offset){var _this$widget2=this.widget,topView=_this$widget2.topView,text=_this$widget2.text;if(!topView)return Math.min(offset,this.length);return posFromDOMInCompositionTree(node,offset,topView,text);}},{key:"ignoreMutation",value:function ignoreMutation(){return false;}},{key:"overrideDOMText",get:function get(){return null;}},{key:"coordsAt",value:function coordsAt(pos,side){var _this$widget3=this.widget,topView=_this$widget3.topView,text=_this$widget3.text;if(!topView)return textCoords(text,pos,side);return scanCompositionTree(pos,side,topView,text,function(v,pos,side){return v.coordsAt(pos,side);},function(pos,side){return textCoords(text,pos,side);});}},{key:"destroy",value:function destroy(){var _a;_get(_getPrototypeOf(CompositionView.prototype),"destroy",this).call(this);(_a=this.widget.topView)===null||_a===void 0?void 0:_a.destroy();}},{key:"isEditable",get:function get(){return true;}},{key:"canReuseDOM",value:function canReuseDOM(){return true;}}]);return CompositionView;}(WidgetView);// Uses the old structure of a chunk of content view frozen for
// composition to try and find a reasonable DOM location for the given
// offset.
function scanCompositionTree(pos,side,view,text,enterView,fromText){if(view instanceof MarkView){for(var child=view.dom.firstChild;child;child=child.nextSibling){var desc=ContentView.get(child);if(!desc)return fromText(pos,side);var hasComp=contains(child,text);var len=desc.length+(hasComp?text.nodeValue.length:0);if(pos<len||pos==len&&desc.getSide()<=0)return hasComp?scanCompositionTree(pos,side,desc,text,enterView,fromText):enterView(desc,pos,side);pos-=len;}return enterView(view,view.length,-1);}else if(view.dom==text){return fromText(pos,side);}else{return enterView(view,pos,side);}}function posFromDOMInCompositionTree(node,offset,view,text){if(view instanceof MarkView){var _iterator39=_createForOfIteratorHelper(view.children),_step39;try{for(_iterator39.s();!(_step39=_iterator39.n()).done;){var child=_step39.value;var pos=0,hasComp=contains(child.dom,text);if(contains(child.dom,node))return pos+(hasComp?posFromDOMInCompositionTree(node,offset,child,text):child.localPosFromDOM(node,offset));pos+=hasComp?text.nodeValue.length:child.length;}}catch(err){_iterator39.e(err);}finally{_iterator39.f();}}else if(view.dom==text){return Math.min(offset,text.nodeValue.length);}return view.localPosFromDOM(node,offset);}// These are drawn around uneditable widgets to avoid a number of
// browser bugs that show up when the cursor is directly next to
// uneditable inline content.
var WidgetBufferView=/*#__PURE__*/function(_ContentView4){_inherits(WidgetBufferView,_ContentView4);var _super22=_createSuper(WidgetBufferView);function WidgetBufferView(side){var _this25;_classCallCheck(this,WidgetBufferView);_this25=_super22.call(this);_this25.side=side;return _this25;}_createClass(WidgetBufferView,[{key:"length",get:function get(){return 0;}},{key:"merge",value:function merge(){return false;}},{key:"become",value:function become(other){return other instanceof WidgetBufferView&&other.side==this.side;}},{key:"split",value:function split(){return new WidgetBufferView(this.side);}},{key:"sync",value:function sync(){if(!this.dom){var dom=document.createElement("img");dom.className="cm-widgetBuffer";dom.setAttribute("aria-hidden","true");this.setDOM(dom);}}},{key:"getSide",value:function getSide(){return this.side;}},{key:"domAtPos",value:function domAtPos(pos){return DOMPos.before(this.dom);}},{key:"localPosFromDOM",value:function localPosFromDOM(){return 0;}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"coordsAt",value:function coordsAt(pos){var imgRect=this.dom.getBoundingClientRect();// Since the <img> height doesn't correspond to text height, try
// to borrow the height from some sibling node.
var siblingRect=inlineSiblingRect(this,this.side>0?-1:1);return siblingRect&&siblingRect.top<imgRect.bottom&&siblingRect.bottom>imgRect.top?{left:imgRect.left,right:imgRect.right,top:siblingRect.top,bottom:siblingRect.bottom}:imgRect;}},{key:"overrideDOMText",get:function get(){return Text.empty;}}]);return WidgetBufferView;}(ContentView);TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineSiblingRect(view,side){var parent=view.parent,index=parent?parent.children.indexOf(view):-1;while(parent&&index>=0){if(side<0?index>0:index<parent.children.length){var next=parent.children[index+side];if(next instanceof TextView){var nextRect=next.coordsAt(side<0?next.length:0,side);if(nextRect)return nextRect;}index+=side;}else if(parent instanceof MarkView&&parent.parent){index=parent.parent.children.indexOf(parent)+(side<0?0:1);parent=parent.parent;}else{var _last2=parent.dom.lastChild;if(_last2&&_last2.nodeName=="BR")return _last2.getClientRects()[0];break;}}return undefined;}function inlineDOMAtPos(parent,pos){var dom=parent.dom,children=parent.children,i=0;for(var off=0;i<children.length;i++){var child=children[i],end=off+child.length;if(end==off&&child.getSide()<=0)continue;if(pos>off&&pos<end&&child.dom.parentNode==dom)return child.domAtPos(pos-off);if(pos<=off)break;off=end;}for(var j=i;j>0;j--){var prev=children[j-1];if(prev.dom.parentNode==dom)return prev.domAtPos(prev.length);}for(var _j=i;_j<children.length;_j++){var next=children[_j];if(next.dom.parentNode==dom)return next.domAtPos(0);}return new DOMPos(dom,0);}// Assumes `view`, if a mark view, has precisely 1 child.
function joinInlineInto(parent,view,open){var last,children=parent.children;if(open>0&&view instanceof MarkView&&children.length&&(last=children[children.length-1])instanceof MarkView&&last.mark.eq(view.mark)){joinInlineInto(last,view.children[0],open-1);}else{children.push(view);view.setParent(parent);}parent.length+=view.length;}function coordsInChildren(view,pos,side){if(!view.children.length)return fallbackRect(view);return(side<=0?coordsInChildrenBefore:coordsInChildrenAfter)(view,pos);}function coordsInChildrenBefore(view,pos){// Find the last leaf in the tree that touches pos and doesn't have getSide() > 0
var found=null,foundPos=-1;function scan(view,pos){for(var _i113=0,off=0;_i113<view.children.length&&off<=pos;_i113++){var child=view.children[_i113],end=off+child.length;if(end>=pos){if(child.children.length){if(scan(child,pos-off))return true;}else if(end>=pos){if(end==pos&&child.getSide()>0)return true;found=child;foundPos=pos-off;}}off=end;}}scan(view,pos);return found?found.coordsAt(Math.max(0,foundPos),-1):coordsInChildrenAfter(view,pos);}function coordsInChildrenAfter(view,pos){// Find the first leaf in the tree that touches pos and doesn't have getSide() < 0
var found=null,foundPos=-1;function scan(view,pos){for(var _i114=view.children.length-1,off=view.length;_i114>=0&&off>=pos;_i114--){var child=view.children[_i114];off-=child.length;if(off<=pos){if(child.children.length){if(scan(child,pos-off))return true;}else if(off<=pos){if(off==pos&&child.getSide()<0)return true;found=child;foundPos=pos-off;}}}}scan(view,pos);return found?found.coordsAt(Math.max(0,foundPos),1):coordsInChildrenBefore(view,pos);}function fallbackRect(view){var last=view.dom.lastChild;if(!last)return view.dom.getBoundingClientRect();var rects=clientRectsFor(last);return rects[rects.length-1]||null;}function combineAttrs(source,target){for(var _name3 in source){if(_name3=="class"&&target["class"])target["class"]+=" "+source["class"];else if(_name3=="style"&&target.style)target.style+=";"+source.style;else target[_name3]=source[_name3];}return target;}function attrsEq(a,b){if(a==b)return true;if(!a||!b)return false;var keysA=Object.keys(a),keysB=Object.keys(b);if(keysA.length!=keysB.length)return false;for(var _i115=0,_keysA=keysA;_i115<_keysA.length;_i115++){var key=_keysA[_i115];if(keysB.indexOf(key)==-1||a[key]!==b[key])return false;}return true;}function _updateAttrs(dom,prev,attrs){var changed=null;if(prev)for(var _name4 in prev){if(!(attrs&&_name4 in attrs))dom.removeAttribute(changed=_name4);}if(attrs)for(var _name5 in attrs){if(!(prev&&prev[_name5]==attrs[_name5]))dom.setAttribute(changed=_name5,attrs[_name5]);}return!!changed;}/**
Widgets added to the content are described by subclasses of this
class. Using a description object like that makes it possible to
delay creating of the DOM structure for a widget until it is
needed, and to avoid redrawing widgets even if the decorations
that define them are recreated.
*/var WidgetType=/*#__PURE__*/function(){function WidgetType(){_classCallCheck(this,WidgetType);}_createClass(WidgetType,[{key:"eq",value:/**
    Compare this instance to another instance of the same type.
    (TypeScript can't express this, but only instances of the same
    specific class will be passed to this method.) This is used to
    avoid redrawing widgets when they are replaced by a new
    decoration of the same type. The default implementation just
    returns `false`, which will cause new instances of the widget to
    always be redrawn.
    */function eq(widget){return false;}/**
    Update a DOM element created by a widget of the same type (but
    different, non-`eq` content) to reflect this widget. May return
    true to indicate that it could update, false to indicate it
    couldn't (in which case the widget will be redrawn). The default
    implementation just returns false.
    */},{key:"updateDOM",value:function updateDOM(dom){return false;}/**
    @internal
    */},{key:"compare",value:function compare(other){return this==other||this.constructor==other.constructor&&this.eq(other);}/**
    The estimated height this widget will have, to be used when
    estimating the height of content that hasn't been drawn. May
    return -1 to indicate you don't know. The default implementation
    returns -1.
    */},{key:"estimatedHeight",get:function get(){return-1;}/**
    Can be used to configure which kinds of events inside the widget
    should be ignored by the editor. The default is to ignore all
    events.
    */},{key:"ignoreEvent",value:function ignoreEvent(event){return true;}/**
    @internal
    */},{key:"customView",get:function get(){return null;}/**
    This is called when the an instance of the widget is removed
    from the editor view.
    */},{key:"destroy",value:function destroy(dom){}}]);return WidgetType;}();/**
The different types of blocks that can occur in an editor view.
*/var BlockType=/*@__PURE__*/function(BlockType){/**
    A line of text.
    */BlockType[BlockType["Text"]=0]="Text";/**
    A block widget associated with the position after it.
    */BlockType[BlockType["WidgetBefore"]=1]="WidgetBefore";/**
    A block widget associated with the position before it.
    */BlockType[BlockType["WidgetAfter"]=2]="WidgetAfter";/**
    A block widget [replacing](https://codemirror.net/6/docs/ref/#view.Decoration^replace) a range of content.
    */BlockType[BlockType["WidgetRange"]=3]="WidgetRange";return BlockType;}(BlockType||(BlockType={}));/**
A decoration provides information on how to draw or style a piece
of content. You'll usually use it wrapped in a
[`Range`](https://codemirror.net/6/docs/ref/#state.Range), which adds a start and end position.
@nonabstract
*/var Decoration=/*#__PURE__*/function(_RangeValue){_inherits(Decoration,_RangeValue);var _super23=_createSuper(Decoration);function Decoration(/**
    @internal
    */startSide,/**
    @internal
    */endSide,/**
    @internal
    */widget,/**
    The config object used to create this decoration. You can
    include additional properties in there to store metadata about
    your decoration.
    */spec){var _this26;_classCallCheck(this,Decoration);_this26=_super23.call(this);_this26.startSide=startSide;_this26.endSide=endSide;_this26.widget=widget;_this26.spec=spec;return _this26;}/**
    @internal
    */_createClass(Decoration,[{key:"heightRelevant",get:function get(){return false;}/**
    Create a mark decoration, which influences the styling of the
    content in its range. Nested mark decorations will cause nested
    DOM elements to be created. Nesting order is determined by
    precedence of the [facet](https://codemirror.net/6/docs/ref/#view.EditorView^decorations), with
    the higher-precedence decorations creating the inner DOM nodes.
    Such elements are split on line boundaries and on the boundaries
    of lower-precedence decorations.
    */},{key:"hasHeight",value:/**
    @internal
    */function hasHeight(){return this.widget?this.widget.estimatedHeight>-1:false;}}],[{key:"mark",value:function mark(spec){return new MarkDecoration(spec);}/**
    Create a widget decoration, which displays a DOM element at the
    given position.
    */},{key:"widget",value:function widget(spec){var side=spec.side||0,block=!!spec.block;side+=block?side>0?300000000/* Side.BlockAfter */:-400000000/* Side.BlockBefore */:side>0?100000000/* Side.InlineAfter */:-100000000/* Side.InlineBefore */;return new PointDecoration(spec,side,side,block,spec.widget||null,false);}/**
    Create a replace decoration which replaces the given range with
    a widget, or simply hides it.
    */},{key:"replace",value:function replace(spec){var block=!!spec.block,startSide,endSide;if(spec.isBlockGap){startSide=-500000000/* Side.GapStart */;endSide=400000000/* Side.GapEnd */;}else{var _getInclusive=getInclusive(spec,block),start=_getInclusive.start,end=_getInclusive.end;startSide=(start?block?-300000000/* Side.BlockIncStart */:-1/* Side.InlineIncStart */:500000000/* Side.NonIncStart */)-1;endSide=(end?block?200000000/* Side.BlockIncEnd */:1/* Side.InlineIncEnd */:-600000000/* Side.NonIncEnd */)+1;}return new PointDecoration(spec,startSide,endSide,block,spec.widget||null,true);}/**
    Create a line decoration, which can add DOM attributes to the
    line starting at the given position.
    */},{key:"line",value:function line(spec){return new LineDecoration(spec);}/**
    Build a [`DecorationSet`](https://codemirror.net/6/docs/ref/#view.DecorationSet) from the given
    decorated range or ranges. If the ranges aren't already sorted,
    pass `true` for `sort` to make the library sort them for you.
    */},{key:"set",value:function set(of){var sort=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return RangeSet.of(of,sort);}}]);return Decoration;}(RangeValue);/**
The empty set of decorations.
*/Decoration.none=RangeSet.empty;var MarkDecoration=/*#__PURE__*/function(_Decoration){_inherits(MarkDecoration,_Decoration);var _super24=_createSuper(MarkDecoration);function MarkDecoration(spec){var _this27;_classCallCheck(this,MarkDecoration);var _getInclusive2=getInclusive(spec),start=_getInclusive2.start,end=_getInclusive2.end;_this27=_super24.call(this,start?-1/* Side.InlineIncStart */:500000000/* Side.NonIncStart */,end?1/* Side.InlineIncEnd */:-600000000/* Side.NonIncEnd */,null,spec);_this27.tagName=spec.tagName||"span";_this27["class"]=spec["class"]||"";_this27.attrs=spec.attributes||null;return _this27;}_createClass(MarkDecoration,[{key:"eq",value:function eq(other){return this==other||other instanceof MarkDecoration&&this.tagName==other.tagName&&this["class"]==other["class"]&&attrsEq(this.attrs,other.attrs);}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(from>=to)throw new RangeError("Mark decorations may not be empty");return _get(_getPrototypeOf(MarkDecoration.prototype),"range",this).call(this,from,to);}}]);return MarkDecoration;}(Decoration);MarkDecoration.prototype.point=false;var LineDecoration=/*#__PURE__*/function(_Decoration2){_inherits(LineDecoration,_Decoration2);var _super25=_createSuper(LineDecoration);function LineDecoration(spec){_classCallCheck(this,LineDecoration);return _super25.call(this,-200000000/* Side.Line */,-200000000/* Side.Line */,null,spec);}_createClass(LineDecoration,[{key:"eq",value:function eq(other){return other instanceof LineDecoration&&attrsEq(this.spec.attributes,other.spec.attributes);}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(to!=from)throw new RangeError("Line decoration ranges must be zero-length");return _get(_getPrototypeOf(LineDecoration.prototype),"range",this).call(this,from,to);}}]);return LineDecoration;}(Decoration);LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=true;var PointDecoration=/*#__PURE__*/function(_Decoration3){_inherits(PointDecoration,_Decoration3);var _super26=_createSuper(PointDecoration);function PointDecoration(spec,startSide,endSide,block,widget,isReplace){var _this28;_classCallCheck(this,PointDecoration);_this28=_super26.call(this,startSide,endSide,widget,spec);_this28.block=block;_this28.isReplace=isReplace;_this28.mapMode=!block?MapMode.TrackDel:startSide<=0?MapMode.TrackBefore:MapMode.TrackAfter;return _this28;}// Only relevant when this.block == true
_createClass(PointDecoration,[{key:"type",get:function get(){return this.startSide<this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter;}},{key:"heightRelevant",get:function get(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5;}},{key:"eq",value:function eq(other){return other instanceof PointDecoration&&widgetsEq(this.widget,other.widget)&&this.block==other.block&&this.startSide==other.startSide&&this.endSide==other.endSide;}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(this.isReplace&&(from>to||from==to&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&to!=from)throw new RangeError("Widget decorations can only have zero-length ranges");return _get(_getPrototypeOf(PointDecoration.prototype),"range",this).call(this,from,to);}}]);return PointDecoration;}(Decoration);PointDecoration.prototype.point=true;function getInclusive(spec){var block=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var start=spec.inclusiveStart,end=spec.inclusiveEnd;if(start==null)start=spec.inclusive;if(end==null)end=spec.inclusive;return{start:start!==null&&start!==void 0?start:block,end:end!==null&&end!==void 0?end:block};}function widgetsEq(a,b){return a==b||!!(a&&b&&a.compare(b));}function addRange(from,to,ranges){var margin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var last=ranges.length-1;if(last>=0&&ranges[last]+margin>=from)ranges[last]=Math.max(ranges[last],to);else ranges.push(from,to);}var LineView=/*#__PURE__*/function(_ContentView5){_inherits(LineView,_ContentView5);var _super27=_createSuper(LineView);function LineView(){var _this29;_classCallCheck(this,LineView);_this29=_super27.apply(this,arguments);_this29.children=[];_this29.length=0;_this29.prevAttrs=undefined;_this29.attrs=null;_this29.breakAfter=0;return _this29;}// Consumes source
_createClass(LineView,[{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){if(source){if(!(source instanceof LineView))return false;if(!this.dom)source.transferDOM(this);// Reuse source.dom when appropriate
}if(hasStart)this.setDeco(source?source.attrs:null);mergeChildrenInto(this,from,to,source?source.children:[],openStart,openEnd);return true;}},{key:"split",value:function split(at){var end=new LineView();end.breakAfter=this.breakAfter;if(this.length==0)return end;var _this$childPos=this.childPos(at),i=_this$childPos.i,off=_this$childPos.off;if(off){end.append(this.children[i].split(off),0);this.children[i].merge(off,this.children[i].length,null,false,0,0);i++;}for(var j=i;j<this.children.length;j++){end.append(this.children[j],0);}while(i>0&&this.children[i-1].length==0){this.children[--i].destroy();}this.children.length=i;this.markDirty();this.length=at;return end;}},{key:"transferDOM",value:function transferDOM(other){if(!this.dom)return;this.markDirty();other.setDOM(this.dom);other.prevAttrs=this.prevAttrs===undefined?this.attrs:this.prevAttrs;this.prevAttrs=undefined;this.dom=null;}},{key:"setDeco",value:function setDeco(attrs){if(!attrsEq(this.attrs,attrs)){if(this.dom){this.prevAttrs=this.attrs;this.markDirty();}this.attrs=attrs;}}},{key:"append",value:function append(child,openStart){joinInlineInto(this,child,openStart);}// Only called when building a line view in ContentBuilder
},{key:"addLineDeco",value:function addLineDeco(deco){var attrs=deco.spec.attributes,cls=deco.spec["class"];if(attrs)this.attrs=combineAttrs(attrs,this.attrs||{});if(cls)this.attrs=combineAttrs({"class":cls},this.attrs||{});}},{key:"domAtPos",value:function domAtPos(pos){return inlineDOMAtPos(this,pos);}},{key:"reuseDOM",value:function reuseDOM(node){if(node.nodeName=="DIV"){this.setDOM(node);this.dirty|=4/* Dirty.Attrs */|2/* Dirty.Node */;}}},{key:"sync",value:function sync(track){var _a;if(!this.dom){this.setDOM(document.createElement("div"));this.dom.className="cm-line";this.prevAttrs=this.attrs?null:undefined;}else if(this.dirty&4/* Dirty.Attrs */){clearAttributes(this.dom);this.dom.className="cm-line";this.prevAttrs=this.attrs?null:undefined;}if(this.prevAttrs!==undefined){_updateAttrs(this.dom,this.prevAttrs,this.attrs);this.dom.classList.add("cm-line");this.prevAttrs=undefined;}_get(_getPrototypeOf(LineView.prototype),"sync",this).call(this,track);var last=this.dom.lastChild;while(last&&ContentView.get(last)instanceof MarkView){last=last.lastChild;}if(!last||!this.length||last.nodeName!="BR"&&((_a=ContentView.get(last))===null||_a===void 0?void 0:_a.isEditable)==false&&(!browser.ios||!this.children.some(function(ch){return ch instanceof TextView;}))){var hack=document.createElement("BR");hack.cmIgnore=true;this.dom.appendChild(hack);}}},{key:"measureTextSize",value:function measureTextSize(){if(this.children.length==0||this.length>20)return null;var totalWidth=0;var _iterator40=_createForOfIteratorHelper(this.children),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var child=_step40.value;if(!(child instanceof TextView)||/[^ -~]/.test(child.text))return null;var rects=clientRectsFor(child.dom);if(rects.length!=1)return null;totalWidth+=rects[0].width;}}catch(err){_iterator40.e(err);}finally{_iterator40.f();}return!totalWidth?null:{lineHeight:this.dom.getBoundingClientRect().height,charWidth:totalWidth/this.length};}},{key:"coordsAt",value:function coordsAt(pos,side){return coordsInChildren(this,pos,side);}},{key:"become",value:function become(_other){return false;}},{key:"type",get:function get(){return BlockType.Text;}}],[{key:"find",value:function find(docView,pos){for(var _i116=0,off=0;_i116<docView.children.length;_i116++){var block=docView.children[_i116],end=off+block.length;if(end>=pos){if(block instanceof LineView)return block;if(end>pos)break;}off=end+block.breakAfter;}return null;}}]);return LineView;}(ContentView);var BlockWidgetView=/*#__PURE__*/function(_ContentView6){_inherits(BlockWidgetView,_ContentView6);var _super28=_createSuper(BlockWidgetView);function BlockWidgetView(widget,length,type){var _this30;_classCallCheck(this,BlockWidgetView);_this30=_super28.call(this);_this30.widget=widget;_this30.length=length;_this30.type=type;_this30.breakAfter=0;_this30.prevWidget=null;return _this30;}_createClass(BlockWidgetView,[{key:"merge",value:function merge(from,to,source,_takeDeco,openStart,openEnd){if(source&&(!(source instanceof BlockWidgetView)||!this.widget.compare(source.widget)||from>0&&openStart<=0||to<this.length&&openEnd<=0))return false;this.length=from+(source?source.length:0)+(this.length-to);return true;}},{key:"domAtPos",value:function domAtPos(pos){return pos==0?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length);}},{key:"split",value:function split(at){var len=this.length-at;this.length=at;var end=new BlockWidgetView(this.widget,len,this.type);end.breakAfter=this.breakAfter;return end;}},{key:"children",get:function get(){return noChildren;}},{key:"sync",value:function sync(){if(!this.dom||!this.widget.updateDOM(this.dom)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false";}}},{key:"overrideDOMText",get:function get(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty;}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"become",value:function become(other){if(other instanceof BlockWidgetView&&other.type==this.type&&other.widget.constructor==this.widget.constructor){if(!other.widget.eq(this.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=other.widget;this.length=other.length;this.breakAfter=other.breakAfter;return true;}return false;}},{key:"ignoreMutation",value:function ignoreMutation(){return true;}},{key:"ignoreEvent",value:function ignoreEvent(event){return this.widget.ignoreEvent(event);}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(BlockWidgetView.prototype),"destroy",this).call(this);if(this.dom)this.widget.destroy(this.dom);}}]);return BlockWidgetView;}(ContentView);var ContentBuilder=/*#__PURE__*/function(){function ContentBuilder(doc,pos,end,disallowBlockEffectsFor){_classCallCheck(this,ContentBuilder);this.doc=doc;this.pos=pos;this.end=end;this.disallowBlockEffectsFor=disallowBlockEffectsFor;this.content=[];this.curLine=null;this.breakAtStart=0;this.pendingBuffer=0/* Buf.No */;// Set to false directly after a widget that covers the position after it
this.atCursorPos=true;this.openStart=-1;this.openEnd=-1;this.text="";this.textOff=0;this.cursor=doc.iter();this.skip=pos;}_createClass(ContentBuilder,[{key:"posCovered",value:function posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var last=this.content[this.content.length-1];return!last.breakAfter&&!(last instanceof BlockWidgetView&&last.type==BlockType.WidgetBefore);}},{key:"getLine",value:function getLine(){if(!this.curLine){this.content.push(this.curLine=new LineView());this.atCursorPos=true;}return this.curLine;}},{key:"flushBuffer",value:function flushBuffer(active){if(this.pendingBuffer){this.curLine.append(wrapMarks(new WidgetBufferView(-1),active),active.length);this.pendingBuffer=0/* Buf.No */;}}},{key:"addBlockWidget",value:function addBlockWidget(view){this.flushBuffer([]);this.curLine=null;this.content.push(view);}},{key:"finish",value:function finish(openEnd){if(!openEnd)this.flushBuffer([]);else this.pendingBuffer=0/* Buf.No */;if(!this.posCovered())this.getLine();}},{key:"buildText",value:function buildText(length,active,openStart){while(length>0){if(this.textOff==this.text.length){var _this$cursor$next2=this.cursor.next(this.skip),value=_this$cursor$next2.value,lineBreak=_this$cursor$next2.lineBreak,done=_this$cursor$next2.done;this.skip=0;if(done)throw new Error("Ran out of text content when drawing inline views");if(lineBreak){if(!this.posCovered())this.getLine();if(this.content.length)this.content[this.content.length-1].breakAfter=1;else this.breakAtStart=1;this.flushBuffer([]);this.curLine=null;length--;continue;}else{this.text=value;this.textOff=0;}}var _take=Math.min(this.text.length-this.textOff,length,512/* T.Chunk */);this.flushBuffer(active.slice(0,openStart));this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+_take)),active),openStart);this.atCursorPos=true;this.textOff+=_take;length-=_take;openStart=0;}}},{key:"span",value:function span(from,to,active,openStart){this.buildText(to-from,active,openStart);this.pos=to;if(this.openStart<0)this.openStart=openStart;}},{key:"point",value:function point(from,to,deco,active,openStart,index){if(this.disallowBlockEffectsFor[index]&&deco instanceof PointDecoration){if(deco.block)throw new RangeError("Block decorations may not be specified via plugins");if(to>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins");}var len=to-from;if(deco instanceof PointDecoration){if(deco.block){var type=deco.type;if(type==BlockType.WidgetAfter&&!this.posCovered())this.getLine();this.addBlockWidget(new BlockWidgetView(deco.widget||new NullWidget("div"),len,type));}else{var view=WidgetView.create(deco.widget||new NullWidget("span"),len,len?0:deco.startSide);var cursorBefore=this.atCursorPos&&!view.isEditable&&openStart<=active.length&&(from<to||deco.startSide>0);var cursorAfter=!view.isEditable&&(from<to||deco.startSide<=0);var line=this.getLine();if(this.pendingBuffer==2/* Buf.IfCursor */&&!cursorBefore)this.pendingBuffer=0/* Buf.No */;this.flushBuffer(active);if(cursorBefore){line.append(wrapMarks(new WidgetBufferView(1),active),openStart);openStart=active.length+Math.max(0,openStart-active.length);}line.append(wrapMarks(view,active),openStart);this.atCursorPos=cursorAfter;this.pendingBuffer=!cursorAfter?0/* Buf.No */:from<to?1/* Buf.Yes */:2/* Buf.IfCursor */;}}else if(this.doc.lineAt(this.pos).from==this.pos){// Line decoration
this.getLine().addLineDeco(deco);}if(len){// Advance the iterator past the replaced content
if(this.textOff+len<=this.text.length){this.textOff+=len;}else{this.skip+=len-(this.text.length-this.textOff);this.text="";this.textOff=0;}this.pos=to;}if(this.openStart<0)this.openStart=openStart;}}],[{key:"build",value:function build(text,from,to,decorations,dynamicDecorationMap){var builder=new ContentBuilder(text,from,to,dynamicDecorationMap);builder.openEnd=RangeSet.spans(decorations,from,to,builder);if(builder.openStart<0)builder.openStart=builder.openEnd;builder.finish(builder.openEnd);return builder;}}]);return ContentBuilder;}();function wrapMarks(view,active){var _iterator41=_createForOfIteratorHelper(active),_step41;try{for(_iterator41.s();!(_step41=_iterator41.n()).done;){var mark=_step41.value;view=new MarkView(mark,[view],view.length);}}catch(err){_iterator41.e(err);}finally{_iterator41.f();}return view;}var NullWidget=/*#__PURE__*/function(_WidgetType){_inherits(NullWidget,_WidgetType);var _super29=_createSuper(NullWidget);function NullWidget(tag){var _this31;_classCallCheck(this,NullWidget);_this31=_super29.call(this);_this31.tag=tag;return _this31;}_createClass(NullWidget,[{key:"eq",value:function eq(other){return other.tag==this.tag;}},{key:"toDOM",value:function toDOM(){return document.createElement(this.tag);}},{key:"updateDOM",value:function updateDOM(elt){return elt.nodeName.toLowerCase()==this.tag;}}]);return NullWidget;}(WidgetType);var clickAddsSelectionRange=/*@__PURE__*/Facet.define();var dragMovesSelection$1=/*@__PURE__*/Facet.define();var mouseSelectionStyle=/*@__PURE__*/Facet.define();var exceptionSink=/*@__PURE__*/Facet.define();var updateListener=/*@__PURE__*/Facet.define();var inputHandler$1=/*@__PURE__*/Facet.define();var perLineTextDirection=/*@__PURE__*/Facet.define({combine:function combine(values){return values.some(function(x){return x;});}});var ScrollTarget=/*#__PURE__*/function(){function ScrollTarget(range){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"nearest";var x=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"nearest";var yMargin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;var xMargin=arguments.length>4&&arguments[4]!==undefined?arguments[4]:5;_classCallCheck(this,ScrollTarget);this.range=range;this.y=y;this.x=x;this.yMargin=yMargin;this.xMargin=xMargin;}_createClass(ScrollTarget,[{key:"map",value:function map(changes){return changes.empty?this:new ScrollTarget(this.range.map(changes),this.y,this.x,this.yMargin,this.xMargin);}}]);return ScrollTarget;}();var scrollIntoView$1=/*@__PURE__*/StateEffect.define({map:function map(t,ch){return t.map(ch);}});/**
Log or report an unhandled exception in client code. Should
probably only be used by extension code that allows client code to
provide functions, and calls those functions in a context where an
exception can't be propagated to calling code in a reasonable way
(for example when in an event handler).

Either calls a handler registered with
[`EditorView.exceptionSink`](https://codemirror.net/6/docs/ref/#view.EditorView^exceptionSink),
`window.onerror`, if defined, or `console.error` (in which case
it'll pass `context`, when given, as first argument).
*/function logException(state,exception,context){var handler=state.facet(exceptionSink);if(handler.length)handler[0](exception);else if(window.onerror)window.onerror(String(exception),context,undefined,undefined,exception);else if(context)console.error(context+":",exception);else console.error(exception);}var editable=/*@__PURE__*/Facet.define({combine:function combine(values){return values.length?values[0]:true;}});var nextPluginID=0;var viewPlugin=/*@__PURE__*/Facet.define();/**
View plugins associate stateful values with a view. They can
influence the way the content is drawn, and are notified of things
that happen in the view.
*/var ViewPlugin=/*#__PURE__*/function(){function ViewPlugin(/**
    @internal
    */id,/**
    @internal
    */create,/**
    @internal
    */domEventHandlers,buildExtensions){_classCallCheck(this,ViewPlugin);this.id=id;this.create=create;this.domEventHandlers=domEventHandlers;this.extension=buildExtensions(this);}/**
    Define a plugin from a constructor function that creates the
    plugin's value, given an editor view.
    */_createClass(ViewPlugin,null,[{key:"define",value:function define(create,spec){var _ref38=spec||{},eventHandlers=_ref38.eventHandlers,provide=_ref38.provide,deco=_ref38.decorations;return new ViewPlugin(nextPluginID++,create,eventHandlers,function(plugin){var ext=[viewPlugin.of(plugin)];if(deco)ext.push(decorations.of(function(view){var pluginInst=view.plugin(plugin);return pluginInst?deco(pluginInst):Decoration.none;}));if(provide)ext.push(provide(plugin));return ext;});}/**
    Create a plugin for a class whose constructor takes a single
    editor view as argument.
    */},{key:"fromClass",value:function fromClass(cls,spec){return ViewPlugin.define(function(view){return new cls(view);},spec);}}]);return ViewPlugin;}();var PluginInstance=/*#__PURE__*/function(){function PluginInstance(spec){_classCallCheck(this,PluginInstance);this.spec=spec;// When starting an update, all plugins have this field set to the
// update object, indicating they need to be updated. When finished
// updating, it is set to `false`. Retrieving a plugin that needs to
// be updated with `view.plugin` forces an eager update.
this.mustUpdate=null;// This is null when the plugin is initially created, but
// initialized on the first update.
this.value=null;}_createClass(PluginInstance,[{key:"update",value:function update(view){if(!this.value){if(this.spec){try{this.value=this.spec.create(view);}catch(e){logException(view.state,e,"CodeMirror plugin crashed");this.deactivate();}}}else if(this.mustUpdate){var _update=this.mustUpdate;this.mustUpdate=null;if(this.value.update){try{this.value.update(_update);}catch(e){logException(_update.state,e,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy();}catch(_){}this.deactivate();}}}return this;}},{key:"destroy",value:function destroy(view){var _a;if((_a=this.value)===null||_a===void 0?void 0:_a.destroy){try{this.value.destroy();}catch(e){logException(view.state,e,"CodeMirror plugin crashed");}}}},{key:"deactivate",value:function deactivate(){this.spec=this.value=null;}}]);return PluginInstance;}();var editorAttributes=/*@__PURE__*/Facet.define();var contentAttributes=/*@__PURE__*/Facet.define();// Provide decorations
var decorations=/*@__PURE__*/Facet.define();var atomicRanges=/*@__PURE__*/Facet.define();var scrollMargins=/*@__PURE__*/Facet.define();var styleModule=/*@__PURE__*/Facet.define();var ChangedRange=/*#__PURE__*/function(){function ChangedRange(fromA,toA,fromB,toB){_classCallCheck(this,ChangedRange);this.fromA=fromA;this.toA=toA;this.fromB=fromB;this.toB=toB;}_createClass(ChangedRange,[{key:"join",value:function join(other){return new ChangedRange(Math.min(this.fromA,other.fromA),Math.max(this.toA,other.toA),Math.min(this.fromB,other.fromB),Math.max(this.toB,other.toB));}},{key:"addToSet",value:function addToSet(set){var i=set.length,me=this;for(;i>0;i--){var _range6=set[i-1];if(_range6.fromA>me.toA)continue;if(_range6.toA<me.fromA)break;me=me.join(_range6);set.splice(i-1,1);}set.splice(i,0,me);return set;}}],[{key:"extendWithRanges",value:function extendWithRanges(diff,ranges){if(ranges.length==0)return diff;var result=[];for(var dI=0,rI=0,posA=0,posB=0;;dI++){var next=dI==diff.length?null:diff[dI],off=posA-posB;var end=next?next.fromB:1e9;while(rI<ranges.length&&ranges[rI]<end){var from=ranges[rI],to=ranges[rI+1];var fromB=Math.max(posB,from),toB=Math.min(end,to);if(fromB<=toB)new ChangedRange(fromB+off,toB+off,fromB,toB).addToSet(result);if(to>end)break;else rI+=2;}if(!next)return result;new ChangedRange(next.fromA,next.toA,next.fromB,next.toB).addToSet(result);posA=next.toA;posB=next.toB;}}}]);return ChangedRange;}();/**
View [plugins](https://codemirror.net/6/docs/ref/#view.ViewPlugin) are given instances of this
class, which describe what happened, whenever the view is updated.
*/var ViewUpdate=/*#__PURE__*/function(){function ViewUpdate(/**
    The editor view that the update is associated with.
    */view,/**
    The new editor state.
    */state,/**
    The transactions involved in the update. May be empty.
    */transactions){_classCallCheck(this,ViewUpdate);this.view=view;this.state=state;this.transactions=transactions;/**
        @internal
        */this.flags=0;this.startState=view.state;this.changes=ChangeSet.empty(this.startState.doc.length);var _iterator42=_createForOfIteratorHelper(transactions),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var tr=_step42.value;this.changes=this.changes.compose(tr.changes);}}catch(err){_iterator42.e(err);}finally{_iterator42.f();}var changedRanges=[];this.changes.iterChangedRanges(function(fromA,toA,fromB,toB){return changedRanges.push(new ChangedRange(fromA,toA,fromB,toB));});this.changedRanges=changedRanges;var focus=view.hasFocus;if(focus!=view.inputState.notifiedFocused){view.inputState.notifiedFocused=focus;this.flags|=1/* UpdateFlag.Focus */;}}/**
    @internal
    */_createClass(ViewUpdate,[{key:"viewportChanged",get:/**
    Tells you whether the [viewport](https://codemirror.net/6/docs/ref/#view.EditorView.viewport) or
    [visible ranges](https://codemirror.net/6/docs/ref/#view.EditorView.visibleRanges) changed in this
    update.
    */function get(){return(this.flags&4/* UpdateFlag.Viewport */)>0;}/**
    Indicates whether the height of a block element in the editor
    changed in this update.
    */},{key:"heightChanged",get:function get(){return(this.flags&2/* UpdateFlag.Height */)>0;}/**
    Returns true when the document was modified or the size of the
    editor, or elements within the editor, changed.
    */},{key:"geometryChanged",get:function get(){return this.docChanged||(this.flags&(8/* UpdateFlag.Geometry */|2/* UpdateFlag.Height */))>0;}/**
    True when this update indicates a focus change.
    */},{key:"focusChanged",get:function get(){return(this.flags&1/* UpdateFlag.Focus */)>0;}/**
    Whether the document changed in this update.
    */},{key:"docChanged",get:function get(){return!this.changes.empty;}/**
    Whether the selection was explicitly set in this update.
    */},{key:"selectionSet",get:function get(){return this.transactions.some(function(tr){return tr.selection;});}/**
    @internal
    */},{key:"empty",get:function get(){return this.flags==0&&this.transactions.length==0;}}],[{key:"create",value:function create(view,state,transactions){return new ViewUpdate(view,state,transactions);}}]);return ViewUpdate;}();/**
Used to indicate [text direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection).
*/var Direction=/*@__PURE__*/function(Direction){// (These are chosen to match the base levels, in bidi algorithm
// terms, of spans in that direction.)
/**
    Left-to-right.
    */Direction[Direction["LTR"]=0]="LTR";/**
    Right-to-left.
    */Direction[Direction["RTL"]=1]="RTL";return Direction;}(Direction||(Direction={}));var LTR=Direction.LTR,RTL=Direction.RTL;// Decode a string with each type encoded as log2(type)
function dec(str){var result=[];for(var _i117=0;_i117<str.length;_i117++){result.push(1<<+str[_i117]);}return result;}// Character types for codepoints 0 to 0xf8
var LowTypes=/*@__PURE__*/dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008");// Character types for codepoints 0x600 to 0x6f9
var ArabicTypes=/*@__PURE__*/dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333");var Brackets=/*@__PURE__*/Object.create(null),BracketStack=[];// There's a lot more in
// https://www.unicode.org/Public/UCD/latest/ucd/BidiBrackets.txt,
// which are left out to keep code size down.
for(var _i118=0,_arr2=["()","[]","{}"];_i118<_arr2.length;_i118++){var p=_arr2[_i118];var l=/*@__PURE__*/p.charCodeAt(0),r=/*@__PURE__*/p.charCodeAt(1);Brackets[l]=r;Brackets[r]=-l;}function charType(ch){return ch<=0xf7?LowTypes[ch]:0x590<=ch&&ch<=0x5f4?2/* T.R */:0x600<=ch&&ch<=0x6f9?ArabicTypes[ch-0x600]:0x6ee<=ch&&ch<=0x8ac?4/* T.AL */:0x2000<=ch&&ch<=0x200b?256/* T.NI */:0xfb50<=ch&&ch<=0xfdff?4/* T.AL */:ch==0x200c?256/* T.NI */:1/* T.L */;}var BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;/**
Represents a contiguous range of text that has a single direction
(as in left-to-right or right-to-left).
*/var BidiSpan=/*#__PURE__*/function(){/**
    @internal
    */function BidiSpan(/**
    The start of the span (relative to the start of the line).
    */from,/**
    The end of the span.
    */to,/**
    The ["bidi
    level"](https://unicode.org/reports/tr9/#Basic_Display_Algorithm)
    of the span (in this context, 0 means
    left-to-right, 1 means right-to-left, 2 means left-to-right
    number inside right-to-left text).
    */level){_classCallCheck(this,BidiSpan);this.from=from;this.to=to;this.level=level;}/**
    The direction of this span.
    */_createClass(BidiSpan,[{key:"dir",get:function get(){return this.level%2?RTL:LTR;}/**
    @internal
    */},{key:"side",value:function side(end,dir){return this.dir==dir==end?this.to:this.from;}/**
    @internal
    */}],[{key:"find",value:function find(order,index,level,assoc){var maybe=-1;for(var _i119=0;_i119<order.length;_i119++){var span=order[_i119];if(span.from<=index&&span.to>=index){if(span.level==level)return _i119;// When multiple spans match, if assoc != 0, take the one that
// covers that side, otherwise take the one with the minimum
// level.
if(maybe<0||(assoc!=0?assoc<0?span.from<index:span.to>index:order[maybe].level>span.level))maybe=_i119;}}if(maybe<0)throw new RangeError("Index out of range");return maybe;}}]);return BidiSpan;}();// Reused array of character types
var types=[];function computeOrder(line,direction){var len=line.length,outerType=direction==LTR?1/* T.L */:2/* T.R */,oppositeType=direction==LTR?2/* T.R */:1/* T.L */;if(!line||outerType==1/* T.L */&&!BidiRE.test(line))return trivialOrder(len);// W1. Examine each non-spacing mark (NSM) in the level run, and
// change the type of the NSM to the type of the previous
// character. If the NSM is at the start of the level run, it will
// get the type of sor.
// W2. Search backwards from each instance of a European number
// until the first strong type (R, L, AL, or sor) is found. If an
// AL is found, change the type of the European number to Arabic
// number.
// W3. Change all ALs to R.
// (Left after this: L, R, EN, AN, ET, CS, NI)
for(var _i120=0,prev=outerType,prevStrong=outerType;_i120<len;_i120++){var type=charType(line.charCodeAt(_i120));if(type==512/* T.NSM */)type=prev;else if(type==8/* T.EN */&&prevStrong==4/* T.AL */)type=16/* T.AN */;types[_i120]=type==4/* T.AL */?2/* T.R */:type;if(type&7/* T.Strong */)prevStrong=type;prev=type;}// W5. A sequence of European terminators adjacent to European
// numbers changes to all European numbers.
// W6. Otherwise, separators and terminators change to Other
// Neutral.
// W7. Search backwards from each instance of a European number
// until the first strong type (R, L, or sor) is found. If an L is
// found, then change the type of the European number to L.
// (Left after this: L, R, EN+AN, NI)
for(var _i121=0,_prev=outerType,_prevStrong=outerType;_i121<len;_i121++){var _type2=types[_i121];if(_type2==128/* T.CS */){if(_i121<len-1&&_prev==types[_i121+1]&&_prev&24/* T.Num */)_type2=types[_i121]=_prev;else types[_i121]=256/* T.NI */;}else if(_type2==64/* T.ET */){var end=_i121+1;while(end<len&&types[end]==64/* T.ET */){end++;}var _replace=_i121&&_prev==8/* T.EN */||end<len&&types[end]==8/* T.EN */?_prevStrong==1/* T.L */?1/* T.L */:8/* T.EN */:256/* T.NI */;for(var j=_i121;j<end;j++){types[j]=_replace;}_i121=end-1;}else if(_type2==8/* T.EN */&&_prevStrong==1/* T.L */){types[_i121]=1/* T.L */;}_prev=_type2;if(_type2&7/* T.Strong */)_prevStrong=_type2;}// N0. Process bracket pairs in an isolating run sequence
// sequentially in the logical order of the text positions of the
// opening paired brackets using the logic given below. Within this
// scope, bidirectional types EN and AN are treated as R.
for(var _i122=0,sI=0,context=0,ch,br,_type3;_i122<len;_i122++){// Keeps [startIndex, type, strongSeen] triples for each open
// bracket on BracketStack.
if(br=Brackets[ch=line.charCodeAt(_i122)]){if(br<0){// Closing bracket
for(var sJ=sI-3;sJ>=0;sJ-=3){if(BracketStack[sJ+1]==-br){var flags=BracketStack[sJ+2];var _type4=flags&2/* Bracketed.EmbedInside */?outerType:!(flags&4/* Bracketed.OppositeInside */)?0:flags&1/* Bracketed.OppositeBefore */?oppositeType:outerType;if(_type4)types[_i122]=types[BracketStack[sJ]]=_type4;sI=sJ;break;}}}else if(BracketStack.length==189/* Bracketed.MaxDepth */){break;}else{BracketStack[sI++]=_i122;BracketStack[sI++]=ch;BracketStack[sI++]=context;}}else if((_type3=types[_i122])==2/* T.R */||_type3==1/* T.L */){var embed=_type3==outerType;context=embed?0:1/* Bracketed.OppositeBefore */;for(var _sJ=sI-3;_sJ>=0;_sJ-=3){var _cur8=BracketStack[_sJ+2];if(_cur8&2/* Bracketed.EmbedInside */)break;if(embed){BracketStack[_sJ+2]|=2/* Bracketed.EmbedInside */;}else{if(_cur8&4/* Bracketed.OppositeInside */)break;BracketStack[_sJ+2]|=4/* Bracketed.OppositeInside */;}}}}// N1. A sequence of neutrals takes the direction of the
// surrounding strong text if the text on both sides has the same
// direction. European and Arabic numbers act as if they were R in
// terms of their influence on neutrals. Start-of-level-run (sor)
// and end-of-level-run (eor) are used at level run boundaries.
// N2. Any remaining neutrals take the embedding direction.
// (Left after this: L, R, EN+AN)
for(var _i123=0;_i123<len;_i123++){if(types[_i123]==256/* T.NI */){var _end2=_i123+1;while(_end2<len&&types[_end2]==256/* T.NI */){_end2++;}var beforeL=(_i123?types[_i123-1]:outerType)==1/* T.L */;var afterL=(_end2<len?types[_end2]:outerType)==1/* T.L */;var _replace2=beforeL==afterL?beforeL?1/* T.L */:2/* T.R */:outerType;for(var _j2=_i123;_j2<_end2;_j2++){types[_j2]=_replace2;}_i123=_end2-1;}}// Here we depart from the documented algorithm, in order to avoid
// building up an actual levels array. Since there are only three
// levels (0, 1, 2) in an implementation that doesn't take
// explicit embedding into account, we can build up the order on
// the fly, without following the level-based algorithm.
var order=[];if(outerType==1/* T.L */){for(var _i124=0;_i124<len;){var start=_i124,rtl=types[_i124++]!=1/* T.L */;while(_i124<len&&rtl==(types[_i124]!=1/* T.L */)){_i124++;}if(rtl){for(var _j3=_i124;_j3>start;){var _end3=_j3,_l=types[--_j3]!=2/* T.R */;while(_j3>start&&_l==(types[_j3-1]!=2/* T.R */)){_j3--;}order.push(new BidiSpan(_j3,_end3,_l?2:1));}}else{order.push(new BidiSpan(start,_i124,0));}}}else{for(var _i125=0;_i125<len;){var _start3=_i125,_rtl=types[_i125++]==2/* T.R */;while(_i125<len&&_rtl==(types[_i125]==2/* T.R */)){_i125++;}order.push(new BidiSpan(_start3,_i125,_rtl?1:2));}}return order;}function trivialOrder(length){return[new BidiSpan(0,length,0)];}var movedOver="";function moveVisually(line,order,dir,start,forward){var _a;var startIndex=start.head-line.from,spanI=-1;if(startIndex==0){if(!forward||!line.length)return null;if(order[0].level!=dir){startIndex=order[0].side(false,dir);spanI=0;}}else if(startIndex==line.length){if(forward)return null;var _last3=order[order.length-1];if(_last3.level!=dir){startIndex=_last3.side(true,dir);spanI=order.length-1;}}if(spanI<0)spanI=BidiSpan.find(order,startIndex,(_a=start.bidiLevel)!==null&&_a!==void 0?_a:-1,start.assoc);var span=order[spanI];// End of span. (But not end of line--that was checked for above.)
if(startIndex==span.side(forward,dir)){span=order[spanI+=forward?1:-1];startIndex=span.side(!forward,dir);}var indexForward=forward==(span.dir==dir);var nextIndex=findClusterBreak(line.text,startIndex,indexForward);movedOver=line.text.slice(Math.min(startIndex,nextIndex),Math.max(startIndex,nextIndex));if(nextIndex!=span.side(forward,dir))return EditorSelection.cursor(nextIndex+line.from,indexForward?-1:1,span.level);var nextSpan=spanI==(forward?order.length-1:0)?null:order[spanI+(forward?1:-1)];if(!nextSpan&&span.level!=dir)return EditorSelection.cursor(forward?line.to:line.from,forward?-1:1,dir);if(nextSpan&&nextSpan.level<span.level)return EditorSelection.cursor(nextSpan.side(!forward,dir)+line.from,forward?1:-1,nextSpan.level);return EditorSelection.cursor(nextIndex+line.from,forward?-1:1,span.level);}var LineBreakPlaceholder="\uFFFF";var DOMReader=/*#__PURE__*/function(){function DOMReader(points,state){_classCallCheck(this,DOMReader);this.points=points;this.text="";this.lineSeparator=state.facet(EditorState.lineSeparator);}_createClass(DOMReader,[{key:"append",value:function append(text){this.text+=text;}},{key:"lineBreak",value:function lineBreak(){this.text+=LineBreakPlaceholder;}},{key:"readRange",value:function readRange(start,end){if(!start)return this;var parent=start.parentNode;for(var _cur9=start;;){this.findPointBefore(parent,_cur9);this.readNode(_cur9);var next=_cur9.nextSibling;if(next==end)break;var view=ContentView.get(_cur9),nextView=ContentView.get(next);if(view&&nextView?view.breakAfter:(view?view.breakAfter:isBlockElement(_cur9))||isBlockElement(next)&&(_cur9.nodeName!="BR"||_cur9.cmIgnore))this.lineBreak();_cur9=next;}this.findPointBefore(parent,end);return this;}},{key:"readTextNode",value:function readTextNode(node){var text=node.nodeValue;var _iterator43=_createForOfIteratorHelper(this.points),_step43;try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var _point=_step43.value;if(_point.node==node)_point.pos=this.text.length+Math.min(_point.offset,text.length);}}catch(err){_iterator43.e(err);}finally{_iterator43.f();}for(var off=0,re=this.lineSeparator?null:/\r\n?|\n/g;;){var nextBreak=-1,breakSize=1,m=void 0;if(this.lineSeparator){nextBreak=text.indexOf(this.lineSeparator,off);breakSize=this.lineSeparator.length;}else if(m=re.exec(text)){nextBreak=m.index;breakSize=m[0].length;}this.append(text.slice(off,nextBreak<0?text.length:nextBreak));if(nextBreak<0)break;this.lineBreak();if(breakSize>1){var _iterator44=_createForOfIteratorHelper(this.points),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var point=_step44.value;if(point.node==node&&point.pos>this.text.length)point.pos-=breakSize-1;}}catch(err){_iterator44.e(err);}finally{_iterator44.f();}}off=nextBreak+breakSize;}}},{key:"readNode",value:function readNode(node){if(node.cmIgnore)return;var view=ContentView.get(node);var fromView=view&&view.overrideDOMText;if(fromView!=null){this.findPointInside(node,fromView.length);for(var _i126=fromView.iter();!_i126.next().done;){if(_i126.lineBreak)this.lineBreak();else this.append(_i126.value);}}else if(node.nodeType==3){this.readTextNode(node);}else if(node.nodeName=="BR"){if(node.nextSibling)this.lineBreak();}else if(node.nodeType==1){this.readRange(node.firstChild,null);}}},{key:"findPointBefore",value:function findPointBefore(node,next){var _iterator45=_createForOfIteratorHelper(this.points),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var point=_step45.value;if(point.node==node&&node.childNodes[point.offset]==next)point.pos=this.text.length;}}catch(err){_iterator45.e(err);}finally{_iterator45.f();}}},{key:"findPointInside",value:function findPointInside(node,maxLen){var _iterator46=_createForOfIteratorHelper(this.points),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var point=_step46.value;if(node.nodeType==3?point.node==node:node.contains(point.node))point.pos=this.text.length+Math.min(maxLen,point.offset);}}catch(err){_iterator46.e(err);}finally{_iterator46.f();}}}]);return DOMReader;}();function isBlockElement(node){return node.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(node.nodeName);}var DOMPoint=/*#__PURE__*/_createClass(function DOMPoint(node,offset){_classCallCheck(this,DOMPoint);this.node=node;this.offset=offset;this.pos=-1;});var DocView=/*#__PURE__*/function(_ContentView7){_inherits(DocView,_ContentView7);var _super30=_createSuper(DocView);function DocView(view){var _this32;_classCallCheck(this,DocView);_this32=_super30.call(this);_this32.view=view;_this32.compositionDeco=Decoration.none;_this32.decorations=[];_this32.dynamicDecorationMap=[];// Track a minimum width for the editor. When measuring sizes in
// measureVisibleLineHeights, this is updated to point at the width
// of a given element and its extent in the document. When a change
// happens in that range, these are reset. That way, once we've seen
// a line/element of a given length, we keep the editor wide enough
// to fit at least that element, until it is changed, at which point
// we forget it again.
_this32.minWidth=0;_this32.minWidthFrom=0;_this32.minWidthTo=0;// Track whether the DOM selection was set in a lossy way, so that
// we don't mess it up when reading it back it
_this32.impreciseAnchor=null;_this32.impreciseHead=null;_this32.forceSelection=false;// Used by the resize observer to ignore resizes that we caused
// ourselves
_this32.lastUpdate=Date.now();_this32.setDOM(view.contentDOM);_this32.children=[new LineView()];_this32.children[0].setParent(_assertThisInitialized(_this32));_this32.updateDeco();_this32.updateInner([new ChangedRange(0,0,0,view.state.doc.length)],0);return _this32;}_createClass(DocView,[{key:"editorView",get:function get(){return this.view;}},{key:"length",get:function get(){return this.view.state.doc.length;}// Update the document view to a given state. scrollIntoView can be
// used as a hint to compute a new viewport that includes that
// position, if we know the editor is going to scroll that position
// into view.
},{key:"update",value:function update(_update2){var _this33=this;var changedRanges=_update2.changedRanges;if(this.minWidth>0&&changedRanges.length){if(!changedRanges.every(function(_ref39){var fromA=_ref39.fromA,toA=_ref39.toA;return toA<_this33.minWidthFrom||fromA>_this33.minWidthTo;})){this.minWidth=this.minWidthFrom=this.minWidthTo=0;}else{this.minWidthFrom=_update2.changes.mapPos(this.minWidthFrom,1);this.minWidthTo=_update2.changes.mapPos(this.minWidthTo,1);}}if(this.view.inputState.composing<0)this.compositionDeco=Decoration.none;else if(_update2.transactions.length||this.dirty)this.compositionDeco=computeCompositionDeco(this.view,_update2.changes);// When the DOM nodes around the selection are moved to another
// parent, Chrome sometimes reports a different selection through
// getSelection than the one that it actually shows to the user.
// This forces a selection update when lines are joined to work
// around that. Issue #54
if((browser.ie||browser.chrome)&&!this.compositionDeco.size&&_update2&&_update2.state.doc.lines!=_update2.startState.doc.lines)this.forceSelection=true;var prevDeco=this.decorations,deco=this.updateDeco();var decoDiff=findChangedDeco(prevDeco,deco,_update2.changes);changedRanges=ChangedRange.extendWithRanges(changedRanges,decoDiff);if(this.dirty==0/* Dirty.Not */&&changedRanges.length==0){return false;}else{this.updateInner(changedRanges,_update2.startState.doc.length);if(_update2.transactions.length)this.lastUpdate=Date.now();return true;}}// Used by update and the constructor do perform the actual DOM
// update
},{key:"updateInner",value:function updateInner(changes,oldLength){var _this34=this;this.view.viewState.mustMeasureContent=true;this.updateChildren(changes,oldLength);var observer=this.view.observer;observer.ignore(function(){// Lock the height during redrawing, since Chrome sometimes
// messes with the scroll position during DOM mutation (though
// no relayout is triggered and I cannot imagine how it can
// recompute the scroll position without a layout)
_this34.dom.style.height=_this34.view.viewState.contentHeight+"px";_this34.dom.style.flexBasis=_this34.minWidth?_this34.minWidth+"px":"";// Chrome will sometimes, when DOM mutations occur directly
// around the selection, get confused and report a different
// selection from the one it displays (issue #218). This tries
// to detect that situation.
var track=browser.chrome||browser.ios?{node:observer.selectionRange.focusNode,written:false}:undefined;_this34.sync(track);_this34.dirty=0/* Dirty.Not */;if(track&&(track.written||observer.selectionRange.focusNode!=track.node))_this34.forceSelection=true;_this34.dom.style.height="";});var gaps=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){var _iterator47=_createForOfIteratorHelper(this.children),_step47;try{for(_iterator47.s();!(_step47=_iterator47.n()).done;){var child=_step47.value;if(child instanceof BlockWidgetView&&child.widget instanceof BlockGapWidget)gaps.push(child.dom);}}catch(err){_iterator47.e(err);}finally{_iterator47.f();}}observer.updateGaps(gaps);}},{key:"updateChildren",value:function updateChildren(changes,oldLength){var cursor=this.childCursor(oldLength);for(var _i127=changes.length-1;;_i127--){var next=_i127>=0?changes[_i127]:null;if(!next)break;var fromA=next.fromA,toA=next.toA,fromB=next.fromB,toB=next.toB;var _ContentBuilder$build=ContentBuilder.build(this.view.state.doc,fromB,toB,this.decorations,this.dynamicDecorationMap),_content3=_ContentBuilder$build.content,breakAtStart=_ContentBuilder$build.breakAtStart,openStart=_ContentBuilder$build.openStart,openEnd=_ContentBuilder$build.openEnd;var _cursor$findPos=cursor.findPos(toA,1),toI=_cursor$findPos.i,toOff=_cursor$findPos.off;var _cursor$findPos2=cursor.findPos(fromA,-1),fromI=_cursor$findPos2.i,fromOff=_cursor$findPos2.off;replaceRange(this,fromI,fromOff,toI,toOff,_content3,breakAtStart,openStart,openEnd);}}// Sync the DOM selection to this.state.selection
},{key:"updateSelection",value:function updateSelection(){var _this35=this;var mustRead=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var fromPointer=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(mustRead||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();if(!(fromPointer||this.mayControlSelection()))return;var force=this.forceSelection;this.forceSelection=false;var main=this.view.state.selection.main;// FIXME need to handle the case where the selection falls inside a block range
var anchor=this.domAtPos(main.anchor);var head=main.empty?anchor:this.domAtPos(main.head);// Always reset on Firefox when next to an uneditable node to
// avoid invisible cursor bugs (#111)
if(browser.gecko&&main.empty&&betweenUneditable(anchor)){var dummy=document.createTextNode("");this.view.observer.ignore(function(){return anchor.node.insertBefore(dummy,anchor.node.childNodes[anchor.offset]||null);});anchor=head=new DOMPos(dummy,0);force=true;}var domSel=this.view.observer.selectionRange;// If the selection is already here, or in an equivalent position, don't touch it
if(force||!domSel.focusNode||!isEquivalentPosition(anchor.node,anchor.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(head.node,head.offset,domSel.focusNode,domSel.focusOffset)){this.view.observer.ignore(function(){// Chrome Android will hide the virtual keyboard when tapping
// inside an uneditable node, and not bring it back when we
// move the cursor to its proper position. This tries to
// restore the keyboard by cycling focus.
if(browser.android&&browser.chrome&&_this35.dom.contains(domSel.focusNode)&&inUneditable(domSel.focusNode,_this35.dom)){_this35.dom.blur();_this35.dom.focus({preventScroll:true});}var rawSel=getSelection(_this35.view.root);if(!rawSel);else if(main.empty){// Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1612076
if(browser.gecko){var nextTo=nextToUneditable(anchor.node,anchor.offset);if(nextTo&&nextTo!=(1/* NextTo.Before */|2/* NextTo.After */)){var _text3=nearbyTextNode(anchor.node,anchor.offset,nextTo==1/* NextTo.Before */?1:-1);if(_text3)anchor=new DOMPos(_text3,nextTo==1/* NextTo.Before */?0:_text3.nodeValue.length);}}rawSel.collapse(anchor.node,anchor.offset);if(main.bidiLevel!=null&&domSel.cursorBidiLevel!=null)domSel.cursorBidiLevel=main.bidiLevel;}else if(rawSel.extend){// Selection.extend can be used to create an 'inverted' selection
// (one where the focus is before the anchor), but not all
// browsers support it yet.
rawSel.collapse(anchor.node,anchor.offset);// Safari will ignore the call above when the editor is
// hidden, and then raise an error on the call to extend
// (#940).
try{rawSel.extend(head.node,head.offset);}catch(_){}}else{// Primitive (IE) way
var _range7=document.createRange();if(main.anchor>main.head){var _ref40=[head,anchor];anchor=_ref40[0];head=_ref40[1];}_range7.setEnd(head.node,head.offset);_range7.setStart(anchor.node,anchor.offset);rawSel.removeAllRanges();rawSel.addRange(_range7);}});this.view.observer.setSelectionRange(anchor,head);}this.impreciseAnchor=anchor.precise?null:new DOMPos(domSel.anchorNode,domSel.anchorOffset);this.impreciseHead=head.precise?null:new DOMPos(domSel.focusNode,domSel.focusOffset);}},{key:"enforceCursorAssoc",value:function enforceCursorAssoc(){if(this.compositionDeco.size)return;var cursor=this.view.state.selection.main;var sel=getSelection(this.view.root);if(!sel||!cursor.empty||!cursor.assoc||!sel.modify)return;var line=LineView.find(this,cursor.head);if(!line)return;var lineStart=line.posAtStart;if(cursor.head==lineStart||cursor.head==lineStart+line.length)return;var before=this.coordsAt(cursor.head,-1),after=this.coordsAt(cursor.head,1);if(!before||!after||before.bottom>after.top)return;var dom=this.domAtPos(cursor.head+cursor.assoc);sel.collapse(dom.node,dom.offset);sel.modify("move",cursor.assoc<0?"forward":"backward","lineboundary");}},{key:"mayControlSelection",value:function mayControlSelection(){var active=this.view.root.activeElement;return active==this.dom||hasSelection(this.dom,this.view.observer.selectionRange)&&!(active&&this.dom.contains(active));}},{key:"nearest",value:function nearest(dom){for(var _cur10=dom;_cur10;){var domView=ContentView.get(_cur10);if(domView&&domView.rootView==this)return domView;_cur10=_cur10.parentNode;}return null;}},{key:"posFromDOM",value:function posFromDOM(node,offset){var view=this.nearest(node);if(!view)throw new RangeError("Trying to find position for a DOM position outside of the document");return view.localPosFromDOM(node,offset)+view.posAtStart;}},{key:"domAtPos",value:function domAtPos(pos){var _this$childCursor$fin=this.childCursor().findPos(pos,-1),i=_this$childCursor$fin.i,off=_this$childCursor$fin.off;for(;i<this.children.length-1;){var child=this.children[i];if(off<child.length||child instanceof LineView)break;i++;off=0;}return this.children[i].domAtPos(off);}},{key:"coordsAt",value:function coordsAt(pos,side){for(var off=this.length,_i128=this.children.length-1;;_i128--){var child=this.children[_i128],start=off-child.breakAfter-child.length;if(pos>start||pos==start&&child.type!=BlockType.WidgetBefore&&child.type!=BlockType.WidgetAfter&&(!_i128||side==2||this.children[_i128-1].breakAfter||this.children[_i128-1].type==BlockType.WidgetBefore&&side>-2))return child.coordsAt(pos-start,side);off=start;}}},{key:"measureVisibleLineHeights",value:function measureVisibleLineHeights(viewport){var result=[],from=viewport.from,to=viewport.to;var contentWidth=this.view.contentDOM.clientWidth;var isWider=contentWidth>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;var widest=-1,ltr=this.view.textDirection==Direction.LTR;for(var pos=0,_i129=0;_i129<this.children.length;_i129++){var child=this.children[_i129],end=pos+child.length;if(end>to)break;if(pos>=from){var childRect=child.dom.getBoundingClientRect();result.push(childRect.height);if(isWider){var _last4=child.dom.lastChild;var rects=_last4?clientRectsFor(_last4):[];if(rects.length){var rect=rects[rects.length-1];var width=ltr?rect.right-childRect.left:childRect.right-rect.left;if(width>widest){widest=width;this.minWidth=contentWidth;this.minWidthFrom=pos;this.minWidthTo=end;}}}}pos=end+child.breakAfter;}return result;}},{key:"textDirectionAt",value:function textDirectionAt(pos){var _this$childPos2=this.childPos(pos,1),i=_this$childPos2.i;return getComputedStyle(this.children[i].dom).direction=="rtl"?Direction.RTL:Direction.LTR;}},{key:"measureTextSize",value:function measureTextSize(){var _this36=this;var _iterator48=_createForOfIteratorHelper(this.children),_step48;try{for(_iterator48.s();!(_step48=_iterator48.n()).done;){var child=_step48.value;if(child instanceof LineView){var _measure=child.measureTextSize();if(_measure)return _measure;}}// If no workable line exists, force a layout of a measurable element
}catch(err){_iterator48.e(err);}finally{_iterator48.f();}var dummy=document.createElement("div"),lineHeight,charWidth;dummy.className="cm-line";dummy.style.width="99999px";dummy.textContent="abc def ghi jkl mno pqr stu";this.view.observer.ignore(function(){_this36.dom.appendChild(dummy);var rect=clientRectsFor(dummy.firstChild)[0];lineHeight=dummy.getBoundingClientRect().height;charWidth=rect?rect.width/27:7;dummy.remove();});return{lineHeight:lineHeight,charWidth:charWidth};}},{key:"childCursor",value:function childCursor(){var pos=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.length;// Move back to start of last element when possible, so that
// `ChildCursor.findPos` doesn't have to deal with the edge case
// of being after the last element.
var i=this.children.length;if(i)pos-=this.children[--i].length;return new ChildCursor(this.children,pos,i);}},{key:"computeBlockGapDeco",value:function computeBlockGapDeco(){var deco=[],vs=this.view.viewState;for(var pos=0,_i130=0;;_i130++){var next=_i130==vs.viewports.length?null:vs.viewports[_i130];var end=next?next.from-1:this.length;if(end>pos){var height=vs.lineBlockAt(end).bottom-vs.lineBlockAt(pos).top;deco.push(Decoration.replace({widget:new BlockGapWidget(height),block:true,inclusive:true,isBlockGap:true}).range(pos,end));}if(!next)break;pos=next.to+1;}return Decoration.set(deco);}},{key:"updateDeco",value:function updateDeco(){var _this37=this;var allDeco=this.view.state.facet(decorations).map(function(d,i){var dynamic=_this37.dynamicDecorationMap[i]=typeof d=="function";return dynamic?d(_this37.view):d;});for(var _i131=allDeco.length;_i131<allDeco.length+3;_i131++){this.dynamicDecorationMap[_i131]=false;}return this.decorations=[].concat(_toConsumableArray2(allDeco),[this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]);}},{key:"scrollIntoView",value:function scrollIntoView(target){var _this38=this;var range=target.range;var rect=this.coordsAt(range.head,range.empty?range.assoc:range.head>range.anchor?-1:1),other;if(!rect)return;if(!range.empty&&(other=this.coordsAt(range.anchor,range.anchor>range.head?-1:1)))rect={left:Math.min(rect.left,other.left),top:Math.min(rect.top,other.top),right:Math.max(rect.right,other.right),bottom:Math.max(rect.bottom,other.bottom)};var mLeft=0,mRight=0,mTop=0,mBottom=0;var _iterator49=_createForOfIteratorHelper(this.view.state.facet(scrollMargins).map(function(f){return f(_this38.view);})),_step49;try{for(_iterator49.s();!(_step49=_iterator49.n()).done;){var margins=_step49.value;if(margins){var left=margins.left,right=margins.right,_top7=margins.top,bottom=margins.bottom;if(left!=null)mLeft=Math.max(mLeft,left);if(right!=null)mRight=Math.max(mRight,right);if(_top7!=null)mTop=Math.max(mTop,_top7);if(bottom!=null)mBottom=Math.max(mBottom,bottom);}}}catch(err){_iterator49.e(err);}finally{_iterator49.f();}var targetRect={left:rect.left-mLeft,top:rect.top-mTop,right:rect.right+mRight,bottom:rect.bottom+mBottom};scrollRectIntoView(this.view.scrollDOM,targetRect,range.head<range.anchor?-1:1,target.x,target.y,target.xMargin,target.yMargin,this.view.textDirection==Direction.LTR);}}]);return DocView;}(ContentView);function betweenUneditable(pos){return pos.node.nodeType==1&&pos.node.firstChild&&(pos.offset==0||pos.node.childNodes[pos.offset-1].contentEditable=="false")&&(pos.offset==pos.node.childNodes.length||pos.node.childNodes[pos.offset].contentEditable=="false");}var BlockGapWidget=/*#__PURE__*/function(_WidgetType2){_inherits(BlockGapWidget,_WidgetType2);var _super31=_createSuper(BlockGapWidget);function BlockGapWidget(height){var _this39;_classCallCheck(this,BlockGapWidget);_this39=_super31.call(this);_this39.height=height;return _this39;}_createClass(BlockGapWidget,[{key:"toDOM",value:function toDOM(){var elt=document.createElement("div");this.updateDOM(elt);return elt;}},{key:"eq",value:function eq(other){return other.height==this.height;}},{key:"updateDOM",value:function updateDOM(elt){elt.style.height=this.height+"px";return true;}},{key:"estimatedHeight",get:function get(){return this.height;}}]);return BlockGapWidget;}(WidgetType);function compositionSurroundingNode(view){var sel=view.observer.selectionRange;var textNode=sel.focusNode&&nearbyTextNode(sel.focusNode,sel.focusOffset,0);if(!textNode)return null;var cView=view.docView.nearest(textNode);if(!cView)return null;if(cView instanceof LineView){var topNode=textNode;while(topNode.parentNode!=cView.dom){topNode=topNode.parentNode;}var prev=topNode.previousSibling;while(prev&&!ContentView.get(prev)){prev=prev.previousSibling;}var pos=prev?ContentView.get(prev).posAtEnd:cView.posAtStart;return{from:pos,to:pos,node:topNode,text:textNode};}else{for(;;){var _cView=cView,_parent7=_cView.parent;if(!_parent7)return null;if(_parent7 instanceof LineView)break;cView=_parent7;}var from=cView.posAtStart;return{from:from,to:from+cView.length,node:cView.dom,text:textNode};}}function computeCompositionDeco(view,changes){var surrounding=compositionSurroundingNode(view);if(!surrounding)return Decoration.none;var from=surrounding.from,to=surrounding.to,node=surrounding.node,textNode=surrounding.text;var newFrom=changes.mapPos(from,1),newTo=Math.max(newFrom,changes.mapPos(to,-1));var state=view.state,text=node.nodeType==3?node.nodeValue:new DOMReader([],state).readRange(node.firstChild,null).text;if(newTo-newFrom<text.length){if(state.doc.sliceString(newFrom,Math.min(state.doc.length,newFrom+text.length),LineBreakPlaceholder)==text)newTo=newFrom+text.length;else if(state.doc.sliceString(Math.max(0,newTo-text.length),newTo,LineBreakPlaceholder)==text)newFrom=newTo-text.length;else return Decoration.none;}else if(state.doc.sliceString(newFrom,newTo,LineBreakPlaceholder)!=text){return Decoration.none;}var topView=ContentView.get(node);if(topView instanceof CompositionView)topView=topView.widget.topView;else if(topView)topView.parent=null;return Decoration.set(Decoration.replace({widget:new CompositionWidget(node,textNode,topView),inclusive:true}).range(newFrom,newTo));}var CompositionWidget=/*#__PURE__*/function(_WidgetType3){_inherits(CompositionWidget,_WidgetType3);var _super32=_createSuper(CompositionWidget);function CompositionWidget(top,text,topView){var _this40;_classCallCheck(this,CompositionWidget);_this40=_super32.call(this);_this40.top=top;_this40.text=text;_this40.topView=topView;return _this40;}_createClass(CompositionWidget,[{key:"eq",value:function eq(other){return this.top==other.top&&this.text==other.text;}},{key:"toDOM",value:function toDOM(){return this.top;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}},{key:"customView",get:function get(){return CompositionView;}}]);return CompositionWidget;}(WidgetType);function nearbyTextNode(node,offset,side){for(;;){if(node.nodeType==3)return node;if(node.nodeType==1&&offset>0&&side<=0){node=node.childNodes[offset-1];offset=maxOffset(node);}else if(node.nodeType==1&&offset<node.childNodes.length&&side>=0){node=node.childNodes[offset];offset=0;}else{return null;}}}function nextToUneditable(node,offset){if(node.nodeType!=1)return 0;return(offset&&node.childNodes[offset-1].contentEditable=="false"?1/* NextTo.Before */:0)|(offset<node.childNodes.length&&node.childNodes[offset].contentEditable=="false"?2/* NextTo.After */:0);}var DecorationComparator$1=/*#__PURE__*/function(){function DecorationComparator$1(){_classCallCheck(this,DecorationComparator$1);this.changes=[];}_createClass(DecorationComparator$1,[{key:"compareRange",value:function compareRange(from,to){addRange(from,to,this.changes);}},{key:"comparePoint",value:function comparePoint(from,to){addRange(from,to,this.changes);}}]);return DecorationComparator$1;}();function findChangedDeco(a,b,diff){var comp=new DecorationComparator$1();RangeSet.compare(a,b,diff,comp);return comp.changes;}function inUneditable(node,inside){for(var _cur11=node;_cur11&&_cur11!=inside;_cur11=_cur11.assignedSlot||_cur11.parentNode){if(_cur11.nodeType==1&&_cur11.contentEditable=='false'){return true;}}return false;}function groupAt(state,pos){var bias=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var categorize=state.charCategorizer(pos);var line=state.doc.lineAt(pos),linePos=pos-line.from;if(line.length==0)return EditorSelection.cursor(pos);if(linePos==0)bias=1;else if(linePos==line.length)bias=-1;var from=linePos,to=linePos;if(bias<0)from=findClusterBreak(line.text,linePos,false);else to=findClusterBreak(line.text,linePos);var cat=categorize(line.text.slice(from,to));while(from>0){var prev=findClusterBreak(line.text,from,false);if(categorize(line.text.slice(prev,from))!=cat)break;from=prev;}while(to<line.length){var next=findClusterBreak(line.text,to);if(categorize(line.text.slice(to,next))!=cat)break;to=next;}return EditorSelection.range(from+line.from,to+line.from);}// Search the DOM for the {node, offset} position closest to the given
// coordinates. Very inefficient and crude, but can usually be avoided
// by calling caret(Position|Range)FromPoint instead.
function getdx(x,rect){return rect.left>x?rect.left-x:Math.max(0,x-rect.right);}function getdy(y,rect){return rect.top>y?rect.top-y:Math.max(0,y-rect.bottom);}function yOverlap(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1;}function upTop(rect,top){return top<rect.top?{top:top,left:rect.left,right:rect.right,bottom:rect.bottom}:rect;}function upBot(rect,bottom){return bottom>rect.bottom?{top:rect.top,left:rect.left,right:rect.right,bottom:bottom}:rect;}function domPosAtCoords(parent,x,y){var closest,closestRect,closestX,closestY,closestOverlap=false;var above,below,aboveRect,belowRect;for(var child=parent.firstChild;child;child=child.nextSibling){var rects=clientRectsFor(child);for(var _i132=0;_i132<rects.length;_i132++){var rect=rects[_i132];if(closestRect&&yOverlap(closestRect,rect))rect=upTop(upBot(rect,closestRect.bottom),closestRect.top);var dx=getdx(x,rect),dy=getdy(y,rect);if(dx==0&&dy==0)return child.nodeType==3?domPosInText(child,x,y):domPosAtCoords(child,x,y);if(!closest||closestY>dy||closestY==dy&&closestX>dx){closest=child;closestRect=rect;closestX=dx;closestY=dy;closestOverlap=!dx||(dx>0?_i132<rects.length-1:_i132>0);}if(dx==0){if(y>rect.bottom&&(!aboveRect||aboveRect.bottom<rect.bottom)){above=child;aboveRect=rect;}else if(y<rect.top&&(!belowRect||belowRect.top>rect.top)){below=child;belowRect=rect;}}else if(aboveRect&&yOverlap(aboveRect,rect)){aboveRect=upBot(aboveRect,rect.bottom);}else if(belowRect&&yOverlap(belowRect,rect)){belowRect=upTop(belowRect,rect.top);}}}if(aboveRect&&aboveRect.bottom>=y){closest=above;closestRect=aboveRect;}else if(belowRect&&belowRect.top<=y){closest=below;closestRect=belowRect;}if(!closest)return{node:parent,offset:0};var clipX=Math.max(closestRect.left,Math.min(closestRect.right,x));if(closest.nodeType==3)return domPosInText(closest,clipX,y);if(closestOverlap&&closest.contentEditable!="false")return domPosAtCoords(closest,clipX,y);var offset=Array.prototype.indexOf.call(parent.childNodes,closest)+(x>=(closestRect.left+closestRect.right)/2?1:0);return{node:parent,offset:offset};}function domPosInText(node,x,y){var len=node.nodeValue.length;var closestOffset=-1,closestDY=1e9,generalSide=0;for(var _i133=0;_i133<len;_i133++){var rects=textRange(node,_i133,_i133+1).getClientRects();for(var j=0;j<rects.length;j++){var rect=rects[j];if(rect.top==rect.bottom)continue;if(!generalSide)generalSide=x-rect.left;var dy=(rect.top>y?rect.top-y:y-rect.bottom)-1;if(rect.left-1<=x&&rect.right+1>=x&&dy<closestDY){var right=x>=(rect.left+rect.right)/2,_after3=right;if(browser.chrome||browser.gecko){// Check for RTL on browsers that support getting client
// rects for empty ranges.
var rectBefore=textRange(node,_i133).getBoundingClientRect();if(rectBefore.left==rect.right)_after3=!right;}if(dy<=0)return{node:node,offset:_i133+(_after3?1:0)};closestOffset=_i133+(_after3?1:0);closestDY=dy;}}}return{node:node,offset:closestOffset>-1?closestOffset:generalSide>0?node.nodeValue.length:0};}function _posAtCoords(view,_ref41,precise){var x=_ref41.x,y=_ref41.y;var bias=arguments.length>3&&arguments[3]!==undefined?arguments[3]:-1;var _a;var content=view.contentDOM.getBoundingClientRect(),docTop=content.top+view.viewState.paddingTop;var block,docHeight=view.viewState.docHeight;var yOffset=y-docTop;if(yOffset<0)return 0;if(yOffset>docHeight)return view.state.doc.length;// Scan for a text block near the queried y position
for(var halfLine=view.defaultLineHeight/2,bounced=false;;){block=view.elementAtHeight(yOffset);if(block.type==BlockType.Text)break;for(;;){// Move the y position out of this block
yOffset=bias>0?block.bottom+halfLine:block.top-halfLine;if(yOffset>=0&&yOffset<=docHeight)break;// If the document consists entirely of replaced widgets, we
// won't find a text block, so return 0
if(bounced)return precise?null:0;bounced=true;bias=-bias;}}y=docTop+yOffset;var lineStart=block.from;// If this is outside of the rendered viewport, we can't determine a position
if(lineStart<view.viewport.from)return view.viewport.from==0?0:precise?null:posAtCoordsImprecise(view,content,block,x,y);if(lineStart>view.viewport.to)return view.viewport.to==view.state.doc.length?view.state.doc.length:precise?null:posAtCoordsImprecise(view,content,block,x,y);// Prefer ShadowRootOrDocument.elementFromPoint if present, fall back to document if not
var doc=view.dom.ownerDocument;var root=view.root.elementFromPoint?view.root:doc;var element=root.elementFromPoint(x,y);if(element&&!view.contentDOM.contains(element))element=null;// If the element is unexpected, clip x at the sides of the content area and try again
if(!element){x=Math.max(content.left+1,Math.min(content.right-1,x));element=root.elementFromPoint(x,y);if(element&&!view.contentDOM.contains(element))element=null;}// There's visible editor content under the point, so we can try
// using caret(Position|Range)FromPoint as a shortcut
var node,offset=-1;if(element&&((_a=view.docView.nearest(element))===null||_a===void 0?void 0:_a.isEditable)!=false){if(doc.caretPositionFromPoint){var pos=doc.caretPositionFromPoint(x,y);if(pos){node=pos.offsetNode;offset=pos.offset;}}else if(doc.caretRangeFromPoint){var _range8=doc.caretRangeFromPoint(x,y);if(_range8){node=_range8.startContainer;offset=_range8.startOffset;if(!view.contentDOM.contains(node)||browser.safari&&isSuspiciousSafariCaretResult(node,offset,x)||browser.chrome&&isSuspiciousChromeCaretResult(node,offset,x))node=undefined;}}}// No luck, do our own (potentially expensive) search
if(!node||!view.docView.dom.contains(node)){var line=LineView.find(view.docView,lineStart);if(!line)return yOffset>block.top+block.height/2?block.to:block.from;var _domPosAtCoords=domPosAtCoords(line.dom,x,y);node=_domPosAtCoords.node;offset=_domPosAtCoords.offset;}return view.docView.posFromDOM(node,offset);}function posAtCoordsImprecise(view,contentRect,block,x,y){var into=Math.round((x-contentRect.left)*view.defaultCharacterWidth);if(view.lineWrapping&&block.height>view.defaultLineHeight*1.5){var line=Math.floor((y-block.top)/view.defaultLineHeight);into+=line*view.viewState.heightOracle.lineLength;}var content=view.state.sliceDoc(block.from,block.to);return block.from+findColumn(content,into,view.state.tabSize);}// In case of a high line height, Safari's caretRangeFromPoint treats
// the space between lines as belonging to the last character of the
// line before. This is used to detect such a result so that it can be
// ignored (issue #401).
function isSuspiciousSafariCaretResult(node,offset,x){var len;if(node.nodeType!=3||offset!=(len=node.nodeValue.length))return false;for(var next=node.nextSibling;next;next=next.nextSibling){if(next.nodeType!=1||next.nodeName!="BR")return false;}return textRange(node,len-1,len).getBoundingClientRect().left>x;}// Chrome will move positions between lines to the start of the next line
function isSuspiciousChromeCaretResult(node,offset,x){if(offset!=0)return false;for(var _cur12=node;;){var _parent8=_cur12.parentNode;if(!_parent8||_parent8.nodeType!=1||_parent8.firstChild!=_cur12)return false;if(_parent8.classList.contains("cm-line"))break;_cur12=_parent8;}var rect=node.nodeType==1?node.getBoundingClientRect():textRange(node,0,Math.max(node.nodeValue.length,1)).getBoundingClientRect();return x-rect.left>5;}function _moveToLineBoundary(view,start,forward,includeWrap){var line=view.state.doc.lineAt(start.head);var coords=!includeWrap||!view.lineWrapping?null:view.coordsAtPos(start.assoc<0&&start.head>line.from?start.head-1:start.head);if(coords){var editorRect=view.dom.getBoundingClientRect();var direction=view.textDirectionAt(line.from);var pos=view.posAtCoords({x:forward==(direction==Direction.LTR)?editorRect.right-1:editorRect.left+1,y:(coords.top+coords.bottom)/2});if(pos!=null)return EditorSelection.cursor(pos,forward?-1:1);}var lineView=LineView.find(view.docView,start.head);var end=lineView?forward?lineView.posAtEnd:lineView.posAtStart:forward?line.to:line.from;return EditorSelection.cursor(end,forward?-1:1);}function _moveByChar(view,start,forward,by){var line=view.state.doc.lineAt(start.head),spans=view.bidiSpans(line);var direction=view.textDirectionAt(line.from);for(var _cur13=start,check=null;;){var next=moveVisually(line,spans,direction,_cur13,forward),_char10=movedOver;if(!next){if(line.number==(forward?view.state.doc.lines:1))return _cur13;_char10="\n";line=view.state.doc.line(line.number+(forward?1:-1));spans=view.bidiSpans(line);next=EditorSelection.cursor(forward?line.from:line.to);}if(!check){if(!by)return next;check=by(_char10);}else if(!check(_char10)){return _cur13;}_cur13=next;}}function byGroup(view,pos,start){var categorize=view.state.charCategorizer(pos);var cat=categorize(start);return function(next){var nextCat=categorize(next);if(cat==CharCategory.Space)cat=nextCat;return cat==nextCat;};}function _moveVertically(view,start,forward,distance){var startPos=start.head,dir=forward?1:-1;if(startPos==(forward?view.state.doc.length:0))return EditorSelection.cursor(startPos,start.assoc);var goal=start.goalColumn,startY;var rect=view.contentDOM.getBoundingClientRect();var startCoords=view.coordsAtPos(startPos),docTop=view.documentTop;if(startCoords){if(goal==null)goal=startCoords.left-rect.left;startY=dir<0?startCoords.top:startCoords.bottom;}else{var line=view.viewState.lineBlockAt(startPos);if(goal==null)goal=Math.min(rect.right-rect.left,view.defaultCharacterWidth*(startPos-line.from));startY=(dir<0?line.top:line.bottom)+docTop;}var resolvedGoal=rect.left+goal;var dist=distance!==null&&distance!==void 0?distance:view.defaultLineHeight>>1;for(var extra=0;;extra+=10){var curY=startY+(dist+extra)*dir;var pos=_posAtCoords(view,{x:resolvedGoal,y:curY},false,dir);if(curY<rect.top||curY>rect.bottom||(dir<0?pos<startPos:pos>startPos))return EditorSelection.cursor(pos,start.assoc,undefined,goal);}}function skipAtoms(view,oldPos,pos){var atoms=view.state.facet(atomicRanges).map(function(f){return f(view);});for(;;){var moved=false;var _iterator50=_createForOfIteratorHelper(atoms),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var _set3=_step50.value;_set3.between(pos.from-1,pos.from+1,function(from,to,value){if(pos.from>from&&pos.from<to){pos=oldPos.head>pos.from?EditorSelection.cursor(from,1):EditorSelection.cursor(to,-1);moved=true;}});}}catch(err){_iterator50.e(err);}finally{_iterator50.f();}if(!moved)return pos;}}// This will also be where dragging info and such goes
var InputState=/*#__PURE__*/function(){function InputState(view){var _this41=this;_classCallCheck(this,InputState);this.lastKeyCode=0;this.lastKeyTime=0;this.lastTouchTime=0;this.lastFocusTime=0;this.lastScrollTop=0;this.lastScrollLeft=0;this.chromeScrollHack=-1;// On iOS, some keys need to have their default behavior happen
// (after which we retroactively handle them and reset the DOM) to
// avoid messing up the virtual keyboard state.
this.pendingIOSKey=undefined;this.lastSelectionOrigin=null;this.lastSelectionTime=0;this.lastEscPress=0;this.lastContextMenu=0;this.scrollHandlers=[];this.registeredEvents=[];this.customHandlers=[];// -1 means not in a composition. Otherwise, this counts the number
// of changes made during the composition. The count is used to
// avoid treating the start state of the composition, before any
// changes have been made, as part of the composition.
this.composing=-1;// Tracks whether the next change should be marked as starting the
// composition (null means no composition, true means next is the
// first, false means first has already been marked for this
// composition)
this.compositionFirstChange=null;this.compositionEndedAt=0;this.mouseSelection=null;var _loop4=function _loop4(type){var handler=handlers[type];view.contentDOM.addEventListener(type,function(event){if(!eventBelongsToEditor(view,event)||_this41.ignoreDuringComposition(event))return;if(type=="keydown"&&_this41.keydown(view,event))return;if(_this41.mustFlushObserver(event))view.observer.forceFlush();if(_this41.runCustomHandlers(type,view,event))event.preventDefault();else handler(view,event);},handlerOptions[type]);_this41.registeredEvents.push(type);};for(var type in handlers){_loop4(type);}if(browser.chrome&&browser.chrome_version==102){// FIXME remove at some point
// On Chrome 102, viewport updates somehow stop wheel-based
// scrolling. Turning off pointer events during the scroll seems
// to avoid the issue.
view.scrollDOM.addEventListener("wheel",function(){if(_this41.chromeScrollHack<0)view.contentDOM.style.pointerEvents="none";else window.clearTimeout(_this41.chromeScrollHack);_this41.chromeScrollHack=setTimeout(function(){_this41.chromeScrollHack=-1;view.contentDOM.style.pointerEvents="";},100);},{passive:true});}this.notifiedFocused=view.hasFocus;// On Safari adding an input event handler somehow prevents an
// issue where the composition vanishes when you press enter.
if(browser.safari)view.contentDOM.addEventListener("input",function(){return null;});}_createClass(InputState,[{key:"setSelectionOrigin",value:function setSelectionOrigin(origin){this.lastSelectionOrigin=origin;this.lastSelectionTime=Date.now();}},{key:"ensureHandlers",value:function ensureHandlers(view,plugins){var _this42=this;var _a;var handlers;this.customHandlers=[];var _iterator51=_createForOfIteratorHelper(plugins),_step51;try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var plugin=_step51.value;if(handlers=(_a=plugin.update(view).spec)===null||_a===void 0?void 0:_a.domEventHandlers){this.customHandlers.push({plugin:plugin.value,handlers:handlers});var _loop5=function _loop5(type){if(_this42.registeredEvents.indexOf(type)<0&&type!="scroll"){_this42.registeredEvents.push(type);view.contentDOM.addEventListener(type,function(event){if(!eventBelongsToEditor(view,event))return;if(_this42.runCustomHandlers(type,view,event))event.preventDefault();});}};for(var type in handlers){_loop5(type);}}}}catch(err){_iterator51.e(err);}finally{_iterator51.f();}}},{key:"runCustomHandlers",value:function runCustomHandlers(type,view,event){var _iterator52=_createForOfIteratorHelper(this.customHandlers),_step52;try{for(_iterator52.s();!(_step52=_iterator52.n()).done;){var _set4=_step52.value;var handler=_set4.handlers[type];if(handler){try{if(handler.call(_set4.plugin,event,view)||event.defaultPrevented)return true;}catch(e){logException(view.state,e);}}}}catch(err){_iterator52.e(err);}finally{_iterator52.f();}return false;}},{key:"runScrollHandlers",value:function runScrollHandlers(view,event){this.lastScrollTop=view.scrollDOM.scrollTop;this.lastScrollLeft=view.scrollDOM.scrollLeft;var _iterator53=_createForOfIteratorHelper(this.customHandlers),_step53;try{for(_iterator53.s();!(_step53=_iterator53.n()).done;){var _set5=_step53.value;var handler=_set5.handlers.scroll;if(handler){try{handler.call(_set5.plugin,event,view);}catch(e){logException(view.state,e);}}}}catch(err){_iterator53.e(err);}finally{_iterator53.f();}}},{key:"keydown",value:function keydown(view,event){var _this43=this;// Must always run, even if a custom handler handled the event
this.lastKeyCode=event.keyCode;this.lastKeyTime=Date.now();if(event.keyCode==9&&Date.now()<this.lastEscPress+2000)return true;// Chrome for Android usually doesn't fire proper key events, but
// occasionally does, usually surrounded by a bunch of complicated
// composition changes. When an enter or backspace key event is
// seen, hold off on handling DOM events for a bit, and then
// dispatch it.
if(browser.android&&browser.chrome&&!event.synthetic&&(event.keyCode==13||event.keyCode==8)){view.observer.delayAndroidKey(event.key,event.keyCode);return true;}// Prevent the default behavior of Enter on iOS makes the
// virtual keyboard get stuck in the wrong (lowercase)
// state. So we let it go through, and then, in
// applyDOMChange, notify key handlers of it and reset to
// the state they produce.
var pending;if(browser.ios&&!event.synthetic&&!event.altKey&&!event.metaKey&&((pending=PendingKeys.find(function(key){return key.keyCode==event.keyCode;}))&&!event.ctrlKey||EmacsyPendingKeys.indexOf(event.key)>-1&&event.ctrlKey&&!event.shiftKey)){this.pendingIOSKey=pending||event;setTimeout(function(){return _this43.flushIOSKey(view);},250);return true;}return false;}},{key:"flushIOSKey",value:function flushIOSKey(view){var key=this.pendingIOSKey;if(!key)return false;this.pendingIOSKey=undefined;return dispatchKey(view.contentDOM,key.key,key.keyCode);}},{key:"ignoreDuringComposition",value:function ignoreDuringComposition(event){if(!/^key/.test(event.type))return false;if(this.composing>0)return true;// See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.
// On some input method editors (IMEs), the Enter key is used to
// confirm character selection. On Safari, when Enter is pressed,
// compositionend and keydown events are sometimes emitted in the
// wrong order. The key event should still be ignored, even when
// it happens after the compositionend event.
if(browser.safari&&!browser.ios&&Date.now()-this.compositionEndedAt<100){this.compositionEndedAt=0;return true;}return false;}},{key:"mustFlushObserver",value:function mustFlushObserver(event){return event.type=="keydown"&&event.keyCode!=229;}},{key:"startMouseSelection",value:function startMouseSelection(mouseSelection){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=mouseSelection;}},{key:"update",value:function update(_update3){if(this.mouseSelection)this.mouseSelection.update(_update3);if(_update3.transactions.length)this.lastKeyCode=this.lastSelectionTime=0;}},{key:"destroy",value:function destroy(){if(this.mouseSelection)this.mouseSelection.destroy();}}]);return InputState;}();var PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}];var EmacsyPendingKeys="dthko";// Key codes for modifier keys
var modifierCodes=[16,17,18,20,91,92,224,225];var MouseSelection=/*#__PURE__*/function(){function MouseSelection(view,startEvent,style,mustSelect){_classCallCheck(this,MouseSelection);this.view=view;this.style=style;this.mustSelect=mustSelect;this.lastEvent=startEvent;var doc=view.contentDOM.ownerDocument;doc.addEventListener("mousemove",this.move=this.move.bind(this));doc.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=startEvent.shiftKey;this.multiple=view.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(view,startEvent);this.dragMove=dragMovesSelection(view,startEvent);this.dragging=isInPrimarySelection(view,startEvent)&&getClickType(startEvent)==1?null:false;// When clicking outside of the selection, immediately apply the
// effect of starting the selection
if(this.dragging===false){startEvent.preventDefault();this.select(startEvent);}}_createClass(MouseSelection,[{key:"move",value:function move(event){if(event.buttons==0)return this.destroy();if(this.dragging!==false)return;this.select(this.lastEvent=event);}},{key:"up",value:function up(event){if(this.dragging==null)this.select(this.lastEvent);if(!this.dragging)event.preventDefault();this.destroy();}},{key:"destroy",value:function destroy(){var doc=this.view.contentDOM.ownerDocument;doc.removeEventListener("mousemove",this.move);doc.removeEventListener("mouseup",this.up);this.view.inputState.mouseSelection=null;}},{key:"select",value:function select(event){var selection=this.style.get(event,this.extend,this.multiple);if(this.mustSelect||!selection.eq(this.view.state.selection)||selection.main.assoc!=this.view.state.selection.main.assoc)this.view.dispatch({selection:selection,userEvent:"select.pointer",scrollIntoView:true});this.mustSelect=false;}},{key:"update",value:function update(_update4){var _this44=this;if(_update4.docChanged&&this.dragging)this.dragging=this.dragging.map(_update4.changes);if(this.style.update(_update4))setTimeout(function(){return _this44.select(_this44.lastEvent);},20);}}]);return MouseSelection;}();function addsSelectionRange(view,event){var facet=view.state.facet(clickAddsSelectionRange);return facet.length?facet[0](event):browser.mac?event.metaKey:event.ctrlKey;}function dragMovesSelection(view,event){var facet=view.state.facet(dragMovesSelection$1);return facet.length?facet[0](event):browser.mac?!event.altKey:!event.ctrlKey;}function isInPrimarySelection(view,event){var main=view.state.selection.main;if(main.empty)return false;// On boundary clicks, check whether the coordinates are inside the
// selection's client rectangles
var sel=getSelection(view.root);if(!sel||sel.rangeCount==0)return true;var rects=sel.getRangeAt(0).getClientRects();for(var _i134=0;_i134<rects.length;_i134++){var rect=rects[_i134];if(rect.left<=event.clientX&&rect.right>=event.clientX&&rect.top<=event.clientY&&rect.bottom>=event.clientY)return true;}return false;}function eventBelongsToEditor(view,event){if(!event.bubbles)return true;if(event.defaultPrevented)return false;for(var node=event.target,cView;node!=view.contentDOM;node=node.parentNode){if(!node||node.nodeType==11||(cView=ContentView.get(node))&&cView.ignoreEvent(event))return false;}return true;}var handlers=/*@__PURE__*/Object.create(null);var handlerOptions=/*@__PURE__*/Object.create(null);// This is very crude, but unfortunately both these browsers _pretend_
// that they have a clipboard APIall the objects and methods are
// there, they just don't work, and they are hard to test.
var brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(view){var parent=view.dom.parentNode;if(!parent)return;var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.focus();setTimeout(function(){view.focus();target.remove();doPaste(view,target.value);},50);}function doPaste(view,input){var state=view.state,changes,i=1,text=state.toText(input);var byLine=text.lines==state.selection.ranges.length;var linewise=lastLinewiseCopy!=null&&state.selection.ranges.every(function(r){return r.empty;})&&lastLinewiseCopy==text.toString();if(linewise){var lastLine=-1;changes=state.changeByRange(function(range){var line=state.doc.lineAt(range.from);if(line.from==lastLine)return{range:range};lastLine=line.from;var insert=state.toText((byLine?text.line(i++).text:input)+state.lineBreak);return{changes:{from:line.from,insert:insert},range:EditorSelection.cursor(range.from+insert.length)};});}else if(byLine){changes=state.changeByRange(function(range){var line=text.line(i++);return{changes:{from:range.from,to:range.to,insert:line.text},range:EditorSelection.cursor(range.from+line.length)};});}else{changes=state.replaceSelection(text);}view.dispatch(changes,{userEvent:"input.paste",scrollIntoView:true});}handlers.keydown=function(view,event){view.inputState.setSelectionOrigin("select");if(event.keyCode==27)view.inputState.lastEscPress=Date.now();else if(modifierCodes.indexOf(event.keyCode)<0)view.inputState.lastEscPress=0;};handlers.touchstart=function(view,e){view.inputState.lastTouchTime=Date.now();view.inputState.setSelectionOrigin("select.pointer");};handlers.touchmove=function(view){view.inputState.setSelectionOrigin("select.pointer");};handlerOptions.touchstart=handlerOptions.touchmove={passive:true};handlers.mousedown=function(view,event){view.observer.flush();if(view.inputState.lastTouchTime>Date.now()-2000)return;// Ignore touch interaction
var style=null;var _iterator54=_createForOfIteratorHelper(view.state.facet(mouseSelectionStyle)),_step54;try{for(_iterator54.s();!(_step54=_iterator54.n()).done;){var makeStyle=_step54.value;style=makeStyle(view,event);if(style)break;}}catch(err){_iterator54.e(err);}finally{_iterator54.f();}if(!style&&event.button==0)style=basicMouseSelection(view,event);if(style){var mustFocus=view.root.activeElement!=view.contentDOM;if(mustFocus)view.observer.ignore(function(){return focusPreventScroll(view.contentDOM);});view.inputState.startMouseSelection(new MouseSelection(view,event,style,mustFocus));}};function rangeForClick(view,pos,bias,type){if(type==1){// Single click
return EditorSelection.cursor(pos,bias);}else if(type==2){// Double click
return groupAt(view.state,pos,bias);}else{// Triple click
var visual=LineView.find(view.docView,pos),line=view.state.doc.lineAt(visual?visual.posAtEnd:pos);var from=visual?visual.posAtStart:line.from,to=visual?visual.posAtEnd:line.to;if(to<view.state.doc.length&&to==line.to)to++;return EditorSelection.range(from,to);}}var insideY=function insideY(y,rect){return y>=rect.top&&y<=rect.bottom;};var inside=function inside(x,y,rect){return insideY(y,rect)&&x>=rect.left&&x<=rect.right;};// Try to determine, for the given coordinates, associated with the
// given position, whether they are related to the element before or
// the element after the position.
function findPositionSide(view,pos,x,y){var line=LineView.find(view.docView,pos);if(!line)return 1;var off=pos-line.posAtStart;// Line boundaries point into the line
if(off==0)return 1;if(off==line.length)return-1;// Positions on top of an element point at that element
var before=line.coordsAt(off,-1);if(before&&inside(x,y,before))return-1;var after=line.coordsAt(off,1);if(after&&inside(x,y,after))return 1;// This is probably a line wrap point. Pick before if the point is
// beside it.
return before&&insideY(y,before)?-1:1;}function queryPos(view,event){var pos=view.posAtCoords({x:event.clientX,y:event.clientY},false);return{pos:pos,bias:findPositionSide(view,pos,event.clientX,event.clientY)};}var BadMouseDetail=browser.ie&&browser.ie_version<=11;var lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(event){if(!BadMouseDetail)return event.detail;var last=lastMouseDown,lastTime=lastMouseDownTime;lastMouseDown=event;lastMouseDownTime=Date.now();return lastMouseDownCount=!last||lastTime>Date.now()-400&&Math.abs(last.clientX-event.clientX)<2&&Math.abs(last.clientY-event.clientY)<2?(lastMouseDownCount+1)%3:1;}function basicMouseSelection(view,event){var start=queryPos(view,event),type=getClickType(event);var startSel=view.state.selection;var last=start,lastEvent=event;return{update:function update(_update5){if(_update5.docChanged){start.pos=_update5.changes.mapPos(start.pos);startSel=startSel.map(_update5.changes);lastEvent=null;}},get:function get(event,extend,multiple){var cur;if(lastEvent&&event.clientX==lastEvent.clientX&&event.clientY==lastEvent.clientY)cur=last;else{cur=last=queryPos(view,event);lastEvent=event;}var range=rangeForClick(view,cur.pos,cur.bias,type);if(start.pos!=cur.pos&&!extend){var startRange=rangeForClick(view,start.pos,start.bias,type);var from=Math.min(startRange.from,range.from),to=Math.max(startRange.to,range.to);range=from<range.from?EditorSelection.range(from,to):EditorSelection.range(to,from);}if(extend)return startSel.replaceRange(startSel.main.extend(range.from,range.to));else if(multiple&&startSel.ranges.length>1&&startSel.ranges.some(function(r){return r.eq(range);}))return removeRange(startSel,range);else if(multiple)return startSel.addRange(range);else return EditorSelection.create([range]);}};}function removeRange(sel,range){for(var _i135=0;;_i135++){if(sel.ranges[_i135].eq(range))return EditorSelection.create(sel.ranges.slice(0,_i135).concat(sel.ranges.slice(_i135+1)),sel.mainIndex==_i135?0:sel.mainIndex-(sel.mainIndex>_i135?1:0));}}handlers.dragstart=function(view,event){var main=view.state.selection.main;var mouseSelection=view.inputState.mouseSelection;if(mouseSelection)mouseSelection.dragging=main;if(event.dataTransfer){event.dataTransfer.setData("Text",view.state.sliceDoc(main.from,main.to));event.dataTransfer.effectAllowed="copyMove";}};function dropText(view,event,text,direct){if(!text)return;var dropPos=view.posAtCoords({x:event.clientX,y:event.clientY},false);event.preventDefault();var mouseSelection=view.inputState.mouseSelection;var del=direct&&mouseSelection&&mouseSelection.dragging&&mouseSelection.dragMove?{from:mouseSelection.dragging.from,to:mouseSelection.dragging.to}:null;var ins={from:dropPos,insert:text};var changes=view.state.changes(del?[del,ins]:ins);view.focus();view.dispatch({changes:changes,selection:{anchor:changes.mapPos(dropPos,-1),head:changes.mapPos(dropPos,1)},userEvent:del?"move.drop":"input.drop"});}handlers.drop=function(view,event){if(!event.dataTransfer)return;if(view.state.readOnly)return event.preventDefault();var files=event.dataTransfer.files;if(files&&files.length){(function(){// For a file drop, read the file's text.
event.preventDefault();var text=Array(files.length),read=0;var finishFile=function finishFile(){if(++read==files.length)dropText(view,event,text.filter(function(s){return s!=null;}).join(view.state.lineBreak),false);};var _loop6=function _loop6(_i136){var reader=new FileReader();reader.onerror=finishFile;reader.onload=function(){if(!/[\x00-\x08\x0e-\x1f]{2}/.test(reader.result))text[_i136]=reader.result;finishFile();};reader.readAsText(files[_i136]);};for(var _i136=0;_i136<files.length;_i136++){_loop6(_i136);}})();}else{dropText(view,event,event.dataTransfer.getData("Text"),true);}};handlers.paste=function(view,event){if(view.state.readOnly)return event.preventDefault();view.observer.flush();var data=brokenClipboardAPI?null:event.clipboardData;if(data){doPaste(view,data.getData("text/plain"));event.preventDefault();}else{capturePaste(view);}};function captureCopy(view,text){// The extra wrapper is somehow necessary on IE/Edge to prevent the
// content from being mangled when it is put onto the clipboard
var parent=view.dom.parentNode;if(!parent)return;var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.value=text;target.focus();target.selectionEnd=text.length;target.selectionStart=0;setTimeout(function(){target.remove();view.focus();},50);}function copiedRange(state){var content=[],ranges=[],linewise=false;var _iterator55=_createForOfIteratorHelper(state.selection.ranges),_step55;try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){var _range9=_step55.value;if(!_range9.empty){content.push(state.sliceDoc(_range9.from,_range9.to));ranges.push(_range9);}}}catch(err){_iterator55.e(err);}finally{_iterator55.f();}if(!content.length){// Nothing selected, do a line-wise copy
var upto=-1;var _iterator56=_createForOfIteratorHelper(state.selection.ranges),_step56;try{for(_iterator56.s();!(_step56=_iterator56.n()).done;){var from=_step56.value.from;var line=state.doc.lineAt(from);if(line.number>upto){content.push(line.text);ranges.push({from:line.from,to:Math.min(state.doc.length,line.to+1)});}upto=line.number;}}catch(err){_iterator56.e(err);}finally{_iterator56.f();}linewise=true;}return{text:content.join(state.lineBreak),ranges:ranges,linewise:linewise};}var lastLinewiseCopy=null;handlers.copy=handlers.cut=function(view,event){var _copiedRange=copiedRange(view.state),text=_copiedRange.text,ranges=_copiedRange.ranges,linewise=_copiedRange.linewise;if(!text&&!linewise)return;lastLinewiseCopy=linewise?text:null;var data=brokenClipboardAPI?null:event.clipboardData;if(data){event.preventDefault();data.clearData();data.setData("text/plain",text);}else{captureCopy(view,text);}if(event.type=="cut"&&!view.state.readOnly)view.dispatch({changes:ranges,scrollIntoView:true,userEvent:"delete.cut"});};function updateForFocusChange(view){setTimeout(function(){if(view.hasFocus!=view.inputState.notifiedFocused)view.update([]);},10);}handlers.focus=function(view){view.inputState.lastFocusTime=Date.now();// When focusing reset the scroll position, move it back to where it was
if(!view.scrollDOM.scrollTop&&(view.inputState.lastScrollTop||view.inputState.lastScrollLeft)){view.scrollDOM.scrollTop=view.inputState.lastScrollTop;view.scrollDOM.scrollLeft=view.inputState.lastScrollLeft;}updateForFocusChange(view);};handlers.blur=function(view){view.observer.clearSelectionRange();updateForFocusChange(view);};handlers.compositionstart=handlers.compositionupdate=function(view){if(view.inputState.compositionFirstChange==null)view.inputState.compositionFirstChange=true;if(view.inputState.composing<0){// FIXME possibly set a timeout to clear it again on Android
view.inputState.composing=0;}};handlers.compositionend=function(view){view.inputState.composing=-1;view.inputState.compositionEndedAt=Date.now();view.inputState.compositionFirstChange=null;if(browser.chrome&&browser.android)view.observer.flushSoon();setTimeout(function(){// Force the composition state to be cleared if it hasn't already been
if(view.inputState.composing<0&&view.docView.compositionDeco.size)view.update([]);},50);};handlers.contextmenu=function(view){view.inputState.lastContextMenu=Date.now();};handlers.beforeinput=function(view,event){var _a;// Because Chrome Android doesn't fire useful key events, use
// beforeinput to detect backspace (and possibly enter and delete,
// but those usually don't even seem to fire beforeinput events at
// the moment) and fake a key event for it.
//
// (preventDefault on beforeinput, though supported in the spec,
// seems to do nothing at all on Chrome).
var pending;if(browser.chrome&&browser.android&&(pending=PendingKeys.find(function(key){return key.inputType==event.inputType;}))){view.observer.delayAndroidKey(pending.key,pending.keyCode);if(pending.key=="Backspace"||pending.key=="Delete"){var startViewHeight=((_a=window.visualViewport)===null||_a===void 0?void 0:_a.height)||0;setTimeout(function(){var _a;// Backspacing near uneditable nodes on Chrome Android sometimes
// closes the virtual keyboard. This tries to crudely detect
// that and refocus to get it back.
if((((_a=window.visualViewport)===null||_a===void 0?void 0:_a.height)||0)>startViewHeight+10&&view.hasFocus){view.contentDOM.blur();view.focus();}},100);}}};var wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];var HeightOracle=/*#__PURE__*/function(){function HeightOracle(){_classCallCheck(this,HeightOracle);this.doc=Text.empty;this.lineWrapping=false;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.lineLength=30;// Used to track, during updateHeight, if any actual heights changed
this.heightChanged=false;}_createClass(HeightOracle,[{key:"heightForGap",value:function heightForGap(from,to){var lines=this.doc.lineAt(to).number-this.doc.lineAt(from).number+1;if(this.lineWrapping)lines+=Math.ceil((to-from-lines*this.lineLength*0.5)/this.lineLength);return this.lineHeight*lines;}},{key:"heightForLine",value:function heightForLine(length){if(!this.lineWrapping)return this.lineHeight;var lines=1+Math.max(0,Math.ceil((length-this.lineLength)/(this.lineLength-5)));return lines*this.lineHeight;}},{key:"setDoc",value:function setDoc(doc){this.doc=doc;return this;}},{key:"mustRefreshForWrapping",value:function mustRefreshForWrapping(whiteSpace){return wrappingWhiteSpace.indexOf(whiteSpace)>-1!=this.lineWrapping;}},{key:"mustRefreshForHeights",value:function mustRefreshForHeights(lineHeights){var newHeight=false;for(var _i137=0;_i137<lineHeights.length;_i137++){var h=lineHeights[_i137];if(h<0){_i137++;}else if(!this.heightSamples[Math.floor(h*10)]){// Round to .1 pixels
newHeight=true;this.heightSamples[Math.floor(h*10)]=true;}}return newHeight;}},{key:"refresh",value:function refresh(whiteSpace,lineHeight,charWidth,lineLength,knownHeights){var lineWrapping=wrappingWhiteSpace.indexOf(whiteSpace)>-1;var changed=Math.round(lineHeight)!=Math.round(this.lineHeight)||this.lineWrapping!=lineWrapping;this.lineWrapping=lineWrapping;this.lineHeight=lineHeight;this.charWidth=charWidth;this.lineLength=lineLength;if(changed){this.heightSamples={};for(var _i138=0;_i138<knownHeights.length;_i138++){var h=knownHeights[_i138];if(h<0)_i138++;else this.heightSamples[Math.floor(h*10)]=true;}}return changed;}}]);return HeightOracle;}();// This object is used by `updateHeight` to make DOM measurements
// arrive at the right nides. The `heights` array is a sequence of
// block heights, starting from position `from`.
var MeasuredHeights=/*#__PURE__*/function(){function MeasuredHeights(from,heights){_classCallCheck(this,MeasuredHeights);this.from=from;this.heights=heights;this.index=0;}_createClass(MeasuredHeights,[{key:"more",get:function get(){return this.index<this.heights.length;}}]);return MeasuredHeights;}();/**
Record used to represent information about a block-level element
in the editor view.
*/var BlockInfo=/*#__PURE__*/function(){/**
    @internal
    */function BlockInfo(/**
    The start of the element in the document.
    */from,/**
    The length of the element.
    */length,/**
    The top position of the element (relative to the top of the
    document).
    */top,/**
    Its height.
    */height,/**
    The type of element this is. When querying lines, this may be
    an array of all the blocks that make up the line.
    */type){_classCallCheck(this,BlockInfo);this.from=from;this.length=length;this.top=top;this.height=height;this.type=type;}/**
    The end of the element as a document position.
    */_createClass(BlockInfo,[{key:"to",get:function get(){return this.from+this.length;}/**
    The bottom position of the element.
    */},{key:"bottom",get:function get(){return this.top+this.height;}/**
    @internal
    */},{key:"join",value:function join(other){var detail=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(other.type)?other.type:[other]);return new BlockInfo(this.from,this.length+other.length,this.top,this.height+other.height,detail);}}]);return BlockInfo;}();var QueryType$1=/*@__PURE__*/function(QueryType){QueryType[QueryType["ByPos"]=0]="ByPos";QueryType[QueryType["ByHeight"]=1]="ByHeight";QueryType[QueryType["ByPosNoHeight"]=2]="ByPosNoHeight";return QueryType;}(QueryType$1||(QueryType$1={}));var Epsilon=1e-3;var HeightMap=/*#__PURE__*/function(){function HeightMap(length,// The number of characters covered
height){var flags=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2;_classCallCheck(this,HeightMap);this.length=length;this.height=height;this.flags=flags;}_createClass(HeightMap,[{key:"outdated",get:function get(){return(this.flags&2/* Flag.Outdated */)>0;},set:function set(value){this.flags=(value?2/* Flag.Outdated */:0)|this.flags&~2/* Flag.Outdated */;}},{key:"setHeight",value:function setHeight(oracle,height){if(this.height!=height){if(Math.abs(this.height-height)>Epsilon)oracle.heightChanged=true;this.height=height;}}// Base case is to replace a leaf node, which simply builds a tree
// from the new nodes and returns that (HeightMapBranch and
// HeightMapGap override this to actually use from/to)
},{key:"replace",value:function replace(_from,_to,nodes){return HeightMap.of(nodes);}// Again, these are base cases, and are overridden for branch and gap nodes.
},{key:"decomposeLeft",value:function decomposeLeft(_to,result){result.push(this);}},{key:"decomposeRight",value:function decomposeRight(_from,result){result.push(this);}},{key:"applyChanges",value:function applyChanges(decorations,oldDoc,oracle,changes){var me=this;for(var _i139=changes.length-1;_i139>=0;_i139--){var _changes$_i=changes[_i139],fromA=_changes$_i.fromA,toA=_changes$_i.toA,fromB=_changes$_i.fromB,toB=_changes$_i.toB;var start=me.lineAt(fromA,QueryType$1.ByPosNoHeight,oldDoc,0,0);var end=start.to>=toA?start:me.lineAt(toA,QueryType$1.ByPosNoHeight,oldDoc,0,0);toB+=end.to-toA;toA=end.to;while(_i139>0&&start.from<=changes[_i139-1].toA){fromA=changes[_i139-1].fromA;fromB=changes[_i139-1].fromB;_i139--;if(fromA<start.from)start=me.lineAt(fromA,QueryType$1.ByPosNoHeight,oldDoc,0,0);}fromB+=start.from-fromA;fromA=start.from;var nodes=NodeBuilder.build(oracle,decorations,fromB,toB);me=me.replace(fromA,toA,nodes);}return me.updateHeight(oracle,0);}}],[{key:"empty",value:function empty(){return new HeightMapText(0,0);}// nodes uses null values to indicate the position of line breaks.
// There are never line breaks at the start or end of the array, or
// two line breaks next to each other, and the array isn't allowed
// to be empty (same restrictions as return value from the builder).
},{key:"of",value:function of(nodes){if(nodes.length==1)return nodes[0];var i=0,j=nodes.length,before=0,after=0;for(;;){if(i==j){if(before>after*2){var _split=nodes[i-1];if(_split["break"])nodes.splice(--i,1,_split.left,null,_split.right);else nodes.splice(--i,1,_split.left,_split.right);j+=1+_split["break"];before-=_split.size;}else if(after>before*2){var _split2=nodes[j];if(_split2["break"])nodes.splice(j,1,_split2.left,null,_split2.right);else nodes.splice(j,1,_split2.left,_split2.right);j+=2+_split2["break"];after-=_split2.size;}else{break;}}else if(before<after){var next=nodes[i++];if(next)before+=next.size;}else{var _next2=nodes[--j];if(_next2)after+=_next2.size;}}var brk=0;if(nodes[i-1]==null){brk=1;i--;}else if(nodes[i]==null){brk=1;j++;}return new HeightMapBranch(HeightMap.of(nodes.slice(0,i)),brk,HeightMap.of(nodes.slice(j)));}}]);return HeightMap;}();HeightMap.prototype.size=1;var HeightMapBlock=/*#__PURE__*/function(_HeightMap){_inherits(HeightMapBlock,_HeightMap);var _super33=_createSuper(HeightMapBlock);function HeightMapBlock(length,height,type){var _this45;_classCallCheck(this,HeightMapBlock);_this45=_super33.call(this,length,height);_this45.type=type;return _this45;}_createClass(HeightMapBlock,[{key:"blockAt",value:function blockAt(_height,_doc,top,offset){return new BlockInfo(offset,this.length,top,this.height,this.type);}},{key:"lineAt",value:function lineAt(_value,_type,doc,top,offset){return this.blockAt(0,doc,top,offset);}},{key:"forEachLine",value:function forEachLine(from,to,doc,top,offset,f){if(from<=offset+this.length&&to>=offset)f(this.blockAt(0,doc,top,offset));}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var _force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;if(measured&&measured.from<=offset&&measured.more)this.setHeight(oracle,measured.heights[measured.index++]);this.outdated=false;return this;}},{key:"toString",value:function toString(){return"block(".concat(this.length,")");}}]);return HeightMapBlock;}(HeightMap);var HeightMapText=/*#__PURE__*/function(_HeightMapBlock){_inherits(HeightMapText,_HeightMapBlock);var _super34=_createSuper(HeightMapText);function HeightMapText(length,height){var _this46;_classCallCheck(this,HeightMapText);_this46=_super34.call(this,length,height,BlockType.Text);_this46.collapsed=0;// Amount of collapsed content in the line
_this46.widgetHeight=0;// Maximum inline widget height
return _this46;}_createClass(HeightMapText,[{key:"replace",value:function replace(_from,_to,nodes){var node=nodes[0];if(nodes.length==1&&(node instanceof HeightMapText||node instanceof HeightMapGap&&node.flags&4/* Flag.SingleLine */)&&Math.abs(this.length-node.length)<10){if(node instanceof HeightMapGap)node=new HeightMapText(node.length,this.height);else node.height=this.height;if(!this.outdated)node.outdated=false;return node;}else{return HeightMap.of(nodes);}}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;if(measured&&measured.from<=offset&&measured.more)this.setHeight(oracle,measured.heights[measured.index++]);else if(force||this.outdated)this.setHeight(oracle,Math.max(this.widgetHeight,oracle.heightForLine(this.length-this.collapsed)));this.outdated=false;return this;}},{key:"toString",value:function toString(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")");}}]);return HeightMapText;}(HeightMapBlock);var HeightMapGap=/*#__PURE__*/function(_HeightMap2){_inherits(HeightMapGap,_HeightMap2);var _super35=_createSuper(HeightMapGap);function HeightMapGap(length){_classCallCheck(this,HeightMapGap);return _super35.call(this,length,0);}_createClass(HeightMapGap,[{key:"lines",value:function lines(doc,offset){var firstLine=doc.lineAt(offset).number,lastLine=doc.lineAt(offset+this.length).number;return{firstLine:firstLine,lastLine:lastLine,lineHeight:this.height/(lastLine-firstLine+1)};}},{key:"blockAt",value:function blockAt(height,doc,top,offset){var _this$lines=this.lines(doc,offset),firstLine=_this$lines.firstLine,lastLine=_this$lines.lastLine,lineHeight=_this$lines.lineHeight;var line=Math.max(0,Math.min(lastLine-firstLine,Math.floor((height-top)/lineHeight)));var _doc$line=doc.line(firstLine+line),from=_doc$line.from,length=_doc$line.length;return new BlockInfo(from,length,top+lineHeight*line,lineHeight,BlockType.Text);}},{key:"lineAt",value:function lineAt(value,type,doc,top,offset){if(type==QueryType$1.ByHeight)return this.blockAt(value,doc,top,offset);if(type==QueryType$1.ByPosNoHeight){var _doc$lineAt=doc.lineAt(value),_from2=_doc$lineAt.from,to=_doc$lineAt.to;return new BlockInfo(_from2,to-_from2,0,0,BlockType.Text);}var _this$lines2=this.lines(doc,offset),firstLine=_this$lines2.firstLine,lineHeight=_this$lines2.lineHeight;var _doc$lineAt2=doc.lineAt(value),from=_doc$lineAt2.from,length=_doc$lineAt2.length,number=_doc$lineAt2.number;return new BlockInfo(from,length,top+lineHeight*(number-firstLine),lineHeight,BlockType.Text);}},{key:"forEachLine",value:function forEachLine(from,to,doc,top,offset,f){var _this$lines3=this.lines(doc,offset),firstLine=_this$lines3.firstLine,lineHeight=_this$lines3.lineHeight;for(var pos=Math.max(from,offset),end=Math.min(offset+this.length,to);pos<=end;){var line=doc.lineAt(pos);if(pos==from)top+=lineHeight*(line.number-firstLine);f(new BlockInfo(line.from,line.length,top,lineHeight,BlockType.Text));top+=lineHeight;pos=line.to+1;}}},{key:"replace",value:function replace(from,to,nodes){var after=this.length-to;if(after>0){var _last5=nodes[nodes.length-1];if(_last5 instanceof HeightMapGap)nodes[nodes.length-1]=new HeightMapGap(_last5.length+after);else nodes.push(null,new HeightMapGap(after-1));}if(from>0){var first=nodes[0];if(first instanceof HeightMapGap)nodes[0]=new HeightMapGap(from+first.length);else nodes.unshift(new HeightMapGap(from-1),null);}return HeightMap.of(nodes);}},{key:"decomposeLeft",value:function decomposeLeft(to,result){result.push(new HeightMapGap(to-1),null);}},{key:"decomposeRight",value:function decomposeRight(from,result){result.push(null,new HeightMapGap(this.length-from-1));}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;var end=offset+this.length;if(measured&&measured.from<=offset+this.length&&measured.more){// Fill in part of this gap with measured lines. We know there
// can't be widgets or collapsed ranges in those lines, because
// they would already have been added to the heightmap (gaps
// only contain plain text).
var nodes=[],pos=Math.max(offset,measured.from),singleHeight=-1;var wasChanged=oracle.heightChanged;if(measured.from>offset)nodes.push(new HeightMapGap(measured.from-offset-1).updateHeight(oracle,offset));while(pos<=end&&measured.more){var len=oracle.doc.lineAt(pos).length;if(nodes.length)nodes.push(null);var height=measured.heights[measured.index++];if(singleHeight==-1)singleHeight=height;else if(Math.abs(height-singleHeight)>=Epsilon)singleHeight=-2;var line=new HeightMapText(len,height);line.outdated=false;nodes.push(line);pos+=len+1;}if(pos<=end)nodes.push(null,new HeightMapGap(end-pos).updateHeight(oracle,pos));var _result4=HeightMap.of(nodes);oracle.heightChanged=wasChanged||singleHeight<0||Math.abs(_result4.height-this.height)>=Epsilon||Math.abs(singleHeight-this.lines(oracle.doc,offset).lineHeight)>=Epsilon;return _result4;}else if(force||this.outdated){this.setHeight(oracle,oracle.heightForGap(offset,offset+this.length));this.outdated=false;}return this;}},{key:"toString",value:function toString(){return"gap(".concat(this.length,")");}}]);return HeightMapGap;}(HeightMap);var HeightMapBranch=/*#__PURE__*/function(_HeightMap3){_inherits(HeightMapBranch,_HeightMap3);var _super36=_createSuper(HeightMapBranch);function HeightMapBranch(left,brk,right){var _this47;_classCallCheck(this,HeightMapBranch);_this47=_super36.call(this,left.length+brk+right.length,left.height+right.height,brk|(left.outdated||right.outdated?2/* Flag.Outdated */:0));_this47.left=left;_this47.right=right;_this47.size=left.size+right.size;return _this47;}_createClass(HeightMapBranch,[{key:"break",get:function get(){return this.flags&1/* Flag.Break */;}},{key:"blockAt",value:function blockAt(height,doc,top,offset){var mid=top+this.left.height;return height<mid?this.left.blockAt(height,doc,top,offset):this.right.blockAt(height,doc,mid,offset+this.left.length+this["break"]);}},{key:"lineAt",value:function lineAt(value,type,doc,top,offset){var rightTop=top+this.left.height,rightOffset=offset+this.left.length+this["break"];var left=type==QueryType$1.ByHeight?value<rightTop:value<rightOffset;var base=left?this.left.lineAt(value,type,doc,top,offset):this.right.lineAt(value,type,doc,rightTop,rightOffset);if(this["break"]||(left?base.to<rightOffset:base.from>rightOffset))return base;var subQuery=type==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;if(left)return base.join(this.right.lineAt(rightOffset,subQuery,doc,rightTop,rightOffset));else return this.left.lineAt(rightOffset,subQuery,doc,top,offset).join(base);}},{key:"forEachLine",value:function forEachLine(from,to,doc,top,offset,f){var rightTop=top+this.left.height,rightOffset=offset+this.left.length+this["break"];if(this["break"]){if(from<rightOffset)this.left.forEachLine(from,to,doc,top,offset,f);if(to>=rightOffset)this.right.forEachLine(from,to,doc,rightTop,rightOffset,f);}else{var mid=this.lineAt(rightOffset,QueryType$1.ByPos,doc,top,offset);if(from<mid.from)this.left.forEachLine(from,mid.from-1,doc,top,offset,f);if(mid.to>=from&&mid.from<=to)f(mid);if(to>mid.to)this.right.forEachLine(mid.to+1,to,doc,rightTop,rightOffset,f);}}},{key:"replace",value:function replace(from,to,nodes){var rightStart=this.left.length+this["break"];if(to<rightStart)return this.balanced(this.left.replace(from,to,nodes),this.right);if(from>this.left.length)return this.balanced(this.left,this.right.replace(from-rightStart,to-rightStart,nodes));var result=[];if(from>0)this.decomposeLeft(from,result);var left=result.length;var _iterator57=_createForOfIteratorHelper(nodes),_step57;try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){var node=_step57.value;result.push(node);}}catch(err){_iterator57.e(err);}finally{_iterator57.f();}if(from>0)mergeGaps(result,left-1);if(to<this.length){var right=result.length;this.decomposeRight(to,result);mergeGaps(result,right);}return HeightMap.of(result);}},{key:"decomposeLeft",value:function decomposeLeft(to,result){var left=this.left.length;if(to<=left)return this.left.decomposeLeft(to,result);result.push(this.left);if(this["break"]){left++;if(to>=left)result.push(null);}if(to>left)this.right.decomposeLeft(to-left,result);}},{key:"decomposeRight",value:function decomposeRight(from,result){var left=this.left.length,right=left+this["break"];if(from>=right)return this.right.decomposeRight(from-right,result);if(from<left)this.left.decomposeRight(from,result);if(this["break"]&&from<right)result.push(null);result.push(this.right);}},{key:"balanced",value:function balanced(left,right){if(left.size>2*right.size||right.size>2*left.size)return HeightMap.of(this["break"]?[left,null,right]:[left,right]);this.left=left;this.right=right;this.height=left.height+right.height;this.outdated=left.outdated||right.outdated;this.size=left.size+right.size;this.length=left.length+this["break"]+right.length;return this;}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;var left=this.left,right=this.right,rightStart=offset+left.length+this["break"],rebalance=null;if(measured&&measured.from<=offset+left.length&&measured.more)rebalance=left=left.updateHeight(oracle,offset,force,measured);else left.updateHeight(oracle,offset,force);if(measured&&measured.from<=rightStart+right.length&&measured.more)rebalance=right=right.updateHeight(oracle,rightStart,force,measured);else right.updateHeight(oracle,rightStart,force);if(rebalance)return this.balanced(left,right);this.height=this.left.height+this.right.height;this.outdated=false;return this;}},{key:"toString",value:function toString(){return this.left+(this["break"]?" ":"-")+this.right;}}]);return HeightMapBranch;}(HeightMap);function mergeGaps(nodes,around){var before,after;if(nodes[around]==null&&(before=nodes[around-1])instanceof HeightMapGap&&(after=nodes[around+1])instanceof HeightMapGap)nodes.splice(around-1,3,new HeightMapGap(before.length+1+after.length));}var relevantWidgetHeight=5;var NodeBuilder=/*#__PURE__*/function(){function NodeBuilder(pos,oracle){_classCallCheck(this,NodeBuilder);this.pos=pos;this.oracle=oracle;this.nodes=[];this.lineStart=-1;this.lineEnd=-1;this.covering=null;this.writtenTo=pos;}_createClass(NodeBuilder,[{key:"isCovered",get:function get(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering;}},{key:"span",value:function span(_from,to){if(this.lineStart>-1){var end=Math.min(to,this.lineEnd),_last6=this.nodes[this.nodes.length-1];if(_last6 instanceof HeightMapText)_last6.length+=end-this.pos;else if(end>this.pos||!this.isCovered)this.nodes.push(new HeightMapText(end-this.pos,-1));this.writtenTo=end;if(to>end){this.nodes.push(null);this.writtenTo++;this.lineStart=-1;}}this.pos=to;}},{key:"point",value:function point(from,to,deco){if(from<to||deco.heightRelevant){var height=deco.widget?deco.widget.estimatedHeight:0;if(height<0)height=this.oracle.lineHeight;var len=to-from;if(deco.block){this.addBlock(new HeightMapBlock(len,height,deco.type));}else if(len||height>=relevantWidgetHeight){this.addLineDeco(height,len);}}else if(to>from){this.span(from,to);}if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to;}},{key:"enterLine",value:function enterLine(){if(this.lineStart>-1)return;var _this$oracle$doc$line=this.oracle.doc.lineAt(this.pos),from=_this$oracle$doc$line.from,to=_this$oracle$doc$line.to;this.lineStart=from;this.lineEnd=to;if(this.writtenTo<from){if(this.writtenTo<from-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,from-1));this.nodes.push(null);}if(this.pos>from)this.nodes.push(new HeightMapText(this.pos-from,-1));this.writtenTo=this.pos;}},{key:"blankContent",value:function blankContent(from,to){var gap=new HeightMapGap(to-from);if(this.oracle.doc.lineAt(from).to==to)gap.flags|=4/* Flag.SingleLine */;return gap;}},{key:"ensureLine",value:function ensureLine(){this.enterLine();var last=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(last instanceof HeightMapText)return last;var line=new HeightMapText(0,-1);this.nodes.push(line);return line;}},{key:"addBlock",value:function addBlock(block){this.enterLine();if(block.type==BlockType.WidgetAfter&&!this.isCovered)this.ensureLine();this.nodes.push(block);this.writtenTo=this.pos=this.pos+block.length;if(block.type!=BlockType.WidgetBefore)this.covering=block;}},{key:"addLineDeco",value:function addLineDeco(height,length){var line=this.ensureLine();line.length+=length;line.collapsed+=length;line.widgetHeight=Math.max(line.widgetHeight,height);this.writtenTo=this.pos=this.pos+length;}},{key:"finish",value:function finish(from){var last=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!(last instanceof HeightMapText)&&!this.isCovered)this.nodes.push(new HeightMapText(0,-1));else if(this.writtenTo<this.pos||last==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));var pos=from;var _iterator58=_createForOfIteratorHelper(this.nodes),_step58;try{for(_iterator58.s();!(_step58=_iterator58.n()).done;){var node=_step58.value;if(node instanceof HeightMapText)node.updateHeight(this.oracle,pos);pos+=node?node.length:1;}}catch(err){_iterator58.e(err);}finally{_iterator58.f();}return this.nodes;}// Always called with a region that on both sides either stretches
// to a line break or the end of the document.
// The returned array uses null to indicate line breaks, but never
// starts or ends in a line break, or has multiple line breaks next
// to each other.
}],[{key:"build",value:function build(oracle,decorations,from,to){var builder=new NodeBuilder(from,oracle);RangeSet.spans(decorations,from,to,builder,0);return builder.finish(from);}}]);return NodeBuilder;}();function heightRelevantDecoChanges(a,b,diff){var comp=new DecorationComparator();RangeSet.compare(a,b,diff,comp,0);return comp.changes;}var DecorationComparator=/*#__PURE__*/function(){function DecorationComparator(){_classCallCheck(this,DecorationComparator);this.changes=[];}_createClass(DecorationComparator,[{key:"compareRange",value:function compareRange(){}},{key:"comparePoint",value:function comparePoint(from,to,a,b){if(from<to||a&&a.heightRelevant||b&&b.heightRelevant)addRange(from,to,this.changes,5);}}]);return DecorationComparator;}();function visiblePixelRange(dom,paddingTop){var rect=dom.getBoundingClientRect();var doc=dom.ownerDocument,win=doc.defaultView||window;var left=Math.max(0,rect.left),right=Math.min(win.innerWidth,rect.right);var top=Math.max(0,rect.top),bottom=Math.min(win.innerHeight,rect.bottom);for(var _parent9=dom.parentNode;_parent9&&_parent9!=doc.body;){if(_parent9.nodeType==1){var elt=_parent9;var _style2=window.getComputedStyle(elt);if((elt.scrollHeight>elt.clientHeight||elt.scrollWidth>elt.clientWidth)&&_style2.overflow!="visible"){var parentRect=elt.getBoundingClientRect();left=Math.max(left,parentRect.left);right=Math.min(right,parentRect.right);top=Math.max(top,parentRect.top);bottom=_parent9==dom.parentNode?parentRect.bottom:Math.min(bottom,parentRect.bottom);}_parent9=_style2.position=="absolute"||_style2.position=="fixed"?elt.offsetParent:elt.parentNode;}else if(_parent9.nodeType==11){// Shadow root
_parent9=_parent9.host;}else{break;}}return{left:left-rect.left,right:Math.max(left,right)-rect.left,top:top-(rect.top+paddingTop),bottom:Math.max(top,bottom)-(rect.top+paddingTop)};}function fullPixelRange(dom,paddingTop){var rect=dom.getBoundingClientRect();return{left:0,right:rect.right-rect.left,top:paddingTop,bottom:rect.bottom-(rect.top+paddingTop)};}// Line gaps are placeholder widgets used to hide pieces of overlong
// lines within the viewport, as a kludge to keep the editor
// responsive when a ridiculously long line is loaded into it.
var LineGap=/*#__PURE__*/function(){function LineGap(from,to,size){_classCallCheck(this,LineGap);this.from=from;this.to=to;this.size=size;}_createClass(LineGap,[{key:"draw",value:function draw(wrapping){return Decoration.replace({widget:new LineGapWidget(this.size,wrapping)}).range(this.from,this.to);}}],[{key:"same",value:function same(a,b){if(a.length!=b.length)return false;for(var _i140=0;_i140<a.length;_i140++){var gA=a[_i140],gB=b[_i140];if(gA.from!=gB.from||gA.to!=gB.to||gA.size!=gB.size)return false;}return true;}}]);return LineGap;}();var LineGapWidget=/*#__PURE__*/function(_WidgetType4){_inherits(LineGapWidget,_WidgetType4);var _super37=_createSuper(LineGapWidget);function LineGapWidget(size,vertical){var _this48;_classCallCheck(this,LineGapWidget);_this48=_super37.call(this);_this48.size=size;_this48.vertical=vertical;return _this48;}_createClass(LineGapWidget,[{key:"eq",value:function eq(other){return other.size==this.size&&other.vertical==this.vertical;}},{key:"toDOM",value:function toDOM(){var elt=document.createElement("div");if(this.vertical){elt.style.height=this.size+"px";}else{elt.style.width=this.size+"px";elt.style.height="2px";elt.style.display="inline-block";}return elt;}},{key:"estimatedHeight",get:function get(){return this.vertical?this.size:-1;}}]);return LineGapWidget;}(WidgetType);var ViewState=/*#__PURE__*/function(){function ViewState(state){_classCallCheck(this,ViewState);this.state=state;// These are contentDOM-local coordinates
this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=true;this.paddingTop=0;this.paddingBottom=0;this.contentDOMWidth=0;this.contentDOMHeight=0;this.editorHeight=0;this.editorWidth=0;this.heightOracle=new HeightOracle();// See VP.MaxDOMHeight
this.scaler=IdScaler;this.scrollTarget=null;// Briefly set to true when printing, to disable viewport limiting
this.printing=false;// Flag set when editor content was redrawn, so that the next
// measure stage knows it must read DOM layout
this.mustMeasureContent=true;this.defaultTextDirection=Direction.RTL;this.visibleRanges=[];// Cursor 'assoc' is only significant when the cursor is on a line
// wrap point, where it must stick to the character that it is
// associated with. Since browsers don't provide a reasonable
// interface to set or query this, when a selection is set that
// might cause this to be significant, this flag is set. The next
// measure phase will check whether the cursor is on a line-wrapping
// boundary and, if so, reset it to make sure it is positioned in
// the right place.
this.mustEnforceCursorAssoc=false;this.stateDeco=state.facet(decorations).filter(function(d){return typeof d!="function";});this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(state.doc),[new ChangedRange(0,0,0,state.doc.length)]);this.viewport=this.getViewport(0,null);this.updateViewportLines();this.updateForViewport();this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=Decoration.set(this.lineGaps.map(function(gap){return gap.draw(false);}));this.computeVisibleRanges();}_createClass(ViewState,[{key:"updateForViewport",value:function updateForViewport(){var _this49=this;var viewports=[this.viewport],main=this.state.selection.main;var _loop7=function _loop7(_i141){var pos=_i141?main.head:main.anchor;if(!viewports.some(function(_ref42){var from=_ref42.from,to=_ref42.to;return pos>=from&&pos<=to;})){var _this49$lineBlockAt=_this49.lineBlockAt(pos),from=_this49$lineBlockAt.from,to=_this49$lineBlockAt.to;viewports.push(new Viewport(from,to));}};for(var _i141=0;_i141<=1;_i141++){_loop7(_i141);}this.viewports=viewports.sort(function(a,b){return a.from-b.from;});this.scaler=this.heightMap.height<=7000000/* VP.MaxDOMHeight */?IdScaler:new BigScaler(this.heightOracle.doc,this.heightMap,this.viewports);}},{key:"updateViewportLines",value:function updateViewportLines(){var _this50=this;this.viewportLines=[];this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,function(block){_this50.viewportLines.push(_this50.scaler.scale==1?block:scaleBlock(block,_this50.scaler));});}},{key:"update",value:function update(_update6){var scrollTarget=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.state=_update6.state;var prevDeco=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(function(d){return typeof d!="function";});var contentChanges=_update6.changedRanges;var heightChanges=ChangedRange.extendWithRanges(contentChanges,heightRelevantDecoChanges(prevDeco,this.stateDeco,_update6?_update6.changes:ChangeSet.empty(this.state.doc.length)));var prevHeight=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,_update6.startState.doc,this.heightOracle.setDoc(this.state.doc),heightChanges);if(this.heightMap.height!=prevHeight)_update6.flags|=2/* UpdateFlag.Height */;var viewport=heightChanges.length?this.mapViewport(this.viewport,_update6.changes):this.viewport;if(scrollTarget&&(scrollTarget.range.head<viewport.from||scrollTarget.range.head>viewport.to)||!this.viewportIsAppropriate(viewport))viewport=this.getViewport(0,scrollTarget);var updateLines=!_update6.changes.empty||_update6.flags&2/* UpdateFlag.Height */||viewport.from!=this.viewport.from||viewport.to!=this.viewport.to;this.viewport=viewport;this.updateForViewport();if(updateLines)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>2000/* LG.Margin */<<1)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,_update6.changes)));_update6.flags|=this.computeVisibleRanges();if(scrollTarget)this.scrollTarget=scrollTarget;if(!this.mustEnforceCursorAssoc&&_update6.selectionSet&&_update6.view.lineWrapping&&_update6.state.selection.main.empty&&_update6.state.selection.main.assoc)this.mustEnforceCursorAssoc=true;}},{key:"measure",value:function measure(view){var dom=view.contentDOM,style=window.getComputedStyle(dom);var oracle=this.heightOracle;var whiteSpace=style.whiteSpace;this.defaultTextDirection=style.direction=="rtl"?Direction.RTL:Direction.LTR;var refresh=this.heightOracle.mustRefreshForWrapping(whiteSpace);var measureContent=refresh||this.mustMeasureContent||this.contentDOMHeight!=dom.clientHeight;this.contentDOMHeight=dom.clientHeight;this.mustMeasureContent=false;var result=0,bias=0;// Vertical padding
var paddingTop=parseInt(style.paddingTop)||0,paddingBottom=parseInt(style.paddingBottom)||0;if(this.paddingTop!=paddingTop||this.paddingBottom!=paddingBottom){this.paddingTop=paddingTop;this.paddingBottom=paddingBottom;result|=8/* UpdateFlag.Geometry */|2/* UpdateFlag.Height */;}if(this.editorWidth!=view.scrollDOM.clientWidth){if(oracle.lineWrapping)measureContent=true;this.editorWidth=view.scrollDOM.clientWidth;result|=8/* UpdateFlag.Geometry */;}// Pixel viewport
var pixelViewport=(this.printing?fullPixelRange:visiblePixelRange)(dom,this.paddingTop);var dTop=pixelViewport.top-this.pixelViewport.top,dBottom=pixelViewport.bottom-this.pixelViewport.bottom;this.pixelViewport=pixelViewport;var inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(inView!=this.inView){this.inView=inView;if(inView)measureContent=true;}if(!this.inView&&!this.scrollTarget)return 0;var contentWidth=dom.clientWidth;if(this.contentDOMWidth!=contentWidth||this.editorHeight!=view.scrollDOM.clientHeight){this.contentDOMWidth=contentWidth;this.editorHeight=view.scrollDOM.clientHeight;result|=8/* UpdateFlag.Geometry */;}if(measureContent){var lineHeights=view.docView.measureVisibleLineHeights(this.viewport);if(oracle.mustRefreshForHeights(lineHeights))refresh=true;if(refresh||oracle.lineWrapping&&Math.abs(contentWidth-this.contentDOMWidth)>oracle.charWidth){var _view$docView$measure=view.docView.measureTextSize(),lineHeight=_view$docView$measure.lineHeight,charWidth=_view$docView$measure.charWidth;refresh=lineHeight>0&&oracle.refresh(whiteSpace,lineHeight,charWidth,contentWidth/charWidth,lineHeights);if(refresh){view.docView.minWidth=0;result|=8/* UpdateFlag.Geometry */;}}if(dTop>0&&dBottom>0)bias=Math.max(dTop,dBottom);else if(dTop<0&&dBottom<0)bias=Math.min(dTop,dBottom);oracle.heightChanged=false;var _iterator59=_createForOfIteratorHelper(this.viewports),_step59;try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var vp=_step59.value;var heights=vp.from==this.viewport.from?lineHeights:view.docView.measureVisibleLineHeights(vp);this.heightMap=this.heightMap.updateHeight(oracle,0,refresh,new MeasuredHeights(vp.from,heights));}}catch(err){_iterator59.e(err);}finally{_iterator59.f();}if(oracle.heightChanged)result|=2/* UpdateFlag.Height */;}var viewportChange=!this.viewportIsAppropriate(this.viewport,bias)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(viewportChange)this.viewport=this.getViewport(bias,this.scrollTarget);this.updateForViewport();if(result&2/* UpdateFlag.Height */||viewportChange)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>2000/* LG.Margin */<<1)this.updateLineGaps(this.ensureLineGaps(refresh?[]:this.lineGaps,view));result|=this.computeVisibleRanges();if(this.mustEnforceCursorAssoc){this.mustEnforceCursorAssoc=false;// This is done in the read stage, because moving the selection
// to a line end is going to trigger a layout anyway, so it
// can't be a pure write. It should be rare that it does any
// writing.
view.docView.enforceCursorAssoc();}return result;}},{key:"visibleTop",get:function get(){return this.scaler.fromDOM(this.pixelViewport.top);}},{key:"visibleBottom",get:function get(){return this.scaler.fromDOM(this.pixelViewport.bottom);}},{key:"getViewport",value:function getViewport(bias,scrollTarget){// This will divide VP.Margin between the top and the
// bottom, depending on the bias (the change in viewport position
// since the last update). It'll hold a number between 0 and 1
var marginTop=0.5-Math.max(-0.5,Math.min(0.5,bias/1000/* VP.Margin *//2));var map=this.heightMap,doc=this.state.doc,visibleTop=this.visibleTop,visibleBottom=this.visibleBottom;var viewport=new Viewport(map.lineAt(visibleTop-marginTop*1000/* VP.Margin */,QueryType$1.ByHeight,doc,0,0).from,map.lineAt(visibleBottom+(1-marginTop)*1000/* VP.Margin */,QueryType$1.ByHeight,doc,0,0).to);// If scrollTarget is given, make sure the viewport includes that position
if(scrollTarget){var _head=scrollTarget.range.head;if(_head<viewport.from||_head>viewport.to){var viewHeight=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top);var block=map.lineAt(_head,QueryType$1.ByPos,doc,0,0),topPos;if(scrollTarget.y=="center")topPos=(block.top+block.bottom)/2-viewHeight/2;else if(scrollTarget.y=="start"||scrollTarget.y=="nearest"&&_head<viewport.from)topPos=block.top;else topPos=block.bottom-viewHeight;viewport=new Viewport(map.lineAt(topPos-1000/* VP.Margin *//2,QueryType$1.ByHeight,doc,0,0).from,map.lineAt(topPos+viewHeight+1000/* VP.Margin *//2,QueryType$1.ByHeight,doc,0,0).to);}}return viewport;}},{key:"mapViewport",value:function mapViewport(viewport,changes){var from=changes.mapPos(viewport.from,-1),to=changes.mapPos(viewport.to,1);return new Viewport(this.heightMap.lineAt(from,QueryType$1.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(to,QueryType$1.ByPos,this.state.doc,0,0).to);}// Checks if a given viewport covers the visible part of the
// document and not too much beyond that.
},{key:"viewportIsAppropriate",value:function viewportIsAppropriate(_ref43){var from=_ref43.from,to=_ref43.to;var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!this.inView)return true;var _this$heightMap$lineA=this.heightMap.lineAt(from,QueryType$1.ByPos,this.state.doc,0,0),top=_this$heightMap$lineA.top;var _this$heightMap$lineA2=this.heightMap.lineAt(to,QueryType$1.ByPos,this.state.doc,0,0),bottom=_this$heightMap$lineA2.bottom;var visibleTop=this.visibleTop,visibleBottom=this.visibleBottom;return(from==0||top<=visibleTop-Math.max(10/* VP.MinCoverMargin */,Math.min(-bias,250/* VP.MaxCoverMargin */)))&&(to==this.state.doc.length||bottom>=visibleBottom+Math.max(10/* VP.MinCoverMargin */,Math.min(bias,250/* VP.MaxCoverMargin */)))&&top>visibleTop-2*1000/* VP.Margin */&&bottom<visibleBottom+2*1000/* VP.Margin */;}},{key:"mapLineGaps",value:function mapLineGaps(gaps,changes){if(!gaps.length||changes.empty)return gaps;var mapped=[];var _iterator60=_createForOfIteratorHelper(gaps),_step60;try{for(_iterator60.s();!(_step60=_iterator60.n()).done;){var gap=_step60.value;if(!changes.touchesRange(gap.from,gap.to))mapped.push(new LineGap(changes.mapPos(gap.from),changes.mapPos(gap.to),gap.size));}}catch(err){_iterator60.e(err);}finally{_iterator60.f();}return mapped;}// Computes positions in the viewport where the start or end of a
// line should be hidden, trying to reuse existing line gaps when
// appropriate to avoid unneccesary redraws.
// Uses crude character-counting for the positioning and sizing,
// since actual DOM coordinates aren't always available and
// predictable. Relies on generous margins (see LG.Margin) to hide
// the artifacts this might produce from the user.
},{key:"ensureLineGaps",value:function ensureLineGaps(current,mayMeasure){var _this51=this;var wrapping=this.heightOracle.lineWrapping;var margin=wrapping?10000/* LG.MarginWrap */:2000/* LG.Margin */,halfMargin=margin>>1,doubleMargin=margin<<1;// The non-wrapping logic won't work at all in predominantly right-to-left text.
if(this.defaultTextDirection!=Direction.LTR&&!wrapping)return[];var gaps=[];var addGap=function addGap(from,to,line,structure){if(to-from<halfMargin)return;var sel=_this51.state.selection.main,avoid=[sel.from];if(!sel.empty)avoid.push(sel.to);for(var _i142=0,_avoid=avoid;_i142<_avoid.length;_i142++){var pos=_avoid[_i142];if(pos>from&&pos<to){addGap(from,pos-10/* LG.SelectionMargin */,line,structure);addGap(pos+10/* LG.SelectionMargin */,to,line,structure);return;}}var gap=find(current,function(gap){return gap.from>=line.from&&gap.to<=line.to&&Math.abs(gap.from-from)<halfMargin&&Math.abs(gap.to-to)<halfMargin&&!avoid.some(function(pos){return gap.from<pos&&gap.to>pos;});});if(!gap){// When scrolling down, snap gap ends to line starts to avoid shifts in wrapping
if(to<line.to&&mayMeasure&&wrapping&&mayMeasure.visibleRanges.some(function(r){return r.from<=to&&r.to>=to;})){var lineStart=mayMeasure.moveToLineBoundary(EditorSelection.cursor(to),false,true).head;if(lineStart>from)to=lineStart;}gap=new LineGap(from,to,_this51.gapSize(line,from,to,structure));}gaps.push(gap);};var _iterator61=_createForOfIteratorHelper(this.viewportLines),_step61;try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var line=_step61.value;if(line.length<doubleMargin)continue;var structure=lineStructure(line.from,line.to,this.stateDeco);if(structure.total<doubleMargin)continue;var target=this.scrollTarget?this.scrollTarget.range.head:null;var viewFrom=void 0,viewTo=void 0;if(wrapping){var marginHeight=margin/this.heightOracle.lineLength*this.heightOracle.lineHeight;var _top8=void 0,bot=void 0;if(target!=null){var targetFrac=findFraction(structure,target);var spaceFrac=((this.visibleBottom-this.visibleTop)/2+marginHeight)/line.height;_top8=targetFrac-spaceFrac;bot=targetFrac+spaceFrac;}else{_top8=(this.visibleTop-line.top-marginHeight)/line.height;bot=(this.visibleBottom-line.top+marginHeight)/line.height;}viewFrom=findPosition(structure,_top8);viewTo=findPosition(structure,bot);}else{var totalWidth=structure.total*this.heightOracle.charWidth;var marginWidth=margin*this.heightOracle.charWidth;var left=void 0,right=void 0;if(target!=null){var _targetFrac=findFraction(structure,target);var _spaceFrac=((this.pixelViewport.right-this.pixelViewport.left)/2+marginWidth)/totalWidth;left=_targetFrac-_spaceFrac;right=_targetFrac+_spaceFrac;}else{left=(this.pixelViewport.left-marginWidth)/totalWidth;right=(this.pixelViewport.right+marginWidth)/totalWidth;}viewFrom=findPosition(structure,left);viewTo=findPosition(structure,right);}if(viewFrom>line.from)addGap(line.from,viewFrom,line,structure);if(viewTo<line.to)addGap(viewTo,line.to,line,structure);}}catch(err){_iterator61.e(err);}finally{_iterator61.f();}return gaps;}},{key:"gapSize",value:function gapSize(line,from,to,structure){var fraction=findFraction(structure,to)-findFraction(structure,from);if(this.heightOracle.lineWrapping){return line.height*fraction;}else{return structure.total*this.heightOracle.charWidth*fraction;}}},{key:"updateLineGaps",value:function updateLineGaps(gaps){var _this52=this;if(!LineGap.same(gaps,this.lineGaps)){this.lineGaps=gaps;this.lineGapDeco=Decoration.set(gaps.map(function(gap){return gap.draw(_this52.heightOracle.lineWrapping);}));}}},{key:"computeVisibleRanges",value:function computeVisibleRanges(){var deco=this.stateDeco;if(this.lineGaps.length)deco=deco.concat(this.lineGapDeco);var ranges=[];RangeSet.spans(deco,this.viewport.from,this.viewport.to,{span:function span(from,to){ranges.push({from:from,to:to});},point:function point(){}},20);var changed=ranges.length!=this.visibleRanges.length||this.visibleRanges.some(function(r,i){return r.from!=ranges[i].from||r.to!=ranges[i].to;});this.visibleRanges=ranges;return changed?4/* UpdateFlag.Viewport */:0;}},{key:"lineBlockAt",value:function lineBlockAt(pos){return pos>=this.viewport.from&&pos<=this.viewport.to&&this.viewportLines.find(function(b){return b.from<=pos&&b.to>=pos;})||scaleBlock(this.heightMap.lineAt(pos,QueryType$1.ByPos,this.state.doc,0,0),this.scaler);}},{key:"lineBlockAtHeight",value:function lineBlockAtHeight(height){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(height),QueryType$1.ByHeight,this.state.doc,0,0),this.scaler);}},{key:"elementAtHeight",value:function elementAtHeight(height){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(height),this.state.doc,0,0),this.scaler);}},{key:"docHeight",get:function get(){return this.scaler.toDOM(this.heightMap.height);}},{key:"contentHeight",get:function get(){return this.docHeight+this.paddingTop+this.paddingBottom;}}]);return ViewState;}();var Viewport=/*#__PURE__*/_createClass(function Viewport(from,to){_classCallCheck(this,Viewport);this.from=from;this.to=to;});function lineStructure(from,to,stateDeco){var ranges=[],pos=from,total=0;RangeSet.spans(stateDeco,from,to,{span:function span(){},point:function point(from,to){if(from>pos){ranges.push({from:pos,to:from});total+=from-pos;}pos=to;}},20);// We're only interested in collapsed ranges of a significant size
if(pos<to){ranges.push({from:pos,to:to});total+=to-pos;}return{total:total,ranges:ranges};}function findPosition(_ref44,ratio){var total=_ref44.total,ranges=_ref44.ranges;if(ratio<=0)return ranges[0].from;if(ratio>=1)return ranges[ranges.length-1].to;var dist=Math.floor(total*ratio);for(var _i143=0;;_i143++){var _ranges$_i=ranges[_i143],from=_ranges$_i.from,to=_ranges$_i.to,_size2=to-from;if(dist<=_size2)return from+dist;dist-=_size2;}}function findFraction(structure,pos){var counted=0;var _iterator62=_createForOfIteratorHelper(structure.ranges),_step62;try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var _step62$value=_step62.value,from=_step62$value.from,to=_step62$value.to;if(pos<=to){counted+=pos-from;break;}counted+=to-from;}}catch(err){_iterator62.e(err);}finally{_iterator62.f();}return counted/structure.total;}function find(array,f){var _iterator63=_createForOfIteratorHelper(array),_step63;try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){var val=_step63.value;if(f(val))return val;}}catch(err){_iterator63.e(err);}finally{_iterator63.f();}return undefined;}// Don't scale when the document height is within the range of what
// the DOM can handle.
var IdScaler={toDOM:function toDOM(n){return n;},fromDOM:function fromDOM(n){return n;},scale:1};// When the height is too big (> VP.MaxDOMHeight), scale down the
// regions outside the viewports so that the total height is
// VP.MaxDOMHeight.
var BigScaler=/*#__PURE__*/function(){function BigScaler(doc,heightMap,viewports){_classCallCheck(this,BigScaler);var vpHeight=0,base=0,domBase=0;this.viewports=viewports.map(function(_ref45){var from=_ref45.from,to=_ref45.to;var top=heightMap.lineAt(from,QueryType$1.ByPos,doc,0,0).top;var bottom=heightMap.lineAt(to,QueryType$1.ByPos,doc,0,0).bottom;vpHeight+=bottom-top;return{from:from,to:to,top:top,bottom:bottom,domTop:0,domBottom:0};});this.scale=(7000000/* VP.MaxDOMHeight */-vpHeight)/(heightMap.height-vpHeight);var _iterator64=_createForOfIteratorHelper(this.viewports),_step64;try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var obj=_step64.value;obj.domTop=domBase+(obj.top-base)*this.scale;domBase=obj.domBottom=obj.domTop+(obj.bottom-obj.top);base=obj.bottom;}}catch(err){_iterator64.e(err);}finally{_iterator64.f();}}_createClass(BigScaler,[{key:"toDOM",value:function toDOM(n){for(var _i144=0,_base=0,domBase=0;;_i144++){var vp=_i144<this.viewports.length?this.viewports[_i144]:null;if(!vp||n<vp.top)return domBase+(n-_base)*this.scale;if(n<=vp.bottom)return vp.domTop+(n-vp.top);_base=vp.bottom;domBase=vp.domBottom;}}},{key:"fromDOM",value:function fromDOM(n){for(var _i145=0,_base2=0,domBase=0;;_i145++){var vp=_i145<this.viewports.length?this.viewports[_i145]:null;if(!vp||n<vp.domTop)return _base2+(n-domBase)/this.scale;if(n<=vp.domBottom)return vp.top+(n-vp.domTop);_base2=vp.bottom;domBase=vp.domBottom;}}}]);return BigScaler;}();function scaleBlock(block,scaler){if(scaler.scale==1)return block;var bTop=scaler.toDOM(block.top),bBottom=scaler.toDOM(block.bottom);return new BlockInfo(block.from,block.length,bTop,bBottom-bTop,Array.isArray(block.type)?block.type.map(function(b){return scaleBlock(b,scaler);}):block.type);}var _theme=/*@__PURE__*/Facet.define({combine:function combine(strs){return strs.join(" ");}});var darkTheme=/*@__PURE__*/Facet.define({combine:function combine(values){return values.indexOf(true)>-1;}});var baseThemeID=/*@__PURE__*/StyleModule.newName(),baseLightID=/*@__PURE__*/StyleModule.newName(),baseDarkID=/*@__PURE__*/StyleModule.newName();var lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(main,spec,scopes){return new StyleModule(spec,{finish:function finish(sel){return /&/.test(sel)?sel.replace(/&\w*/,function(m){if(m=="&")return main;if(!scopes||!scopes[m])throw new RangeError("Unsupported selector: ".concat(m));return scopes[m];}):main+" "+sel;}});}var baseTheme$1$3=/*@__PURE__*/buildTheme("."+baseThemeID,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{// Provide a simple default outline to make sure a focused
// editor is visually distinct. Can't leave the default behavior
// because that will apply to the content element, which is
// inside the scrollable container and doesn't include the
// gutters. We also can't use an 'auto' outline, since those
// are, for some reason, drawn behind the element content, which
// will cause things like the active line background to cover
// the outline (#297).
outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},// Two animations defined so that we can switch between them to
// restart the animation without forcing another style
// recomputation.
"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);var DOMChange=/*#__PURE__*/_createClass(function DOMChange(view,start,end,typeOver){_classCallCheck(this,DOMChange);this.typeOver=typeOver;this.bounds=null;this.text="";var _view$docView=view.docView,iHead=_view$docView.impreciseHead,iAnchor=_view$docView.impreciseAnchor;if(start>-1&&!view.state.readOnly&&(this.bounds=view.docView.domBoundsAround(start,end,0))){var selPoints=iHead||iAnchor?[]:selectionPoints(view);var reader=new DOMReader(selPoints,view.state);reader.readRange(this.bounds.startDOM,this.bounds.endDOM);this.text=reader.text;this.newSel=selectionFromPoints(selPoints,this.bounds.from);}else{var domSel=view.observer.selectionRange;var _head2=iHead&&iHead.node==domSel.focusNode&&iHead.offset==domSel.focusOffset||!contains(view.contentDOM,domSel.focusNode)?view.state.selection.main.head:view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset);var anchor=iAnchor&&iAnchor.node==domSel.anchorNode&&iAnchor.offset==domSel.anchorOffset||!contains(view.contentDOM,domSel.anchorNode)?view.state.selection.main.anchor:view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);this.newSel=EditorSelection.single(anchor,_head2);}});function applyDOMChange(view,domChange){var change;var newSel=domChange.newSel,sel=view.state.selection.main;if(domChange.bounds){var _domChange$bounds=domChange.bounds,from=_domChange$bounds.from,to=_domChange$bounds.to;var preferredPos=sel.from,preferredSide=null;// Prefer anchoring to end when Backspace is pressed (or, on
// Android, when something was deleted)
if(view.inputState.lastKeyCode===8&&view.inputState.lastKeyTime>Date.now()-100||browser.android&&domChange.text.length<to-from){preferredPos=sel.to;preferredSide="end";}var diff=findDiff(view.state.doc.sliceString(from,to,LineBreakPlaceholder),domChange.text,preferredPos-from,preferredSide);if(diff){// Chrome inserts two newlines when pressing shift-enter at the
// end of a line. DomChange drops one of those.
if(browser.chrome&&view.inputState.lastKeyCode==13&&diff.toB==diff.from+2&&domChange.text.slice(diff.from,diff.toB)==LineBreakPlaceholder+LineBreakPlaceholder)diff.toB--;change={from:from+diff.from,to:from+diff.toA,insert:Text.of(domChange.text.slice(diff.from,diff.toB).split(LineBreakPlaceholder))};}}else if(newSel&&(!view.hasFocus||!view.state.facet(editable)||newSel.main.eq(sel))){newSel=null;}if(!change&&!newSel)return false;if(!change&&domChange.typeOver&&!sel.empty&&newSel&&newSel.main.empty){// Heuristic to notice typing over a selected character
change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,sel.to)};}else if(change&&change.from>=sel.from&&change.to<=sel.to&&(change.from!=sel.from||change.to!=sel.to)&&sel.to-sel.from-(change.to-change.from)<=4){// If the change is inside the selection and covers most of it,
// assume it is a selection replace (with identical characters at
// the start/end not included in the diff)
change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,change.from).append(change.insert).append(view.state.doc.slice(change.to,sel.to))};}else if((browser.mac||browser.android)&&change&&change.from==change.to&&change.from==sel.head-1&&/^\. ?$/.test(change.insert.toString())){// Detect insert-period-on-double-space Mac and Android behavior,
// and transform it into a regular space insert.
if(newSel&&change.insert.length==2)newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1);change={from:sel.from,to:sel.to,insert:Text.of([" "])};}if(change){var startState=view.state;if(browser.ios&&view.inputState.flushIOSKey(view))return true;// Android browsers don't fire reasonable key events for enter,
// backspace, or delete. So this detects changes that look like
// they're caused by those keys, and reinterprets them as key
// events. (Some of these keys are also handled by beforeinput
// events and the pendingAndroidKey mechanism, but that's not
// reliable in all situations.)
if(browser.android&&(change.from==sel.from&&change.to==sel.to&&change.insert.length==1&&change.insert.lines==2&&dispatchKey(view.contentDOM,"Enter",13)||change.from==sel.from-1&&change.to==sel.to&&change.insert.length==0&&dispatchKey(view.contentDOM,"Backspace",8)||change.from==sel.from&&change.to==sel.to+1&&change.insert.length==0&&dispatchKey(view.contentDOM,"Delete",46)))return true;var _text4=change.insert.toString();if(view.state.facet(inputHandler$1).some(function(h){return h(view,change.from,change.to,_text4);}))return true;if(view.inputState.composing>=0)view.inputState.composing++;var tr;if(change.from>=sel.from&&change.to<=sel.to&&change.to-change.from>=(sel.to-sel.from)/3&&(!newSel||newSel.main.empty&&newSel.main.from==change.from+change.insert.length)&&view.inputState.composing<0){var _before2=sel.from<change.from?startState.sliceDoc(sel.from,change.from):"";var _after4=sel.to>change.to?startState.sliceDoc(change.to,sel.to):"";tr=startState.replaceSelection(view.state.toText(_before2+change.insert.sliceString(0,undefined,view.state.lineBreak)+_after4));}else{var changes=startState.changes(change);var mainSel=newSel&&!startState.selection.main.eq(newSel.main)&&newSel.main.to<=changes.newLength?newSel.main:undefined;// Try to apply a composition change to all cursors
if(startState.selection.ranges.length>1&&view.inputState.composing>=0&&change.to<=sel.to&&change.to>=sel.to-10){var replaced=view.state.sliceDoc(change.from,change.to);var compositionRange=compositionSurroundingNode(view)||view.state.doc.lineAt(sel.head);var offset=sel.to-change.to,_size3=sel.to-sel.from;tr=startState.changeByRange(function(range){if(range.from==sel.from&&range.to==sel.to)return{changes:changes,range:mainSel||range.map(changes)};var to=range.to-offset,from=to-replaced.length;if(range.to-range.from!=_size3||view.state.sliceDoc(from,to)!=replaced||// Unfortunately, there's no way to make multiple
// changes in the same node work without aborting
// composition, so cursors in the composition range are
// ignored.
compositionRange&&range.to>=compositionRange.from&&range.from<=compositionRange.to)return{range:range};var rangeChanges=startState.changes({from:from,to:to,insert:change.insert}),selOff=range.to-sel.to;return{changes:rangeChanges,range:!mainSel?range.map(rangeChanges):EditorSelection.range(Math.max(0,mainSel.anchor+selOff),Math.max(0,mainSel.head+selOff))};});}else{tr={changes:changes,selection:mainSel&&startState.selection.replaceRange(mainSel)};}}var userEvent="input.type";if(view.composing){userEvent+=".compose";if(view.inputState.compositionFirstChange){userEvent+=".start";view.inputState.compositionFirstChange=false;}}view.dispatch(tr,{scrollIntoView:true,userEvent:userEvent});return true;}else if(newSel&&!newSel.main.eq(sel)){var _scrollIntoView=false,_userEvent="select";if(view.inputState.lastSelectionTime>Date.now()-50){if(view.inputState.lastSelectionOrigin=="select")_scrollIntoView=true;_userEvent=view.inputState.lastSelectionOrigin;}view.dispatch({selection:newSel,scrollIntoView:_scrollIntoView,userEvent:_userEvent});return true;}else{return false;}}function findDiff(a,b,preferredPos,preferredSide){var minLen=Math.min(a.length,b.length);var from=0;while(from<minLen&&a.charCodeAt(from)==b.charCodeAt(from)){from++;}if(from==minLen&&a.length==b.length)return null;var toA=a.length,toB=b.length;while(toA>0&&toB>0&&a.charCodeAt(toA-1)==b.charCodeAt(toB-1)){toA--;toB--;}if(preferredSide=="end"){var adjust=Math.max(0,from-Math.min(toA,toB));preferredPos-=toA+adjust-from;}if(toA<from&&a.length<b.length){var move=preferredPos<=from&&preferredPos>=toA?from-preferredPos:0;from-=move;toB=from+(toB-toA);toA=from;}else if(toB<from){var _move=preferredPos<=from&&preferredPos>=toB?from-preferredPos:0;from-=_move;toA=from+(toA-toB);toB=from;}return{from:from,toA:toA,toB:toB};}function selectionPoints(view){var result=[];if(view.root.activeElement!=view.contentDOM)return result;var _view$observer$select=view.observer.selectionRange,anchorNode=_view$observer$select.anchorNode,anchorOffset=_view$observer$select.anchorOffset,focusNode=_view$observer$select.focusNode,focusOffset=_view$observer$select.focusOffset;if(anchorNode){result.push(new DOMPoint(anchorNode,anchorOffset));if(focusNode!=anchorNode||focusOffset!=anchorOffset)result.push(new DOMPoint(focusNode,focusOffset));}return result;}function selectionFromPoints(points,base){if(points.length==0)return null;var anchor=points[0].pos,head=points.length==2?points[1].pos:anchor;return anchor>-1&&head>-1?EditorSelection.single(anchor+base,head+base):null;}var observeOptions={childList:true,characterData:true,subtree:true,attributes:true,characterDataOldValue:true};// IE11 has very broken mutation observers, so we also listen to
// DOMCharacterDataModified there
var useCharData=browser.ie&&browser.ie_version<=11;var DOMObserver=/*#__PURE__*/function(){function DOMObserver(view){var _this53=this;_classCallCheck(this,DOMObserver);this.view=view;this.active=false;// The known selection. Kept in our own object, as opposed to just
// directly accessing the selection because:
//  - Safari doesn't report the right selection in shadow DOM
//  - Reading from the selection forces a DOM layout
//  - This way, we can ignore selectionchange events if we have
//    already seen the 'new' selection
this.selectionRange=new DOMSelectionState();// Set when a selection change is detected, cleared on flush
this.selectionChanged=false;this.delayedFlush=-1;this.resizeTimeout=-1;this.queue=[];this.delayedAndroidKey=null;this.flushingAndroidKey=-1;this.lastChange=0;this.scrollTargets=[];this.intersection=null;this.resize=null;this.intersecting=false;this.gapIntersection=null;this.gaps=[];// Timeout for scheduling check of the parents that need scroll handlers
this.parentCheck=-1;this.dom=view.contentDOM;this.observer=new MutationObserver(function(mutations){var _iterator65=_createForOfIteratorHelper(mutations),_step65;try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var mut=_step65.value;_this53.queue.push(mut);}// IE11 will sometimes (on typing over a selection or
// backspacing out a single character text node) call the
// observer callback before actually updating the DOM.
//
// Unrelatedly, iOS Safari will, when ending a composition,
// sometimes first clear it, deliver the mutations, and then
// reinsert the finished text. CodeMirror's handling of the
// deletion will prevent the reinsertion from happening,
// breaking composition.
}catch(err){_iterator65.e(err);}finally{_iterator65.f();}if((browser.ie&&browser.ie_version<=11||browser.ios&&view.composing)&&mutations.some(function(m){return m.type=="childList"&&m.removedNodes.length||m.type=="characterData"&&m.oldValue.length>m.target.nodeValue.length;}))_this53.flushSoon();else _this53.flush();});if(useCharData)this.onCharData=function(event){_this53.queue.push({target:event.target,type:"characterData",oldValue:event.prevValue});_this53.flushSoon();};this.onSelectionChange=this.onSelectionChange.bind(this);this.onResize=this.onResize.bind(this);this.onPrint=this.onPrint.bind(this);this.onScroll=this.onScroll.bind(this);if(typeof ResizeObserver=="function"){this.resize=new ResizeObserver(function(){if(_this53.view.docView.lastUpdate<Date.now()-75)_this53.onResize();});this.resize.observe(view.scrollDOM);}this.addWindowListeners(this.win=view.win);this.start();if(typeof IntersectionObserver=="function"){this.intersection=new IntersectionObserver(function(entries){if(_this53.parentCheck<0)_this53.parentCheck=setTimeout(_this53.listenForScroll.bind(_this53),1000);if(entries.length>0&&entries[entries.length-1].intersectionRatio>0!=_this53.intersecting){_this53.intersecting=!_this53.intersecting;if(_this53.intersecting!=_this53.view.inView)_this53.onScrollChanged(document.createEvent("Event"));}},{});this.intersection.observe(this.dom);this.gapIntersection=new IntersectionObserver(function(entries){if(entries.length>0&&entries[entries.length-1].intersectionRatio>0)_this53.onScrollChanged(document.createEvent("Event"));},{});}this.listenForScroll();this.readSelectionRange();}_createClass(DOMObserver,[{key:"onScrollChanged",value:function onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e);if(this.intersecting)this.view.measure();}},{key:"onScroll",value:function onScroll(e){if(this.intersecting)this.flush(false);this.onScrollChanged(e);}},{key:"onResize",value:function onResize(){var _this54=this;if(this.resizeTimeout<0)this.resizeTimeout=setTimeout(function(){_this54.resizeTimeout=-1;_this54.view.requestMeasure();},50);}},{key:"onPrint",value:function onPrint(){var _this55=this;this.view.viewState.printing=true;this.view.measure();setTimeout(function(){_this55.view.viewState.printing=false;_this55.view.requestMeasure();},500);}},{key:"updateGaps",value:function updateGaps(gaps){if(this.gapIntersection&&(gaps.length!=this.gaps.length||this.gaps.some(function(g,i){return g!=gaps[i];}))){this.gapIntersection.disconnect();var _iterator66=_createForOfIteratorHelper(gaps),_step66;try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var gap=_step66.value;this.gapIntersection.observe(gap);}}catch(err){_iterator66.e(err);}finally{_iterator66.f();}this.gaps=gaps;}}},{key:"onSelectionChange",value:function onSelectionChange(event){var wasChanged=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;var view=this.view,sel=this.selectionRange;if(view.state.facet(editable)?view.root.activeElement!=this.dom:!hasSelection(view.dom,sel))return;var context=sel.anchorNode&&view.docView.nearest(sel.anchorNode);if(context&&context.ignoreEvent(event)){if(!wasChanged)this.selectionChanged=false;return;}// Deletions on IE11 fire their events in the wrong order, giving
// us a selection change event before the DOM changes are
// reported.
// Chrome Android has a similar issue when backspacing out a
// selection (#645).
if((browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!view.state.selection.main.empty&&// (Selection.isCollapsed isn't reliable on IE)
sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))this.flushSoon();else this.flush(false);}},{key:"readSelectionRange",value:function readSelectionRange(){var view=this.view;// The Selection object is broken in shadow roots in Safari. See
// https://github.com/codemirror/dev/issues/414
var range=browser.safari&&view.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(view.root);if(!range||this.selectionRange.eq(range))return false;var local=hasSelection(this.dom,range);// Detect the situation where the browser has, on focus, moved the
// selection to the start of the content element. Reset it to the
// position from the editor state.
if(local&&!this.selectionChanged&&view.inputState.lastFocusTime>Date.now()-200&&view.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,range)){this.view.inputState.lastFocusTime=0;view.docView.updateSelection();return false;}this.selectionRange.setRange(range);if(local)this.selectionChanged=true;return true;}},{key:"setSelectionRange",value:function setSelectionRange(anchor,head){this.selectionRange.set(anchor.node,anchor.offset,head.node,head.offset);this.selectionChanged=false;}},{key:"clearSelectionRange",value:function clearSelectionRange(){this.selectionRange.set(null,0,null,0);}},{key:"listenForScroll",value:function listenForScroll(){this.parentCheck=-1;var i=0,changed=null;for(var dom=this.dom;dom;){if(dom.nodeType==1){if(!changed&&i<this.scrollTargets.length&&this.scrollTargets[i]==dom)i++;else if(!changed)changed=this.scrollTargets.slice(0,i);if(changed)changed.push(dom);dom=dom.assignedSlot||dom.parentNode;}else if(dom.nodeType==11){// Shadow root
dom=dom.host;}else{break;}}if(i<this.scrollTargets.length&&!changed)changed=this.scrollTargets.slice(0,i);if(changed){var _iterator67=_createForOfIteratorHelper(this.scrollTargets),_step67;try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var _dom2=_step67.value;_dom2.removeEventListener("scroll",this.onScroll);}}catch(err){_iterator67.e(err);}finally{_iterator67.f();}var _iterator68=_createForOfIteratorHelper(this.scrollTargets=changed),_step68;try{for(_iterator68.s();!(_step68=_iterator68.n()).done;){var _dom3=_step68.value;_dom3.addEventListener("scroll",this.onScroll);}}catch(err){_iterator68.e(err);}finally{_iterator68.f();}}}},{key:"ignore",value:function ignore(f){if(!this.active)return f();try{this.stop();return f();}finally{this.start();this.clear();}}},{key:"start",value:function start(){if(this.active)return;this.observer.observe(this.dom,observeOptions);if(useCharData)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=true;}},{key:"stop",value:function stop(){if(!this.active)return;this.active=false;this.observer.disconnect();if(useCharData)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData);}// Throw away any pending changes
},{key:"clear",value:function clear(){this.processRecords();this.queue.length=0;this.selectionChanged=false;}// Chrome Android, especially in combination with GBoard, not only
// doesn't reliably fire regular key events, but also often
// surrounds the effect of enter or backspace with a bunch of
// composition events that, when interrupted, cause text duplication
// or other kinds of corruption. This hack makes the editor back off
// from handling DOM changes for a moment when such a key is
// detected (via beforeinput or keydown), and then tries to flush
// them or, if that has no effect, dispatches the given key.
},{key:"delayAndroidKey",value:function delayAndroidKey(key,keyCode){var _this56=this;var _a;if(!this.delayedAndroidKey){var _flush=function _flush(){var key=_this56.delayedAndroidKey;if(key){_this56.clearDelayedAndroidKey();if(!_this56.flush()&&key.force)dispatchKey(_this56.dom,key.key,key.keyCode);}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(_flush);}// Since backspace beforeinput is sometimes signalled spuriously,
// Enter always takes precedence.
if(!this.delayedAndroidKey||key=="Enter")this.delayedAndroidKey={key:key,keyCode:keyCode,// Only run the key handler when no changes are detected if
// this isn't coming right after another change, in which case
// it is probably part of a weird chain of updates, and should
// be ignored if it returns the DOM to its previous state.
force:this.lastChange<Date.now()-50||!!((_a=this.delayedAndroidKey)===null||_a===void 0?void 0:_a.force)};}},{key:"clearDelayedAndroidKey",value:function clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey);this.delayedAndroidKey=null;this.flushingAndroidKey=-1;}},{key:"flushSoon",value:function flushSoon(){var _this57=this;if(this.delayedFlush<0)this.delayedFlush=this.view.win.requestAnimationFrame(function(){_this57.delayedFlush=-1;_this57.flush();});}},{key:"forceFlush",value:function forceFlush(){if(this.delayedFlush>=0){this.view.win.cancelAnimationFrame(this.delayedFlush);this.delayedFlush=-1;}this.flush();}},{key:"processRecords",value:function processRecords(){var records=this.queue;var _iterator69=_createForOfIteratorHelper(this.observer.takeRecords()),_step69;try{for(_iterator69.s();!(_step69=_iterator69.n()).done;){var mut=_step69.value;records.push(mut);}}catch(err){_iterator69.e(err);}finally{_iterator69.f();}if(records.length)this.queue=[];var from=-1,to=-1,typeOver=false;var _iterator70=_createForOfIteratorHelper(records),_step70;try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var record=_step70.value;var _range10=this.readMutation(record);if(!_range10)continue;if(_range10.typeOver)typeOver=true;if(from==-1){from=_range10.from;to=_range10.to;}else{from=Math.min(_range10.from,from);to=Math.max(_range10.to,to);}}}catch(err){_iterator70.e(err);}finally{_iterator70.f();}return{from:from,to:to,typeOver:typeOver};}},{key:"readChange",value:function readChange(){var _this$processRecords=this.processRecords(),from=_this$processRecords.from,to=_this$processRecords.to,typeOver=_this$processRecords.typeOver;var newSel=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(from<0&&!newSel)return null;if(from>-1)this.lastChange=Date.now();this.view.inputState.lastFocusTime=0;this.selectionChanged=false;return new DOMChange(this.view,from,to,typeOver);}// Apply pending changes, if any
},{key:"flush",value:function flush(){var readSelection=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;// Completely hold off flushing when pending keys are setthe code
// managing those will make sure processRecords is called and the
// view is resynchronized after
if(this.delayedFlush>=0||this.delayedAndroidKey)return false;if(readSelection)this.readSelectionRange();var domChange=this.readChange();if(!domChange)return false;var startState=this.view.state;var handled=applyDOMChange(this.view,domChange);// The view wasn't updated
if(this.view.state==startState)this.view.update([]);return handled;}},{key:"readMutation",value:function readMutation(rec){var cView=this.view.docView.nearest(rec.target);if(!cView||cView.ignoreMutation(rec))return null;cView.markDirty(rec.type=="attributes");if(rec.type=="attributes")cView.dirty|=4/* Dirty.Attrs */;if(rec.type=="childList"){var childBefore=findChild(cView,rec.previousSibling||rec.target.previousSibling,-1);var childAfter=findChild(cView,rec.nextSibling||rec.target.nextSibling,1);return{from:childBefore?cView.posAfter(childBefore):cView.posAtStart,to:childAfter?cView.posBefore(childAfter):cView.posAtEnd,typeOver:false};}else if(rec.type=="characterData"){return{from:cView.posAtStart,to:cView.posAtEnd,typeOver:rec.target.nodeValue==rec.oldValue};}else{return null;}}},{key:"setWindow",value:function setWindow(win){if(win!=this.win){this.removeWindowListeners(this.win);this.win=win;this.addWindowListeners(this.win);}}},{key:"addWindowListeners",value:function addWindowListeners(win){win.addEventListener("resize",this.onResize);win.addEventListener("beforeprint",this.onPrint);win.addEventListener("scroll",this.onScroll);win.document.addEventListener("selectionchange",this.onSelectionChange);}},{key:"removeWindowListeners",value:function removeWindowListeners(win){win.removeEventListener("scroll",this.onScroll);win.removeEventListener("resize",this.onResize);win.removeEventListener("beforeprint",this.onPrint);win.document.removeEventListener("selectionchange",this.onSelectionChange);}},{key:"destroy",value:function destroy(){var _a,_b,_c;this.stop();(_a=this.intersection)===null||_a===void 0?void 0:_a.disconnect();(_b=this.gapIntersection)===null||_b===void 0?void 0:_b.disconnect();(_c=this.resize)===null||_c===void 0?void 0:_c.disconnect();var _iterator71=_createForOfIteratorHelper(this.scrollTargets),_step71;try{for(_iterator71.s();!(_step71=_iterator71.n()).done;){var dom=_step71.value;dom.removeEventListener("scroll",this.onScroll);}}catch(err){_iterator71.e(err);}finally{_iterator71.f();}this.removeWindowListeners(this.win);clearTimeout(this.parentCheck);clearTimeout(this.resizeTimeout);this.win.cancelAnimationFrame(this.delayedFlush);this.win.cancelAnimationFrame(this.flushingAndroidKey);}}]);return DOMObserver;}();function findChild(cView,dom,dir){while(dom){var curView=ContentView.get(dom);if(curView&&curView.parent==cView)return curView;var _parent10=dom.parentNode;dom=_parent10!=cView.dom?_parent10:dir>0?dom.nextSibling:dom.previousSibling;}return null;}// Used to work around a Safari Selection/shadow DOM bug (#414)
function safariSelectionRangeHack(view){var found=null;// Because Safari (at least in 2018-2021) doesn't provide regular
// access to the selection inside a shadowroot, we have to perform a
// ridiculous hack to get at itusing `execCommand` to trigger a
// `beforeInput` event so that we can read the target range from the
// event.
function read(event){event.preventDefault();event.stopImmediatePropagation();found=event.getTargetRanges()[0];}view.contentDOM.addEventListener("beforeinput",read,true);view.dom.ownerDocument.execCommand("indent");view.contentDOM.removeEventListener("beforeinput",read,true);if(!found)return null;var anchorNode=found.startContainer,anchorOffset=found.startOffset;var focusNode=found.endContainer,focusOffset=found.endOffset;var curAnchor=view.docView.domAtPos(view.state.selection.main.anchor);// Since such a range doesn't distinguish between anchor and head,
// use a heuristic that flips it around if its end matches the
// current anchor.
if(isEquivalentPosition(curAnchor.node,curAnchor.offset,focusNode,focusOffset)){var _ref46=[focusNode,focusOffset,anchorNode,anchorOffset];anchorNode=_ref46[0];anchorOffset=_ref46[1];focusNode=_ref46[2];focusOffset=_ref46[3];}return{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset};}// The editor's update state machine looks something like this:
//
//     Idle  Updating  Idle (unchecked)  Measuring  Idle
//                                               
//                                         Updating (measure)
//
// The difference between 'Idle' and 'Idle (unchecked)' lies in
// whether a layout check has been scheduled. A regular update through
// the `update` method updates the DOM in a write-only fashion, and
// relies on a check (scheduled with `requestAnimationFrame`) to make
// sure everything is where it should be and the viewport covers the
// visible code. That check continues to measure and then optionally
// update until it reaches a coherent state.
/**
An editor view represents the editor's user interface. It holds
the editable DOM surface, and possibly other elements such as the
line number gutter. It handles events and dispatches state
transactions for editing actions.
*/var EditorView=/*#__PURE__*/function(){/**
    Construct a new view. You'll want to either provide a `parent`
    option, or put `view.dom` into your document after creating a
    view, so that the user can see the editor.
    */function EditorView(){var _this58=this;var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EditorView);this.plugins=[];this.pluginMap=new Map();this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.destroyed=false;/**
        @internal
        */this.updateState=2/* UpdateState.Updating */;/**
        @internal
        */this.measureScheduled=-1;/**
        @internal
        */this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);this.announceDOM=document.createElement("div");this.announceDOM.style.cssText="position: absolute; top: -10000px";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);this._dispatch=config.dispatch||function(tr){return _this58.update([tr]);};this.dispatch=this.dispatch.bind(this);this._root=config.root||getRoot(config.parent)||document;this.viewState=new ViewState(config.state||EditorState.create(config));this.plugins=this.state.facet(viewPlugin).map(function(spec){return new PluginInstance(spec);});var _iterator72=_createForOfIteratorHelper(this.plugins),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var plugin=_step72.value;plugin.update(this);}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}this.observer=new DOMObserver(this);this.inputState=new InputState(this);this.inputState.ensureHandlers(this,this.plugins);this.docView=new DocView(this);this.mountStyles();this.updateAttrs();this.updateState=0/* UpdateState.Idle */;this.requestMeasure();if(config.parent)config.parent.appendChild(this.dom);}/**
    The current editor state.
    */_createClass(EditorView,[{key:"state",get:function get(){return this.viewState.state;}/**
    To be able to display large documents without consuming too much
    memory or overloading the browser, CodeMirror only draws the
    code that is visible (plus a margin around it) to the DOM. This
    property tells you the extent of the current drawn viewport, in
    document positions.
    */},{key:"viewport",get:function get(){return this.viewState.viewport;}/**
    When there are, for example, large collapsed ranges in the
    viewport, its size can be a lot bigger than the actual visible
    content. Thus, if you are doing something like styling the
    content in the viewport, it is preferable to only do so for
    these ranges, which are the subset of the viewport that is
    actually drawn.
    */},{key:"visibleRanges",get:function get(){return this.viewState.visibleRanges;}/**
    Returns false when the editor is entirely scrolled out of view
    or otherwise hidden.
    */},{key:"inView",get:function get(){return this.viewState.inView;}/**
    Indicates whether the user is currently composing text via
    [IME](https://en.wikipedia.org/wiki/Input_method), and at least
    one change has been made in the current composition.
    */},{key:"composing",get:function get(){return this.inputState.composing>0;}/**
    Indicates whether the user is currently in composing state. Note
    that on some platforms, like Android, this will be the case a
    lot, since just putting the cursor on a word starts a
    composition there.
    */},{key:"compositionStarted",get:function get(){return this.inputState.composing>=0;}/**
    The document or shadow root that the view lives in.
    */},{key:"root",get:function get(){return this._root;}/**
    @internal
    */},{key:"win",get:function get(){return this.dom.ownerDocument.defaultView||window;}},{key:"dispatch",value:function dispatch(){var _this$state;this._dispatch(arguments.length==1&&(arguments.length<=0?undefined:arguments[0])instanceof Transaction?arguments.length<=0?undefined:arguments[0]:(_this$state=this.state).update.apply(_this$state,arguments));}/**
    Update the view for the given array of transactions. This will
    update the visible document and selection to match the state
    produced by the transactions, and notify view plugins of the
    change. You should usually call
    [`dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch) instead, which uses this
    as a primitive.
    */},{key:"update",value:function update(transactions){if(this.updateState!=0/* UpdateState.Idle */)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");var redrawn=false,attrsChanged=false,update;var state=this.state;var _iterator73=_createForOfIteratorHelper(transactions),_step73;try{for(_iterator73.s();!(_step73=_iterator73.n()).done;){var _tr=_step73.value;if(_tr.startState!=state)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");state=_tr.state;}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}if(this.destroyed){this.viewState.state=state;return;}// If there was a pending DOM change, eagerly read it and try to
// apply it after the given transactions.
var pendingKey=this.observer.delayedAndroidKey,domChange=null;if(pendingKey){this.observer.clearDelayedAndroidKey();domChange=this.observer.readChange();// Only try to apply DOM changes if the transactions didn't
// change the doc or selection.
if(domChange&&!this.state.doc.eq(state.doc)||!this.state.selection.eq(state.selection))domChange=null;}else{this.observer.clear();}// When the phrases change, redraw the editor
if(state.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(state);update=ViewUpdate.create(this,state,transactions);var scrollTarget=this.viewState.scrollTarget;try{this.updateState=2/* UpdateState.Updating */;var _iterator74=_createForOfIteratorHelper(transactions),_step74;try{for(_iterator74.s();!(_step74=_iterator74.n()).done;){var tr=_step74.value;if(scrollTarget)scrollTarget=scrollTarget.map(tr.changes);if(tr.scrollIntoView){var main=tr.state.selection.main;scrollTarget=new ScrollTarget(main.empty?main:EditorSelection.cursor(main.head,main.head>main.anchor?-1:1));}var _iterator75=_createForOfIteratorHelper(tr.effects),_step75;try{for(_iterator75.s();!(_step75=_iterator75.n()).done;){var e=_step75.value;if(e.is(scrollIntoView$1))scrollTarget=e.value;}}catch(err){_iterator75.e(err);}finally{_iterator75.f();}}}catch(err){_iterator74.e(err);}finally{_iterator74.f();}this.viewState.update(update,scrollTarget);this.bidiCache=CachedOrder.update(this.bidiCache,update.changes);if(!update.empty){this.updatePlugins(update);this.inputState.update(update);}redrawn=this.docView.update(update);if(this.state.facet(styleModule)!=this.styleModules)this.mountStyles();attrsChanged=this.updateAttrs();this.showAnnouncements(transactions);this.docView.updateSelection(redrawn,transactions.some(function(tr){return tr.isUserEvent("select.pointer");}));}finally{this.updateState=0/* UpdateState.Idle */;}if(update.startState.facet(_theme)!=update.state.facet(_theme))this.viewState.mustMeasureContent=true;if(redrawn||attrsChanged||scrollTarget||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if(!update.empty){var _iterator76=_createForOfIteratorHelper(this.state.facet(updateListener)),_step76;try{for(_iterator76.s();!(_step76=_iterator76.n()).done;){var listener=_step76.value;listener(update);}}catch(err){_iterator76.e(err);}finally{_iterator76.f();}}if(domChange){if(!applyDOMChange(this,domChange)&&pendingKey.force)dispatchKey(this.contentDOM,pendingKey.key,pendingKey.keyCode);}}/**
    Reset the view to the given state. (This will cause the entire
    document to be redrawn and all view plugins to be reinitialized,
    so you should probably only use it when the new state isn't
    derived from the old state. Otherwise, use
    [`dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch) instead.)
    */},{key:"setState",value:function setState(newState){if(this.updateState!=0/* UpdateState.Idle */)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=newState;return;}this.updateState=2/* UpdateState.Updating */;var hadFocus=this.hasFocus;try{var _iterator77=_createForOfIteratorHelper(this.plugins),_step77;try{for(_iterator77.s();!(_step77=_iterator77.n()).done;){var plugin=_step77.value;plugin.destroy(this);}}catch(err){_iterator77.e(err);}finally{_iterator77.f();}this.viewState=new ViewState(newState);this.plugins=newState.facet(viewPlugin).map(function(spec){return new PluginInstance(spec);});this.pluginMap.clear();var _iterator78=_createForOfIteratorHelper(this.plugins),_step78;try{for(_iterator78.s();!(_step78=_iterator78.n()).done;){var _plugin3=_step78.value;_plugin3.update(this);}}catch(err){_iterator78.e(err);}finally{_iterator78.f();}this.docView=new DocView(this);this.inputState.ensureHandlers(this,this.plugins);this.mountStyles();this.updateAttrs();this.bidiCache=[];}finally{this.updateState=0/* UpdateState.Idle */;}if(hadFocus)this.focus();this.requestMeasure();}},{key:"updatePlugins",value:function updatePlugins(update){var prevSpecs=update.startState.facet(viewPlugin),specs=update.state.facet(viewPlugin);if(prevSpecs!=specs){var newPlugins=[];var _iterator79=_createForOfIteratorHelper(specs),_step79;try{for(_iterator79.s();!(_step79=_iterator79.n()).done;){var spec=_step79.value;var found=prevSpecs.indexOf(spec);if(found<0){newPlugins.push(new PluginInstance(spec));}else{var plugin=this.plugins[found];plugin.mustUpdate=update;newPlugins.push(plugin);}}}catch(err){_iterator79.e(err);}finally{_iterator79.f();}var _iterator80=_createForOfIteratorHelper(this.plugins),_step80;try{for(_iterator80.s();!(_step80=_iterator80.n()).done;){var _plugin4=_step80.value;if(_plugin4.mustUpdate!=update)_plugin4.destroy(this);}}catch(err){_iterator80.e(err);}finally{_iterator80.f();}this.plugins=newPlugins;this.pluginMap.clear();this.inputState.ensureHandlers(this,this.plugins);}else{var _iterator81=_createForOfIteratorHelper(this.plugins),_step81;try{for(_iterator81.s();!(_step81=_iterator81.n()).done;){var _p=_step81.value;_p.mustUpdate=update;}}catch(err){_iterator81.e(err);}finally{_iterator81.f();}}for(var _i146=0;_i146<this.plugins.length;_i146++){this.plugins[_i146].update(this);}}/**
    @internal
    */},{key:"measure",value:function measure(){var _this59=this;var flush=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this.destroyed)return;if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled);this.measureScheduled=0;// Prevent requestMeasure calls from scheduling another animation frame
if(flush)this.observer.forceFlush();var updated=null;var _this$scrollDOM=this.scrollDOM,scrollHeight=_this$scrollDOM.scrollHeight,scrollTop=_this$scrollDOM.scrollTop,clientHeight=_this$scrollDOM.clientHeight;var refHeight=scrollTop>scrollHeight-clientHeight-4?scrollHeight:scrollTop;try{for(var _i147=0;;_i147++){this.updateState=1/* UpdateState.Measuring */;var oldViewport=this.viewport;var refBlock=this.viewState.lineBlockAtHeight(refHeight);var changed=this.viewState.measure(this);if(!changed&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(_i147>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break;}var measuring=[];// Only run measure requests in this cycle when the viewport didn't change
if(!(changed&4/* UpdateFlag.Viewport */)){var _ref47=[measuring,this.measureRequests];this.measureRequests=_ref47[0];measuring=_ref47[1];}var measured=measuring.map(function(m){try{return m.read(_this59);}catch(e){logException(_this59.state,e);return BadMeasure;}});var _update7=ViewUpdate.create(this,this.state,[]),redrawn=false,scrolled=false;_update7.flags|=changed;if(!updated)updated=_update7;else updated.flags|=changed;this.updateState=2/* UpdateState.Updating */;if(!_update7.empty){this.updatePlugins(_update7);this.inputState.update(_update7);this.updateAttrs();redrawn=this.docView.update(_update7);}for(var _i148=0;_i148<measuring.length;_i148++){if(measured[_i148]!=BadMeasure){try{var m=measuring[_i148];if(m.write)m.write(measured[_i148],this);}catch(e){logException(this.state,e);}}}if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget);this.viewState.scrollTarget=null;scrolled=true;}else{var diff=this.viewState.lineBlockAt(refBlock.from).top-refBlock.top;if(diff>1||diff<-1){this.scrollDOM.scrollTop+=diff;scrolled=true;}}if(redrawn)this.docView.updateSelection(true);if(this.viewport.from==oldViewport.from&&this.viewport.to==oldViewport.to&&!scrolled&&this.measureRequests.length==0)break;}}finally{this.updateState=0/* UpdateState.Idle */;this.measureScheduled=-1;}if(updated&&!updated.empty){var _iterator82=_createForOfIteratorHelper(this.state.facet(updateListener)),_step82;try{for(_iterator82.s();!(_step82=_iterator82.n()).done;){var listener=_step82.value;listener(updated);}}catch(err){_iterator82.e(err);}finally{_iterator82.f();}}}/**
    Get the CSS classes for the currently active editor themes.
    */},{key:"themeClasses",get:function get(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(_theme);}},{key:"updateAttrs",value:function updateAttrs(){var _this60=this;var editorAttrs=attrsFromFacet(this,editorAttributes,{"class":"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});var contentAttrs={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:!this.state.facet(editable)?"false":"true","class":"cm-content",style:"".concat(browser.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};if(this.state.readOnly)contentAttrs["aria-readonly"]="true";attrsFromFacet(this,contentAttributes,contentAttrs);var changed=this.observer.ignore(function(){var changedContent=_updateAttrs(_this60.contentDOM,_this60.contentAttrs,contentAttrs);var changedEditor=_updateAttrs(_this60.dom,_this60.editorAttrs,editorAttrs);return changedContent||changedEditor;});this.editorAttrs=editorAttrs;this.contentAttrs=contentAttrs;return changed;}},{key:"showAnnouncements",value:function showAnnouncements(trs){var first=true;var _iterator83=_createForOfIteratorHelper(trs),_step83;try{for(_iterator83.s();!(_step83=_iterator83.n()).done;){var tr=_step83.value;var _iterator84=_createForOfIteratorHelper(tr.effects),_step84;try{for(_iterator84.s();!(_step84=_iterator84.n()).done;){var effect=_step84.value;if(effect.is(EditorView.announce)){if(first)this.announceDOM.textContent="";first=false;var div=this.announceDOM.appendChild(document.createElement("div"));div.textContent=effect.value;}}}catch(err){_iterator84.e(err);}finally{_iterator84.f();}}}catch(err){_iterator83.e(err);}finally{_iterator83.f();}}},{key:"mountStyles",value:function mountStyles(){this.styleModules=this.state.facet(styleModule);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse());}},{key:"readMeasured",value:function readMeasured(){if(this.updateState==2/* UpdateState.Updating */)throw new Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0/* UpdateState.Idle */&&this.measureScheduled>-1)this.measure(false);}/**
    Schedule a layout measurement, optionally providing callbacks to
    do custom DOM measuring followed by a DOM write phase. Using
    this is preferable reading DOM layout directly from, for
    example, an event handler, because it'll make sure measuring and
    drawing done by other components is synchronized, avoiding
    unnecessary DOM layout computations.
    */},{key:"requestMeasure",value:function requestMeasure(request){var _this61=this;if(this.measureScheduled<0)this.measureScheduled=this.win.requestAnimationFrame(function(){return _this61.measure();});if(request){if(request.key!=null)for(var _i149=0;_i149<this.measureRequests.length;_i149++){if(this.measureRequests[_i149].key===request.key){this.measureRequests[_i149]=request;return;}}this.measureRequests.push(request);}}/**
    Get the value of a specific plugin, if present. Note that
    plugins that crash can be dropped from a view, so even when you
    know you registered a given plugin, it is recommended to check
    the return value of this method.
    */},{key:"plugin",value:function plugin(_plugin2){var known=this.pluginMap.get(_plugin2);if(known===undefined||known&&known.spec!=_plugin2)this.pluginMap.set(_plugin2,known=this.plugins.find(function(p){return p.spec==_plugin2;})||null);return known&&known.update(this).value;}/**
    The top position of the document, in screen coordinates. This
    may be negative when the editor is scrolled down. Points
    directly to the top of the first line, not above the padding.
    */},{key:"documentTop",get:function get(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop;}/**
    Reports the padding above and below the document.
    */},{key:"documentPadding",get:function get(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom};}/**
    Find the text line or block widget at the given vertical
    position (which is interpreted as relative to the [top of the
    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop)).
    */},{key:"elementAtHeight",value:function elementAtHeight(height){this.readMeasured();return this.viewState.elementAtHeight(height);}/**
    Find the line block (see
    [`lineBlockAt`](https://codemirror.net/6/docs/ref/#view.EditorView.lineBlockAt) at the given
    height, again interpreted relative to the [top of the
    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop).
    */},{key:"lineBlockAtHeight",value:function lineBlockAtHeight(height){this.readMeasured();return this.viewState.lineBlockAtHeight(height);}/**
    Get the extent and vertical position of all [line
    blocks](https://codemirror.net/6/docs/ref/#view.EditorView.lineBlockAt) in the viewport. Positions
    are relative to the [top of the
    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop);
    */},{key:"viewportLineBlocks",get:function get(){return this.viewState.viewportLines;}/**
    Find the line block around the given document position. A line
    block is a range delimited on both sides by either a
    non-[hidden](https://codemirror.net/6/docs/ref/#view.Decoration^replace) line breaks, or the
    start/end of the document. It will usually just hold a line of
    text, but may be broken into multiple textblocks by block
    widgets.
    */},{key:"lineBlockAt",value:function lineBlockAt(pos){return this.viewState.lineBlockAt(pos);}/**
    The editor's total content height.
    */},{key:"contentHeight",get:function get(){return this.viewState.contentHeight;}/**
    Move a cursor position by [grapheme
    cluster](https://codemirror.net/6/docs/ref/#state.findClusterBreak). `forward` determines whether
    the motion is away from the line start, or towards it. In
    bidirectional text, the line is traversed in visual order, using
    the editor's [text direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection).
    When the start position was the last one on the line, the
    returned position will be across the line break. If there is no
    further line, the original position is returned.
    
    By default, this method moves over a single cluster. The
    optional `by` argument can be used to move across more. It will
    be called with the first cluster as argument, and should return
    a predicate that determines, for each subsequent cluster,
    whether it should also be moved over.
    */},{key:"moveByChar",value:function moveByChar(start,forward,by){return skipAtoms(this,start,_moveByChar(this,start,forward,by));}/**
    Move a cursor position across the next group of either
    [letters](https://codemirror.net/6/docs/ref/#state.EditorState.charCategorizer) or non-letter
    non-whitespace characters.
    */},{key:"moveByGroup",value:function moveByGroup(start,forward){var _this62=this;return skipAtoms(this,start,_moveByChar(this,start,forward,function(initial){return byGroup(_this62,start.head,initial);}));}/**
    Move to the next line boundary in the given direction. If
    `includeWrap` is true, line wrapping is on, and there is a
    further wrap point on the current line, the wrap point will be
    returned. Otherwise this function will return the start or end
    of the line.
    */},{key:"moveToLineBoundary",value:function moveToLineBoundary(start,forward){var includeWrap=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;return _moveToLineBoundary(this,start,forward,includeWrap);}/**
    Move a cursor position vertically. When `distance` isn't given,
    it defaults to moving to the next line (including wrapped
    lines). Otherwise, `distance` should provide a positive distance
    in pixels.
    
    When `start` has a
    [`goalColumn`](https://codemirror.net/6/docs/ref/#state.SelectionRange.goalColumn), the vertical
    motion will use that as a target horizontal position. Otherwise,
    the cursor's own horizontal position is used. The returned
    cursor will have its goal column set to whichever column was
    used.
    */},{key:"moveVertically",value:function moveVertically(start,forward,distance){return skipAtoms(this,start,_moveVertically(this,start,forward,distance));}/**
    Find the DOM parent node and offset (child offset if `node` is
    an element, character offset when it is a text node) at the
    given document position.
    
    Note that for positions that aren't currently in
    `visibleRanges`, the resulting DOM position isn't necessarily
    meaningful (it may just point before or after a placeholder
    element).
    */},{key:"domAtPos",value:function domAtPos(pos){return this.docView.domAtPos(pos);}/**
    Find the document position at the given DOM node. Can be useful
    for associating positions with DOM events. Will raise an error
    when `node` isn't part of the editor content.
    */},{key:"posAtDOM",value:function posAtDOM(node){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.docView.posFromDOM(node,offset);}},{key:"posAtCoords",value:function posAtCoords(coords){var precise=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.readMeasured();return _posAtCoords(this,coords,precise);}/**
    Get the screen coordinates at the given document position.
    `side` determines whether the coordinates are based on the
    element before (-1) or after (1) the position (if no element is
    available on the given side, the method will transparently use
    another strategy to get reasonable coordinates).
    */},{key:"coordsAtPos",value:function coordsAtPos(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.readMeasured();var rect=this.docView.coordsAt(pos,side);if(!rect||rect.left==rect.right)return rect;var line=this.state.doc.lineAt(pos),order=this.bidiSpans(line);var span=order[BidiSpan.find(order,pos-line.from,-1,side)];return flattenRect(rect,span.dir==Direction.LTR==side>0);}/**
    The default width of a character in the editor. May not
    accurately reflect the width of all characters (given variable
    width fonts or styling of invididual ranges).
    */},{key:"defaultCharacterWidth",get:function get(){return this.viewState.heightOracle.charWidth;}/**
    The default height of a line in the editor. May not be accurate
    for all lines.
    */},{key:"defaultLineHeight",get:function get(){return this.viewState.heightOracle.lineHeight;}/**
    The text direction
    ([`direction`](https://developer.mozilla.org/en-US/docs/Web/CSS/direction)
    CSS property) of the editor's content element.
    */},{key:"textDirection",get:function get(){return this.viewState.defaultTextDirection;}/**
    Find the text direction of the block at the given position, as
    assigned by CSS. If
    [`perLineTextDirection`](https://codemirror.net/6/docs/ref/#view.EditorView^perLineTextDirection)
    isn't enabled, or the given position is outside of the viewport,
    this will always return the same as
    [`textDirection`](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection). Note that
    this may trigger a DOM layout.
    */},{key:"textDirectionAt",value:function textDirectionAt(pos){var perLine=this.state.facet(perLineTextDirection);if(!perLine||pos<this.viewport.from||pos>this.viewport.to)return this.textDirection;this.readMeasured();return this.docView.textDirectionAt(pos);}/**
    Whether this editor [wraps lines](https://codemirror.net/6/docs/ref/#view.EditorView.lineWrapping)
    (as determined by the
    [`white-space`](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)
    CSS property of its content element).
    */},{key:"lineWrapping",get:function get(){return this.viewState.heightOracle.lineWrapping;}/**
    Returns the bidirectional text structure of the given line
    (which should be in the current document) as an array of span
    objects. The order of these spans matches the [text
    direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection)if that is
    left-to-right, the leftmost spans come first, otherwise the
    rightmost spans come first.
    */},{key:"bidiSpans",value:function bidiSpans(line){if(line.length>MaxBidiLine)return trivialOrder(line.length);var dir=this.textDirectionAt(line.from);var _iterator85=_createForOfIteratorHelper(this.bidiCache),_step85;try{for(_iterator85.s();!(_step85=_iterator85.n()).done;){var entry=_step85.value;if(entry.from==line.from&&entry.dir==dir)return entry.order;}}catch(err){_iterator85.e(err);}finally{_iterator85.f();}var order=computeOrder(line.text,dir);this.bidiCache.push(new CachedOrder(line.from,line.to,dir,order));return order;}/**
    Check whether the editor has focus.
    */},{key:"hasFocus",get:function get(){var _a;// Safari return false for hasFocus when the context menu is open
// or closing, which leads us to ignore selection changes from the
// context menu because it looks like the editor isn't focused.
// This kludges around that.
return(this.dom.ownerDocument.hasFocus()||browser.safari&&((_a=this.inputState)===null||_a===void 0?void 0:_a.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM;}/**
    Put focus on the editor.
    */},{key:"focus",value:function focus(){var _this63=this;this.observer.ignore(function(){focusPreventScroll(_this63.contentDOM);_this63.docView.updateSelection();});}/**
    Update the [root](https://codemirror.net/6/docs/ref/##view.EditorViewConfig.root) in which the editor lives. This is only
    necessary when moving the editor's existing DOM to a new window or shadow root.
    */},{key:"setRoot",value:function setRoot(root){if(this._root!=root){this._root=root;this.observer.setWindow((root.nodeType==9?root:root.ownerDocument).defaultView||window);this.mountStyles();}}/**
    Clean up this editor view, removing its element from the
    document, unregistering event handlers, and notifying
    plugins. The view instance can no longer be used after
    calling this.
    */},{key:"destroy",value:function destroy(){var _iterator86=_createForOfIteratorHelper(this.plugins),_step86;try{for(_iterator86.s();!(_step86=_iterator86.n()).done;){var plugin=_step86.value;plugin.destroy(this);}}catch(err){_iterator86.e(err);}finally{_iterator86.f();}this.plugins=[];this.inputState.destroy();this.dom.remove();this.observer.destroy();if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled);this.destroyed=true;}/**
    Returns an effect that can be
    [added](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) to a transaction to
    cause it to scroll the given position or range into view.
    */}],[{key:"scrollIntoView",value:function scrollIntoView(pos){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return scrollIntoView$1.of(new ScrollTarget(typeof pos=="number"?EditorSelection.cursor(pos):pos,options.y,options.x,options.yMargin,options.xMargin));}/**
    Returns an extension that can be used to add DOM event handlers.
    The value should be an object mapping event names to handler
    functions. For any given event, such functions are ordered by
    extension precedence, and the first handler to return true will
    be assumed to have handled that event, and no other handlers or
    built-in behavior will be activated for it. These are registered
    on the [content element](https://codemirror.net/6/docs/ref/#view.EditorView.contentDOM), except
    for `scroll` handlers, which will be called any time the
    editor's [scroll element](https://codemirror.net/6/docs/ref/#view.EditorView.scrollDOM) or one of
    its parent nodes is scrolled.
    */},{key:"domEventHandlers",value:function domEventHandlers(handlers){return ViewPlugin.define(function(){return{};},{eventHandlers:handlers});}/**
    Create a theme extension. The first argument can be a
    [`style-mod`](https://github.com/marijnh/style-mod#documentation)
    style spec providing the styles for the theme. These will be
    prefixed with a generated class for the style.
    
    Because the selectors will be prefixed with a scope class, rule
    that directly match the editor's [wrapper
    element](https://codemirror.net/6/docs/ref/#view.EditorView.dom)to which the scope class will be
    addedneed to be explicitly differentiated by adding an `&` to
    the selector for that elementfor example
    `&.cm-focused`.
    
    When `dark` is set to true, the theme will be marked as dark,
    which will cause the `&dark` rules from [base
    themes](https://codemirror.net/6/docs/ref/#view.EditorView^baseTheme) to be used (as opposed to
    `&light` when a light theme is active).
    */},{key:"theme",value:function theme(spec,options){var prefix=StyleModule.newName();var result=[_theme.of(prefix),styleModule.of(buildTheme(".".concat(prefix),spec))];if(options&&options.dark)result.push(darkTheme.of(true));return result;}/**
    Create an extension that adds styles to the base theme. Like
    with [`theme`](https://codemirror.net/6/docs/ref/#view.EditorView^theme), use `&` to indicate the
    place of the editor wrapper element when directly targeting
    that. You can also use `&dark` or `&light` instead to only
    target editors with a dark or light theme.
    */},{key:"baseTheme",value:function baseTheme(spec){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,spec,lightDarkIDs)));}/**
    Retrieve an editor view instance from the view's DOM
    representation.
    */},{key:"findFromDOM",value:function findFromDOM(dom){var _a;var content=dom.querySelector(".cm-content");var cView=content&&ContentView.get(content)||ContentView.get(dom);return((_a=cView===null||cView===void 0?void 0:cView.rootView)===null||_a===void 0?void 0:_a.view)||null;}}]);return EditorView;}();/**
Facet to add a [style
module](https://github.com/marijnh/style-mod#documentation) to
an editor view. The view will ensure that the module is
mounted in its [document
root](https://codemirror.net/6/docs/ref/#view.EditorView.constructor^config.root).
*/EditorView.styleModule=styleModule;/**
An input handler can override the way changes to the editable
DOM content are handled. Handlers are passed the document
positions between which the change was found, and the new
content. When one returns true, no further input handlers are
called and the default behavior is prevented.
*/EditorView.inputHandler=inputHandler$1;/**
By default, the editor assumes all its content has the same
[text direction](https://codemirror.net/6/docs/ref/#view.Direction). Configure this with a `true`
value to make it read the text direction of every (rendered)
line separately.
*/EditorView.perLineTextDirection=perLineTextDirection;/**
Allows you to provide a function that should be called when the
library catches an exception from an extension (mostly from view
plugins, but may be used by other extensions to route exceptions
from user-code-provided callbacks). This is mostly useful for
debugging and logging. See [`logException`](https://codemirror.net/6/docs/ref/#view.logException).
*/EditorView.exceptionSink=exceptionSink;/**
A facet that can be used to register a function to be called
every time the view updates.
*/EditorView.updateListener=updateListener;/**
Facet that controls whether the editor content DOM is editable.
When its highest-precedence value is `false`, the element will
not have its `contenteditable` attribute set. (Note that this
doesn't affect API calls that change the editor content, even
when those are bound to keys or buttons. See the
[`readOnly`](https://codemirror.net/6/docs/ref/#state.EditorState.readOnly) facet for that.)
*/EditorView.editable=editable;/**
Allows you to influence the way mouse selection happens. The
functions in this facet will be called for a `mousedown` event
on the editor, and can return an object that overrides the way a
selection is computed from that mouse click or drag.
*/EditorView.mouseSelectionStyle=mouseSelectionStyle;/**
Facet used to configure whether a given selection drag event
should move or copy the selection. The given predicate will be
called with the `mousedown` event, and can return `true` when
the drag should move the content.
*/EditorView.dragMovesSelection=dragMovesSelection$1;/**
Facet used to configure whether a given selecting click adds a
new range to the existing selection or replaces it entirely. The
default behavior is to check `event.metaKey` on macOS, and
`event.ctrlKey` elsewhere.
*/EditorView.clickAddsSelectionRange=clickAddsSelectionRange;/**
A facet that determines which [decorations](https://codemirror.net/6/docs/ref/#view.Decoration)
are shown in the view. Decorations can be provided in two
waysdirectly, or via a function that takes an editor view.

Only decoration sets provided directly are allowed to influence
the editor's vertical layout structure. The ones provided as
functions are called _after_ the new viewport has been computed,
and thus **must not** introduce block widgets or replacing
decorations that cover line breaks.

If you want decorated ranges to behave like atomic units for
cursor motion and deletion purposes, also provide the range set
containing the decorations to
[`EditorView.atomicRanges`](https://codemirror.net/6/docs/ref/#view.EditorView^atomicRanges).
*/EditorView.decorations=decorations;/**
Used to provide ranges that should be treated as atoms as far as
cursor motion is concerned. This causes methods like
[`moveByChar`](https://codemirror.net/6/docs/ref/#view.EditorView.moveByChar) and
[`moveVertically`](https://codemirror.net/6/docs/ref/#view.EditorView.moveVertically) (and the
commands built on top of them) to skip across such regions when
a selection endpoint would enter them. This does _not_ prevent
direct programmatic [selection
updates](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection) from moving into such
regions.
*/EditorView.atomicRanges=atomicRanges;/**
Facet that allows extensions to provide additional scroll
margins (space around the sides of the scrolling element that
should be considered invisible). This can be useful when the
plugin introduces elements that cover part of that element (for
example a horizontally fixed gutter).
*/EditorView.scrollMargins=scrollMargins;/**
This facet records whether a dark theme is active. The extension
returned by [`theme`](https://codemirror.net/6/docs/ref/#view.EditorView^theme) automatically
includes an instance of this when the `dark` option is set to
true.
*/EditorView.darkTheme=darkTheme;/**
Facet that provides additional DOM attributes for the editor's
editable DOM element.
*/EditorView.contentAttributes=contentAttributes;/**
Facet that provides DOM attributes for the editor's outer
element.
*/EditorView.editorAttributes=editorAttributes;/**
An extension that enables line wrapping in the editor (by
setting CSS `white-space` to `pre-wrap` in the content).
*/EditorView.lineWrapping=/*@__PURE__*/EditorView.contentAttributes.of({"class":"cm-lineWrapping"});/**
State effect used to include screen reader announcements in a
transaction. These will be added to the DOM in a visually hidden
element with `aria-live="polite"` set, and should be used to
describe effects that are visually obvious but may not be
noticed by screen reader users (such as moving to the next
search match).
*/EditorView.announce=/*@__PURE__*/StateEffect.define();// Maximum line length for which we compute accurate bidi info
var MaxBidiLine=4096;var BadMeasure={};var CachedOrder=/*#__PURE__*/function(){function CachedOrder(from,to,dir,order){_classCallCheck(this,CachedOrder);this.from=from;this.to=to;this.dir=dir;this.order=order;}_createClass(CachedOrder,null,[{key:"update",value:function update(cache,changes){if(changes.empty)return cache;var result=[],lastDir=cache.length?cache[cache.length-1].dir:Direction.LTR;for(var _i150=Math.max(0,cache.length-10);_i150<cache.length;_i150++){var entry=cache[_i150];if(entry.dir==lastDir&&!changes.touchesRange(entry.from,entry.to))result.push(new CachedOrder(changes.mapPos(entry.from,1),changes.mapPos(entry.to,-1),entry.dir,entry.order));}return result;}}]);return CachedOrder;}();function attrsFromFacet(view,facet,base){for(var sources=view.state.facet(facet),_i151=sources.length-1;_i151>=0;_i151--){var source=sources[_i151],value=typeof source=="function"?source(view):source;if(value)combineAttrs(value,base);}return base;}var currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(name,platform){var parts=name.split(/-(?!$)/);var result=parts[parts.length-1];if(result=="Space")result=" ";var alt,ctrl,shift,meta;for(var _i152=0;_i152<parts.length-1;++_i152){var mod=parts[_i152];if(/^(cmd|meta|m)$/i.test(mod))meta=true;else if(/^a(lt)?$/i.test(mod))alt=true;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=true;else if(/^s(hift)?$/i.test(mod))shift=true;else if(/^mod$/i.test(mod)){if(platform=="mac")meta=true;else ctrl=true;}else throw new Error("Unrecognized modifier name: "+mod);}if(alt)result="Alt-"+result;if(ctrl)result="Ctrl-"+result;if(meta)result="Meta-"+result;if(shift)result="Shift-"+result;return result;}function modifiers(name,event,shift){if(event.altKey)name="Alt-"+name;if(event.ctrlKey)name="Ctrl-"+name;if(event.metaKey)name="Meta-"+name;if(shift!==false&&event.shiftKey)name="Shift-"+name;return name;}var handleKeyEvents=/*@__PURE__*/Prec["default"](/*@__PURE__*/EditorView.domEventHandlers({keydown:function keydown(event,view){return runHandlers(getKeymap(view.state),event,view,"editor");}}));/**
Facet used for registering keymaps.

You can add multiple keymaps to an editor. Their priorities
determine their precedence (the ones specified early or with high
priority get checked first). When a handler has returned `true`
for a given key, no further handlers are called.
*/var keymap=/*@__PURE__*/Facet.define({enables:handleKeyEvents});var Keymaps=/*@__PURE__*/new WeakMap();// This is hidden behind an indirection, rather than directly computed
// by the facet, to keep internal types out of the facet's type.
function getKeymap(state){var bindings=state.facet(keymap);var map=Keymaps.get(bindings);if(!map)Keymaps.set(bindings,map=buildKeymap(bindings.reduce(function(a,b){return a.concat(b);},[])));return map;}/**
Run the key handlers registered for a given scope. The event
object should be a `"keydown"` event. Returns true if any of the
handlers handled it.
*/function runScopeHandlers(view,event,scope){return runHandlers(getKeymap(view.state),event,view,scope);}var storedPrefix=null;var PrefixTimeout=4000;function buildKeymap(bindings){var platform=arguments.length>1&&arguments[1]!==undefined?arguments[1]:currentPlatform;var bound=Object.create(null);var isPrefix=Object.create(null);var checkPrefix=function checkPrefix(name,is){var current=isPrefix[name];if(current==null)isPrefix[name]=is;else if(current!=is)throw new Error("Key binding "+name+" is used both as a regular binding and as a multi-stroke prefix");};var add=function add(scope,key,command,preventDefault){var _a,_b;var scopeObj=bound[scope]||(bound[scope]=Object.create(null));var parts=key.split(/ (?!$)/).map(function(k){return normalizeKeyName(k,platform);});var _loop8=function _loop8(_i153){var prefix=parts.slice(0,_i153).join(" ");checkPrefix(prefix,true);if(!scopeObj[prefix])scopeObj[prefix]={preventDefault:true,run:[function(view){var ourObj=storedPrefix={view:view,prefix:prefix,scope:scope};setTimeout(function(){if(storedPrefix==ourObj)storedPrefix=null;},PrefixTimeout);return true;}]};};for(var _i153=1;_i153<parts.length;_i153++){_loop8(_i153);}var full=parts.join(" ");checkPrefix(full,false);var binding=scopeObj[full]||(scopeObj[full]={preventDefault:false,run:((_b=(_a=scopeObj._any)===null||_a===void 0?void 0:_a.run)===null||_b===void 0?void 0:_b.slice())||[]});if(command)binding.run.push(command);if(preventDefault)binding.preventDefault=true;};var _iterator87=_createForOfIteratorHelper(bindings),_step87;try{for(_iterator87.s();!(_step87=_iterator87.n()).done;){var b=_step87.value;var scopes=b.scope?b.scope.split(" "):["editor"];if(b.any){var _iterator88=_createForOfIteratorHelper(scopes),_step88;try{for(_iterator88.s();!(_step88=_iterator88.n()).done;){var scope=_step88.value;var scopeObj=bound[scope]||(bound[scope]=Object.create(null));if(!scopeObj._any)scopeObj._any={preventDefault:false,run:[]};for(var key in scopeObj){scopeObj[key].run.push(b.any);}}}catch(err){_iterator88.e(err);}finally{_iterator88.f();}}var _name6=b[platform]||b.key;if(!_name6)continue;var _iterator89=_createForOfIteratorHelper(scopes),_step89;try{for(_iterator89.s();!(_step89=_iterator89.n()).done;){var _scope=_step89.value;add(_scope,_name6,b.run,b.preventDefault);if(b.shift)add(_scope,"Shift-"+_name6,b.shift,b.preventDefault);}}catch(err){_iterator89.e(err);}finally{_iterator89.f();}}}catch(err){_iterator87.e(err);}finally{_iterator87.f();}return bound;}function runHandlers(map,event,view,scope){var name=keyName(event);var charCode=codePointAt(name,0),isChar=codePointSize(charCode)==name.length&&name!=" ";var prefix="",fallthrough=false;if(storedPrefix&&storedPrefix.view==view&&storedPrefix.scope==scope){prefix=storedPrefix.prefix+" ";if(fallthrough=modifierCodes.indexOf(event.keyCode)<0)storedPrefix=null;}var ran=new Set();var runFor=function runFor(binding){if(binding){var _iterator90=_createForOfIteratorHelper(binding.run),_step90;try{for(_iterator90.s();!(_step90=_iterator90.n()).done;){var _cmd=_step90.value;if(!ran.has(_cmd)){ran.add(_cmd);if(_cmd(view,event))return true;}}}catch(err){_iterator90.e(err);}finally{_iterator90.f();}if(binding.preventDefault)fallthrough=true;}return false;};var scopeObj=map[scope],baseName,shiftName;if(scopeObj){if(runFor(scopeObj[prefix+modifiers(name,event,!isChar)]))return true;if(isChar&&(event.shiftKey||event.altKey||event.metaKey||charCode>127)&&(baseName=base[event.keyCode])&&baseName!=name){if(runFor(scopeObj[prefix+modifiers(baseName,event,true)]))return true;else if(event.shiftKey&&(shiftName=shift[event.keyCode])!=name&&shiftName!=baseName&&runFor(scopeObj[prefix+modifiers(shiftName,event,false)]))return true;}else if(isChar&&event.shiftKey){if(runFor(scopeObj[prefix+modifiers(name,event,true)]))return true;}if(runFor(scopeObj._any))return true;}return fallthrough;}var CanHidePrimary=!browser.ios;// FIXME test IE
var selectionConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{cursorBlinkRate:1200,drawRangeCursor:true},{cursorBlinkRate:function cursorBlinkRate(a,b){return Math.min(a,b);},drawRangeCursor:function drawRangeCursor(a,b){return a||b;}});}});/**
Returns an extension that hides the browser's native selection and
cursor, replacing the selection with a background behind the text
(with the `cm-selectionBackground` class), and the
cursors with elements overlaid over the code (using
`cm-cursor-primary` and `cm-cursor-secondary`).

This allows the editor to display secondary selection ranges, and
tends to produce a type of selection more in line with that users
expect in a text editor (the native selection styling will often
leave gaps between lines and won't fill the horizontal space after
a line when the selection continues past it).

It does have a performance cost, in that it requires an extra DOM
layout cycle for many updates (the selection is drawn based on DOM
layout information that's only available after laying out the
content).
*/function drawSelection(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[selectionConfig.of(config),drawSelectionPlugin,hideNativeSelection];}var Piece=/*#__PURE__*/function(){function Piece(left,top,width,height,className){_classCallCheck(this,Piece);this.left=left;this.top=top;this.width=width;this.height=height;this.className=className;}_createClass(Piece,[{key:"draw",value:function draw(){var elt=document.createElement("div");elt.className=this.className;this.adjust(elt);return elt;}},{key:"adjust",value:function adjust(elt){elt.style.left=this.left+"px";elt.style.top=this.top+"px";if(this.width>=0)elt.style.width=this.width+"px";elt.style.height=this.height+"px";}},{key:"eq",value:function eq(p){return this.left==p.left&&this.top==p.top&&this.width==p.width&&this.height==p.height&&this.className==p.className;}}]);return Piece;}();var drawSelectionPlugin=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class(view){_classCallCheck(this,_class);this.view=view;this.rangePieces=[];this.cursors=[];this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)};this.selectionLayer=view.scrollDOM.appendChild(document.createElement("div"));this.selectionLayer.className="cm-selectionLayer";this.selectionLayer.setAttribute("aria-hidden","true");this.cursorLayer=view.scrollDOM.appendChild(document.createElement("div"));this.cursorLayer.className="cm-cursorLayer";this.cursorLayer.setAttribute("aria-hidden","true");view.requestMeasure(this.measureReq);this.setBlinkRate();}_createClass(_class,[{key:"setBlinkRate",value:function setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(selectionConfig).cursorBlinkRate+"ms";}},{key:"update",value:function update(_update8){var confChanged=_update8.startState.facet(selectionConfig)!=_update8.state.facet(selectionConfig);if(confChanged||_update8.selectionSet||_update8.geometryChanged||_update8.viewportChanged)this.view.requestMeasure(this.measureReq);if(_update8.transactions.some(function(tr){return tr.scrollIntoView;}))this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";if(confChanged)this.setBlinkRate();}},{key:"readPos",value:function readPos(){var _this64=this;var state=this.view.state,conf=state.facet(selectionConfig);var rangePieces=state.selection.ranges.map(function(r){return r.empty?[]:measureRange(_this64.view,r);}).reduce(function(a,b){return a.concat(b);});var cursors=[];var _iterator91=_createForOfIteratorHelper(state.selection.ranges),_step91;try{for(_iterator91.s();!(_step91=_iterator91.n()).done;){var _r2=_step91.value;var prim=_r2==state.selection.main;if(_r2.empty?!prim||CanHidePrimary:conf.drawRangeCursor){var piece=measureCursor(this.view,_r2,prim);if(piece)cursors.push(piece);}}}catch(err){_iterator91.e(err);}finally{_iterator91.f();}return{rangePieces:rangePieces,cursors:cursors};}},{key:"drawSel",value:function drawSel(_ref48){var _this65=this;var rangePieces=_ref48.rangePieces,cursors=_ref48.cursors;if(rangePieces.length!=this.rangePieces.length||rangePieces.some(function(p,i){return!p.eq(_this65.rangePieces[i]);})){this.selectionLayer.textContent="";var _iterator92=_createForOfIteratorHelper(rangePieces),_step92;try{for(_iterator92.s();!(_step92=_iterator92.n()).done;){var _p2=_step92.value;this.selectionLayer.appendChild(_p2.draw());}}catch(err){_iterator92.e(err);}finally{_iterator92.f();}this.rangePieces=rangePieces;}if(cursors.length!=this.cursors.length||cursors.some(function(c,i){return!c.eq(_this65.cursors[i]);})){var oldCursors=this.cursorLayer.children;if(oldCursors.length!==cursors.length){this.cursorLayer.textContent="";var _iterator93=_createForOfIteratorHelper(cursors),_step93;try{for(_iterator93.s();!(_step93=_iterator93.n()).done;){var c=_step93.value;this.cursorLayer.appendChild(c.draw());}}catch(err){_iterator93.e(err);}finally{_iterator93.f();}}else{cursors.forEach(function(c,idx){return c.adjust(oldCursors[idx]);});}this.cursors=cursors;}}},{key:"destroy",value:function destroy(){this.selectionLayer.remove();this.cursorLayer.remove();}}]);return _class;}());var themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};if(CanHidePrimary)themeSpec[".cm-line"].caretColor="transparent !important";var hideNativeSelection=/*@__PURE__*/Prec.highest(/*@__PURE__*/EditorView.theme(themeSpec));function getBase(view){var rect=view.scrollDOM.getBoundingClientRect();var left=view.textDirection==Direction.LTR?rect.left:rect.right-view.scrollDOM.clientWidth;return{left:left-view.scrollDOM.scrollLeft,top:rect.top-view.scrollDOM.scrollTop};}function wrappedLine(view,pos,inside){var range=EditorSelection.cursor(pos);return{from:Math.max(inside.from,view.moveToLineBoundary(range,false,true).from),to:Math.min(inside.to,view.moveToLineBoundary(range,true,true).from),type:BlockType.Text};}function blockAt(view,pos){var line=view.lineBlockAt(pos);if(Array.isArray(line.type)){var _iterator94=_createForOfIteratorHelper(line.type),_step94;try{for(_iterator94.s();!(_step94=_iterator94.n()).done;){var _l2=_step94.value;if(_l2.to>pos||_l2.to==pos&&(_l2.to==line.to||_l2.type==BlockType.Text))return _l2;}}catch(err){_iterator94.e(err);}finally{_iterator94.f();}}return line;}function measureRange(view,range){if(range.to<=view.viewport.from||range.from>=view.viewport.to)return[];var from=Math.max(range.from,view.viewport.from),to=Math.min(range.to,view.viewport.to);var ltr=view.textDirection==Direction.LTR;var content=view.contentDOM,contentRect=content.getBoundingClientRect(),base=getBase(view);var lineStyle=window.getComputedStyle(content.firstChild);var leftSide=contentRect.left+parseInt(lineStyle.paddingLeft)+Math.min(0,parseInt(lineStyle.textIndent));var rightSide=contentRect.right-parseInt(lineStyle.paddingRight);var startBlock=blockAt(view,from),endBlock=blockAt(view,to);var visualStart=startBlock.type==BlockType.Text?startBlock:null;var visualEnd=endBlock.type==BlockType.Text?endBlock:null;if(view.lineWrapping){if(visualStart)visualStart=wrappedLine(view,from,visualStart);if(visualEnd)visualEnd=wrappedLine(view,to,visualEnd);}if(visualStart&&visualEnd&&visualStart.from==visualEnd.from){return pieces(drawForLine(range.from,range.to,visualStart));}else{var _top9=visualStart?drawForLine(range.from,null,visualStart):drawForWidget(startBlock,false);var bottom=visualEnd?drawForLine(null,range.to,visualEnd):drawForWidget(endBlock,true);var between=[];if((visualStart||startBlock).to<(visualEnd||endBlock).from-1)between.push(piece(leftSide,_top9.bottom,rightSide,bottom.top));else if(_top9.bottom<bottom.top&&view.elementAtHeight((_top9.bottom+bottom.top)/2).type==BlockType.Text)_top9.bottom=bottom.top=(_top9.bottom+bottom.top)/2;return pieces(_top9).concat(between).concat(pieces(bottom));}function piece(left,top,right,bottom){return new Piece(left-base.left,top-base.top-0.01/* C.Epsilon */,right-left,bottom-top+0.01/* C.Epsilon */,"cm-selectionBackground");}function pieces(_ref49){var top=_ref49.top,bottom=_ref49.bottom,horizontal=_ref49.horizontal;var pieces=[];for(var _i154=0;_i154<horizontal.length;_i154+=2){pieces.push(piece(horizontal[_i154],top,horizontal[_i154+1],bottom));}return pieces;}// Gets passed from/to in line-local positions
function drawForLine(from,to,line){var top=1e9,bottom=-1e9,horizontal=[];function addSpan(from,fromOpen,to,toOpen,dir){// Passing 2/-2 is a kludge to force the view to return
// coordinates on the proper side of block widgets, since
// normalizing the side there, though appropriate for most
// coordsAtPos queries, would break selection drawing.
var fromCoords=view.coordsAtPos(from,from==line.to?-2:2);var toCoords=view.coordsAtPos(to,to==line.from?2:-2);top=Math.min(fromCoords.top,toCoords.top,top);bottom=Math.max(fromCoords.bottom,toCoords.bottom,bottom);if(dir==Direction.LTR)horizontal.push(ltr&&fromOpen?leftSide:fromCoords.left,ltr&&toOpen?rightSide:toCoords.right);else horizontal.push(!ltr&&toOpen?leftSide:toCoords.left,!ltr&&fromOpen?rightSide:fromCoords.right);}var start=from!==null&&from!==void 0?from:line.from,end=to!==null&&to!==void 0?to:line.to;// Split the range by visible range and document line
var _iterator95=_createForOfIteratorHelper(view.visibleRanges),_step95;try{for(_iterator95.s();!(_step95=_iterator95.n()).done;){var _r3=_step95.value;if(_r3.to>start&&_r3.from<end){for(var pos=Math.max(_r3.from,start),endPos=Math.min(_r3.to,end);;){var docLine=view.state.doc.lineAt(pos);var _iterator96=_createForOfIteratorHelper(view.bidiSpans(docLine)),_step96;try{for(_iterator96.s();!(_step96=_iterator96.n()).done;){var span=_step96.value;var spanFrom=span.from+docLine.from,spanTo=span.to+docLine.from;if(spanFrom>=endPos)break;if(spanTo>pos)addSpan(Math.max(spanFrom,pos),from==null&&spanFrom<=start,Math.min(spanTo,endPos),to==null&&spanTo>=end,span.dir);}}catch(err){_iterator96.e(err);}finally{_iterator96.f();}pos=docLine.to+1;if(pos>=endPos)break;}}}}catch(err){_iterator95.e(err);}finally{_iterator95.f();}if(horizontal.length==0)addSpan(start,from==null,end,to==null,view.textDirection);return{top:top,bottom:bottom,horizontal:horizontal};}function drawForWidget(block,top){var y=contentRect.top+(top?block.top:block.bottom);return{top:y,bottom:y,horizontal:[]};}}function measureCursor(view,cursor,primary){var pos=view.coordsAtPos(cursor.head,cursor.assoc||1);if(!pos)return null;var base=getBase(view);return new Piece(pos.left-base.left,pos.top-base.top,-1,pos.bottom-pos.top,primary?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary");}var setDropCursorPos=/*@__PURE__*/StateEffect.define({map:function map(pos,mapping){return pos==null?null:mapping.mapPos(pos);}});var dropCursorPos=/*@__PURE__*/StateField.define({create:function create(){return null;},update:function update(pos,tr){if(pos!=null)pos=tr.changes.mapPos(pos);return tr.effects.reduce(function(pos,e){return e.is(setDropCursorPos)?e.value:pos;},pos);}});var drawDropCursor=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class2(view){_classCallCheck(this,_class2);this.view=view;this.cursor=null;this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)};}_createClass(_class2,[{key:"update",value:function update(_update9){var _a;var cursorPos=_update9.state.field(dropCursorPos);if(cursorPos==null){if(this.cursor!=null){(_a=this.cursor)===null||_a===void 0?void 0:_a.remove();this.cursor=null;}}else{if(!this.cursor){this.cursor=this.view.scrollDOM.appendChild(document.createElement("div"));this.cursor.className="cm-dropCursor";}if(_update9.startState.field(dropCursorPos)!=cursorPos||_update9.docChanged||_update9.geometryChanged)this.view.requestMeasure(this.measureReq);}}},{key:"readPos",value:function readPos(){var pos=this.view.state.field(dropCursorPos);var rect=pos!=null&&this.view.coordsAtPos(pos);if(!rect)return null;var outer=this.view.scrollDOM.getBoundingClientRect();return{left:rect.left-outer.left+this.view.scrollDOM.scrollLeft,top:rect.top-outer.top+this.view.scrollDOM.scrollTop,height:rect.bottom-rect.top};}},{key:"drawCursor",value:function drawCursor(pos){if(this.cursor){if(pos){this.cursor.style.left=pos.left+"px";this.cursor.style.top=pos.top+"px";this.cursor.style.height=pos.height+"px";}else{this.cursor.style.left="-100000px";}}}},{key:"destroy",value:function destroy(){if(this.cursor)this.cursor.remove();}},{key:"setDropPos",value:function setDropPos(pos){if(this.view.state.field(dropCursorPos)!=pos)this.view.dispatch({effects:setDropCursorPos.of(pos)});}}]);return _class2;}(),{eventHandlers:{dragover:function dragover(event){this.setDropPos(this.view.posAtCoords({x:event.clientX,y:event.clientY}));},dragleave:function dragleave(event){if(event.target==this.view.contentDOM||!this.view.contentDOM.contains(event.relatedTarget))this.setDropPos(null);},dragend:function dragend(){this.setDropPos(null);},drop:function drop(){this.setDropPos(null);}}});/**
Draws a cursor at the current drop position when something is
dragged over the editor.
*/function dropCursor(){return[dropCursorPos,drawDropCursor];}function iterMatches(doc,re,from,to,f){re.lastIndex=0;for(var cursor=doc.iterRange(from,to),pos=from,m;!cursor.next().done;pos+=cursor.value.length){if(!cursor.lineBreak)while(m=re.exec(cursor.value)){f(pos+m.index,m);}}}function matchRanges(view,maxLength){var visible=view.visibleRanges;if(visible.length==1&&visible[0].from==view.viewport.from&&visible[0].to==view.viewport.to)return visible;var result=[];var _iterator97=_createForOfIteratorHelper(visible),_step97;try{for(_iterator97.s();!(_step97=_iterator97.n()).done;){var _step97$value=_step97.value,from=_step97$value.from,to=_step97$value.to;from=Math.max(view.state.doc.lineAt(from).from,from-maxLength);to=Math.min(view.state.doc.lineAt(to).to,to+maxLength);if(result.length&&result[result.length-1].to>=from)result[result.length-1].to=to;else result.push({from:from,to:to});}}catch(err){_iterator97.e(err);}finally{_iterator97.f();}return result;}/**
Helper class used to make it easier to maintain decorations on
visible code that matches a given regular expression. To be used
in a [view plugin](https://codemirror.net/6/docs/ref/#view.ViewPlugin). Instances of this object
represent a matching configuration.
*/var MatchDecorator=/*#__PURE__*/function(){/**
    Create a decorator.
    */function MatchDecorator(config){_classCallCheck(this,MatchDecorator);var regexp=config.regexp,decoration=config.decoration,decorate=config.decorate,boundary=config.boundary,_config$maxLength=config.maxLength,maxLength=_config$maxLength===void 0?1000:_config$maxLength;if(!regexp.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=regexp;if(decorate){this.addMatch=function(match,view,from,add){return decorate(add,from,from+match[0].length,match,view);};}else if(typeof decoration=="function"){this.addMatch=function(match,view,from,add){var deco=decoration(match,view,from);if(deco)add(from,from+match[0].length,deco);};}else if(decoration){this.addMatch=function(match,_view,from,add){return add(from,from+match[0].length,decoration);};}else{throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");}this.boundary=boundary;this.maxLength=maxLength;}/**
    Compute the full set of decorations for matches in the given
    view's viewport. You'll want to call this when initializing your
    plugin.
    */_createClass(MatchDecorator,[{key:"createDeco",value:function createDeco(view){var _this66=this;var build=new RangeSetBuilder(),add=build.add.bind(build);var _iterator98=_createForOfIteratorHelper(matchRanges(view,this.maxLength)),_step98;try{for(_iterator98.s();!(_step98=_iterator98.n()).done;){var _step98$value=_step98.value,from=_step98$value.from,to=_step98$value.to;iterMatches(view.state.doc,this.regexp,from,to,function(from,m){return _this66.addMatch(m,view,from,add);});}}catch(err){_iterator98.e(err);}finally{_iterator98.f();}return build.finish();}/**
    Update a set of decorations for a view update. `deco` _must_ be
    the set of decorations produced by _this_ `MatchDecorator` for
    the view state before the update.
    */},{key:"updateDeco",value:function updateDeco(update,deco){var changeFrom=1e9,changeTo=-1;if(update.docChanged)update.changes.iterChanges(function(_f,_t,from,to){if(to>update.view.viewport.from&&from<update.view.viewport.to){changeFrom=Math.min(from,changeFrom);changeTo=Math.max(to,changeTo);}});if(update.viewportChanged||changeTo-changeFrom>1000)return this.createDeco(update.view);if(changeTo>-1)return this.updateRange(update.view,deco.map(update.changes),changeFrom,changeTo);return deco;}},{key:"updateRange",value:function updateRange(view,deco,updateFrom,updateTo){var _this67=this;var _iterator99=_createForOfIteratorHelper(view.visibleRanges),_step99;try{for(_iterator99.s();!(_step99=_iterator99.n()).done;){var _r4=_step99.value;var from=Math.max(_r4.from,updateFrom),to=Math.min(_r4.to,updateTo);if(to>from){(function(){var fromLine=view.state.doc.lineAt(from),toLine=fromLine.to<to?view.state.doc.lineAt(to):fromLine;var start=Math.max(_r4.from,fromLine.from),end=Math.min(_r4.to,toLine.to);if(_this67.boundary){for(;from>fromLine.from;from--){if(_this67.boundary.test(fromLine.text[from-1-fromLine.from])){start=from;break;}}for(;to<toLine.to;to++){if(_this67.boundary.test(toLine.text[to-toLine.from])){end=to;break;}}}var ranges=[],m=void 0;var add=function add(from,to,deco){return ranges.push(deco.range(from,to));};if(fromLine==toLine){_this67.regexp.lastIndex=start-fromLine.from;while((m=_this67.regexp.exec(fromLine.text))&&m.index<end-fromLine.from){_this67.addMatch(m,view,m.index+fromLine.from,add);}}else{iterMatches(view.state.doc,_this67.regexp,start,end,function(from,m){return _this67.addMatch(m,view,from,add);});}deco=deco.update({filterFrom:start,filterTo:end,filter:function filter(from,to){return from<start||to>end;},add:ranges});})();}}}catch(err){_iterator99.e(err);}finally{_iterator99.f();}return deco;}}]);return MatchDecorator;}();var UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g";var Specials=/*@__PURE__*/new RegExp("[\0-\b\n-\x1F\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]",UnicodeRegexpSupport);var Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};var _supportsTabSize=null;function supportsTabSize(){var _a;if(_supportsTabSize==null&&typeof document!="undefined"&&document.body){var styles=document.body.style;_supportsTabSize=((_a=styles.tabSize)!==null&&_a!==void 0?_a:styles.MozTabSize)!=null;}return _supportsTabSize||false;}var specialCharConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){var config=combineConfig(configs,{render:null,specialChars:Specials,addSpecialChars:null});if(config.replaceTabs=!supportsTabSize())config.specialChars=new RegExp("\t|"+config.specialChars.source,UnicodeRegexpSupport);if(config.addSpecialChars)config.specialChars=new RegExp(config.specialChars.source+"|"+config.addSpecialChars.source,UnicodeRegexpSupport);return config;}});/**
Returns an extension that installs highlighting of special
characters.
*/function highlightSpecialChars(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[specialCharConfig.of(config),specialCharPlugin()];}var _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class3(view){_classCallCheck(this,_class3);this.view=view;this.decorations=Decoration.none;this.decorationCache=Object.create(null);this.decorator=this.makeDecorator(view.state.facet(specialCharConfig));this.decorations=this.decorator.createDeco(view);}_createClass(_class3,[{key:"makeDecorator",value:function makeDecorator(conf){var _this68=this;return new MatchDecorator({regexp:conf.specialChars,decoration:function decoration(m,view,pos){var doc=view.state.doc;var code=codePointAt(m[0],0);if(code==9){var line=doc.lineAt(pos);var _size4=view.state.tabSize,col=_countColumn(line.text,_size4,pos-line.from);return Decoration.replace({widget:new TabWidget((_size4-col%_size4)*_this68.view.defaultCharacterWidth)});}return _this68.decorationCache[code]||(_this68.decorationCache[code]=Decoration.replace({widget:new SpecialCharWidget(conf,code)}));},boundary:conf.replaceTabs?undefined:/[^]/});}},{key:"update",value:function update(_update10){var conf=_update10.state.facet(specialCharConfig);if(_update10.startState.facet(specialCharConfig)!=conf){this.decorator=this.makeDecorator(conf);this.decorations=this.decorator.createDeco(_update10.view);}else{this.decorations=this.decorator.updateDeco(_update10,this.decorations);}}}]);return _class3;}(),{decorations:function decorations(v){return v.decorations;}}));}var DefaultPlaceholder="\u2022";// Assigns placeholder characters from the Control Pictures block to
// ASCII control characters
function placeholder$1(code){if(code>=32)return DefaultPlaceholder;if(code==10)return"\u2424";return String.fromCharCode(9216+code);}var SpecialCharWidget=/*#__PURE__*/function(_WidgetType5){_inherits(SpecialCharWidget,_WidgetType5);var _super38=_createSuper(SpecialCharWidget);function SpecialCharWidget(options,code){var _this69;_classCallCheck(this,SpecialCharWidget);_this69=_super38.call(this);_this69.options=options;_this69.code=code;return _this69;}_createClass(SpecialCharWidget,[{key:"eq",value:function eq(other){return other.code==this.code;}},{key:"toDOM",value:function toDOM(view){var ph=placeholder$1(this.code);var desc=view.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16));var custom=this.options.render&&this.options.render(this.code,desc,ph);if(custom)return custom;var span=document.createElement("span");span.textContent=ph;span.title=desc;span.setAttribute("aria-label",desc);span.className="cm-specialChar";return span;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}}]);return SpecialCharWidget;}(WidgetType);var TabWidget=/*#__PURE__*/function(_WidgetType6){_inherits(TabWidget,_WidgetType6);var _super39=_createSuper(TabWidget);function TabWidget(width){var _this70;_classCallCheck(this,TabWidget);_this70=_super39.call(this);_this70.width=width;return _this70;}_createClass(TabWidget,[{key:"eq",value:function eq(other){return other.width==this.width;}},{key:"toDOM",value:function toDOM(){var span=document.createElement("span");span.textContent="\t";span.className="cm-tab";span.style.width=this.width+"px";return span;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}}]);return TabWidget;}(WidgetType);/**
Mark lines that have a cursor on them with the `"cm-activeLine"`
DOM class.
*/function highlightActiveLine(){return activeLineHighlighter;}var lineDeco=/*@__PURE__*/Decoration.line({"class":"cm-activeLine"});var activeLineHighlighter=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class4(view){_classCallCheck(this,_class4);this.decorations=this.getDeco(view);}_createClass(_class4,[{key:"update",value:function update(_update11){if(_update11.docChanged||_update11.selectionSet)this.decorations=this.getDeco(_update11.view);}},{key:"getDeco",value:function getDeco(view){var lastLineStart=-1,deco=[];var _iterator100=_createForOfIteratorHelper(view.state.selection.ranges),_step100;try{for(_iterator100.s();!(_step100=_iterator100.n()).done;){var _r5=_step100.value;var line=view.lineBlockAt(_r5.head);if(line.from>lastLineStart){deco.push(lineDeco.range(line.from));lastLineStart=line.from;}}}catch(err){_iterator100.e(err);}finally{_iterator100.f();}return Decoration.set(deco);}}]);return _class4;}(),{decorations:function decorations(v){return v.decorations;}});// Don't compute precise column positions for line offsets above this
// (since it could get expensive). Assume offset==column for them.
var MaxOff=2000;function rectangleFor(state,a,b){var startLine=Math.min(a.line,b.line),endLine=Math.max(a.line,b.line);var ranges=[];if(a.off>MaxOff||b.off>MaxOff||a.col<0||b.col<0){var startOff=Math.min(a.off,b.off),endOff=Math.max(a.off,b.off);for(var _i155=startLine;_i155<=endLine;_i155++){var line=state.doc.line(_i155);if(line.length<=endOff)ranges.push(EditorSelection.range(line.from+startOff,line.to+endOff));}}else{var startCol=Math.min(a.col,b.col),endCol=Math.max(a.col,b.col);for(var _i156=startLine;_i156<=endLine;_i156++){var _line2=state.doc.line(_i156);var start=findColumn(_line2.text,startCol,state.tabSize,true);if(start>-1){var end=findColumn(_line2.text,endCol,state.tabSize);ranges.push(EditorSelection.range(_line2.from+start,_line2.from+end));}}}return ranges;}function absoluteColumn(view,x){var ref=view.coordsAtPos(view.viewport.from);return ref?Math.round(Math.abs((ref.left-x)/view.defaultCharacterWidth)):-1;}function getPos(view,event){var offset=view.posAtCoords({x:event.clientX,y:event.clientY},false);var line=view.state.doc.lineAt(offset),off=offset-line.from;var col=off>MaxOff?-1:off==line.length?absoluteColumn(view,event.clientX):_countColumn(line.text,view.state.tabSize,offset-line.from);return{line:line.number,col:col,off:off};}function rectangleSelectionStyle(view,event){var start=getPos(view,event),startSel=view.state.selection;if(!start)return null;return{update:function update(_update12){if(_update12.docChanged){var newStart=_update12.changes.mapPos(_update12.startState.doc.line(start.line).from);var newLine=_update12.state.doc.lineAt(newStart);start={line:newLine.number,col:start.col,off:Math.min(start.off,newLine.length)};startSel=startSel.map(_update12.changes);}},get:function get(event,_extend,multiple){var cur=getPos(view,event);if(!cur)return startSel;var ranges=rectangleFor(view.state,start,cur);if(!ranges.length)return startSel;if(multiple)return EditorSelection.create(ranges.concat(startSel.ranges));else return EditorSelection.create(ranges);}};}/**
Create an extension that enables rectangular selections. By
default, it will react to left mouse drag with the Alt key held
down. When such a selection occurs, the text within the rectangle
that was dragged over will be selected, as one selection
[range](https://codemirror.net/6/docs/ref/#state.SelectionRange) per line.
*/function rectangularSelection(options){var filter=(options===null||options===void 0?void 0:options.eventFilter)||function(e){return e.altKey&&e.button==0;};return EditorView.mouseSelectionStyle.of(function(view,event){return filter(event)?rectangleSelectionStyle(view,event):null;});}var keys={Alt:[18,function(e){return e.altKey;}],Control:[17,function(e){return e.ctrlKey;}],Shift:[16,function(e){return e.shiftKey;}],Meta:[91,function(e){return e.metaKey;}]};var showCrosshair={style:"cursor: crosshair"};/**
Returns an extension that turns the pointer cursor into a
crosshair when a given modifier key, defaulting to Alt, is held
down. Can serve as a visual hint that rectangular selection is
going to happen when paired with
[`rectangularSelection`](https://codemirror.net/6/docs/ref/#view.rectangularSelection).
*/function crosshairCursor(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _keys2=_slicedToArray(keys[options.key||"Alt"],2),code=_keys2[0],getter=_keys2[1];var plugin=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class5(view){_classCallCheck(this,_class5);this.view=view;this.isDown=false;}_createClass(_class5,[{key:"set",value:function set(isDown){if(this.isDown!=isDown){this.isDown=isDown;this.view.update([]);}}}]);return _class5;}(),{eventHandlers:{keydown:function keydown(e){this.set(e.keyCode==code||getter(e));},keyup:function keyup(e){if(e.keyCode==code||!getter(e))this.set(false);}}});return[plugin,EditorView.contentAttributes.of(function(view){var _a;return((_a=view.plugin(plugin))===null||_a===void 0?void 0:_a.isDown)?showCrosshair:null;})];}var Outside="-10000px";var TooltipViewManager=/*#__PURE__*/function(){function TooltipViewManager(view,facet,createTooltipView){_classCallCheck(this,TooltipViewManager);this.facet=facet;this.createTooltipView=createTooltipView;this.input=view.state.facet(facet);this.tooltips=this.input.filter(function(t){return t;});this.tooltipViews=this.tooltips.map(createTooltipView);}_createClass(TooltipViewManager,[{key:"update",value:function update(_update13){var input=_update13.state.facet(this.facet);var tooltips=input.filter(function(x){return x;});if(input===this.input){var _iterator101=_createForOfIteratorHelper(this.tooltipViews),_step101;try{for(_iterator101.s();!(_step101=_iterator101.n()).done;){var _t3=_step101.value;if(_t3.update)_t3.update(_update13);}}catch(err){_iterator101.e(err);}finally{_iterator101.f();}return false;}var tooltipViews=[];for(var _i157=0;_i157<tooltips.length;_i157++){var tip=tooltips[_i157],known=-1;if(!tip)continue;for(var _i158=0;_i158<this.tooltips.length;_i158++){var other=this.tooltips[_i158];if(other&&other.create==tip.create)known=_i158;}if(known<0){tooltipViews[_i157]=this.createTooltipView(tip);}else{var tooltipView=tooltipViews[_i157]=this.tooltipViews[known];if(tooltipView.update)tooltipView.update(_update13);}}var _iterator102=_createForOfIteratorHelper(this.tooltipViews),_step102;try{for(_iterator102.s();!(_step102=_iterator102.n()).done;){var _t4=_step102.value;if(tooltipViews.indexOf(_t4)<0)_t4.dom.remove();}}catch(err){_iterator102.e(err);}finally{_iterator102.f();}this.input=input;this.tooltips=tooltips;this.tooltipViews=tooltipViews;return true;}}]);return TooltipViewManager;}();function windowSpace(view){var win=view.win;return{top:0,left:0,bottom:win.innerHeight,right:win.innerWidth};}var tooltipConfig=/*@__PURE__*/Facet.define({combine:function combine(values){var _a,_b,_c;return{position:browser.ios?"absolute":((_a=values.find(function(conf){return conf.position;}))===null||_a===void 0?void 0:_a.position)||"fixed",parent:((_b=values.find(function(conf){return conf.parent;}))===null||_b===void 0?void 0:_b.parent)||null,tooltipSpace:((_c=values.find(function(conf){return conf.tooltipSpace;}))===null||_c===void 0?void 0:_c.tooltipSpace)||windowSpace};}});var tooltipPlugin=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class6(view){var _this71=this;_classCallCheck(this,_class6);this.view=view;this.inView=true;this.lastTransaction=0;this.measureTimeout=-1;var config=view.state.facet(tooltipConfig);this.position=config.position;this.parent=config.parent;this.classes=view.themeClasses;this.createContainer();this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.manager=new TooltipViewManager(view,showTooltip,function(t){return _this71.createTooltip(t);});this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(function(entries){if(Date.now()>_this71.lastTransaction-50&&entries.length>0&&entries[entries.length-1].intersectionRatio<1)_this71.measureSoon();},{threshold:[1]}):null;this.observeIntersection();view.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this));this.maybeMeasure();}_createClass(_class6,[{key:"createContainer",value:function createContainer(){if(this.parent){this.container=document.createElement("div");this.container.style.position="relative";this.container.className=this.view.themeClasses;this.parent.appendChild(this.container);}else{this.container=this.view.dom;}}},{key:"observeIntersection",value:function observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();var _iterator103=_createForOfIteratorHelper(this.manager.tooltipViews),_step103;try{for(_iterator103.s();!(_step103=_iterator103.n()).done;){var _tooltip=_step103.value;this.intersectionObserver.observe(_tooltip.dom);}}catch(err){_iterator103.e(err);}finally{_iterator103.f();}}}},{key:"measureSoon",value:function measureSoon(){var _this72=this;if(this.measureTimeout<0)this.measureTimeout=setTimeout(function(){_this72.measureTimeout=-1;_this72.maybeMeasure();},50);}},{key:"update",value:function update(_update14){if(_update14.transactions.length)this.lastTransaction=Date.now();var updated=this.manager.update(_update14);if(updated)this.observeIntersection();var shouldMeasure=updated||_update14.geometryChanged;var newConfig=_update14.state.facet(tooltipConfig);if(newConfig.position!=this.position){this.position=newConfig.position;var _iterator104=_createForOfIteratorHelper(this.manager.tooltipViews),_step104;try{for(_iterator104.s();!(_step104=_iterator104.n()).done;){var _t5=_step104.value;_t5.dom.style.position=this.position;}}catch(err){_iterator104.e(err);}finally{_iterator104.f();}shouldMeasure=true;}if(newConfig.parent!=this.parent){if(this.parent)this.container.remove();this.parent=newConfig.parent;this.createContainer();var _iterator105=_createForOfIteratorHelper(this.manager.tooltipViews),_step105;try{for(_iterator105.s();!(_step105=_iterator105.n()).done;){var _t6=_step105.value;this.container.appendChild(_t6.dom);}}catch(err){_iterator105.e(err);}finally{_iterator105.f();}shouldMeasure=true;}else if(this.parent&&this.view.themeClasses!=this.classes){this.classes=this.container.className=this.view.themeClasses;}if(shouldMeasure)this.maybeMeasure();}},{key:"createTooltip",value:function createTooltip(tooltip){var tooltipView=tooltip.create(this.view);tooltipView.dom.classList.add("cm-tooltip");if(tooltip.arrow&&!tooltipView.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){var arrow=document.createElement("div");arrow.className="cm-tooltip-arrow";tooltipView.dom.appendChild(arrow);}tooltipView.dom.style.position=this.position;tooltipView.dom.style.top=Outside;this.container.appendChild(tooltipView.dom);if(tooltipView.mount)tooltipView.mount(this.view);return tooltipView;}},{key:"destroy",value:function destroy(){var _a;this.view.win.removeEventListener("resize",this.measureSoon);var _iterator106=_createForOfIteratorHelper(this.manager.tooltipViews),_step106;try{for(_iterator106.s();!(_step106=_iterator106.n()).done;){var dom=_step106.value.dom;dom.remove();}}catch(err){_iterator106.e(err);}finally{_iterator106.f();}(_a=this.intersectionObserver)===null||_a===void 0?void 0:_a.disconnect();clearTimeout(this.measureTimeout);}},{key:"readMeasure",value:function readMeasure(){var _this73=this;var editor=this.view.dom.getBoundingClientRect();return{editor:editor,parent:this.parent?this.container.getBoundingClientRect():editor,pos:this.manager.tooltips.map(function(t,i){var tv=_this73.manager.tooltipViews[i];return tv.getCoords?tv.getCoords(t.pos):_this73.view.coordsAtPos(t.pos);}),size:this.manager.tooltipViews.map(function(_ref50){var dom=_ref50.dom;return dom.getBoundingClientRect();}),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view)};}},{key:"writeMeasure",value:function writeMeasure(measured){var editor=measured.editor,space=measured.space;var others=[];for(var _i159=0;_i159<this.manager.tooltips.length;_i159++){var _tooltip2=this.manager.tooltips[_i159],tView=this.manager.tooltipViews[_i159],dom=tView.dom;var pos=measured.pos[_i159],_size5=measured.size[_i159];// Hide tooltips that are outside of the editor.
if(!pos||pos.bottom<=Math.max(editor.top,space.top)||pos.top>=Math.min(editor.bottom,space.bottom)||pos.right<Math.max(editor.left,space.left)-.1||pos.left>Math.min(editor.right,space.right)+.1){dom.style.top=Outside;continue;}var arrow=_tooltip2.arrow?tView.dom.querySelector(".cm-tooltip-arrow"):null;var arrowHeight=arrow?7/* Arrow.Size */:0;var width=_size5.right-_size5.left,height=_size5.bottom-_size5.top;var offset=tView.offset||noOffset,ltr=this.view.textDirection==Direction.LTR;var left=_size5.width>space.right-space.left?ltr?space.left:space.right-_size5.width:ltr?Math.min(pos.left-(arrow?14/* Arrow.Offset */:0)+offset.x,space.right-width):Math.max(space.left,pos.left-width+(arrow?14/* Arrow.Offset */:0)-offset.x);var above=!!_tooltip2.above;if(!_tooltip2.strictSide&&(above?pos.top-(_size5.bottom-_size5.top)-offset.y<space.top:pos.bottom+(_size5.bottom-_size5.top)+offset.y>space.bottom)&&above==space.bottom-pos.bottom>pos.top-space.top)above=!above;var _top10=above?pos.top-height-arrowHeight-offset.y:pos.bottom+arrowHeight+offset.y;var right=left+width;if(tView.overlap!==true){var _iterator107=_createForOfIteratorHelper(others),_step107;try{for(_iterator107.s();!(_step107=_iterator107.n()).done;){var _r6=_step107.value;if(_r6.left<right&&_r6.right>left&&_r6.top<_top10+height&&_r6.bottom>_top10)_top10=above?_r6.top-height-2-arrowHeight:_r6.bottom+arrowHeight+2;}}catch(err){_iterator107.e(err);}finally{_iterator107.f();}}if(this.position=="absolute"){dom.style.top=_top10-measured.parent.top+"px";dom.style.left=left-measured.parent.left+"px";}else{dom.style.top=_top10+"px";dom.style.left=left+"px";}if(arrow)arrow.style.left="".concat(pos.left+(ltr?offset.x:-offset.x)-(left+14/* Arrow.Offset */-7/* Arrow.Size */),"px");if(tView.overlap!==true)others.push({left:left,top:_top10,right:right,bottom:_top10+height});dom.classList.toggle("cm-tooltip-above",above);dom.classList.toggle("cm-tooltip-below",!above);if(tView.positioned)tView.positioned();}}},{key:"maybeMeasure",value:function maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){this.inView=this.view.inView;if(!this.inView){var _iterator108=_createForOfIteratorHelper(this.manager.tooltipViews),_step108;try{for(_iterator108.s();!(_step108=_iterator108.n()).done;){var tv=_step108.value;tv.dom.style.top=Outside;}}catch(err){_iterator108.e(err);}finally{_iterator108.f();}}}}}}]);return _class6;}(),{eventHandlers:{scroll:function scroll(){this.maybeMeasure();}}});var baseTheme$4=/*@__PURE__*/EditorView.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7/* Arrow.Size */,"px"),width:"".concat(7/* Arrow.Size */*2,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7/* Arrow.Size */,"px solid transparent"),borderRight:"".concat(7/* Arrow.Size */,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7/* Arrow.Size */,"px"),"&:before":{borderTop:"".concat(7/* Arrow.Size */,"px solid #bbb")},"&:after":{borderTop:"".concat(7/* Arrow.Size */,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7/* Arrow.Size */,"px"),"&:before":{borderBottom:"".concat(7/* Arrow.Size */,"px solid #bbb")},"&:after":{borderBottom:"".concat(7/* Arrow.Size */,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}});var noOffset={x:0,y:0};/**
Facet to which an extension can add a value to show a tooltip.
*/var showTooltip=/*@__PURE__*/Facet.define({enables:[tooltipPlugin,baseTheme$4]});var showHoverTooltip=/*@__PURE__*/Facet.define();var HoverTooltipHost=/*#__PURE__*/function(){function HoverTooltipHost(view){var _this74=this;_classCallCheck(this,HoverTooltipHost);this.view=view;this.mounted=false;this.dom=document.createElement("div");this.dom.classList.add("cm-tooltip-hover");this.manager=new TooltipViewManager(view,showHoverTooltip,function(t){return _this74.createHostedView(t);});}// Needs to be static so that host tooltip instances always match
_createClass(HoverTooltipHost,[{key:"createHostedView",value:function createHostedView(tooltip){var hostedView=tooltip.create(this.view);hostedView.dom.classList.add("cm-tooltip-section");this.dom.appendChild(hostedView.dom);if(this.mounted&&hostedView.mount)hostedView.mount(this.view);return hostedView;}},{key:"mount",value:function mount(view){var _iterator109=_createForOfIteratorHelper(this.manager.tooltipViews),_step109;try{for(_iterator109.s();!(_step109=_iterator109.n()).done;){var hostedView=_step109.value;if(hostedView.mount)hostedView.mount(view);}}catch(err){_iterator109.e(err);}finally{_iterator109.f();}this.mounted=true;}},{key:"positioned",value:function positioned(){var _iterator110=_createForOfIteratorHelper(this.manager.tooltipViews),_step110;try{for(_iterator110.s();!(_step110=_iterator110.n()).done;){var hostedView=_step110.value;if(hostedView.positioned)hostedView.positioned();}}catch(err){_iterator110.e(err);}finally{_iterator110.f();}}},{key:"update",value:function update(_update15){this.manager.update(_update15);}}],[{key:"create",value:function create(view){return new HoverTooltipHost(view);}}]);return HoverTooltipHost;}();var showHoverTooltipHost=/*@__PURE__*/showTooltip.compute([showHoverTooltip],function(state){var tooltips=state.facet(showHoverTooltip).filter(function(t){return t;});if(tooltips.length===0)return null;return{pos:Math.min.apply(Math,_toConsumableArray2(tooltips.map(function(t){return t.pos;}))),end:Math.max.apply(Math,_toConsumableArray2(tooltips.filter(function(t){return t.end!=null;}).map(function(t){return t.end;}))),create:HoverTooltipHost.create,above:tooltips[0].above,arrow:tooltips.some(function(t){return t.arrow;})};});var HoverPlugin=/*#__PURE__*/function(){function HoverPlugin(view,source,field,setHover,hoverTime){_classCallCheck(this,HoverPlugin);this.view=view;this.source=source;this.field=field;this.setHover=setHover;this.hoverTime=hoverTime;this.hoverTimeout=-1;this.restartTimeout=-1;this.pending=null;this.lastMove={x:0,y:0,target:view.dom,time:0};this.checkHover=this.checkHover.bind(this);view.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this));view.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this));}_createClass(HoverPlugin,[{key:"update",value:function update(){var _this75=this;if(this.pending){this.pending=null;clearTimeout(this.restartTimeout);this.restartTimeout=setTimeout(function(){return _this75.startHover();},20);}}},{key:"active",get:function get(){return this.view.state.field(this.field);}},{key:"checkHover",value:function checkHover(){this.hoverTimeout=-1;if(this.active)return;var hovered=Date.now()-this.lastMove.time;if(hovered<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-hovered);else this.startHover();}},{key:"startHover",value:function startHover(){var _this76=this;clearTimeout(this.restartTimeout);var lastMove=this.lastMove;var pos=this.view.contentDOM.contains(lastMove.target)?this.view.posAtCoords(lastMove):null;if(pos==null)return;var posCoords=this.view.coordsAtPos(pos);if(posCoords==null||lastMove.y<posCoords.top||lastMove.y>posCoords.bottom||lastMove.x<posCoords.left-this.view.defaultCharacterWidth||lastMove.x>posCoords.right+this.view.defaultCharacterWidth)return;var bidi=this.view.bidiSpans(this.view.state.doc.lineAt(pos)).find(function(s){return s.from<=pos&&s.to>=pos;});var rtl=bidi&&bidi.dir==Direction.RTL?-1:1;var open=this.source(this.view,pos,lastMove.x<posCoords.left?-rtl:rtl);if(open===null||open===void 0?void 0:open.then){var pending=this.pending={pos:pos};open.then(function(result){if(_this76.pending==pending){_this76.pending=null;if(result)_this76.view.dispatch({effects:_this76.setHover.of(result)});}},function(e){return logException(_this76.view.state,e,"hover tooltip");});}else if(open){this.view.dispatch({effects:this.setHover.of(open)});}}},{key:"mousemove",value:function mousemove(event){var _a;this.lastMove={x:event.clientX,y:event.clientY,target:event.target,time:Date.now()};if(this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);var tooltip=this.active;if(tooltip&&!isInTooltip(this.lastMove.target)||this.pending){var _ref51=tooltip||this.pending,pos=_ref51.pos,end=(_a=tooltip===null||tooltip===void 0?void 0:tooltip.end)!==null&&_a!==void 0?_a:pos;if(pos==end?this.view.posAtCoords(this.lastMove)!=pos:!isOverRange(this.view,pos,end,event.clientX,event.clientY,6/* Hover.MaxDist */)){this.view.dispatch({effects:this.setHover.of(null)});this.pending=null;}}}},{key:"mouseleave",value:function mouseleave(){clearTimeout(this.hoverTimeout);this.hoverTimeout=-1;if(this.active)this.view.dispatch({effects:this.setHover.of(null)});}},{key:"destroy",value:function destroy(){clearTimeout(this.hoverTimeout);this.view.dom.removeEventListener("mouseleave",this.mouseleave);this.view.dom.removeEventListener("mousemove",this.mousemove);}}]);return HoverPlugin;}();function isInTooltip(elt){for(var _cur14=elt;_cur14;_cur14=_cur14.parentNode){if(_cur14.nodeType==1&&_cur14.classList.contains("cm-tooltip"))return true;}return false;}function isOverRange(view,from,to,x,y,margin){var range=document.createRange();var fromDOM=view.domAtPos(from),toDOM=view.domAtPos(to);range.setEnd(toDOM.node,toDOM.offset);range.setStart(fromDOM.node,fromDOM.offset);var rects=range.getClientRects();range.detach();for(var _i160=0;_i160<rects.length;_i160++){var rect=rects[_i160];var dist=Math.max(rect.top-y,y-rect.bottom,rect.left-x,x-rect.right);if(dist<=margin)return true;}return false;}/**
Set up a hover tooltip, which shows up when the pointer hovers
over ranges of text. The callback is called when the mouse hovers
over the document text. It should, if there is a tooltip
associated with position `pos`, return the tooltip description
(either directly or in a promise). The `side` argument indicates
on which side of the position the pointer isit will be -1 if the
pointer is before the position, 1 if after the position.

Note that all hover tooltips are hosted within a single tooltip
container element. This allows multiple tooltips over the same
range to be "merged" together without overlapping.
*/function hoverTooltip(source){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var setHover=StateEffect.define();var hoverState=StateField.define({create:function create(){return null;},update:function update(value,tr){if(value&&(options.hideOnChange&&(tr.docChanged||tr.selection)||options.hideOn&&options.hideOn(tr,value)))return null;if(value&&tr.docChanged){var newPos=tr.changes.mapPos(value.pos,-1,MapMode.TrackDel);if(newPos==null)return null;var copy=Object.assign(Object.create(null),value);copy.pos=newPos;if(value.end!=null)copy.end=tr.changes.mapPos(value.end);value=copy;}var _iterator111=_createForOfIteratorHelper(tr.effects),_step111;try{for(_iterator111.s();!(_step111=_iterator111.n()).done;){var effect=_step111.value;if(effect.is(setHover))value=effect.value;if(effect.is(closeHoverTooltipEffect))value=null;}}catch(err){_iterator111.e(err);}finally{_iterator111.f();}return value;},provide:function provide(f){return showHoverTooltip.from(f);}});return[hoverState,ViewPlugin.define(function(view){return new HoverPlugin(view,source,hoverState,setHover,options.hoverTime||300/* Hover.Time */);}),showHoverTooltipHost];}/**
Get the active tooltip view for a given tooltip, if available.
*/function getTooltip(view,tooltip){var plugin=view.plugin(tooltipPlugin);if(!plugin)return null;var found=plugin.manager.tooltips.indexOf(tooltip);return found<0?null:plugin.manager.tooltipViews[found];}var closeHoverTooltipEffect=/*@__PURE__*/StateEffect.define();var panelConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){var topContainer,bottomContainer;var _iterator112=_createForOfIteratorHelper(configs),_step112;try{for(_iterator112.s();!(_step112=_iterator112.n()).done;){var c=_step112.value;topContainer=topContainer||c.topContainer;bottomContainer=bottomContainer||c.bottomContainer;}}catch(err){_iterator112.e(err);}finally{_iterator112.f();}return{topContainer:topContainer,bottomContainer:bottomContainer};}});/**
Get the active panel created by the given constructor, if any.
This can be useful when you need access to your panels' DOM
structure.
*/function getPanel(view,panel){var plugin=view.plugin(panelPlugin);var index=plugin?plugin.specs.indexOf(panel):-1;return index>-1?plugin.panels[index]:null;}var panelPlugin=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class7(view){_classCallCheck(this,_class7);this.input=view.state.facet(showPanel);this.specs=this.input.filter(function(s){return s;});this.panels=this.specs.map(function(spec){return spec(view);});var conf=view.state.facet(panelConfig);this.top=new PanelGroup(view,true,conf.topContainer);this.bottom=new PanelGroup(view,false,conf.bottomContainer);this.top.sync(this.panels.filter(function(p){return p.top;}));this.bottom.sync(this.panels.filter(function(p){return!p.top;}));var _iterator113=_createForOfIteratorHelper(this.panels),_step113;try{for(_iterator113.s();!(_step113=_iterator113.n()).done;){var _p3=_step113.value;_p3.dom.classList.add("cm-panel");if(_p3.mount)_p3.mount();}}catch(err){_iterator113.e(err);}finally{_iterator113.f();}}_createClass(_class7,[{key:"update",value:function update(_update16){var conf=_update16.state.facet(panelConfig);if(this.top.container!=conf.topContainer){this.top.sync([]);this.top=new PanelGroup(_update16.view,true,conf.topContainer);}if(this.bottom.container!=conf.bottomContainer){this.bottom.sync([]);this.bottom=new PanelGroup(_update16.view,false,conf.bottomContainer);}this.top.syncClasses();this.bottom.syncClasses();var input=_update16.state.facet(showPanel);if(input!=this.input){var specs=input.filter(function(x){return x;});var panels=[],_top11=[],bottom=[],mount=[];var _iterator114=_createForOfIteratorHelper(specs),_step114;try{for(_iterator114.s();!(_step114=_iterator114.n()).done;){var spec=_step114.value;var known=this.specs.indexOf(spec),panel=void 0;if(known<0){panel=spec(_update16.view);mount.push(panel);}else{panel=this.panels[known];if(panel.update)panel.update(_update16);}panels.push(panel);(panel.top?_top11:bottom).push(panel);}}catch(err){_iterator114.e(err);}finally{_iterator114.f();}this.specs=specs;this.panels=panels;this.top.sync(_top11);this.bottom.sync(bottom);for(var _i161=0,_mount=mount;_i161<_mount.length;_i161++){var _p4=_mount[_i161];_p4.dom.classList.add("cm-panel");if(_p4.mount)_p4.mount();}}else{var _iterator115=_createForOfIteratorHelper(this.panels),_step115;try{for(_iterator115.s();!(_step115=_iterator115.n()).done;){var _p5=_step115.value;if(_p5.update)_p5.update(_update16);}}catch(err){_iterator115.e(err);}finally{_iterator115.f();}}}},{key:"destroy",value:function destroy(){this.top.sync([]);this.bottom.sync([]);}}]);return _class7;}(),{provide:function provide(plugin){return EditorView.scrollMargins.of(function(view){var value=view.plugin(plugin);return value&&{top:value.top.scrollMargin(),bottom:value.bottom.scrollMargin()};});}});var PanelGroup=/*#__PURE__*/function(){function PanelGroup(view,top,container){_classCallCheck(this,PanelGroup);this.view=view;this.top=top;this.container=container;this.dom=undefined;this.classes="";this.panels=[];this.syncClasses();}_createClass(PanelGroup,[{key:"sync",value:function sync(panels){var _iterator116=_createForOfIteratorHelper(this.panels),_step116;try{for(_iterator116.s();!(_step116=_iterator116.n()).done;){var _p6=_step116.value;if(_p6.destroy&&panels.indexOf(_p6)<0)_p6.destroy();}}catch(err){_iterator116.e(err);}finally{_iterator116.f();}this.panels=panels;this.syncDOM();}},{key:"syncDOM",value:function syncDOM(){if(this.panels.length==0){if(this.dom){this.dom.remove();this.dom=undefined;}return;}if(!this.dom){this.dom=document.createElement("div");this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom";this.dom.style[this.top?"top":"bottom"]="0";var _parent11=this.container||this.view.dom;_parent11.insertBefore(this.dom,this.top?_parent11.firstChild:null);}var curDOM=this.dom.firstChild;var _iterator117=_createForOfIteratorHelper(this.panels),_step117;try{for(_iterator117.s();!(_step117=_iterator117.n()).done;){var panel=_step117.value;if(panel.dom.parentNode==this.dom){while(curDOM!=panel.dom){curDOM=rm(curDOM);}curDOM=curDOM.nextSibling;}else{this.dom.insertBefore(panel.dom,curDOM);}}}catch(err){_iterator117.e(err);}finally{_iterator117.f();}while(curDOM){curDOM=rm(curDOM);}}},{key:"scrollMargin",value:function scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top);}},{key:"syncClasses",value:function syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;var _iterator118=_createForOfIteratorHelper(this.classes.split(" ")),_step118;try{for(_iterator118.s();!(_step118=_iterator118.n()).done;){var cls=_step118.value;if(cls)this.container.classList.remove(cls);}}catch(err){_iterator118.e(err);}finally{_iterator118.f();}var _iterator119=_createForOfIteratorHelper((this.classes=this.view.themeClasses).split(" ")),_step119;try{for(_iterator119.s();!(_step119=_iterator119.n()).done;){var _cls=_step119.value;if(_cls)this.container.classList.add(_cls);}}catch(err){_iterator119.e(err);}finally{_iterator119.f();}}}]);return PanelGroup;}();function rm(node){var next=node.nextSibling;node.remove();return next;}/**
Opening a panel is done by providing a constructor function for
the panel through this facet. (The panel is closed again when its
constructor is no longer provided.) Values of `null` are ignored.
*/var showPanel=/*@__PURE__*/Facet.define({enables:panelPlugin});/**
A gutter marker represents a bit of information attached to a line
in a specific gutter. Your own custom markers have to extend this
class.
*/var GutterMarker=/*#__PURE__*/function(_RangeValue2){_inherits(GutterMarker,_RangeValue2);var _super40=_createSuper(GutterMarker);function GutterMarker(){_classCallCheck(this,GutterMarker);return _super40.apply(this,arguments);}_createClass(GutterMarker,[{key:"compare",value:/**
    @internal
    */function compare(other){return this==other||this.constructor==other.constructor&&this.eq(other);}/**
    Compare this marker to another marker of the same type.
    */},{key:"eq",value:function eq(other){return false;}/**
    Called if the marker has a `toDOM` method and its representation
    was removed from a gutter.
    */},{key:"destroy",value:function destroy(dom){}}]);return GutterMarker;}(RangeValue);GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=undefined;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=true;/**
Facet used to add a class to all gutter elements for a given line.
Markers given to this facet should _only_ define an
[`elementclass`](https://codemirror.net/6/docs/ref/#view.GutterMarker.elementClass), not a
[`toDOM`](https://codemirror.net/6/docs/ref/#view.GutterMarker.toDOM) (or the marker will appear
in all gutters for the line).
*/var gutterLineClass=/*@__PURE__*/Facet.define();var defaults$1={"class":"",renderEmptyElements:false,elementStyle:"",markers:function markers(){return RangeSet.empty;},lineMarker:function lineMarker(){return null;},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}};var activeGutters=/*@__PURE__*/Facet.define();/**
Define an editor gutter. The order in which the gutters appear is
determined by their extension priority.
*/function gutter(config){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),config))];}var unfixGutters=/*@__PURE__*/Facet.define({combine:function combine(values){return values.some(function(x){return x;});}});/**
The gutter-drawing plugin is automatically enabled when you add a
gutter, but you can use this function to explicitly configure it.

Unless `fixed` is explicitly set to `false`, the gutters are
fixed, meaning they don't scroll along with the content
horizontally (except on Internet Explorer, which doesn't support
CSS [`position:
sticky`](https://developer.mozilla.org/en-US/docs/Web/CSS/position#sticky)).
*/function gutters(config){var result=[gutterView];if(config&&config.fixed===false)result.push(unfixGutters.of(true));return result;}var gutterView=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class8(view){_classCallCheck(this,_class8);this.view=view;this.prevViewport=view.viewport;this.dom=document.createElement("div");this.dom.className="cm-gutters";this.dom.setAttribute("aria-hidden","true");this.dom.style.minHeight=this.view.contentHeight+"px";this.gutters=view.state.facet(activeGutters).map(function(conf){return new SingleGutterView(view,conf);});var _iterator120=_createForOfIteratorHelper(this.gutters),_step120;try{for(_iterator120.s();!(_step120=_iterator120.n()).done;){var _gutter=_step120.value;this.dom.appendChild(_gutter.dom);}}catch(err){_iterator120.e(err);}finally{_iterator120.f();}this.fixed=!view.state.facet(unfixGutters);if(this.fixed){// FIXME IE11 fallback, which doesn't support position: sticky,
// by using position: relative + event handlers that realign the
// gutter (or just force fixed=false on IE11?)
this.dom.style.position="sticky";}this.syncGutters(false);view.scrollDOM.insertBefore(this.dom,view.contentDOM);}_createClass(_class8,[{key:"update",value:function update(_update17){if(this.updateGutters(_update17)){// Detach during sync when the viewport changed significantly
// (such as during scrolling), since for large updates that is
// faster.
var vpA=this.prevViewport,vpB=_update17.view.viewport;var vpOverlap=Math.min(vpA.to,vpB.to)-Math.max(vpA.from,vpB.from);this.syncGutters(vpOverlap<(vpB.to-vpB.from)*0.8);}if(_update17.geometryChanged)this.dom.style.minHeight=this.view.contentHeight+"px";if(this.view.state.facet(unfixGutters)!=!this.fixed){this.fixed=!this.fixed;this.dom.style.position=this.fixed?"sticky":"";}this.prevViewport=_update17.view.viewport;}},{key:"syncGutters",value:function syncGutters(detach){var _this77=this;var after=this.dom.nextSibling;if(detach)this.dom.remove();var lineClasses=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from);var classSet=[];var contexts=this.gutters.map(function(gutter){return new UpdateContext(gutter,_this77.view.viewport,-_this77.view.documentPadding.top);});var _iterator121=_createForOfIteratorHelper(this.view.viewportLineBlocks),_step121;try{for(_iterator121.s();!(_step121=_iterator121.n()).done;){var line=_step121.value;var _text5=void 0;if(Array.isArray(line.type)){var _iterator123=_createForOfIteratorHelper(line.type),_step123;try{for(_iterator123.s();!(_step123=_iterator123.n()).done;){var b=_step123.value;if(b.type==BlockType.Text){_text5=b;break;}}}catch(err){_iterator123.e(err);}finally{_iterator123.f();}}else{_text5=line.type==BlockType.Text?line:undefined;}if(!_text5)continue;if(classSet.length)classSet=[];advanceCursor(lineClasses,classSet,line.from);var _iterator124=_createForOfIteratorHelper(contexts),_step124;try{for(_iterator124.s();!(_step124=_iterator124.n()).done;){var cx=_step124.value;cx.line(this.view,_text5,classSet);}}catch(err){_iterator124.e(err);}finally{_iterator124.f();}}}catch(err){_iterator121.e(err);}finally{_iterator121.f();}var _iterator122=_createForOfIteratorHelper(contexts),_step122;try{for(_iterator122.s();!(_step122=_iterator122.n()).done;){var _cx=_step122.value;_cx.finish();}}catch(err){_iterator122.e(err);}finally{_iterator122.f();}if(detach)this.view.scrollDOM.insertBefore(this.dom,after);}},{key:"updateGutters",value:function updateGutters(update){var prev=update.startState.facet(activeGutters),cur=update.state.facet(activeGutters);var change=update.docChanged||update.heightChanged||update.viewportChanged||!RangeSet.eq(update.startState.facet(gutterLineClass),update.state.facet(gutterLineClass),update.view.viewport.from,update.view.viewport.to);if(prev==cur){var _iterator125=_createForOfIteratorHelper(this.gutters),_step125;try{for(_iterator125.s();!(_step125=_iterator125.n()).done;){var _gutter2=_step125.value;if(_gutter2.update(update))change=true;}}catch(err){_iterator125.e(err);}finally{_iterator125.f();}}else{change=true;var _gutters=[];var _iterator126=_createForOfIteratorHelper(cur),_step126;try{for(_iterator126.s();!(_step126=_iterator126.n()).done;){var conf=_step126.value;var known=prev.indexOf(conf);if(known<0){_gutters.push(new SingleGutterView(this.view,conf));}else{this.gutters[known].update(update);_gutters.push(this.gutters[known]);}}}catch(err){_iterator126.e(err);}finally{_iterator126.f();}var _iterator127=_createForOfIteratorHelper(this.gutters),_step127;try{for(_iterator127.s();!(_step127=_iterator127.n()).done;){var _g2=_step127.value;_g2.dom.remove();if(_gutters.indexOf(_g2)<0)_g2.destroy();}}catch(err){_iterator127.e(err);}finally{_iterator127.f();}for(var _i162=0,_gutters2=_gutters;_i162<_gutters2.length;_i162++){var g=_gutters2[_i162];this.dom.appendChild(g.dom);}this.gutters=_gutters;}return change;}},{key:"destroy",value:function destroy(){var _iterator128=_createForOfIteratorHelper(this.gutters),_step128;try{for(_iterator128.s();!(_step128=_iterator128.n()).done;){var view=_step128.value;view.destroy();}}catch(err){_iterator128.e(err);}finally{_iterator128.f();}this.dom.remove();}}]);return _class8;}(),{provide:function provide(plugin){return EditorView.scrollMargins.of(function(view){var value=view.plugin(plugin);if(!value||value.gutters.length==0||!value.fixed)return null;return view.textDirection==Direction.LTR?{left:value.dom.offsetWidth}:{right:value.dom.offsetWidth};});}});function asArray(val){return Array.isArray(val)?val:[val];}function advanceCursor(cursor,collect,pos){while(cursor.value&&cursor.from<=pos){if(cursor.from==pos)collect.push(cursor.value);cursor.next();}}var UpdateContext=/*#__PURE__*/function(){function UpdateContext(gutter,viewport,height){_classCallCheck(this,UpdateContext);this.gutter=gutter;this.height=height;this.localMarkers=[];this.i=0;this.cursor=RangeSet.iter(gutter.markers,viewport.from);}_createClass(UpdateContext,[{key:"line",value:function line(view,_line3,extraMarkers){if(this.localMarkers.length)this.localMarkers=[];advanceCursor(this.cursor,this.localMarkers,_line3.from);var localMarkers=extraMarkers.length?this.localMarkers.concat(extraMarkers):this.localMarkers;var forLine=this.gutter.config.lineMarker(view,_line3,localMarkers);if(forLine)localMarkers.unshift(forLine);var gutter=this.gutter;if(localMarkers.length==0&&!gutter.config.renderEmptyElements)return;var above=_line3.top-this.height;if(this.i==gutter.elements.length){var newElt=new GutterElement(view,_line3.height,above,localMarkers);gutter.elements.push(newElt);gutter.dom.appendChild(newElt.dom);}else{gutter.elements[this.i].update(view,_line3.height,above,localMarkers);}this.height=_line3.bottom;this.i++;}},{key:"finish",value:function finish(){var gutter=this.gutter;while(gutter.elements.length>this.i){var _last7=gutter.elements.pop();gutter.dom.removeChild(_last7.dom);_last7.destroy();}}}]);return UpdateContext;}();var SingleGutterView=/*#__PURE__*/function(){function SingleGutterView(view,config){var _this78=this;_classCallCheck(this,SingleGutterView);this.view=view;this.config=config;this.elements=[];this.spacer=null;this.dom=document.createElement("div");this.dom.className="cm-gutter"+(this.config["class"]?" "+this.config["class"]:"");var _loop9=function _loop9(prop){_this78.dom.addEventListener(prop,function(event){var line=view.lineBlockAtHeight(event.clientY-view.documentTop);if(config.domEventHandlers[prop](view,line,event))event.preventDefault();});};for(var prop in config.domEventHandlers){_loop9(prop);}this.markers=asArray(config.markers(view));if(config.initialSpacer){this.spacer=new GutterElement(view,0,0,[config.initialSpacer(view)]);this.dom.appendChild(this.spacer.dom);this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none";}}_createClass(SingleGutterView,[{key:"update",value:function update(_update18){var prevMarkers=this.markers;this.markers=asArray(this.config.markers(_update18.view));if(this.spacer&&this.config.updateSpacer){var updated=this.config.updateSpacer(this.spacer.markers[0],_update18);if(updated!=this.spacer.markers[0])this.spacer.update(_update18.view,0,0,[updated]);}var vp=_update18.view.viewport;return!RangeSet.eq(this.markers,prevMarkers,vp.from,vp.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(_update18):false);}},{key:"destroy",value:function destroy(){var _iterator129=_createForOfIteratorHelper(this.elements),_step129;try{for(_iterator129.s();!(_step129=_iterator129.n()).done;){var elt=_step129.value;elt.destroy();}}catch(err){_iterator129.e(err);}finally{_iterator129.f();}}}]);return SingleGutterView;}();var GutterElement=/*#__PURE__*/function(){function GutterElement(view,height,above,markers){_classCallCheck(this,GutterElement);this.height=-1;this.above=0;this.markers=[];this.dom=document.createElement("div");this.dom.className="cm-gutterElement";this.update(view,height,above,markers);}_createClass(GutterElement,[{key:"update",value:function update(view,height,above,markers){if(this.height!=height)this.dom.style.height=(this.height=height)+"px";if(this.above!=above)this.dom.style.marginTop=(this.above=above)?above+"px":"";if(!sameMarkers(this.markers,markers))this.setMarkers(view,markers);}},{key:"setMarkers",value:function setMarkers(view,markers){var cls="cm-gutterElement",domPos=this.dom.firstChild;for(var iNew=0,iOld=0;;){var skipTo=iOld,marker=iNew<markers.length?markers[iNew++]:null,matched=false;if(marker){var c=marker.elementClass;if(c)cls+=" "+c;for(var _i163=iOld;_i163<this.markers.length;_i163++){if(this.markers[_i163].compare(marker)){skipTo=_i163;matched=true;break;}}}else{skipTo=this.markers.length;}while(iOld<skipTo){var next=this.markers[iOld++];if(next.toDOM){next.destroy(domPos);var _after5=domPos.nextSibling;domPos.remove();domPos=_after5;}}if(!marker)break;if(marker.toDOM){if(matched)domPos=domPos.nextSibling;else this.dom.insertBefore(marker.toDOM(view),domPos);}if(matched)iOld++;}this.dom.className=cls;this.markers=markers;}},{key:"destroy",value:function destroy(){this.setMarkers(null,[]);// First argument not used unless creating markers
}}]);return GutterElement;}();function sameMarkers(a,b){if(a.length!=b.length)return false;for(var _i164=0;_i164<a.length;_i164++){if(!a[_i164].compare(b[_i164]))return false;}return true;}/**
Facet used to provide markers to the line number gutter.
*/var lineNumberMarkers=/*@__PURE__*/Facet.define();var lineNumberConfig=/*@__PURE__*/Facet.define({combine:function combine(values){return combineConfig(values,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function domEventHandlers(a,b){var result=Object.assign({},a);var _loop10=function _loop10(event){var exists=result[event],add=b[event];result[event]=exists?function(view,line,event){return exists(view,line,event)||add(view,line,event);}:add;};for(var event in b){_loop10(event);}return result;}});}});var NumberMarker=/*#__PURE__*/function(_GutterMarker){_inherits(NumberMarker,_GutterMarker);var _super41=_createSuper(NumberMarker);function NumberMarker(number){var _this79;_classCallCheck(this,NumberMarker);_this79=_super41.call(this);_this79.number=number;return _this79;}_createClass(NumberMarker,[{key:"eq",value:function eq(other){return this.number==other.number;}},{key:"toDOM",value:function toDOM(){return document.createTextNode(this.number);}}]);return NumberMarker;}(GutterMarker);function formatNumber(view,number){return view.state.facet(lineNumberConfig).formatNumber(number,view.state);}var lineNumberGutter=/*@__PURE__*/activeGutters.compute([lineNumberConfig],function(state){return{"class":"cm-lineNumbers",renderEmptyElements:false,markers:function markers(view){return view.state.facet(lineNumberMarkers);},lineMarker:function lineMarker(view,line,others){if(others.some(function(m){return m.toDOM;}))return null;return new NumberMarker(formatNumber(view,view.state.doc.lineAt(line.from).number));},lineMarkerChange:function lineMarkerChange(update){return update.startState.facet(lineNumberConfig)!=update.state.facet(lineNumberConfig);},initialSpacer:function initialSpacer(view){return new NumberMarker(formatNumber(view,maxLineNumber(view.state.doc.lines)));},updateSpacer:function updateSpacer(spacer,update){var max=formatNumber(update.view,maxLineNumber(update.view.state.doc.lines));return max==spacer.number?spacer:new NumberMarker(max);},domEventHandlers:state.facet(lineNumberConfig).domEventHandlers};});/**
Create a line number gutter extension.
*/function lineNumbers(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[lineNumberConfig.of(config),gutters(),lineNumberGutter];}function maxLineNumber(lines){var last=9;while(last<lines){last=last*10+9;}return last;}var activeLineGutterMarker=/*@__PURE__*/new(/*#__PURE__*/function(_GutterMarker2){_inherits(_class9,_GutterMarker2);var _super42=_createSuper(_class9);function _class9(){var _this80;_classCallCheck(this,_class9);_this80=_super42.apply(this,arguments);_this80.elementClass="cm-activeLineGutter";return _this80;}return _createClass(_class9);}(GutterMarker))();var activeLineGutterHighlighter=/*@__PURE__*/gutterLineClass.compute(["selection"],function(state){var marks=[],last=-1;var _iterator130=_createForOfIteratorHelper(state.selection.ranges),_step130;try{for(_iterator130.s();!(_step130=_iterator130.n()).done;){var _range11=_step130.value;var linePos=state.doc.lineAt(_range11.head).from;if(linePos>last){last=linePos;marks.push(activeLineGutterMarker.range(linePos));}}}catch(err){_iterator130.e(err);}finally{_iterator130.f();}return RangeSet.of(marks);});/**
Returns an extension that adds a `cm-activeLineGutter` class to
all gutter elements on the [active
line](https://codemirror.net/6/docs/ref/#view.highlightActiveLine).
*/function highlightActiveLineGutter(){return activeLineGutterHighlighter;}// FIXME profile adding a per-Tree TreeNode cache, validating it by
// parent pointer
/// The default maximum length of a `TreeBuffer` node.
var DefaultBufferLength=1024;var nextPropID=0;var Range=/*#__PURE__*/_createClass(function Range(from,to){_classCallCheck(this,Range);this.from=from;this.to=to;});/// Each [node type](#common.NodeType) or [individual tree](#common.Tree)
/// can have metadata associated with it in props. Instances of this
/// class represent prop names.
var NodeProp=/*#__PURE__*/function(){/// Create a new node prop type.
function NodeProp(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,NodeProp);this.id=nextPropID++;this.perNode=!!config.perNode;this.deserialize=config.deserialize||function(){throw new Error("This node type doesn't define a deserialize function");};}/// This is meant to be used with
/// [`NodeSet.extend`](#common.NodeSet.extend) or
/// [`LRParser.configure`](#lr.ParserConfig.props) to compute
/// prop values for each node type in the set. Takes a [match
/// object](#common.NodeType^match) or function that returns undefined
/// if the node type doesn't get this prop, and the prop's value if
/// it does.
_createClass(NodeProp,[{key:"add",value:function add(match){var _this81=this;if(this.perNode)throw new RangeError("Can't add per-node props to node types");if(typeof match!="function")match=NodeType.match(match);return function(type){var result=match(type);return result===undefined?null:[_this81,result];};}}]);return NodeProp;}();/// Prop that is used to describe matching delimiters. For opening
/// delimiters, this holds an array of node names (written as a
/// space-separated string when declaring this prop in a grammar)
/// for the node types of closing delimiters that match it.
NodeProp.closedBy=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});/// The inverse of [`closedBy`](#common.NodeProp^closedBy). This is
/// attached to closing delimiters, holding an array of node names
/// of types of matching opening delimiters.
NodeProp.openedBy=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});/// Used to assign node types to groups (for example, all node
/// types that represent an expression could be tagged with an
/// `"Expression"` group).
NodeProp.group=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});/// The hash of the [context](#lr.ContextTracker.constructor)
/// that the node was parsed in, if any. Used to limit reuse of
/// contextual nodes.
NodeProp.contextHash=new NodeProp({perNode:true});/// The distance beyond the end of the node that the tokenizer
/// looked ahead for any of the tokens inside the node. (The LR
/// parser only stores this when it is larger than 25, for
/// efficiency reasons.)
NodeProp.lookAhead=new NodeProp({perNode:true});/// This per-node prop is used to replace a given node, or part of a
/// node, with another tree. This is useful to include trees from
/// different languages in mixed-language parsers.
NodeProp.mounted=new NodeProp({perNode:true});var noProps=Object.create(null);/// Each node in a syntax tree has a node type associated with it.
var NodeType=/*#__PURE__*/function(){/// @internal
function NodeType(/// The name of the node type. Not necessarily unique, but if the
/// grammar was written properly, different node types with the
/// same name within a node set should play the same semantic
/// role.
name,/// @internal
props,/// The id of this node in its set. Corresponds to the term ids
/// used in the parser.
id){var flags=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,NodeType);this.name=name;this.props=props;this.id=id;this.flags=flags;}/// Define a node type.
_createClass(NodeType,[{key:"prop",value:/// Retrieves a node prop for this type. Will return `undefined` if
/// the prop isn't present on this node.
function prop(_prop){return this.props[_prop.id];}/// True when this is the top node of a grammar.
},{key:"isTop",get:function get(){return(this.flags&1/* Top */)>0;}/// True when this node is produced by a skip rule.
},{key:"isSkipped",get:function get(){return(this.flags&2/* Skipped */)>0;}/// Indicates whether this is an error node.
},{key:"isError",get:function get(){return(this.flags&4/* Error */)>0;}/// When true, this node type doesn't correspond to a user-declared
/// named node, for example because it is used to cache repetition.
},{key:"isAnonymous",get:function get(){return(this.flags&8/* Anonymous */)>0;}/// Returns true when this node's name or one of its
/// [groups](#common.NodeProp^group) matches the given string.
},{key:"is",value:function is(name){if(typeof name=='string'){if(this.name==name)return true;var group=this.prop(NodeProp.group);return group?group.indexOf(name)>-1:false;}return this.id==name;}/// Create a function from node types to arbitrary values by
/// specifying an object whose property names are node or
/// [group](#common.NodeProp^group) names. Often useful with
/// [`NodeProp.add`](#common.NodeProp.add). You can put multiple
/// names, separated by spaces, in a single property name to map
/// multiple node names to a single value.
}],[{key:"define",value:function define(spec){var props=spec.props&&spec.props.length?Object.create(null):noProps;var flags=(spec.top?1/* Top */:0)|(spec.skipped?2/* Skipped */:0)|(spec.error?4/* Error */:0)|(spec.name==null?8/* Anonymous */:0);var type=new NodeType(spec.name||"",props,spec.id,flags);if(spec.props){var _iterator131=_createForOfIteratorHelper(spec.props),_step131;try{for(_iterator131.s();!(_step131=_iterator131.n()).done;){var src=_step131.value;if(!Array.isArray(src))src=src(type);if(src){if(src[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");props[src[0].id]=src[1];}}}catch(err){_iterator131.e(err);}finally{_iterator131.f();}}return type;}},{key:"match",value:function match(map){var direct=Object.create(null);for(var prop in map){var _iterator132=_createForOfIteratorHelper(prop.split(" ")),_step132;try{for(_iterator132.s();!(_step132=_iterator132.n()).done;){var _name7=_step132.value;direct[_name7]=map[prop];}}catch(err){_iterator132.e(err);}finally{_iterator132.f();}}return function(node){for(var groups=node.prop(NodeProp.group),_i165=-1;_i165<(groups?groups.length:0);_i165++){var found=direct[_i165<0?node.name:groups[_i165]];if(found)return found;}};}}]);return NodeType;}();/// An empty dummy node type to use when no actual type is available.
NodeType.none=new NodeType("",Object.create(null),0,8/* Anonymous */);/// A node set holds a collection of node types. It is used to
/// compactly represent trees by storing their type ids, rather than a
/// full pointer to the type object, in a numeric array. Each parser
/// [has](#lr.LRParser.nodeSet) a node set, and [tree
/// buffers](#common.TreeBuffer) can only store collections of nodes
/// from the same set. A set can have a maximum of 2**16 (65536) node
/// types in it, so that the ids fit into 16-bit typed array slots.
var NodeSet=/*#__PURE__*/function(){/// Create a set with the given types. The `id` property of each
/// type should correspond to its position within the array.
function NodeSet(/// The node types in this set, by id.
types){_classCallCheck(this,NodeSet);this.types=types;for(var _i166=0;_i166<types.length;_i166++){if(types[_i166].id!=_i166)throw new RangeError("Node type ids should correspond to array positions when creating a node set");}}/// Create a copy of this set with some node properties added. The
/// arguments to this method can be created with
/// [`NodeProp.add`](#common.NodeProp.add).
_createClass(NodeSet,[{key:"extend",value:function extend(){var newTypes=[];for(var _len7=arguments.length,props=new Array(_len7),_key9=0;_key9<_len7;_key9++){props[_key9]=arguments[_key9];}var _iterator133=_createForOfIteratorHelper(this.types),_step133;try{for(_iterator133.s();!(_step133=_iterator133.n()).done;){var type=_step133.value;var newProps=null;var _iterator134=_createForOfIteratorHelper(props),_step134;try{for(_iterator134.s();!(_step134=_iterator134.n()).done;){var source=_step134.value;var _add=source(type);if(_add){if(!newProps)newProps=Object.assign({},type.props);newProps[_add[0].id]=_add[1];}}}catch(err){_iterator134.e(err);}finally{_iterator134.f();}newTypes.push(newProps?new NodeType(type.name,newProps,type.id,type.flags):type);}}catch(err){_iterator133.e(err);}finally{_iterator133.f();}return new NodeSet(newTypes);}}]);return NodeSet;}();var CachedNode=new WeakMap(),CachedInnerNode=new WeakMap();/// Options that control iteration. Can be combined with the `|`
/// operator to enable multiple ones.
var IterMode;(function(IterMode){/// When enabled, iteration will only visit [`Tree`](#common.Tree)
/// objects, not nodes packed into
/// [`TreeBuffer`](#common.TreeBuffer)s.
IterMode[IterMode["ExcludeBuffers"]=1]="ExcludeBuffers";/// Enable this to make iteration include anonymous nodes (such as
/// the nodes that wrap repeated grammar constructs into a balanced
/// tree).
IterMode[IterMode["IncludeAnonymous"]=2]="IncludeAnonymous";/// By default, regular [mounted](#common.NodeProp^mounted) nodes
/// replace their base node in iteration. Enable this to ignore them
/// instead.
IterMode[IterMode["IgnoreMounts"]=4]="IgnoreMounts";/// This option only applies in
/// [`enter`](#common.SyntaxNode.enter)-style methods. It tells the
/// library to not enter mounted overlays if one covers the given
/// position.
IterMode[IterMode["IgnoreOverlays"]=8]="IgnoreOverlays";})(IterMode||(IterMode={}));/// A piece of syntax tree. There are two ways to approach these
/// trees: the way they are actually stored in memory, and the
/// convenient way.
///
/// Syntax trees are stored as a tree of `Tree` and `TreeBuffer`
/// objects. By packing detail information into `TreeBuffer` leaf
/// nodes, the representation is made a lot more memory-efficient.
///
/// However, when you want to actually work with tree nodes, this
/// representation is very awkward, so most client code will want to
/// use the [`TreeCursor`](#common.TreeCursor) or
/// [`SyntaxNode`](#common.SyntaxNode) interface instead, which provides
/// a view on some part of this data structure, and can be used to
/// move around to adjacent nodes.
var Tree=/*#__PURE__*/function(){/// Construct a new tree. See also [`Tree.build`](#common.Tree^build).
function Tree(/// The type of the top node.
type,/// This node's child nodes.
children,/// The positions (offsets relative to the start of this tree) of
/// the children.
positions,/// The total length of this tree
length,/// Per-node [node props](#common.NodeProp) to associate with this node.
props){_classCallCheck(this,Tree);this.type=type;this.children=children;this.positions=positions;this.length=length;/// @internal
this.props=null;if(props&&props.length){this.props=Object.create(null);var _iterator135=_createForOfIteratorHelper(props),_step135;try{for(_iterator135.s();!(_step135=_iterator135.n()).done;){var _step135$value=_slicedToArray(_step135.value,2),prop=_step135$value[0],value=_step135$value[1];this.props[typeof prop=="number"?prop:prop.id]=value;}}catch(err){_iterator135.e(err);}finally{_iterator135.f();}}}/// @internal
_createClass(Tree,[{key:"toString",value:function toString(){var mounted=this.prop(NodeProp.mounted);if(mounted&&!mounted.overlay)return mounted.tree.toString();var children="";var _iterator136=_createForOfIteratorHelper(this.children),_step136;try{for(_iterator136.s();!(_step136=_iterator136.n()).done;){var ch=_step136.value;var str=ch.toString();if(str){if(children)children+=",";children+=str;}}}catch(err){_iterator136.e(err);}finally{_iterator136.f();}return!this.type.name?children:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(children.length?"("+children+")":"");}/// Get a [tree cursor](#common.TreeCursor) positioned at the top of
/// the tree. Mode can be used to [control](#common.IterMode) which
/// nodes the cursor visits.
},{key:"cursor",value:function cursor(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new TreeCursor(this.topNode,mode);}/// Get a [tree cursor](#common.TreeCursor) pointing into this tree
/// at the given position and side (see
/// [`moveTo`](#common.TreeCursor.moveTo).
},{key:"cursorAt",value:function cursorAt(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var scope=CachedNode.get(this)||this.topNode;var cursor=new TreeCursor(scope);cursor.moveTo(pos,side);CachedNode.set(this,cursor._tree);return cursor;}/// Get a [syntax node](#common.SyntaxNode) object for the top of the
/// tree.
},{key:"topNode",get:function get(){return new TreeNode(this,0,0,null);}/// Get the [syntax node](#common.SyntaxNode) at the given position.
/// If `side` is -1, this will move into nodes that end at the
/// position. If 1, it'll move into nodes that start at the
/// position. With 0, it'll only enter nodes that cover the position
/// from both sides.
///
/// Note that this will not enter
/// [overlays](#common.MountedTree.overlay), and you often want
/// [`resolveInner`](#common.Tree.resolveInner) instead.
},{key:"resolve",value:function resolve(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var node=resolveNode(CachedNode.get(this)||this.topNode,pos,side,false);CachedNode.set(this,node);return node;}/// Like [`resolve`](#common.Tree.resolve), but will enter
/// [overlaid](#common.MountedTree.overlay) nodes, producing a syntax node
/// pointing into the innermost overlaid tree at the given position
/// (with parent links going through all parent structure, including
/// the host trees).
},{key:"resolveInner",value:function resolveInner(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var node=resolveNode(CachedInnerNode.get(this)||this.topNode,pos,side,true);CachedInnerNode.set(this,node);return node;}/// Iterate over the tree and its children, calling `enter` for any
/// node that touches the `from`/`to` region (if given) before
/// running over such a node's children, and `leave` (if given) when
/// leaving the node. When `enter` returns `false`, that node will
/// not have its children iterated over (or `leave` called).
},{key:"iterate",value:function iterate(spec){var enter=spec.enter,leave=spec.leave,_spec$from=spec.from,from=_spec$from===void 0?0:_spec$from,_spec$to2=spec.to,to=_spec$to2===void 0?this.length:_spec$to2;for(var c=this.cursor((spec.mode||0)|IterMode.IncludeAnonymous);;){var entered=false;if(c.from<=to&&c.to>=from&&(c.type.isAnonymous||enter(c)!==false)){if(c.firstChild())continue;entered=true;}for(;;){if(entered&&leave&&!c.type.isAnonymous)leave(c);if(c.nextSibling())break;if(!c.parent())return;entered=true;}}}/// Get the value of the given [node prop](#common.NodeProp) for this
/// node. Works with both per-node and per-type props.
},{key:"prop",value:function prop(_prop2){return!_prop2.perNode?this.type.prop(_prop2):this.props?this.props[_prop2.id]:undefined;}/// Returns the node's [per-node props](#common.NodeProp.perNode) in a
/// format that can be passed to the [`Tree`](#common.Tree)
/// constructor.
},{key:"propValues",get:function get(){var result=[];if(this.props)for(var _id2 in this.props){result.push([+_id2,this.props[_id2]]);}return result;}/// Balance the direct children of this tree, producing a copy of
/// which may have children grouped into subtrees with type
/// [`NodeType.none`](#common.NodeType^none).
},{key:"balance",value:function balance(){var _this82=this;var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this.children.length<=8/* BranchFactor */?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,function(children,positions,length){return new Tree(_this82.type,children,positions,length,_this82.propValues);},config.makeTree||function(children,positions,length){return new Tree(NodeType.none,children,positions,length);});}/// Build a tree from a postfix-ordered buffer of node information,
/// or a cursor over such a buffer.
}],[{key:"build",value:function build(data){return buildTree(data);}}]);return Tree;}();/// The empty tree
Tree.empty=new Tree(NodeType.none,[],[],0);var FlatBufferCursor=/*#__PURE__*/function(){function FlatBufferCursor(buffer,index){_classCallCheck(this,FlatBufferCursor);this.buffer=buffer;this.index=index;}_createClass(FlatBufferCursor,[{key:"id",get:function get(){return this.buffer[this.index-4];}},{key:"start",get:function get(){return this.buffer[this.index-3];}},{key:"end",get:function get(){return this.buffer[this.index-2];}},{key:"size",get:function get(){return this.buffer[this.index-1];}},{key:"pos",get:function get(){return this.index;}},{key:"next",value:function next(){this.index-=4;}},{key:"fork",value:function fork(){return new FlatBufferCursor(this.buffer,this.index);}}]);return FlatBufferCursor;}();/// Tree buffers contain (type, start, end, endIndex) quads for each
/// node. In such a buffer, nodes are stored in prefix order (parents
/// before children, with the endIndex of the parent indicating which
/// children belong to it).
var TreeBuffer=/*#__PURE__*/function(){/// Create a tree buffer.
function TreeBuffer(/// The buffer's content.
buffer,/// The total length of the group of nodes in the buffer.
length,/// The node set used in this buffer.
set){_classCallCheck(this,TreeBuffer);this.buffer=buffer;this.length=length;this.set=set;}/// @internal
_createClass(TreeBuffer,[{key:"type",get:function get(){return NodeType.none;}/// @internal
},{key:"toString",value:function toString(){var result=[];for(var index=0;index<this.buffer.length;){result.push(this.childString(index));index=this.buffer[index+3];}return result.join(",");}/// @internal
},{key:"childString",value:function childString(index){var id=this.buffer[index],endIndex=this.buffer[index+3];var type=this.set.types[id],result=type.name;if(/\W/.test(result)&&!type.isError)result=JSON.stringify(result);index+=4;if(endIndex==index)return result;var children=[];while(index<endIndex){children.push(this.childString(index));index=this.buffer[index+3];}return result+"("+children.join(",")+")";}/// @internal
},{key:"findChild",value:function findChild(startIndex,endIndex,dir,pos,side){var buffer=this.buffer,pick=-1;for(var _i167=startIndex;_i167!=endIndex;_i167=buffer[_i167+3]){if(checkSide(side,pos,buffer[_i167+1],buffer[_i167+2])){pick=_i167;if(dir>0)break;}}return pick;}/// @internal
},{key:"slice",value:function slice(startI,endI,from,to){var b=this.buffer;var copy=new Uint16Array(endI-startI);for(var _i168=startI,j=0;_i168<endI;){copy[j++]=b[_i168++];copy[j++]=b[_i168++]-from;copy[j++]=b[_i168++]-from;copy[j++]=b[_i168++]-startI;}return new TreeBuffer(copy,to-from,this.set);}}]);return TreeBuffer;}();function checkSide(side,pos,from,to){switch(side){case-2/* Before */:return from<pos;case-1/* AtOrBefore */:return to>=pos&&from<pos;case 0/* Around */:return from<pos&&to>pos;case 1/* AtOrAfter */:return from<=pos&&to>pos;case 2/* After */:return to>pos;case 4/* DontCare */:return true;}}function _enterUnfinishedNodesBefore(node,pos){var scan=node.childBefore(pos);while(scan){var _last8=scan.lastChild;if(!_last8||_last8.to!=scan.to)break;if(_last8.type.isError&&_last8.from==_last8.to){node=scan;scan=_last8.prevSibling;}else{scan=_last8;}}return node;}function resolveNode(node,pos,side,overlays){var _a;// Move up to a node that actually holds the position, if possible
while(node.from==node.to||(side<1?node.from>=pos:node.from>pos)||(side>-1?node.to<=pos:node.to<pos)){var _parent12=!overlays&&node instanceof TreeNode&&node.index<0?null:node.parent;if(!_parent12)return node;node=_parent12;}var mode=overlays?0:IterMode.IgnoreOverlays;// Must go up out of overlays when those do not overlap with pos
if(overlays)for(var scan=node,_parent13=scan.parent;_parent13;scan=_parent13,_parent13=scan.parent){if(scan instanceof TreeNode&&scan.index<0&&((_a=_parent13.enter(pos,side,mode))===null||_a===void 0?void 0:_a.from)!=scan.from)node=_parent13;}for(;;){var inner=node.enter(pos,side,mode);if(!inner)return node;node=inner;}}var TreeNode=/*#__PURE__*/function(){function TreeNode(_tree,from,// Index in parent node, set to -1 if the node is not a direct child of _parent.node (overlay)
index,_parent){_classCallCheck(this,TreeNode);this._tree=_tree;this.from=from;this.index=index;this._parent=_parent;}_createClass(TreeNode,[{key:"type",get:function get(){return this._tree.type;}},{key:"name",get:function get(){return this._tree.type.name;}},{key:"to",get:function get(){return this.from+this._tree.length;}},{key:"nextChild",value:function nextChild(i,dir,pos,side){var mode=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;for(var _parent14=this;;){for(var _parent14$_tree=_parent14._tree,_children=_parent14$_tree.children,positions=_parent14$_tree.positions,e=dir>0?_children.length:-1;i!=e;i+=dir){var next=_children[i],start=positions[i]+_parent14.from;if(!checkSide(side,pos,start,start+next.length))continue;if(next instanceof TreeBuffer){if(mode&IterMode.ExcludeBuffers)continue;var index=next.findChild(0,next.buffer.length,dir,pos-start,side);if(index>-1)return new BufferNode(new BufferContext(_parent14,next,i,start),null,index);}else if(mode&IterMode.IncludeAnonymous||!next.type.isAnonymous||hasChild(next)){var mounted=void 0;if(!(mode&IterMode.IgnoreMounts)&&next.props&&(mounted=next.prop(NodeProp.mounted))&&!mounted.overlay)return new TreeNode(mounted.tree,start,i,_parent14);var inner=new TreeNode(next,start,i,_parent14);return mode&IterMode.IncludeAnonymous||!inner.type.isAnonymous?inner:inner.nextChild(dir<0?next.children.length-1:0,dir,pos,side);}}if(mode&IterMode.IncludeAnonymous||!_parent14.type.isAnonymous)return null;if(_parent14.index>=0)i=_parent14.index+dir;else i=dir<0?-1:_parent14._parent._tree.children.length;_parent14=_parent14._parent;if(!_parent14)return null;}}},{key:"firstChild",get:function get(){return this.nextChild(0,1,0,4/* DontCare */);}},{key:"lastChild",get:function get(){return this.nextChild(this._tree.children.length-1,-1,0,4/* DontCare */);}},{key:"childAfter",value:function childAfter(pos){return this.nextChild(0,1,pos,2/* After */);}},{key:"childBefore",value:function childBefore(pos){return this.nextChild(this._tree.children.length-1,-1,pos,-2/* Before */);}},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var mounted;if(!(mode&IterMode.IgnoreOverlays)&&(mounted=this._tree.prop(NodeProp.mounted))&&mounted.overlay){var rPos=pos-this.from;var _iterator137=_createForOfIteratorHelper(mounted.overlay),_step137;try{for(_iterator137.s();!(_step137=_iterator137.n()).done;){var _step137$value=_step137.value,from=_step137$value.from,to=_step137$value.to;if((side>0?from<=rPos:from<rPos)&&(side<0?to>=rPos:to>rPos))return new TreeNode(mounted.tree,mounted.overlay[0].from+this.from,-1,this);}}catch(err){_iterator137.e(err);}finally{_iterator137.f();}}return this.nextChild(0,1,pos,side,mode);}},{key:"nextSignificantParent",value:function nextSignificantParent(){var val=this;while(val.type.isAnonymous&&val._parent){val=val._parent;}return val;}},{key:"parent",get:function get(){return this._parent?this._parent.nextSignificantParent():null;}},{key:"nextSibling",get:function get(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4/* DontCare */):null;}},{key:"prevSibling",get:function get(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4/* DontCare */):null;}},{key:"cursor",value:function cursor(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new TreeCursor(this,mode);}},{key:"tree",get:function get(){return this._tree;}},{key:"toTree",value:function toTree(){return this._tree;}},{key:"resolve",value:function resolve(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,false);}},{key:"resolveInner",value:function resolveInner(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,true);}},{key:"enterUnfinishedNodesBefore",value:function enterUnfinishedNodesBefore(pos){return _enterUnfinishedNodesBefore(this,pos);}},{key:"getChild",value:function getChild(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var r=_getChildren(this,type,before,after);return r.length?r[0]:null;}},{key:"getChildren",value:function getChildren(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return _getChildren(this,type,before,after);}/// @internal
},{key:"toString",value:function toString(){return this._tree.toString();}},{key:"node",get:function get(){return this;}},{key:"matchContext",value:function matchContext(context){return matchNodeContext(this,context);}}]);return TreeNode;}();function _getChildren(node,type,before,after){var cur=node.cursor(),result=[];if(!cur.firstChild())return result;if(before!=null)while(!cur.type.is(before)){if(!cur.nextSibling())return result;}for(;;){if(after!=null&&cur.type.is(after))return result;if(cur.type.is(type))result.push(cur.node);if(!cur.nextSibling())return after==null?result:[];}}function matchNodeContext(node,context){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:context.length-1;for(var _p7=node.parent;i>=0;_p7=_p7.parent){if(!_p7)return false;if(!_p7.type.isAnonymous){if(context[i]&&context[i]!=_p7.name)return false;i--;}}return true;}var BufferContext=/*#__PURE__*/_createClass(function BufferContext(parent,buffer,index,start){_classCallCheck(this,BufferContext);this.parent=parent;this.buffer=buffer;this.index=index;this.start=start;});var BufferNode=/*#__PURE__*/function(){function BufferNode(context,_parent,index){_classCallCheck(this,BufferNode);this.context=context;this._parent=_parent;this.index=index;this.type=context.buffer.set.types[context.buffer.buffer[index]];}_createClass(BufferNode,[{key:"name",get:function get(){return this.type.name;}},{key:"from",get:function get(){return this.context.start+this.context.buffer.buffer[this.index+1];}},{key:"to",get:function get(){return this.context.start+this.context.buffer.buffer[this.index+2];}},{key:"child",value:function child(dir,pos,side){var buffer=this.context.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index);}},{key:"firstChild",get:function get(){return this.child(1,0,4/* DontCare */);}},{key:"lastChild",get:function get(){return this.child(-1,0,4/* DontCare */);}},{key:"childAfter",value:function childAfter(pos){return this.child(1,pos,2/* After */);}},{key:"childBefore",value:function childBefore(pos){return this.child(-1,pos,-2/* Before */);}},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(mode&IterMode.ExcludeBuffers)return null;var buffer=this.context.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],side>0?1:-1,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index);}},{key:"parent",get:function get(){return this._parent||this.context.parent.nextSignificantParent();}},{key:"externalSibling",value:function externalSibling(dir){return this._parent?null:this.context.parent.nextChild(this.context.index+dir,dir,0,4/* DontCare */);}},{key:"nextSibling",get:function get(){var buffer=this.context.buffer;var after=buffer.buffer[this.index+3];if(after<(this._parent?buffer.buffer[this._parent.index+3]:buffer.buffer.length))return new BufferNode(this.context,this._parent,after);return this.externalSibling(1);}},{key:"prevSibling",get:function get(){var buffer=this.context.buffer;var parentStart=this._parent?this._parent.index+4:0;if(this.index==parentStart)return this.externalSibling(-1);return new BufferNode(this.context,this._parent,buffer.findChild(parentStart,this.index,-1,0,4/* DontCare */));}},{key:"cursor",value:function cursor(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new TreeCursor(this,mode);}},{key:"tree",get:function get(){return null;}},{key:"toTree",value:function toTree(){var children=[],positions=[];var buffer=this.context.buffer;var startI=this.index+4,endI=buffer.buffer[this.index+3];if(endI>startI){var from=buffer.buffer[this.index+1],to=buffer.buffer[this.index+2];children.push(buffer.slice(startI,endI,from,to));positions.push(0);}return new Tree(this.type,children,positions,this.to-this.from);}},{key:"resolve",value:function resolve(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,false);}},{key:"resolveInner",value:function resolveInner(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,true);}},{key:"enterUnfinishedNodesBefore",value:function enterUnfinishedNodesBefore(pos){return _enterUnfinishedNodesBefore(this,pos);}/// @internal
},{key:"toString",value:function toString(){return this.context.buffer.childString(this.index);}},{key:"getChild",value:function getChild(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var r=_getChildren(this,type,before,after);return r.length?r[0]:null;}},{key:"getChildren",value:function getChildren(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return _getChildren(this,type,before,after);}},{key:"node",get:function get(){return this;}},{key:"matchContext",value:function matchContext(context){return matchNodeContext(this,context);}}]);return BufferNode;}();/// A tree cursor object focuses on a given node in a syntax tree, and
/// allows you to move to adjacent nodes.
var TreeCursor=/*#__PURE__*/function(){/// @internal
function TreeCursor(node){var mode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;_classCallCheck(this,TreeCursor);this.mode=mode;/// @internal
this.buffer=null;this.stack=[];/// @internal
this.index=0;this.bufferNode=null;if(node instanceof TreeNode){this.yieldNode(node);}else{this._tree=node.context.parent;this.buffer=node.context;for(var n=node._parent;n;n=n._parent){this.stack.unshift(n.index);}this.bufferNode=node;this.yieldBuf(node.index);}}/// Shorthand for `.type.name`.
_createClass(TreeCursor,[{key:"name",get:function get(){return this.type.name;}},{key:"yieldNode",value:function yieldNode(node){if(!node)return false;this._tree=node;this.type=node.type;this.from=node.from;this.to=node.to;return true;}},{key:"yieldBuf",value:function yieldBuf(index,type){this.index=index;var _this$buffer=this.buffer,start=_this$buffer.start,buffer=_this$buffer.buffer;this.type=type||buffer.set.types[buffer.buffer[index]];this.from=start+buffer.buffer[index+1];this.to=start+buffer.buffer[index+2];return true;}},{key:"yield",value:function _yield(node){if(!node)return false;if(node instanceof TreeNode){this.buffer=null;return this.yieldNode(node);}this.buffer=node.context;return this.yieldBuf(node.index,node.type);}/// @internal
},{key:"toString",value:function toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString();}/// @internal
},{key:"enterChild",value:function enterChild(dir,pos,side){if(!this.buffer)return this["yield"](this._tree.nextChild(dir<0?this._tree._tree.children.length-1:0,dir,pos,side,this.mode));var buffer=this.buffer.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.buffer.start,side);if(index<0)return false;this.stack.push(this.index);return this.yieldBuf(index);}/// Move the cursor to this node's first child. When this returns
/// false, the node has no child, and the cursor has not been moved.
},{key:"firstChild",value:function firstChild(){return this.enterChild(1,0,4/* DontCare */);}/// Move the cursor to this node's last child.
},{key:"lastChild",value:function lastChild(){return this.enterChild(-1,0,4/* DontCare */);}/// Move the cursor to the first child that ends after `pos`.
},{key:"childAfter",value:function childAfter(pos){return this.enterChild(1,pos,2/* After */);}/// Move to the last child that starts before `pos`.
},{key:"childBefore",value:function childBefore(pos){return this.enterChild(-1,pos,-2/* Before */);}/// Move the cursor to the child around `pos`. If side is -1 the
/// child may end at that position, when 1 it may start there. This
/// will also enter [overlaid](#common.MountedTree.overlay)
/// [mounted](#common.NodeProp^mounted) trees unless `overlays` is
/// set to false.
},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.mode;if(!this.buffer)return this["yield"](this._tree.enter(pos,side,mode));return mode&IterMode.ExcludeBuffers?false:this.enterChild(1,pos,side);}/// Move to the node's parent node, if this isn't the top node.
},{key:"parent",value:function parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());var parent=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();this.buffer=null;return this.yieldNode(parent);}/// @internal
},{key:"sibling",value:function sibling(dir){if(!this.buffer)return!this._tree._parent?false:this["yield"](this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+dir,dir,0,4/* DontCare */,this.mode));var buffer=this.buffer.buffer,d=this.stack.length-1;if(dir<0){var parentStart=d<0?0:this.stack[d]+4;if(this.index!=parentStart)return this.yieldBuf(buffer.findChild(parentStart,this.index,-1,0,4/* DontCare */));}else{var _after6=buffer.buffer[this.index+3];if(_after6<(d<0?buffer.buffer.length:buffer.buffer[this.stack[d]+3]))return this.yieldBuf(_after6);}return d<0?this["yield"](this.buffer.parent.nextChild(this.buffer.index+dir,dir,0,4/* DontCare */,this.mode)):false;}/// Move to this node's next sibling, if any.
},{key:"nextSibling",value:function nextSibling(){return this.sibling(1);}/// Move to this node's previous sibling, if any.
},{key:"prevSibling",value:function prevSibling(){return this.sibling(-1);}},{key:"atLastNode",value:function atLastNode(dir){var index,parent,buffer=this.buffer;if(buffer){if(dir>0){if(this.index<buffer.buffer.buffer.length)return false;}else{for(var _i169=0;_i169<this.index;_i169++){if(buffer.buffer.buffer[_i169+3]<this.index)return false;}}index=buffer.index;parent=buffer.parent;}else{var _this$_tree=this._tree;index=_this$_tree.index;parent=_this$_tree._parent;}for(;parent;_parent15=parent,index=_parent15.index,parent=_parent15._parent,_parent15){var _parent15;if(index>-1)for(var _i170=index+dir,e=dir<0?-1:parent._tree.children.length;_i170!=e;_i170+=dir){var child=parent._tree.children[_i170];if(this.mode&IterMode.IncludeAnonymous||child instanceof TreeBuffer||!child.type.isAnonymous||hasChild(child))return false;}}return true;}},{key:"move",value:function move(dir,enter){if(enter&&this.enterChild(dir,0,4/* DontCare */))return true;for(;;){if(this.sibling(dir))return true;if(this.atLastNode(dir)||!this.parent())return false;}}/// Move to the next node in a
/// [pre-order](https://en.wikipedia.org/wiki/Tree_traversal#Pre-order_(NLR))
/// traversal, going from a node to its first child or, if the
/// current node is empty or `enter` is false, its next sibling or
/// the next sibling of the first parent node that has one.
},{key:"next",value:function next(){var enter=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return this.move(1,enter);}/// Move to the next node in a last-to-first pre-order traveral. A
/// node is followed by its last child or, if it has none, its
/// previous sibling or the previous sibling of the first parent
/// node that has one.
},{key:"prev",value:function prev(){var enter=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return this.move(-1,enter);}/// Move the cursor to the innermost node that covers `pos`. If
/// `side` is -1, it will enter nodes that end at `pos`. If it is 1,
/// it will enter nodes that start at `pos`.
},{key:"moveTo",value:function moveTo(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;// Move up to a node that actually holds the position, if possible
while(this.from==this.to||(side<1?this.from>=pos:this.from>pos)||(side>-1?this.to<=pos:this.to<pos)){if(!this.parent())break;}// Then scan down into child nodes as far as possible
while(this.enterChild(1,pos,side)){}return this;}/// Get a [syntax node](#common.SyntaxNode) at the cursor's current
/// position.
},{key:"node",get:function get(){if(!this.buffer)return this._tree;var cache=this.bufferNode,result=null,depth=0;if(cache&&cache.context==this.buffer){scan:for(var index=this.index,d=this.stack.length;d>=0;){for(var c=cache;c;c=c._parent){if(c.index==index){if(index==this.index)return c;result=c;depth=d+1;break scan;}}index=this.stack[--d];}}for(var _i171=depth;_i171<this.stack.length;_i171++){result=new BufferNode(this.buffer,result,this.stack[_i171]);}return this.bufferNode=new BufferNode(this.buffer,result,this.index);}/// Get the [tree](#common.Tree) that represents the current node, if
/// any. Will return null when the node is in a [tree
/// buffer](#common.TreeBuffer).
},{key:"tree",get:function get(){return this.buffer?null:this._tree._tree;}/// Iterate over the current node and all its descendants, calling
/// `enter` when entering a node and `leave`, if given, when leaving
/// one. When `enter` returns `false`, any children of that node are
/// skipped, and `leave` isn't called for it.
},{key:"iterate",value:function iterate(enter,leave){for(var _depth=0;;){var mustLeave=false;if(this.type.isAnonymous||enter(this)!==false){if(this.firstChild()){_depth++;continue;}if(!this.type.isAnonymous)mustLeave=true;}for(;;){if(mustLeave&&leave)leave(this);mustLeave=this.type.isAnonymous;if(this.nextSibling())break;if(!_depth)return;this.parent();_depth--;mustLeave=true;}}}/// Test whether the current node matches a given contexta sequence
/// of direct parent node names. Empty strings in the context array
/// are treated as wildcards.
},{key:"matchContext",value:function matchContext(context){if(!this.buffer)return matchNodeContext(this.node,context);var buffer=this.buffer.buffer,types=buffer.set.types;for(var _i172=context.length-1,d=this.stack.length-1;_i172>=0;d--){if(d<0)return matchNodeContext(this.node,context,_i172);var type=types[buffer.buffer[this.stack[d]]];if(!type.isAnonymous){if(context[_i172]&&context[_i172]!=type.name)return false;_i172--;}}return true;}}]);return TreeCursor;}();function hasChild(tree){return tree.children.some(function(ch){return ch instanceof TreeBuffer||!ch.type.isAnonymous||hasChild(ch);});}function buildTree(data){var _a;var buffer=data.buffer,nodeSet=data.nodeSet,_data$maxBufferLength=data.maxBufferLength,maxBufferLength=_data$maxBufferLength===void 0?DefaultBufferLength:_data$maxBufferLength,_data$reused=data.reused,reused=_data$reused===void 0?[]:_data$reused,_data$minRepeatType=data.minRepeatType,minRepeatType=_data$minRepeatType===void 0?nodeSet.types.length:_data$minRepeatType;var cursor=Array.isArray(buffer)?new FlatBufferCursor(buffer,buffer.length):buffer;var types=nodeSet.types;var contextHash=0,lookAhead=0;function takeNode(parentStart,minPos,children,positions,inRepeat){var id=cursor.id,start=cursor.start,end=cursor.end,size=cursor.size;var lookAheadAtStart=lookAhead;while(size<0){cursor.next();if(size==-1/* Reuse */){var _node=reused[id];children.push(_node);positions.push(start-parentStart);return;}else if(size==-3/* ContextChange */){// Context change
contextHash=id;return;}else if(size==-4/* LookAhead */){lookAhead=id;return;}else{throw new RangeError("Unrecognized record size: ".concat(size));}}var type=types[id],node,buffer;var startPos=start-parentStart;if(end-start<=maxBufferLength&&(buffer=findBufferSize(cursor.pos-minPos,inRepeat))){// Small enough for a buffer, and no reused nodes inside
var _data2=new Uint16Array(buffer.size-buffer.skip);var endPos=cursor.pos-buffer.size,index=_data2.length;while(cursor.pos>endPos){index=copyToBuffer(buffer.start,_data2,index);}node=new TreeBuffer(_data2,end-buffer.start,nodeSet);startPos=buffer.start-parentStart;}else{// Make it a node
var _endPos=cursor.pos-size;cursor.next();var localChildren=[],localPositions=[];var localInRepeat=id>=minRepeatType?id:-1;var lastGroup=0,lastEnd=end;while(cursor.pos>_endPos){if(localInRepeat>=0&&cursor.id==localInRepeat&&cursor.size>=0){if(cursor.end<=lastEnd-maxBufferLength){makeRepeatLeaf(localChildren,localPositions,start,lastGroup,cursor.end,lastEnd,localInRepeat,lookAheadAtStart);lastGroup=localChildren.length;lastEnd=cursor.end;}cursor.next();}else{takeNode(start,_endPos,localChildren,localPositions,localInRepeat);}}if(localInRepeat>=0&&lastGroup>0&&lastGroup<localChildren.length)makeRepeatLeaf(localChildren,localPositions,start,lastGroup,start,lastEnd,localInRepeat,lookAheadAtStart);localChildren.reverse();localPositions.reverse();if(localInRepeat>-1&&lastGroup>0){var make=makeBalanced(type);node=balanceRange(type,localChildren,localPositions,0,localChildren.length,0,end-start,make,make);}else{node=makeTree(type,localChildren,localPositions,end-start,lookAheadAtStart-end);}}children.push(node);positions.push(startPos);}function makeBalanced(type){return function(children,positions,length){var lookAhead=0,lastI=children.length-1,last,lookAheadProp;if(lastI>=0&&(last=children[lastI])instanceof Tree){if(!lastI&&last.type==type&&last.length==length)return last;if(lookAheadProp=last.prop(NodeProp.lookAhead))lookAhead=positions[lastI]+last.length+lookAheadProp;}return makeTree(type,children,positions,length,lookAhead);};}function makeRepeatLeaf(children,positions,base,i,from,to,type,lookAhead){var localChildren=[],localPositions=[];while(children.length>i){localChildren.push(children.pop());localPositions.push(positions.pop()+base-from);}children.push(makeTree(nodeSet.types[type],localChildren,localPositions,to-from,lookAhead-to));positions.push(from-base);}function makeTree(type,children,positions,length){var lookAhead=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var props=arguments.length>5?arguments[5]:undefined;if(contextHash){var _pair=[NodeProp.contextHash,contextHash];props=props?[_pair].concat(props):[_pair];}if(lookAhead>25){var _pair2=[NodeProp.lookAhead,lookAhead];props=props?[_pair2].concat(props):[_pair2];}return new Tree(type,children,positions,length,props);}function findBufferSize(maxSize,inRepeat){// Scan through the buffer to find previous siblings that fit
// together in a TreeBuffer, and don't contain any reused nodes
// (which can't be stored in a buffer).
// If `inRepeat` is > -1, ignore node boundaries of that type for
// nesting, but make sure the end falls either at the start
// (`maxSize`) or before such a node.
var fork=cursor.fork();var size=0,start=0,skip=0,minStart=fork.end-maxBufferLength;var result={size:0,start:0,skip:0};scan:for(var minPos=fork.pos-maxSize;fork.pos>minPos;){var _nodeSize=fork.size;// Pretend nested repeat nodes of the same type don't exist
if(fork.id==inRepeat&&_nodeSize>=0){// Except that we store the current state as a valid return
// value.
result.size=size;result.start=start;result.skip=skip;skip+=4;size+=4;fork.next();continue;}var startPos=fork.pos-_nodeSize;if(_nodeSize<0||startPos<minPos||fork.start<minStart)break;var localSkipped=fork.id>=minRepeatType?4:0;var _nodeStart=fork.start;fork.next();while(fork.pos>startPos){if(fork.size<0){if(fork.size==-3/* ContextChange */)localSkipped+=4;else break scan;}else if(fork.id>=minRepeatType){localSkipped+=4;}fork.next();}start=_nodeStart;size+=_nodeSize;skip+=localSkipped;}if(inRepeat<0||size==maxSize){result.size=size;result.start=start;result.skip=skip;}return result.size>4?result:undefined;}function copyToBuffer(bufferStart,buffer,index){var id=cursor.id,start=cursor.start,end=cursor.end,size=cursor.size;cursor.next();if(size>=0&&id<minRepeatType){var startIndex=index;if(size>4){var endPos=cursor.pos-(size-4);while(cursor.pos>endPos){index=copyToBuffer(bufferStart,buffer,index);}}buffer[--index]=startIndex;buffer[--index]=end-bufferStart;buffer[--index]=start-bufferStart;buffer[--index]=id;}else if(size==-3/* ContextChange */){contextHash=id;}else if(size==-4/* LookAhead */){lookAhead=id;}return index;}var children=[],positions=[];while(cursor.pos>0){takeNode(data.start||0,data.bufferStart||0,children,positions,-1);}var length=(_a=data.length)!==null&&_a!==void 0?_a:children.length?positions[0]+children[0].length:0;return new Tree(types[data.topID],children.reverse(),positions.reverse(),length);}var nodeSizeCache=new WeakMap();function nodeSize(balanceType,node){if(!balanceType.isAnonymous||node instanceof TreeBuffer||node.type!=balanceType)return 1;var size=nodeSizeCache.get(node);if(size==null){size=1;var _iterator138=_createForOfIteratorHelper(node.children),_step138;try{for(_iterator138.s();!(_step138=_iterator138.n()).done;){var child=_step138.value;if(child.type!=balanceType||!(child instanceof Tree)){size=1;break;}size+=nodeSize(balanceType,child);}}catch(err){_iterator138.e(err);}finally{_iterator138.f();}nodeSizeCache.set(node,size);}return size;}function balanceRange(// The type the balanced tree's inner nodes.
balanceType,// The direct children and their positions
children,positions,// The index range in children/positions to use
from,to,// The start position of the nodes, relative to their parent.
start,// Length of the outer node
length,// Function to build the top node of the balanced tree
mkTop,// Function to build internal nodes for the balanced tree
mkTree){var total=0;for(var _i173=from;_i173<to;_i173++){total+=nodeSize(balanceType,children[_i173]);}var maxChild=Math.ceil(total*1.5/8/* BranchFactor */);var localChildren=[],localPositions=[];function divide(children,positions,from,to,offset){for(var _i174=from;_i174<to;){var groupFrom=_i174,groupStart=positions[_i174],groupSize=nodeSize(balanceType,children[_i174]);_i174++;for(;_i174<to;_i174++){var nextSize=nodeSize(balanceType,children[_i174]);if(groupSize+nextSize>=maxChild)break;groupSize+=nextSize;}if(_i174==groupFrom+1){if(groupSize>maxChild){var only=children[groupFrom];// Only trees can have a size > 1
divide(only.children,only.positions,0,only.children.length,positions[groupFrom]+offset);continue;}localChildren.push(children[groupFrom]);}else{var _length=positions[_i174-1]+children[_i174-1].length-groupStart;localChildren.push(balanceRange(balanceType,children,positions,groupFrom,_i174,groupStart,_length,null,mkTree));}localPositions.push(groupStart+offset-start);}}divide(children,positions,from,to,0);return(mkTop||mkTree)(localChildren,localPositions,length);}/// Tree fragments are used during [incremental
/// parsing](#common.Parser.startParse) to track parts of old trees
/// that can be reused in a new parse. An array of fragments is used
/// to track regions of an old tree whose nodes might be reused in new
/// parses. Use the static
/// [`applyChanges`](#common.TreeFragment^applyChanges) method to
/// update fragments for document changes.
var TreeFragment=/*#__PURE__*/function(){/// Construct a tree fragment. You'll usually want to use
/// [`addTree`](#common.TreeFragment^addTree) and
/// [`applyChanges`](#common.TreeFragment^applyChanges) instead of
/// calling this directly.
function TreeFragment(/// The start of the unchanged range pointed to by this fragment.
/// This refers to an offset in the _updated_ document (as opposed
/// to the original tree).
from,/// The end of the unchanged range.
to,/// The tree that this fragment is based on.
tree,/// The offset between the fragment's tree and the document that
/// this fragment can be used against. Add this when going from
/// document to tree positions, subtract it to go from tree to
/// document positions.
offset){var openStart=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var openEnd=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;_classCallCheck(this,TreeFragment);this.from=from;this.to=to;this.tree=tree;this.offset=offset;this.open=(openStart?1/* Start */:0)|(openEnd?2/* End */:0);}/// Whether the start of the fragment represents the start of a
/// parse, or the end of a change. (In the second case, it may not
/// be safe to reuse some nodes at the start, depending on the
/// parsing algorithm.)
_createClass(TreeFragment,[{key:"openStart",get:function get(){return(this.open&1/* Start */)>0;}/// Whether the end of the fragment represents the end of a
/// full-document parse, or the start of a change.
},{key:"openEnd",get:function get(){return(this.open&2/* End */)>0;}/// Create a set of fragments from a freshly parsed tree, or update
/// an existing set of fragments by replacing the ones that overlap
/// with a tree with content from the new tree. When `partial` is
/// true, the parse is treated as incomplete, and the resulting
/// fragment has [`openEnd`](#common.TreeFragment.openEnd) set to
/// true.
}],[{key:"addTree",value:function addTree(tree){var fragments=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var partial=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var result=[new TreeFragment(0,tree.length,tree,0,false,partial)];var _iterator139=_createForOfIteratorHelper(fragments),_step139;try{for(_iterator139.s();!(_step139=_iterator139.n()).done;){var f=_step139.value;if(f.to>tree.length)result.push(f);}}catch(err){_iterator139.e(err);}finally{_iterator139.f();}return result;}/// Apply a set of edits to an array of fragments, removing or
/// splitting fragments as necessary to remove edited ranges, and
/// adjusting offsets for fragments that moved.
},{key:"applyChanges",value:function applyChanges(fragments,changes){var minGap=arguments.length>2&&arguments[2]!==undefined?arguments[2]:128;if(!changes.length)return fragments;var result=[];var fI=1,nextF=fragments.length?fragments[0]:null;for(var cI=0,pos=0,off=0;;cI++){var nextC=cI<changes.length?changes[cI]:null;var nextPos=nextC?nextC.fromA:1e9;if(nextPos-pos>=minGap)while(nextF&&nextF.from<nextPos){var cut=nextF;if(pos>=cut.from||nextPos<=cut.to||off){var fFrom=Math.max(cut.from,pos)-off,fTo=Math.min(cut.to,nextPos)-off;cut=fFrom>=fTo?null:new TreeFragment(fFrom,fTo,cut.tree,cut.offset+off,cI>0,!!nextC);}if(cut)result.push(cut);if(nextF.to>nextPos)break;nextF=fI<fragments.length?fragments[fI++]:null;}if(!nextC)break;pos=nextC.toA;off=nextC.toA-nextC.toB;}return result;}}]);return TreeFragment;}();/// A superclass that parsers should extend.
var Parser=/*#__PURE__*/function(){function Parser(){_classCallCheck(this,Parser);}_createClass(Parser,[{key:"startParse",value:/// Start a parse, returning a [partial parse](#common.PartialParse)
/// object. [`fragments`](#common.TreeFragment) can be passed in to
/// make the parse incremental.
///
/// By default, the entire input is parsed. You can pass `ranges`,
/// which should be a sorted array of non-empty, non-overlapping
/// ranges, to parse only those ranges. The tree returned in that
/// case will start at `ranges[0].from`.
function startParse(input,fragments,ranges){if(typeof input=="string")input=new StringInput(input);ranges=!ranges?[new Range(0,input.length)]:ranges.length?ranges.map(function(r){return new Range(r.from,r.to);}):[new Range(0,0)];return this.createParse(input,fragments||[],ranges);}/// Run a full parse, returning the resulting tree.
},{key:"parse",value:function parse(input,fragments,ranges){var parse=this.startParse(input,fragments,ranges);for(;;){var done=parse.advance();if(done)return done;}}}]);return Parser;}();var StringInput=/*#__PURE__*/function(){function StringInput(string){_classCallCheck(this,StringInput);this.string=string;}_createClass(StringInput,[{key:"length",get:function get(){return this.string.length;}},{key:"chunk",value:function chunk(from){return this.string.slice(from);}},{key:"lineChunks",get:function get(){return false;}},{key:"read",value:function read(from,to){return this.string.slice(from,to);}}]);return StringInput;}();new NodeProp({perNode:true});var nextTagID=0;/// Highlighting tags are markers that denote a highlighting category.
/// They are [associated](#highlight.styleTags) with parts of a syntax
/// tree by a language mode, and then mapped to an actual CSS style by
/// a [highlighter](#highlight.Highlighter).
///
/// Because syntax tree node types and highlight styles have to be
/// able to talk the same language, CodeMirror uses a mostly _closed_
/// [vocabulary](#highlight.tags) of syntax tags (as opposed to
/// traditional open string-based systems, which make it hard for
/// highlighting themes to cover all the tokens produced by the
/// various languages).
///
/// It _is_ possible to [define](#highlight.Tag^define) your own
/// highlighting tags for system-internal use (where you control both
/// the language package and the highlighter), but such tags will not
/// be picked up by regular highlighters (though you can derive them
/// from standard tags to allow highlighters to fall back to those).
var Tag=/*#__PURE__*/function(){/// @internal
function Tag(/// The set of this tag and all its parent tags, starting with
/// this one itself and sorted in order of decreasing specificity.
set,/// The base unmodified tag that this one is based on, if it's
/// modified @internal
base,/// The modifiers applied to this.base @internal
modified){_classCallCheck(this,Tag);this.set=set;this.base=base;this.modified=modified;/// @internal
this.id=nextTagID++;}/// Define a new tag. If `parent` is given, the tag is treated as a
/// sub-tag of that parent, and
/// [highlighters](#highlight.tagHighlighter) that don't mention
/// this tag will try to fall back to the parent tag (or grandparent
/// tag, etc).
_createClass(Tag,null,[{key:"define",value:function define(parent){if(parent===null||parent===void 0?void 0:parent.base)throw new Error("Can not derive from a modified tag");var tag=new Tag([],null,[]);tag.set.push(tag);if(parent){var _iterator140=_createForOfIteratorHelper(parent.set),_step140;try{for(_iterator140.s();!(_step140=_iterator140.n()).done;){var _t7=_step140.value;tag.set.push(_t7);}}catch(err){_iterator140.e(err);}finally{_iterator140.f();}}return tag;}/// Define a tag _modifier_, which is a function that, given a tag,
/// will return a tag that is a subtag of the original. Applying the
/// same modifier to a twice tag will return the same value (`m1(t1)
/// == m1(t1)`) and applying multiple modifiers will, regardless or
/// order, produce the same tag (`m1(m2(t1)) == m2(m1(t1))`).
///
/// When multiple modifiers are applied to a given base tag, each
/// smaller set of modifiers is registered as a parent, so that for
/// example `m1(m2(m3(t1)))` is a subtype of `m1(m2(t1))`,
/// `m1(m3(t1)`, and so on.
},{key:"defineModifier",value:function defineModifier(){var mod=new Modifier();return function(tag){if(tag.modified.indexOf(mod)>-1)return tag;return Modifier.get(tag.base||tag,tag.modified.concat(mod).sort(function(a,b){return a.id-b.id;}));};}}]);return Tag;}();var nextModifierID=0;var Modifier=/*#__PURE__*/function(){function Modifier(){_classCallCheck(this,Modifier);this.instances=[];this.id=nextModifierID++;}_createClass(Modifier,null,[{key:"get",value:function get(base,mods){if(!mods.length)return base;var exists=mods[0].instances.find(function(t){return t.base==base&&sameArray(mods,t.modified);});if(exists)return exists;var set=[],tag=new Tag(set,base,mods);var _iterator141=_createForOfIteratorHelper(mods),_step141;try{for(_iterator141.s();!(_step141=_iterator141.n()).done;){var m=_step141.value;m.instances.push(tag);}}catch(err){_iterator141.e(err);}finally{_iterator141.f();}var configs=permute(mods);var _iterator142=_createForOfIteratorHelper(base.set),_step142;try{for(_iterator142.s();!(_step142=_iterator142.n()).done;){var _parent16=_step142.value;var _iterator143=_createForOfIteratorHelper(configs),_step143;try{for(_iterator143.s();!(_step143=_iterator143.n()).done;){var _config2=_step143.value;set.push(Modifier.get(_parent16,_config2));}}catch(err){_iterator143.e(err);}finally{_iterator143.f();}}}catch(err){_iterator142.e(err);}finally{_iterator142.f();}return tag;}}]);return Modifier;}();function sameArray(a,b){return a.length==b.length&&a.every(function(x,i){return x==b[i];});}function permute(array){var result=[array];for(var _i175=0;_i175<array.length;_i175++){var _iterator144=_createForOfIteratorHelper(permute(array.slice(0,_i175).concat(array.slice(_i175+1)))),_step144;try{for(_iterator144.s();!(_step144=_iterator144.n()).done;){var a=_step144.value;result.push(a);}}catch(err){_iterator144.e(err);}finally{_iterator144.f();}}return result;}/// This function is used to add a set of tags to a language syntax
/// via [`NodeSet.extend`](#common.NodeSet.extend) or
/// [`LRParser.configure`](#lr.LRParser.configure).
///
/// The argument object maps node selectors to [highlighting
/// tags](#highlight.Tag) or arrays of tags.
///
/// Node selectors may hold one or more (space-separated) node paths.
/// Such a path can be a [node name](#common.NodeType.name), or
/// multiple node names (or `*` wildcards) separated by slash
/// characters, as in `"Block/Declaration/VariableName"`. Such a path
/// matches the final node but only if its direct parent nodes are the
/// other nodes mentioned. A `*` in such a path matches any parent,
/// but only a single levelwildcards that match multiple parents
/// aren't supported, both for efficiency reasons and because Lezer
/// trees make it rather hard to reason about what they would match.)
///
/// A path can be ended with `/...` to indicate that the tag assigned
/// to the node should also apply to all child nodes, even if they
/// match their own style (by default, only the innermost style is
/// used).
///
/// When a path ends in `!`, as in `Attribute!`, no further matching
/// happens for the node's child nodes, and the entire node gets the
/// given style.
///
/// In this notation, node names that contain `/`, `!`, `*`, or `...`
/// must be quoted as JSON strings.
///
/// For example:
///
/// ```javascript
/// parser.withProps(
///   styleTags({
///     // Style Number and BigNumber nodes
///     "Number BigNumber": tags.number,
///     // Style Escape nodes whose parent is String
///     "String/Escape": tags.escape,
///     // Style anything inside Attributes nodes
///     "Attributes!": tags.meta,
///     // Add a style to all content inside Italic nodes
///     "Italic/...": tags.emphasis,
///     // Style InvalidString nodes as both `string` and `invalid`
///     "InvalidString": [tags.string, tags.invalid],
///     // Style the node named "/" as punctuation
///     '"/"': tags.punctuation
///   })
/// )
/// ```
function styleTags(spec){var byName=Object.create(null);for(var prop in spec){var _tags=spec[prop];if(!Array.isArray(_tags))_tags=[_tags];var _iterator145=_createForOfIteratorHelper(prop.split(" ")),_step145;try{for(_iterator145.s();!(_step145=_iterator145.n()).done;){var part=_step145.value;if(part){var pieces=[],mode=2/* Normal */,_rest=part;for(var pos=0;;){if(_rest=="..."&&pos>0&&pos+3==part.length){mode=1/* Inherit */;break;}var m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(_rest);if(!m)throw new RangeError("Invalid path: "+part);pieces.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]);pos+=m[0].length;if(pos==part.length)break;var next=part[pos++];if(pos==part.length&&next=="!"){mode=0/* Opaque */;break;}if(next!="/")throw new RangeError("Invalid path: "+part);_rest=part.slice(pos);}var _last9=pieces.length-1,inner=pieces[_last9];if(!inner)throw new RangeError("Invalid path: "+part);var rule=new Rule(_tags,mode,_last9>0?pieces.slice(0,_last9):null);byName[inner]=rule.sort(byName[inner]);}}}catch(err){_iterator145.e(err);}finally{_iterator145.f();}}return ruleNodeProp.add(byName);}var ruleNodeProp=new NodeProp();var Rule=/*#__PURE__*/function(){function Rule(tags,mode,context,next){_classCallCheck(this,Rule);this.tags=tags;this.mode=mode;this.context=context;this.next=next;}_createClass(Rule,[{key:"sort",value:function sort(other){if(!other||other.depth<this.depth){this.next=other;return this;}other.next=this.sort(other.next);return other;}},{key:"depth",get:function get(){return this.context?this.context.length:0;}}]);return Rule;}();/// Define a [highlighter](#highlight.Highlighter) from an array of
/// tag/class pairs. Classes associated with more specific tags will
/// take precedence.
function tagHighlighter(tags,options){var map=Object.create(null);var _iterator146=_createForOfIteratorHelper(tags),_step146;try{for(_iterator146.s();!(_step146=_iterator146.n()).done;){var _style3=_step146.value;if(!Array.isArray(_style3.tag))map[_style3.tag.id]=_style3["class"];else{var _iterator149=_createForOfIteratorHelper(_style3.tag),_step149;try{for(_iterator149.s();!(_step149=_iterator149.n()).done;){var tag=_step149.value;map[tag.id]=_style3["class"];}}catch(err){_iterator149.e(err);}finally{_iterator149.f();}}}}catch(err){_iterator146.e(err);}finally{_iterator146.f();}var _ref52=options||{},scope=_ref52.scope,_ref52$all=_ref52.all,all=_ref52$all===void 0?null:_ref52$all;return{style:function style(tags){var cls=all;var _iterator147=_createForOfIteratorHelper(tags),_step147;try{for(_iterator147.s();!(_step147=_iterator147.n()).done;){var tag=_step147.value;var _iterator148=_createForOfIteratorHelper(tag.set),_step148;try{for(_iterator148.s();!(_step148=_iterator148.n()).done;){var sub=_step148.value;var tagClass=map[sub.id];if(tagClass){cls=cls?cls+" "+tagClass:tagClass;break;}}}catch(err){_iterator148.e(err);}finally{_iterator148.f();}}}catch(err){_iterator147.e(err);}finally{_iterator147.f();}return cls;},scope:scope};}function highlightTags(highlighters,tags){var result=null;var _iterator150=_createForOfIteratorHelper(highlighters),_step150;try{for(_iterator150.s();!(_step150=_iterator150.n()).done;){var _highlighter=_step150.value;var value=_highlighter.style(tags);if(value)result=result?result+" "+value:value;}}catch(err){_iterator150.e(err);}finally{_iterator150.f();}return result;}/// Highlight the given [tree](#common.Tree) with the given
/// [highlighter](#highlight.Highlighter).
function highlightTree(tree,highlighter,/// Assign styling to a region of the text. Will be called, in order
/// of position, for any ranges where more than zero classes apply.
/// `classes` is a space separated string of CSS classes.
putStyle){var from=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var to=arguments.length>4&&arguments[4]!==undefined?arguments[4]:tree.length;var builder=new HighlightBuilder(from,Array.isArray(highlighter)?highlighter:[highlighter],putStyle);builder.highlightRange(tree.cursor(),from,to,"",builder.highlighters);builder.flush(to);}var HighlightBuilder=/*#__PURE__*/function(){function HighlightBuilder(at,highlighters,span){_classCallCheck(this,HighlightBuilder);this.at=at;this.highlighters=highlighters;this.span=span;this["class"]="";}_createClass(HighlightBuilder,[{key:"startSpan",value:function startSpan(at,cls){if(cls!=this["class"]){this.flush(at);if(at>this.at)this.at=at;this["class"]=cls;}}},{key:"flush",value:function flush(to){if(to>this.at&&this["class"])this.span(this.at,to,this["class"]);}},{key:"highlightRange",value:function highlightRange(cursor,from,to,inheritedClass,highlighters){var type=cursor.type,start=cursor.from,end=cursor.to;if(start>=to||end<=from)return;if(type.isTop)highlighters=this.highlighters.filter(function(h){return!h.scope||h.scope(type);});var cls=inheritedClass;var rule=type.prop(ruleNodeProp),opaque=false;while(rule){if(!rule.context||cursor.matchContext(rule.context)){var tagCls=highlightTags(highlighters,rule.tags);if(tagCls){if(cls)cls+=" ";cls+=tagCls;if(rule.mode==1/* Inherit */)inheritedClass+=(inheritedClass?" ":"")+tagCls;else if(rule.mode==0/* Opaque */)opaque=true;}break;}rule=rule.next;}this.startSpan(cursor.from,cls);if(opaque)return;var mounted=cursor.tree&&cursor.tree.prop(NodeProp.mounted);if(mounted&&mounted.overlay){var inner=cursor.node.enter(mounted.overlay[0].from+start,1);var innerHighlighters=this.highlighters.filter(function(h){return!h.scope||h.scope(mounted.tree.type);});var _hasChild=cursor.firstChild();for(var _i176=0,pos=start;;_i176++){var next=_i176<mounted.overlay.length?mounted.overlay[_i176]:null;var nextPos=next?next.from+start:end;var rangeFrom=Math.max(from,pos),rangeTo=Math.min(to,nextPos);if(rangeFrom<rangeTo&&_hasChild){while(cursor.from<rangeTo){this.highlightRange(cursor,rangeFrom,rangeTo,inheritedClass,highlighters);this.startSpan(Math.min(to,cursor.to),cls);if(cursor.to>=nextPos||!cursor.nextSibling())break;}}if(!next||nextPos>to)break;pos=next.to+start;if(pos>from){this.highlightRange(inner.cursor(),Math.max(from,next.from+start),Math.min(to,pos),inheritedClass,innerHighlighters);this.startSpan(pos,cls);}}if(_hasChild)cursor.parent();}else if(cursor.firstChild()){do{if(cursor.to<=from)continue;if(cursor.from>=to)break;this.highlightRange(cursor,from,to,inheritedClass,highlighters);this.startSpan(Math.min(to,cursor.to),cls);}while(cursor.nextSibling());cursor.parent();}}}]);return HighlightBuilder;}();var t=Tag.define;var comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string=t(literal),number=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t();/// The default set of highlighting [tags](#highlight.Tag).
///
/// This collection is heavily biased towards programming languages,
/// and necessarily incomplete. A full ontology of syntactic
/// constructs would fill a stack of books, and be impractical to
/// write themes for. So try to make do with this set. If all else
/// fails, [open an
/// issue](https://github.com/codemirror/codemirror.next) to propose a
/// new tag, or [define](#highlight.Tag^define) a local custom tag for
/// your use case.
///
/// Note that it is not obligatory to always attach the most specific
/// tag possible to an elementif your grammar can't easily
/// distinguish a certain type of element (such as a local variable),
/// it is okay to style it as its more general variant (a variable).
/// 
/// For tags that extend some parent tag, the documentation links to
/// the parent.
var tags={/// A comment.
comment:comment,/// A line [comment](#highlight.tags.comment).
lineComment:t(comment),/// A block [comment](#highlight.tags.comment).
blockComment:t(comment),/// A documentation [comment](#highlight.tags.comment).
docComment:t(comment),/// Any kind of identifier.
name:name,/// The [name](#highlight.tags.name) of a variable.
variableName:t(name),/// A type [name](#highlight.tags.name).
typeName:typeName,/// A tag name (subtag of [`typeName`](#highlight.tags.typeName)).
tagName:t(typeName),/// A property or field [name](#highlight.tags.name).
propertyName:propertyName,/// An attribute name (subtag of [`propertyName`](#highlight.tags.propertyName)).
attributeName:t(propertyName),/// The [name](#highlight.tags.name) of a class.
className:t(name),/// A label [name](#highlight.tags.name).
labelName:t(name),/// A namespace [name](#highlight.tags.name).
namespace:t(name),/// The [name](#highlight.tags.name) of a macro.
macroName:t(name),/// A literal value.
literal:literal,/// A string [literal](#highlight.tags.literal).
string:string,/// A documentation [string](#highlight.tags.string).
docString:t(string),/// A character literal (subtag of [string](#highlight.tags.string)).
character:t(string),/// An attribute value (subtag of [string](#highlight.tags.string)).
attributeValue:t(string),/// A number [literal](#highlight.tags.literal).
number:number,/// An integer [number](#highlight.tags.number) literal.
integer:t(number),/// A floating-point [number](#highlight.tags.number) literal.
"float":t(number),/// A boolean [literal](#highlight.tags.literal).
bool:t(literal),/// Regular expression [literal](#highlight.tags.literal).
regexp:t(literal),/// An escape [literal](#highlight.tags.literal), for example a
/// backslash escape in a string.
escape:t(literal),/// A color [literal](#highlight.tags.literal).
color:t(literal),/// A URL [literal](#highlight.tags.literal).
url:t(literal),/// A language keyword.
keyword:keyword,/// The [keyword](#highlight.tags.keyword) for the self or this
/// object.
self:t(keyword),/// The [keyword](#highlight.tags.keyword) for null.
"null":t(keyword),/// A [keyword](#highlight.tags.keyword) denoting some atomic value.
atom:t(keyword),/// A [keyword](#highlight.tags.keyword) that represents a unit.
unit:t(keyword),/// A modifier [keyword](#highlight.tags.keyword).
modifier:t(keyword),/// A [keyword](#highlight.tags.keyword) that acts as an operator.
operatorKeyword:t(keyword),/// A control-flow related [keyword](#highlight.tags.keyword).
controlKeyword:t(keyword),/// A [keyword](#highlight.tags.keyword) that defines something.
definitionKeyword:t(keyword),/// A [keyword](#highlight.tags.keyword) related to defining or
/// interfacing with modules.
moduleKeyword:t(keyword),/// An operator.
operator:operator,/// An [operator](#highlight.tags.operator) that defines something.
derefOperator:t(operator),/// Arithmetic-related [operator](#highlight.tags.operator).
arithmeticOperator:t(operator),/// Logical [operator](#highlight.tags.operator).
logicOperator:t(operator),/// Bit [operator](#highlight.tags.operator).
bitwiseOperator:t(operator),/// Comparison [operator](#highlight.tags.operator).
compareOperator:t(operator),/// [Operator](#highlight.tags.operator) that updates its operand.
updateOperator:t(operator),/// [Operator](#highlight.tags.operator) that defines something.
definitionOperator:t(operator),/// Type-related [operator](#highlight.tags.operator).
typeOperator:t(operator),/// Control-flow [operator](#highlight.tags.operator).
controlOperator:t(operator),/// Program or markup punctuation.
punctuation:punctuation,/// [Punctuation](#highlight.tags.punctuation) that separates
/// things.
separator:t(punctuation),/// Bracket-style [punctuation](#highlight.tags.punctuation).
bracket:bracket,/// Angle [brackets](#highlight.tags.bracket) (usually `<` and `>`
/// tokens).
angleBracket:t(bracket),/// Square [brackets](#highlight.tags.bracket) (usually `[` and `]`
/// tokens).
squareBracket:t(bracket),/// Parentheses (usually `(` and `)` tokens). Subtag of
/// [bracket](#highlight.tags.bracket).
paren:t(bracket),/// Braces (usually `{` and `}` tokens). Subtag of
/// [bracket](#highlight.tags.bracket).
brace:t(bracket),/// Content, for example plain text in XML or markup documents.
content:content,/// [Content](#highlight.tags.content) that represents a heading.
heading:heading,/// A level 1 [heading](#highlight.tags.heading).
heading1:t(heading),/// A level 2 [heading](#highlight.tags.heading).
heading2:t(heading),/// A level 3 [heading](#highlight.tags.heading).
heading3:t(heading),/// A level 4 [heading](#highlight.tags.heading).
heading4:t(heading),/// A level 5 [heading](#highlight.tags.heading).
heading5:t(heading),/// A level 6 [heading](#highlight.tags.heading).
heading6:t(heading),/// A prose separator (such as a horizontal rule).
contentSeparator:t(content),/// [Content](#highlight.tags.content) that represents a list.
list:t(content),/// [Content](#highlight.tags.content) that represents a quote.
quote:t(content),/// [Content](#highlight.tags.content) that is emphasized.
emphasis:t(content),/// [Content](#highlight.tags.content) that is styled strong.
strong:t(content),/// [Content](#highlight.tags.content) that is part of a link.
link:t(content),/// [Content](#highlight.tags.content) that is styled as code or
/// monospace.
monospace:t(content),/// [Content](#highlight.tags.content) that has a strike-through
/// style.
strikethrough:t(content),/// Inserted text in a change-tracking format.
inserted:t(),/// Deleted text.
deleted:t(),/// Changed text.
changed:t(),/// An invalid or unsyntactic element.
invalid:t(),/// Metadata or meta-instruction.
meta:meta,/// [Metadata](#highlight.tags.meta) that applies to the entire
/// document.
documentMeta:t(meta),/// [Metadata](#highlight.tags.meta) that annotates or adds
/// attributes to a given syntactic element.
annotation:t(meta),/// Processing instruction or preprocessor directive. Subtag of
/// [meta](#highlight.tags.meta).
processingInstruction:t(meta),/// [Modifier](#highlight.Tag^defineModifier) that indicates that a
/// given element is being defined. Expected to be used with the
/// various [name](#highlight.tags.name) tags.
definition:Tag.defineModifier(),/// [Modifier](#highlight.Tag^defineModifier) that indicates that
/// something is constant. Mostly expected to be used with
/// [variable names](#highlight.tags.variableName).
constant:Tag.defineModifier(),/// [Modifier](#highlight.Tag^defineModifier) used to indicate that
/// a [variable](#highlight.tags.variableName) or [property
/// name](#highlight.tags.propertyName) is being called or defined
/// as a function.
"function":Tag.defineModifier(),/// [Modifier](#highlight.Tag^defineModifier) that can be applied to
/// [names](#highlight.tags.name) to indicate that they belong to
/// the language's standard environment.
standard:Tag.defineModifier(),/// [Modifier](#highlight.Tag^defineModifier) that indicates a given
/// [names](#highlight.tags.name) is local to some scope.
local:Tag.defineModifier(),/// A generic variant [modifier](#highlight.Tag^defineModifier) that
/// can be used to tag language-specific alternative variants of
/// some common tag. It is recommended for themes to define special
/// forms of at least the [string](#highlight.tags.string) and
/// [variable name](#highlight.tags.variableName) tags, since those
/// come up a lot.
special:Tag.defineModifier()};/// This is a highlighter that adds stable, predictable classes to
/// tokens, for styling with external CSS.
///
/// The following tags are mapped to their name prefixed with `"tok-"`
/// (for example `"tok-comment"`):
///
/// * [`link`](#highlight.tags.link)
/// * [`heading`](#highlight.tags.heading)
/// * [`emphasis`](#highlight.tags.emphasis)
/// * [`strong`](#highlight.tags.strong)
/// * [`keyword`](#highlight.tags.keyword)
/// * [`atom`](#highlight.tags.atom)
/// * [`bool`](#highlight.tags.bool)
/// * [`url`](#highlight.tags.url)
/// * [`labelName`](#highlight.tags.labelName)
/// * [`inserted`](#highlight.tags.inserted)
/// * [`deleted`](#highlight.tags.deleted)
/// * [`literal`](#highlight.tags.literal)
/// * [`string`](#highlight.tags.string)
/// * [`number`](#highlight.tags.number)
/// * [`variableName`](#highlight.tags.variableName)
/// * [`typeName`](#highlight.tags.typeName)
/// * [`namespace`](#highlight.tags.namespace)
/// * [`className`](#highlight.tags.className)
/// * [`macroName`](#highlight.tags.macroName)
/// * [`propertyName`](#highlight.tags.propertyName)
/// * [`operator`](#highlight.tags.operator)
/// * [`comment`](#highlight.tags.comment)
/// * [`meta`](#highlight.tags.meta)
/// * [`punctuation`](#highlight.tags.punctuation)
/// * [`invalid`](#highlight.tags.invalid)
///
/// In addition, these mappings are provided:
///
/// * [`regexp`](#highlight.tags.regexp),
///   [`escape`](#highlight.tags.escape), and
///   [`special`](#highlight.tags.special)[`(string)`](#highlight.tags.string)
///   are mapped to `"tok-string2"`
/// * [`special`](#highlight.tags.special)[`(variableName)`](#highlight.tags.variableName)
///   to `"tok-variableName2"`
/// * [`local`](#highlight.tags.local)[`(variableName)`](#highlight.tags.variableName)
///   to `"tok-variableName tok-local"`
/// * [`definition`](#highlight.tags.definition)[`(variableName)`](#highlight.tags.variableName)
///   to `"tok-variableName tok-definition"`
/// * [`definition`](#highlight.tags.definition)[`(propertyName)`](#highlight.tags.propertyName)
///   to `"tok-propertyName tok-definition"`
tagHighlighter([{tag:tags.link,"class":"tok-link"},{tag:tags.heading,"class":"tok-heading"},{tag:tags.emphasis,"class":"tok-emphasis"},{tag:tags.strong,"class":"tok-strong"},{tag:tags.keyword,"class":"tok-keyword"},{tag:tags.atom,"class":"tok-atom"},{tag:tags.bool,"class":"tok-bool"},{tag:tags.url,"class":"tok-url"},{tag:tags.labelName,"class":"tok-labelName"},{tag:tags.inserted,"class":"tok-inserted"},{tag:tags.deleted,"class":"tok-deleted"},{tag:tags.literal,"class":"tok-literal"},{tag:tags.string,"class":"tok-string"},{tag:tags.number,"class":"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],"class":"tok-string2"},{tag:tags.variableName,"class":"tok-variableName"},{tag:tags.local(tags.variableName),"class":"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),"class":"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),"class":"tok-variableName2"},{tag:tags.definition(tags.propertyName),"class":"tok-propertyName tok-definition"},{tag:tags.typeName,"class":"tok-typeName"},{tag:tags.namespace,"class":"tok-namespace"},{tag:tags.className,"class":"tok-className"},{tag:tags.macroName,"class":"tok-macroName"},{tag:tags.propertyName,"class":"tok-propertyName"},{tag:tags.operator,"class":"tok-operator"},{tag:tags.comment,"class":"tok-comment"},{tag:tags.meta,"class":"tok-meta"},{tag:tags.invalid,"class":"tok-invalid"},{tag:tags.punctuation,"class":"tok-punctuation"}]);var _a;/**
Node prop stored in a parser's top syntax node to provide the
facet that stores language-specific data for that language.
*/var languageDataProp=/*@__PURE__*/new NodeProp();/**
Helper function to define a facet (to be added to the top syntax
node(s) for a language via
[`languageDataProp`](https://codemirror.net/6/docs/ref/#language.languageDataProp)), that will be
used to associate language data with the language. You
probably only need this when subclassing
[`Language`](https://codemirror.net/6/docs/ref/#language.Language).
*/function defineLanguageFacet(baseData){return Facet.define({combine:baseData?function(values){return values.concat(baseData);}:undefined});}/**
A language object manages parsing and per-language
[metadata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt). Parse data is
managed as a [Lezer](https://lezer.codemirror.net) tree. The class
can be used directly, via the [`LRLanguage`](https://codemirror.net/6/docs/ref/#language.LRLanguage)
subclass for [Lezer](https://lezer.codemirror.net/) LR parsers, or
via the [`StreamLanguage`](https://codemirror.net/6/docs/ref/#language.StreamLanguage) subclass
for stream parsers.
*/var Language=/*#__PURE__*/function(){/**
    Construct a language object. If you need to invoke this
    directly, first define a data facet with
    [`defineLanguageFacet`](https://codemirror.net/6/docs/ref/#language.defineLanguageFacet), and then
    configure your parser to [attach](https://codemirror.net/6/docs/ref/#language.languageDataProp) it
    to the language's outer syntax node.
    */function Language(/**
    The [language data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt) facet
    used for this language.
    */data,parser){var extraExtensions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];_classCallCheck(this,Language);this.data=data;// Kludge to define EditorState.tree as a debugging helper,
// without the EditorState package actually knowing about
// languages and lezer trees.
if(!EditorState.prototype.hasOwnProperty("tree"))Object.defineProperty(EditorState.prototype,"tree",{get:function get(){return syntaxTree(this);}});this.parser=parser;this.extension=[language.of(this),EditorState.languageData.of(function(state,pos,side){return state.facet(languageDataFacetAt(state,pos,side));})].concat(extraExtensions);}/**
    Query whether this language is active at the given position.
    */_createClass(Language,[{key:"isActiveAt",value:function isActiveAt(state,pos){var side=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;return languageDataFacetAt(state,pos,side)==this.data;}/**
    Find the document regions that were parsed using this language.
    The returned regions will _include_ any nested languages rooted
    in this language, when those exist.
    */},{key:"findRegions",value:function findRegions(state){var _this83=this;var lang=state.facet(language);if((lang===null||lang===void 0?void 0:lang.data)==this.data)return[{from:0,to:state.doc.length}];if(!lang||!lang.allowsNesting)return[];var result=[];var explore=function explore(tree,from){if(tree.prop(languageDataProp)==_this83.data){result.push({from:from,to:from+tree.length});return;}var mount=tree.prop(NodeProp.mounted);if(mount){if(mount.tree.prop(languageDataProp)==_this83.data){if(mount.overlay){var _iterator151=_createForOfIteratorHelper(mount.overlay),_step151;try{for(_iterator151.s();!(_step151=_iterator151.n()).done;){var _r7=_step151.value;result.push({from:_r7.from+from,to:_r7.to+from});}}catch(err){_iterator151.e(err);}finally{_iterator151.f();}}else result.push({from:from,to:from+tree.length});return;}else if(mount.overlay){var _size6=result.length;explore(mount.tree,mount.overlay[0].from+from);if(result.length>_size6)return;}}for(var _i177=0;_i177<tree.children.length;_i177++){var ch=tree.children[_i177];if(ch instanceof Tree)explore(ch,tree.positions[_i177]+from);}};explore(syntaxTree(state),0);return result;}/**
    Indicates whether this language allows nested languages. The
    default implementation returns true.
    */},{key:"allowsNesting",get:function get(){return true;}}]);return Language;}();/**
@internal
*/Language.setState=/*@__PURE__*/StateEffect.define();function languageDataFacetAt(state,pos,side){var topLang=state.facet(language);if(!topLang)return null;var facet=topLang.data;if(topLang.allowsNesting){for(var node=syntaxTree(state).topNode;node;node=node.enter(pos,side,IterMode.ExcludeBuffers)){facet=node.type.prop(languageDataProp)||facet;}}return facet;}/**
A subclass of [`Language`](https://codemirror.net/6/docs/ref/#language.Language) for use with Lezer
[LR parsers](https://lezer.codemirror.net/docs/ref#lr.LRParser)
parsers.
*/var LRLanguage=/*#__PURE__*/function(_Language){_inherits(LRLanguage,_Language);var _super43=_createSuper(LRLanguage);function LRLanguage(data,parser){var _this84;_classCallCheck(this,LRLanguage);_this84=_super43.call(this,data,parser);_this84.parser=parser;return _this84;}/**
    Define a language from a parser.
    */_createClass(LRLanguage,[{key:"configure",value:/**
    Create a new instance of this language with a reconfigured
    version of its parser.
    */function configure(options){return new LRLanguage(this.data,this.parser.configure(options));}},{key:"allowsNesting",get:function get(){return this.parser.hasWrappers();}}],[{key:"define",value:function define(spec){var data=defineLanguageFacet(spec.languageData);return new LRLanguage(data,spec.parser.configure({props:[languageDataProp.add(function(type){return type.isTop?data:undefined;})]}));}}]);return LRLanguage;}(Language);/**
Get the syntax tree for a state, which is the current (possibly
incomplete) parse tree of the active
[language](https://codemirror.net/6/docs/ref/#language.Language), or the empty tree if there is no
language available.
*/function syntaxTree(state){var field=state.field(Language.state,false);return field?field.tree:Tree.empty;}// Lezer-style Input object for a Text document.
var DocInput=/*#__PURE__*/function(){function DocInput(doc){var length=arguments.length>1&&arguments[1]!==undefined?arguments[1]:doc.length;_classCallCheck(this,DocInput);this.doc=doc;this.length=length;this.cursorPos=0;this.string="";this.cursor=doc.iter();}_createClass(DocInput,[{key:"syncTo",value:function syncTo(pos){this.string=this.cursor.next(pos-this.cursorPos).value;this.cursorPos=pos+this.string.length;return this.cursorPos-this.string.length;}},{key:"chunk",value:function chunk(pos){this.syncTo(pos);return this.string;}},{key:"lineChunks",get:function get(){return true;}},{key:"read",value:function read(from,to){var stringStart=this.cursorPos-this.string.length;if(from<stringStart||to>=this.cursorPos)return this.doc.sliceString(from,to);else return this.string.slice(from-stringStart,to-stringStart);}}]);return DocInput;}();var currentContext=null;/**
A parse context provided to parsers working on the editor content.
*/var ParseContext=/*#__PURE__*/function(){function ParseContext(parser,/**
    The current editor state.
    */state){var fragments=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var/**
    @internal
    */tree=arguments.length>3?arguments[3]:undefined;var/**
    @internal
    */treeLen=arguments.length>4?arguments[4]:undefined;var/**
    The current editor viewport (or some overapproximation
    thereof). Intended to be used for opportunistically avoiding
    work (in which case
    [`skipUntilInView`](https://codemirror.net/6/docs/ref/#language.ParseContext.skipUntilInView)
    should be called to make sure the parser is restarted when the
    skipped region becomes visible).
    */viewport=arguments.length>5?arguments[5]:undefined;var/**
    @internal
    */skipped=arguments.length>6?arguments[6]:undefined;var/**
    This is where skipping parsers can register a promise that,
    when resolved, will schedule a new parse. It is cleared when
    the parse worker picks up the promise. @internal
    */scheduleOn=arguments.length>7?arguments[7]:undefined;_classCallCheck(this,ParseContext);this.parser=parser;this.state=state;this.fragments=fragments;this.tree=tree;this.treeLen=treeLen;this.viewport=viewport;this.skipped=skipped;this.scheduleOn=scheduleOn;this.parse=null;/**
        @internal
        */this.tempSkipped=[];}/**
    @internal
    */_createClass(ParseContext,[{key:"startParse",value:function startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments);}/**
    @internal
    */},{key:"work",value:function work(until,upto){var _this85=this;if(upto!=null&&upto>=this.state.doc.length)upto=undefined;if(this.tree!=Tree.empty&&this.isDone(upto!==null&&upto!==void 0?upto:this.state.doc.length)){this.takeTree();return true;}return this.withContext(function(){var _a;if(typeof until=="number"){var endTime=Date.now()+until;until=function until(){return Date.now()>endTime;};}if(!_this85.parse)_this85.parse=_this85.startParse();if(upto!=null&&(_this85.parse.stoppedAt==null||_this85.parse.stoppedAt>upto)&&upto<_this85.state.doc.length)_this85.parse.stopAt(upto);for(;;){var done=_this85.parse.advance();if(done){_this85.fragments=_this85.withoutTempSkipped(TreeFragment.addTree(done,_this85.fragments,_this85.parse.stoppedAt!=null));_this85.treeLen=(_a=_this85.parse.stoppedAt)!==null&&_a!==void 0?_a:_this85.state.doc.length;_this85.tree=done;_this85.parse=null;if(_this85.treeLen<(upto!==null&&upto!==void 0?upto:_this85.state.doc.length))_this85.parse=_this85.startParse();else return true;}if(until())return false;}});}/**
    @internal
    */},{key:"takeTree",value:function takeTree(){var _this86=this;var pos,tree;if(this.parse&&(pos=this.parse.parsedPos)>=this.treeLen){if(this.parse.stoppedAt==null||this.parse.stoppedAt>pos)this.parse.stopAt(pos);this.withContext(function(){while(!(tree=_this86.parse.advance())){}});this.treeLen=pos;this.tree=tree;this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,true));this.parse=null;}}},{key:"withContext",value:function withContext(f){var prev=currentContext;currentContext=this;try{return f();}finally{currentContext=prev;}}},{key:"withoutTempSkipped",value:function withoutTempSkipped(fragments){for(var _r8;_r8=this.tempSkipped.pop();){fragments=cutFragments(fragments,_r8.from,_r8.to);}return fragments;}/**
    @internal
    */},{key:"changes",value:function changes(_changes,newState){var fragments=this.fragments,tree=this.tree,treeLen=this.treeLen,viewport=this.viewport,skipped=this.skipped;this.takeTree();if(!_changes.empty){var ranges=[];_changes.iterChangedRanges(function(fromA,toA,fromB,toB){return ranges.push({fromA:fromA,toA:toA,fromB:fromB,toB:toB});});fragments=TreeFragment.applyChanges(fragments,ranges);tree=Tree.empty;treeLen=0;viewport={from:_changes.mapPos(viewport.from,-1),to:_changes.mapPos(viewport.to,1)};if(this.skipped.length){skipped=[];var _iterator152=_createForOfIteratorHelper(this.skipped),_step152;try{for(_iterator152.s();!(_step152=_iterator152.n()).done;){var _r9=_step152.value;var from=_changes.mapPos(_r9.from,1),to=_changes.mapPos(_r9.to,-1);if(from<to)skipped.push({from:from,to:to});}}catch(err){_iterator152.e(err);}finally{_iterator152.f();}}}return new ParseContext(this.parser,newState,fragments,tree,treeLen,viewport,skipped,this.scheduleOn);}/**
    @internal
    */},{key:"updateViewport",value:function updateViewport(viewport){if(this.viewport.from==viewport.from&&this.viewport.to==viewport.to)return false;this.viewport=viewport;var startLen=this.skipped.length;for(var _i178=0;_i178<this.skipped.length;_i178++){var _this$skipped$_i=this.skipped[_i178],from=_this$skipped$_i.from,to=_this$skipped$_i.to;if(from<viewport.to&&to>viewport.from){this.fragments=cutFragments(this.fragments,from,to);this.skipped.splice(_i178--,1);}}if(this.skipped.length>=startLen)return false;this.reset();return true;}/**
    @internal
    */},{key:"reset",value:function reset(){if(this.parse){this.takeTree();this.parse=null;}}/**
    Notify the parse scheduler that the given region was skipped
    because it wasn't in view, and the parse should be restarted
    when it comes into view.
    */},{key:"skipUntilInView",value:function skipUntilInView(from,to){this.skipped.push({from:from,to:to});}/**
    Returns a parser intended to be used as placeholder when
    asynchronously loading a nested parser. It'll skip its input and
    mark it as not-really-parsed, so that the next update will parse
    it again.
    
    When `until` is given, a reparse will be scheduled when that
    promise resolves.
    */},{key:"isDone",value:/**
    @internal
    */function isDone(upto){upto=Math.min(upto,this.state.doc.length);var frags=this.fragments;return this.treeLen>=upto&&frags.length&&frags[0].from==0&&frags[0].to>=upto;}/**
    Get the context for the current parse, or `null` if no editor
    parse is in progress.
    */}],[{key:"create",value:function create(parser,state,viewport){return new ParseContext(parser,state,[],Tree.empty,0,viewport,[],null);}},{key:"getSkippingParser",value:function getSkippingParser(until){return new(/*#__PURE__*/function(_Parser){_inherits(_class10,_Parser);var _super44=_createSuper(_class10);function _class10(){_classCallCheck(this,_class10);return _super44.apply(this,arguments);}_createClass(_class10,[{key:"createParse",value:function createParse(input,fragments,ranges){var from=ranges[0].from,to=ranges[ranges.length-1].to;var parser={parsedPos:from,advance:function advance(){var cx=currentContext;if(cx){var _iterator153=_createForOfIteratorHelper(ranges),_step153;try{for(_iterator153.s();!(_step153=_iterator153.n()).done;){var _r10=_step153.value;cx.tempSkipped.push(_r10);}}catch(err){_iterator153.e(err);}finally{_iterator153.f();}if(until)cx.scheduleOn=cx.scheduleOn?Promise.all([cx.scheduleOn,until]):until;}this.parsedPos=to;return new Tree(NodeType.none,[],[],to-from);},stoppedAt:null,stopAt:function stopAt(){}};return parser;}}]);return _class10;}(Parser))();}},{key:"get",value:function get(){return currentContext;}}]);return ParseContext;}();function cutFragments(fragments,from,to){return TreeFragment.applyChanges(fragments,[{fromA:from,toA:to,fromB:from,toB:to}]);}var LanguageState=/*#__PURE__*/function(){function LanguageState(// A mutable parse state that is used to preserve work done during
// the lifetime of a state when moving to the next state.
context){_classCallCheck(this,LanguageState);this.context=context;this.tree=context.tree;}_createClass(LanguageState,[{key:"apply",value:function apply(tr){if(!tr.docChanged&&this.tree==this.context.tree)return this;var newCx=this.context.changes(tr.changes,tr.state);// If the previous parse wasn't done, go forward only up to its
// end position or the end of the viewport, to avoid slowing down
// state updates with parse work beyond the viewport.
var upto=this.context.treeLen==tr.startState.doc.length?undefined:Math.max(tr.changes.mapPos(this.context.treeLen),newCx.viewport.to);if(!newCx.work(20/* Apply */,upto))newCx.takeTree();return new LanguageState(newCx);}}],[{key:"init",value:function init(state){var vpTo=Math.min(3000/* InitViewport */,state.doc.length);var parseState=ParseContext.create(state.facet(language).parser,state,{from:0,to:vpTo});if(!parseState.work(20/* Apply */,vpTo))parseState.takeTree();return new LanguageState(parseState);}}]);return LanguageState;}();Language.state=/*@__PURE__*/StateField.define({create:LanguageState.init,update:function update(value,tr){var _iterator154=_createForOfIteratorHelper(tr.effects),_step154;try{for(_iterator154.s();!(_step154=_iterator154.n()).done;){var e=_step154.value;if(e.is(Language.setState))return e.value;}}catch(err){_iterator154.e(err);}finally{_iterator154.f();}if(tr.startState.facet(language)!=tr.state.facet(language))return LanguageState.init(tr.state);return value.apply(tr);}});var requestIdle=function requestIdle(callback){var timeout=setTimeout(function(){return callback();},500/* MaxPause */);return function(){return clearTimeout(timeout);};};if(typeof requestIdleCallback!="undefined")requestIdle=function requestIdle(callback){var idle=-1,timeout=setTimeout(function(){idle=requestIdleCallback(callback,{timeout:500/* MaxPause */-100/* MinPause */});},100/* MinPause */);return function(){return idle<0?clearTimeout(timeout):cancelIdleCallback(idle);};};var isInputPending=typeof navigator!="undefined"&&((_a=navigator.scheduling)===null||_a===void 0?void 0:_a.isInputPending)?function(){return navigator.scheduling.isInputPending();}:null;var parseWorker=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function ParseWorker(view){_classCallCheck(this,ParseWorker);this.view=view;this.working=null;this.workScheduled=0;// End of the current time chunk
this.chunkEnd=-1;// Milliseconds of budget left for this chunk
this.chunkBudget=-1;this.work=this.work.bind(this);this.scheduleWork();}_createClass(ParseWorker,[{key:"update",value:function update(_update19){var cx=this.view.state.field(Language.state).context;if(cx.updateViewport(_update19.view.viewport)||this.view.viewport.to>cx.treeLen)this.scheduleWork();if(_update19.docChanged){if(this.view.hasFocus)this.chunkBudget+=50/* ChangeBonus */;this.scheduleWork();}this.checkAsyncSchedule(cx);}},{key:"scheduleWork",value:function scheduleWork(){if(this.working)return;var state=this.view.state,field=state.field(Language.state);if(field.tree!=field.context.tree||!field.context.isDone(state.doc.length))this.working=requestIdle(this.work);}},{key:"work",value:function work(deadline){this.working=null;var now=Date.now();if(this.chunkEnd<now&&(this.chunkEnd<0||this.view.hasFocus)){// Start a new chunk
this.chunkEnd=now+30000/* ChunkTime */;this.chunkBudget=3000/* ChunkBudget */;}if(this.chunkBudget<=0)return;// No more budget
var _this$view=this.view,state=_this$view.state,vpTo=_this$view.viewport.to,field=state.field(Language.state);if(field.tree==field.context.tree&&field.context.isDone(vpTo+100000/* MaxParseAhead */))return;var endTime=Date.now()+Math.min(this.chunkBudget,100/* Slice */,deadline&&!isInputPending?Math.max(25/* MinSlice */,deadline.timeRemaining()-5):1e9);var viewportFirst=field.context.treeLen<vpTo&&state.doc.length>vpTo+1000;var done=field.context.work(function(){return isInputPending&&isInputPending()||Date.now()>endTime;},vpTo+(viewportFirst?0:100000/* MaxParseAhead */));this.chunkBudget-=Date.now()-now;if(done||this.chunkBudget<=0){field.context.takeTree();this.view.dispatch({effects:Language.setState.of(new LanguageState(field.context))});}if(this.chunkBudget>0&&!(done&&!viewportFirst))this.scheduleWork();this.checkAsyncSchedule(field.context);}},{key:"checkAsyncSchedule",value:function checkAsyncSchedule(cx){var _this87=this;if(cx.scheduleOn){this.workScheduled++;cx.scheduleOn.then(function(){return _this87.scheduleWork();})["catch"](function(err){return logException(_this87.view.state,err);}).then(function(){return _this87.workScheduled--;});cx.scheduleOn=null;}}},{key:"destroy",value:function destroy(){if(this.working)this.working();}},{key:"isWorking",value:function isWorking(){return!!(this.working||this.workScheduled>0);}}]);return ParseWorker;}(),{eventHandlers:{focus:function focus(){this.scheduleWork();}}});/**
The facet used to associate a language with an editor state. Used
by `Language` object's `extension` property (so you don't need to
manually wrap your languages in this). Can be used to access the
current language on a state.
*/var language=/*@__PURE__*/Facet.define({combine:function combine(languages){return languages.length?languages[0]:null;},enables:[Language.state,parseWorker]});/**
This class bundles a [language](https://codemirror.net/6/docs/ref/#language.Language) with an
optional set of supporting extensions. Language packages are
encouraged to export a function that optionally takes a
configuration object and returns a `LanguageSupport` instance, as
the main way for client code to use the package.
*/var LanguageSupport=/*#__PURE__*/_createClass(/**
    Create a language support object.
    */function LanguageSupport(/**
    The language object.
    */language){var support=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,LanguageSupport);this.language=language;this.support=support;this.extension=[language,support];});/**
Facet that defines a way to provide a function that computes the
appropriate indentation depth at the start of a given line, or
`null` to indicate no appropriate indentation could be determined.
*/var indentService=/*@__PURE__*/Facet.define();/**
Facet for overriding the unit by which indentation happens.
Should be a string consisting either entirely of spaces or
entirely of tabs. When not set, this defaults to 2 spaces.
*/var indentUnit=/*@__PURE__*/Facet.define({combine:function combine(values){if(!values.length)return"  ";if(!/^(?: +|\t+)$/.test(values[0]))throw new Error("Invalid indent unit: "+JSON.stringify(values[0]));return values[0];}});/**
Return the _column width_ of an indent unit in the state.
Determined by the [`indentUnit`](https://codemirror.net/6/docs/ref/#language.indentUnit)
facet, and [`tabSize`](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize) when that
contains tabs.
*/function getIndentUnit(state){var unit=state.facet(indentUnit);return unit.charCodeAt(0)==9?state.tabSize*unit.length:unit.length;}/**
Create an indentation string that covers columns 0 to `cols`.
Will use tabs for as much of the columns as possible when the
[`indentUnit`](https://codemirror.net/6/docs/ref/#language.indentUnit) facet contains
tabs.
*/function indentString(state,cols){var result="",ts=state.tabSize;if(state.facet(indentUnit).charCodeAt(0)==9)while(cols>=ts){result+="\t";cols-=ts;}for(var _i179=0;_i179<cols;_i179++){result+=" ";}return result;}/**
Get the indentation at the given position. Will first consult any
[indent services](https://codemirror.net/6/docs/ref/#language.indentService) that are registered,
and if none of those return an indentation, this will check the
syntax tree for the [indent node prop](https://codemirror.net/6/docs/ref/#language.indentNodeProp)
and use that if found. Returns a number when an indentation could
be determined, and null otherwise.
*/function getIndentation(context,pos){if(context instanceof EditorState)context=new IndentContext(context);var _iterator155=_createForOfIteratorHelper(context.state.facet(indentService)),_step155;try{for(_iterator155.s();!(_step155=_iterator155.n()).done;){var service=_step155.value;var _result5=service(context,pos);if(_result5!=null)return _result5;}}catch(err){_iterator155.e(err);}finally{_iterator155.f();}var tree=syntaxTree(context.state);return tree?syntaxIndentation(context,tree,pos):null;}/**
Indentation contexts are used when calling [indentation
services](https://codemirror.net/6/docs/ref/#language.indentService). They provide helper utilities
useful in indentation logic, and can selectively override the
indentation reported for some lines.
*/var IndentContext=/*#__PURE__*/function(){/**
    Create an indent context.
    */function IndentContext(/**
    The editor state.
    */state){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,IndentContext);this.state=state;this.options=options;this.unit=getIndentUnit(state);}/**
    Get a description of the line at the given position, taking
    [simulated line
    breaks](https://codemirror.net/6/docs/ref/#language.IndentContext.constructor^options.simulateBreak)
    into account. If there is such a break at `pos`, the `bias`
    argument determines whether the part of the line line before or
    after the break is used.
    */_createClass(IndentContext,[{key:"lineAt",value:function lineAt(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var line=this.state.doc.lineAt(pos);var _this$options=this.options,simulateBreak=_this$options.simulateBreak,simulateDoubleBreak=_this$options.simulateDoubleBreak;if(simulateBreak!=null&&simulateBreak>=line.from&&simulateBreak<=line.to){if(simulateDoubleBreak&&simulateBreak==pos)return{text:"",from:pos};else if(bias<0?simulateBreak<pos:simulateBreak<=pos)return{text:line.text.slice(simulateBreak-line.from),from:simulateBreak};else return{text:line.text.slice(0,simulateBreak-line.from),from:line.from};}return line;}/**
    Get the text directly after `pos`, either the entire line
    or the next 100 characters, whichever is shorter.
    */},{key:"textAfterPos",value:function textAfterPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(this.options.simulateDoubleBreak&&pos==this.options.simulateBreak)return"";var _this$lineAt=this.lineAt(pos,bias),text=_this$lineAt.text,from=_this$lineAt.from;return text.slice(pos-from,Math.min(text.length,pos+100-from));}/**
    Find the column for the given position.
    */},{key:"column",value:function column(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var _this$lineAt2=this.lineAt(pos,bias),text=_this$lineAt2.text,from=_this$lineAt2.from;var result=this.countColumn(text,pos-from);var override=this.options.overrideIndentation?this.options.overrideIndentation(from):-1;if(override>-1)result+=override-this.countColumn(text,text.search(/\S|$/));return result;}/**
    Find the column position (taking tabs into account) of the given
    position in the given string.
    */},{key:"countColumn",value:function countColumn(line){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:line.length;return _countColumn(line,this.state.tabSize,pos);}/**
    Find the indentation column of the line at the given point.
    */},{key:"lineIndent",value:function lineIndent(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var _this$lineAt3=this.lineAt(pos,bias),text=_this$lineAt3.text,from=_this$lineAt3.from;var override=this.options.overrideIndentation;if(override){var overriden=override(from);if(overriden>-1)return overriden;}return this.countColumn(text,text.search(/\S|$/));}/**
    Returns the [simulated line
    break](https://codemirror.net/6/docs/ref/#language.IndentContext.constructor^options.simulateBreak)
    for this context, if any.
    */},{key:"simulatedBreak",get:function get(){return this.options.simulateBreak||null;}}]);return IndentContext;}();/**
A syntax tree node prop used to associate indentation strategies
with node types. Such a strategy is a function from an indentation
context to a column number or null, where null indicates that no
definitive indentation can be determined.
*/var indentNodeProp=/*@__PURE__*/new NodeProp();// Compute the indentation for a given position from the syntax tree.
function syntaxIndentation(cx,ast,pos){return indentFrom(ast.resolveInner(pos).enterUnfinishedNodesBefore(pos),pos,cx);}function ignoreClosed(cx){return cx.pos==cx.options.simulateBreak&&cx.options.simulateDoubleBreak;}function indentStrategy(tree){var strategy=tree.type.prop(indentNodeProp);if(strategy)return strategy;var first=tree.firstChild,close;if(first&&(close=first.type.prop(NodeProp.closedBy))){var _last10=tree.lastChild,closed=_last10&&close.indexOf(_last10.name)>-1;return function(cx){return delimitedStrategy(cx,true,1,undefined,closed&&!ignoreClosed(cx)?_last10.from:undefined);};}return tree.parent==null?topIndent:null;}function indentFrom(node,pos,base){for(;node;node=node.parent){var strategy=indentStrategy(node);if(strategy)return strategy(TreeIndentContext.create(base,pos,node));}return null;}function topIndent(){return 0;}/**
Objects of this type provide context information and helper
methods to indentation functions registered on syntax nodes.
*/var TreeIndentContext=/*#__PURE__*/function(_IndentContext){_inherits(TreeIndentContext,_IndentContext);var _super45=_createSuper(TreeIndentContext);function TreeIndentContext(base,/**
    The position at which indentation is being computed.
    */pos,/**
    The syntax tree node to which the indentation strategy
    applies.
    */node){var _this88;_classCallCheck(this,TreeIndentContext);_this88=_super45.call(this,base.state,base.options);_this88.base=base;_this88.pos=pos;_this88.node=node;return _this88;}/**
    @internal
    */_createClass(TreeIndentContext,[{key:"textAfter",get:/**
    Get the text directly after `this.pos`, either the entire line
    or the next 100 characters, whichever is shorter.
    */function get(){return this.textAfterPos(this.pos);}/**
    Get the indentation at the reference line for `this.node`, which
    is the line on which it starts, unless there is a node that is
    _not_ a parent of this node covering the start of that line. If
    so, the line at the start of that node is tried, again skipping
    on if it is covered by another such node.
    */},{key:"baseIndent",get:function get(){var line=this.state.doc.lineAt(this.node.from);// Skip line starts that are covered by a sibling (or cousin, etc)
for(;;){var atBreak=this.node.resolve(line.from);while(atBreak.parent&&atBreak.parent.from==atBreak.from){atBreak=atBreak.parent;}if(isParent(atBreak,this.node))break;line=this.state.doc.lineAt(atBreak.from);}return this.lineIndent(line.from);}/**
    Continue looking for indentations in the node's parent nodes,
    and return the result of that.
    */},{key:"continue",value:function _continue(){var parent=this.node.parent;return parent?indentFrom(parent,this.pos,this.base):0;}}],[{key:"create",value:function create(base,pos,node){return new TreeIndentContext(base,pos,node);}}]);return TreeIndentContext;}(IndentContext);function isParent(parent,of){for(var _cur15=of;_cur15;_cur15=_cur15.parent){if(parent==_cur15)return true;}return false;}// Check whether a delimited node is aligned (meaning there are
// non-skipped nodes on the same line as the opening delimiter). And
// if so, return the opening token.
function bracketedAligned(context){var tree=context.node;var openToken=tree.childAfter(tree.from),last=tree.lastChild;if(!openToken)return null;var sim=context.options.simulateBreak;var openLine=context.state.doc.lineAt(openToken.from);var lineEnd=sim==null||sim<=openLine.from?openLine.to:Math.min(openLine.to,sim);for(var pos=openToken.to;;){var next=tree.childAfter(pos);if(!next||next==last)return null;if(!next.type.isSkipped)return next.from<lineEnd?openToken:null;pos=next.to;}}function delimitedStrategy(context,align,units,closing,closedAt){var after=context.textAfter,space=after.match(/^\s*/)[0].length;var closed=closing&&after.slice(space,space+closing.length)==closing||closedAt==context.pos+space;var aligned=align?bracketedAligned(context):null;if(aligned)return closed?context.column(aligned.from):context.column(aligned.to);return context.baseIndent+(closed?0:context.unit*units);}/**
Creates an indentation strategy that, by default, indents
continued lines one unit more than the node's base indentation.
You can provide `except` to prevent indentation of lines that
match a pattern (for example `/^else\b/` in `if`/`else`
constructs), and you can change the amount of units used with the
`units` option.
*/function continuedIndent(){var _ref53=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},except=_ref53.except,_ref53$units=_ref53.units,units=_ref53$units===void 0?1:_ref53$units;return function(context){var matchExcept=except&&except.test(context.textAfter);return context.baseIndent+(matchExcept?0:units*context.unit);};}var DontIndentBeyond=200;/**
Enables reindentation on input. When a language defines an
`indentOnInput` field in its [language
data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt), which must hold a regular
expression, the line at the cursor will be reindented whenever new
text is typed and the input from the start of the line up to the
cursor matches that regexp.

To avoid unneccesary reindents, it is recommended to start the
regexp with `^` (usually followed by `\s*`), and end it with `$`.
For example, `/^\s*\}$/` will reindent when a closing brace is
added at the start of a line.
*/function indentOnInput(){return EditorState.transactionFilter.of(function(tr){if(!tr.docChanged||!tr.isUserEvent("input.type")&&!tr.isUserEvent("input.complete"))return tr;var rules=tr.startState.languageDataAt("indentOnInput",tr.startState.selection.main.head);if(!rules.length)return tr;var doc=tr.newDoc,head=tr.newSelection.main.head,line=doc.lineAt(head);if(head>line.from+DontIndentBeyond)return tr;var lineStart=doc.sliceString(line.from,head);if(!rules.some(function(r){return r.test(lineStart);}))return tr;var state=tr.state,last=-1,changes=[];var _iterator156=_createForOfIteratorHelper(state.selection.ranges),_step156;try{for(_iterator156.s();!(_step156=_iterator156.n()).done;){var _head3=_step156.value.head;var _line4=state.doc.lineAt(_head3);if(_line4.from==last)continue;last=_line4.from;var indent=getIndentation(state,_line4.from);if(indent==null)continue;var _cur16=/^\s*/.exec(_line4.text)[0];var norm=indentString(state,indent);if(_cur16!=norm)changes.push({from:_line4.from,to:_line4.from+_cur16.length,insert:norm});}}catch(err){_iterator156.e(err);}finally{_iterator156.f();}return changes.length?[tr,{changes:changes,sequential:true}]:tr;});}/**
A facet that registers a code folding service. When called with
the extent of a line, such a function should return a foldable
range that starts on that line (but continues beyond it), if one
can be found.
*/var foldService=/*@__PURE__*/Facet.define();/**
This node prop is used to associate folding information with
syntax node types. Given a syntax node, it should check whether
that tree is foldable and return the range that can be collapsed
when it is.
*/var foldNodeProp=/*@__PURE__*/new NodeProp();/**
[Fold](https://codemirror.net/6/docs/ref/#language.foldNodeProp) function that folds everything but
the first and the last child of a syntax node. Useful for nodes
that start and end with delimiters.
*/function foldInside(node){var first=node.firstChild,last=node.lastChild;return first&&first.to<last.from?{from:first.to,to:last.type.isError?node.to:last.from}:null;}function syntaxFolding(state,start,end){var tree=syntaxTree(state);if(tree.length<end)return null;var inner=tree.resolveInner(end);var found=null;for(var _cur17=inner;_cur17;_cur17=_cur17.parent){if(_cur17.to<=end||_cur17.from>end)continue;if(found&&_cur17.from<start)break;var prop=_cur17.type.prop(foldNodeProp);if(prop&&(_cur17.to<tree.length-50||tree.length==state.doc.length||!isUnfinished(_cur17))){var value=prop(_cur17,state);if(value&&value.from<=end&&value.from>=start&&value.to>end)found=value;}}return found;}function isUnfinished(node){var ch=node.lastChild;return ch&&ch.to==node.to&&ch.type.isError;}/**
Check whether the given line is foldable. First asks any fold
services registered through
[`foldService`](https://codemirror.net/6/docs/ref/#language.foldService), and if none of them return
a result, tries to query the [fold node
prop](https://codemirror.net/6/docs/ref/#language.foldNodeProp) of syntax nodes that cover the end
of the line.
*/function foldable(state,lineStart,lineEnd){var _iterator157=_createForOfIteratorHelper(state.facet(foldService)),_step157;try{for(_iterator157.s();!(_step157=_iterator157.n()).done;){var service=_step157.value;var _result6=service(state,lineStart,lineEnd);if(_result6)return _result6;}}catch(err){_iterator157.e(err);}finally{_iterator157.f();}return syntaxFolding(state,lineStart,lineEnd);}function mapRange(range,mapping){var from=mapping.mapPos(range.from,1),to=mapping.mapPos(range.to,-1);return from>=to?undefined:{from:from,to:to};}/**
State effect that can be attached to a transaction to fold the
given range. (You probably only need this in exceptional
circumstancesusually you'll just want to let
[`foldCode`](https://codemirror.net/6/docs/ref/#language.foldCode) and the [fold
gutter](https://codemirror.net/6/docs/ref/#language.foldGutter) create the transactions.)
*/var foldEffect=/*@__PURE__*/StateEffect.define({map:mapRange});/**
State effect that unfolds the given range (if it was folded).
*/var unfoldEffect=/*@__PURE__*/StateEffect.define({map:mapRange});function selectedLines(view){var lines=[];var _iterator158=_createForOfIteratorHelper(view.state.selection.ranges),_step158;try{var _loop11=function _loop11(){var head=_step158.value.head;if(lines.some(function(l){return l.from<=head&&l.to>=head;}))return"continue";lines.push(view.lineBlockAt(head));};for(_iterator158.s();!(_step158=_iterator158.n()).done;){var _ret=_loop11();if(_ret==="continue")continue;}}catch(err){_iterator158.e(err);}finally{_iterator158.f();}return lines;}/**
The state field that stores the folded ranges (as a [decoration
set](https://codemirror.net/6/docs/ref/#view.DecorationSet)). Can be passed to
[`EditorState.toJSON`](https://codemirror.net/6/docs/ref/#state.EditorState.toJSON) and
[`fromJSON`](https://codemirror.net/6/docs/ref/#state.EditorState^fromJSON) to serialize the fold
state.
*/var foldState=/*@__PURE__*/StateField.define({create:function create(){return Decoration.none;},update:function update(folded,tr){folded=folded.map(tr.changes);var _iterator159=_createForOfIteratorHelper(tr.effects),_step159;try{var _loop12=function _loop12(){var e=_step159.value;if(e.is(foldEffect)&&!foldExists(folded,e.value.from,e.value.to))folded=folded.update({add:[foldWidget.range(e.value.from,e.value.to)]});else if(e.is(unfoldEffect))folded=folded.update({filter:function filter(from,to){return e.value.from!=from||e.value.to!=to;},filterFrom:e.value.from,filterTo:e.value.to});};for(_iterator159.s();!(_step159=_iterator159.n()).done;){_loop12();}// Clear folded ranges that cover the selection head
}catch(err){_iterator159.e(err);}finally{_iterator159.f();}if(tr.selection){var onSelection=false,_head4=tr.selection.main.head;folded.between(_head4,_head4,function(a,b){if(a<_head4&&b>_head4)onSelection=true;});if(onSelection)folded=folded.update({filterFrom:_head4,filterTo:_head4,filter:function filter(a,b){return b<=_head4||a>=_head4;}});}return folded;},provide:function provide(f){return EditorView.decorations.from(f);},toJSON:function toJSON(folded,state){var ranges=[];folded.between(0,state.doc.length,function(from,to){ranges.push(from,to);});return ranges;},fromJSON:function fromJSON(value){if(!Array.isArray(value)||value.length%2)throw new RangeError("Invalid JSON for fold state");var ranges=[];for(var _i180=0;_i180<value.length;){var from=value[_i180++],to=value[_i180++];if(typeof from!="number"||typeof to!="number")throw new RangeError("Invalid JSON for fold state");ranges.push(foldWidget.range(from,to));}return Decoration.set(ranges,true);}});function findFold(state,from,to){var _a;var found=null;(_a=state.field(foldState,false))===null||_a===void 0?void 0:_a.between(from,to,function(from,to){if(!found||found.from>from)found={from:from,to:to};});return found;}function foldExists(folded,from,to){var found=false;folded.between(from,from,function(a,b){if(a==from&&b==to)found=true;});return found;}function maybeEnable(state,other){return state.field(foldState,false)?other:other.concat(StateEffect.appendConfig.of(codeFolding()));}/**
Fold the lines that are selected, if possible.
*/var foldCode=function foldCode(view){var _iterator160=_createForOfIteratorHelper(selectedLines(view)),_step160;try{for(_iterator160.s();!(_step160=_iterator160.n()).done;){var line=_step160.value;var _range12=foldable(view.state,line.from,line.to);if(_range12){view.dispatch({effects:maybeEnable(view.state,[foldEffect.of(_range12),announceFold(view,_range12)])});return true;}}}catch(err){_iterator160.e(err);}finally{_iterator160.f();}return false;};/**
Unfold folded ranges on selected lines.
*/var unfoldCode=function unfoldCode(view){if(!view.state.field(foldState,false))return false;var effects=[];var _iterator161=_createForOfIteratorHelper(selectedLines(view)),_step161;try{for(_iterator161.s();!(_step161=_iterator161.n()).done;){var line=_step161.value;var folded=findFold(view.state,line.from,line.to);if(folded)effects.push(unfoldEffect.of(folded),announceFold(view,folded,false));}}catch(err){_iterator161.e(err);}finally{_iterator161.f();}if(effects.length)view.dispatch({effects:effects});return effects.length>0;};function announceFold(view,range){var fold=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var lineFrom=view.state.doc.lineAt(range.from).number,lineTo=view.state.doc.lineAt(range.to).number;return EditorView.announce.of("".concat(view.state.phrase(fold?"Folded lines":"Unfolded lines")," ").concat(lineFrom," ").concat(view.state.phrase("to")," ").concat(lineTo,"."));}/**
Fold all top-level foldable ranges. Note that, in most cases,
folding information will depend on the [syntax
tree](https://codemirror.net/6/docs/ref/#language.syntaxTree), and folding everything may not work
reliably when the document hasn't been fully parsed (either
because the editor state was only just initialized, or because the
document is so big that the parser decided not to parse it
entirely).
*/var foldAll=function foldAll(view){var state=view.state,effects=[];for(var pos=0;pos<state.doc.length;){var line=view.lineBlockAt(pos),_range13=foldable(state,line.from,line.to);if(_range13)effects.push(foldEffect.of(_range13));pos=(_range13?view.lineBlockAt(_range13.to):line).to+1;}if(effects.length)view.dispatch({effects:maybeEnable(view.state,effects)});return!!effects.length;};/**
Unfold all folded code.
*/var unfoldAll=function unfoldAll(view){var field=view.state.field(foldState,false);if(!field||!field.size)return false;var effects=[];field.between(0,view.state.doc.length,function(from,to){effects.push(unfoldEffect.of({from:from,to:to}));});view.dispatch({effects:effects});return true;};/**
Default fold-related key bindings.

 - Ctrl-Shift-[ (Cmd-Alt-[ on macOS): [`foldCode`](https://codemirror.net/6/docs/ref/#language.foldCode).
 - Ctrl-Shift-] (Cmd-Alt-] on macOS): [`unfoldCode`](https://codemirror.net/6/docs/ref/#language.unfoldCode).
 - Ctrl-Alt-[: [`foldAll`](https://codemirror.net/6/docs/ref/#language.foldAll).
 - Ctrl-Alt-]: [`unfoldAll`](https://codemirror.net/6/docs/ref/#language.unfoldAll).
*/var foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}];var defaultConfig={placeholderDOM:null,placeholderText:""};var foldConfig=/*@__PURE__*/Facet.define({combine:function combine(values){return combineConfig(values,defaultConfig);}});/**
Create an extension that configures code folding.
*/function codeFolding(config){var result=[foldState,baseTheme$1$2];if(config)result.push(foldConfig.of(config));return result;}var foldWidget=/*@__PURE__*/Decoration.replace({widget:/*@__PURE__*/new(/*#__PURE__*/function(_WidgetType7){_inherits(_class11,_WidgetType7);var _super46=_createSuper(_class11);function _class11(){_classCallCheck(this,_class11);return _super46.apply(this,arguments);}_createClass(_class11,[{key:"toDOM",value:function toDOM(view){var state=view.state,conf=state.facet(foldConfig);var onclick=function onclick(event){var line=view.lineBlockAt(view.posAtDOM(event.target));var folded=findFold(view.state,line.from,line.to);if(folded)view.dispatch({effects:unfoldEffect.of(folded)});event.preventDefault();};if(conf.placeholderDOM)return conf.placeholderDOM(view,onclick);var element=document.createElement("span");element.textContent=conf.placeholderText;element.setAttribute("aria-label",state.phrase("folded code"));element.title=state.phrase("unfold");element.className="cm-foldPlaceholder";element.onclick=onclick;return element;}}]);return _class11;}(WidgetType))()});var foldGutterDefaults={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:function foldingChanged(){return false;}};var FoldMarker=/*#__PURE__*/function(_GutterMarker3){_inherits(FoldMarker,_GutterMarker3);var _super47=_createSuper(FoldMarker);function FoldMarker(config,open){var _this89;_classCallCheck(this,FoldMarker);_this89=_super47.call(this);_this89.config=config;_this89.open=open;return _this89;}_createClass(FoldMarker,[{key:"eq",value:function eq(other){return this.config==other.config&&this.open==other.open;}},{key:"toDOM",value:function toDOM(view){if(this.config.markerDOM)return this.config.markerDOM(this.open);var span=document.createElement("span");span.textContent=this.open?this.config.openText:this.config.closedText;span.title=view.state.phrase(this.open?"Fold line":"Unfold line");return span;}}]);return FoldMarker;}(GutterMarker);/**
Create an extension that registers a fold gutter, which shows a
fold status indicator before foldable lines (which can be clicked
to fold or unfold the line).
*/function foldGutter(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var fullConfig=Object.assign(Object.assign({},foldGutterDefaults),config);var canFold=new FoldMarker(fullConfig,true),canUnfold=new FoldMarker(fullConfig,false);var _markers=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class12(view){_classCallCheck(this,_class12);this.from=view.viewport.from;this.markers=this.buildMarkers(view);}_createClass(_class12,[{key:"update",value:function update(_update20){if(_update20.docChanged||_update20.viewportChanged||_update20.startState.facet(language)!=_update20.state.facet(language)||_update20.startState.field(foldState,false)!=_update20.state.field(foldState,false)||syntaxTree(_update20.startState)!=syntaxTree(_update20.state)||fullConfig.foldingChanged(_update20))this.markers=this.buildMarkers(_update20.view);}},{key:"buildMarkers",value:function buildMarkers(view){var builder=new RangeSetBuilder();var _iterator162=_createForOfIteratorHelper(view.viewportLineBlocks),_step162;try{for(_iterator162.s();!(_step162=_iterator162.n()).done;){var line=_step162.value;var mark=findFold(view.state,line.from,line.to)?canUnfold:foldable(view.state,line.from,line.to)?canFold:null;if(mark)builder.add(line.from,line.from,mark);}}catch(err){_iterator162.e(err);}finally{_iterator162.f();}return builder.finish();}}]);return _class12;}());var domEventHandlers=fullConfig.domEventHandlers;return[_markers,gutter({"class":"cm-foldGutter",markers:function markers(view){var _a;return((_a=view.plugin(_markers))===null||_a===void 0?void 0:_a.markers)||RangeSet.empty;},initialSpacer:function initialSpacer(){return new FoldMarker(fullConfig,false);},domEventHandlers:Object.assign(Object.assign({},domEventHandlers),{click:function click(view,line,event){if(domEventHandlers.click&&domEventHandlers.click(view,line,event))return true;var folded=findFold(view.state,line.from,line.to);if(folded){view.dispatch({effects:unfoldEffect.of(folded)});return true;}var range=foldable(view.state,line.from,line.to);if(range){view.dispatch({effects:foldEffect.of(range)});return true;}return false;}})}),codeFolding()];}var baseTheme$1$2=/*@__PURE__*/EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});/**
A highlight style associates CSS styles with higlighting
[tags](https://lezer.codemirror.net/docs/ref#highlight.Tag).
*/var HighlightStyle=/*#__PURE__*/function(){function HighlightStyle(spec,options){_classCallCheck(this,HighlightStyle);var modSpec;function def(spec){var cls=StyleModule.newName();(modSpec||(modSpec=Object.create(null)))["."+cls]=spec;return cls;}var all=typeof options.all=="string"?options.all:options.all?def(options.all):undefined;var scopeOpt=options.scope;this.scope=scopeOpt instanceof Language?function(type){return type.prop(languageDataProp)==scopeOpt.data;}:scopeOpt?function(type){return type==scopeOpt;}:undefined;this.style=tagHighlighter(spec.map(function(style){return{tag:style.tag,"class":style["class"]||def(Object.assign({},style,{tag:null}))};}),{all:all}).style;this.module=modSpec?new StyleModule(modSpec):null;this.themeType=options.themeType;}/**
    Create a highlighter style that associates the given styles to
    the given tags. The specs must be objects that hold a style tag
    or array of tags in their `tag` property, and either a single
    `class` property providing a static CSS class (for highlighter
    that rely on external styling), or a
    [`style-mod`](https://github.com/marijnh/style-mod#documentation)-style
    set of CSS properties (which define the styling for those tags).
    
    The CSS rules created for a highlighter will be emitted in the
    order of the spec's properties. That means that for elements that
    have multiple tags associated with them, styles defined further
    down in the list will have a higher CSS precedence than styles
    defined earlier.
    */_createClass(HighlightStyle,null,[{key:"define",value:function define(specs,options){return new HighlightStyle(specs,options||{});}}]);return HighlightStyle;}();var highlighterFacet=/*@__PURE__*/Facet.define();var fallbackHighlighter=/*@__PURE__*/Facet.define({combine:function combine(values){return values.length?[values[0]]:null;}});function getHighlighters(state){var main=state.facet(highlighterFacet);return main.length?main:state.facet(fallbackHighlighter);}/**
Wrap a highlighter in an editor extension that uses it to apply
syntax highlighting to the editor content.

When multiple (non-fallback) styles are provided, the styling
applied is the union of the classes they emit.
*/function syntaxHighlighting(highlighter,options){var ext=[treeHighlighter],themeType;if(highlighter instanceof HighlightStyle){if(highlighter.module)ext.push(EditorView.styleModule.of(highlighter.module));themeType=highlighter.themeType;}if(options===null||options===void 0?void 0:options.fallback)ext.push(fallbackHighlighter.of(highlighter));else if(themeType)ext.push(highlighterFacet.computeN([EditorView.darkTheme],function(state){return state.facet(EditorView.darkTheme)==(themeType=="dark")?[highlighter]:[];}));else ext.push(highlighterFacet.of(highlighter));return ext;}var TreeHighlighter=/*#__PURE__*/function(){function TreeHighlighter(view){_classCallCheck(this,TreeHighlighter);this.markCache=Object.create(null);this.tree=syntaxTree(view.state);this.decorations=this.buildDeco(view,getHighlighters(view.state));}_createClass(TreeHighlighter,[{key:"update",value:function update(_update21){var tree=syntaxTree(_update21.state),highlighters=getHighlighters(_update21.state);var styleChange=highlighters!=getHighlighters(_update21.startState);if(tree.length<_update21.view.viewport.to&&!styleChange&&tree.type==this.tree.type){this.decorations=this.decorations.map(_update21.changes);}else if(tree!=this.tree||_update21.viewportChanged||styleChange){this.tree=tree;this.decorations=this.buildDeco(_update21.view,highlighters);}}},{key:"buildDeco",value:function buildDeco(view,highlighters){var _this90=this;if(!highlighters||!this.tree.length)return Decoration.none;var builder=new RangeSetBuilder();var _iterator163=_createForOfIteratorHelper(view.visibleRanges),_step163;try{for(_iterator163.s();!(_step163=_iterator163.n()).done;){var _step163$value=_step163.value,from=_step163$value.from,to=_step163$value.to;highlightTree(this.tree,highlighters,function(from,to,style){builder.add(from,to,_this90.markCache[style]||(_this90.markCache[style]=Decoration.mark({"class":style})));},from,to);}}catch(err){_iterator163.e(err);}finally{_iterator163.f();}return builder.finish();}}]);return TreeHighlighter;}();var treeHighlighter=/*@__PURE__*/Prec.high(/*@__PURE__*/ViewPlugin.fromClass(TreeHighlighter,{decorations:function decorations(v){return v.decorations;}}));/**
A default highlight style (works well with light themes).
*/var defaultHighlightStyle=/*@__PURE__*/HighlightStyle.define([{tag:tags.meta,color:"#7a757a"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,/*@__PURE__*/tags.special(tags.string)],color:"#e40"},{tag:/*@__PURE__*/tags.definition(tags.variableName),color:"#00f"},{tag:/*@__PURE__*/tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[/*@__PURE__*/tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:/*@__PURE__*/tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]);var baseTheme$3=/*@__PURE__*/EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}});var DefaultScanDist=10000,DefaultBrackets="()[]{}";var bracketMatchingConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{afterCursor:true,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch});}});var matchingMark=/*@__PURE__*/Decoration.mark({"class":"cm-matchingBracket"}),nonmatchingMark=/*@__PURE__*/Decoration.mark({"class":"cm-nonmatchingBracket"});function defaultRenderMatch(match){var decorations=[];var mark=match.matched?matchingMark:nonmatchingMark;decorations.push(mark.range(match.start.from,match.start.to));if(match.end)decorations.push(mark.range(match.end.from,match.end.to));return decorations;}var bracketMatchingState=/*@__PURE__*/StateField.define({create:function create(){return Decoration.none;},update:function update(deco,tr){if(!tr.docChanged&&!tr.selection)return deco;var decorations=[];var config=tr.state.facet(bracketMatchingConfig);var _iterator164=_createForOfIteratorHelper(tr.state.selection.ranges),_step164;try{for(_iterator164.s();!(_step164=_iterator164.n()).done;){var _range14=_step164.value;if(!_range14.empty)continue;var match=matchBrackets(tr.state,_range14.head,-1,config)||_range14.head>0&&matchBrackets(tr.state,_range14.head-1,1,config)||config.afterCursor&&(matchBrackets(tr.state,_range14.head,1,config)||_range14.head<tr.state.doc.length&&matchBrackets(tr.state,_range14.head+1,-1,config));if(match)decorations=decorations.concat(config.renderMatch(match,tr.state));}}catch(err){_iterator164.e(err);}finally{_iterator164.f();}return Decoration.set(decorations,true);},provide:function provide(f){return EditorView.decorations.from(f);}});var bracketMatchingUnique=[bracketMatchingState,baseTheme$3];/**
Create an extension that enables bracket matching. Whenever the
cursor is next to a bracket, that bracket and the one it matches
are highlighted. Or, when no matching bracket is found, another
highlighting style is used to indicate this.
*/function bracketMatching(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[bracketMatchingConfig.of(config),bracketMatchingUnique];}function matchingNodes(node,dir,brackets){var byProp=node.prop(dir<0?NodeProp.openedBy:NodeProp.closedBy);if(byProp)return byProp;if(node.name.length==1){var index=brackets.indexOf(node.name);if(index>-1&&index%2==(dir<0?1:0))return[brackets[index+dir]];}return null;}/**
Find the matching bracket for the token at `pos`, scanning
direction `dir`. Only the `brackets` and `maxScanDistance`
properties are used from `config`, if given. Returns null if no
bracket was found at `pos`, or a match result otherwise.
*/function matchBrackets(state,pos,dir){var config=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var maxScanDistance=config.maxScanDistance||DefaultScanDist,brackets=config.brackets||DefaultBrackets;var tree=syntaxTree(state),node=tree.resolveInner(pos,dir);for(var _cur18=node;_cur18;_cur18=_cur18.parent){var _matches=matchingNodes(_cur18.type,dir,brackets);if(_matches&&_cur18.from<_cur18.to)return matchMarkedBrackets(state,pos,dir,_cur18,_matches,brackets);}return matchPlainBrackets(state,pos,dir,tree,node.type,maxScanDistance,brackets);}function matchMarkedBrackets(_state,_pos,dir,token,matching,brackets){var parent=token.parent,firstToken={from:token.from,to:token.to};var depth=0,cursor=parent===null||parent===void 0?void 0:parent.cursor();if(cursor&&(dir<0?cursor.childBefore(token.from):cursor.childAfter(token.to)))do{if(dir<0?cursor.to<=token.from:cursor.from>=token.to){if(depth==0&&matching.indexOf(cursor.type.name)>-1&&cursor.from<cursor.to){return{start:firstToken,end:{from:cursor.from,to:cursor.to},matched:true};}else if(matchingNodes(cursor.type,dir,brackets)){depth++;}else if(matchingNodes(cursor.type,-dir,brackets)){if(depth==0)return{start:firstToken,end:cursor.from==cursor.to?undefined:{from:cursor.from,to:cursor.to},matched:false};depth--;}}}while(dir<0?cursor.prevSibling():cursor.nextSibling());return{start:firstToken,matched:false};}function matchPlainBrackets(state,pos,dir,tree,tokenType,maxScanDistance,brackets){var startCh=dir<0?state.sliceDoc(pos-1,pos):state.sliceDoc(pos,pos+1);var bracket=brackets.indexOf(startCh);if(bracket<0||bracket%2==0!=dir>0)return null;var startToken={from:dir<0?pos-1:pos,to:dir>0?pos+1:pos};var iter=state.doc.iterRange(pos,dir>0?state.doc.length:0),depth=0;for(var distance=0;!iter.next().done&&distance<=maxScanDistance;){var _text6=iter.value;if(dir<0)distance+=_text6.length;var basePos=pos+distance*dir;for(var _pos2=dir>0?0:_text6.length-1,end=dir>0?_text6.length:-1;_pos2!=end;_pos2+=dir){var found=brackets.indexOf(_text6[_pos2]);if(found<0||tree.resolveInner(basePos+_pos2,1).type!=tokenType)continue;if(found%2==0==dir>0){depth++;}else if(depth==1){// Closing
return{start:startToken,end:{from:basePos+_pos2,to:basePos+_pos2+1},matched:found>>1==bracket>>1};}else{depth--;}}if(dir>0)distance+=_text6.length;}return iter.done?{start:startToken,matched:false}:null;}var noTokens=/*@__PURE__*/Object.create(null);var typeArray=[NodeType.none];var warned=[];var defaultTable=/*@__PURE__*/Object.create(null);for(var _i181=0,_arr3=[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]];_i181<_arr3.length;_i181++){var _arr3$_i=_slicedToArray(_arr3[_i181],2),legacyName=_arr3$_i[0],_name8=_arr3$_i[1];defaultTable[legacyName]=/*@__PURE__*/createTokenType(noTokens,_name8);}function warnForPart(part,msg){if(warned.indexOf(part)>-1)return;warned.push(part);console.warn(msg);}function createTokenType(extra,tagStr){var tag=null;var _iterator165=_createForOfIteratorHelper(tagStr.split(".")),_step165;try{for(_iterator165.s();!(_step165=_iterator165.n()).done;){var part=_step165.value;var value=extra[part]||tags[part];if(!value){warnForPart(part,"Unknown highlighting tag ".concat(part));}else if(typeof value=="function"){if(!tag)warnForPart(part,"Modifier ".concat(part," used at start of tag"));else tag=value(tag);}else{if(tag)warnForPart(part,"Tag ".concat(part," used as modifier"));else tag=value;}}}catch(err){_iterator165.e(err);}finally{_iterator165.f();}if(!tag)return 0;var name=tagStr.replace(/ /g,"_"),type=NodeType.define({id:typeArray.length,name:name,props:[styleTags(_defineProperty2({},name,tag))]});typeArray.push(type);return type.id;}/**
Comment or uncomment the current selection. Will use line comments
if available, otherwise falling back to block comments.
*/var toggleComment=function toggleComment(target){var config=getConfig(target.state);return config.line?toggleLineComment(target):config.block?toggleBlockCommentByLine(target):false;};function command(f,option){return function(_ref54){var state=_ref54.state,dispatch=_ref54.dispatch;if(state.readOnly)return false;var tr=f(option,state);if(!tr)return false;dispatch(state.update(tr));return true;};}/**
Comment or uncomment the current selection using line comments.
The line comment syntax is taken from the
[`commentTokens`](https://codemirror.net/6/docs/ref/#commands.CommentTokens) [language
data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt).
*/var toggleLineComment=/*@__PURE__*/command(changeLineComment,0/* CommentOption.Toggle */);/**
Comment or uncomment the current selection using block comments.
The block comment syntax is taken from the
[`commentTokens`](https://codemirror.net/6/docs/ref/#commands.CommentTokens) [language
data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt).
*/var toggleBlockComment=/*@__PURE__*/command(changeBlockComment,0/* CommentOption.Toggle */);/**
Comment or uncomment the lines around the current selection using
block comments.
*/var toggleBlockCommentByLine=/*@__PURE__*/command(function(o,s){return changeBlockComment(o,s,selectedLineRanges(s));},0/* CommentOption.Toggle */);function getConfig(state){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:state.selection.main.head;var data=state.languageDataAt("commentTokens",pos);return data.length?data[0]:{};}var SearchMargin=50;/**
Determines if the given range is block-commented in the given
state.
*/function findBlockComment(state,_ref55,from,to){var open=_ref55.open,close=_ref55.close;var textBefore=state.sliceDoc(from-SearchMargin,from);var textAfter=state.sliceDoc(to,to+SearchMargin);var spaceBefore=/\s*$/.exec(textBefore)[0].length,spaceAfter=/^\s*/.exec(textAfter)[0].length;var beforeOff=textBefore.length-spaceBefore;if(textBefore.slice(beforeOff-open.length,beforeOff)==open&&textAfter.slice(spaceAfter,spaceAfter+close.length)==close){return{open:{pos:from-spaceBefore,margin:spaceBefore&&1},close:{pos:to+spaceAfter,margin:spaceAfter&&1}};}var startText,endText;if(to-from<=2*SearchMargin){startText=endText=state.sliceDoc(from,to);}else{startText=state.sliceDoc(from,from+SearchMargin);endText=state.sliceDoc(to-SearchMargin,to);}var startSpace=/^\s*/.exec(startText)[0].length,endSpace=/\s*$/.exec(endText)[0].length;var endOff=endText.length-endSpace-close.length;if(startText.slice(startSpace,startSpace+open.length)==open&&endText.slice(endOff,endOff+close.length)==close){return{open:{pos:from+startSpace+open.length,margin:/\s/.test(startText.charAt(startSpace+open.length))?1:0},close:{pos:to-endSpace-close.length,margin:/\s/.test(endText.charAt(endOff-1))?1:0}};}return null;}function selectedLineRanges(state){var ranges=[];var _iterator166=_createForOfIteratorHelper(state.selection.ranges),_step166;try{for(_iterator166.s();!(_step166=_iterator166.n()).done;){var _r11=_step166.value;var fromLine=state.doc.lineAt(_r11.from);var toLine=_r11.to<=fromLine.to?fromLine:state.doc.lineAt(_r11.to);var _last11=ranges.length-1;if(_last11>=0&&ranges[_last11].to>fromLine.from)ranges[_last11].to=toLine.to;else ranges.push({from:fromLine.from,to:toLine.to});}}catch(err){_iterator166.e(err);}finally{_iterator166.f();}return ranges;}// Performs toggle, comment and uncomment of block comments in
// languages that support them.
function changeBlockComment(option,state){var ranges=arguments.length>2&&arguments[2]!==undefined?arguments[2]:state.selection.ranges;var tokens=ranges.map(function(r){return getConfig(state,r.from).block;});if(!tokens.every(function(c){return c;}))return null;var comments=ranges.map(function(r,i){return findBlockComment(state,tokens[i],r.from,r.to);});if(option!=2/* CommentOption.Uncomment */&&!comments.every(function(c){return c;})){return{changes:state.changes(ranges.map(function(range,i){if(comments[i])return[];return[{from:range.from,insert:tokens[i].open+" "},{from:range.to,insert:" "+tokens[i].close}];}))};}else if(option!=1/* CommentOption.Comment */&&comments.some(function(c){return c;})){var changes=[];for(var _i182=0,_comment;_i182<comments.length;_i182++){if(_comment=comments[_i182]){var token=tokens[_i182],_comment2=_comment,open=_comment2.open,close=_comment2.close;changes.push({from:open.pos-token.open.length,to:open.pos+open.margin},{from:close.pos-close.margin,to:close.pos+token.close.length});}}return{changes:changes};}return null;}// Performs toggle, comment and uncomment of line comments.
function changeLineComment(option,state){var ranges=arguments.length>2&&arguments[2]!==undefined?arguments[2]:state.selection.ranges;var lines=[];var prevLine=-1;var _iterator167=_createForOfIteratorHelper(ranges),_step167;try{for(_iterator167.s();!(_step167=_iterator167.n()).done;){var _step167$value=_step167.value,_from3=_step167$value.from,_to2=_step167$value.to;var startI=lines.length,minIndent=1e9;for(var pos=_from3;pos<=_to2;){var _line6=state.doc.lineAt(pos);if(_line6.from>prevLine&&(_from3==_to2||_to2>_line6.from)){prevLine=_line6.from;var _token2=getConfig(state,pos).line;if(!_token2)continue;var _indent=/^\s*/.exec(_line6.text)[0].length;var _empty2=_indent==_line6.length;var _comment4=_line6.text.slice(_indent,_indent+_token2.length)==_token2?_indent:-1;if(_indent<_line6.text.length&&_indent<minIndent)minIndent=_indent;lines.push({line:_line6,comment:_comment4,token:_token2,indent:_indent,empty:_empty2,single:false});}pos=_line6.to+1;}if(minIndent<1e9)for(var _i183=startI;_i183<lines.length;_i183++){if(lines[_i183].indent<lines[_i183].line.text.length)lines[_i183].indent=minIndent;}if(lines.length==startI+1)lines[startI].single=true;}}catch(err){_iterator167.e(err);}finally{_iterator167.f();}if(option!=2/* CommentOption.Uncomment */&&lines.some(function(l){return l.comment<0&&(!l.empty||l.single);})){var changes=[];var _iterator168=_createForOfIteratorHelper(lines),_step168;try{for(_iterator168.s();!(_step168=_iterator168.n()).done;){var _step168$value=_step168.value,line=_step168$value.line,token=_step168$value.token,indent=_step168$value.indent,_empty=_step168$value.empty,single=_step168$value.single;if(single||!_empty)changes.push({from:line.from+indent,insert:token+" "});}}catch(err){_iterator168.e(err);}finally{_iterator168.f();}var changeSet=state.changes(changes);return{changes:changeSet,selection:state.selection.map(changeSet,1)};}else if(option!=1/* CommentOption.Comment */&&lines.some(function(l){return l.comment>=0;})){var _changes2=[];var _iterator169=_createForOfIteratorHelper(lines),_step169;try{for(_iterator169.s();!(_step169=_iterator169.n()).done;){var _step169$value=_step169.value,_line5=_step169$value.line,_comment3=_step169$value.comment,_token=_step169$value.token;if(_comment3>=0){var from=_line5.from+_comment3,to=from+_token.length;if(_line5.text[to-_line5.from]==" ")to++;_changes2.push({from:from,to:to});}}}catch(err){_iterator169.e(err);}finally{_iterator169.f();}return{changes:_changes2};}return null;}var fromHistory=/*@__PURE__*/Annotation.define();/**
Transaction annotation that will prevent that transaction from
being combined with other transactions in the undo history. Given
`"before"`, it'll prevent merging with previous transactions. With
`"after"`, subsequent transactions won't be combined with this
one. With `"full"`, the transaction is isolated on both sides.
*/var isolateHistory=/*@__PURE__*/Annotation.define();/**
This facet provides a way to register functions that, given a
transaction, provide a set of effects that the history should
store when inverting the transaction. This can be used to
integrate some kinds of effects in the history, so that they can
be undone (and redone again).
*/var invertedEffects=/*@__PURE__*/Facet.define();var historyConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min});}});function changeEnd(changes){var end=0;changes.iterChangedRanges(function(_,to){return end=to;});return end;}var historyField_=/*@__PURE__*/StateField.define({create:function create(){return HistoryState.empty;},update:function update(state,tr){var config=tr.state.facet(historyConfig);var fromHist=tr.annotation(fromHistory);if(fromHist){var selection=tr.docChanged?EditorSelection.single(changeEnd(tr.changes)):undefined;var item=HistEvent.fromTransaction(tr,selection),from=fromHist.side;var other=from==0/* BranchName.Done */?state.undone:state.done;if(item)other=updateBranch(other,other.length,config.minDepth,item);else other=_addSelection(other,tr.startState.selection);return new HistoryState(from==0/* BranchName.Done */?fromHist.rest:other,from==0/* BranchName.Done */?other:fromHist.rest);}var isolate=tr.annotation(isolateHistory);if(isolate=="full"||isolate=="before")state=state.isolate();if(tr.annotation(Transaction.addToHistory)===false)return!tr.changes.empty?state.addMapping(tr.changes.desc):state;var event=HistEvent.fromTransaction(tr);var time=tr.annotation(Transaction.time),userEvent=tr.annotation(Transaction.userEvent);if(event)state=state.addChanges(event,time,userEvent,config.newGroupDelay,config.minDepth);else if(tr.selection)state=state.addSelection(tr.startState.selection,time,userEvent,config.newGroupDelay);if(isolate=="full"||isolate=="after")state=state.isolate();return state;},toJSON:function toJSON(value){return{done:value.done.map(function(e){return e.toJSON();}),undone:value.undone.map(function(e){return e.toJSON();})};},fromJSON:function fromJSON(json){return new HistoryState(json.done.map(HistEvent.fromJSON),json.undone.map(HistEvent.fromJSON));}});/**
Create a history extension with the given configuration.
*/function history(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[historyField_,historyConfig.of(config),EditorView.domEventHandlers({beforeinput:function beforeinput(e,view){var command=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;if(!command)return false;e.preventDefault();return command(view);}})];}function cmd(side,selection){return function(_ref56){var state=_ref56.state,dispatch=_ref56.dispatch;if(!selection&&state.readOnly)return false;var historyState=state.field(historyField_,false);if(!historyState)return false;var tr=historyState.pop(side,state,selection);if(!tr)return false;dispatch(tr);return true;};}/**
Undo a single group of history events. Returns false if no group
was available.
*/var undo=/*@__PURE__*/cmd(0/* BranchName.Done */,false);/**
Redo a group of history events. Returns false if no group was
available.
*/var redo=/*@__PURE__*/cmd(1/* BranchName.Undone */,false);/**
Undo a change or selection change.
*/var undoSelection=/*@__PURE__*/cmd(0/* BranchName.Done */,true);/**
Redo a change or selection change.
*/var redoSelection=/*@__PURE__*/cmd(1/* BranchName.Undone */,true);function depth(side){return function(state){var histState=state.field(historyField_,false);if(!histState)return 0;var branch=side==0/* BranchName.Done */?histState.done:histState.undone;return branch.length-(branch.length&&!branch[0].changes?1:0);};}/**
The amount of undoable change events available in a given state.
*/var undoDepth=/*@__PURE__*/depth(0/* BranchName.Done */);/**
The amount of redoable change events available in a given state.
*/var redoDepth=/*@__PURE__*/depth(1/* BranchName.Undone */);// History events store groups of changes or effects that need to be
// undone/redone together.
var HistEvent=/*#__PURE__*/function(){function HistEvent(// The changes in this event. Normal events hold at least one
// change or effect. But it may be necessary to store selection
// events before the first change, in which case a special type of
// instance is created which doesn't hold any changes, with
// changes == startSelection == undefined
changes,// The effects associated with this event
effects,// Accumulated mapping (from addToHistory==false) that should be
// applied to events below this one.
mapped,// The selection before this event
startSelection,// Stores selection changes after this event, to be used for
// selection undo/redo.
selectionsAfter){_classCallCheck(this,HistEvent);this.changes=changes;this.effects=effects;this.mapped=mapped;this.startSelection=startSelection;this.selectionsAfter=selectionsAfter;}_createClass(HistEvent,[{key:"setSelAfter",value:function setSelAfter(after){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,after);}},{key:"toJSON",value:function toJSON(){var _a,_b,_c;return{changes:(_a=this.changes)===null||_a===void 0?void 0:_a.toJSON(),mapped:(_b=this.mapped)===null||_b===void 0?void 0:_b.toJSON(),startSelection:(_c=this.startSelection)===null||_c===void 0?void 0:_c.toJSON(),selectionsAfter:this.selectionsAfter.map(function(s){return s.toJSON();})};}}],[{key:"fromJSON",value:function fromJSON(json){return new HistEvent(json.changes&&ChangeSet.fromJSON(json.changes),[],json.mapped&&ChangeDesc.fromJSON(json.mapped),json.startSelection&&EditorSelection.fromJSON(json.startSelection),json.selectionsAfter.map(EditorSelection.fromJSON));}// This does not check `addToHistory` and such, it assumes the
// transaction needs to be converted to an item. Returns null when
// there are no changes or effects in the transaction.
},{key:"fromTransaction",value:function fromTransaction(tr,selection){var effects=none$1;var _iterator170=_createForOfIteratorHelper(tr.startState.facet(invertedEffects)),_step170;try{for(_iterator170.s();!(_step170=_iterator170.n()).done;){var _invert=_step170.value;var _result7=_invert(tr);if(_result7.length)effects=effects.concat(_result7);}}catch(err){_iterator170.e(err);}finally{_iterator170.f();}if(!effects.length&&tr.changes.empty)return null;return new HistEvent(tr.changes.invert(tr.startState.doc),effects,undefined,selection||tr.startState.selection,none$1);}},{key:"selection",value:function selection(selections){return new HistEvent(undefined,none$1,undefined,undefined,selections);}}]);return HistEvent;}();function updateBranch(branch,to,maxLen,newEvent){var start=to+1>maxLen+20?to-maxLen-1:0;var newBranch=branch.slice(start,to);newBranch.push(newEvent);return newBranch;}function isAdjacent(a,b){var ranges=[],isAdjacent=false;a.iterChangedRanges(function(f,t){return ranges.push(f,t);});b.iterChangedRanges(function(_f,_t,f,t){for(var _i184=0;_i184<ranges.length;){var from=ranges[_i184++],to=ranges[_i184++];if(t>=from&&f<=to)isAdjacent=true;}});return isAdjacent;}function eqSelectionShape(a,b){return a.ranges.length==b.ranges.length&&a.ranges.filter(function(r,i){return r.empty!=b.ranges[i].empty;}).length===0;}function conc(a,b){return!a.length?b:!b.length?a:a.concat(b);}var none$1=[];var MaxSelectionsPerEvent=200;function _addSelection(branch,selection){if(!branch.length){return[HistEvent.selection([selection])];}else{var lastEvent=branch[branch.length-1];var sels=lastEvent.selectionsAfter.slice(Math.max(0,lastEvent.selectionsAfter.length-MaxSelectionsPerEvent));if(sels.length&&sels[sels.length-1].eq(selection))return branch;sels.push(selection);return updateBranch(branch,branch.length-1,1e9,lastEvent.setSelAfter(sels));}}// Assumes the top item has one or more selectionAfter values
function popSelection(branch){var last=branch[branch.length-1];var newBranch=branch.slice();newBranch[branch.length-1]=last.setSelAfter(last.selectionsAfter.slice(0,last.selectionsAfter.length-1));return newBranch;}// Add a mapping to the top event in the given branch. If this maps
// away all the changes and effects in that item, drop it and
// propagate the mapping to the next item.
function addMappingToBranch(branch,mapping){if(!branch.length)return branch;var length=branch.length,selections=none$1;while(length){var event=mapEvent(branch[length-1],mapping,selections);if(event.changes&&!event.changes.empty||event.effects.length){// Event survived mapping
var _result8=branch.slice(0,length);_result8[length-1]=event;return _result8;}else{// Drop this event, since there's no changes or effects left
mapping=event.mapped;length--;selections=event.selectionsAfter;}}return selections.length?[HistEvent.selection(selections)]:none$1;}function mapEvent(event,mapping,extraSelections){var selections=conc(event.selectionsAfter.length?event.selectionsAfter.map(function(s){return s.map(mapping);}):none$1,extraSelections);// Change-less events don't store mappings (they are always the last event in a branch)
if(!event.changes)return HistEvent.selection(selections);var mappedChanges=event.changes.map(mapping),before=mapping.mapDesc(event.changes,true);var fullMapping=event.mapped?event.mapped.composeDesc(before):before;return new HistEvent(mappedChanges,StateEffect.mapEffects(event.effects,mapping),fullMapping,event.startSelection.map(before),selections);}var joinableUserEvent=/^(input\.type|delete)($|\.)/;var HistoryState=/*#__PURE__*/function(){function HistoryState(done,undone){var prevTime=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var prevUserEvent=arguments.length>3&&arguments[3]!==undefined?arguments[3]:undefined;_classCallCheck(this,HistoryState);this.done=done;this.undone=undone;this.prevTime=prevTime;this.prevUserEvent=prevUserEvent;}_createClass(HistoryState,[{key:"isolate",value:function isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this;}},{key:"addChanges",value:function addChanges(event,time,userEvent,newGroupDelay,maxLen){var done=this.done,lastEvent=done[done.length-1];if(lastEvent&&lastEvent.changes&&!lastEvent.changes.empty&&event.changes&&(!userEvent||joinableUserEvent.test(userEvent))&&(!lastEvent.selectionsAfter.length&&time-this.prevTime<newGroupDelay&&isAdjacent(lastEvent.changes,event.changes)||// For compose (but not compose.start) events, always join with previous event
userEvent=="input.type.compose")){done=updateBranch(done,done.length-1,maxLen,new HistEvent(event.changes.compose(lastEvent.changes),conc(event.effects,lastEvent.effects),lastEvent.mapped,lastEvent.startSelection,none$1));}else{done=updateBranch(done,done.length,maxLen,event);}return new HistoryState(done,none$1,time,userEvent);}},{key:"addSelection",value:function addSelection(selection,time,userEvent,newGroupDelay){var last=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;if(last.length>0&&time-this.prevTime<newGroupDelay&&userEvent==this.prevUserEvent&&userEvent&&/^select($|\.)/.test(userEvent)&&eqSelectionShape(last[last.length-1],selection))return this;return new HistoryState(_addSelection(this.done,selection),this.undone,time,userEvent);}},{key:"addMapping",value:function addMapping(mapping){return new HistoryState(addMappingToBranch(this.done,mapping),addMappingToBranch(this.undone,mapping),this.prevTime,this.prevUserEvent);}},{key:"pop",value:function pop(side,state,selection){var branch=side==0/* BranchName.Done */?this.done:this.undone;if(branch.length==0)return null;var event=branch[branch.length-1];if(selection&&event.selectionsAfter.length){return state.update({selection:event.selectionsAfter[event.selectionsAfter.length-1],annotations:fromHistory.of({side:side,rest:popSelection(branch)}),userEvent:side==0/* BranchName.Done */?"select.undo":"select.redo",scrollIntoView:true});}else if(!event.changes){return null;}else{var _rest2=branch.length==1?none$1:branch.slice(0,branch.length-1);if(event.mapped)_rest2=addMappingToBranch(_rest2,event.mapped);return state.update({changes:event.changes,selection:event.startSelection,effects:event.effects,annotations:fromHistory.of({side:side,rest:_rest2}),filter:false,userEvent:side==0/* BranchName.Done */?"undo":"redo",scrollIntoView:true});}}}]);return HistoryState;}();HistoryState.empty=/*@__PURE__*/new HistoryState(none$1,none$1);/**
Default key bindings for the undo history.

- Mod-z: [`undo`](https://codemirror.net/6/docs/ref/#commands.undo).
- Mod-y (Mod-Shift-z on macOS) + Ctrl-Shift-z on Linux: [`redo`](https://codemirror.net/6/docs/ref/#commands.redo).
- Mod-u: [`undoSelection`](https://codemirror.net/6/docs/ref/#commands.undoSelection).
- Alt-u (Mod-Shift-u on macOS): [`redoSelection`](https://codemirror.net/6/docs/ref/#commands.redoSelection).
*/var historyKeymap=[{key:"Mod-z",run:undo,preventDefault:true},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:true},{linux:"Ctrl-Shift-z",run:redo,preventDefault:true},{key:"Mod-u",run:undoSelection,preventDefault:true},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:true}];function updateSel(sel,by){return EditorSelection.create(sel.ranges.map(by),sel.mainIndex);}function setSel(state,selection){return state.update({selection:selection,scrollIntoView:true,userEvent:"select"});}function moveSel(_ref57,how){var state=_ref57.state,dispatch=_ref57.dispatch;var selection=updateSel(state.selection,how);if(selection.eq(state.selection))return false;dispatch(setSel(state,selection));return true;}function rangeEnd(range,forward){return EditorSelection.cursor(forward?range.to:range.from);}function cursorByChar(view,forward){return moveSel(view,function(range){return range.empty?view.moveByChar(range,forward):rangeEnd(range,forward);});}function ltrAtCursor(view){return view.textDirectionAt(view.state.selection.main.head)==Direction.LTR;}/**
Move the selection one character to the left (which is backward in
left-to-right text, forward in right-to-left text).
*/var cursorCharLeft=function cursorCharLeft(view){return cursorByChar(view,!ltrAtCursor(view));};/**
Move the selection one character to the right.
*/var cursorCharRight=function cursorCharRight(view){return cursorByChar(view,ltrAtCursor(view));};function cursorByGroup(view,forward){return moveSel(view,function(range){return range.empty?view.moveByGroup(range,forward):rangeEnd(range,forward);});}/**
Move the selection to the left across one group of word or
non-word (but also non-space) characters.
*/var cursorGroupLeft=function cursorGroupLeft(view){return cursorByGroup(view,!ltrAtCursor(view));};/**
Move the selection one group to the right.
*/var cursorGroupRight=function cursorGroupRight(view){return cursorByGroup(view,ltrAtCursor(view));};function interestingNode(state,node,bracketProp){if(node.type.prop(bracketProp))return true;var len=node.to-node.from;return len&&(len>2||/[^\s,.;:]/.test(state.sliceDoc(node.from,node.to)))||node.firstChild;}function moveBySyntax(state,start,forward){var pos=syntaxTree(state).resolveInner(start.head);var bracketProp=forward?NodeProp.closedBy:NodeProp.openedBy;// Scan forward through child nodes to see if there's an interesting
// node ahead.
for(var _at=start.head;;){var next=forward?pos.childAfter(_at):pos.childBefore(_at);if(!next)break;if(interestingNode(state,next,bracketProp))pos=next;else _at=forward?next.to:next.from;}var bracket=pos.type.prop(bracketProp),match,newPos;if(bracket&&(match=forward?matchBrackets(state,pos.from,1):matchBrackets(state,pos.to,-1))&&match.matched)newPos=forward?match.end.to:match.end.from;else newPos=forward?pos.to:pos.from;return EditorSelection.cursor(newPos,forward?-1:1);}/**
Move the cursor over the next syntactic element to the left.
*/var cursorSyntaxLeft=function cursorSyntaxLeft(view){return moveSel(view,function(range){return moveBySyntax(view.state,range,!ltrAtCursor(view));});};/**
Move the cursor over the next syntactic element to the right.
*/var cursorSyntaxRight=function cursorSyntaxRight(view){return moveSel(view,function(range){return moveBySyntax(view.state,range,ltrAtCursor(view));});};function cursorByLine(view,forward){return moveSel(view,function(range){if(!range.empty)return rangeEnd(range,forward);var moved=view.moveVertically(range,forward);return moved.head!=range.head?moved:view.moveToLineBoundary(range,forward);});}/**
Move the selection one line up.
*/var cursorLineUp=function cursorLineUp(view){return cursorByLine(view,false);};/**
Move the selection one line down.
*/var cursorLineDown=function cursorLineDown(view){return cursorByLine(view,true);};function pageHeight(view){return Math.max(view.defaultLineHeight,Math.min(view.dom.clientHeight,innerHeight)-5);}function cursorByPage(view,forward){var state=view.state,selection=updateSel(state.selection,function(range){return range.empty?view.moveVertically(range,forward,pageHeight(view)):rangeEnd(range,forward);});if(selection.eq(state.selection))return false;var startPos=view.coordsAtPos(state.selection.main.head);var scrollRect=view.scrollDOM.getBoundingClientRect();var effect;if(startPos&&startPos.top>scrollRect.top&&startPos.bottom<scrollRect.bottom&&startPos.top-scrollRect.top<=view.scrollDOM.scrollHeight-view.scrollDOM.scrollTop-view.scrollDOM.clientHeight)effect=EditorView.scrollIntoView(selection.main.head,{y:"start",yMargin:startPos.top-scrollRect.top});view.dispatch(setSel(state,selection),{effects:effect});return true;}/**
Move the selection one page up.
*/var cursorPageUp=function cursorPageUp(view){return cursorByPage(view,false);};/**
Move the selection one page down.
*/var cursorPageDown=function cursorPageDown(view){return cursorByPage(view,true);};function moveByLineBoundary(view,start,forward){var line=view.lineBlockAt(start.head),moved=view.moveToLineBoundary(start,forward);if(moved.head==start.head&&moved.head!=(forward?line.to:line.from))moved=view.moveToLineBoundary(start,forward,false);if(!forward&&moved.head==line.from&&line.length){var _space=/^\s*/.exec(view.state.sliceDoc(line.from,Math.min(line.from+100,line.to)))[0].length;if(_space&&start.head!=line.from+_space)moved=EditorSelection.cursor(line.from+_space);}return moved;}/**
Move the selection to the next line wrap point, or to the end of
the line if there isn't one left on this line.
*/var cursorLineBoundaryForward=function cursorLineBoundaryForward(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,true);});};/**
Move the selection to previous line wrap point, or failing that to
the start of the line. If the line is indented, and the cursor
isn't already at the end of the indentation, this will move to the
end of the indentation instead of the start of the line.
*/var cursorLineBoundaryBackward=function cursorLineBoundaryBackward(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,false);});};/**
Move the selection one line wrap point to the left.
*/var cursorLineBoundaryLeft=function cursorLineBoundaryLeft(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,!ltrAtCursor(view));});};/**
Move the selection one line wrap point to the right.
*/var cursorLineBoundaryRight=function cursorLineBoundaryRight(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,ltrAtCursor(view));});};/**
Move the selection to the start of the line.
*/var cursorLineStart=function cursorLineStart(view){return moveSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).from,1);});};/**
Move the selection to the end of the line.
*/var cursorLineEnd=function cursorLineEnd(view){return moveSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).to,-1);});};function toMatchingBracket(state,dispatch,extend){var found=false,selection=updateSel(state.selection,function(range){var matching=matchBrackets(state,range.head,-1)||matchBrackets(state,range.head,1)||range.head>0&&matchBrackets(state,range.head-1,1)||range.head<state.doc.length&&matchBrackets(state,range.head+1,-1);if(!matching||!matching.end)return range;found=true;var head=matching.start.from==range.head?matching.end.to:matching.end.from;return extend?EditorSelection.range(range.anchor,head):EditorSelection.cursor(head);});if(!found)return false;dispatch(setSel(state,selection));return true;}/**
Move the selection to the bracket matching the one it is currently
on, if any.
*/var cursorMatchingBracket=function cursorMatchingBracket(_ref58){var state=_ref58.state,dispatch=_ref58.dispatch;return toMatchingBracket(state,dispatch,false);};function extendSel(view,how){var selection=updateSel(view.state.selection,function(range){var head=how(range);return EditorSelection.range(range.anchor,head.head,head.goalColumn);});if(selection.eq(view.state.selection))return false;view.dispatch(setSel(view.state,selection));return true;}function selectByChar(view,forward){return extendSel(view,function(range){return view.moveByChar(range,forward);});}/**
Move the selection head one character to the left, while leaving
the anchor in place.
*/var selectCharLeft=function selectCharLeft(view){return selectByChar(view,!ltrAtCursor(view));};/**
Move the selection head one character to the right.
*/var selectCharRight=function selectCharRight(view){return selectByChar(view,ltrAtCursor(view));};function selectByGroup(view,forward){return extendSel(view,function(range){return view.moveByGroup(range,forward);});}/**
Move the selection head one [group](https://codemirror.net/6/docs/ref/#commands.cursorGroupLeft) to
the left.
*/var selectGroupLeft=function selectGroupLeft(view){return selectByGroup(view,!ltrAtCursor(view));};/**
Move the selection head one group to the right.
*/var selectGroupRight=function selectGroupRight(view){return selectByGroup(view,ltrAtCursor(view));};/**
Move the selection head over the next syntactic element to the left.
*/var selectSyntaxLeft=function selectSyntaxLeft(view){return extendSel(view,function(range){return moveBySyntax(view.state,range,!ltrAtCursor(view));});};/**
Move the selection head over the next syntactic element to the right.
*/var selectSyntaxRight=function selectSyntaxRight(view){return extendSel(view,function(range){return moveBySyntax(view.state,range,ltrAtCursor(view));});};function selectByLine(view,forward){return extendSel(view,function(range){return view.moveVertically(range,forward);});}/**
Move the selection head one line up.
*/var selectLineUp=function selectLineUp(view){return selectByLine(view,false);};/**
Move the selection head one line down.
*/var selectLineDown=function selectLineDown(view){return selectByLine(view,true);};function selectByPage(view,forward){return extendSel(view,function(range){return view.moveVertically(range,forward,pageHeight(view));});}/**
Move the selection head one page up.
*/var selectPageUp=function selectPageUp(view){return selectByPage(view,false);};/**
Move the selection head one page down.
*/var selectPageDown=function selectPageDown(view){return selectByPage(view,true);};/**
Move the selection head to the next line boundary.
*/var selectLineBoundaryForward=function selectLineBoundaryForward(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,true);});};/**
Move the selection head to the previous line boundary.
*/var selectLineBoundaryBackward=function selectLineBoundaryBackward(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,false);});};/**
Move the selection head one line boundary to the left.
*/var selectLineBoundaryLeft=function selectLineBoundaryLeft(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,!ltrAtCursor(view));});};/**
Move the selection head one line boundary to the right.
*/var selectLineBoundaryRight=function selectLineBoundaryRight(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,ltrAtCursor(view));});};/**
Move the selection head to the start of the line.
*/var selectLineStart=function selectLineStart(view){return extendSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).from);});};/**
Move the selection head to the end of the line.
*/var selectLineEnd=function selectLineEnd(view){return extendSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).to);});};/**
Move the selection to the start of the document.
*/var cursorDocStart=function cursorDocStart(_ref59){var state=_ref59.state,dispatch=_ref59.dispatch;dispatch(setSel(state,{anchor:0}));return true;};/**
Move the selection to the end of the document.
*/var cursorDocEnd=function cursorDocEnd(_ref60){var state=_ref60.state,dispatch=_ref60.dispatch;dispatch(setSel(state,{anchor:state.doc.length}));return true;};/**
Move the selection head to the start of the document.
*/var selectDocStart=function selectDocStart(_ref61){var state=_ref61.state,dispatch=_ref61.dispatch;dispatch(setSel(state,{anchor:state.selection.main.anchor,head:0}));return true;};/**
Move the selection head to the end of the document.
*/var selectDocEnd=function selectDocEnd(_ref62){var state=_ref62.state,dispatch=_ref62.dispatch;dispatch(setSel(state,{anchor:state.selection.main.anchor,head:state.doc.length}));return true;};/**
Select the entire document.
*/var selectAll$1=function selectAll$1(_ref63){var state=_ref63.state,dispatch=_ref63.dispatch;dispatch(state.update({selection:{anchor:0,head:state.doc.length},userEvent:"select"}));return true;};/**
Expand the selection to cover entire lines.
*/var selectLine=function selectLine(_ref64){var state=_ref64.state,dispatch=_ref64.dispatch;var ranges=selectedLineBlocks(state).map(function(_ref65){var from=_ref65.from,to=_ref65.to;return EditorSelection.range(from,Math.min(to+1,state.doc.length));});dispatch(state.update({selection:EditorSelection.create(ranges),userEvent:"select"}));return true;};/**
Select the next syntactic construct that is larger than the
selection. Note that this will only work insofar as the language
[provider](https://codemirror.net/6/docs/ref/#language.language) you use builds up a full
syntax tree.
*/var selectParentSyntax=function selectParentSyntax(_ref66){var state=_ref66.state,dispatch=_ref66.dispatch;var selection=updateSel(state.selection,function(range){var _a;var context=syntaxTree(state).resolveInner(range.head,1);while(!(context.from<range.from&&context.to>=range.to||context.to>range.to&&context.from<=range.from||!((_a=context.parent)===null||_a===void 0?void 0:_a.parent))){context=context.parent;}return EditorSelection.range(context.to,context.from);});dispatch(setSel(state,selection));return true;};/**
Simplify the current selection. When multiple ranges are selected,
reduce it to its main range. Otherwise, if the selection is
non-empty, convert it to a cursor selection.
*/var simplifySelection=function simplifySelection(_ref67){var state=_ref67.state,dispatch=_ref67.dispatch;var cur=state.selection,selection=null;if(cur.ranges.length>1)selection=EditorSelection.create([cur.main]);else if(!cur.main.empty)selection=EditorSelection.create([EditorSelection.cursor(cur.main.head)]);if(!selection)return false;dispatch(setSel(state,selection));return true;};function deleteBy(target,by){if(target.state.readOnly)return false;var event="delete.selection",state=target.state;var changes=state.changeByRange(function(range){var from=range.from,to=range.to;if(from==to){var towards=by(from);if(towards<from){event="delete.backward";towards=skipAtomic(target,towards,false);}else if(towards>from){event="delete.forward";towards=skipAtomic(target,towards,true);}from=Math.min(from,towards);to=Math.max(to,towards);}else{from=skipAtomic(target,from,false);to=skipAtomic(target,from,true);}return from==to?{range:range}:{changes:{from:from,to:to},range:EditorSelection.cursor(from)};});if(changes.changes.empty)return false;target.dispatch(state.update(changes,{scrollIntoView:true,userEvent:event,effects:event=="delete.selection"?EditorView.announce.of(state.phrase("Selection deleted")):undefined}));return true;}function skipAtomic(target,pos,forward){if(target instanceof EditorView){var _iterator171=_createForOfIteratorHelper(target.state.facet(EditorView.atomicRanges).map(function(f){return f(target);})),_step171;try{for(_iterator171.s();!(_step171=_iterator171.n()).done;){var ranges=_step171.value;ranges.between(pos,pos,function(from,to){if(from<pos&&to>pos)pos=forward?to:from;});}}catch(err){_iterator171.e(err);}finally{_iterator171.f();}}return pos;}var deleteByChar=function deleteByChar(target,forward){return deleteBy(target,function(pos){var state=target.state,line=state.doc.lineAt(pos),before,targetPos;if(!forward&&pos>line.from&&pos<line.from+200&&!/[^ \t]/.test(before=line.text.slice(0,pos-line.from))){if(before[before.length-1]=="\t")return pos-1;var col=_countColumn(before,state.tabSize),_drop=col%getIndentUnit(state)||getIndentUnit(state);for(var _i185=0;_i185<_drop&&before[before.length-1-_i185]==" ";_i185++){pos--;}targetPos=pos;}else{targetPos=findClusterBreak(line.text,pos-line.from,forward,forward)+line.from;if(targetPos==pos&&line.number!=(forward?state.doc.lines:1))targetPos+=forward?1:-1;}return targetPos;});};/**
Delete the selection, or, for cursor selections, the character
before the cursor.
*/var deleteCharBackward=function deleteCharBackward(view){return deleteByChar(view,false);};/**
Delete the selection or the character after the cursor.
*/var deleteCharForward=function deleteCharForward(view){return deleteByChar(view,true);};var deleteByGroup=function deleteByGroup(target,forward){return deleteBy(target,function(start){var pos=start,state=target.state,line=state.doc.lineAt(pos);var categorize=state.charCategorizer(pos);for(var cat=null;;){if(pos==(forward?line.to:line.from)){if(pos==start&&line.number!=(forward?state.doc.lines:1))pos+=forward?1:-1;break;}var next=findClusterBreak(line.text,pos-line.from,forward)+line.from;var _nextChar=line.text.slice(Math.min(pos,next)-line.from,Math.max(pos,next)-line.from);var nextCat=categorize(_nextChar);if(cat!=null&&nextCat!=cat)break;if(_nextChar!=" "||pos!=start)cat=nextCat;pos=next;}return pos;});};/**
Delete the selection or backward until the end of the next
[group](https://codemirror.net/6/docs/ref/#view.EditorView.moveByGroup), only skipping groups of
whitespace when they consist of a single space.
*/var deleteGroupBackward=function deleteGroupBackward(target){return deleteByGroup(target,false);};/**
Delete the selection or forward until the end of the next group.
*/var deleteGroupForward=function deleteGroupForward(target){return deleteByGroup(target,true);};/**
Delete the selection, or, if it is a cursor selection, delete to
the end of the line. If the cursor is directly at the end of the
line, delete the line break after it.
*/var deleteToLineEnd=function deleteToLineEnd(view){return deleteBy(view,function(pos){var lineEnd=view.lineBlockAt(pos).to;return pos<lineEnd?lineEnd:Math.min(view.state.doc.length,pos+1);});};/**
Delete the selection, or, if it is a cursor selection, delete to
the start of the line. If the cursor is directly at the start of the
line, delete the line break before it.
*/var deleteToLineStart=function deleteToLineStart(view){return deleteBy(view,function(pos){var lineStart=view.lineBlockAt(pos).from;return pos>lineStart?lineStart:Math.max(0,pos-1);});};/**
Replace each selection range with a line break, leaving the cursor
on the line before the break.
*/var splitLine=function splitLine(_ref68){var state=_ref68.state,dispatch=_ref68.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){return{changes:{from:range.from,to:range.to,insert:Text.of(["",""])},range:EditorSelection.cursor(range.from)};});dispatch(state.update(changes,{scrollIntoView:true,userEvent:"input"}));return true;};/**
Flip the characters before and after the cursor(s).
*/var transposeChars=function transposeChars(_ref69){var state=_ref69.state,dispatch=_ref69.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){if(!range.empty||range.from==0||range.from==state.doc.length)return{range:range};var pos=range.from,line=state.doc.lineAt(pos);var from=pos==line.from?pos-1:findClusterBreak(line.text,pos-line.from,false)+line.from;var to=pos==line.to?pos+1:findClusterBreak(line.text,pos-line.from,true)+line.from;return{changes:{from:from,to:to,insert:state.doc.slice(pos,to).append(state.doc.slice(from,pos))},range:EditorSelection.cursor(to)};});if(changes.changes.empty)return false;dispatch(state.update(changes,{scrollIntoView:true,userEvent:"move.character"}));return true;};function selectedLineBlocks(state){var blocks=[],upto=-1;var _iterator172=_createForOfIteratorHelper(state.selection.ranges),_step172;try{for(_iterator172.s();!(_step172=_iterator172.n()).done;){var _range15=_step172.value;var startLine=state.doc.lineAt(_range15.from),endLine=state.doc.lineAt(_range15.to);if(!_range15.empty&&_range15.to==endLine.from)endLine=state.doc.lineAt(_range15.to-1);if(upto>=startLine.number){var prev=blocks[blocks.length-1];prev.to=endLine.to;prev.ranges.push(_range15);}else{blocks.push({from:startLine.from,to:endLine.to,ranges:[_range15]});}upto=endLine.number+1;}}catch(err){_iterator172.e(err);}finally{_iterator172.f();}return blocks;}function moveLine(state,dispatch,forward){if(state.readOnly)return false;var changes=[],ranges=[];var _iterator173=_createForOfIteratorHelper(selectedLineBlocks(state)),_step173;try{for(_iterator173.s();!(_step173=_iterator173.n()).done;){var block=_step173.value;if(forward?block.to==state.doc.length:block.from==0)continue;var nextLine=state.doc.lineAt(forward?block.to+1:block.from-1);var _size7=nextLine.length+1;if(forward){changes.push({from:block.to,to:nextLine.to},{from:block.from,insert:nextLine.text+state.lineBreak});var _iterator174=_createForOfIteratorHelper(block.ranges),_step174;try{for(_iterator174.s();!(_step174=_iterator174.n()).done;){var _r12=_step174.value;ranges.push(EditorSelection.range(Math.min(state.doc.length,_r12.anchor+_size7),Math.min(state.doc.length,_r12.head+_size7)));}}catch(err){_iterator174.e(err);}finally{_iterator174.f();}}else{changes.push({from:nextLine.from,to:block.from},{from:block.to,insert:state.lineBreak+nextLine.text});var _iterator175=_createForOfIteratorHelper(block.ranges),_step175;try{for(_iterator175.s();!(_step175=_iterator175.n()).done;){var _r13=_step175.value;ranges.push(EditorSelection.range(_r13.anchor-_size7,_r13.head-_size7));}}catch(err){_iterator175.e(err);}finally{_iterator175.f();}}}}catch(err){_iterator173.e(err);}finally{_iterator173.f();}if(!changes.length)return false;dispatch(state.update({changes:changes,scrollIntoView:true,selection:EditorSelection.create(ranges,state.selection.mainIndex),userEvent:"move.line"}));return true;}/**
Move the selected lines up one line.
*/var moveLineUp=function moveLineUp(_ref70){var state=_ref70.state,dispatch=_ref70.dispatch;return moveLine(state,dispatch,false);};/**
Move the selected lines down one line.
*/var moveLineDown=function moveLineDown(_ref71){var state=_ref71.state,dispatch=_ref71.dispatch;return moveLine(state,dispatch,true);};function copyLine(state,dispatch,forward){if(state.readOnly)return false;var changes=[];var _iterator176=_createForOfIteratorHelper(selectedLineBlocks(state)),_step176;try{for(_iterator176.s();!(_step176=_iterator176.n()).done;){var block=_step176.value;if(forward)changes.push({from:block.from,insert:state.doc.slice(block.from,block.to)+state.lineBreak});else changes.push({from:block.to,insert:state.lineBreak+state.doc.slice(block.from,block.to)});}}catch(err){_iterator176.e(err);}finally{_iterator176.f();}dispatch(state.update({changes:changes,scrollIntoView:true,userEvent:"input.copyline"}));return true;}/**
Create a copy of the selected lines. Keep the selection in the top copy.
*/var copyLineUp=function copyLineUp(_ref72){var state=_ref72.state,dispatch=_ref72.dispatch;return copyLine(state,dispatch,false);};/**
Create a copy of the selected lines. Keep the selection in the bottom copy.
*/var copyLineDown=function copyLineDown(_ref73){var state=_ref73.state,dispatch=_ref73.dispatch;return copyLine(state,dispatch,true);};/**
Delete selected lines.
*/var deleteLine=function deleteLine(view){if(view.state.readOnly)return false;var state=view.state,changes=state.changes(selectedLineBlocks(state).map(function(_ref74){var from=_ref74.from,to=_ref74.to;if(from>0)from--;else if(to<state.doc.length)to++;return{from:from,to:to};}));var selection=updateSel(state.selection,function(range){return view.moveVertically(range,true);}).map(changes);view.dispatch({changes:changes,selection:selection,scrollIntoView:true,userEvent:"delete.line"});return true;};function isBetweenBrackets(state,pos){if(/\(\)|\[\]|\{\}/.test(state.sliceDoc(pos-1,pos+1)))return{from:pos,to:pos};var context=syntaxTree(state).resolveInner(pos);var before=context.childBefore(pos),after=context.childAfter(pos),closedBy;if(before&&after&&before.to<=pos&&after.from>=pos&&(closedBy=before.type.prop(NodeProp.closedBy))&&closedBy.indexOf(after.name)>-1&&state.doc.lineAt(before.to).from==state.doc.lineAt(after.from).from)return{from:before.to,to:after.from};return null;}/**
Replace the selection with a newline and indent the newly created
line(s). If the current line consists only of whitespace, this
will also delete that whitespace. When the cursor is between
matching brackets, an additional newline will be inserted after
the cursor.
*/var insertNewlineAndIndent=/*@__PURE__*/newlineAndIndent(false);/**
Create a blank, indented line below the current line.
*/var insertBlankLine=/*@__PURE__*/newlineAndIndent(true);function newlineAndIndent(atEof){return function(_ref75){var state=_ref75.state,dispatch=_ref75.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){var from=range.from,to=range.to,line=state.doc.lineAt(from);var explode=!atEof&&from==to&&isBetweenBrackets(state,from);if(atEof)from=to=(to<=line.to?line:state.doc.lineAt(to)).to;var cx=new IndentContext(state,{simulateBreak:from,simulateDoubleBreak:!!explode});var indent=getIndentation(cx,from);if(indent==null)indent=/^\s*/.exec(state.doc.lineAt(from).text)[0].length;while(to<line.to&&/\s/.test(line.text[to-line.from])){to++;}if(explode){from=explode.from;to=explode.to;}else if(from>line.from&&from<line.from+100&&!/\S/.test(line.text.slice(0,from)))from=line.from;var insert=["",indentString(state,indent)];if(explode)insert.push(indentString(state,cx.lineIndent(line.from,-1)));return{changes:{from:from,to:to,insert:Text.of(insert)},range:EditorSelection.cursor(from+1+insert[1].length)};});dispatch(state.update(changes,{scrollIntoView:true,userEvent:"input"}));return true;};}function changeBySelectedLine(state,f){var atLine=-1;return state.changeByRange(function(range){var changes=[];for(var pos=range.from;pos<=range.to;){var line=state.doc.lineAt(pos);if(line.number>atLine&&(range.empty||range.to>line.from)){f(line,changes,range);atLine=line.number;}pos=line.to+1;}var changeSet=state.changes(changes);return{changes:changes,range:EditorSelection.range(changeSet.mapPos(range.anchor,1),changeSet.mapPos(range.head,1))};});}/**
Auto-indent the selected lines. This uses the [indentation service
facet](https://codemirror.net/6/docs/ref/#language.indentService) as source for auto-indent
information.
*/var indentSelection=function indentSelection(_ref76){var state=_ref76.state,dispatch=_ref76.dispatch;if(state.readOnly)return false;var updated=Object.create(null);var context=new IndentContext(state,{overrideIndentation:function overrideIndentation(start){var found=updated[start];return found==null?-1:found;}});var changes=changeBySelectedLine(state,function(line,changes,range){var indent=getIndentation(context,line.from);if(indent==null)return;if(!/\S/.test(line.text))indent=0;var cur=/^\s*/.exec(line.text)[0];var norm=indentString(state,indent);if(cur!=norm||range.from<line.from+cur.length){updated[line.from]=indent;changes.push({from:line.from,to:line.from+cur.length,insert:norm});}});if(!changes.changes.empty)dispatch(state.update(changes,{userEvent:"indent"}));return true;};/**
Add a [unit](https://codemirror.net/6/docs/ref/#language.indentUnit) of indentation to all selected
lines.
*/var indentMore=function indentMore(_ref77){var state=_ref77.state,dispatch=_ref77.dispatch;if(state.readOnly)return false;dispatch(state.update(changeBySelectedLine(state,function(line,changes){changes.push({from:line.from,insert:state.facet(indentUnit)});}),{userEvent:"input.indent"}));return true;};/**
Remove a [unit](https://codemirror.net/6/docs/ref/#language.indentUnit) of indentation from all
selected lines.
*/var indentLess=function indentLess(_ref78){var state=_ref78.state,dispatch=_ref78.dispatch;if(state.readOnly)return false;dispatch(state.update(changeBySelectedLine(state,function(line,changes){var space=/^\s*/.exec(line.text)[0];if(!space)return;var col=_countColumn(space,state.tabSize),keep=0;var insert=indentString(state,Math.max(0,col-getIndentUnit(state)));while(keep<space.length&&keep<insert.length&&space.charCodeAt(keep)==insert.charCodeAt(keep)){keep++;}changes.push({from:line.from+keep,to:line.from+space.length,insert:insert.slice(keep)});}),{userEvent:"delete.dedent"}));return true;};/**
Array of key bindings containing the Emacs-style bindings that are
available on macOS by default.

 - Ctrl-b: [`cursorCharLeft`](https://codemirror.net/6/docs/ref/#commands.cursorCharLeft) ([`selectCharLeft`](https://codemirror.net/6/docs/ref/#commands.selectCharLeft) with Shift)
 - Ctrl-f: [`cursorCharRight`](https://codemirror.net/6/docs/ref/#commands.cursorCharRight) ([`selectCharRight`](https://codemirror.net/6/docs/ref/#commands.selectCharRight) with Shift)
 - Ctrl-p: [`cursorLineUp`](https://codemirror.net/6/docs/ref/#commands.cursorLineUp) ([`selectLineUp`](https://codemirror.net/6/docs/ref/#commands.selectLineUp) with Shift)
 - Ctrl-n: [`cursorLineDown`](https://codemirror.net/6/docs/ref/#commands.cursorLineDown) ([`selectLineDown`](https://codemirror.net/6/docs/ref/#commands.selectLineDown) with Shift)
 - Ctrl-a: [`cursorLineStart`](https://codemirror.net/6/docs/ref/#commands.cursorLineStart) ([`selectLineStart`](https://codemirror.net/6/docs/ref/#commands.selectLineStart) with Shift)
 - Ctrl-e: [`cursorLineEnd`](https://codemirror.net/6/docs/ref/#commands.cursorLineEnd) ([`selectLineEnd`](https://codemirror.net/6/docs/ref/#commands.selectLineEnd) with Shift)
 - Ctrl-d: [`deleteCharForward`](https://codemirror.net/6/docs/ref/#commands.deleteCharForward)
 - Ctrl-h: [`deleteCharBackward`](https://codemirror.net/6/docs/ref/#commands.deleteCharBackward)
 - Ctrl-k: [`deleteToLineEnd`](https://codemirror.net/6/docs/ref/#commands.deleteToLineEnd)
 - Ctrl-Alt-h: [`deleteGroupBackward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupBackward)
 - Ctrl-o: [`splitLine`](https://codemirror.net/6/docs/ref/#commands.splitLine)
 - Ctrl-t: [`transposeChars`](https://codemirror.net/6/docs/ref/#commands.transposeChars)
 - Ctrl-v: [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown)
 - Alt-v: [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp)
*/var emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:true},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}];/**
An array of key bindings closely sticking to platform-standard or
widely used bindings. (This includes the bindings from
[`emacsStyleKeymap`](https://codemirror.net/6/docs/ref/#commands.emacsStyleKeymap), with their `key`
property changed to `mac`.)

 - ArrowLeft: [`cursorCharLeft`](https://codemirror.net/6/docs/ref/#commands.cursorCharLeft) ([`selectCharLeft`](https://codemirror.net/6/docs/ref/#commands.selectCharLeft) with Shift)
 - ArrowRight: [`cursorCharRight`](https://codemirror.net/6/docs/ref/#commands.cursorCharRight) ([`selectCharRight`](https://codemirror.net/6/docs/ref/#commands.selectCharRight) with Shift)
 - Ctrl-ArrowLeft (Alt-ArrowLeft on macOS): [`cursorGroupLeft`](https://codemirror.net/6/docs/ref/#commands.cursorGroupLeft) ([`selectGroupLeft`](https://codemirror.net/6/docs/ref/#commands.selectGroupLeft) with Shift)
 - Ctrl-ArrowRight (Alt-ArrowRight on macOS): [`cursorGroupRight`](https://codemirror.net/6/docs/ref/#commands.cursorGroupRight) ([`selectGroupRight`](https://codemirror.net/6/docs/ref/#commands.selectGroupRight) with Shift)
 - Cmd-ArrowLeft (on macOS): [`cursorLineStart`](https://codemirror.net/6/docs/ref/#commands.cursorLineStart) ([`selectLineStart`](https://codemirror.net/6/docs/ref/#commands.selectLineStart) with Shift)
 - Cmd-ArrowRight (on macOS): [`cursorLineEnd`](https://codemirror.net/6/docs/ref/#commands.cursorLineEnd) ([`selectLineEnd`](https://codemirror.net/6/docs/ref/#commands.selectLineEnd) with Shift)
 - ArrowUp: [`cursorLineUp`](https://codemirror.net/6/docs/ref/#commands.cursorLineUp) ([`selectLineUp`](https://codemirror.net/6/docs/ref/#commands.selectLineUp) with Shift)
 - ArrowDown: [`cursorLineDown`](https://codemirror.net/6/docs/ref/#commands.cursorLineDown) ([`selectLineDown`](https://codemirror.net/6/docs/ref/#commands.selectLineDown) with Shift)
 - Cmd-ArrowUp (on macOS): [`cursorDocStart`](https://codemirror.net/6/docs/ref/#commands.cursorDocStart) ([`selectDocStart`](https://codemirror.net/6/docs/ref/#commands.selectDocStart) with Shift)
 - Cmd-ArrowDown (on macOS): [`cursorDocEnd`](https://codemirror.net/6/docs/ref/#commands.cursorDocEnd) ([`selectDocEnd`](https://codemirror.net/6/docs/ref/#commands.selectDocEnd) with Shift)
 - Ctrl-ArrowUp (on macOS): [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp) ([`selectPageUp`](https://codemirror.net/6/docs/ref/#commands.selectPageUp) with Shift)
 - Ctrl-ArrowDown (on macOS): [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown) ([`selectPageDown`](https://codemirror.net/6/docs/ref/#commands.selectPageDown) with Shift)
 - PageUp: [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp) ([`selectPageUp`](https://codemirror.net/6/docs/ref/#commands.selectPageUp) with Shift)
 - PageDown: [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown) ([`selectPageDown`](https://codemirror.net/6/docs/ref/#commands.selectPageDown) with Shift)
 - Home: [`cursorLineBoundaryBackward`](https://codemirror.net/6/docs/ref/#commands.cursorLineBoundaryBackward) ([`selectLineBoundaryBackward`](https://codemirror.net/6/docs/ref/#commands.selectLineBoundaryBackward) with Shift)
 - End: [`cursorLineBoundaryForward`](https://codemirror.net/6/docs/ref/#commands.cursorLineBoundaryForward) ([`selectLineBoundaryForward`](https://codemirror.net/6/docs/ref/#commands.selectLineBoundaryForward) with Shift)
 - Ctrl-Home (Cmd-Home on macOS): [`cursorDocStart`](https://codemirror.net/6/docs/ref/#commands.cursorDocStart) ([`selectDocStart`](https://codemirror.net/6/docs/ref/#commands.selectDocStart) with Shift)
 - Ctrl-End (Cmd-Home on macOS): [`cursorDocEnd`](https://codemirror.net/6/docs/ref/#commands.cursorDocEnd) ([`selectDocEnd`](https://codemirror.net/6/docs/ref/#commands.selectDocEnd) with Shift)
 - Enter: [`insertNewlineAndIndent`](https://codemirror.net/6/docs/ref/#commands.insertNewlineAndIndent)
 - Ctrl-a (Cmd-a on macOS): [`selectAll`](https://codemirror.net/6/docs/ref/#commands.selectAll)
 - Backspace: [`deleteCharBackward`](https://codemirror.net/6/docs/ref/#commands.deleteCharBackward)
 - Delete: [`deleteCharForward`](https://codemirror.net/6/docs/ref/#commands.deleteCharForward)
 - Ctrl-Backspace (Alt-Backspace on macOS): [`deleteGroupBackward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupBackward)
 - Ctrl-Delete (Alt-Delete on macOS): [`deleteGroupForward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupForward)
 - Cmd-Backspace (macOS): [`deleteToLineStart`](https://codemirror.net/6/docs/ref/#commands.deleteToLineStart).
 - Cmd-Delete (macOS): [`deleteToLineEnd`](https://codemirror.net/6/docs/ref/#commands.deleteToLineEnd).
*/var standardKeymap=/*@__PURE__*/[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:true},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:true},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:true},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:true},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:true},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:true},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:true},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:true},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:true},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:true},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll$1},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd}].concat(/*@__PURE__*/emacsStyleKeymap.map(function(b){return{mac:b.key,run:b.run,shift:b.shift};}));/**
The default keymap. Includes all bindings from
[`standardKeymap`](https://codemirror.net/6/docs/ref/#commands.standardKeymap) plus the following:

- Alt-ArrowLeft (Ctrl-ArrowLeft on macOS): [`cursorSyntaxLeft`](https://codemirror.net/6/docs/ref/#commands.cursorSyntaxLeft) ([`selectSyntaxLeft`](https://codemirror.net/6/docs/ref/#commands.selectSyntaxLeft) with Shift)
- Alt-ArrowRight (Ctrl-ArrowRight on macOS): [`cursorSyntaxRight`](https://codemirror.net/6/docs/ref/#commands.cursorSyntaxRight) ([`selectSyntaxRight`](https://codemirror.net/6/docs/ref/#commands.selectSyntaxRight) with Shift)
- Alt-ArrowUp: [`moveLineUp`](https://codemirror.net/6/docs/ref/#commands.moveLineUp)
- Alt-ArrowDown: [`moveLineDown`](https://codemirror.net/6/docs/ref/#commands.moveLineDown)
- Shift-Alt-ArrowUp: [`copyLineUp`](https://codemirror.net/6/docs/ref/#commands.copyLineUp)
- Shift-Alt-ArrowDown: [`copyLineDown`](https://codemirror.net/6/docs/ref/#commands.copyLineDown)
- Escape: [`simplifySelection`](https://codemirror.net/6/docs/ref/#commands.simplifySelection)
- Ctrl-Enter (Comd-Enter on macOS): [`insertBlankLine`](https://codemirror.net/6/docs/ref/#commands.insertBlankLine)
- Alt-l (Ctrl-l on macOS): [`selectLine`](https://codemirror.net/6/docs/ref/#commands.selectLine)
- Ctrl-i (Cmd-i on macOS): [`selectParentSyntax`](https://codemirror.net/6/docs/ref/#commands.selectParentSyntax)
- Ctrl-[ (Cmd-[ on macOS): [`indentLess`](https://codemirror.net/6/docs/ref/#commands.indentLess)
- Ctrl-] (Cmd-] on macOS): [`indentMore`](https://codemirror.net/6/docs/ref/#commands.indentMore)
- Ctrl-Alt-\\ (Cmd-Alt-\\ on macOS): [`indentSelection`](https://codemirror.net/6/docs/ref/#commands.indentSelection)
- Shift-Ctrl-k (Shift-Cmd-k on macOS): [`deleteLine`](https://codemirror.net/6/docs/ref/#commands.deleteLine)
- Shift-Ctrl-\\ (Shift-Cmd-\\ on macOS): [`cursorMatchingBracket`](https://codemirror.net/6/docs/ref/#commands.cursorMatchingBracket)
- Ctrl-/ (Cmd-/ on macOS): [`toggleComment`](https://codemirror.net/6/docs/ref/#commands.toggleComment).
- Shift-Alt-a: [`toggleBlockComment`](https://codemirror.net/6/docs/ref/#commands.toggleBlockComment).
*/var defaultKeymap=/*@__PURE__*/[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:true},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap);/**
A binding that binds Tab to [`indentMore`](https://codemirror.net/6/docs/ref/#commands.indentMore) and
Shift-Tab to [`indentLess`](https://codemirror.net/6/docs/ref/#commands.indentLess).
Please see the [Tab example](../../examples/tab/) before using
this.
*/var indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var elt=arguments[0];if(typeof elt=="string")elt=document.createElement(elt);var i=1,next=arguments[1];if(next&&_typeof2(next)=="object"&&next.nodeType==null&&!Array.isArray(next)){for(var name in next){if(Object.prototype.hasOwnProperty.call(next,name)){var value=next[name];if(typeof value=="string")elt.setAttribute(name,value);else if(value!=null)elt[name]=value;}}i++;}for(;i<arguments.length;i++){add(elt,arguments[i]);}return elt;}function add(elt,child){if(typeof child=="string"){elt.appendChild(document.createTextNode(child));}else if(child==null);else if(child.nodeType!=null){elt.appendChild(child);}else if(Array.isArray(child)){for(var i=0;i<child.length;i++){add(elt,child[i]);}}else{throw new RangeError("Unsupported child node: "+child);}}var basicNormalize=typeof String.prototype.normalize=="function"?function(x){return x.normalize("NFKD");}:function(x){return x;};/**
A search cursor provides an iterator over text matches in a
document.
*/var SearchCursor=/*#__PURE__*/function(){/**
    Create a text cursor. The query is the search string, `from` to
    `to` provides the region to search.
    
    When `normalize` is given, it will be called, on both the query
    string and the content it is matched against, before comparing.
    You can, for example, create a case-insensitive search by
    passing `s => s.toLowerCase()`.
    
    Text is always normalized with
    [`.normalize("NFKD")`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize)
    (when supported).
    */function SearchCursor(text,query){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3&&arguments[3]!==undefined?arguments[3]:text.length;var normalize=arguments.length>4?arguments[4]:undefined;var test=arguments.length>5?arguments[5]:undefined;_classCallCheck(this,SearchCursor);this.test=test;/**
        The current match (only holds a meaningful value after
        [`next`](https://codemirror.net/6/docs/ref/#search.SearchCursor.next) has been called and when
        `done` is false).
        */this.value={from:0,to:0};/**
        Whether the end of the iterated region has been reached.
        */this.done=false;this.matches=[];this.buffer="";this.bufferPos=0;this.iter=text.iterRange(from,to);this.bufferStart=from;this.normalize=normalize?function(x){return normalize(basicNormalize(x));}:basicNormalize;this.query=this.normalize(query);}_createClass(SearchCursor,[{key:"peek",value:function peek(){if(this.bufferPos==this.buffer.length){this.bufferStart+=this.buffer.length;this.iter.next();if(this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value;}return codePointAt(this.buffer,this.bufferPos);}/**
    Look for the next match. Updates the iterator's
    [`value`](https://codemirror.net/6/docs/ref/#search.SearchCursor.value) and
    [`done`](https://codemirror.net/6/docs/ref/#search.SearchCursor.done) properties. Should be called
    at least once before using the cursor.
    */},{key:"next",value:function next(){while(this.matches.length){this.matches.pop();}return this.nextOverlapping();}/**
    The `next` method will ignore matches that partially overlap a
    previous match. This method behaves like `next`, but includes
    such matches.
    */},{key:"nextOverlapping",value:function nextOverlapping(){for(;;){var next=this.peek();if(next<0){this.done=true;return this;}var str=fromCodePoint(next),start=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(next);var norm=this.normalize(str);for(var _i186=0,pos=start;;_i186++){var _code=norm.charCodeAt(_i186);var match=this.match(_code,pos);if(match){this.value=match;return this;}if(_i186==norm.length-1)break;if(pos==start&&_i186<str.length&&str.charCodeAt(_i186)==_code)pos++;}}}},{key:"match",value:function match(code,pos){var match=null;for(var _i187=0;_i187<this.matches.length;_i187+=2){var index=this.matches[_i187],keep=false;if(this.query.charCodeAt(index)==code){if(index==this.query.length-1){match={from:this.matches[_i187+1],to:pos+1};}else{this.matches[_i187]++;keep=true;}}if(!keep){this.matches.splice(_i187,2);_i187-=2;}}if(this.query.charCodeAt(0)==code){if(this.query.length==1)match={from:pos,to:pos+1};else this.matches.push(1,pos);}if(match&&this.test&&!this.test(match.from,match.to,this.buffer,this.bufferPos))match=null;return match;}}]);return SearchCursor;}();if(typeof Symbol!="undefined")SearchCursor.prototype[Symbol.iterator]=function(){return this;};var empty={from:-1,to:-1,match:/*@__PURE__*/ /.*/.exec("")};var baseFlags="gm"+(/x/.unicode==null?"":"u");/**
This class is similar to [`SearchCursor`](https://codemirror.net/6/docs/ref/#search.SearchCursor)
but searches for a regular expression pattern instead of a plain
string.
*/var RegExpCursor=/*#__PURE__*/function(){/**
    Create a cursor that will search the given range in the given
    document. `query` should be the raw pattern (as you'd pass it to
    `new RegExp`).
    */function RegExpCursor(text,query,options){var from=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var to=arguments.length>4&&arguments[4]!==undefined?arguments[4]:text.length;_classCallCheck(this,RegExpCursor);this.text=text;this.to=to;this.curLine="";/**
        Set to `true` when the cursor has reached the end of the search
        range.
        */this.done=false;/**
        Will contain an object with the extent of the match and the
        match object when [`next`](https://codemirror.net/6/docs/ref/#search.RegExpCursor.next)
        sucessfully finds a match.
        */this.value=empty;if(/\\[sWDnr]|\n|\r|\[\^/.test(query))return new MultilineRegExpCursor(text,query,options,from,to);this.re=new RegExp(query,baseFlags+((options===null||options===void 0?void 0:options.ignoreCase)?"i":""));this.test=options===null||options===void 0?void 0:options.test;this.iter=text.iter();var startLine=text.lineAt(from);this.curLineStart=startLine.from;this.matchPos=toCharEnd(text,from);this.getLine(this.curLineStart);}_createClass(RegExpCursor,[{key:"getLine",value:function getLine(skip){this.iter.next(skip);if(this.iter.lineBreak){this.curLine="";}else{this.curLine=this.iter.value;if(this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next();}}},{key:"nextLine",value:function nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;if(this.curLineStart>this.to)this.curLine="";else this.getLine(0);}/**
    Move to the next match, if there is one.
    */},{key:"next",value:function next(){for(var off=this.matchPos-this.curLineStart;;){this.re.lastIndex=off;var match=this.matchPos<=this.to&&this.re.exec(this.curLine);if(match){var from=this.curLineStart+match.index,to=from+match[0].length;this.matchPos=toCharEnd(this.text,to+(from==to?1:0));if(from==this.curLine.length)this.nextLine();if((from<to||from>this.value.to)&&(!this.test||this.test(from,to,match))){this.value={from:from,to:to,match:match};return this;}off=this.matchPos-this.curLineStart;}else if(this.curLineStart+this.curLine.length<this.to){this.nextLine();off=0;}else{this.done=true;return this;}}}}]);return RegExpCursor;}();var flattened=/*@__PURE__*/new WeakMap();// Reusable (partially) flattened document strings
var FlattenedDoc=/*#__PURE__*/function(){function FlattenedDoc(from,text){_classCallCheck(this,FlattenedDoc);this.from=from;this.text=text;}_createClass(FlattenedDoc,[{key:"to",get:function get(){return this.from+this.text.length;}}],[{key:"get",value:function get(doc,from,to){var cached=flattened.get(doc);if(!cached||cached.from>=to||cached.to<=from){var flat=new FlattenedDoc(from,doc.sliceString(from,to));flattened.set(doc,flat);return flat;}if(cached.from==from&&cached.to==to)return cached;var text=cached.text,cachedFrom=cached.from;if(cachedFrom>from){text=doc.sliceString(from,cachedFrom)+text;cachedFrom=from;}if(cached.to<to)text+=doc.sliceString(cached.to,to);flattened.set(doc,new FlattenedDoc(cachedFrom,text));return new FlattenedDoc(from,text.slice(from-cachedFrom,to-cachedFrom));}}]);return FlattenedDoc;}();var MultilineRegExpCursor=/*#__PURE__*/function(){function MultilineRegExpCursor(text,query,options,from,to){_classCallCheck(this,MultilineRegExpCursor);this.text=text;this.to=to;this.done=false;this.value=empty;this.matchPos=toCharEnd(text,from);this.re=new RegExp(query,baseFlags+((options===null||options===void 0?void 0:options.ignoreCase)?"i":""));this.test=options===null||options===void 0?void 0:options.test;this.flat=FlattenedDoc.get(text,from,this.chunkEnd(from+5000/* Chunk.Base */));}_createClass(MultilineRegExpCursor,[{key:"chunkEnd",value:function chunkEnd(pos){return pos>=this.to?this.to:this.text.lineAt(pos).to;}},{key:"next",value:function next(){for(;;){var off=this.re.lastIndex=this.matchPos-this.flat.from;var match=this.re.exec(this.flat.text);// Skip empty matches directly after the last match
if(match&&!match[0]&&match.index==off){this.re.lastIndex=off+1;match=this.re.exec(this.flat.text);}if(match){var from=this.flat.from+match.index,to=from+match[0].length;// If a match goes almost to the end of a noncomplete chunk, try
// again, since it'll likely be able to match more
if((this.flat.to>=this.to||match.index+match[0].length<=this.flat.text.length-10)&&(!this.test||this.test(from,to,match))){this.value={from:from,to:to,match:match};this.matchPos=toCharEnd(this.text,to+(from==to?1:0));return this;}}if(this.flat.to==this.to){this.done=true;return this;}// Grow the flattened doc
this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2));}}}]);return MultilineRegExpCursor;}();if(typeof Symbol!="undefined"){RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this;};}function validRegExp(source){try{new RegExp(source,baseFlags);return true;}catch(_a){return false;}}function toCharEnd(text,pos){if(pos>=text.length)return pos;var line=text.lineAt(pos),next;while(pos<line.to&&(next=line.text.charCodeAt(pos-line.from))>=0xDC00&&next<0xE000){pos++;}return pos;}function createLineDialog(view){var input=crelt("input",{"class":"cm-textfield",name:"line"});var dom=crelt("form",{"class":"cm-gotoLine",onkeydown:function onkeydown(event){if(event.keyCode==27){// Escape
event.preventDefault();view.dispatch({effects:dialogEffect.of(false)});view.focus();}else if(event.keyCode==13){// Enter
event.preventDefault();go();}},onsubmit:function onsubmit(event){event.preventDefault();go();}},crelt("label",view.state.phrase("Go to line"),": ",input)," ",crelt("button",{"class":"cm-button",type:"submit"},view.state.phrase("go")));function go(){var match=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(input.value);if(!match)return;var state=view.state,startLine=state.doc.lineAt(state.selection.main.head);var _match=_slicedToArray(match,5),sign=_match[1],ln=_match[2],cl=_match[3],percent=_match[4];var col=cl?+cl.slice(1):0;var line=ln?+ln:startLine.number;if(ln&&percent){var pc=line/100;if(sign)pc=pc*(sign=="-"?-1:1)+startLine.number/state.doc.lines;line=Math.round(state.doc.lines*pc);}else if(ln&&sign){line=line*(sign=="-"?-1:1)+startLine.number;}var docLine=state.doc.line(Math.max(1,Math.min(state.doc.lines,line)));view.dispatch({effects:dialogEffect.of(false),selection:EditorSelection.cursor(docLine.from+Math.max(0,Math.min(col,docLine.length))),scrollIntoView:true});view.focus();}return{dom:dom};}var dialogEffect=/*@__PURE__*/StateEffect.define();var dialogField=/*@__PURE__*/StateField.define({create:function create(){return true;},update:function update(value,tr){var _iterator177=_createForOfIteratorHelper(tr.effects),_step177;try{for(_iterator177.s();!(_step177=_iterator177.n()).done;){var e=_step177.value;if(e.is(dialogEffect))value=e.value;}}catch(err){_iterator177.e(err);}finally{_iterator177.f();}return value;},provide:function provide(f){return showPanel.from(f,function(val){return val?createLineDialog:null;});}});/**
Command that shows a dialog asking the user for a line number, and
when a valid position is provided, moves the cursor to that line.

Supports line numbers, relative line offsets prefixed with `+` or
`-`, document percentages suffixed with `%`, and an optional
column position by adding `:` and a second number after the line
number.

The dialog can be styled with the `panel.gotoLine` theme
selector.
*/var gotoLine=function gotoLine(view){var panel=getPanel(view,createLineDialog);if(!panel){var effects=[dialogEffect.of(true)];if(view.state.field(dialogField,false)==null)effects.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1]));view.dispatch({effects:effects});panel=getPanel(view,createLineDialog);}if(panel)panel.dom.querySelector("input").focus();return true;};var baseTheme$1$1=/*@__PURE__*/EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}});var defaultHighlightOptions={highlightWordAroundCursor:false,minSelectionLength:1,maxMatches:100,wholeWords:false};var highlightConfig=/*@__PURE__*/Facet.define({combine:function combine(options){return combineConfig(options,defaultHighlightOptions,{highlightWordAroundCursor:function highlightWordAroundCursor(a,b){return a||b;},minSelectionLength:Math.min,maxMatches:Math.min});}});/**
This extension highlights text that matches the selection. It uses
the `"cm-selectionMatch"` class for the highlighting. When
`highlightWordAroundCursor` is enabled, the word at the cursor
itself will be highlighted with `"cm-selectionMatch-main"`.
*/function highlightSelectionMatches(options){var ext=[defaultTheme,matchHighlighter];if(options)ext.push(highlightConfig.of(options));return ext;}var matchDeco=/*@__PURE__*/Decoration.mark({"class":"cm-selectionMatch"});var mainMatchDeco=/*@__PURE__*/Decoration.mark({"class":"cm-selectionMatch cm-selectionMatch-main"});// Whether the characters directly outside the given positions are non-word characters
function insideWordBoundaries(check,state,from,to){return(from==0||check(state.sliceDoc(from-1,from))!=CharCategory.Word)&&(to==state.doc.length||check(state.sliceDoc(to,to+1))!=CharCategory.Word);}// Whether the characters directly at the given positions are word characters
function insideWord(check,state,from,to){return check(state.sliceDoc(from,from+1))==CharCategory.Word&&check(state.sliceDoc(to-1,to))==CharCategory.Word;}var matchHighlighter=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class13(view){_classCallCheck(this,_class13);this.decorations=this.getDeco(view);}_createClass(_class13,[{key:"update",value:function update(_update22){if(_update22.selectionSet||_update22.docChanged||_update22.viewportChanged)this.decorations=this.getDeco(_update22.view);}},{key:"getDeco",value:function getDeco(view){var conf=view.state.facet(highlightConfig);var state=view.state,sel=state.selection;if(sel.ranges.length>1)return Decoration.none;var range=sel.main,query,check=null;if(range.empty){if(!conf.highlightWordAroundCursor)return Decoration.none;var word=state.wordAt(range.head);if(!word)return Decoration.none;check=state.charCategorizer(range.head);query=state.sliceDoc(word.from,word.to);}else{var len=range.to-range.from;if(len<conf.minSelectionLength||len>200)return Decoration.none;if(conf.wholeWords){query=state.sliceDoc(range.from,range.to);// TODO: allow and include leading/trailing space?
check=state.charCategorizer(range.head);if(!(insideWordBoundaries(check,state,range.from,range.to)&&insideWord(check,state,range.from,range.to)))return Decoration.none;}else{query=state.sliceDoc(range.from,range.to).trim();if(!query)return Decoration.none;}}var deco=[];var _iterator178=_createForOfIteratorHelper(view.visibleRanges),_step178;try{for(_iterator178.s();!(_step178=_iterator178.n()).done;){var part=_step178.value;var cursor=new SearchCursor(state.doc,query,part.from,part.to);while(!cursor.next().done){var _cursor$value=cursor.value,from=_cursor$value.from,to=_cursor$value.to;if(!check||insideWordBoundaries(check,state,from,to)){if(range.empty&&from<=range.from&&to>=range.to)deco.push(mainMatchDeco.range(from,to));else if(from>=range.to||to<=range.from)deco.push(matchDeco.range(from,to));if(deco.length>conf.maxMatches)return Decoration.none;}}}}catch(err){_iterator178.e(err);}finally{_iterator178.f();}return Decoration.set(deco);}}]);return _class13;}(),{decorations:function decorations(v){return v.decorations;}});var defaultTheme=/*@__PURE__*/EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});// Select the words around the cursors.
var selectWord=function selectWord(_ref79){var state=_ref79.state,dispatch=_ref79.dispatch;var selection=state.selection;var newSel=EditorSelection.create(selection.ranges.map(function(range){return state.wordAt(range.head)||EditorSelection.cursor(range.head);}),selection.mainIndex);if(newSel.eq(selection))return false;dispatch(state.update({selection:newSel}));return true;};// Find next occurrence of query relative to last cursor. Wrap around
// the document if there are no more matches.
function findNextOccurrence(state,query){var _state$selection=state.selection,main=_state$selection.main,ranges=_state$selection.ranges;var word=state.wordAt(main.head),fullWord=word&&word.from==main.from&&word.to==main.to;var _loop13=function _loop13(_cycled,_cursor){_cursor.next();if(_cursor.done){if(_cycled){cursor=_cursor;{cycled=_cycled;return{v:null};}}_cursor=new SearchCursor(state.doc,query,0,Math.max(0,ranges[ranges.length-1].from-1));_cycled=true;}else{if(_cycled&&ranges.some(function(r){return r.from==_cursor.value.from;})){cursor=_cursor;{cycled=_cycled;return"continue";}}if(fullWord){var _word=state.wordAt(_cursor.value.from);if(!_word||_word.from!=_cursor.value.from||_word.to!=_cursor.value.to){cursor=_cursor;{cycled=_cycled;return"continue";}}}cycled=_cycled;cursor=_cursor;return{v:_cursor.value};}cycled=_cycled;cursor=_cursor;};for(var cycled=false,cursor=new SearchCursor(state.doc,query,ranges[ranges.length-1].to);;){var _ret2=_loop13(cycled,cursor);if(_ret2==="continue")continue;if(_typeof2(_ret2)==="object")return _ret2.v;}}/**
Select next occurrence of the current selection. Expand selection
to the surrounding word when the selection is empty.
*/var selectNextOccurrence=function selectNextOccurrence(_ref80){var state=_ref80.state,dispatch=_ref80.dispatch;var ranges=state.selection.ranges;if(ranges.some(function(sel){return sel.from===sel.to;}))return selectWord({state:state,dispatch:dispatch});var searchedText=state.sliceDoc(ranges[0].from,ranges[0].to);if(state.selection.ranges.some(function(r){return state.sliceDoc(r.from,r.to)!=searchedText;}))return false;var range=findNextOccurrence(state,searchedText);if(!range)return false;dispatch(state.update({selection:state.selection.addRange(EditorSelection.range(range.from,range.to),false),effects:EditorView.scrollIntoView(range.to)}));return true;};var searchConfigFacet=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{top:false,caseSensitive:false,literal:false,wholeWord:false,createPanel:function createPanel(view){return new SearchPanel(view);}});}});/**
Add search state to the editor configuration, and optionally
configure the search extension.
([`openSearchPanel`](https://codemirror.net/6/docs/ref/#search.openSearchPanel) will automatically
enable this if it isn't already on).
*/function search$1(config){return config?[searchConfigFacet.of(config),searchExtensions]:searchExtensions;}/**
A search query. Part of the editor's search state.
*/var SearchQuery=/*#__PURE__*/function(){/**
    Create a query object.
    */function SearchQuery(config){_classCallCheck(this,SearchQuery);this.search=config.search;this.caseSensitive=!!config.caseSensitive;this.literal=!!config.literal;this.regexp=!!config.regexp;this.replace=config.replace||"";this.valid=!!this.search&&(!this.regexp||validRegExp(this.search));this.unquoted=this.literal?this.search:this.search.replace(/\\([nrt\\])/g,function(_,ch){return ch=="n"?"\n":ch=="r"?"\r":ch=="t"?"\t":"\\";});this.wholeWord=!!config.wholeWord;}/**
    Compare this query to another query.
    */_createClass(SearchQuery,[{key:"eq",value:function eq(other){return this.search==other.search&&this.replace==other.replace&&this.caseSensitive==other.caseSensitive&&this.regexp==other.regexp&&this.wholeWord==other.wholeWord;}/**
    @internal
    */},{key:"create",value:function create(){return this.regexp?new RegExpQuery(this):new StringQuery(this);}/**
    Get a search cursor for this query, searching through the given
    range in the given state.
    */},{key:"getCursor",value:function getCursor(state){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var to=arguments.length>2?arguments[2]:undefined;var st=state.doc?state:EditorState.create({doc:state});if(to==null)to=st.doc.length;return this.regexp?regexpCursor(this,st,from,to):stringCursor(this,st,from,to);}}]);return SearchQuery;}();var QueryType=/*#__PURE__*/_createClass(function QueryType(spec){_classCallCheck(this,QueryType);this.spec=spec;});function stringCursor(spec,state,from,to){return new SearchCursor(state.doc,spec.unquoted,from,to,spec.caseSensitive?undefined:function(x){return x.toLowerCase();},spec.wholeWord?stringWordTest(state.doc,state.charCategorizer(state.selection.main.head)):undefined);}function stringWordTest(doc,categorizer){return function(from,to,buf,bufPos){if(bufPos>from||bufPos+buf.length<to){bufPos=Math.max(0,from-2);buf=doc.sliceString(bufPos,Math.min(doc.length,to+2));}return(categorizer(charBefore(buf,from-bufPos))!=CharCategory.Word||categorizer(charAfter(buf,from-bufPos))!=CharCategory.Word)&&(categorizer(charAfter(buf,to-bufPos))!=CharCategory.Word||categorizer(charBefore(buf,to-bufPos))!=CharCategory.Word);};}var StringQuery=/*#__PURE__*/function(_QueryType){_inherits(StringQuery,_QueryType);var _super48=_createSuper(StringQuery);function StringQuery(spec){_classCallCheck(this,StringQuery);return _super48.call(this,spec);}_createClass(StringQuery,[{key:"nextMatch",value:function nextMatch(state,curFrom,curTo){var cursor=stringCursor(this.spec,state,curTo,state.doc.length).nextOverlapping();if(cursor.done)cursor=stringCursor(this.spec,state,0,curFrom).nextOverlapping();return cursor.done?null:cursor.value;}// Searching in reverse is, rather than implementing inverted search
// cursor, done by scanning chunk after chunk forward.
},{key:"prevMatchInRange",value:function prevMatchInRange(state,from,to){for(var pos=to;;){var start=Math.max(from,pos-10000/* FindPrev.ChunkSize */-this.spec.unquoted.length);var _cursor2=stringCursor(this.spec,state,start,pos),_range16=null;while(!_cursor2.nextOverlapping().done){_range16=_cursor2.value;}if(_range16)return _range16;if(start==from)return null;pos-=10000/* FindPrev.ChunkSize */;}}},{key:"prevMatch",value:function prevMatch(state,curFrom,curTo){return this.prevMatchInRange(state,0,curFrom)||this.prevMatchInRange(state,curTo,state.doc.length);}},{key:"getReplacement",value:function getReplacement(_result){return this.spec.replace;}},{key:"matchAll",value:function matchAll(state,limit){var cursor=stringCursor(this.spec,state,0,state.doc.length),ranges=[];while(!cursor.next().done){if(ranges.length>=limit)return null;ranges.push(cursor.value);}return ranges;}},{key:"highlight",value:function highlight(state,from,to,add){var cursor=stringCursor(this.spec,state,Math.max(0,from-this.spec.unquoted.length),Math.min(to+this.spec.unquoted.length,state.doc.length));while(!cursor.next().done){add(cursor.value.from,cursor.value.to);}}}]);return StringQuery;}(QueryType);function regexpCursor(spec,state,from,to){return new RegExpCursor(state.doc,spec.search,{ignoreCase:!spec.caseSensitive,test:spec.wholeWord?regexpWordTest(state.charCategorizer(state.selection.main.head)):undefined},from,to);}function charBefore(str,index){return str.slice(findClusterBreak(str,index,false),index);}function charAfter(str,index){return str.slice(index,findClusterBreak(str,index));}function regexpWordTest(categorizer){return function(_from,_to,match){return!match[0].length||(categorizer(charBefore(match.input,match.index))!=CharCategory.Word||categorizer(charAfter(match.input,match.index))!=CharCategory.Word)&&(categorizer(charAfter(match.input,match.index+match[0].length))!=CharCategory.Word||categorizer(charBefore(match.input,match.index+match[0].length))!=CharCategory.Word);};}var RegExpQuery=/*#__PURE__*/function(_QueryType2){_inherits(RegExpQuery,_QueryType2);var _super49=_createSuper(RegExpQuery);function RegExpQuery(){_classCallCheck(this,RegExpQuery);return _super49.apply(this,arguments);}_createClass(RegExpQuery,[{key:"nextMatch",value:function nextMatch(state,curFrom,curTo){var cursor=regexpCursor(this.spec,state,curTo,state.doc.length).next();if(cursor.done)cursor=regexpCursor(this.spec,state,0,curFrom).next();return cursor.done?null:cursor.value;}},{key:"prevMatchInRange",value:function prevMatchInRange(state,from,to){for(var _size8=1;;_size8++){var start=Math.max(from,to-_size8*10000/* FindPrev.ChunkSize */);var _cursor3=regexpCursor(this.spec,state,start,to),_range17=null;while(!_cursor3.next().done){_range17=_cursor3.value;}if(_range17&&(start==from||_range17.from>start+10))return _range17;if(start==from)return null;}}},{key:"prevMatch",value:function prevMatch(state,curFrom,curTo){return this.prevMatchInRange(state,0,curFrom)||this.prevMatchInRange(state,curTo,state.doc.length);}},{key:"getReplacement",value:function getReplacement(result){return this.spec.replace.replace(/\$([$&\d+])/g,function(m,i){return i=="$"?"$":i=="&"?result.match[0]:i!="0"&&+i<result.match.length?result.match[i]:m;});}},{key:"matchAll",value:function matchAll(state,limit){var cursor=regexpCursor(this.spec,state,0,state.doc.length),ranges=[];while(!cursor.next().done){if(ranges.length>=limit)return null;ranges.push(cursor.value);}return ranges;}},{key:"highlight",value:function highlight(state,from,to,add){var cursor=regexpCursor(this.spec,state,Math.max(0,from-250/* RegExp.HighlightMargin */),Math.min(to+250/* RegExp.HighlightMargin */,state.doc.length));while(!cursor.next().done){add(cursor.value.from,cursor.value.to);}}}]);return RegExpQuery;}(QueryType);/**
A state effect that updates the current search query. Note that
this only has an effect if the search state has been initialized
(by including [`search`](https://codemirror.net/6/docs/ref/#search.search) in your configuration or
by running [`openSearchPanel`](https://codemirror.net/6/docs/ref/#search.openSearchPanel) at least
once).
*/var setSearchQuery=/*@__PURE__*/StateEffect.define();var togglePanel$1=/*@__PURE__*/StateEffect.define();var searchState=/*@__PURE__*/StateField.define({create:function create(state){return new SearchState(defaultQuery(state).create(),null);},update:function update(value,tr){var _iterator179=_createForOfIteratorHelper(tr.effects),_step179;try{for(_iterator179.s();!(_step179=_iterator179.n()).done;){var effect=_step179.value;if(effect.is(setSearchQuery))value=new SearchState(effect.value.create(),value.panel);else if(effect.is(togglePanel$1))value=new SearchState(value.query,effect.value?createSearchPanel:null);}}catch(err){_iterator179.e(err);}finally{_iterator179.f();}return value;},provide:function provide(f){return showPanel.from(f,function(val){return val.panel;});}});var SearchState=/*#__PURE__*/_createClass(function SearchState(query,panel){_classCallCheck(this,SearchState);this.query=query;this.panel=panel;});var matchMark=/*@__PURE__*/Decoration.mark({"class":"cm-searchMatch"}),selectedMatchMark=/*@__PURE__*/Decoration.mark({"class":"cm-searchMatch cm-searchMatch-selected"});var searchHighlighter=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class14(view){_classCallCheck(this,_class14);this.view=view;this.decorations=this.highlight(view.state.field(searchState));}_createClass(_class14,[{key:"update",value:function update(_update23){var state=_update23.state.field(searchState);if(state!=_update23.startState.field(searchState)||_update23.docChanged||_update23.selectionSet||_update23.viewportChanged)this.decorations=this.highlight(state);}},{key:"highlight",value:function highlight(_ref81){var query=_ref81.query,panel=_ref81.panel;if(!panel||!query.spec.valid)return Decoration.none;var view=this.view;var builder=new RangeSetBuilder();for(var _i188=0,ranges=view.visibleRanges,_l3=ranges.length;_i188<_l3;_i188++){var _ranges$_i2=ranges[_i188],from=_ranges$_i2.from,to=_ranges$_i2.to;while(_i188<_l3-1&&to>ranges[_i188+1].from-2*250/* RegExp.HighlightMargin */){to=ranges[++_i188].to;}query.highlight(view.state,from,to,function(from,to){var selected=view.state.selection.ranges.some(function(r){return r.from==from&&r.to==to;});builder.add(from,to,selected?selectedMatchMark:matchMark);});}return builder.finish();}}]);return _class14;}(),{decorations:function decorations(v){return v.decorations;}});function searchCommand(f){return function(view){var state=view.state.field(searchState,false);return state&&state.query.spec.valid?f(view,state):openSearchPanel(view);};}/**
Open the search panel if it isn't already open, and move the
selection to the first match after the current main selection.
Will wrap around to the start of the document when it reaches the
end.
*/var findNext=/*@__PURE__*/searchCommand(function(view,_ref82){var query=_ref82.query;var to=view.state.selection.main.to;var next=query.nextMatch(view.state,to,to);if(!next)return false;view.dispatch({selection:{anchor:next.from,head:next.to},scrollIntoView:true,effects:announceMatch(view,next),userEvent:"select.search"});return true;});/**
Move the selection to the previous instance of the search query,
before the current main selection. Will wrap past the start
of the document to start searching at the end again.
*/var findPrevious=/*@__PURE__*/searchCommand(function(view,_ref83){var query=_ref83.query;var state=view.state,from=state.selection.main.from;var range=query.prevMatch(state,from,from);if(!range)return false;view.dispatch({selection:{anchor:range.from,head:range.to},scrollIntoView:true,effects:announceMatch(view,range),userEvent:"select.search"});return true;});/**
Select all instances of the search query.
*/var selectMatches=/*@__PURE__*/searchCommand(function(view,_ref84){var query=_ref84.query;var ranges=query.matchAll(view.state,1000);if(!ranges||!ranges.length)return false;view.dispatch({selection:EditorSelection.create(ranges.map(function(r){return EditorSelection.range(r.from,r.to);})),userEvent:"select.search.matches"});return true;});/**
Select all instances of the currently selected text.
*/var selectSelectionMatches=function selectSelectionMatches(_ref85){var state=_ref85.state,dispatch=_ref85.dispatch;var sel=state.selection;if(sel.ranges.length>1||sel.main.empty)return false;var _sel$main=sel.main,from=_sel$main.from,to=_sel$main.to;var ranges=[],main=0;for(var _cur19=new SearchCursor(state.doc,state.sliceDoc(from,to));!_cur19.next().done;){if(ranges.length>1000)return false;if(_cur19.value.from==from)main=ranges.length;ranges.push(EditorSelection.range(_cur19.value.from,_cur19.value.to));}dispatch(state.update({selection:EditorSelection.create(ranges,main),userEvent:"select.search.matches"}));return true;};/**
Replace the current match of the search query.
*/var replaceNext=/*@__PURE__*/searchCommand(function(view,_ref86){var query=_ref86.query;var state=view.state,_state$selection$main=state.selection.main,from=_state$selection$main.from,to=_state$selection$main.to;if(state.readOnly)return false;var next=query.nextMatch(state,from,from);if(!next)return false;var changes=[],selection,replacement;var announce=[];if(next.from==from&&next.to==to){replacement=state.toText(query.getReplacement(next));changes.push({from:next.from,to:next.to,insert:replacement});next=query.nextMatch(state,next.from,next.to);announce.push(EditorView.announce.of(state.phrase("replaced match on line $",state.doc.lineAt(from).number)+"."));}if(next){var off=changes.length==0||changes[0].from>=next.to?0:next.to-next.from-replacement.length;selection={anchor:next.from-off,head:next.to-off};announce.push(announceMatch(view,next));}view.dispatch({changes:changes,selection:selection,scrollIntoView:!!selection,effects:announce,userEvent:"input.replace"});return true;});/**
Replace all instances of the search query with the given
replacement.
*/var replaceAll=/*@__PURE__*/searchCommand(function(view,_ref87){var query=_ref87.query;if(view.state.readOnly)return false;var changes=query.matchAll(view.state,1e9).map(function(match){var from=match.from,to=match.to;return{from:from,to:to,insert:query.getReplacement(match)};});if(!changes.length)return false;var announceText=view.state.phrase("replaced $ matches",changes.length)+".";view.dispatch({changes:changes,effects:EditorView.announce.of(announceText),userEvent:"input.replace.all"});return true;});function createSearchPanel(view){return view.state.facet(searchConfigFacet).createPanel(view);}function defaultQuery(state,fallback){var _a,_b,_c,_d;var sel=state.selection.main;var selText=sel.empty||sel.to>sel.from+100?"":state.sliceDoc(sel.from,sel.to);if(fallback&&!selText)return fallback;var config=state.facet(searchConfigFacet);return new SearchQuery({search:((_a=fallback===null||fallback===void 0?void 0:fallback.literal)!==null&&_a!==void 0?_a:config.literal)?selText:selText.replace(/\n/g,"\\n"),caseSensitive:(_b=fallback===null||fallback===void 0?void 0:fallback.caseSensitive)!==null&&_b!==void 0?_b:config.caseSensitive,literal:(_c=fallback===null||fallback===void 0?void 0:fallback.literal)!==null&&_c!==void 0?_c:config.literal,wholeWord:(_d=fallback===null||fallback===void 0?void 0:fallback.wholeWord)!==null&&_d!==void 0?_d:config.wholeWord});}/**
Make sure the search panel is open and focused.
*/var openSearchPanel=function openSearchPanel(view){var state=view.state.field(searchState,false);if(state&&state.panel){var panel=getPanel(view,createSearchPanel);if(!panel)return false;var searchInput=panel.dom.querySelector("[main-field]");if(searchInput&&searchInput!=view.root.activeElement){var query=defaultQuery(view.state,state.query.spec);if(query.valid)view.dispatch({effects:setSearchQuery.of(query)});searchInput.focus();searchInput.select();}}else{view.dispatch({effects:[togglePanel$1.of(true),state?setSearchQuery.of(defaultQuery(view.state,state.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});}return true;};/**
Close the search panel.
*/var closeSearchPanel=function closeSearchPanel(view){var state=view.state.field(searchState,false);if(!state||!state.panel)return false;var panel=getPanel(view,createSearchPanel);if(panel&&panel.dom.contains(view.root.activeElement))view.focus();view.dispatch({effects:togglePanel$1.of(false)});return true;};/**
Default search-related key bindings.

 - Mod-f: [`openSearchPanel`](https://codemirror.net/6/docs/ref/#search.openSearchPanel)
 - F3, Mod-g: [`findNext`](https://codemirror.net/6/docs/ref/#search.findNext)
 - Shift-F3, Shift-Mod-g: [`findPrevious`](https://codemirror.net/6/docs/ref/#search.findPrevious)
 - Alt-g: [`gotoLine`](https://codemirror.net/6/docs/ref/#search.gotoLine)
 - Mod-d: [`selectNextOccurrence`](https://codemirror.net/6/docs/ref/#search.selectNextOccurrence)
*/var searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:true},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:true},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:true}];var SearchPanel=/*#__PURE__*/function(){function SearchPanel(view){var _this91=this;_classCallCheck(this,SearchPanel);this.view=view;var query=this.query=view.state.field(searchState).query.spec;this.commit=this.commit.bind(this);this.searchField=crelt("input",{value:query.search,placeholder:phrase(view,"Find"),"aria-label":phrase(view,"Find"),"class":"cm-textfield",name:"search","main-field":"true",onchange:this.commit,onkeyup:this.commit});this.replaceField=crelt("input",{value:query.replace,placeholder:phrase(view,"Replace"),"aria-label":phrase(view,"Replace"),"class":"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit});this.caseField=crelt("input",{type:"checkbox",name:"case",checked:query.caseSensitive,onchange:this.commit});this.reField=crelt("input",{type:"checkbox",name:"re",checked:query.regexp,onchange:this.commit});this.wordField=crelt("input",{type:"checkbox",name:"word",checked:query.wholeWord,onchange:this.commit});function button(name,onclick,content){return crelt("button",{"class":"cm-button",name:name,onclick:onclick,type:"button"},content);}this.dom=crelt("div",{onkeydown:function onkeydown(e){return _this91.keydown(e);},"class":"cm-search"},[this.searchField,button("next",function(){return findNext(view);},[phrase(view,"next")]),button("prev",function(){return findPrevious(view);},[phrase(view,"previous")]),button("select",function(){return selectMatches(view);},[phrase(view,"all")]),crelt("label",null,[this.caseField,phrase(view,"match case")]),crelt("label",null,[this.reField,phrase(view,"regexp")]),crelt("label",null,[this.wordField,phrase(view,"by word")])].concat(_toConsumableArray2(view.state.readOnly?[]:[crelt("br"),this.replaceField,button("replace",function(){return replaceNext(view);},[phrase(view,"replace")]),button("replaceAll",function(){return replaceAll(view);},[phrase(view,"replace all")]),crelt("button",{name:"close",onclick:function onclick(){return closeSearchPanel(view);},"aria-label":phrase(view,"close"),type:"button"},[""])])));}_createClass(SearchPanel,[{key:"commit",value:function commit(){var query=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!query.eq(this.query)){this.query=query;this.view.dispatch({effects:setSearchQuery.of(query)});}}},{key:"keydown",value:function keydown(e){if(runScopeHandlers(this.view,e,"search-panel")){e.preventDefault();}else if(e.keyCode==13&&e.target==this.searchField){e.preventDefault();(e.shiftKey?findPrevious:findNext)(this.view);}else if(e.keyCode==13&&e.target==this.replaceField){e.preventDefault();replaceNext(this.view);}}},{key:"update",value:function update(_update24){var _iterator180=_createForOfIteratorHelper(_update24.transactions),_step180;try{for(_iterator180.s();!(_step180=_iterator180.n()).done;){var tr=_step180.value;var _iterator181=_createForOfIteratorHelper(tr.effects),_step181;try{for(_iterator181.s();!(_step181=_iterator181.n()).done;){var effect=_step181.value;if(effect.is(setSearchQuery)&&!effect.value.eq(this.query))this.setQuery(effect.value);}}catch(err){_iterator181.e(err);}finally{_iterator181.f();}}}catch(err){_iterator180.e(err);}finally{_iterator180.f();}}},{key:"setQuery",value:function setQuery(query){this.query=query;this.searchField.value=query.search;this.replaceField.value=query.replace;this.caseField.checked=query.caseSensitive;this.reField.checked=query.regexp;this.wordField.checked=query.wholeWord;}},{key:"mount",value:function mount(){this.searchField.select();}},{key:"pos",get:function get(){return 80;}},{key:"top",get:function get(){return this.view.state.facet(searchConfigFacet).top;}}]);return SearchPanel;}();function phrase(view,phrase){return view.state.phrase(phrase);}var AnnounceMargin=30;var Break=/[\s\.,:;?!]/;function announceMatch(view,_ref88){var from=_ref88.from,to=_ref88.to;var line=view.state.doc.lineAt(from),lineEnd=view.state.doc.lineAt(to).to;var start=Math.max(line.from,from-AnnounceMargin),end=Math.min(lineEnd,to+AnnounceMargin);var text=view.state.sliceDoc(start,end);if(start!=line.from){for(var _i189=0;_i189<AnnounceMargin;_i189++){if(!Break.test(text[_i189+1])&&Break.test(text[_i189])){text=text.slice(_i189);break;}}}if(end!=lineEnd){for(var _i190=text.length-1;_i190>text.length-AnnounceMargin;_i190--){if(!Break.test(text[_i190-1])&&Break.test(text[_i190])){text=text.slice(0,_i190);break;}}}return EditorView.announce.of("".concat(view.state.phrase("current match"),". ").concat(text," ").concat(view.state.phrase("on line")," ").concat(line.number,"."));}var baseTheme$2=/*@__PURE__*/EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}});var searchExtensions=[searchState,/*@__PURE__*/Prec.lowest(searchHighlighter),baseTheme$2];/**
An instance of this is passed to completion source functions.
*/var CompletionContext=/*#__PURE__*/function(){/**
    Create a new completion context. (Mostly useful for testing
    completion sourcesin the editor, the extension will create
    these for you.)
    */function CompletionContext(/**
    The editor state that the completion happens in.
    */state,/**
    The position at which the completion is happening.
    */pos,/**
    Indicates whether completion was activated explicitly, or
    implicitly by typing. The usual way to respond to this is to
    only return completions when either there is part of a
    completable entity before the cursor, or `explicit` is true.
    */explicit){_classCallCheck(this,CompletionContext);this.state=state;this.pos=pos;this.explicit=explicit;/**
        @internal
        */this.abortListeners=[];}/**
    Get the extent, content, and (if there is a token) type of the
    token before `this.pos`.
    */_createClass(CompletionContext,[{key:"tokenBefore",value:function tokenBefore(types){var token=syntaxTree(this.state).resolveInner(this.pos,-1);while(token&&types.indexOf(token.name)<0){token=token.parent;}return token?{from:token.from,to:this.pos,text:this.state.sliceDoc(token.from,this.pos),type:token.type}:null;}/**
    Get the match of the given expression directly before the
    cursor.
    */},{key:"matchBefore",value:function matchBefore(expr){var line=this.state.doc.lineAt(this.pos);var start=Math.max(line.from,this.pos-250);var str=line.text.slice(start-line.from,this.pos-line.from);var found=str.search(ensureAnchor(expr,false));return found<0?null:{from:start+found,to:this.pos,text:str.slice(found)};}/**
    Yields true when the query has been aborted. Can be useful in
    asynchronous queries to avoid doing work that will be ignored.
    */},{key:"aborted",get:function get(){return this.abortListeners==null;}/**
    Allows you to register abort handlers, which will be called when
    the query is
    [aborted](https://codemirror.net/6/docs/ref/#autocomplete.CompletionContext.aborted).
    */},{key:"addEventListener",value:function addEventListener(type,listener){if(type=="abort"&&this.abortListeners)this.abortListeners.push(listener);}}]);return CompletionContext;}();function toSet(chars){var flat=Object.keys(chars).join("");var words=/\w/.test(flat);if(words)flat=flat.replace(/\w/g,"");return"[".concat(words?"\\w":"").concat(flat.replace(/[^\w\s]/g,"\\$&"),"]");}function prefixMatch(options){var first=Object.create(null),rest=Object.create(null);var _iterator182=_createForOfIteratorHelper(options),_step182;try{for(_iterator182.s();!(_step182=_iterator182.n()).done;){var label=_step182.value.label;first[label[0]]=true;for(var _i191=1;_i191<label.length;_i191++){rest[label[_i191]]=true;}}}catch(err){_iterator182.e(err);}finally{_iterator182.f();}var source=toSet(first)+toSet(rest)+"*$";return[new RegExp("^"+source),new RegExp(source)];}/**
Given a a fixed array of options, return an autocompleter that
completes them.
*/function completeFromList(list){var options=list.map(function(o){return typeof o=="string"?{label:o}:o;});var _ref89=options.every(function(o){return /^\w+$/.test(o.label);})?[/\w*$/,/\w+$/]:prefixMatch(options),_ref90=_slicedToArray(_ref89,2),validFor=_ref90[0],match=_ref90[1];return function(context){var token=context.matchBefore(match);return token||context.explicit?{from:token?token.from:context.pos,options:options,validFor:validFor}:null;};}var Option=/*#__PURE__*/_createClass(function Option(completion,source,match){_classCallCheck(this,Option);this.completion=completion;this.source=source;this.match=match;});function cur(state){return state.selection.main.head;}// Make sure the given regexp has a $ at its end and, if `start` is
// true, a ^ at its start.
function ensureAnchor(expr,start){var _a;var source=expr.source;var addStart=start&&source[0]!="^",addEnd=source[source.length-1]!="$";if(!addStart&&!addEnd)return expr;return new RegExp("".concat(addStart?"^":"","(?:").concat(source,")").concat(addEnd?"$":""),(_a=expr.flags)!==null&&_a!==void 0?_a:expr.ignoreCase?"i":"");}/**
Helper function that returns a transaction spec which inserts a
completion's text in the main selection range, and any other
selection range that has the same text in front of it.
*/function insertCompletionText(state,text,from,to){return Object.assign(Object.assign({},state.changeByRange(function(range){if(range==state.selection.main)return{changes:{from:from,to:to,insert:text},range:EditorSelection.cursor(from+text.length)};var len=to-from;if(!range.empty||len&&state.sliceDoc(range.from-len,range.from)!=state.sliceDoc(from,to))return{range:range};return{changes:{from:range.from-len,to:range.from,insert:text},range:EditorSelection.cursor(range.from-len+text.length)};})),{userEvent:"input.complete"});}function applyCompletion(view,option){var apply=option.completion.apply||option.completion.label;var result=option.source;if(typeof apply=="string")view.dispatch(insertCompletionText(view.state,apply,result.from,result.to));else apply(view,option.completion,result.from,result.to);}var SourceCache=/*@__PURE__*/new WeakMap();function asSource(source){if(!Array.isArray(source))return source;var known=SourceCache.get(source);if(!known)SourceCache.set(source,known=completeFromList(source));return known;}// A pattern matcher for fuzzy completion matching. Create an instance
// once for a pattern, and then use that to match any number of
// completions.
var FuzzyMatcher=/*#__PURE__*/function(){function FuzzyMatcher(pattern){_classCallCheck(this,FuzzyMatcher);this.pattern=pattern;this.chars=[];this.folded=[];// Buffers reused by calls to `match` to track matched character
// positions.
this.any=[];this.precise=[];this.byWord=[];for(var _p8=0;_p8<pattern.length;){var _char11=codePointAt(pattern,_p8),_size9=codePointSize(_char11);this.chars.push(_char11);var part=pattern.slice(_p8,_p8+_size9),upper=part.toUpperCase();this.folded.push(codePointAt(upper==part?part.toLowerCase():upper,0));_p8+=_size9;}this.astral=pattern.length!=this.chars.length;}// Matches a given word (completion) against the pattern (input).
// Will return null for no match, and otherwise an array that starts
// with the match score, followed by any number of `from, to` pairs
// indicating the matched parts of `word`.
//
// The score is a number that is more negative the worse the match
// is. See `Penalty` above.
_createClass(FuzzyMatcher,[{key:"match",value:function match(word){if(this.pattern.length==0)return[0];if(word.length<this.pattern.length)return null;var chars=this.chars,folded=this.folded,any=this.any,precise=this.precise,byWord=this.byWord;// For single-character queries, only match when they occur right
// at the start
if(chars.length==1){var first=codePointAt(word,0);return first==chars[0]?[0,0,codePointSize(first)]:first==folded[0]?[-200/* CaseFold */,0,codePointSize(first)]:null;}var direct=word.indexOf(this.pattern);if(direct==0)return[0,0,this.pattern.length];var len=chars.length,anyTo=0;if(direct<0){for(var _i192=0,e=Math.min(word.length,200);_i192<e&&anyTo<len;){var next=codePointAt(word,_i192);if(next==chars[anyTo]||next==folded[anyTo])any[anyTo++]=_i192;_i192+=codePointSize(next);}// No match, exit immediately
if(anyTo<len)return null;}// This tracks the extent of the precise (non-folded, not
// necessarily adjacent) match
var preciseTo=0;// Tracks whether there is a match that hits only characters that
// appear to be starting words. `byWordFolded` is set to true when
// a case folded character is encountered in such a match
var byWordTo=0,byWordFolded=false;// If we've found a partial adjacent match, these track its state
var adjacentTo=0,adjacentStart=-1,adjacentEnd=-1;var hasLower=/[a-z]/.test(word),wordAdjacent=true;// Go over the option's text, scanning for the various kinds of matches
for(var _i193=0,_e2=Math.min(word.length,200),prevType=0/* NonWord */;_i193<_e2&&byWordTo<len;){var _next3=codePointAt(word,_i193);if(direct<0){if(preciseTo<len&&_next3==chars[preciseTo])precise[preciseTo++]=_i193;if(adjacentTo<len){if(_next3==chars[adjacentTo]||_next3==folded[adjacentTo]){if(adjacentTo==0)adjacentStart=_i193;adjacentEnd=_i193+1;adjacentTo++;}else{adjacentTo=0;}}}var ch=void 0,type=_next3<0xff?_next3>=48&&_next3<=57||_next3>=97&&_next3<=122?2/* Lower */:_next3>=65&&_next3<=90?1/* Upper */:0/* NonWord */:(ch=fromCodePoint(_next3))!=ch.toLowerCase()?1/* Upper */:ch!=ch.toUpperCase()?2/* Lower */:0/* NonWord */;if(!_i193||type==1/* Upper */&&hasLower||prevType==0/* NonWord */&&type!=0/* NonWord */){if(chars[byWordTo]==_next3||folded[byWordTo]==_next3&&(byWordFolded=true))byWord[byWordTo++]=_i193;else if(byWord.length)wordAdjacent=false;}prevType=type;_i193+=codePointSize(_next3);}if(byWordTo==len&&byWord[0]==0&&wordAdjacent)return this.result(-100/* ByWord */+(byWordFolded?-200/* CaseFold */:0),byWord,word);if(adjacentTo==len&&adjacentStart==0)return[-200/* CaseFold */-word.length,0,adjacentEnd];if(direct>-1)return[-700/* NotStart */-word.length,direct,direct+this.pattern.length];if(adjacentTo==len)return[-200/* CaseFold */+-700/* NotStart */-word.length,adjacentStart,adjacentEnd];if(byWordTo==len)return this.result(-100/* ByWord */+(byWordFolded?-200/* CaseFold */:0)+-700/* NotStart */+(wordAdjacent?0:-1100/* Gap */),byWord,word);return chars.length==2?null:this.result((any[0]?-700/* NotStart */:0)+-200/* CaseFold */+-1100/* Gap */,any,word);}},{key:"result",value:function result(score,positions,word){var result=[score-word.length],i=1;var _iterator183=_createForOfIteratorHelper(positions),_step183;try{for(_iterator183.s();!(_step183=_iterator183.n()).done;){var pos=_step183.value;var to=pos+(this.astral?codePointSize(codePointAt(word,pos)):1);if(i>1&&result[i-1]==pos)result[i-1]=to;else{result[i++]=pos;result[i++]=to;}}}catch(err){_iterator183.e(err);}finally{_iterator183.f();}return result;}}]);return FuzzyMatcher;}();var completionConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{activateOnTyping:true,selectOnOpen:true,override:null,closeOnBlur:true,maxRenderedOptions:100,defaultKeymap:true,optionClass:function optionClass(){return"";},aboveCursor:false,icons:true,addToOptions:[],compareCompletions:function compareCompletions(a,b){return a.label.localeCompare(b.label);}},{defaultKeymap:function defaultKeymap(a,b){return a&&b;},closeOnBlur:function closeOnBlur(a,b){return a&&b;},icons:function icons(a,b){return a&&b;},optionClass:function optionClass(a,b){return function(c){return joinClass(a(c),b(c));};},addToOptions:function addToOptions(a,b){return a.concat(b);}});}});function joinClass(a,b){return a?b?a+" "+b:a:b;}function optionContent(config){var content=config.addToOptions.slice();if(config.icons)content.push({render:function render(completion){var _icon$classList;var icon=document.createElement("div");icon.classList.add("cm-completionIcon");if(completion.type)(_icon$classList=icon.classList).add.apply(_icon$classList,_toConsumableArray2(completion.type.split(/\s+/g).map(function(cls){return"cm-completionIcon-"+cls;})));icon.setAttribute("aria-hidden","true");return icon;},position:20});content.push({render:function render(completion,_s,match){var labelElt=document.createElement("span");labelElt.className="cm-completionLabel";var label=completion.label,off=0;for(var j=1;j<match.length;){var from=match[j++],to=match[j++];if(from>off)labelElt.appendChild(document.createTextNode(label.slice(off,from)));var span=labelElt.appendChild(document.createElement("span"));span.appendChild(document.createTextNode(label.slice(from,to)));span.className="cm-completionMatchedText";off=to;}if(off<label.length)labelElt.appendChild(document.createTextNode(label.slice(off)));return labelElt;},position:50},{render:function render(completion){if(!completion.detail)return null;var detailElt=document.createElement("span");detailElt.className="cm-completionDetail";detailElt.textContent=completion.detail;return detailElt;},position:80});return content.sort(function(a,b){return a.position-b.position;}).map(function(a){return a.render;});}function rangeAroundSelected(total,selected,max){if(total<=max)return{from:0,to:total};if(selected<0)selected=0;if(selected<=total>>1){var _off=Math.floor(selected/max);return{from:_off*max,to:(_off+1)*max};}var off=Math.floor((total-selected)/max);return{from:total-(off+1)*max,to:total-off*max};}var CompletionTooltip=/*#__PURE__*/function(){function CompletionTooltip(view,stateField){var _this92=this;_classCallCheck(this,CompletionTooltip);this.view=view;this.stateField=stateField;this.info=null;this.placeInfo={read:function read(){return _this92.measureInfo();},write:function write(pos){return _this92.positionInfo(pos);},key:this};var cState=view.state.field(stateField);var _cState$open=cState.open,options=_cState$open.options,selected=_cState$open.selected;var config=view.state.facet(completionConfig);this.optionContent=optionContent(config);this.optionClass=config.optionClass;this.range=rangeAroundSelected(options.length,selected,config.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.dom.addEventListener("mousedown",function(e){for(var dom=e.target,match;dom&&dom!=_this92.dom;dom=dom.parentNode){if(dom.nodeName=="LI"&&(match=/-(\d+)$/.exec(dom.id))&&+match[1]<options.length){applyCompletion(view,options[+match[1]]);e.preventDefault();return;}}});this.list=this.dom.appendChild(this.createListBox(options,cState.id,this.range));this.list.addEventListener("scroll",function(){if(_this92.info)_this92.view.requestMeasure(_this92.placeInfo);});}_createClass(CompletionTooltip,[{key:"mount",value:function mount(){this.updateSel();}},{key:"update",value:function update(_update25){if(_update25.state.field(this.stateField)!=_update25.startState.field(this.stateField))this.updateSel();}},{key:"positioned",value:function positioned(){if(this.info)this.view.requestMeasure(this.placeInfo);}},{key:"updateSel",value:function updateSel(){var _this93=this;var cState=this.view.state.field(this.stateField),open=cState.open;if(open.selected<this.range.from||open.selected>=this.range.to){this.range=rangeAroundSelected(open.options.length,open.selected,this.view.state.facet(completionConfig).maxRenderedOptions);this.list.remove();this.list=this.dom.appendChild(this.createListBox(open.options,cState.id,this.range));this.list.addEventListener("scroll",function(){if(_this93.info)_this93.view.requestMeasure(_this93.placeInfo);});}if(this.updateSelectedOption(open.selected)){if(this.info){this.info.remove();this.info=null;}var completion=open.options[open.selected].completion;var info=completion.info;if(!info)return;var infoResult=typeof info==='string'?document.createTextNode(info):info(completion);if(!infoResult)return;if('then'in infoResult){infoResult.then(function(node){if(node&&_this93.view.state.field(_this93.stateField,false)==cState)_this93.addInfoPane(node);})["catch"](function(e){return logException(_this93.view.state,e,"completion info");});}else{this.addInfoPane(infoResult);}}}},{key:"addInfoPane",value:function addInfoPane(content){var dom=this.info=document.createElement("div");dom.className="cm-tooltip cm-completionInfo";dom.appendChild(content);this.dom.appendChild(dom);this.view.requestMeasure(this.placeInfo);}},{key:"updateSelectedOption",value:function updateSelectedOption(selected){var set=null;for(var opt=this.list.firstChild,_i194=this.range.from;opt;opt=opt.nextSibling,_i194++){if(_i194==selected){if(!opt.hasAttribute("aria-selected")){opt.setAttribute("aria-selected","true");set=opt;}}else{if(opt.hasAttribute("aria-selected"))opt.removeAttribute("aria-selected");}}if(set)scrollIntoView(this.list,set);return set;}},{key:"measureInfo",value:function measureInfo(){var sel=this.dom.querySelector("[aria-selected]");if(!sel||!this.info)return null;var listRect=this.dom.getBoundingClientRect();var infoRect=this.info.getBoundingClientRect();var selRect=sel.getBoundingClientRect();if(selRect.top>Math.min(innerHeight,listRect.bottom)-10||selRect.bottom<Math.max(0,listRect.top)+10)return null;var top=Math.max(0,Math.min(selRect.top,innerHeight-infoRect.height))-listRect.top;var left=this.view.textDirection==Direction.RTL;var spaceLeft=listRect.left,spaceRight=innerWidth-listRect.right;if(left&&spaceLeft<Math.min(infoRect.width,spaceRight))left=false;else if(!left&&spaceRight<Math.min(infoRect.width,spaceLeft))left=true;return{top:top,left:left};}},{key:"positionInfo",value:function positionInfo(pos){if(this.info){this.info.style.top=(pos?pos.top:-1e6)+"px";if(pos){this.info.classList.toggle("cm-completionInfo-left",pos.left);this.info.classList.toggle("cm-completionInfo-right",!pos.left);}}}},{key:"createListBox",value:function createListBox(options,id,range){var ul=document.createElement("ul");ul.id=id;ul.setAttribute("role","listbox");ul.setAttribute("aria-expanded","true");ul.setAttribute("aria-label",this.view.state.phrase("Completions"));for(var _i195=range.from;_i195<range.to;_i195++){var _options$_i=options[_i195],completion=_options$_i.completion,match=_options$_i.match;var li=ul.appendChild(document.createElement("li"));li.id=id+"-"+_i195;li.setAttribute("role","option");var cls=this.optionClass(completion);if(cls)li.className=cls;var _iterator184=_createForOfIteratorHelper(this.optionContent),_step184;try{for(_iterator184.s();!(_step184=_iterator184.n()).done;){var source=_step184.value;var node=source(completion,this.view.state,match);if(node)li.appendChild(node);}}catch(err){_iterator184.e(err);}finally{_iterator184.f();}}if(range.from)ul.classList.add("cm-completionListIncompleteTop");if(range.to<options.length)ul.classList.add("cm-completionListIncompleteBottom");return ul;}}]);return CompletionTooltip;}();// We allocate a new function instance every time the completion
// changes to force redrawing/repositioning of the tooltip
function completionTooltip(stateField){return function(view){return new CompletionTooltip(view,stateField);};}function scrollIntoView(container,element){var parent=container.getBoundingClientRect();var self=element.getBoundingClientRect();if(self.top<parent.top)container.scrollTop-=parent.top-self.top;else if(self.bottom>parent.bottom)container.scrollTop+=self.bottom-parent.bottom;}// Used to pick a preferred option when two options with the same
// label occur in the result.
function score(option){return(option.boost||0)*100+(option.apply?10:0)+(option.info?5:0)+(option.type?1:0);}function sortOptions(active,state){var options=[],i=0;var _iterator185=_createForOfIteratorHelper(active),_step185;try{for(_iterator185.s();!(_step185=_iterator185.n()).done;){var a=_step185.value;if(a.hasResult()){if(a.result.filter===false){var getMatch=a.result.getMatch;var _iterator187=_createForOfIteratorHelper(a.result.options),_step187;try{for(_iterator187.s();!(_step187=_iterator187.n()).done;){var option=_step187.value;var match=[1e9-i++];if(getMatch){var _iterator188=_createForOfIteratorHelper(getMatch(option)),_step188;try{for(_iterator188.s();!(_step188=_iterator188.n()).done;){var n=_step188.value;match.push(n);}}catch(err){_iterator188.e(err);}finally{_iterator188.f();}}options.push(new Option(option,a,match));}}catch(err){_iterator187.e(err);}finally{_iterator187.f();}}else{var matcher=new FuzzyMatcher(state.sliceDoc(a.from,a.to)),_match2=void 0;var _iterator189=_createForOfIteratorHelper(a.result.options),_step189;try{for(_iterator189.s();!(_step189=_iterator189.n()).done;){var _option=_step189.value;if(_match2=matcher.match(_option.label)){if(_option.boost!=null)_match2[0]+=_option.boost;options.push(new Option(_option,a,_match2));}}}catch(err){_iterator189.e(err);}finally{_iterator189.f();}}}}}catch(err){_iterator185.e(err);}finally{_iterator185.f();}var result=[],prev=null;var compare=state.facet(completionConfig).compareCompletions;var _iterator186=_createForOfIteratorHelper(options.sort(function(a,b){return b.match[0]-a.match[0]||compare(a.completion,b.completion);})),_step186;try{for(_iterator186.s();!(_step186=_iterator186.n()).done;){var opt=_step186.value;if(!prev||prev.label!=opt.completion.label||prev.detail!=opt.completion.detail||prev.type!=null&&opt.completion.type!=null&&prev.type!=opt.completion.type||prev.apply!=opt.completion.apply)result.push(opt);else if(score(opt.completion)>score(prev))result[result.length-1]=opt;prev=opt.completion;}}catch(err){_iterator186.e(err);}finally{_iterator186.f();}return result;}var CompletionDialog=/*#__PURE__*/function(){function CompletionDialog(options,attrs,tooltip,timestamp,selected){_classCallCheck(this,CompletionDialog);this.options=options;this.attrs=attrs;this.tooltip=tooltip;this.timestamp=timestamp;this.selected=selected;}_createClass(CompletionDialog,[{key:"setSelected",value:function setSelected(selected,id){return selected==this.selected||selected>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(id,selected),this.tooltip,this.timestamp,selected);}},{key:"map",value:function map(changes){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:changes.mapPos(this.tooltip.pos)}),this.timestamp,this.selected);}}],[{key:"build",value:function build(active,state,id,prev,conf){var options=sortOptions(active,state);if(!options.length)return null;var selected=state.facet(completionConfig).selectOnOpen?0:-1;if(prev&&prev.selected!=selected&&prev.selected!=-1){var selectedValue=prev.options[prev.selected].completion;for(var _i196=0;_i196<options.length;_i196++){if(options[_i196].completion==selectedValue){selected=_i196;break;}}}return new CompletionDialog(options,makeAttrs(id,selected),{pos:active.reduce(function(a,b){return b.hasResult()?Math.min(a,b.from):a;},1e8),create:completionTooltip(completionState),above:conf.aboveCursor},prev?prev.timestamp:Date.now(),selected);}}]);return CompletionDialog;}();var CompletionState=/*#__PURE__*/function(){function CompletionState(active,id,open){_classCallCheck(this,CompletionState);this.active=active;this.id=id;this.open=open;}_createClass(CompletionState,[{key:"update",value:function update(tr){var _this94=this;var state=tr.state,conf=state.facet(completionConfig);var sources=conf.override||state.languageDataAt("autocomplete",cur(state)).map(asSource);var active=sources.map(function(source){var value=_this94.active.find(function(s){return s.source==source;})||new ActiveSource(source,_this94.active.some(function(a){return a.state!=0;}/* Inactive */)?1/* Pending */:0/* Inactive */);return value.update(tr,conf);});if(active.length==this.active.length&&active.every(function(a,i){return a==_this94.active[i];}))active=this.active;var open=tr.selection||active.some(function(a){return a.hasResult()&&tr.changes.touchesRange(a.from,a.to);})||!sameResults(active,this.active)?CompletionDialog.build(active,state,this.id,this.open,conf):this.open&&tr.docChanged?this.open.map(tr.changes):this.open;if(!open&&active.every(function(a){return a.state!=1;}/* Pending */)&&active.some(function(a){return a.hasResult();}))active=active.map(function(a){return a.hasResult()?new ActiveSource(a.source,0/* Inactive */):a;});var _iterator190=_createForOfIteratorHelper(tr.effects),_step190;try{for(_iterator190.s();!(_step190=_iterator190.n()).done;){var effect=_step190.value;if(effect.is(setSelectedEffect))open=open&&open.setSelected(effect.value,this.id);}}catch(err){_iterator190.e(err);}finally{_iterator190.f();}return active==this.active&&open==this.open?this:new CompletionState(active,this.id,open);}},{key:"tooltip",get:function get(){return this.open?this.open.tooltip:null;}},{key:"attrs",get:function get(){return this.open?this.open.attrs:baseAttrs;}}],[{key:"start",value:function start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null);}}]);return CompletionState;}();function sameResults(a,b){if(a==b)return true;for(var iA=0,iB=0;;){while(iA<a.length&&!a[iA].hasResult){iA++;}while(iB<b.length&&!b[iB].hasResult){iB++;}var endA=iA==a.length,endB=iB==b.length;if(endA||endB)return endA==endB;if(a[iA++].result!=b[iB++].result)return false;}}var baseAttrs={"aria-autocomplete":"list"};function makeAttrs(id,selected){var result={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":id};if(selected>-1)result["aria-activedescendant"]=id+"-"+selected;return result;}var none=[];function getUserEvent(tr){return tr.isUserEvent("input.type")?"input":tr.isUserEvent("delete.backward")?"delete":null;}var ActiveSource=/*#__PURE__*/function(){function ActiveSource(source,state){var explicitPos=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;_classCallCheck(this,ActiveSource);this.source=source;this.state=state;this.explicitPos=explicitPos;}_createClass(ActiveSource,[{key:"hasResult",value:function hasResult(){return false;}},{key:"update",value:function update(tr,conf){var event=getUserEvent(tr),value=this;if(event)value=value.handleUserEvent(tr,event,conf);else if(tr.docChanged)value=value.handleChange(tr);else if(tr.selection&&value.state!=0/* Inactive */)value=new ActiveSource(value.source,0/* Inactive */);var _iterator191=_createForOfIteratorHelper(tr.effects),_step191;try{for(_iterator191.s();!(_step191=_iterator191.n()).done;){var effect=_step191.value;if(effect.is(startCompletionEffect))value=new ActiveSource(value.source,1/* Pending */,effect.value?cur(tr.state):-1);else if(effect.is(closeCompletionEffect))value=new ActiveSource(value.source,0/* Inactive */);else if(effect.is(setActiveEffect)){var _iterator192=_createForOfIteratorHelper(effect.value),_step192;try{for(_iterator192.s();!(_step192=_iterator192.n()).done;){var _active=_step192.value;if(_active.source==value.source)value=_active;}}catch(err){_iterator192.e(err);}finally{_iterator192.f();}}}}catch(err){_iterator191.e(err);}finally{_iterator191.f();}return value;}},{key:"handleUserEvent",value:function handleUserEvent(tr,type,conf){return type=="delete"||!conf.activateOnTyping?this.map(tr.changes):new ActiveSource(this.source,1/* Pending */);}},{key:"handleChange",value:function handleChange(tr){return tr.changes.touchesRange(cur(tr.startState))?new ActiveSource(this.source,0/* Inactive */):this.map(tr.changes);}},{key:"map",value:function map(changes){return changes.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,changes.mapPos(this.explicitPos));}}]);return ActiveSource;}();var ActiveResult=/*#__PURE__*/function(_ActiveSource){_inherits(ActiveResult,_ActiveSource);var _super50=_createSuper(ActiveResult);function ActiveResult(source,explicitPos,result,from,to){var _this95;_classCallCheck(this,ActiveResult);_this95=_super50.call(this,source,2/* Result */,explicitPos);_this95.result=result;_this95.from=from;_this95.to=to;return _this95;}_createClass(ActiveResult,[{key:"hasResult",value:function hasResult(){return true;}},{key:"handleUserEvent",value:function handleUserEvent(tr,type,conf){var _a;var from=tr.changes.mapPos(this.from),to=tr.changes.mapPos(this.to,1);var pos=cur(tr.state);if((this.explicitPos<0?pos<=from:pos<this.from)||pos>to||type=="delete"&&cur(tr.startState)==this.from)return new ActiveSource(this.source,type=="input"&&conf.activateOnTyping?1/* Pending */:0/* Inactive */);var explicitPos=this.explicitPos<0?-1:tr.changes.mapPos(this.explicitPos),updated;if(checkValid(this.result.validFor,tr.state,from,to))return new ActiveResult(this.source,explicitPos,this.result,from,to);if(this.result.update&&(updated=this.result.update(this.result,from,to,new CompletionContext(tr.state,pos,explicitPos>=0))))return new ActiveResult(this.source,explicitPos,updated,updated.from,(_a=updated.to)!==null&&_a!==void 0?_a:cur(tr.state));return new ActiveSource(this.source,1/* Pending */,explicitPos);}},{key:"handleChange",value:function handleChange(tr){return tr.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0/* Inactive */):this.map(tr.changes);}},{key:"map",value:function map(mapping){return mapping.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:mapping.mapPos(this.explicitPos),this.result,mapping.mapPos(this.from),mapping.mapPos(this.to,1));}}]);return ActiveResult;}(ActiveSource);function checkValid(validFor,state,from,to){if(!validFor)return false;var text=state.sliceDoc(from,to);return typeof validFor=="function"?validFor(text,from,to,state):ensureAnchor(validFor,true).test(text);}var startCompletionEffect=/*@__PURE__*/StateEffect.define();var closeCompletionEffect=/*@__PURE__*/StateEffect.define();var setActiveEffect=/*@__PURE__*/StateEffect.define({map:function map(sources,mapping){return sources.map(function(s){return s.map(mapping);});}});var setSelectedEffect=/*@__PURE__*/StateEffect.define();var completionState=/*@__PURE__*/StateField.define({create:function create(){return CompletionState.start();},update:function update(value,tr){return value.update(tr);},provide:function provide(f){return[showTooltip.from(f,function(val){return val.tooltip;}),EditorView.contentAttributes.from(f,function(state){return state.attrs;})];}});var CompletionInteractMargin=75;/**
Returns a command that moves the completion selection forward or
backward by the given amount.
*/function moveCompletionSelection(forward){var by=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"option";return function(view){var cState=view.state.field(completionState,false);if(!cState||!cState.open||Date.now()-cState.open.timestamp<CompletionInteractMargin)return false;var step=1,tooltip;if(by=="page"&&(tooltip=getTooltip(view,cState.open.tooltip)))step=Math.max(2,Math.floor(tooltip.dom.offsetHeight/tooltip.dom.querySelector("li").offsetHeight)-1);var length=cState.open.options.length;var selected=cState.open.selected>-1?cState.open.selected+step*(forward?1:-1):forward?0:length-1;if(selected<0)selected=by=="page"?0:length-1;else if(selected>=length)selected=by=="page"?length-1:0;view.dispatch({effects:setSelectedEffect.of(selected)});return true;};}/**
Accept the current completion.
*/var acceptCompletion=function acceptCompletion(view){var cState=view.state.field(completionState,false);if(view.state.readOnly||!cState||!cState.open||Date.now()-cState.open.timestamp<CompletionInteractMargin||cState.open.selected<0)return false;applyCompletion(view,cState.open.options[cState.open.selected]);return true;};/**
Explicitly start autocompletion.
*/var startCompletion=function startCompletion(view){var cState=view.state.field(completionState,false);if(!cState)return false;view.dispatch({effects:startCompletionEffect.of(true)});return true;};/**
Close the currently active completion.
*/var closeCompletion=function closeCompletion(view){var cState=view.state.field(completionState,false);if(!cState||!cState.active.some(function(a){return a.state!=0;}/* Inactive */))return false;view.dispatch({effects:closeCompletionEffect.of(null)});return true;};var RunningQuery=/*#__PURE__*/_createClass(function RunningQuery(active,context){_classCallCheck(this,RunningQuery);this.active=active;this.context=context;this.time=Date.now();this.updates=[];// Note that 'undefined' means 'not done yet', whereas 'null' means
// 'query returned null'.
this.done=undefined;});var DebounceTime=50,MaxUpdateCount=50,MinAbortTime=1000;var completionPlugin=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class15(view){_classCallCheck(this,_class15);this.view=view;this.debounceUpdate=-1;this.running=[];this.debounceAccept=-1;this.composing=0/* None */;var _iterator193=_createForOfIteratorHelper(view.state.field(completionState).active),_step193;try{for(_iterator193.s();!(_step193=_iterator193.n()).done;){var _active2=_step193.value;if(_active2.state==1/* Pending */)this.startQuery(_active2);}}catch(err){_iterator193.e(err);}finally{_iterator193.f();}}_createClass(_class15,[{key:"update",value:function update(_update26){var _this96=this;var cState=_update26.state.field(completionState);if(!_update26.selectionSet&&!_update26.docChanged&&_update26.startState.field(completionState)==cState)return;var doesReset=_update26.transactions.some(function(tr){return(tr.selection||tr.docChanged)&&!getUserEvent(tr);});for(var _i197=0;_i197<this.running.length;_i197++){var query=this.running[_i197];if(doesReset||query.updates.length+_update26.transactions.length>MaxUpdateCount&&Date.now()-query.time>MinAbortTime){var _iterator194=_createForOfIteratorHelper(query.context.abortListeners),_step194;try{for(_iterator194.s();!(_step194=_iterator194.n()).done;){var handler=_step194.value;try{handler();}catch(e){logException(this.view.state,e);}}}catch(err){_iterator194.e(err);}finally{_iterator194.f();}query.context.abortListeners=null;this.running.splice(_i197--,1);}else{var _query$updates;(_query$updates=query.updates).push.apply(_query$updates,_toConsumableArray2(_update26.transactions));}}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);this.debounceUpdate=cState.active.some(function(a){return a.state==1/* Pending */&&!_this96.running.some(function(q){return q.active.source==a.source;});})?setTimeout(function(){return _this96.startUpdate();},DebounceTime):-1;if(this.composing!=0/* None */){var _iterator195=_createForOfIteratorHelper(_update26.transactions),_step195;try{for(_iterator195.s();!(_step195=_iterator195.n()).done;){var tr=_step195.value;if(getUserEvent(tr)=="input")this.composing=2/* Changed */;else if(this.composing==2/* Changed */&&tr.selection)this.composing=3/* ChangedAndMoved */;}}catch(err){_iterator195.e(err);}finally{_iterator195.f();}}}},{key:"startUpdate",value:function startUpdate(){var _this97=this;this.debounceUpdate=-1;var state=this.view.state,cState=state.field(completionState);var _iterator196=_createForOfIteratorHelper(cState.active),_step196;try{var _loop14=function _loop14(){var active=_step196.value;if(active.state==1/* Pending */&&!_this97.running.some(function(r){return r.active.source==active.source;}))_this97.startQuery(active);};for(_iterator196.s();!(_step196=_iterator196.n()).done;){_loop14();}}catch(err){_iterator196.e(err);}finally{_iterator196.f();}}},{key:"startQuery",value:function startQuery(active){var _this98=this;var state=this.view.state,pos=cur(state);var context=new CompletionContext(state,pos,active.explicitPos==pos);var pending=new RunningQuery(active,context);this.running.push(pending);Promise.resolve(active.source(context)).then(function(result){if(!pending.context.aborted){pending.done=result||null;_this98.scheduleAccept();}},function(err){_this98.view.dispatch({effects:closeCompletionEffect.of(null)});logException(_this98.view.state,err);});}},{key:"scheduleAccept",value:function scheduleAccept(){var _this99=this;if(this.running.every(function(q){return q.done!==undefined;}))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout(function(){return _this99.accept();},DebounceTime);}// For each finished query in this.running, try to create a result
// or, if appropriate, restart the query.
},{key:"accept",value:function accept(){var _this100=this;var _a;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;var updated=[];var conf=this.view.state.facet(completionConfig);var _loop15=function _loop15(_i199){var query=_this100.running[_i199];if(query.done===undefined){_i198=_i199;return"continue";}_this100.running.splice(_i199--,1);if(query.done){var _active3=new ActiveResult(query.active.source,query.active.explicitPos,query.done,query.done.from,(_a=query.done.to)!==null&&_a!==void 0?_a:cur(query.updates.length?query.updates[0].startState:_this100.view.state));// Replay the transactions that happened since the start of
// the request and see if that preserves the result
var _iterator197=_createForOfIteratorHelper(query.updates),_step197;try{for(_iterator197.s();!(_step197=_iterator197.n()).done;){var tr=_step197.value;_active3=_active3.update(tr,conf);}}catch(err){_iterator197.e(err);}finally{_iterator197.f();}if(_active3.hasResult()){updated.push(_active3);_i198=_i199;return"continue";}}var current=_this100.view.state.field(completionState).active.find(function(a){return a.source==query.active.source;});if(current&&current.state==1/* Pending */){if(query.done==null){// Explicitly failed. Should clear the pending status if it
// hasn't been re-set in the meantime.
var _active4=new ActiveSource(query.active.source,0/* Inactive */);var _iterator198=_createForOfIteratorHelper(query.updates),_step198;try{for(_iterator198.s();!(_step198=_iterator198.n()).done;){var _tr2=_step198.value;_active4=_active4.update(_tr2,conf);}}catch(err){_iterator198.e(err);}finally{_iterator198.f();}if(_active4.state!=1/* Pending */)updated.push(_active4);}else{// Cleared by subsequent transactions. Restart.
_this100.startQuery(current);}}_i198=_i199;};for(var _i198=0;_i198<this.running.length;_i198++){var _ret3=_loop15(_i198);if(_ret3==="continue")continue;}if(updated.length)this.view.dispatch({effects:setActiveEffect.of(updated)});}}]);return _class15;}(),{eventHandlers:{blur:function blur(){var state=this.view.state.field(completionState,false);if(state&&state.tooltip&&this.view.state.facet(completionConfig).closeOnBlur)this.view.dispatch({effects:closeCompletionEffect.of(null)});},compositionstart:function compositionstart(){this.composing=1/* Started */;},compositionend:function compositionend(){var _this101=this;if(this.composing==3/* ChangedAndMoved */){// Safari fires compositionend events synchronously, possibly
// from inside an update, so dispatch asynchronously to avoid reentrancy
setTimeout(function(){return _this101.view.dispatch({effects:startCompletionEffect.of(false)});},20);}this.composing=0/* None */;}}});var baseTheme$1=/*@__PURE__*/EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:0.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11\uFE0E'"}// Disable emoji rendering
},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});var defaults={brackets:["(","[","{","'",'"'],before:")]}:;>"};var closeBracketEffect=/*@__PURE__*/StateEffect.define({map:function map(value,mapping){var mapped=mapping.mapPos(value,-1,MapMode.TrackAfter);return mapped==null?undefined:mapped;}});var skipBracketEffect=/*@__PURE__*/StateEffect.define({map:function map(value,mapping){return mapping.mapPos(value);}});var closedBracket=/*@__PURE__*/new(/*#__PURE__*/function(_RangeValue3){_inherits(_class16,_RangeValue3);var _super51=_createSuper(_class16);function _class16(){_classCallCheck(this,_class16);return _super51.apply(this,arguments);}return _createClass(_class16);}(RangeValue))();closedBracket.startSide=1;closedBracket.endSide=-1;var bracketState=/*@__PURE__*/StateField.define({create:function create(){return RangeSet.empty;},update:function update(value,tr){if(tr.selection){var lineStart=tr.state.doc.lineAt(tr.selection.main.head).from;var prevLineStart=tr.startState.doc.lineAt(tr.startState.selection.main.head).from;if(lineStart!=tr.changes.mapPos(prevLineStart,-1))value=RangeSet.empty;}value=value.map(tr.changes);var _iterator199=_createForOfIteratorHelper(tr.effects),_step199;try{var _loop16=function _loop16(){var effect=_step199.value;if(effect.is(closeBracketEffect))value=value.update({add:[closedBracket.range(effect.value,effect.value+1)]});else if(effect.is(skipBracketEffect))value=value.update({filter:function filter(from){return from!=effect.value;}});};for(_iterator199.s();!(_step199=_iterator199.n()).done;){_loop16();}}catch(err){_iterator199.e(err);}finally{_iterator199.f();}return value;}});/**
Extension to enable bracket-closing behavior. When a closeable
bracket is typed, its closing bracket is immediately inserted
after the cursor. When closing a bracket directly in front of a
closing bracket inserted by the extension, the cursor moves over
that bracket.
*/function closeBrackets(){return[inputHandler,bracketState];}var definedClosing="()[]{}<>";function closing(ch){for(var _i200=0;_i200<definedClosing.length;_i200+=2){if(definedClosing.charCodeAt(_i200)==ch)return definedClosing.charAt(_i200+1);}return fromCodePoint(ch<128?ch:ch+1);}function config(state,pos){return state.languageDataAt("closeBrackets",pos)[0]||defaults;}var android=(typeof navigator==="undefined"?"undefined":_typeof2(navigator))=="object"&&/*@__PURE__*/ /Android\b/.test(navigator.userAgent);var inputHandler=/*@__PURE__*/EditorView.inputHandler.of(function(view,from,to,insert){if((android?view.composing:view.compositionStarted)||view.state.readOnly)return false;var sel=view.state.selection.main;if(insert.length>2||insert.length==2&&codePointSize(codePointAt(insert,0))==1||from!=sel.from||to!=sel.to)return false;var tr=insertBracket(view.state,insert);if(!tr)return false;view.dispatch(tr);return true;});/**
Command that implements deleting a pair of matching brackets when
the cursor is between them.
*/var deleteBracketPair=function deleteBracketPair(_ref91){var state=_ref91.state,dispatch=_ref91.dispatch;if(state.readOnly)return false;var conf=config(state,state.selection.main.head);var tokens=conf.brackets||defaults.brackets;var dont=null,changes=state.changeByRange(function(range){if(range.empty){var _before3=prevChar(state.doc,range.head);var _iterator200=_createForOfIteratorHelper(tokens),_step200;try{for(_iterator200.s();!(_step200=_iterator200.n()).done;){var token=_step200.value;if(token==_before3&&nextChar(state.doc,range.head)==closing(codePointAt(token,0)))return{changes:{from:range.head-token.length,to:range.head+token.length},range:EditorSelection.cursor(range.head-token.length),userEvent:"delete.backward"};}}catch(err){_iterator200.e(err);}finally{_iterator200.f();}}return{range:dont=range};});if(!dont)dispatch(state.update(changes,{scrollIntoView:true}));return!dont;};/**
Close-brackets related key bindings. Binds Backspace to
[`deleteBracketPair`](https://codemirror.net/6/docs/ref/#autocomplete.deleteBracketPair).
*/var closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];/**
Implements the extension's behavior on text insertion. If the
given string counts as a bracket in the language around the
selection, and replacing the selection with it requires custom
behavior (inserting a closing version or skipping past a
previously-closed bracket), this function returns a transaction
representing that custom behavior. (You only need this if you want
to programmatically insert bracketsthe
[`closeBrackets`](https://codemirror.net/6/docs/ref/#autocomplete.closeBrackets) extension will
take care of running this for user input.)
*/function insertBracket(state,bracket){var conf=config(state,state.selection.main.head);var tokens=conf.brackets||defaults.brackets;var _iterator201=_createForOfIteratorHelper(tokens),_step201;try{for(_iterator201.s();!(_step201=_iterator201.n()).done;){var tok=_step201.value;var closed=closing(codePointAt(tok,0));if(bracket==tok)return closed==tok?handleSame(state,tok,tokens.indexOf(tok+tok+tok)>-1):handleOpen(state,tok,closed,conf.before||defaults.before);if(bracket==closed&&closedBracketAt(state,state.selection.main.from))return handleClose(state,tok,closed);}}catch(err){_iterator201.e(err);}finally{_iterator201.f();}return null;}function closedBracketAt(state,pos){var found=false;state.field(bracketState).between(0,state.doc.length,function(from){if(from==pos)found=true;});return found;}function nextChar(doc,pos){var next=doc.sliceString(pos,pos+2);return next.slice(0,codePointSize(codePointAt(next,0)));}function prevChar(doc,pos){var prev=doc.sliceString(pos-2,pos);return codePointSize(codePointAt(prev,0))==prev.length?prev:prev.slice(1);}function handleOpen(state,open,close,closeBefore){var dont=null,changes=state.changeByRange(function(range){if(!range.empty)return{changes:[{insert:open,from:range.from},{insert:close,from:range.to}],effects:closeBracketEffect.of(range.to+open.length),range:EditorSelection.range(range.anchor+open.length,range.head+open.length)};var next=nextChar(state.doc,range.head);if(!next||/\s/.test(next)||closeBefore.indexOf(next)>-1)return{changes:{insert:open+close,from:range.head},effects:closeBracketEffect.of(range.head+open.length),range:EditorSelection.cursor(range.head+open.length)};return{range:dont=range};});return dont?null:state.update(changes,{scrollIntoView:true,userEvent:"input.type"});}function handleClose(state,_open,close){var dont=null,moved=state.selection.ranges.map(function(range){if(range.empty&&nextChar(state.doc,range.head)==close)return EditorSelection.cursor(range.head+close.length);return dont=range;});return dont?null:state.update({selection:EditorSelection.create(moved,state.selection.mainIndex),scrollIntoView:true,effects:state.selection.ranges.map(function(_ref92){var from=_ref92.from;return skipBracketEffect.of(from);})});}// Handles cases where the open and close token are the same, and
// possibly triple quotes (as in `"""abc"""`-style quoting).
function handleSame(state,token,allowTriple){var dont=null,changes=state.changeByRange(function(range){if(!range.empty)return{changes:[{insert:token,from:range.from},{insert:token,from:range.to}],effects:closeBracketEffect.of(range.to+token.length),range:EditorSelection.range(range.anchor+token.length,range.head+token.length)};var pos=range.head,next=nextChar(state.doc,pos);if(next==token){if(nodeStart(state,pos)){return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}else if(closedBracketAt(state,pos)){var isTriple=allowTriple&&state.sliceDoc(pos,pos+token.length*3)==token+token+token;return{range:EditorSelection.cursor(pos+token.length*(isTriple?3:1)),effects:skipBracketEffect.of(pos)};}}else if(allowTriple&&state.sliceDoc(pos-2*token.length,pos)==token+token&&nodeStart(state,pos-2*token.length)){return{changes:{insert:token+token+token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}else if(state.charCategorizer(pos)(next)!=CharCategory.Word){var prev=state.sliceDoc(pos-1,pos);if(prev!=token&&state.charCategorizer(pos)(prev)!=CharCategory.Word&&!probablyInString(state,pos,token))return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}return{range:dont=range};});return dont?null:state.update(changes,{scrollIntoView:true,userEvent:"input.type"});}function nodeStart(state,pos){var tree=syntaxTree(state).resolveInner(pos+1);return tree.parent&&tree.from==pos;}function probablyInString(state,pos,quoteToken){var node=syntaxTree(state).resolveInner(pos,-1);for(var _i201=0;_i201<5;_i201++){if(state.sliceDoc(node.from,node.from+quoteToken.length)==quoteToken){var first=node.firstChild;while(first&&first.from==node.from&&first.to-first.from>quoteToken.length){if(state.sliceDoc(first.to-quoteToken.length,first.to)==quoteToken)return false;first=first.firstChild;}return true;}var _parent17=node.to==pos&&node.parent;if(!_parent17)break;node=_parent17;}return false;}/**
Returns an extension that enables autocompletion.
*/function autocompletion(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[completionState,completionConfig.of(config),completionPlugin,completionKeymapExt,baseTheme$1];}/**
Basic keybindings for autocompletion.

 - Ctrl-Space: [`startCompletion`](https://codemirror.net/6/docs/ref/#autocomplete.startCompletion)
 - Escape: [`closeCompletion`](https://codemirror.net/6/docs/ref/#autocomplete.closeCompletion)
 - ArrowDown: [`moveCompletionSelection`](https://codemirror.net/6/docs/ref/#autocomplete.moveCompletionSelection)`(true)`
 - ArrowUp: [`moveCompletionSelection`](https://codemirror.net/6/docs/ref/#autocomplete.moveCompletionSelection)`(false)`
 - PageDown: [`moveCompletionSelection`](https://codemirror.net/6/docs/ref/#autocomplete.moveCompletionSelection)`(true, "page")`
 - PageDown: [`moveCompletionSelection`](https://codemirror.net/6/docs/ref/#autocomplete.moveCompletionSelection)`(true, "page")`
 - Enter: [`acceptCompletion`](https://codemirror.net/6/docs/ref/#autocomplete.acceptCompletion)
*/var completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:/*@__PURE__*/moveCompletionSelection(true)},{key:"ArrowUp",run:/*@__PURE__*/moveCompletionSelection(false)},{key:"PageDown",run:/*@__PURE__*/moveCompletionSelection(true,"page")},{key:"PageUp",run:/*@__PURE__*/moveCompletionSelection(false,"page")},{key:"Enter",run:acceptCompletion}];var completionKeymapExt=/*@__PURE__*/Prec.highest(/*@__PURE__*/keymap.computeN([completionConfig],function(state){return state.facet(completionConfig).defaultKeymap?[completionKeymap]:[];}));var SelectedDiagnostic=/*#__PURE__*/_createClass(function SelectedDiagnostic(from,to,diagnostic){_classCallCheck(this,SelectedDiagnostic);this.from=from;this.to=to;this.diagnostic=diagnostic;});var LintState=/*#__PURE__*/function(){function LintState(diagnostics,panel,selected){_classCallCheck(this,LintState);this.diagnostics=diagnostics;this.panel=panel;this.selected=selected;}_createClass(LintState,null,[{key:"init",value:function init(diagnostics,panel,state){// Filter the list of diagnostics for which to create markers
var markedDiagnostics=diagnostics;var diagnosticFilter=state.facet(lintConfig).markerFilter;if(diagnosticFilter)markedDiagnostics=diagnosticFilter(markedDiagnostics);var ranges=Decoration.set(markedDiagnostics.map(function(d){// For zero-length ranges or ranges covering only a line break, create a widget
return d.from==d.to||d.from==d.to-1&&state.doc.lineAt(d.from).to==d.from?Decoration.widget({widget:new DiagnosticWidget(d),diagnostic:d}).range(d.from):Decoration.mark({attributes:{"class":"cm-lintRange cm-lintRange-"+d.severity},diagnostic:d}).range(d.from,d.to);}),true);return new LintState(ranges,panel,findDiagnostic(ranges));}}]);return LintState;}();function findDiagnostic(diagnostics){var diagnostic=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var found=null;diagnostics.between(after,1e9,function(from,to,_ref93){var spec=_ref93.spec;if(diagnostic&&spec.diagnostic!=diagnostic)return;found=new SelectedDiagnostic(from,to,spec.diagnostic);return false;});return found;}function hideTooltip(tr,tooltip){return!!(tr.effects.some(function(e){return e.is(setDiagnosticsEffect);})||tr.changes.touchesRange(tooltip.pos));}function maybeEnableLint(state,effects){return state.field(lintState,false)?effects:effects.concat(StateEffect.appendConfig.of([lintState,EditorView.decorations.compute([lintState],function(state){var _state$field=state.field(lintState),selected=_state$field.selected,panel=_state$field.panel;return!selected||!panel||selected.from==selected.to?Decoration.none:Decoration.set([activeMark.range(selected.from,selected.to)]);}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme]));}/**
Returns a transaction spec which updates the current set of
diagnostics, and enables the lint extension if if wasn't already
active.
*/function setDiagnostics(state,diagnostics){return{effects:maybeEnableLint(state,[setDiagnosticsEffect.of(diagnostics)])};}/**
The state effect that updates the set of active diagnostics. Can
be useful when writing an extension that needs to track these.
*/var setDiagnosticsEffect=/*@__PURE__*/StateEffect.define();var togglePanel=/*@__PURE__*/StateEffect.define();var movePanelSelection=/*@__PURE__*/StateEffect.define();var lintState=/*@__PURE__*/StateField.define({create:function create(){return new LintState(Decoration.none,null,null);},update:function update(value,tr){if(tr.docChanged){var mapped=value.diagnostics.map(tr.changes),selected=null;if(value.selected){var selPos=tr.changes.mapPos(value.selected.from,1);selected=findDiagnostic(mapped,value.selected.diagnostic,selPos)||findDiagnostic(mapped,null,selPos);}value=new LintState(mapped,value.panel,selected);}var _iterator202=_createForOfIteratorHelper(tr.effects),_step202;try{for(_iterator202.s();!(_step202=_iterator202.n()).done;){var effect=_step202.value;if(effect.is(setDiagnosticsEffect)){value=LintState.init(effect.value,value.panel,tr.state);}else if(effect.is(togglePanel)){value=new LintState(value.diagnostics,effect.value?LintPanel.open:null,value.selected);}else if(effect.is(movePanelSelection)){value=new LintState(value.diagnostics,value.panel,effect.value);}}}catch(err){_iterator202.e(err);}finally{_iterator202.f();}return value;},provide:function provide(f){return[showPanel.from(f,function(val){return val.panel;}),EditorView.decorations.from(f,function(s){return s.diagnostics;})];}});var activeMark=/*@__PURE__*/Decoration.mark({"class":"cm-lintRange cm-lintRange-active"});function lintTooltip(view,pos,side){var _view$state$field=view.state.field(lintState),diagnostics=_view$state$field.diagnostics;var found=[],stackStart=2e8,stackEnd=0;diagnostics.between(pos-(side<0?1:0),pos+(side>0?1:0),function(from,to,_ref94){var spec=_ref94.spec;if(pos>=from&&pos<=to&&(from==to||(pos>from||side>0)&&(pos<to||side<0))){found.push(spec.diagnostic);stackStart=Math.min(from,stackStart);stackEnd=Math.max(to,stackEnd);}});var diagnosticFilter=view.state.facet(lintConfig).tooltipFilter;if(diagnosticFilter)found=diagnosticFilter(found);if(!found.length)return null;return{pos:stackStart,end:stackEnd,above:view.state.doc.lineAt(stackStart).to<stackEnd,create:function create(){return{dom:diagnosticsTooltip(view,found)};}};}function diagnosticsTooltip(view,diagnostics){return crelt("ul",{"class":"cm-tooltip-lint"},diagnostics.map(function(d){return renderDiagnostic(view,d,false);}));}/**
Command to open and focus the lint panel.
*/var openLintPanel=function openLintPanel(view){var field=view.state.field(lintState,false);if(!field||!field.panel)view.dispatch({effects:maybeEnableLint(view.state,[togglePanel.of(true)])});var panel=getPanel(view,LintPanel.open);if(panel)panel.dom.querySelector(".cm-panel-lint ul").focus();return true;};/**
Command to close the lint panel, when open.
*/var closeLintPanel=function closeLintPanel(view){var field=view.state.field(lintState,false);if(!field||!field.panel)return false;view.dispatch({effects:togglePanel.of(false)});return true;};/**
Move the selection to the next diagnostic.
*/var nextDiagnostic=function nextDiagnostic(view){var field=view.state.field(lintState,false);if(!field)return false;var sel=view.state.selection.main,next=field.diagnostics.iter(sel.to+1);if(!next.value){next=field.diagnostics.iter(0);if(!next.value||next.from==sel.from&&next.to==sel.to)return false;}view.dispatch({selection:{anchor:next.from,head:next.to},scrollIntoView:true});return true;};/**
A set of default key bindings for the lint functionality.

- Ctrl-Shift-m (Cmd-Shift-m on macOS): [`openLintPanel`](https://codemirror.net/6/docs/ref/#lint.openLintPanel)
- F8: [`nextDiagnostic`](https://codemirror.net/6/docs/ref/#lint.nextDiagnostic)
*/var lintKeymap=[{key:"Mod-Shift-m",run:openLintPanel},{key:"F8",run:nextDiagnostic}];var lintPlugin=/*@__PURE__*/ViewPlugin.fromClass(/*#__PURE__*/function(){function _class17(view){_classCallCheck(this,_class17);this.view=view;this.timeout=-1;this.set=true;var _view$state$facet=view.state.facet(lintConfig),delay=_view$state$facet.delay;this.lintTime=Date.now()+delay;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,delay);}_createClass(_class17,[{key:"run",value:function run(){var _this102=this;var now=Date.now();if(now<this.lintTime-10){setTimeout(this.run,this.lintTime-now);}else{this.set=false;var state=this.view.state,_state$facet=state.facet(lintConfig),sources=_state$facet.sources;Promise.all(sources.map(function(source){return Promise.resolve(source(_this102.view));})).then(function(annotations){var all=annotations.reduce(function(a,b){return a.concat(b);});if(_this102.view.state.doc==state.doc)_this102.view.dispatch(setDiagnostics(_this102.view.state,all));},function(error){logException(_this102.view.state,error);});}}},{key:"update",value:function update(_update27){var config=_update27.state.facet(lintConfig);if(_update27.docChanged||config!=_update27.startState.facet(lintConfig)){this.lintTime=Date.now()+config.delay;if(!this.set){this.set=true;this.timeout=setTimeout(this.run,config.delay);}}}},{key:"force",value:function force(){if(this.set){this.lintTime=Date.now();this.run();}}},{key:"destroy",value:function destroy(){clearTimeout(this.timeout);}}]);return _class17;}());var lintConfig=/*@__PURE__*/Facet.define({combine:function combine(input){return Object.assign({sources:input.map(function(i){return i.source;})},combineConfig(input.map(function(i){return i.config;}),{delay:750,markerFilter:null,tooltipFilter:null}));},enables:lintPlugin});/**
Given a diagnostic source, this function returns an extension that
enables linting with that source. It will be called whenever the
editor is idle (after its content changed).
*/function linter(source){var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return lintConfig.of({source:source,config:config});}function assignKeys(actions){var assigned=[];if(actions){var _iterator203=_createForOfIteratorHelper(actions),_step203;try{actions:for(_iterator203.s();!(_step203=_iterator203.n()).done;){var _name9=_step203.value.name;var _loop17=function _loop17(_i202){var ch=_name9[_i202];if(/[a-zA-Z]/.test(ch)&&!assigned.some(function(c){return c.toLowerCase()==ch.toLowerCase();})){assigned.push(ch);return"continue|actions";}};for(var _i202=0;_i202<_name9.length;_i202++){var _ret4=_loop17(_i202);if(_ret4==="continue|actions")continue actions;}assigned.push("");}}catch(err){_iterator203.e(err);}finally{_iterator203.f();}}return assigned;}function renderDiagnostic(view,diagnostic,inPanel){var _a;var keys=inPanel?assignKeys(diagnostic.actions):[];return crelt("li",{"class":"cm-diagnostic cm-diagnostic-"+diagnostic.severity},crelt("span",{"class":"cm-diagnosticText"},diagnostic.renderMessage?diagnostic.renderMessage():diagnostic.message),(_a=diagnostic.actions)===null||_a===void 0?void 0:_a.map(function(action,i){var click=function click(e){e.preventDefault();var found=findDiagnostic(view.state.field(lintState).diagnostics,diagnostic);if(found)action.apply(view,found.from,found.to);};var name=action.name,keyIndex=keys[i]?name.indexOf(keys[i]):-1;var nameElt=keyIndex<0?name:[name.slice(0,keyIndex),crelt("u",name.slice(keyIndex,keyIndex+1)),name.slice(keyIndex+1)];return crelt("button",{type:"button","class":"cm-diagnosticAction",onclick:click,onmousedown:click,"aria-label":" Action: ".concat(name).concat(keyIndex<0?"":" (access key \"".concat(keys[i],")\""),".")},nameElt);}),diagnostic.source&&crelt("div",{"class":"cm-diagnosticSource"},diagnostic.source));}var DiagnosticWidget=/*#__PURE__*/function(_WidgetType8){_inherits(DiagnosticWidget,_WidgetType8);var _super52=_createSuper(DiagnosticWidget);function DiagnosticWidget(diagnostic){var _this103;_classCallCheck(this,DiagnosticWidget);_this103=_super52.call(this);_this103.diagnostic=diagnostic;return _this103;}_createClass(DiagnosticWidget,[{key:"eq",value:function eq(other){return other.diagnostic==this.diagnostic;}},{key:"toDOM",value:function toDOM(){return crelt("span",{"class":"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity});}}]);return DiagnosticWidget;}(WidgetType);var PanelItem=/*#__PURE__*/_createClass(function PanelItem(view,diagnostic){_classCallCheck(this,PanelItem);this.diagnostic=diagnostic;this.id="item_"+Math.floor(Math.random()*0xffffffff).toString(16);this.dom=renderDiagnostic(view,diagnostic,true);this.dom.id=this.id;this.dom.setAttribute("role","option");});var LintPanel=/*#__PURE__*/function(){function LintPanel(view){var _this104=this;_classCallCheck(this,LintPanel);this.view=view;this.items=[];var onkeydown=function onkeydown(event){if(event.keyCode==27){// Escape
closeLintPanel(_this104.view);_this104.view.focus();}else if(event.keyCode==38||event.keyCode==33){// ArrowUp, PageUp
_this104.moveSelection((_this104.selectedIndex-1+_this104.items.length)%_this104.items.length);}else if(event.keyCode==40||event.keyCode==34){// ArrowDown, PageDown
_this104.moveSelection((_this104.selectedIndex+1)%_this104.items.length);}else if(event.keyCode==36){// Home
_this104.moveSelection(0);}else if(event.keyCode==35){// End
_this104.moveSelection(_this104.items.length-1);}else if(event.keyCode==13){// Enter
_this104.view.focus();}else if(event.keyCode>=65&&event.keyCode<=90&&_this104.selectedIndex>=0){// A-Z
var diagnostic=_this104.items[_this104.selectedIndex].diagnostic,_keys3=assignKeys(diagnostic.actions);for(var _i203=0;_i203<_keys3.length;_i203++){if(_keys3[_i203].toUpperCase().charCodeAt(0)==event.keyCode){var found=findDiagnostic(_this104.view.state.field(lintState).diagnostics,diagnostic);if(found)diagnostic.actions[_i203].apply(view,found.from,found.to);}}}else{return;}event.preventDefault();};var onclick=function onclick(event){for(var _i204=0;_i204<_this104.items.length;_i204++){if(_this104.items[_i204].dom.contains(event.target))_this104.moveSelection(_i204);}};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:onkeydown,onclick:onclick});this.dom=crelt("div",{"class":"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:function onclick(){return closeLintPanel(_this104.view);}},""));this.update();}_createClass(LintPanel,[{key:"selectedIndex",get:function get(){var selected=this.view.state.field(lintState).selected;if(!selected)return-1;for(var _i205=0;_i205<this.items.length;_i205++){if(this.items[_i205].diagnostic==selected.diagnostic)return _i205;}return-1;}},{key:"update",value:function update(){var _this105=this;var _this$view$state$fiel=this.view.state.field(lintState),diagnostics=_this$view$state$fiel.diagnostics,selected=_this$view$state$fiel.selected;var i=0,needsSync=false,newSelectedItem=null;diagnostics.between(0,this.view.state.doc.length,function(_start,_end,_ref95){var spec=_ref95.spec;var found=-1,item;for(var j=i;j<_this105.items.length;j++){if(_this105.items[j].diagnostic==spec.diagnostic){found=j;break;}}if(found<0){item=new PanelItem(_this105.view,spec.diagnostic);_this105.items.splice(i,0,item);needsSync=true;}else{item=_this105.items[found];if(found>i){_this105.items.splice(i,found-i);needsSync=true;}}if(selected&&item.diagnostic==selected.diagnostic){if(!item.dom.hasAttribute("aria-selected")){item.dom.setAttribute("aria-selected","true");newSelectedItem=item;}}else if(item.dom.hasAttribute("aria-selected")){item.dom.removeAttribute("aria-selected");}i++;});while(i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0)){needsSync=true;this.items.pop();}if(this.items.length==0){this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")}));needsSync=true;}if(newSelectedItem){this.list.setAttribute("aria-activedescendant",newSelectedItem.id);this.view.requestMeasure({key:this,read:function read(){return{sel:newSelectedItem.dom.getBoundingClientRect(),panel:_this105.list.getBoundingClientRect()};},write:function write(_ref96){var sel=_ref96.sel,panel=_ref96.panel;if(sel.top<panel.top)_this105.list.scrollTop-=panel.top-sel.top;else if(sel.bottom>panel.bottom)_this105.list.scrollTop+=sel.bottom-panel.bottom;}});}else if(this.selectedIndex<0){this.list.removeAttribute("aria-activedescendant");}if(needsSync)this.sync();}},{key:"sync",value:function sync(){var domPos=this.list.firstChild;function rm(){var prev=domPos;domPos=prev.nextSibling;prev.remove();}var _iterator204=_createForOfIteratorHelper(this.items),_step204;try{for(_iterator204.s();!(_step204=_iterator204.n()).done;){var item=_step204.value;if(item.dom.parentNode==this.list){while(domPos!=item.dom){rm();}domPos=item.dom.nextSibling;}else{this.list.insertBefore(item.dom,domPos);}}}catch(err){_iterator204.e(err);}finally{_iterator204.f();}while(domPos){rm();}}},{key:"moveSelection",value:function moveSelection(selectedIndex){if(this.selectedIndex<0)return;var field=this.view.state.field(lintState);var selection=findDiagnostic(field.diagnostics,this.items[selectedIndex].diagnostic);if(!selection)return;this.view.dispatch({selection:{anchor:selection.from,head:selection.to},scrollIntoView:true,effects:movePanelSelection.of(selection)});}}],[{key:"open",value:function open(view){return new LintPanel(view);}}]);return LintPanel;}();function svg(content){var attrs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"viewBox=\"0 0 40 40\"";return"url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" ".concat(attrs,">").concat(encodeURIComponent(content),"</svg>')");}function underline(color){return svg("<path d=\"m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0\" stroke=\"".concat(color,"\" fill=\"none\" stroke-width=\".7\"/>"),"width=\"6\" height=\"3\"");}var baseTheme=/*@__PURE__*/EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:/*@__PURE__*/underline("#d11")},".cm-lintRange-warning":{backgroundImage:/*@__PURE__*/underline("orange")},".cm-lintRange-info":{backgroundImage:/*@__PURE__*/underline("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});var LintGutterMarker=/*#__PURE__*/function(_GutterMarker4){_inherits(LintGutterMarker,_GutterMarker4);var _super53=_createSuper(LintGutterMarker);function LintGutterMarker(diagnostics){var _this106;_classCallCheck(this,LintGutterMarker);_this106=_super53.call(this);_this106.diagnostics=diagnostics;_this106.severity=diagnostics.reduce(function(max,d){var s=d.severity;return s=="error"||s=="warning"&&max=="info"?s:max;},"info");return _this106;}_createClass(LintGutterMarker,[{key:"toDOM",value:function toDOM(view){var elt=document.createElement("div");elt.className="cm-lint-marker cm-lint-marker-"+this.severity;var diagnostics=this.diagnostics;var diagnosticsFilter=view.state.facet(lintGutterConfig).tooltipFilter;if(diagnosticsFilter)diagnostics=diagnosticsFilter(diagnostics);if(diagnostics.length)elt.onmouseover=function(){return gutterMarkerMouseOver(view,elt,diagnostics);};return elt;}}]);return LintGutterMarker;}(GutterMarker);function trackHoverOn(view,marker){var mousemove=function mousemove(event){var rect=marker.getBoundingClientRect();if(event.clientX>rect.left-10/* Margin */&&event.clientX<rect.right+10/* Margin */&&event.clientY>rect.top-10/* Margin */&&event.clientY<rect.bottom+10/* Margin */)return;for(var target=event.target;target;target=target.parentNode){if(target.nodeType==1&&target.classList.contains("cm-tooltip-lint"))return;}window.removeEventListener("mousemove",mousemove);if(view.state.field(lintGutterTooltip))view.dispatch({effects:setLintGutterTooltip.of(null)});};window.addEventListener("mousemove",mousemove);}function gutterMarkerMouseOver(view,marker,diagnostics){function hovered(){var line=view.elementAtHeight(marker.getBoundingClientRect().top+5-view.documentTop);var linePos=view.coordsAtPos(line.from);if(linePos){view.dispatch({effects:setLintGutterTooltip.of({pos:line.from,above:false,create:function create(){return{dom:diagnosticsTooltip(view,diagnostics),getCoords:function getCoords(){return marker.getBoundingClientRect();}};}})});}marker.onmouseout=marker.onmousemove=null;trackHoverOn(view,marker);}var _view$state$facet2=view.state.facet(lintGutterConfig),hoverTime=_view$state$facet2.hoverTime;var hoverTimeout=setTimeout(hovered,hoverTime);marker.onmouseout=function(){clearTimeout(hoverTimeout);marker.onmouseout=marker.onmousemove=null;};marker.onmousemove=function(){clearTimeout(hoverTimeout);hoverTimeout=setTimeout(hovered,hoverTime);};}function markersForDiagnostics(doc,diagnostics){var byLine=Object.create(null);var _iterator205=_createForOfIteratorHelper(diagnostics),_step205;try{for(_iterator205.s();!(_step205=_iterator205.n()).done;){var diagnostic=_step205.value;var _line7=doc.lineAt(diagnostic.from);(byLine[_line7.from]||(byLine[_line7.from]=[])).push(diagnostic);}}catch(err){_iterator205.e(err);}finally{_iterator205.f();}var markers=[];for(var line in byLine){markers.push(new LintGutterMarker(byLine[line]).range(+line));}return RangeSet.of(markers,true);}var lintGutterExtension=/*@__PURE__*/gutter({"class":"cm-gutter-lint",markers:function markers(view){return view.state.field(lintGutterMarkers);}});var lintGutterMarkers=/*@__PURE__*/StateField.define({create:function create(){return RangeSet.empty;},update:function update(markers,tr){markers=markers.map(tr.changes);var diagnosticFilter=tr.state.facet(lintGutterConfig).markerFilter;var _iterator206=_createForOfIteratorHelper(tr.effects),_step206;try{for(_iterator206.s();!(_step206=_iterator206.n()).done;){var effect=_step206.value;if(effect.is(setDiagnosticsEffect)){var diagnostics=effect.value;if(diagnosticFilter)diagnostics=diagnosticFilter(diagnostics||[]);markers=markersForDiagnostics(tr.state.doc,diagnostics.slice(0));}}}catch(err){_iterator206.e(err);}finally{_iterator206.f();}return markers;}});var setLintGutterTooltip=/*@__PURE__*/StateEffect.define();var lintGutterTooltip=/*@__PURE__*/StateField.define({create:function create(){return null;},update:function update(tooltip,tr){if(tooltip&&tr.docChanged)tooltip=hideTooltip(tr,tooltip)?null:Object.assign(Object.assign({},tooltip),{pos:tr.changes.mapPos(tooltip.pos)});return tr.effects.reduce(function(t,e){return e.is(setLintGutterTooltip)?e.value:t;},tooltip);},provide:function provide(field){return showTooltip.from(field);}});var lintGutterTheme=/*@__PURE__*/EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:/*@__PURE__*/svg("<path fill=\"#aaf\" stroke=\"#77e\" stroke-width=\"6\" stroke-linejoin=\"round\" d=\"M5 5L35 5L35 35L5 35Z\"/>")},".cm-lint-marker-warning":{content:/*@__PURE__*/svg("<path fill=\"#fe8\" stroke=\"#fd7\" stroke-width=\"6\" stroke-linejoin=\"round\" d=\"M20 6L37 35L3 35Z\"/>")},".cm-lint-marker-error:before":{content:/*@__PURE__*/svg("<circle cx=\"20\" cy=\"20\" r=\"15\" fill=\"#f87\" stroke=\"#f43\" stroke-width=\"6\"/>")}});var lintGutterConfig=/*@__PURE__*/Facet.define({combine:function combine(configs){return combineConfig(configs,{hoverTime:300/* Time */,markerFilter:null,tooltipFilter:null});}});/**
Returns an extension that installs a gutter showing markers for
each line that has diagnostics, which can be hovered over to see
the diagnostics.
*/function lintGutter(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[lintGutterConfig.of(config),lintGutterMarkers,lintGutterExtension,lintGutterTheme,lintGutterTooltip];}// (The superfluous function calls around the list of extensions work
// around current limitations in tree-shaking software.)
/**
This is an extension value that just pulls together a number of
extensions that you might want in a basic editor. It is meant as a
convenient helper to quickly set up CodeMirror without installing
and importing a lot of separate packages.

Specifically, it includes...

 - [the default command bindings](https://codemirror.net/6/docs/ref/#commands.defaultKeymap)
 - [line numbers](https://codemirror.net/6/docs/ref/#view.lineNumbers)
 - [special character highlighting](https://codemirror.net/6/docs/ref/#view.highlightSpecialChars)
 - [the undo history](https://codemirror.net/6/docs/ref/#commands.history)
 - [a fold gutter](https://codemirror.net/6/docs/ref/#language.foldGutter)
 - [custom selection drawing](https://codemirror.net/6/docs/ref/#view.drawSelection)
 - [drop cursor](https://codemirror.net/6/docs/ref/#view.dropCursor)
 - [multiple selections](https://codemirror.net/6/docs/ref/#state.EditorState^allowMultipleSelections)
 - [reindentation on input](https://codemirror.net/6/docs/ref/#language.indentOnInput)
 - [the default highlight style](https://codemirror.net/6/docs/ref/#language.defaultHighlightStyle) (as fallback)
 - [bracket matching](https://codemirror.net/6/docs/ref/#language.bracketMatching)
 - [bracket closing](https://codemirror.net/6/docs/ref/#autocomplete.closeBrackets)
 - [autocompletion](https://codemirror.net/6/docs/ref/#autocomplete.autocompletion)
 - [rectangular selection](https://codemirror.net/6/docs/ref/#view.rectangularSelection) and [crosshair cursor](https://codemirror.net/6/docs/ref/#view.crosshairCursor)
 - [active line highlighting](https://codemirror.net/6/docs/ref/#view.highlightActiveLine)
 - [active line gutter highlighting](https://codemirror.net/6/docs/ref/#view.highlightActiveLineGutter)
 - [selection match highlighting](https://codemirror.net/6/docs/ref/#search.highlightSelectionMatches)
 - [search](https://codemirror.net/6/docs/ref/#search.searchKeymap)
 - [linting](https://codemirror.net/6/docs/ref/#lint.lintKeymap)

(You'll probably want to add some language package to your setup
too.)

This extension does not allow customization. The idea is that,
once you decide you want to configure your editor more precisely,
you take this package's source (which is just a bunch of imports
and an array literal), copy it into your own code, and adjust it
as desired.
*/var basicSetup=/*@__PURE__*/function(){return[lineNumbers(),highlightActiveLineGutter(),highlightSpecialChars(),history(),foldGutter(),drawSelection(),dropCursor(),EditorState.allowMultipleSelections.of(true),indentOnInput(),syntaxHighlighting(defaultHighlightStyle,{fallback:true}),bracketMatching(),closeBrackets(),autocompletion(),rectangularSelection(),crosshairCursor(),highlightActiveLine(),highlightSelectionMatches(),keymap.of([].concat(closeBracketsKeymap,_toConsumableArray2(defaultKeymap),searchKeymap,historyKeymap,foldKeymap,completionKeymap,lintKeymap))];}();/// A parse stack. These are used internally by the parser to track
/// parsing progress. They also provide some properties and methods
/// that external code such as a tokenizer can use to get information
/// about the parse state.
var Stack=/*#__PURE__*/function(){/// @internal
function Stack(/// The parse that this stack is part of @internal
p,/// Holds state, input pos, buffer index triplets for all but the
/// top state @internal
stack,/// The current parse state @internal
state,// The position at which the next reduce should take place. This
// can be less than `this.pos` when skipped expressions have been
// added to the stack (which should be moved outside of the next
// reduction)
/// @internal
reducePos,/// The input position up to which this stack has parsed.
pos,/// The dynamic score of the stack, including dynamic precedence
/// and error-recovery penalties
/// @internal
score,// The output buffer. Holds (type, start, end, size) quads
// representing nodes created by the parser, where `size` is
// amount of buffer array entries covered by this node.
/// @internal
buffer,// The base offset of the buffer. When stacks are split, the split
// instance shared the buffer history with its parent up to
// `bufferBase`, which is the absolute offset (including the
// offset of previous splits) into the buffer at which this stack
// starts writing.
/// @internal
bufferBase,/// @internal
curContext){var lookAhead=arguments.length>9&&arguments[9]!==undefined?arguments[9]:0;var// A parent stack from which this was split off, if any. This is
// set up so that it always points to a stack that has some
// additional buffer content, never to a stack with an equal
// `bufferBase`.
/// @internal
parent=arguments.length>10?arguments[10]:undefined;_classCallCheck(this,Stack);this.p=p;this.stack=stack;this.state=state;this.reducePos=reducePos;this.pos=pos;this.score=score;this.buffer=buffer;this.bufferBase=bufferBase;this.curContext=curContext;this.lookAhead=lookAhead;this.parent=parent;}/// @internal
_createClass(Stack,[{key:"toString",value:function toString(){return"[".concat(this.stack.filter(function(_,i){return i%3==0;}).concat(this.state),"]@").concat(this.pos).concat(this.score?"!"+this.score:"");}// Start an empty stack
/// @internal
},{key:"context",get:/// The stack's current [context](#lr.ContextTracker) value, if
/// any. Its type will depend on the context tracker's type
/// parameter, or it will be `null` if there is no context
/// tracker.
function get(){return this.curContext?this.curContext.context:null;}// Push a state onto the stack, tracking its start position as well
// as the buffer base at that point.
/// @internal
},{key:"pushState",value:function pushState(state,start){this.stack.push(this.state,start,this.bufferBase+this.buffer.length);this.state=state;}// Apply a reduce action
/// @internal
},{key:"reduce",value:function reduce(action){var depth=action>>19/* ReduceDepthShift */,type=action&65535/* ValueMask */;var parser=this.p.parser;var dPrec=parser.dynamicPrecedence(type);if(dPrec)this.score+=dPrec;if(depth==0){this.pushState(parser.getGoto(this.state,type,true),this.reducePos);// Zero-depth reductions are a special casethey add stuff to
// the stack without popping anything off.
if(type<parser.minRepeatTerm)this.storeNode(type,this.reducePos,this.reducePos,4,true);this.reduceContext(type,this.reducePos);return;}// Find the base index into `this.stack`, content after which will
// be dropped. Note that with `StayFlag` reductions we need to
// consume two extra frames (the dummy parent node for the skipped
// expression and the state that we'll be staying in, which should
// be moved to `this.state`).
var base=this.stack.length-(depth-1)*3-(action&262144/* StayFlag */?6:0);var start=this.stack[base-2];var bufferBase=this.stack[base-1],count=this.bufferBase+this.buffer.length-bufferBase;// Store normal terms or `R -> R R` repeat reductions
if(type<parser.minRepeatTerm||action&131072/* RepeatFlag */){var pos=parser.stateFlag(this.state,1/* Skipped */)?this.pos:this.reducePos;this.storeNode(type,start,pos,count+4,true);}if(action&262144/* StayFlag */){this.state=this.stack[base];}else{var baseStateID=this.stack[base-3];this.state=parser.getGoto(baseStateID,type,true);}while(this.stack.length>base){this.stack.pop();}this.reduceContext(type,start);}// Shift a value into the buffer
/// @internal
},{key:"storeNode",value:function storeNode(term,start,end){var size=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4;var isReduce=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;if(term==0/* Err */&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){// Try to omit/merge adjacent error nodes
var _cur20=this,_top12=this.buffer.length;if(_top12==0&&_cur20.parent){_top12=_cur20.bufferBase-_cur20.parent.bufferBase;_cur20=_cur20.parent;}if(_top12>0&&_cur20.buffer[_top12-4]==0/* Err */&&_cur20.buffer[_top12-1]>-1){if(start==end)return;if(_cur20.buffer[_top12-2]>=start){_cur20.buffer[_top12-2]=end;return;}}}if(!isReduce||this.pos==end){// Simple case, just append
this.buffer.push(term,start,end,size);}else{// There may be skipped nodes that have to be moved forward
var index=this.buffer.length;if(index>0&&this.buffer[index-4]!=0/* Err */)while(index>0&&this.buffer[index-2]>end){// Move this record forward
this.buffer[index]=this.buffer[index-4];this.buffer[index+1]=this.buffer[index-3];this.buffer[index+2]=this.buffer[index-2];this.buffer[index+3]=this.buffer[index-1];index-=4;if(size>4)size-=4;}this.buffer[index]=term;this.buffer[index+1]=start;this.buffer[index+2]=end;this.buffer[index+3]=size;}}// Apply a shift action
/// @internal
},{key:"shift",value:function shift(action,next,nextEnd){var start=this.pos;if(action&131072/* GotoFlag */){this.pushState(action&65535/* ValueMask */,this.pos);}else if((action&262144/* StayFlag */)==0){// Regular shift
var nextState=action,_parser=this.p.parser;if(nextEnd>this.pos||next<=_parser.maxNode){this.pos=nextEnd;if(!_parser.stateFlag(nextState,1/* Skipped */))this.reducePos=nextEnd;}this.pushState(nextState,start);this.shiftContext(next,start);if(next<=_parser.maxNode)this.buffer.push(next,start,nextEnd,4);}else{// Shift-and-stay, which means this is a skipped token
this.pos=nextEnd;this.shiftContext(next,start);if(next<=this.p.parser.maxNode)this.buffer.push(next,start,nextEnd,4);}}// Apply an action
/// @internal
},{key:"apply",value:function apply(action,next,nextEnd){if(action&65536/* ReduceFlag */)this.reduce(action);else this.shift(action,next,nextEnd);}// Add a prebuilt (reused) node into the buffer.
/// @internal
},{key:"useNode",value:function useNode(value,next){var index=this.p.reused.length-1;if(index<0||this.p.reused[index]!=value){this.p.reused.push(value);index++;}var start=this.pos;this.reducePos=this.pos=start+value.length;this.pushState(next,start);this.buffer.push(index,start,this.reducePos,-1/* size == -1 means this is a reused value */);if(this.curContext)this.updateContext(this.curContext.tracker.reuse(this.curContext.context,value,this,this.p.stream.reset(this.pos-value.length)));}// Split the stack. Due to the buffer sharing and the fact
// that `this.stack` tends to stay quite shallow, this isn't very
// expensive.
/// @internal
},{key:"split",value:function split(){var parent=this;var off=parent.buffer.length;// Because the top of the buffer (after this.pos) may be mutated
// to reorder reductions and skipped tokens, and shared buffers
// should be immutable, this copies any outstanding skipped tokens
// to the new buffer, and puts the base pointer before them.
while(off>0&&parent.buffer[off-2]>parent.reducePos){off-=4;}var buffer=parent.buffer.slice(off),base=parent.bufferBase+off;// Make sure parent points to an actual parent with content, if there is such a parent.
while(parent&&base==parent.bufferBase){parent=parent.parent;}return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,buffer,base,this.curContext,this.lookAhead,parent);}// Try to recover from an error by 'deleting' (ignoring) one token.
/// @internal
},{key:"recoverByDelete",value:function recoverByDelete(next,nextEnd){var isNode=next<=this.p.parser.maxNode;if(isNode)this.storeNode(next,this.pos,nextEnd,4);this.storeNode(0/* Err */,this.pos,nextEnd,isNode?8:4);this.pos=this.reducePos=nextEnd;this.score-=190/* Delete */;}/// Check if the given term would be able to be shifted (optionally
/// after some reductions) on this stack. This can be useful for
/// external tokenizers that want to make sure they only provide a
/// given token when it applies.
},{key:"canShift",value:function canShift(term){for(var sim=new SimulatedStack(this);;){var action=this.p.parser.stateSlot(sim.state,4/* DefaultReduce */)||this.p.parser.hasAction(sim.state,term);if((action&65536/* ReduceFlag */)==0)return true;if(action==0)return false;sim.reduce(action);}}// Apply up to Recover.MaxNext recovery actions that conceptually
// inserts some missing token or rule.
/// @internal
},{key:"recoverByInsert",value:function recoverByInsert(next){if(this.stack.length>=300/* MaxInsertStackDepth */)return[];var nextStates=this.p.parser.nextStates(this.state);if(nextStates.length>4/* MaxNext */<<1||this.stack.length>=120/* DampenInsertStackDepth */){var best=[];for(var _i206=0,s;_i206<nextStates.length;_i206+=2){if((s=nextStates[_i206+1])!=this.state&&this.p.parser.hasAction(s,next))best.push(nextStates[_i206],s);}if(this.stack.length<120/* DampenInsertStackDepth */){var _loop18=function _loop18(_i207){var s=nextStates[_i207+1];if(!best.some(function(v,i){return i&1&&v==s;}))best.push(nextStates[_i207],s);};for(var _i207=0;best.length<4/* MaxNext */<<1&&_i207<nextStates.length;_i207+=2){_loop18(_i207);}}nextStates=best;}var result=[];for(var _i208=0;_i208<nextStates.length&&result.length<4/* MaxNext */;_i208+=2){var _s2=nextStates[_i208+1];if(_s2==this.state)continue;var stack=this.split();stack.pushState(_s2,this.pos);stack.storeNode(0/* Err */,stack.pos,stack.pos,4,true);stack.shiftContext(nextStates[_i208],this.pos);stack.score-=200/* Insert */;result.push(stack);}return result;}// Force a reduce, if possible. Return false if that can't
// be done.
/// @internal
},{key:"forceReduce",value:function forceReduce(){var reduce=this.p.parser.stateSlot(this.state,5/* ForcedReduce */);if((reduce&65536/* ReduceFlag */)==0)return false;var parser=this.p.parser;if(!parser.validAction(this.state,reduce)){var _depth2=reduce>>19/* ReduceDepthShift */,term=reduce&65535/* ValueMask */;var target=this.stack.length-_depth2*3;if(target<0||parser.getGoto(this.stack[target],term,false)<0)return false;this.storeNode(0/* Err */,this.reducePos,this.reducePos,4,true);this.score-=100/* Reduce */;}this.reducePos=this.pos;this.reduce(reduce);return true;}/// @internal
},{key:"forceAll",value:function forceAll(){while(!this.p.parser.stateFlag(this.state,2/* Accepting */)){if(!this.forceReduce()){this.storeNode(0/* Err */,this.pos,this.pos,4,true);break;}}return this;}/// Check whether this state has no further actions (assumed to be a direct descendant of the
/// top state, since any other states must be able to continue
/// somehow). @internal
},{key:"deadEnd",get:function get(){if(this.stack.length!=3)return false;var parser=this.p.parser;return parser.data[parser.stateSlot(this.state,1/* Actions */)]==65535/* End */&&!parser.stateSlot(this.state,4/* DefaultReduce */);}/// Restart the stack (put it back in its start state). Only safe
/// when this.stack.length == 3 (state is directly below the top
/// state). @internal
},{key:"restart",value:function restart(){this.state=this.stack[0];this.stack.length=0;}/// @internal
},{key:"sameState",value:function sameState(other){if(this.state!=other.state||this.stack.length!=other.stack.length)return false;for(var _i209=0;_i209<this.stack.length;_i209+=3){if(this.stack[_i209]!=other.stack[_i209])return false;}return true;}/// Get the parser used by this stack.
},{key:"parser",get:function get(){return this.p.parser;}/// Test whether a given dialect (by numeric ID, as exported from
/// the terms file) is enabled.
},{key:"dialectEnabled",value:function dialectEnabled(dialectID){return this.p.parser.dialect.flags[dialectID];}},{key:"shiftContext",value:function shiftContext(term,start){if(this.curContext)this.updateContext(this.curContext.tracker.shift(this.curContext.context,term,this,this.p.stream.reset(start)));}},{key:"reduceContext",value:function reduceContext(term,start){if(this.curContext)this.updateContext(this.curContext.tracker.reduce(this.curContext.context,term,this,this.p.stream.reset(start)));}/// @internal
},{key:"emitContext",value:function emitContext(){var last=this.buffer.length-1;if(last<0||this.buffer[last]!=-3)this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3);}/// @internal
},{key:"emitLookAhead",value:function emitLookAhead(){var last=this.buffer.length-1;if(last<0||this.buffer[last]!=-4)this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4);}},{key:"updateContext",value:function updateContext(context){if(context!=this.curContext.context){var newCx=new StackContext(this.curContext.tracker,context);if(newCx.hash!=this.curContext.hash)this.emitContext();this.curContext=newCx;}}/// @internal
},{key:"setLookAhead",value:function setLookAhead(lookAhead){if(lookAhead>this.lookAhead){this.emitLookAhead();this.lookAhead=lookAhead;}}/// @internal
},{key:"close",value:function close(){if(this.curContext&&this.curContext.tracker.strict)this.emitContext();if(this.lookAhead>0)this.emitLookAhead();}}],[{key:"start",value:function start(p,state){var pos=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var cx=p.parser.context;return new Stack(p,[],state,pos,pos,0,[],0,cx?new StackContext(cx,cx.start):null,0,null);}}]);return Stack;}();var StackContext=/*#__PURE__*/_createClass(function StackContext(tracker,context){_classCallCheck(this,StackContext);this.tracker=tracker;this.context=context;this.hash=tracker.strict?tracker.hash(context):0;});var Recover;(function(Recover){Recover[Recover["Insert"]=200]="Insert";Recover[Recover["Delete"]=190]="Delete";Recover[Recover["Reduce"]=100]="Reduce";Recover[Recover["MaxNext"]=4]="MaxNext";Recover[Recover["MaxInsertStackDepth"]=300]="MaxInsertStackDepth";Recover[Recover["DampenInsertStackDepth"]=120]="DampenInsertStackDepth";})(Recover||(Recover={}));// Used to cheaply run some reductions to scan ahead without mutating
// an entire stack
var SimulatedStack=/*#__PURE__*/function(){function SimulatedStack(start){_classCallCheck(this,SimulatedStack);this.start=start;this.state=start.state;this.stack=start.stack;this.base=this.stack.length;}_createClass(SimulatedStack,[{key:"reduce",value:function reduce(action){var term=action&65535/* ValueMask */,depth=action>>19/* ReduceDepthShift */;if(depth==0){if(this.stack==this.start.stack)this.stack=this.stack.slice();this.stack.push(this.state,0,0);this.base+=3;}else{this.base-=(depth-1)*3;}var _goto=this.start.p.parser.getGoto(this.stack[this.base-3],term,true);this.state=_goto;}}]);return SimulatedStack;}();// This is given to `Tree.build` to build a buffer, and encapsulates
// the parent-stack-walking necessary to read the nodes.
var StackBufferCursor=/*#__PURE__*/function(){function StackBufferCursor(stack,pos,index){_classCallCheck(this,StackBufferCursor);this.stack=stack;this.pos=pos;this.index=index;this.buffer=stack.buffer;if(this.index==0)this.maybeNext();}_createClass(StackBufferCursor,[{key:"maybeNext",value:function maybeNext(){var next=this.stack.parent;if(next!=null){this.index=this.stack.bufferBase-next.bufferBase;this.stack=next;this.buffer=next.buffer;}}},{key:"id",get:function get(){return this.buffer[this.index-4];}},{key:"start",get:function get(){return this.buffer[this.index-3];}},{key:"end",get:function get(){return this.buffer[this.index-2];}},{key:"size",get:function get(){return this.buffer[this.index-1];}},{key:"next",value:function next(){this.index-=4;this.pos-=4;if(this.index==0)this.maybeNext();}},{key:"fork",value:function fork(){return new StackBufferCursor(this.stack,this.pos,this.index);}}],[{key:"create",value:function create(stack){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:stack.bufferBase+stack.buffer.length;return new StackBufferCursor(stack,pos,pos-stack.bufferBase);}}]);return StackBufferCursor;}();var CachedToken=/*#__PURE__*/_createClass(function CachedToken(){_classCallCheck(this,CachedToken);this.start=-1;this.value=-1;this.end=-1;this.extended=-1;this.lookAhead=0;this.mask=0;this.context=0;});var nullToken=new CachedToken();/// [Tokenizers](#lr.ExternalTokenizer) interact with the input
/// through this interface. It presents the input as a stream of
/// characters, tracking lookahead and hiding the complexity of
/// [ranges](#common.Parser.parse^ranges) from tokenizer code.
var InputStream=/*#__PURE__*/function(){/// @internal
function InputStream(/// @internal
input,/// @internal
ranges){_classCallCheck(this,InputStream);this.input=input;this.ranges=ranges;/// @internal
this.chunk="";/// @internal
this.chunkOff=0;/// Backup chunk
this.chunk2="";this.chunk2Pos=0;/// The character code of the next code unit in the input, or -1
/// when the stream is at the end of the input.
this.next=-1;/// @internal
this.token=nullToken;this.rangeIndex=0;this.pos=this.chunkPos=ranges[0].from;this.range=ranges[0];this.end=ranges[ranges.length-1].to;this.readNext();}/// @internal
_createClass(InputStream,[{key:"resolveOffset",value:function resolveOffset(offset,assoc){var range=this.range,index=this.rangeIndex;var pos=this.pos+offset;while(pos<range.from){if(!index)return null;var next=this.ranges[--index];pos-=range.from-next.to;range=next;}while(assoc<0?pos>range.to:pos>=range.to){if(index==this.ranges.length-1)return null;var _next4=this.ranges[++index];pos+=_next4.from-range.to;range=_next4;}return pos;}/// @internal
},{key:"clipPos",value:function clipPos(pos){if(pos>=this.range.from&&pos<this.range.to)return pos;var _iterator207=_createForOfIteratorHelper(this.ranges),_step207;try{for(_iterator207.s();!(_step207=_iterator207.n()).done;){var _range18=_step207.value;if(_range18.to>pos)return Math.max(pos,_range18.from);}}catch(err){_iterator207.e(err);}finally{_iterator207.f();}return this.end;}/// Look at a code unit near the stream position. `.peek(0)` equals
/// `.next`, `.peek(-1)` gives you the previous character, and so
/// on.
///
/// Note that looking around during tokenizing creates dependencies
/// on potentially far-away content, which may reduce the
/// effectiveness incremental parsingwhen looking forwardor even
/// cause invalid reparses when looking backward more than 25 code
/// units, since the library does not track lookbehind.
},{key:"peek",value:function peek(offset){var idx=this.chunkOff+offset,pos,result;if(idx>=0&&idx<this.chunk.length){pos=this.pos+offset;result=this.chunk.charCodeAt(idx);}else{var resolved=this.resolveOffset(offset,1);if(resolved==null)return-1;pos=resolved;if(pos>=this.chunk2Pos&&pos<this.chunk2Pos+this.chunk2.length){result=this.chunk2.charCodeAt(pos-this.chunk2Pos);}else{var _i210=this.rangeIndex,_range19=this.range;while(_range19.to<=pos){_range19=this.ranges[++_i210];}this.chunk2=this.input.chunk(this.chunk2Pos=pos);if(pos+this.chunk2.length>_range19.to)this.chunk2=this.chunk2.slice(0,_range19.to-pos);result=this.chunk2.charCodeAt(0);}}if(pos>=this.token.lookAhead)this.token.lookAhead=pos+1;return result;}/// Accept a token. By default, the end of the token is set to the
/// current stream position, but you can pass an offset (relative to
/// the stream position) to change that.
},{key:"acceptToken",value:function acceptToken(token){var endOffset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var end=endOffset?this.resolveOffset(endOffset,-1):this.pos;if(end==null||end<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=token;this.token.end=end;}},{key:"getChunk",value:function getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){var _chunk5=this.chunk,chunkPos=this.chunkPos;this.chunk=this.chunk2;this.chunkPos=this.chunk2Pos;this.chunk2=_chunk5;this.chunk2Pos=chunkPos;this.chunkOff=this.pos-this.chunkPos;}else{this.chunk2=this.chunk;this.chunk2Pos=this.chunkPos;var nextChunk=this.input.chunk(this.pos);var end=this.pos+nextChunk.length;this.chunk=end>this.range.to?nextChunk.slice(0,this.range.to-this.pos):nextChunk;this.chunkPos=this.pos;this.chunkOff=0;}}},{key:"readNext",value:function readNext(){if(this.chunkOff>=this.chunk.length){this.getChunk();if(this.chunkOff==this.chunk.length)return this.next=-1;}return this.next=this.chunk.charCodeAt(this.chunkOff);}/// Move the stream forward N (defaults to 1) code units. Returns
/// the new value of [`next`](#lr.InputStream.next).
},{key:"advance",value:function advance(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.chunkOff+=n;while(this.pos+n>=this.range.to){if(this.rangeIndex==this.ranges.length-1)return this.setDone();n-=this.range.to-this.pos;this.range=this.ranges[++this.rangeIndex];this.pos=this.range.from;}this.pos+=n;if(this.pos>=this.token.lookAhead)this.token.lookAhead=this.pos+1;return this.readNext();}},{key:"setDone",value:function setDone(){this.pos=this.chunkPos=this.end;this.range=this.ranges[this.rangeIndex=this.ranges.length-1];this.chunk="";return this.next=-1;}/// @internal
},{key:"reset",value:function reset(pos,token){if(token){this.token=token;token.start=pos;token.lookAhead=pos+1;token.value=token.extended=-1;}else{this.token=nullToken;}if(this.pos!=pos){this.pos=pos;if(pos==this.end){this.setDone();return this;}while(pos<this.range.from){this.range=this.ranges[--this.rangeIndex];}while(pos>=this.range.to){this.range=this.ranges[++this.rangeIndex];}if(pos>=this.chunkPos&&pos<this.chunkPos+this.chunk.length){this.chunkOff=pos-this.chunkPos;}else{this.chunk="";this.chunkOff=0;}this.readNext();}return this;}/// @internal
},{key:"read",value:function read(from,to){if(from>=this.chunkPos&&to<=this.chunkPos+this.chunk.length)return this.chunk.slice(from-this.chunkPos,to-this.chunkPos);if(from>=this.chunk2Pos&&to<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(from-this.chunk2Pos,to-this.chunk2Pos);if(from>=this.range.from&&to<=this.range.to)return this.input.read(from,to);var result="";var _iterator208=_createForOfIteratorHelper(this.ranges),_step208;try{for(_iterator208.s();!(_step208=_iterator208.n()).done;){var _r14=_step208.value;if(_r14.from>=to)break;if(_r14.to>from)result+=this.input.read(Math.max(_r14.from,from),Math.min(_r14.to,to));}}catch(err){_iterator208.e(err);}finally{_iterator208.f();}return result;}}]);return InputStream;}();/// @internal
var TokenGroup=/*#__PURE__*/function(){function TokenGroup(data,id){_classCallCheck(this,TokenGroup);this.data=data;this.id=id;}_createClass(TokenGroup,[{key:"token",value:function token(input,stack){readToken(this.data,input,stack,this.id);}}]);return TokenGroup;}();TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=false;// Tokenizer data is stored a big uint16 array containing, for each
// state:
//
//  - A group bitmask, indicating what token groups are reachable from
//    this state, so that paths that can only lead to tokens not in
//    any of the current groups can be cut off early.
//
//  - The position of the end of the state's sequence of accepting
//    tokens
//
//  - The number of outgoing edges for the state
//
//  - The accepting tokens, as (token id, group mask) pairs
//
//  - The outgoing edges, as (start character, end character, state
//    index) triples, with end character being exclusive
//
// This function interprets that data, running through a stream as
// long as new states with the a matching group mask can be reached,
// and updating `input.token` when it matches a token.
function readToken(data,input,stack,group){var state=0,groupMask=1<<group,parser=stack.p.parser,dialect=parser.dialect;scan:for(;;){if((groupMask&data[state])==0)break;var accEnd=data[state+1];// Check whether this state can lead to a token in the current group
// Accept tokens in this state, possibly overwriting
// lower-precedence / shorter tokens
for(var _i211=state+3;_i211<accEnd;_i211+=2){if((data[_i211+1]&groupMask)>0){var term=data[_i211];if(dialect.allows(term)&&(input.token.value==-1||input.token.value==term||parser.overrides(term,input.token.value))){input.acceptToken(term);break;}}}var next=input.next,low=0,high=data[state+2];// Special case for EOF
if(input.next<0&&high>low&&data[accEnd+high*3-3]==65535/* End */){state=data[accEnd+high*3-1];continue scan;}// Do a binary search on the state's edges
for(;low<high;){var mid=low+high>>1;var index=accEnd+mid+(mid<<1);var from=data[index],to=data[index+1];if(next<from)high=mid;else if(next>=to)low=mid+1;else{state=data[index+2];input.advance();continue scan;}}break;}}// See lezer-generator/src/encode.ts for comments about the encoding
// used here
function decodeArray(input){var Type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Uint16Array;if(typeof input!="string")return input;var array=null;for(var pos=0,out=0;pos<input.length;){var value=0;for(;;){var next=input.charCodeAt(pos++),stop=false;if(next==126/* BigValCode */){value=65535/* BigVal */;break;}if(next>=92/* Gap2 */)next--;if(next>=34/* Gap1 */)next--;var digit=next-32/* Start */;if(digit>=46/* Base */){digit-=46/* Base */;stop=true;}value+=digit;if(stop)break;value*=46/* Base */;}if(array)array[out++]=value;else array=new Type(value);}return array;}// Environment variable used to control console output
var verbose=typeof process!="undefined"&&process.env&&/\bparse\b/.test(process.env.LOG);var stackIDs=null;var Safety;(function(Safety){Safety[Safety["Margin"]=25]="Margin";})(Safety||(Safety={}));function cutAt(tree,pos,side){var cursor=tree.cursor(IterMode.IncludeAnonymous);cursor.moveTo(pos);for(;;){if(!(side<0?cursor.childBefore(pos):cursor.childAfter(pos)))for(;;){if((side<0?cursor.to<pos:cursor.from>pos)&&!cursor.type.isError)return side<0?Math.max(0,Math.min(cursor.to-1,pos-25/* Margin */)):Math.min(tree.length,Math.max(cursor.from+1,pos+25/* Margin */));if(side<0?cursor.prevSibling():cursor.nextSibling())break;if(!cursor.parent())return side<0?0:tree.length;}}}var FragmentCursor=/*#__PURE__*/function(){function FragmentCursor(fragments,nodeSet){_classCallCheck(this,FragmentCursor);this.fragments=fragments;this.nodeSet=nodeSet;this.i=0;this.fragment=null;this.safeFrom=-1;this.safeTo=-1;this.trees=[];this.start=[];this.index=[];this.nextFragment();}_createClass(FragmentCursor,[{key:"nextFragment",value:function nextFragment(){var fr=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(fr){this.safeFrom=fr.openStart?cutAt(fr.tree,fr.from+fr.offset,1)-fr.offset:fr.from;this.safeTo=fr.openEnd?cutAt(fr.tree,fr.to+fr.offset,-1)-fr.offset:fr.to;while(this.trees.length){this.trees.pop();this.start.pop();this.index.pop();}this.trees.push(fr.tree);this.start.push(-fr.offset);this.index.push(0);this.nextStart=this.safeFrom;}else{this.nextStart=1e9;}}// `pos` must be >= any previously given `pos` for this cursor
},{key:"nodeAt",value:function nodeAt(pos){if(pos<this.nextStart)return null;while(this.fragment&&this.safeTo<=pos){this.nextFragment();}if(!this.fragment)return null;for(;;){var _last12=this.trees.length-1;if(_last12<0){// End of tree
this.nextFragment();return null;}var _top13=this.trees[_last12],index=this.index[_last12];if(index==_top13.children.length){this.trees.pop();this.start.pop();this.index.pop();continue;}var next=_top13.children[index];var start=this.start[_last12]+_top13.positions[index];if(start>pos){this.nextStart=start;return null;}if(next instanceof Tree){if(start==pos){if(start<this.safeFrom)return null;var end=start+next.length;if(end<=this.safeTo){var lookAhead=next.prop(NodeProp.lookAhead);if(!lookAhead||end+lookAhead<this.fragment.to)return next;}}this.index[_last12]++;if(start+next.length>=Math.max(this.safeFrom,pos)){// Enter this node
this.trees.push(next);this.start.push(start);this.index.push(0);}}else{this.index[_last12]++;this.nextStart=start+next.length;}}}}]);return FragmentCursor;}();var TokenCache=/*#__PURE__*/function(){function TokenCache(parser,stream){_classCallCheck(this,TokenCache);this.stream=stream;this.tokens=[];this.mainToken=null;this.actions=[];this.tokens=parser.tokenizers.map(function(_){return new CachedToken();});}_createClass(TokenCache,[{key:"getActions",value:function getActions(stack){var actionIndex=0;var main=null;var parser=stack.p.parser,tokenizers=parser.tokenizers;var mask=parser.stateSlot(stack.state,3/* TokenizerMask */);var context=stack.curContext?stack.curContext.hash:0;var lookAhead=0;for(var _i212=0;_i212<tokenizers.length;_i212++){if((1<<_i212&mask)==0)continue;var tokenizer=tokenizers[_i212],token=this.tokens[_i212];if(main&&!tokenizer.fallback)continue;if(tokenizer.contextual||token.start!=stack.pos||token.mask!=mask||token.context!=context){this.updateCachedToken(token,tokenizer,stack);token.mask=mask;token.context=context;}if(token.lookAhead>token.end+25/* Margin */)lookAhead=Math.max(token.lookAhead,lookAhead);if(token.value!=0/* Err */){var startIndex=actionIndex;if(token.extended>-1)actionIndex=this.addActions(stack,token.extended,token.end,actionIndex);actionIndex=this.addActions(stack,token.value,token.end,actionIndex);if(!tokenizer.extend){main=token;if(actionIndex>startIndex)break;}}}while(this.actions.length>actionIndex){this.actions.pop();}if(lookAhead)stack.setLookAhead(lookAhead);if(!main&&stack.pos==this.stream.end){main=new CachedToken();main.value=stack.p.parser.eofTerm;main.start=main.end=stack.pos;actionIndex=this.addActions(stack,main.value,main.end,actionIndex);}this.mainToken=main;return this.actions;}},{key:"getMainToken",value:function getMainToken(stack){if(this.mainToken)return this.mainToken;var main=new CachedToken(),pos=stack.pos,p=stack.p;main.start=pos;main.end=Math.min(pos+1,p.stream.end);main.value=pos==p.stream.end?p.parser.eofTerm:0/* Err */;return main;}},{key:"updateCachedToken",value:function updateCachedToken(token,tokenizer,stack){var start=this.stream.clipPos(stack.pos);tokenizer.token(this.stream.reset(start,token),stack);if(token.value>-1){var _parser2=stack.p.parser;for(var _i213=0;_i213<_parser2.specialized.length;_i213++){if(_parser2.specialized[_i213]==token.value){var _result9=_parser2.specializers[_i213](this.stream.read(token.start,token.end),stack);if(_result9>=0&&stack.p.parser.dialect.allows(_result9>>1)){if((_result9&1)==0/* Specialize */)token.value=_result9>>1;else token.extended=_result9>>1;break;}}}}else{token.value=0/* Err */;token.end=this.stream.clipPos(start+1);}}},{key:"putAction",value:function putAction(action,token,end,index){// Don't add duplicate actions
for(var _i214=0;_i214<index;_i214+=3){if(this.actions[_i214]==action)return index;}this.actions[index++]=action;this.actions[index++]=token;this.actions[index++]=end;return index;}},{key:"addActions",value:function addActions(stack,token,end,index){var state=stack.state,parser=stack.p.parser,data=parser.data;for(var _set6=0;_set6<2;_set6++){for(var _i215=parser.stateSlot(state,_set6?2/* Skip */:1/* Actions */);;_i215+=3){if(data[_i215]==65535/* End */){if(data[_i215+1]==1/* Next */){_i215=pair(data,_i215+2);}else{if(index==0&&data[_i215+1]==2/* Other */)index=this.putAction(pair(data,_i215+2),token,end,index);break;}}if(data[_i215]==token)index=this.putAction(pair(data,_i215+1),token,end,index);}}return index;}}]);return TokenCache;}();var Rec;(function(Rec){Rec[Rec["Distance"]=5]="Distance";Rec[Rec["MaxRemainingPerStep"]=3]="MaxRemainingPerStep";// When two stacks have been running independently long enough to
// add this many elements to their buffers, prune one.
Rec[Rec["MinBufferLengthPrune"]=500]="MinBufferLengthPrune";Rec[Rec["ForceReduceLimit"]=10]="ForceReduceLimit";// Once a stack reaches this depth (in .stack.length) force-reduce
// it back to CutTo to avoid creating trees that overflow the stack
// on recursive traversal.
Rec[Rec["CutDepth"]=15000]="CutDepth";Rec[Rec["CutTo"]=9000]="CutTo";})(Rec||(Rec={}));var Parse=/*#__PURE__*/function(){function Parse(parser,input,fragments,ranges){_classCallCheck(this,Parse);this.parser=parser;this.input=input;this.ranges=ranges;this.recovering=0;this.nextStackID=0x2654;// , , , , , , , , , , , , , 
this.minStackPos=0;this.reused=[];this.stoppedAt=null;this.stream=new InputStream(input,ranges);this.tokens=new TokenCache(parser,this.stream);this.topTerm=parser.top[1];var from=ranges[0].from;this.stacks=[Stack.start(this,parser.top[0],from)];this.fragments=fragments.length&&this.stream.end-from>parser.bufferLength*4?new FragmentCursor(fragments,parser.nodeSet):null;}_createClass(Parse,[{key:"parsedPos",get:function get(){return this.minStackPos;}// Move the parser forward. This will process all parse stacks at
// `this.pos` and try to advance them to a further position. If no
// stack for such a position is found, it'll start error-recovery.
//
// When the parse is finished, this will return a syntax tree. When
// not, it returns `null`.
},{key:"advance",value:function advance(){var stacks=this.stacks,pos=this.minStackPos;// This will hold stacks beyond `pos`.
var newStacks=this.stacks=[];var stopped,stoppedTokens;// Keep advancing any stacks at `pos` until they either move
// forward or can't be advanced. Gather stacks that can't be
// advanced further in `stopped`.
for(var _i216=0;_i216<stacks.length;_i216++){var stack=stacks[_i216];for(;;){this.tokens.mainToken=null;if(stack.pos>pos){newStacks.push(stack);}else if(this.advanceStack(stack,newStacks,stacks)){continue;}else{if(!stopped){stopped=[];stoppedTokens=[];}stopped.push(stack);var tok=this.tokens.getMainToken(stack);stoppedTokens.push(tok.value,tok.end);}break;}}if(!newStacks.length){var finished=stopped&&findFinished(stopped);if(finished)return this.stackToTree(finished);if(this.parser.strict){if(verbose&&stopped)console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none"));throw new SyntaxError("No parse at "+pos);}if(!this.recovering)this.recovering=5/* Distance */;}if(this.recovering&&stopped){var _finished=this.stoppedAt!=null&&stopped[0].pos>this.stoppedAt?stopped[0]:this.runRecovery(stopped,stoppedTokens,newStacks);if(_finished)return this.stackToTree(_finished.forceAll());}if(this.recovering){var maxRemaining=this.recovering==1?1:this.recovering*3/* MaxRemainingPerStep */;if(newStacks.length>maxRemaining){newStacks.sort(function(a,b){return b.score-a.score;});while(newStacks.length>maxRemaining){newStacks.pop();}}if(newStacks.some(function(s){return s.reducePos>pos;}))this.recovering--;}else if(newStacks.length>1){// Prune stacks that are in the same state, or that have been
// running without splitting for a while, to avoid getting stuck
// with multiple successful stacks running endlessly on.
outer:for(var _i217=0;_i217<newStacks.length-1;_i217++){var _stack=newStacks[_i217];for(var j=_i217+1;j<newStacks.length;j++){var other=newStacks[j];if(_stack.sameState(other)||_stack.buffer.length>500/* MinBufferLengthPrune */&&other.buffer.length>500/* MinBufferLengthPrune */){if((_stack.score-other.score||_stack.buffer.length-other.buffer.length)>0){newStacks.splice(j--,1);}else{newStacks.splice(_i217--,1);continue outer;}}}}}this.minStackPos=newStacks[0].pos;for(var _i218=1;_i218<newStacks.length;_i218++){if(newStacks[_i218].pos<this.minStackPos)this.minStackPos=newStacks[_i218].pos;}return null;}},{key:"stopAt",value:function stopAt(pos){if(this.stoppedAt!=null&&this.stoppedAt<pos)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=pos;}// Returns an updated version of the given stack, or null if the
// stack can't advance normally. When `split` and `stacks` are
// given, stacks split off by ambiguous operations will be pushed to
// `split`, or added to `stacks` if they move `pos` forward.
},{key:"advanceStack",value:function advanceStack(stack,stacks,split){var start=stack.pos,parser=this.parser;var base=verbose?this.stackID(stack)+" -> ":"";if(this.stoppedAt!=null&&start>this.stoppedAt)return stack.forceReduce()?stack:null;if(this.fragments){var strictCx=stack.curContext&&stack.curContext.tracker.strict,cxHash=strictCx?stack.curContext.hash:0;for(var cached=this.fragments.nodeAt(start);cached;){var match=this.parser.nodeSet.types[cached.type.id]==cached.type?parser.getGoto(stack.state,cached.type.id):-1;if(match>-1&&cached.length&&(!strictCx||(cached.prop(NodeProp.contextHash)||0)==cxHash)){stack.useNode(cached,match);if(verbose)console.log(base+this.stackID(stack)+" (via reuse of ".concat(parser.getName(cached.type.id),")"));return true;}if(!(cached instanceof Tree)||cached.children.length==0||cached.positions[0]>0)break;var inner=cached.children[0];if(inner instanceof Tree&&cached.positions[0]==0)cached=inner;else break;}}var defaultReduce=parser.stateSlot(stack.state,4/* DefaultReduce */);if(defaultReduce>0){stack.reduce(defaultReduce);if(verbose)console.log(base+this.stackID(stack)+" (via always-reduce ".concat(parser.getName(defaultReduce&65535/* ValueMask */),")"));return true;}if(stack.stack.length>=15000/* CutDepth */){while(stack.stack.length>9000/* CutTo */&&stack.forceReduce()){}}var actions=this.tokens.getActions(stack);for(var _i219=0;_i219<actions.length;){var action=actions[_i219++],term=actions[_i219++],end=actions[_i219++];var _last13=_i219==actions.length||!split;var localStack=_last13?stack:stack.split();localStack.apply(action,term,end);if(verbose)console.log(base+this.stackID(localStack)+" (via ".concat((action&65536/* ReduceFlag */)==0?"shift":"reduce of ".concat(parser.getName(action&65535/* ValueMask */))," for ").concat(parser.getName(term)," @ ").concat(start).concat(localStack==stack?"":", split",")"));if(_last13)return true;else if(localStack.pos>start)stacks.push(localStack);else split.push(localStack);}return false;}// Advance a given stack forward as far as it will go. Returns the
// (possibly updated) stack if it got stuck, or null if it moved
// forward and was given to `pushStackDedup`.
},{key:"advanceFully",value:function advanceFully(stack,newStacks){var pos=stack.pos;for(;;){if(!this.advanceStack(stack,null,null))return false;if(stack.pos>pos){pushStackDedup(stack,newStacks);return true;}}}},{key:"runRecovery",value:function runRecovery(stacks,tokens,newStacks){var finished=null,restarted=false;for(var _i220=0;_i220<stacks.length;_i220++){var stack=stacks[_i220],token=tokens[_i220<<1],tokenEnd=tokens[(_i220<<1)+1];var _base3=verbose?this.stackID(stack)+" -> ":"";if(stack.deadEnd){if(restarted)continue;restarted=true;stack.restart();if(verbose)console.log(_base3+this.stackID(stack)+" (restarted)");var done=this.advanceFully(stack,newStacks);if(done)continue;}var force=stack.split(),forceBase=_base3;for(var j=0;force.forceReduce()&&j<10/* ForceReduceLimit */;j++){if(verbose)console.log(forceBase+this.stackID(force)+" (via force-reduce)");var _done=this.advanceFully(force,newStacks);if(_done)break;if(verbose)forceBase=this.stackID(force)+" -> ";}var _iterator209=_createForOfIteratorHelper(stack.recoverByInsert(token)),_step209;try{for(_iterator209.s();!(_step209=_iterator209.n()).done;){var _insert2=_step209.value;if(verbose)console.log(_base3+this.stackID(_insert2)+" (via recover-insert)");this.advanceFully(_insert2,newStacks);}}catch(err){_iterator209.e(err);}finally{_iterator209.f();}if(this.stream.end>stack.pos){if(tokenEnd==stack.pos){tokenEnd++;token=0/* Err */;}stack.recoverByDelete(token,tokenEnd);if(verbose)console.log(_base3+this.stackID(stack)+" (via recover-delete ".concat(this.parser.getName(token),")"));pushStackDedup(stack,newStacks);}else if(!finished||finished.score<stack.score){finished=stack;}}return finished;}// Convert the stack's buffer to a syntax tree.
},{key:"stackToTree",value:function stackToTree(stack){stack.close();return Tree.build({buffer:StackBufferCursor.create(stack),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:stack.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm});}},{key:"stackID",value:function stackID(stack){var id=(stackIDs||(stackIDs=new WeakMap())).get(stack);if(!id)stackIDs.set(stack,id=String.fromCodePoint(this.nextStackID++));return id+stack;}}]);return Parse;}();function pushStackDedup(stack,newStacks){for(var _i221=0;_i221<newStacks.length;_i221++){var other=newStacks[_i221];if(other.pos==stack.pos&&other.sameState(stack)){if(newStacks[_i221].score<stack.score)newStacks[_i221]=stack;return;}}newStacks.push(stack);}var Dialect=/*#__PURE__*/function(){function Dialect(source,flags,disabled){_classCallCheck(this,Dialect);this.source=source;this.flags=flags;this.disabled=disabled;}_createClass(Dialect,[{key:"allows",value:function allows(term){return!this.disabled||this.disabled[term]==0;}}]);return Dialect;}();/// Holds the parse tables for a given grammar, as generated by
/// `lezer-generator`, and provides [methods](#common.Parser) to parse
/// content with.
var LRParser=/*#__PURE__*/function(_Parser2){_inherits(LRParser,_Parser2);var _super54=_createSuper(LRParser);/// @internal
function LRParser(spec){var _this107$nodeSet;var _this107;_classCallCheck(this,LRParser);_this107=_super54.call(this);/// @internal
_this107.wrappers=[];if(spec.version!=14/* Version */)throw new RangeError("Parser version (".concat(spec.version,") doesn't match runtime version (",14/* Version */,")"));var nodeNames=spec.nodeNames.split(" ");_this107.minRepeatTerm=nodeNames.length;for(var _i222=0;_i222<spec.repeatNodeCount;_i222++){nodeNames.push("");}var topTerms=Object.keys(spec.topRules).map(function(r){return spec.topRules[r][1];});var nodeProps=[];for(var _i223=0;_i223<nodeNames.length;_i223++){nodeProps.push([]);}function setProp(nodeID,prop,value){nodeProps[nodeID].push([prop,prop.deserialize(String(value))]);}if(spec.nodeProps){var _iterator210=_createForOfIteratorHelper(spec.nodeProps),_step210;try{for(_iterator210.s();!(_step210=_iterator210.n()).done;){var propSpec=_step210.value;var prop=propSpec[0];if(typeof prop=="string")prop=NodeProp[prop];for(var _i224=1;_i224<propSpec.length;){var next=propSpec[_i224++];if(next>=0){setProp(next,prop,propSpec[_i224++]);}else{var value=propSpec[_i224+-next];for(var j=-next;j>0;j--){setProp(propSpec[_i224++],prop,value);}_i224++;}}}}catch(err){_iterator210.e(err);}finally{_iterator210.f();}}_this107.nodeSet=new NodeSet(nodeNames.map(function(name,i){return NodeType.define({name:i>=_this107.minRepeatTerm?undefined:name,id:i,props:nodeProps[i],top:topTerms.indexOf(i)>-1,error:i==0,skipped:spec.skippedNodes&&spec.skippedNodes.indexOf(i)>-1});}));if(spec.propSources)_this107.nodeSet=(_this107$nodeSet=_this107.nodeSet).extend.apply(_this107$nodeSet,_toConsumableArray2(spec.propSources));_this107.strict=false;_this107.bufferLength=DefaultBufferLength;var tokenArray=decodeArray(spec.tokenData);_this107.context=spec.context;_this107.specializerSpecs=spec.specialized||[];_this107.specialized=new Uint16Array(_this107.specializerSpecs.length);for(var _i225=0;_i225<_this107.specializerSpecs.length;_i225++){_this107.specialized[_i225]=_this107.specializerSpecs[_i225].term;}_this107.specializers=_this107.specializerSpecs.map(getSpecializer);_this107.states=decodeArray(spec.states,Uint32Array);_this107.data=decodeArray(spec.stateData);_this107["goto"]=decodeArray(spec["goto"]);_this107.maxTerm=spec.maxTerm;_this107.tokenizers=spec.tokenizers.map(function(value){return typeof value=="number"?new TokenGroup(tokenArray,value):value;});_this107.topRules=spec.topRules;_this107.dialects=spec.dialects||{};_this107.dynamicPrecedences=spec.dynamicPrecedences||null;_this107.tokenPrecTable=spec.tokenPrec;_this107.termNames=spec.termNames||null;_this107.maxNode=_this107.nodeSet.types.length-1;_this107.dialect=_this107.parseDialect();_this107.top=_this107.topRules[Object.keys(_this107.topRules)[0]];return _this107;}_createClass(LRParser,[{key:"createParse",value:function createParse(input,fragments,ranges){var parse=new Parse(this,input,fragments,ranges);var _iterator211=_createForOfIteratorHelper(this.wrappers),_step211;try{for(_iterator211.s();!(_step211=_iterator211.n()).done;){var w=_step211.value;parse=w(parse,input,fragments,ranges);}}catch(err){_iterator211.e(err);}finally{_iterator211.f();}return parse;}/// Get a goto table entry @internal
},{key:"getGoto",value:function getGoto(state,term){var loose=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var table=this["goto"];if(term>=table[0])return-1;for(var pos=table[term+1];;){var groupTag=table[pos++],_last14=groupTag&1;var target=table[pos++];if(_last14&&loose)return target;for(var end=pos+(groupTag>>1);pos<end;pos++){if(table[pos]==state)return target;}if(_last14)return-1;}}/// Check if this state has an action for a given terminal @internal
},{key:"hasAction",value:function hasAction(state,terminal){var data=this.data;for(var _set7=0;_set7<2;_set7++){for(var _i226=this.stateSlot(state,_set7?2/* Skip */:1/* Actions */),next;;_i226+=3){if((next=data[_i226])==65535/* End */){if(data[_i226+1]==1/* Next */)next=data[_i226=pair(data,_i226+2)];else if(data[_i226+1]==2/* Other */)return pair(data,_i226+2);else break;}if(next==terminal||next==0/* Err */)return pair(data,_i226+1);}}return 0;}/// @internal
},{key:"stateSlot",value:function stateSlot(state,slot){return this.states[state*6/* Size */+slot];}/// @internal
},{key:"stateFlag",value:function stateFlag(state,flag){return(this.stateSlot(state,0/* Flags */)&flag)>0;}/// @internal
},{key:"validAction",value:function validAction(state,action){if(action==this.stateSlot(state,4/* DefaultReduce */))return true;for(var _i227=this.stateSlot(state,1/* Actions */);;_i227+=3){if(this.data[_i227]==65535/* End */){if(this.data[_i227+1]==1/* Next */)_i227=pair(this.data,_i227+2);else return false;}if(action==pair(this.data,_i227+1))return true;}}/// Get the states that can follow this one through shift actions or
/// goto jumps. @internal
},{key:"nextStates",value:function nextStates(state){var _this108=this;var result=[];for(var _i228=this.stateSlot(state,1/* Actions */);;_i228+=3){if(this.data[_i228]==65535/* End */){if(this.data[_i228+1]==1/* Next */)_i228=pair(this.data,_i228+2);else break;}if((this.data[_i228+2]&65536/* ReduceFlag */>>16)==0){(function(){var value=_this108.data[_i228+1];if(!result.some(function(v,i){return i&1&&v==value;}))result.push(_this108.data[_i228],value);})();}}return result;}/// @internal
},{key:"overrides",value:function overrides(token,prev){var iPrev=findOffset(this.data,this.tokenPrecTable,prev);return iPrev<0||findOffset(this.data,this.tokenPrecTable,token)<iPrev;}/// Configure the parser. Returns a new parser instance that has the
/// given settings modified. Settings not provided in `config` are
/// kept from the original parser.
},{key:"configure",value:function configure(config){var _this$nodeSet;// Hideous reflection-based kludge to make it easy to create a
// slightly modified copy of a parser.
var copy=Object.assign(Object.create(LRParser.prototype),this);if(config.props)copy.nodeSet=(_this$nodeSet=this.nodeSet).extend.apply(_this$nodeSet,_toConsumableArray2(config.props));if(config.top){var info=this.topRules[config.top];if(!info)throw new RangeError("Invalid top rule name ".concat(config.top));copy.top=info;}if(config.tokenizers)copy.tokenizers=this.tokenizers.map(function(t){var found=config.tokenizers.find(function(r){return r.from==t;});return found?found.to:t;});if(config.specializers){copy.specializers=this.specializers.slice();copy.specializerSpecs=this.specializerSpecs.map(function(s,i){var found=config.specializers.find(function(r){return r.from==s.external;});if(!found)return s;var spec=Object.assign(Object.assign({},s),{external:found.to});copy.specializers[i]=getSpecializer(spec);return spec;});}if(config.contextTracker)copy.context=config.contextTracker;if(config.dialect)copy.dialect=this.parseDialect(config.dialect);if(config.strict!=null)copy.strict=config.strict;if(config.wrap)copy.wrappers=copy.wrappers.concat(config.wrap);if(config.bufferLength!=null)copy.bufferLength=config.bufferLength;return copy;}/// Tells you whether any [parse wrappers](#lr.ParserConfig.wrap)
/// are registered for this parser.
},{key:"hasWrappers",value:function hasWrappers(){return this.wrappers.length>0;}/// Returns the name associated with a given term. This will only
/// work for all terms when the parser was generated with the
/// `--names` option. By default, only the names of tagged terms are
/// stored.
},{key:"getName",value:function getName(term){return this.termNames?this.termNames[term]:String(term<=this.maxNode&&this.nodeSet.types[term].name||term);}/// The eof term id is always allocated directly after the node
/// types. @internal
},{key:"eofTerm",get:function get(){return this.maxNode+1;}/// The type of top node produced by the parser.
},{key:"topNode",get:function get(){return this.nodeSet.types[this.top[1]];}/// @internal
},{key:"dynamicPrecedence",value:function dynamicPrecedence(term){var prec=this.dynamicPrecedences;return prec==null?0:prec[term]||0;}/// @internal
},{key:"parseDialect",value:function parseDialect(dialect){var values=Object.keys(this.dialects),flags=values.map(function(){return false;});if(dialect){var _iterator212=_createForOfIteratorHelper(dialect.split(" ")),_step212;try{for(_iterator212.s();!(_step212=_iterator212.n()).done;){var part=_step212.value;var _id3=values.indexOf(part);if(_id3>=0)flags[_id3]=true;}}catch(err){_iterator212.e(err);}finally{_iterator212.f();}}var disabled=null;for(var _i229=0;_i229<values.length;_i229++){if(!flags[_i229]){for(var j=this.dialects[values[_i229]],_id4;(_id4=this.data[j++])!=65535/* End */;){(disabled||(disabled=new Uint8Array(this.maxTerm+1)))[_id4]=1;}}}return new Dialect(dialect,flags,disabled);}/// Used by the output of the parser generator. Not available to
/// user code.
}],[{key:"deserialize",value:function deserialize(spec){return new LRParser(spec);}}]);return LRParser;}(Parser);function pair(data,off){return data[off]|data[off+1]<<16;}function findOffset(data,start,term){for(var _i230=start,next;(next=data[_i230])!=65535/* End */;_i230++){if(next==term)return _i230-start;}return-1;}function findFinished(stacks){var best=null;var _iterator213=_createForOfIteratorHelper(stacks),_step213;try{for(_iterator213.s();!(_step213=_iterator213.n()).done;){var stack=_step213.value;var stopped=stack.p.stoppedAt;if((stack.pos==stack.p.stream.end||stopped!=null&&stack.pos>stopped)&&stack.p.parser.stateFlag(stack.state,2/* Accepting */)&&(!best||best.score<stack.score))best=stack;}}catch(err){_iterator213.e(err);}finally{_iterator213.f();}return best;}function getSpecializer(spec){if(spec.external){var mask=spec.extend?1/* Extend */:0/* Specialize */;return function(value,stack){return spec.external(value,stack)<<1|mask;};}return spec.get;}var jsonHighlighting=styleTags({String:tags.string,Number:tags.number,"True False":tags.bool,PropertyName:tags.propertyName,Null:tags["null"],",":tags.separator,"[ ]":tags.squareBracket,"{ }":tags.brace});// This file was generated by lezer-generator. You probably shouldn't edit it.
var parser=LRParser.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O","goto":"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:" JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[jsonHighlighting],skippedNodes:[0],repeatNodeCount:2,tokenData:"(p~RaXY!WYZ!W]^!Wpq!Wrs!]|}$i}!O$n!Q!R$w!R![&V![!]&h!}#O&m#P#Q&r#Y#Z&w#b#c'f#h#i'}#o#p(f#q#r(k~!]Oc~~!`Upq!]qr!]rs!rs#O!]#O#P!w#P~!]~!wOe~~!zXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#g~#jR!Q![#s!c!i#s#T#Z#s~#vR!Q![$P!c!i$P#T#Z$P~$SR!Q![$]!c!i$]#T#Z$]~$`R!Q![!]!c!i!]#T#Z!]~$nOh~~$qQ!Q!R$w!R![&V~$|RT~!O!P%V!g!h%k#X#Y%k~%YP!Q![%]~%bRT~!Q![%]!g!h%k#X#Y%k~%nR{|%w}!O%w!Q![%}~%zP!Q![%}~&SPT~!Q![%}~&[ST~!O!P%V!Q![&V!g!h%k#X#Y%k~&mOg~~&rO]~~&wO[~~&zP#T#U&}~'QP#`#a'T~'WP#g#h'Z~'^P#X#Y'a~'fOR~~'iP#i#j'l~'oP#`#a'r~'uP#`#a'x~'}OS~~(QP#f#g(T~(WP#i#j(Z~(^P#X#Y(a~(fOQ~~(kOW~~(pOV~",tokenizers:[0],topRules:{"JsonText":[0,1]},tokenPrec:0});/**
A language provider that provides JSON parsing.
*/var jsonLanguage=/*@__PURE__*/LRLanguage.define({parser:/*@__PURE__*/parser.configure({props:[/*@__PURE__*/indentNodeProp.add({Object:/*@__PURE__*/continuedIndent({except:/^\s*\}/}),Array:/*@__PURE__*/continuedIndent({except:/^\s*\]/})}),/*@__PURE__*/foldNodeProp.add({"Object Array":foldInside})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});/**
JSON language support.
*/function json(){return new LanguageSupport(jsonLanguage);}/* src/lib/components/modes/textmode/StatusBar.svelte generated by Svelte v3.51.0 */function add_css$E(target){append_styles(target,"svelte-1oo7hnc",".jse-status-bar.svelte-1oo7hnc.svelte-1oo7hnc{background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);margin:0;border-top:var(--jse-panel-border);border-left:var(--jse-main-border);border-right:var(--jse-main-border);display:flex;gap:var(--jse-padding)}.jse-status-bar.svelte-1oo7hnc.svelte-1oo7hnc:last-child{border-bottom:var(--jse-main-border)}.jse-status-bar.svelte-1oo7hnc .jse-status-bar-info.svelte-1oo7hnc{padding:2px}");}// (17:2) {#if lineNumber !== undefined}
function create_if_block_2$8(ctx){var div;var t0;var t1;return{c:function c(){div=element("div");t0=text("Line: ");t1=text(/*lineNumber*/ctx[0]);attr(div,"class","jse-status-bar-info svelte-1oo7hnc");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t0);append$1(div,t1);},p:function p(ctx,dirty){if(dirty&/*lineNumber*/1)set_data(t1,/*lineNumber*/ctx[0]);},d:function d(detaching){if(detaching)detach(div);}};}// (21:2) {#if columnNumber !== undefined}
function create_if_block_1$b(ctx){var div;var t0;var t1;return{c:function c(){div=element("div");t0=text("Column: ");t1=text(/*columnNumber*/ctx[1]);attr(div,"class","jse-status-bar-info svelte-1oo7hnc");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t0);append$1(div,t1);},p:function p(ctx,dirty){if(dirty&/*columnNumber*/2)set_data(t1,/*columnNumber*/ctx[1]);},d:function d(detaching){if(detaching)detach(div);}};}// (25:2) {#if charCount !== undefined && charCount > 0}
function create_if_block$n(ctx){var div;var t0;var t1;var t2;return{c:function c(){div=element("div");t0=text("Selection: ");t1=text(/*charCount*/ctx[2]);t2=text(" characters");attr(div,"class","jse-status-bar-info svelte-1oo7hnc");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t0);append$1(div,t1);append$1(div,t2);},p:function p(ctx,dirty){if(dirty&/*charCount*/4)set_data(t1,/*charCount*/ctx[2]);},d:function d(detaching){if(detaching)detach(div);}};}function create_fragment$I(ctx){var div;var t0;var t1;var if_block0=/*lineNumber*/ctx[0]!==undefined&&create_if_block_2$8(ctx);var if_block1=/*columnNumber*/ctx[1]!==undefined&&create_if_block_1$b(ctx);var if_block2=/*charCount*/ctx[2]!==undefined&&/*charCount*/ctx[2]>0&&create_if_block$n(ctx);return{c:function c(){div=element("div");if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if(if_block2)if_block2.c();attr(div,"class","jse-status-bar svelte-1oo7hnc");},m:function m(target,anchor){insert$2(target,div,anchor);if(if_block0)if_block0.m(div,null);append$1(div,t0);if(if_block1)if_block1.m(div,null);append$1(div,t1);if(if_block2)if_block2.m(div,null);},p:function p(ctx,_ref97){var _ref98=_slicedToArray(_ref97,1),dirty=_ref98[0];if(/*lineNumber*/ctx[0]!==undefined){if(if_block0){if_block0.p(ctx,dirty);}else{if_block0=create_if_block_2$8(ctx);if_block0.c();if_block0.m(div,t0);}}else if(if_block0){if_block0.d(1);if_block0=null;}if(/*columnNumber*/ctx[1]!==undefined){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_1$b(ctx);if_block1.c();if_block1.m(div,t1);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(/*charCount*/ctx[2]!==undefined&&/*charCount*/ctx[2]>0){if(if_block2){if_block2.p(ctx,dirty);}else{if_block2=create_if_block$n(ctx);if_block2.c();if_block2.m(div,null);}}else if(if_block2){if_block2.d(1);if_block2=null;}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);if(if_block0)if_block0.d();if(if_block1)if_block1.d();if(if_block2)if_block2.d();}};}function instance$I($$self,$$props,$$invalidate){var editorState=$$props.editorState;var pos;var line;var lineNumber;var columnNumber;var charCount;$$self.$$set=function($$props){if('editorState'in $$props)$$invalidate(3,editorState=$$props.editorState);};$$self.$$.update=function(){if($$self.$$.dirty&/*editorState*/8){var _editorState,_editorState$selectio,_editorState$selectio2;$$invalidate(4,pos=(_editorState=editorState)===null||_editorState===void 0?void 0:(_editorState$selectio=_editorState.selection)===null||_editorState$selectio===void 0?void 0:(_editorState$selectio2=_editorState$selectio.main)===null||_editorState$selectio2===void 0?void 0:_editorState$selectio2.head);}if($$self.$$.dirty&/*editorState, pos*/24){var _editorState2,_editorState2$doc;$$invalidate(5,line=(_editorState2=editorState)===null||_editorState2===void 0?void 0:(_editorState2$doc=_editorState2.doc)===null||_editorState2$doc===void 0?void 0:_editorState2$doc.lineAt(pos));}if($$self.$$.dirty&/*line*/32){$$invalidate(0,lineNumber=line?line.number:undefined);}if($$self.$$.dirty&/*line, pos*/48){$$invalidate(1,columnNumber=line?pos-line.from+1:undefined);}if($$self.$$.dirty&/*editorState*/8){var _editorState3,_editorState3$selecti,_editorState3$selecti2;$$invalidate(2,charCount=(_editorState3=editorState)===null||_editorState3===void 0?void 0:(_editorState3$selecti=_editorState3.selection)===null||_editorState3$selecti===void 0?void 0:(_editorState3$selecti2=_editorState3$selecti.ranges)===null||_editorState3$selecti2===void 0?void 0:_editorState3$selecti2.reduce(function(count,range){return count+range.to-range.from;},0));}};return[lineNumber,columnNumber,charCount,editorState,pos,line];}var StatusBar=/*#__PURE__*/function(_SvelteComponent14){_inherits(StatusBar,_SvelteComponent14);var _super55=_createSuper(StatusBar);function StatusBar(options){var _this109;_classCallCheck(this,StatusBar);_this109=_super55.call(this);init(_assertThisInitialized(_this109),options,instance$I,create_fragment$I,safe_not_equal,{editorState:3},add_css$E);return _this109;}return _createClass(StatusBar);}(SvelteComponent);var StatusBar$1=StatusBar;var highlightStyle=HighlightStyle.define([{tag:tags.propertyName,color:'var(--jse-key-color)'},{tag:tags.number,color:'var(--jse-value-color-number)'},{tag:tags.bool,color:'var(--jse-value-color-boolean)'},{tag:tags.string,color:'var(--jse-value-color-string)'},{tag:tags.keyword,color:'var(--jse-value-color-null)'}// null
]);var highlighter=syntaxHighlighting(highlightStyle);// TODO: remove workaround when not needed anymore
// Workaround for the error "CodeMirror plugin crashed: TypeError: tags3 is undefined"
// thrown when using the json() language from '@codemirror/lang-json'
//
// Note that a plain CodeSandbox with parcel and code mirror v6.0.0,
// so it is maybe related to Vite
//
// See https://discuss.codemirror.net/t/highlighting-that-seems-ignored-in-cm6/4320/15
var originalStyle=highlightStyle.style;// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
// noinspection JSConstantReassignment
highlightStyle.style=function(tags){return originalStyle(tags||[]);};function isMenuSpaceItem(item){return item&&item['space']===true&&Object.keys(item).length===1;}function isContentParseError(contentErrors){return _typeof2(contentErrors['parseError'])==='object'&&contentErrors['parseError']!==null;}function isContentValidationErrors(contentErrors){return Array.isArray(contentErrors['validationErrors']);}var safeIsNaN=Number.isNaN||function ponyfill(value){return typeof value==='number'&&value!==value;};function isEqual(first,second){if(first===second){return true;}if(safeIsNaN(first)&&safeIsNaN(second)){return true;}return false;}function areInputsEqual(newInputs,lastInputs){if(newInputs.length!==lastInputs.length){return false;}for(var i=0;i<newInputs.length;i++){if(!isEqual(newInputs[i],lastInputs[i])){return false;}}return true;}function memoizeOne(resultFn,isEqual){if(isEqual===void 0){isEqual=areInputsEqual;}var cache=null;function memoized(){var newArgs=[];for(var _i=0;_i<arguments.length;_i++){newArgs[_i]=arguments[_i];}if(cache&&cache.lastThis===this&&isEqual(newArgs,cache.lastArgs)){return cache.lastResult;}var lastResult=resultFn.apply(this,newArgs);cache={lastResult:lastResult,lastArgs:newArgs,lastThis:this};return lastResult;}memoized.clear=function clear(){cache=null;};return memoized;}/**
 * Measure how long a callback takes to execute.
 * Returns the response from the callback
 * The measured duration is returned via the onDuration callback
 */function measure(callback,onDuration){var start=Date.now();var result=callback();var end=Date.now();onDuration(end-start);return result;}var debug$2=createDebug('validation');/**
 * Create a flat map with validation errors, where the key is the stringified path
 * and also create error messages for the parent nodes of the nodes having an error.
 *
 * Returns a nested object containing the validation errors
 */function mapValidationErrors(validationErrors){var map={};// first generate a map with the errors themselves
validationErrors.forEach(function(validationError){map[immutableJSONPatch.exports.compileJSONPointer(validationError.path)]=validationError;});// create error entries for all parent nodes (displayed when the node is collapsed)
validationErrors.forEach(function(validationError){var parentPath=validationError.path;while(parentPath.length>0){parentPath=initial(parentPath);var parentPointer=immutableJSONPatch.exports.compileJSONPointer(parentPath);if(!(parentPointer in map)){map[parentPointer]={isChildError:true,path:parentPath,message:'Contains invalid data'};}}});return map;}function validateJSON(json,validator,parser,validationParser){debug$2('validateJSON');if(!validator){return[];}if(parser!==validationParser){// if needed, convert for example Lossless JSON to native JSON
// (like replace bigint or LosslessNumber into regular numbers)
var convertedJSON=validationParser.parse(parser.stringify(json));return validator(convertedJSON);}else{return validator(json);}}function validateText(text,validator,parser,validationParser){debug$2('validateText');if(text.length>MAX_VALIDATABLE_SIZE){var validationError={path:[],message:'Validation turned off: the document is too large',severity:ValidationSeverity.info};return{validationErrors:[validationError]};}if(text.length===0){// new, empty document, do not try to parse
return{validationErrors:[]};}try{// parse with the "main" parser (not the validation parser) to get parse errors
// (like syntax errors and duplicate keys errors)
var _json=measure(function(){return parser.parse(text);},function(duration){return debug$2("validate: parsed json in ".concat(duration," ms"));});if(!validator){return{validationErrors:[]};}// if needed, parse with the validationParser to be able to feed the json to the validator
var convertedJSON=parser===validationParser?_json:measure(function(){return validationParser.parse(text);},function(duration){return debug$2("validate: parsed json with the validationParser in ".concat(duration," ms"));});// actually validate the json
var validationErrors=measure(function(){return validator(convertedJSON);},function(duration){return debug$2("validate: validated json in ".concat(duration," ms"));});return{validationErrors:validationErrors};}catch(err){var isRepairable=measure(function(){return canAutoRepair(text,parser);},function(duration){return debug$2("validate: checked whether repairable in ".concat(duration," ms"));});var parseError=normalizeJsonParseError(text,err.message||err.toString());return{parseError:parseError,isRepairable:isRepairable};}}function canAutoRepair(text,parser){if(text.length>MAX_AUTO_REPAIRABLE_SIZE){return false;}try{parser.parse(jsonrepair(text));return true;}catch(err){return false;}}/* src/lib/components/modes/textmode/TextMode.svelte generated by Svelte v3.51.0 */function add_css$D(target){append_styles(target,"svelte-o0o8bj",".jse-text-mode.svelte-o0o8bj.svelte-o0o8bj{flex:1;box-sizing:border-box;display:flex;flex-direction:column;background:var(--jse-background-color)}.jse-text-mode.no-main-menu.svelte-o0o8bj.svelte-o0o8bj{border-top:var(--jse-main-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0;min-height:0;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj:last-child{border-bottom:var(--jse-main-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.jse-hidden.svelte-o0o8bj{visibility:hidden}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor{flex:1;overflow:hidden}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-scroller{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);line-height:var(--jse-line-height);color:var(--jse-delimiter-color)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-gutters{background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);border-right:var(--jse-panel-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-activeLine,.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-activeLineGutter{background:var(--jse-hover-background-color)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-selectionBackground{background:var(--jse-selection-background-color)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-searchMatch{background-color:var(--jse-search-match-color);outline:var(--jse-search-match-outline)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-searchMatch.cm-searchMatch-selected{background-color:var(--jse-search-match-active-color);outline:var(--jse-search-match-active-outline)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-foldPlaceholder{background:var(--jse-tag-background);color:var(--jse-tag-color);border:none;padding:0 var(--jse-padding)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-tooltip{font-size:var(--jse-font-size);font-family:var(--jse-font-family);color:var(--jse-tooltip-color);background:var(--jse-tooltip-background);border:var(--jse-tooltip-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-diagnosticAction{background:var(--jse-tooltip-action-button-color);background:var(--jse-tooltip-action-button-background)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-panels{border-bottom:var(--jse-panel-border)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search{background:var(--jse-panel-background);color:var(--jse-panel-color);font-family:var(--jse-font-family);font-size:var(--jse-font-size)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search input{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);color:var(--jse-input-color);border:var(--jse-input-border);background:var(--jse-input-background);margin-right:2px}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search button{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);color:var(--jse-panel-button-color);background:var(--jse-panel-button-background);border:none;cursor:pointer;text-transform:capitalize;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);margin:0}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search button:hover{color:var(--jse-panel-button-color-highlight);background:var(--jse-panel-button-background-highlight)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search label{font-family:var(--jse-font-family);font-size:var(--jse-font-size-text-mode-search);padding-left:var(--jse-padding)}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search label input{margin-right:2px}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-search button[name=\"close\"]{width:32px;height:32px;font-size:24px;line-height:24px;padding:0;right:0;top:-4px}.jse-text-mode.svelte-o0o8bj .jse-contents.svelte-o0o8bj .cm-editor .cm-cursor-primary{border-color:var(--jse-text-color)}.jse-text-mode.svelte-o0o8bj .jse-contents .jse-loading-space.svelte-o0o8bj{flex:1}.jse-text-mode.svelte-o0o8bj .jse-contents .jse-loading.svelte-o0o8bj{flex:2;text-align:center;color:var(--jse-panel-color-readonly);box-sizing:border-box;font-family:var(--jse-font-family);font-size:var(--jse-font-size)}");}// (637:2) {#if mainMenuBar}
function create_if_block_5$3(ctx){var textmenu;var current;textmenu=new TextMenu$1({props:{readOnly:/*readOnly*/ctx[0],onFormat:/*handleFormat*/ctx[17],onCompact:/*handleCompact*/ctx[18],onSort:/*handleSort*/ctx[19],onTransform:/*handleTransform*/ctx[20],onToggleSearch:/*handleToggleSearch*/ctx[21],onUndo:/*handleUndo*/ctx[22],onRedo:/*handleRedo*/ctx[23],canFormat:!/*isNewDocument*/ctx[15],canCompact:!/*isNewDocument*/ctx[15],canSort:!/*isNewDocument*/ctx[15],canTransform:!/*isNewDocument*/ctx[15],canUndo:/*canUndo*/ctx[11],canRedo:/*canRedo*/ctx[12],onRenderMenu:/*onRenderMenu*/ctx[4]}});return{c:function c(){create_component(textmenu.$$.fragment);},m:function m(target,anchor){mount_component(textmenu,target,anchor);current=true;},p:function p(ctx,dirty){var textmenu_changes={};if(dirty[0]&/*readOnly*/1)textmenu_changes.readOnly=/*readOnly*/ctx[0];if(dirty[0]&/*isNewDocument*/32768)textmenu_changes.canFormat=!/*isNewDocument*/ctx[15];if(dirty[0]&/*isNewDocument*/32768)textmenu_changes.canCompact=!/*isNewDocument*/ctx[15];if(dirty[0]&/*isNewDocument*/32768)textmenu_changes.canSort=!/*isNewDocument*/ctx[15];if(dirty[0]&/*isNewDocument*/32768)textmenu_changes.canTransform=!/*isNewDocument*/ctx[15];if(dirty[0]&/*canUndo*/2048)textmenu_changes.canUndo=/*canUndo*/ctx[11];if(dirty[0]&/*canRedo*/4096)textmenu_changes.canRedo=/*canRedo*/ctx[12];if(dirty[0]&/*onRenderMenu*/16)textmenu_changes.onRenderMenu=/*onRenderMenu*/ctx[4];textmenu.$set(textmenu_changes);},i:function i(local){if(current)return;transition_in(textmenu.$$.fragment,local);current=true;},o:function o(local){transition_out(textmenu.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(textmenu,detaching);}};}// (709:2) {:else}
function create_else_block$d(ctx){var div2;return{c:function c(){div2=element("div");div2.innerHTML="<div class=\"jse-loading-space svelte-o0o8bj\"></div> \n      <div class=\"jse-loading svelte-o0o8bj\">loading...</div>";attr(div2,"class","jse-contents svelte-o0o8bj");},m:function m(target,anchor){insert$2(target,div2,anchor);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div2);}};}// (657:2) {#if !isSSR}
function create_if_block$m(ctx){var t0;var div;var t1;var t2;var if_block2_anchor;var current;var if_block0=/*editorDisabled*/ctx[10]&&create_if_block_4$3(ctx);var if_block1=/*statusBar*/ctx[2]&&create_if_block_3$5(ctx);var if_block2=!/*editorDisabled*/ctx[10]&&create_if_block_1$a(ctx);return{c:function c(){if(if_block0)if_block0.c();t0=space();div=element("div");t1=space();if(if_block1)if_block1.c();t2=space();if(if_block2)if_block2.c();if_block2_anchor=empty$1();attr(div,"class","jse-contents svelte-o0o8bj");toggle_class(div,"jse-hidden",/*editorDisabled*/ctx[10]);},m:function m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert$2(target,t0,anchor);insert$2(target,div,anchor);/*div_binding*/ctx[48](div);insert$2(target,t1,anchor);if(if_block1)if_block1.m(target,anchor);insert$2(target,t2,anchor);if(if_block2)if_block2.m(target,anchor);insert$2(target,if_block2_anchor,anchor);current=true;},p:function p(ctx,dirty){if(/*editorDisabled*/ctx[10]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*editorDisabled*/1024){transition_in(if_block0,1);}}else{if_block0=create_if_block_4$3(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(!current||dirty[0]&/*editorDisabled*/1024){toggle_class(div,"jse-hidden",/*editorDisabled*/ctx[10]);}if(/*statusBar*/ctx[2]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*statusBar*/4){transition_in(if_block1,1);}}else{if_block1=create_if_block_3$5(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(t2.parentNode,t2);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(!/*editorDisabled*/ctx[10]){if(if_block2){if_block2.p(ctx,dirty);if(dirty[0]&/*editorDisabled*/1024){transition_in(if_block2,1);}}else{if_block2=create_if_block_1$a(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(if_block2_anchor.parentNode,if_block2_anchor);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,function(){if_block2=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);current=false;},d:function d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(detaching)detach(div);/*div_binding*/ctx[48](null);if(detaching)detach(t1);if(if_block1)if_block1.d(detaching);if(detaching)detach(t2);if(if_block2)if_block2.d(detaching);if(detaching)detach(if_block2_anchor);}};}// (658:4) {#if editorDisabled}
function create_if_block_4$3(ctx){var message;var current;message=new Message$1({props:{icon:faExclamationTriangle,type:"error",message:"The JSON document is larger than ".concat(formatSize(MAX_DOCUMENT_SIZE_TEXT_MODE,1024),", ")+"and may crash your browser when loading it in text mode. Actual size: ".concat(formatSize(/*text*/ctx[5].length,1024),"."),actions:[{text:'Open anyway',title:'Open the document in text mode. This may freeze or crash your browser.',onClick:/*handleAcceptTooLarge*/ctx[24]},{text:'Open in tree mode',title:'Open the document in tree mode. Tree mode can handle large documents.',onClick:/*onSwitchToTreeMode*/ctx[3]},{text:'Cancel',title:'Cancel opening this large document.',onClick:/*cancelLoadTooLarge*/ctx[25]}]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty[0]&/*text*/32)message_changes.message="The JSON document is larger than ".concat(formatSize(MAX_DOCUMENT_SIZE_TEXT_MODE,1024),", ")+"and may crash your browser when loading it in text mode. Actual size: ".concat(formatSize(/*text*/ctx[5].length,1024),".");if(dirty[0]&/*onSwitchToTreeMode*/8)message_changes.actions=[{text:'Open anyway',title:'Open the document in text mode. This may freeze or crash your browser.',onClick:/*handleAcceptTooLarge*/ctx[24]},{text:'Open in tree mode',title:'Open the document in tree mode. Tree mode can handle large documents.',onClick:/*onSwitchToTreeMode*/ctx[3]},{text:'Cancel',title:'Cancel opening this large document.',onClick:/*cancelLoadTooLarge*/ctx[25]}];message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}// (692:4) {#if statusBar}
function create_if_block_3$5(ctx){var statusbar;var current;statusbar=new StatusBar$1({props:{editorState:/*editorState*/ctx[8]}});return{c:function c(){create_component(statusbar.$$.fragment);},m:function m(target,anchor){mount_component(statusbar,target,anchor);current=true;},p:function p(ctx,dirty){var statusbar_changes={};if(dirty[0]&/*editorState*/256)statusbar_changes.editorState=/*editorState*/ctx[8];statusbar.$set(statusbar_changes);},i:function i(local){if(current)return;transition_in(statusbar.$$.fragment,local);current=true;},o:function o(local){transition_out(statusbar.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(statusbar,detaching);}};}// (696:4) {#if !editorDisabled}
function create_if_block_1$a(ctx){var t;var validationerrorsoverview;var current;var if_block=/*jsonParseError*/ctx[13]&&create_if_block_2$7(ctx);validationerrorsoverview=new ValidationErrorsOverview$1({props:{validationErrors:/*validationErrors*/ctx[9],selectError:/*handleSelectValidationError*/ctx[26]}});return{c:function c(){if(if_block)if_block.c();t=space();create_component(validationerrorsoverview.$$.fragment);},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,t,anchor);mount_component(validationerrorsoverview,target,anchor);current=true;},p:function p(ctx,dirty){if(/*jsonParseError*/ctx[13]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*jsonParseError*/8192){transition_in(if_block,1);}}else{if_block=create_if_block_2$7(ctx);if_block.c();transition_in(if_block,1);if_block.m(t.parentNode,t);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}var validationerrorsoverview_changes={};if(dirty[0]&/*validationErrors*/512)validationerrorsoverview_changes.validationErrors=/*validationErrors*/ctx[9];validationerrorsoverview.$set(validationerrorsoverview_changes);},i:function i(local){if(current)return;transition_in(if_block);transition_in(validationerrorsoverview.$$.fragment,local);current=true;},o:function o(local){transition_out(if_block);transition_out(validationerrorsoverview.$$.fragment,local);current=false;},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(t);destroy_component(validationerrorsoverview,detaching);}};}// (697:6) {#if jsonParseError}
function create_if_block_2$7(ctx){var message;var current;message=new Message$1({props:{type:"error",icon:faExclamationTriangle,message:/*jsonParseError*/ctx[13].message,actions:/*repairActions*/ctx[14],onClick:/*func*/ctx[49]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty[0]&/*jsonParseError*/8192)message_changes.message=/*jsonParseError*/ctx[13].message;if(dirty[0]&/*repairActions*/16384)message_changes.actions=/*repairActions*/ctx[14];if(dirty[0]&/*jsonParseError*/8192)message_changes.onClick=/*func*/ctx[49];message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}function create_fragment$H(ctx){var div;var t;var current_block_type_index;var if_block1;var current;var if_block0=/*mainMenuBar*/ctx[1]&&create_if_block_5$3(ctx);var if_block_creators=[create_if_block$m,create_else_block$d];var if_blocks=[];function select_block_type(ctx,dirty){if(!/*isSSR*/ctx[16])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block1=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if(if_block0)if_block0.c();t=space();if_block1.c();attr(div,"class","jse-text-mode svelte-o0o8bj");toggle_class(div,"no-main-menu",!/*mainMenuBar*/ctx[1]);},m:function m(target,anchor){insert$2(target,div,anchor);if(if_block0)if_block0.m(div,null);append$1(div,t);if_blocks[current_block_type_index].m(div,null);/*div_binding_1*/ctx[50](div);current=true;},p:function p(ctx,dirty){if(/*mainMenuBar*/ctx[1]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*mainMenuBar*/2){transition_in(if_block0,1);}}else{if_block0=create_if_block_5$3(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if_block1.p(ctx,dirty);if(!current||dirty[0]&/*mainMenuBar*/2){toggle_class(div,"no-main-menu",!/*mainMenuBar*/ctx[1]);}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d:function d(detaching){if(detaching)detach(div);if(if_block0)if_block0.d();if_blocks[current_block_type_index].d();/*div_binding_1*/ctx[50](null);}};}function toDiagnostic(error){return{from:error.from,to:error.to,message:error.message,actions:error.actions,severity:error.severity,source:undefined};}function instance$H($$self,$$props,$$invalidate){var isNewDocument;var normalization;var repairActions;var readOnly=$$props.readOnly;var mainMenuBar=$$props.mainMenuBar;var statusBar=$$props.statusBar;var externalContent=$$props.externalContent;var indentation=$$props.indentation;var tabSize=$$props.tabSize;var escapeUnicodeCharacters=$$props.escapeUnicodeCharacters;var parser=$$props.parser;var validator=$$props.validator;var validationParser=$$props.validationParser;var onChange=$$props.onChange;var onSwitchToTreeMode=$$props.onSwitchToTreeMode;var onError=$$props.onError;var onFocus=$$props.onFocus;var onBlur=$$props.onBlur;var onRenderMenu=$$props.onRenderMenu;var onSortModal=$$props.onSortModal;var onTransformModal=$$props.onTransformModal;var debug=createDebug('jsoneditor:TextMode');var formatCompactKeyBinding={key:'Mod-i',run:handleFormat,shift:handleCompact,preventDefault:true};var isSSR=typeof window==='undefined';debug('isSSR:',isSSR);var codeMirrorRef;var codeMirrorView;var domTextMode;var editorState;var acceptTooLarge=false;var validationErrors=[];var linterCompartment=new Compartment();var editableCompartment=new Compartment();// needed to prevent a mobile keyboard from opening when readonly
var readOnlyCompartment=new Compartment();var indentUnitCompartment=new Compartment();var tabSizeCompartment=new Compartment();var content=externalContent;var text=getText(content,indentation,parser);// text is just a cached version of content.text or parsed content.json
var editorDisabled=disableTextEditor(text,acceptTooLarge);// force updating the text when escapeUnicodeCharacters changes
var previousEscapeUnicodeCharacters=escapeUnicodeCharacters;onMount(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isSSR){_context.next=2;break;}return _context.abrupt("return");case 2:try{codeMirrorView=createCodeMirrorView({target:codeMirrorRef,initialText:!editorDisabled?normalization.escapeValue(text):'',readOnly:readOnly,indentation:indentation});focus();}catch(err){// TODO: report error to the user
console.error(err);}case 3:case"end":return _context.stop();}}},_callee);})));onDestroy(function(){if(codeMirrorView){debug('Destroy CodeMirror editor');codeMirrorView.destroy();}});var canUndo=false;var canRedo=false;var sortModalId=uniqueId();var transformModalId=uniqueId();function focus(){if(codeMirrorView){debug('focus');codeMirrorView.focus();}}// modalOpen is true when one of the modals is open.
// This is used to track whether the editor still has focus
var modalOpen=false;createFocusTracker({onMount:onMount,onDestroy:onDestroy,getWindow:function getWindow(){return _getWindow(domTextMode);},hasFocus:function hasFocus(){return modalOpen&&document.hasFocus()||activeElementIsChildOf(domTextMode);},onFocus:onFocus,onBlur:onBlur});function patch(operations){debug('patch',operations);var previousJson=parser.parse(text);var updatedJson=immutableJSONPatch.exports.immutableJSONPatch(previousJson,operations);var undo=immutableJSONPatch.exports.revertJSONPatch(previousJson,operations);setCodeMirrorContent({text:parser.stringify(updatedJson,null,indentation)});return{json:updatedJson,previousJson:previousJson,undo:undo,redo:operations};}function handleFormat(){debug('format');if(readOnly){return;}try{var _json2=parser.parse(text);setCodeMirrorContent({text:parser.stringify(_json2,null,indentation)});}catch(err){onError(err);}}function handleCompact(){debug('compact');if(readOnly){return;}try{var _json3=parser.parse(text);setCodeMirrorContent({text:parser.stringify(_json3)});}catch(err){onError(err);}}function handleRepair(){debug('repair');if(readOnly){return;}try{setCodeMirrorContent({text:jsonrepair(text)});$$invalidate(47,jsonStatus=JSON_STATUS_VALID);$$invalidate(13,jsonParseError=undefined);}catch(err){onError(err);}}function handleSort(){if(readOnly){return;}try{var _json4=parser.parse(text);modalOpen=true;onSortModal({id:sortModalId,json:_json4,selectedPath:[],onSort:function(){var _onSort=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(operations){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:debug('onSort',operations);patch(operations);case 2:case"end":return _context2.stop();}}},_callee2);}));function onSort(_x){return _onSort.apply(this,arguments);}return onSort;}(),onClose:function onClose(){modalOpen=false;focus();}});}catch(err){onError(err);}}function openTransformModal(_ref100){var id=_ref100.id,selectedPath=_ref100.selectedPath,onTransform=_ref100.onTransform,_onClose=_ref100.onClose;try{var _json5=parser.parse(text);modalOpen=true;onTransformModal({id:id||transformModalId,json:_json5,selectedPath:selectedPath,onTransform:onTransform?function(operations){onTransform({operations:operations,json:_json5,transformedJson:immutableJSONPatch.exports.immutableJSONPatch(_json5,operations)});}:function(operations){debug('onTransform',operations);patch(operations);},onClose:function onClose(){modalOpen=false;focus();if(_onClose){_onClose();}}});}catch(err){onError(err);}}function handleTransform(){if(readOnly){return;}openTransformModal({selectedPath:[]});}function handleToggleSearch(){if(codeMirrorView){// TODO: figure out the proper way to detect whether the search panel is open
if(codeMirrorRef&&codeMirrorRef.querySelector('.cm-search')){closeSearchPanel(codeMirrorView);}else{openSearchPanel(codeMirrorView);}}}function handleUndo(){if(readOnly){return;}if(codeMirrorView){undo(codeMirrorView);focus();}}function handleRedo(){if(readOnly){return;}if(codeMirrorView){redo(codeMirrorView);focus();}}function handleAcceptTooLarge(){acceptTooLarge=true;setCodeMirrorContent(externalContent,true);}function cancelLoadTooLarge(){// copy the latest contents of the text editor again into text
onChangeCodeMirrorValue();}/**
 * @param {ValidationError} validationError
 **/function handleSelectValidationError(validationError){debug('select validation error',validationError);var richValidationError=toRichValidationError(validationError);// we take "to" as head, not as anchor, because the scrollIntoView will
// move to the head, and when a large whole object is selected as a whole,
// we want to scroll to the start of the object and not the end
setSelection(richValidationError.from,richValidationError.to);focus();}function handleSelectParseError(parseError){debug('select parse error',parseError);var richParseError=toRichParseError(parseError,false);// we take "to" as head, not as anchor, because the scrollIntoView will
// move to the head, and when a large whole object is selected as a whole,
// we want to scroll to the start of the object and not the end
setSelection(richParseError.from,richParseError.to);focus();}/**
 * @param {number} anchor
 * @param {number} head
 **/function setSelection(anchor,head){debug('setSelection',{anchor:anchor,head:head});if(codeMirrorView){codeMirrorView.dispatch(codeMirrorView.state.update({selection:{anchor:anchor,head:head},scrollIntoView:true}));}}function handleDoubleClick(event,view){// When the user double-clicked right from a bracket [ or {,
// select the contents of the array or object
if(view.state.selection.ranges.length===1){var _range20=view.state.selection.ranges[0];var selectedText=text.slice(_range20.from,_range20.to);if(selectedText==='{'||selectedText==='['){var jsmap=jsonSourceMap.parse(text);var path=Object.keys(jsmap.pointers).find(function(path){var _pointer$value;var pointer=jsmap.pointers[path];return((_pointer$value=pointer.value)===null||_pointer$value===void 0?void 0:_pointer$value.pos)===_range20.from;});var pointer=jsmap.pointers[path];if(path&&pointer&&pointer.value&&pointer.valueEnd){debug('pointer found, selecting inner contents of path:',path,pointer);var anchor=pointer.value.pos+1;var _head5=pointer.valueEnd.pos-1;setSelection(anchor,_head5);}}}}function createLinter(){return linter(linterCallback,{delay:TEXT_MODE_ONCHANGE_DELAY});}function createCodeMirrorView(_ref101){var target=_ref101.target,initialText=_ref101.initialText,readOnly=_ref101.readOnly,indentation=_ref101.indentation;debug('Create CodeMirror editor',{readOnly:readOnly,indentation:indentation});var state=EditorState.create({doc:initialText,extensions:[keymap.of([indentWithTab,formatCompactKeyBinding]),linterCompartment.of(createLinter()),lintGutter(),basicSetup,highlighter,EditorView.domEventHandlers({dblclick:handleDoubleClick}),EditorView.updateListener.of(function(update){$$invalidate(8,editorState=update.state);if(update.docChanged){onChangeCodeMirrorValueDebounced();}}),json(),search$1({top:true}),readOnlyCompartment.of(EditorState.readOnly.of(readOnly)),editableCompartment.of(EditorView.editable.of(!readOnly)),tabSizeCompartment.of(EditorState.tabSize.of(tabSize)),indentUnitCompartment.of(createIndentUnit(indentation)),EditorView.lineWrapping]});codeMirrorView=new EditorView({state:state,parent:target});return codeMirrorView;}function getCodeMirrorValue(){return codeMirrorView?normalization.unescapeValue(codeMirrorView.state.doc.toString()):'';}function toRichValidationError(validationError){var path=validationError.path,message=validationError.message;var _findTextLocation=findTextLocation(text,path),line=_findTextLocation.line,column=_findTextLocation.column,from=_findTextLocation.from,to=_findTextLocation.to;return{path:path,line:line,column:column,from:from,to:to,message:message,severity:ValidationSeverity.warning,actions:[]};}function toRichParseError(parseError,isRepairable){var line=parseError.line,column=parseError.column,position=parseError.position,message=parseError.message;return{path:null,line:line,column:column,from:position||0,to:position||0,severity:ValidationSeverity.error,message:message,actions:isRepairable&&!readOnly?[{name:'Auto repair',apply:function apply(){return handleRepair();}}]:null};}function setCodeMirrorContent(newContent){var forceUpdate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var newText=getText(newContent,indentation,parser);$$invalidate(10,editorDisabled=disableTextEditor(newText,acceptTooLarge));if(editorDisabled){debug('externalContent not applying text: editor is disabled');return;}var isChanged=!isEqual$1(newContent,content);debug('setCodeMirrorContent',{isChanged:isChanged,forceUpdate:forceUpdate});if(!codeMirrorView||!isChanged&&!forceUpdate){return;}var previousContent=content;content=newContent;$$invalidate(5,text=newText);// keep state
// to reset state: codeMirrorView.setState(EditorState.create({doc: text, extensions: ...}))
codeMirrorView.dispatch({changes:{from:0,to:codeMirrorView.state.doc.length,insert:normalization.escapeValue(text)}});updateCanUndoRedo();if(isChanged){emitOnChange(content,previousContent);}}function refresh(){debug('refresh');var index=codeMirrorView.state.doc.length;// a trick to force Code Mirror to re-render the gutter values:
// insert a space at the end and then remove it again
codeMirrorView.dispatch({changes:{from:index,to:index,insert:' '}});codeMirrorView.dispatch({changes:{from:index,to:index+1,insert:''}});}function forceUpdateText(){debug('forceUpdateText',{escapeUnicodeCharacters:escapeUnicodeCharacters});if(codeMirrorView){codeMirrorView.dispatch({changes:{from:0,to:codeMirrorView.state.doc.length,insert:normalization.escapeValue(text)}});}}function onChangeCodeMirrorValue(){if(!codeMirrorView){return;}var codeMirrorText=getCodeMirrorValue();var isChanged=codeMirrorText!==text;debug('onChangeCodeMirrorValue',{isChanged:isChanged});if(!isChanged){return;}var previousContent=content;$$invalidate(5,text=codeMirrorText);content={text:text};updateCanUndoRedo();emitOnChange(content,previousContent);}function updateLinter(validator){debug('updateLinter',validator);if(!codeMirrorView){return;}codeMirrorView.dispatch({effects:linterCompartment.reconfigure(createLinter())});}function updateIndentation(indentation){if(codeMirrorView){debug('updateIndentation',indentation);codeMirrorView.dispatch({effects:indentUnitCompartment.reconfigure(createIndentUnit(indentation))});}}function updateTabSize(tabSize){if(codeMirrorView){debug('updateTabSize',tabSize);codeMirrorView.dispatch({effects:tabSizeCompartment.reconfigure(EditorState.tabSize.of(tabSize))});}}function updateReadOnly(readOnly){if(codeMirrorView){debug('updateReadOnly',readOnly);codeMirrorView.dispatch({effects:[readOnlyCompartment.reconfigure(EditorState.readOnly.of(readOnly)),editableCompartment.reconfigure(EditorView.editable.of(!readOnly))]});}}function createIndentUnit(indentation){return indentUnit.of(typeof indentation==='number'?' '.repeat(indentation):indentation);}function updateCanUndoRedo(){$$invalidate(11,canUndo=undoDepth(codeMirrorView.state)>0);$$invalidate(12,canRedo=redoDepth(codeMirrorView.state)>0);debug({canUndo:canUndo,canRedo:canRedo});}// debounce the input: when pressing Enter at the end of a line, two change
// events are fired: one with the new Return character, and a second with
// indentation added on the new line. This causes a race condition when used
// for example in React. Debouncing the onChange events also results in not
// firing a change event with every character that a user types, but only as
// soon as the user stops typing.
var onChangeCodeMirrorValueDebounced=debounce$1(onChangeCodeMirrorValue,TEXT_MODE_ONCHANGE_DELAY);function emitOnChange(content,previousContent){if(onChange){onChange(content,previousContent,{contentErrors:validate(),patchResult:null});}}function disableTextEditor(text,acceptTooLarge){var tooLarge=text&&text.length>MAX_DOCUMENT_SIZE_TEXT_MODE;return tooLarge&&!acceptTooLarge;}var jsonStatus=JSON_STATUS_VALID;var jsonParseError=null;function linterCallback(){if(editorDisabled){return[];}var contentErrors=validate();if(isContentParseError(contentErrors)){var parseError=contentErrors.parseError,isRepairable=contentErrors.isRepairable;return[toDiagnostic(toRichParseError(parseError,isRepairable))];}if(isContentValidationErrors(contentErrors)){return contentErrors.validationErrors.map(toRichValidationError).map(toDiagnostic);}return[];}function validate(){debug('validate:start');onChangeCodeMirrorValueDebounced.flush();var contentErrors=memoizedValidateText(text,validator,parser,validationParser);if(isContentParseError(contentErrors)){$$invalidate(47,jsonStatus=contentErrors.isRepairable?JSON_STATUS_REPAIRABLE:JSON_STATUS_INVALID);$$invalidate(13,jsonParseError=contentErrors.parseError);$$invalidate(9,validationErrors=[]);}else{$$invalidate(47,jsonStatus=JSON_STATUS_VALID);$$invalidate(13,jsonParseError=null);$$invalidate(9,validationErrors=contentErrors.validationErrors);}debug('validate:end');return contentErrors;}// because onChange returns the validation errors and there is also a separate listener,
// we would execute validation twice. Memoizing the last result solves this.
var memoizedValidateText=memoizeOne(validateText);function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){codeMirrorRef=$$value;$$invalidate(6,codeMirrorRef);});}var func=function func(){return handleSelectParseError(jsonParseError);};function div_binding_1($$value){binding_callbacks[$$value?'unshift':'push'](function(){domTextMode=$$value;$$invalidate(7,domTextMode);});}$$self.$$set=function($$props){if('readOnly'in $$props)$$invalidate(0,readOnly=$$props.readOnly);if('mainMenuBar'in $$props)$$invalidate(1,mainMenuBar=$$props.mainMenuBar);if('statusBar'in $$props)$$invalidate(2,statusBar=$$props.statusBar);if('externalContent'in $$props)$$invalidate(28,externalContent=$$props.externalContent);if('indentation'in $$props)$$invalidate(29,indentation=$$props.indentation);if('tabSize'in $$props)$$invalidate(30,tabSize=$$props.tabSize);if('escapeUnicodeCharacters'in $$props)$$invalidate(31,escapeUnicodeCharacters=$$props.escapeUnicodeCharacters);if('parser'in $$props)$$invalidate(32,parser=$$props.parser);if('validator'in $$props)$$invalidate(33,validator=$$props.validator);if('validationParser'in $$props)$$invalidate(34,validationParser=$$props.validationParser);if('onChange'in $$props)$$invalidate(35,onChange=$$props.onChange);if('onSwitchToTreeMode'in $$props)$$invalidate(3,onSwitchToTreeMode=$$props.onSwitchToTreeMode);if('onError'in $$props)$$invalidate(36,onError=$$props.onError);if('onFocus'in $$props)$$invalidate(37,onFocus=$$props.onFocus);if('onBlur'in $$props)$$invalidate(38,onBlur=$$props.onBlur);if('onRenderMenu'in $$props)$$invalidate(4,onRenderMenu=$$props.onRenderMenu);if('onSortModal'in $$props)$$invalidate(39,onSortModal=$$props.onSortModal);if('onTransformModal'in $$props)$$invalidate(40,onTransformModal=$$props.onTransformModal);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*text*/32){$$invalidate(15,isNewDocument=text.length===0);}if($$self.$$.dirty[1]&/*escapeUnicodeCharacters*/1){normalization=createNormalizationFunctions({escapeControlCharacters:false,escapeUnicodeCharacters:escapeUnicodeCharacters});}if($$self.$$.dirty[0]&/*externalContent*/268435456){setCodeMirrorContent(externalContent);}if($$self.$$.dirty[1]&/*validator*/4){updateLinter(validator);}if($$self.$$.dirty[0]&/*indentation*/536870912){updateIndentation(indentation);}if($$self.$$.dirty[0]&/*tabSize*/1073741824){updateTabSize(tabSize);}if($$self.$$.dirty[0]&/*readOnly*/1){updateReadOnly(readOnly);}if($$self.$$.dirty[1]&/*previousEscapeUnicodeCharacters, escapeUnicodeCharacters*/32769){{if(previousEscapeUnicodeCharacters!==escapeUnicodeCharacters){$$invalidate(46,previousEscapeUnicodeCharacters=escapeUnicodeCharacters);forceUpdateText();}}}if($$self.$$.dirty[0]&/*readOnly*/1|$$self.$$.dirty[1]&/*jsonStatus*/65536){$$invalidate(14,repairActions=jsonStatus===JSON_STATUS_REPAIRABLE&&!readOnly?[{icon:faWrench,text:'Auto repair',title:'Automatically repair JSON',onClick:handleRepair}]:[]);}};return[readOnly,mainMenuBar,statusBar,onSwitchToTreeMode,onRenderMenu,text,codeMirrorRef,domTextMode,editorState,validationErrors,editorDisabled,canUndo,canRedo,jsonParseError,repairActions,isNewDocument,isSSR,handleFormat,handleCompact,handleSort,handleTransform,handleToggleSearch,handleUndo,handleRedo,handleAcceptTooLarge,cancelLoadTooLarge,handleSelectValidationError,handleSelectParseError,externalContent,indentation,tabSize,escapeUnicodeCharacters,parser,validator,validationParser,onChange,onError,onFocus,onBlur,onSortModal,onTransformModal,focus,patch,openTransformModal,refresh,validate,previousEscapeUnicodeCharacters,jsonStatus,div_binding,func,div_binding_1];}var TextMode=/*#__PURE__*/function(_SvelteComponent15){_inherits(TextMode,_SvelteComponent15);var _super56=_createSuper(TextMode);function TextMode(options){var _this110;_classCallCheck(this,TextMode);_this110=_super56.call(this);init(_assertThisInitialized(_this110),options,instance$H,create_fragment$H,not_equal,{readOnly:0,mainMenuBar:1,statusBar:2,externalContent:28,indentation:29,tabSize:30,escapeUnicodeCharacters:31,parser:32,validator:33,validationParser:34,onChange:35,onSwitchToTreeMode:3,onError:36,onFocus:37,onBlur:38,onRenderMenu:4,onSortModal:39,onTransformModal:40,focus:41,patch:42,openTransformModal:43,refresh:44,validate:45},add_css$D,[-1,-1,-1]);return _this110;}_createClass(TextMode,[{key:"focus",get:function get(){return this.$$.ctx[41];}},{key:"patch",get:function get(){return this.$$.ctx[42];}},{key:"openTransformModal",get:function get(){return this.$$.ctx[43];}},{key:"refresh",get:function get(){return this.$$.ctx[44];}},{key:"validate",get:function get(){return this.$$.ctx[45];}}]);return TextMode;}(SvelteComponent);var TextMode$1=TextMode;var debug$1=createDebug('jsoneditor:AutoScrollHandler');function createAutoScrollHandler(scrollableElement){debug$1('createAutoScrollHandler',scrollableElement);var autoScrollSpeed;// pixels per second
var autoScrollTimer;function calculateSpeed(diff){return diff<20?AUTO_SCROLL_SPEED_SLOW:diff<50?AUTO_SCROLL_SPEED_NORMAL:AUTO_SCROLL_SPEED_FAST;}function autoScrollCallback(){if(scrollableElement){// debug('auto scroll...')
var diff=autoScrollSpeed*(AUTO_SCROLL_INTERVAL/1000);scrollableElement.scrollTop+=diff;}}function startAutoScroll(speed){if(!autoScrollTimer||speed!==autoScrollSpeed){stopAutoScroll();debug$1('startAutoScroll',speed);autoScrollSpeed=speed;autoScrollTimer=setInterval(autoScrollCallback,AUTO_SCROLL_INTERVAL);}}function stopAutoScroll(){if(autoScrollTimer){debug$1('stopAutoScroll');clearInterval(autoScrollTimer);autoScrollTimer=undefined;autoScrollSpeed=undefined;}}function onDrag(event){if(scrollableElement){var y=event.clientY;var _scrollableElement$ge=scrollableElement.getBoundingClientRect(),_top14=_scrollableElement$ge.top,bottom=_scrollableElement$ge.bottom;if(y<_top14){var speed=calculateSpeed(_top14-y);startAutoScroll(-speed);}else if(y>bottom){var _speed=calculateSpeed(y-bottom);startAutoScroll(_speed);}else{stopAutoScroll();}}}function onDragEnd(){stopAutoScroll();}return{onDrag:onDrag,onDragEnd:onDragEnd};}// Robert Penner's easeInOutQuad
// find the rest of his easing functions here: http://robertpenner.com/easing/
// find them exported for ES6 consumption here: https://github.com/jaxgeller/ez.js
var easeInOutQuad=function easeInOutQuad(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t+b;t--;return-c/2*(t*(t-2)-1)+b;};var createJump=function createJump(){// private variable cache
// no variables are created during a jump, preventing memory leaks
var container;// container element to be scrolled       (node)
var element;// element to scroll to                   (node)
var start;// where scroll starts                    (px)
var stop;// where scroll stops                     (px)
var offset;// adjustment from the stop position      (px)
var easing;// easing function                        (function)
var a11y;// accessibility support flag             (boolean)
var distance;// distance of scroll                     (px)
var duration;// scroll duration                        (ms)
var timeStart;// time scroll started                    (ms)
var timeElapsed;// time spent scrolling thus far          (ms)
var next;// next scroll position                   (px)
var callback;// to call when done scrolling            (function)
var scrolling;// true whilst scrolling                  (boolean)
// scroll position helper
function location(){return container.scrollY||container.pageYOffset||container.scrollTop;}// element offset helper
function top(element){var elementTop=element.getBoundingClientRect().top;var containerTop=container.getBoundingClientRect?container.getBoundingClientRect().top:0;return elementTop-containerTop+start;}// scrollTo helper
function scrollTo(top){container.scrollTo?container.scrollTo(0,top)// window
:container.scrollTop=top;// custom container
}// rAF loop helper
function loop(timeCurrent){// store time scroll started, if not started already
if(!timeStart){timeStart=timeCurrent;}// determine time spent scrolling so far
timeElapsed=timeCurrent-timeStart;// calculate next scroll position
next=easing(timeElapsed,start,distance,duration);// scroll to it
scrollTo(next);scrolling=true;// check progress
timeElapsed<duration?requestAnimationFrame(loop)// continue scroll loop
:done();// scrolling is done
}// scroll finished helper
function done(){// account for rAF time rounding inaccuracies
scrollTo(start+distance);// if scrolling to an element, and accessibility is enabled
if(element&&a11y){// add tabindex indicating programmatic focus
element.setAttribute('tabindex','-1');// focus the element
element.focus();}// if it exists, fire the callback
if(typeof callback==='function'){callback();}// reset time for next jump
timeStart=false;// we're done scrolling
scrolling=false;}// API
function jump(target){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};// resolve options, or use defaults
duration=options.duration||1000;offset=options.offset||0;callback=options.callback;// "undefined" is a suitable default, and won't be called
easing=options.easing||easeInOutQuad;a11y=options.a11y||false;// resolve container
switch(_typeof2(options.container)){case'object':// we assume container is an HTML element (Node)
container=options.container;break;case'string':container=document.querySelector(options.container);break;default:container=window;}// cache starting position
start=location();// resolve target
switch(_typeof2(target)){// scroll from current position
case'number':element=undefined;// no element to scroll to
a11y=false;// make sure accessibility is off
stop=start+target;break;// scroll to element (node)
// bounding rect is relative to the viewport
case'object':element=target;stop=top(element);break;// scroll to element (selector)
// bounding rect is relative to the viewport
case'string':element=document.querySelector(target);stop=top(element);break;}// resolve scroll distance, accounting for offset
distance=stop-start+offset;// resolve duration
switch(_typeof2(options.duration)){// number in ms
case'number':duration=options.duration;break;// function passed the distance of the scroll
case'function':duration=options.duration(distance);break;}// start the loop if we're not already scrolling
if(!scrolling){requestAnimationFrame(loop);}else{// reset time for next jump
timeStart=false;}}// expose only the jump method
return jump;};/**
 * Create sections that can be expanded.
 * Used to display a button like "Show items 100-200"
 */function getExpandItemsSections(startIndex,endIndex){// expand the start of the section
var section1={start:startIndex,end:Math.min(nextRoundNumber(startIndex),endIndex)};// expand the middle of the section
var start2=Math.max(currentRoundNumber((startIndex+endIndex)/2),startIndex);var section2={start:start2,end:Math.min(nextRoundNumber(start2),endIndex)};// expand the end of the section
var currentIndex=currentRoundNumber(endIndex);var previousIndex=currentIndex===endIndex?currentIndex-ARRAY_SECTION_SIZE:currentIndex;var section3={start:Math.max(previousIndex,startIndex),end:endIndex};var sections=[section1];var showSection2=section2.start>=section1.end&&section2.end<=section3.start;if(showSection2){sections.push(section2);}var showSection3=section3.start>=(showSection2?section2.end:section1.end);if(showSection3){sections.push(section3);}return sections;}/**
 * Sort and merge a list with sections
 */function mergeSections(sections){var sortedSections=sortBy(sections,function(section){return section.start;});var mergedSections=[sortedSections[0]];for(var _sortedIndex=0;_sortedIndex<sortedSections.length;_sortedIndex++){var mergedIndex=mergedSections.length-1;var previous=mergedSections[mergedIndex];var current=sortedSections[_sortedIndex];if(current.start<=previous.end){// there is overlap -> replace the previous item
mergedSections[mergedIndex]={start:Math.min(previous.start,current.start),end:Math.max(previous.end,current.end)};}else{// no overlap, just add the item
mergedSections.push(current);}}return mergedSections;}// TODO: write unit test
function inVisibleSection(sections,index){return sections.some(function(section){return index>=section.start&&index<section.end;});}function nextRoundNumber(index){return currentRoundNumber(index)+ARRAY_SECTION_SIZE;}function currentRoundNumber(index){return Math.floor(index/ARRAY_SECTION_SIZE)*ARRAY_SECTION_SIZE;}function createDocumentState(props){var documentState={expandedMap:{},enforceStringMap:{},visibleSectionsMap:{},selection:undefined};if(props!==null&&props!==void 0&&props.select){documentState=_objectSpread2(_objectSpread2({},documentState),{},{selection:props.select(props.json,documentState)});}if(props!==null&&props!==void 0&&props.expand){documentState=expandWithCallback(props.json,documentState,[],props.expand);}return documentState;}function getVisibleSections(documentState,pointer){return documentState.visibleSectionsMap[pointer]||DEFAULT_VISIBLE_SECTIONS;}/**
 * Invoke a callback function for every visible item in the array
 */function forEachVisibleIndex(jsonArray,visibleSections,callback){visibleSections.forEach(function(_ref102){var start=_ref102.start,end=_ref102.end;forEachIndex(start,Math.min(jsonArray.length,end),callback);});}/**
 * Expand all nodes on given path
 */function expandPath(json,documentState,path){var expandedMap=_objectSpread2({},documentState.expandedMap);var visibleSectionsMap=_objectSpread2({},documentState.visibleSectionsMap);for(var _i231=0;_i231<=path.length;_i231++){var partialPath=path.slice(0,_i231);var partialPointer=immutableJSONPatch.exports.compileJSONPointer(partialPath);var value=immutableJSONPatch.exports.getIn(json,partialPath);if(isObjectOrArray(value)){expandedMap[partialPointer]=true;}// if needed, enlarge the expanded sections such that the search result becomes visible in the array
if(Array.isArray(value)&&_i231<path.length){var sections=visibleSectionsMap[partialPointer]||DEFAULT_VISIBLE_SECTIONS;var index=_int(path[_i231]);if(!inVisibleSection(sections,index)){var start=currentRoundNumber(index);var end=nextRoundNumber(start);var newSection={start:start,end:end};visibleSectionsMap[partialPointer]=mergeSections(sections.concat(newSection));}}}return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,visibleSectionsMap:visibleSectionsMap});}/**
 * Expand a node, end expand its children according to the provided callback
 * Nodes that are already expanded will be left untouched
 */function expandWithCallback(json,documentState,path,expandedCallback){var expandedMap=_objectSpread2({},documentState.expandedMap);function recurse(value){var pathIndex=currentPath.length;if(Array.isArray(value)){if(expandedCallback(currentPath)){var pointer=immutableJSONPatch.exports.compileJSONPointer(currentPath);expandedMap[pointer]=true;if(value.length>0){var visibleSections=getVisibleSections(documentState,pointer);forEachVisibleIndex(value,visibleSections,function(index){currentPath[pathIndex]=String(index);recurse(value[index]);});currentPath.pop();}}}else if(isObject$1(value)){if(expandedCallback(currentPath)){expandedMap[immutableJSONPatch.exports.compileJSONPointer(currentPath)]=true;var _keys4=Object.keys(value);if(_keys4.length>0){var _iterator214=_createForOfIteratorHelper(_keys4),_step214;try{for(_iterator214.s();!(_step214=_iterator214.n()).done;){var key=_step214.value;currentPath[pathIndex]=key;recurse(value[key]);}}catch(err){_iterator214.e(err);}finally{_iterator214.f();}currentPath.pop();}}}}var currentPath=path.slice();recurse(immutableJSONPatch.exports.getIn(json,path));return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap});}// TODO: write unit tests
function expandSingleItem(documentState,path){return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:_objectSpread2(_objectSpread2({},documentState.expandedMap),{},_defineProperty2({},immutableJSONPatch.exports.compileJSONPointer(path),true))});}// TODO: write unit tests
function collapsePath(documentState,path){// delete the expanded state of the path and all it's nested paths
var expandedMap=deletePath(documentState.expandedMap,path);var enforceStringMap=deletePath(documentState.enforceStringMap,path);var visibleSectionsMap=deletePath(documentState.visibleSectionsMap,path);return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,enforceStringMap:enforceStringMap,visibleSectionsMap:visibleSectionsMap});}// TODO: write unit tests
function setEnforceString(documentState,pointer,enforceString){if(enforceString){var updatedEnforceString=_objectSpread2({},documentState.enforceStringMap);updatedEnforceString[pointer]=enforceString;return _objectSpread2(_objectSpread2({},documentState),{},{enforceStringMap:updatedEnforceString});}else{// remove if defined
if(typeof documentState.enforceStringMap[pointer]==='boolean'){var _updatedEnforceString=_objectSpread2({},documentState.enforceStringMap);delete _updatedEnforceString[pointer];return _objectSpread2(_objectSpread2({},documentState),{},{enforceStringMap:_updatedEnforceString});}else{return documentState;}}}/**
 * Expand a section of items in an array
 */function expandSection(json,documentState,pointer,section){return _objectSpread2(_objectSpread2({},documentState),{},{visibleSectionsMap:_objectSpread2(_objectSpread2({},documentState.visibleSectionsMap),{},_defineProperty2({},pointer,mergeSections(getVisibleSections(documentState,pointer).concat(section))))});}/**
 * Apply patch operations to both json and state
 */function documentStatePatch(json,documentState,operations){var updatedJson=immutableJSONPatch.exports.immutableJSONPatch(json,operations);var updatedDocumentState=operations.reduce(function(updatingState,operation){if(immutableJSONPatch.exports.isJSONPatchAdd(operation)){return documentStateAdd(updatedJson,updatingState,operation);}if(immutableJSONPatch.exports.isJSONPatchRemove(operation)){return documentStateRemove(updatedJson,updatingState,operation);}if(immutableJSONPatch.exports.isJSONPatchReplace(operation)){return documentStateReplace(updatedJson,updatingState,operation);}if(immutableJSONPatch.exports.isJSONPatchCopy(operation)||immutableJSONPatch.exports.isJSONPatchMove(operation)){return documentStateMoveOrCopy(updatedJson,updatingState,operation);}return updatingState;},documentState);return{json:updatedJson,documentState:updatedDocumentState};}function documentStateAdd(json,documentState,operation){var path=immutableJSONPatch.exports.parsePath(json,operation.path);var parentPath=initial(path);var parentPointer=immutableJSONPatch.exports.compileJSONPointer(parentPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONArray(parent)){var index=_int(last(path));// shift all paths of the relevant parts of the state
var expandedMap=shiftPath(documentState.expandedMap,parentPath,index,1);var enforceStringMap=shiftPath(documentState.enforceStringMap,parentPath,index,1);var visibleSectionsMap=shiftPath(documentState.visibleSectionsMap,parentPath,index,1);// shift visible sections of array
visibleSectionsMap=updateInPathsMap(visibleSectionsMap,parentPointer,function(sections){return shiftVisibleSections(sections,index,1);});return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,enforceStringMap:enforceStringMap,visibleSectionsMap:visibleSectionsMap});}// object, nothing to do
return documentState;}function documentStateRemove(updatedJson,documentState,operation){var path=immutableJSONPatch.exports.parsePath(updatedJson,operation.path);var parentPath=initial(path);var parentPointer=immutableJSONPatch.exports.compileJSONPointer(parentPath);var parent=immutableJSONPatch.exports.getIn(updatedJson,parentPath);var expandedMap=documentState.expandedMap,enforceStringMap=documentState.enforceStringMap,visibleSectionsMap=documentState.visibleSectionsMap;// delete the path itself and its children
expandedMap=deletePath(expandedMap,path);enforceStringMap=deletePath(enforceStringMap,path);visibleSectionsMap=deletePath(visibleSectionsMap,path);if(immutableJSONPatch.exports.isJSONArray(parent)){var index=_int(last(path));// shift all paths of the relevant parts of the state
expandedMap=shiftPath(expandedMap,parentPath,index,-1);enforceStringMap=shiftPath(enforceStringMap,parentPath,index,-1);visibleSectionsMap=shiftPath(visibleSectionsMap,parentPath,index,-1);// shift visible sections of array
visibleSectionsMap=updateInPathsMap(visibleSectionsMap,parentPointer,function(sections){return shiftVisibleSections(sections,index,-1);});}return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,enforceStringMap:enforceStringMap,visibleSectionsMap:visibleSectionsMap});}function documentStateReplace(updatedJson,documentState,operation){var pointer=operation.path;// cleanup state from paths that are removed now
var expandedMap=cleanupNonExistingPaths(updatedJson,documentState.expandedMap);var enforceStringMap=cleanupNonExistingPaths(updatedJson,documentState.enforceStringMap);var visibleSectionsMap=cleanupNonExistingPaths(updatedJson,documentState.visibleSectionsMap);// cleanup props of the object/array/value itself that are not applicable anymore
if(!immutableJSONPatch.exports.isJSONObject(operation.value)&&!immutableJSONPatch.exports.isJSONArray(operation.value)){delete expandedMap[pointer];}if(!immutableJSONPatch.exports.isJSONArray(operation.value)){delete visibleSectionsMap[pointer];}if(immutableJSONPatch.exports.isJSONObject(operation.value)||immutableJSONPatch.exports.isJSONArray(operation.value)){delete enforceStringMap[pointer];}return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,enforceStringMap:enforceStringMap,visibleSectionsMap:visibleSectionsMap});}function documentStateMoveOrCopy(updatedJson,documentState,operation){if(immutableJSONPatch.exports.isJSONPatchMove(operation)&&operation.from===operation.path){// nothing to do
return documentState;}// get the state that we will move or copy, and move it to the new location
var renamePointer=function renamePointer(pointer){return operation.path+pointer.substring(operation.from.length);};var expandedMapCopy=movePath(filterPath(documentState.expandedMap,operation.from),renamePointer);var enforceStringMapCopy=movePath(filterPath(documentState.enforceStringMap,operation.from),renamePointer);var visibleSectionsMapCopy=movePath(filterPath(documentState.visibleSectionsMap,operation.from),renamePointer);// patch the document state: use the remove and add operations to apply a move or copy
// note that `value` is just a fake value, we do not use this for real
var updatedState=documentState;if(immutableJSONPatch.exports.isJSONPatchMove(operation)){updatedState=documentStateRemove(updatedJson,updatedState,{op:'remove',path:operation.from});}updatedState=documentStateAdd(updatedJson,updatedState,{op:'add',path:operation.path,value:null});// merge the original and the copied state
var expandedMap=mergePaths(updatedState.expandedMap,expandedMapCopy);var enforceStringMap=mergePaths(updatedState.enforceStringMap,enforceStringMapCopy);var visibleSectionsMap=mergePaths(updatedState.visibleSectionsMap,visibleSectionsMapCopy);return _objectSpread2(_objectSpread2({},documentState),{},{expandedMap:expandedMap,enforceStringMap:enforceStringMap,visibleSectionsMap:visibleSectionsMap});}/**
 * Delete a path from a PathsMap. Will delete the path and its child paths
 * IMPORTANT: will NOT shift array items when an array item is removed, use shiftPath for that
 */function deletePath(map,path){var updatedMap={};var pointer=immutableJSONPatch.exports.compileJSONPointer(path);// partition the contents of the map
Object.keys(map).forEach(function(itemPointer){if(!immutableJSONPatch.exports.startsWithJSONPointer(itemPointer,pointer)){updatedMap[itemPointer]=map[itemPointer];}});return updatedMap;}// TODO: unit test
function filterPath(map,pointer){var filteredMap={};Object.keys(map).forEach(function(itemPointer){if(immutableJSONPatch.exports.startsWithJSONPointer(itemPointer,pointer)){filteredMap[itemPointer]=map[itemPointer];}});return filteredMap;}// TODO: unit test
function mergePaths(a,b){return _objectSpread2(_objectSpread2({},a),b);}// TODO: unit test
function movePath(map,changePointer){var movedMap={};Object.keys(map).forEach(function(oldPointer){var newPointer=changePointer(oldPointer);movedMap[newPointer]=map[oldPointer];});return movedMap;}function shiftPath(map,path,index,offset){var indexPathPos=path.length;var pointer=immutableJSONPatch.exports.compileJSONPointer(path);// collect all paths that need to be shifted, with their old path, new path, and value
var matches=[];for(var _i232=0,_Object$keys4=Object.keys(map);_i232<_Object$keys4.length;_i232++){var itemPointer=_Object$keys4[_i232];if(immutableJSONPatch.exports.startsWithJSONPointer(itemPointer,pointer)){var itemPath=immutableJSONPatch.exports.parseJSONPointer(itemPointer);var pathIndex=_int(itemPath[indexPathPos]);if(pathIndex>=index){itemPath[indexPathPos]=String(pathIndex+offset);matches.push({oldPointer:itemPointer,newPointer:immutableJSONPatch.exports.compileJSONPointer(itemPath),value:map[itemPointer]});}}}// if there are no changes, just return the original map
if(matches.length===0){return map;}var updatedMap=_objectSpread2({},map);// delete all old paths from the map
// we do this *before* inserting new paths to prevent deleting a math that is already moved
matches.forEach(function(match){delete updatedMap[match.oldPointer];});// insert shifted paths in the map
matches.forEach(function(match){updatedMap[match.newPointer]=match.value;});return updatedMap;}// TODO: unit test
function cleanupNonExistingPaths(json,map){var updatedMap={};// TODO: for optimization, we could pass a filter callback which allows you to filter paths
//  starting with a specific, so you don't need to invoke parseJSONPointer and existsIn for largest part
Object.keys(map).filter(function(pointer){return immutableJSONPatch.exports.existsIn(json,immutableJSONPatch.exports.parsePath(json,pointer));}).forEach(function(pointer){updatedMap[pointer]=map[pointer];});return updatedMap;}/**
 * Update a value in a PathsMap.
 * When the path exists, the callback will be invoked.
 * When the path does not exist, the callback is not invoked.
 */function updateInPathsMap(map,pointer,callback){var value=map[pointer];if(pointer in map){var updatedValue=callback(value);if(!isEqual$1(value,updatedValue)){var updatedMap=_objectSpread2({},map);if(updatedValue===undefined){delete updatedMap[pointer];}else{updatedMap[pointer]=updatedValue;}return updatedMap;}}return map;}/**
 * Shift visible sections in an Array with a specified offset
 */function shiftVisibleSections(visibleSections,index,offset){return visibleSections.map(function(section){return{start:section.start>index?section.start+offset:section.start,end:section.end>=index?section.end+offset:section.end};});}function getEnforceString(value,enforceStringMap,pointer,parser){var enforceString=enforceStringMap?enforceStringMap[pointer]:undefined;if(typeof enforceString==='boolean'){return enforceString;}return isStringContainingPrimitiveValue(value,parser);}function getNextKeys(keys,key){var includeKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var index=keys.indexOf(key);if(index!==-1){return includeKey?keys.slice(index):keys.slice(index+1);}else{// a new key, that doesn't have next keys
return[];}}/**
 * Get all paths which are visible and rendered
 */ // TODO: create memoized version of getVisiblePaths which remembers just the previous result if json and state are the same
function getVisiblePaths(json,documentState){var paths=[];function _recurse(value,path){paths.push(path);var pointer=immutableJSONPatch.exports.compileJSONPointer(path);if(value&&documentState.expandedMap[pointer]===true){if(immutableJSONPatch.exports.isJSONArray(value)){var visibleSections=getVisibleSections(documentState,pointer);forEachVisibleIndex(value,visibleSections,function(index){_recurse(value[index],path.concat(String(index)));});}if(immutableJSONPatch.exports.isJSONObject(value)){Object.keys(value).forEach(function(key){_recurse(value[key],path.concat(key));});}}}_recurse(json,[]);return paths;}/**
 * Get all caret position which are visible and rendered:
 * before a node, at a key, at a value, appending an object/array
 */ // TODO: create memoized version of getVisibleCaretPositions which remembers just the previous result if json and state are the same
function getVisibleCaretPositions(json,documentState){var includeInside=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var paths=[];function _recurse(value,path){paths.push({path:path,type:CaretType.value});var pointer=immutableJSONPatch.exports.compileJSONPointer(path);if(value&&documentState.expandedMap[pointer]===true){if(includeInside){paths.push({path:path,type:CaretType.inside});}if(immutableJSONPatch.exports.isJSONArray(value)){var visibleSections=getVisibleSections(documentState,pointer);forEachVisibleIndex(value,visibleSections,function(index){var itemPath=path.concat(String(index));_recurse(value[index],itemPath);if(includeInside){paths.push({path:itemPath,type:CaretType.after});}});}if(immutableJSONPatch.exports.isJSONObject(value)){var _keys5=Object.keys(value);_keys5.forEach(function(key){var propertyPath=path.concat(key);paths.push({path:propertyPath,type:CaretType.key});_recurse(value[key],propertyPath);if(includeInside){paths.push({path:propertyPath,type:CaretType.after});}});}}}_recurse(json,[]);return paths;}/**
 * Find the previous visible path.
 * This can be the last child of the previous object or array, or the parent of a first entry.
 */ // TODO: write tests for getPreviousVisiblePath
function getPreviousVisiblePath(json,documentState,path){var visiblePaths=getVisiblePaths(json,documentState);var visiblePathPointers=visiblePaths.map(immutableJSONPatch.exports.compileJSONPointer);var pathPointer=immutableJSONPatch.exports.compileJSONPointer(path);var index=visiblePathPointers.indexOf(pathPointer);if(index!==-1&&index>0){return visiblePaths[index-1];}return null;}/**
 * Find the next visible path.
 * This can be the next parent entry.
 */ // TODO: write tests for getNextVisiblePath
function getNextVisiblePath(json,documentState,path){var visiblePaths=getVisiblePaths(json,documentState);var visiblePathPointers=visiblePaths.map(immutableJSONPatch.exports.compileJSONPointer);var index=visiblePathPointers.indexOf(immutableJSONPatch.exports.compileJSONPointer(path));if(index!==-1&&index<visiblePaths.length-1){return visiblePaths[index+1];}return null;}var MAX_HISTORY_ITEMS=1000;var debug=createDebug('jsoneditor:History');function createHistory(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var maxItems=options.maxItems||MAX_HISTORY_ITEMS;/**
     * items in history are sorted from newest first to oldest last
     */var items=[];var index=0;function canUndo(){return index<items.length;}function canRedo(){return index>0;}function getState(){return{canUndo:canUndo(),canRedo:canRedo(),length:items.length};}function handleChange(){if(options.onChange){options.onChange(getState());}}function add(item){debug('add',item);items=[item].concat(items.slice(index)).slice(0,maxItems);index=0;handleChange();}function clear(){debug('clear');items=[];index=0;handleChange();}function undo(){if(canUndo()){var item=items[index];index+=1;debug('undo',item);handleChange();return item;}return undefined;}function redo(){if(canRedo()){index-=1;debug('redo',items[index]);handleChange();return items[index];}return undefined;}return{add:add,clear:clear,getState:getState,undo:undo,redo:redo};}/**
 * Find a unique name. Suffix the name with ' (copy)', '(copy 2)', etc
 * until a unique name is found
 * @param name    Proposed name
 * @param keys    Array with existing keys
 */function findUniqueName(name,keys){var keysSet=new Set(keys);// remove any " (copy)" or " (copy 2)" suffix from the name
var nameWithoutCopySuffix=name.replace(/ \(copy( \d+)?\)$/,'');var validName=name;var i=1;while(keysSet.has(validName)){var copy='copy'+(i>1?' '+i:'');validName="".concat(nameWithoutCopySuffix," (").concat(copy,")");i++;}return validName;}/**
 * Truncate a text to a maximum length.
 * When truncated, the text will pe appended with ellipsis '...'
 * @param text Text to be truncated
 * @param maxLength Maximum allowed length for the text including ellipsis
 */function truncate(text,maxLength){var ellipsis='...';var maxTextLength=maxLength-ellipsis.length;return text.length>maxLength?text.substring(0,maxTextLength)+ellipsis:text;}/**
 * Cast contents of a string to the correct type.
 * This can be a string, a number, a boolean, null, undefined, etc
 * @param str
 * @return parsed string
 */function parseString(str){if(str===''){return'';}var lower=str.toLowerCase();if(lower==='null'){return null;}if(lower==='true'){return true;}if(lower==='false'){return false;}if(lower==='undefined'){return undefined;}var num=Number(str);// will nicely fail with '123ab'
var numFloat=parseFloat(str);// will nicely fail with '  '
if(!isNaN(num)&&!isNaN(numFloat)){return num;}return str;}function isAfterSelection(selection){return selection&&selection.type===SelectionType.after;}function isInsideSelection(selection){return selection&&selection.type===SelectionType.inside;}function isKeySelection(selection){return selection&&selection.type===SelectionType.key;}function isValueSelection(selection){return selection&&selection.type===SelectionType.value;}function isMultiSelection(selection){return selection&&selection.type===SelectionType.multi;}/**
 * Expand a selection start and end into an array containing all paths
 * between (and including) start and end
 */function expandSelection(json,anchorPath,focusPath){if(isEqual$1(anchorPath,focusPath)){// just a single node
return[anchorPath];}else{// multiple nodes
var sharedPath=findSharedPath(anchorPath,focusPath);if(anchorPath.length===sharedPath.length||focusPath.length===sharedPath.length){// a parent and a child, like ['arr', 1] and ['arr']
return[sharedPath];}var anchorKey=anchorPath[sharedPath.length];var focusKey=focusPath[sharedPath.length];var value=immutableJSONPatch.exports.getIn(json,sharedPath);if(immutableJSONPatch.exports.isJSONObject(value)){var _keys6=Object.keys(value);var anchorIndex=_keys6.indexOf(anchorKey);var focusIndex=_keys6.indexOf(focusKey);if(anchorIndex!==-1&&focusIndex!==-1){var startIndex=Math.min(anchorIndex,focusIndex);var endIndex=Math.max(anchorIndex,focusIndex);var paths=[];for(var _i233=startIndex;_i233<=endIndex;_i233++){paths.push(sharedPath.concat(_keys6[_i233]));}return paths;}}if(immutableJSONPatch.exports.isJSONArray(value)){var _startIndex=Math.min(_int(anchorKey),_int(focusKey));var _endIndex=Math.max(_int(anchorKey),_int(focusKey));var _paths=[];for(var _i234=_startIndex;_i234<=_endIndex;_i234++){_paths.push(sharedPath.concat(String(_i234)));}return _paths;}}throw new Error('Failed to create selection');}function getParentPath(selection){if(isInsideSelection(selection)){return selection.focusPath;}else{return initial(selection.focusPath);}}function getStartPath(selection){return isMultiSelection(selection)?head(selection.paths):selection.focusPath;}function getEndPath(selection){return isMultiSelection(selection)?last(selection.paths):selection.focusPath;}// TODO: write unit test
function isSelectionInsidePath(selection,path){return pathStartsWith(selection.focusPath,path)&&(selection.focusPath.length>path.length||isInsideSelection(selection));}// TODO: write unit test
function isPathInsideSelection(selection,path,anchorType){if(!selection){return false;}var p=path.slice(0);if(isMultiSelection(selection)){while(p.length>0){if(selection.pointersMap[immutableJSONPatch.exports.compileJSONPointer(p)]===true){return true;}p.pop();}}if(isKeySelection(selection)){return anchorType===SelectionType.key&&isEqual$1(selection.focusPath,path);}if(isValueSelection(selection)){if(anchorType===SelectionType.value&&isEqual$1(selection.focusPath,path)){return true;}if(pathStartsWith(path,selection.focusPath)&&path.length>selection.focusPath.length&&(anchorType===SelectionType.key||anchorType===SelectionType.value||anchorType===SelectionType.multi)){return true;}}return false;}function getSelectionUp(json,documentState){var keepAnchorPath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var useFocusPath=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var selection=documentState.selection;var path=!useFocusPath&&isMultiSelection(selection)?head(selection.paths):selection.focusPath;var previousPath=getPreviousVisiblePath(json,documentState,path);if(previousPath===null){return null;}var anchorPath=previousPath;var focusPath=previousPath;if(keepAnchorPath){// multi selection
if(isAfterSelection(selection)||isInsideSelection(selection)){return createMultiSelection(json,selection.anchorPath,selection.anchorPath);}return createMultiSelection(json,selection.anchorPath,focusPath);}if(isKeySelection(selection)){var parentPath=initial(previousPath);var _parent18=immutableJSONPatch.exports.getIn(json,parentPath);if(Array.isArray(_parent18)||isEmpty(previousPath)){// switch to value selection: array has no keys, and root object also not
return createValueSelection(previousPath,false);}else{return createKeySelection(previousPath,false);}}if(isValueSelection(selection)){return createValueSelection(previousPath,false);}if(isAfterSelection(selection)){// select the node itself, not the previous node,
// FIXME: when after an expanded object/array, should go to the last item inside the object/array
return createMultiSelection(json,path,path);}if(isInsideSelection(selection)){// select the node itself, not the previous node,
return createMultiSelection(json,path,path);}// multi selection -> select previous node
return createMultiSelection(json,anchorPath,focusPath);}function getSelectionDown(json,documentState){var keepAnchorPath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var useFocusPath=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var selection=documentState.selection;// TODO: this function is too large, break it down in two separate functions: one for keepAnchorPath = true, and one for keepAnchorPath = false?
var path=!useFocusPath&&isMultiSelection(selection)?last(selection.paths):selection.focusPath;var nextPath=getNextVisiblePath(json,documentState,path);var anchorPath=nextPath;var focusPath=nextPath;if(nextPath===null){return null;}if(keepAnchorPath){// if the focusPath is an Array or object, we must not step into it but
// over it, we pass state with this array/object collapsed
var collapsedState=isObjectOrArray(immutableJSONPatch.exports.getIn(json,path))?collapsePath(documentState,path):documentState;var nextPathAfter=getNextVisiblePath(json,collapsedState,path);// multi selection
if(nextPathAfter===null){return null;}if(isAfterSelection(selection)){return createMultiSelection(json,nextPathAfter,nextPathAfter);}if(isInsideSelection(selection)){return createMultiSelection(json,anchorPath,focusPath);}return createMultiSelection(json,selection.anchorPath,nextPathAfter);}if(isKeySelection(selection)){var parentPath=initial(nextPath);var _parent19=immutableJSONPatch.exports.getIn(json,parentPath);if(Array.isArray(_parent19)){// switch to value selection: array has no keys
return createValueSelection(focusPath,false);}else{return createKeySelection(focusPath,false);}}if(isValueSelection(selection)){return createValueSelection(focusPath,false);}// TODO: simplify, this is redundant, same as next
if(isInsideSelection(selection)){return createMultiSelection(json,anchorPath,focusPath);}// selection type MULTI or AFTER
return createMultiSelection(json,nextPath,nextPath);}/**
 * Get the next selection for a value inside the current object/array
 * If there is no next value, select AFTER.
 * Only applicable for ValueSelection
 */function getSelectionNextInside(json,documentState,path){// TODO: write unit tests for getSelectionNextInside
var parentPath=initial(path);var childPath=[last(path)];var nextPathInside=getNextVisiblePath(immutableJSONPatch.exports.getIn(json,parentPath),documentState,childPath);if(nextPathInside){return createValueSelection(parentPath.concat(nextPathInside),false);}else{return createAfterSelection(path);}}/**
 * Find the caret position and its siblings for a given selection
 */ // TODO: unit test
function findCaretAndSiblings(json,documentState,includeInside){var selection=documentState.selection;var visibleCaretPositions=getVisibleCaretPositions(json,documentState,includeInside);var index=visibleCaretPositions.findIndex(function(caret){return isEqual$1(caret.path,selection.focusPath)&&String(caret.type)===String(selection.type);});return{caret:index!==-1?visibleCaretPositions[index]:null,previous:index!==-1&&index>0?visibleCaretPositions[index-1]:null,next:index!==-1&&index<visibleCaretPositions.length-1?visibleCaretPositions[index+1]:null};}function getSelectionLeft(json,documentState){var keepAnchorPath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var includeInside=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var selection=documentState.selection;var _findCaretAndSiblings=findCaretAndSiblings(json,documentState,includeInside),caret=_findCaretAndSiblings.caret,previous=_findCaretAndSiblings.previous;if(keepAnchorPath){if(!isMultiSelection(selection)){return createMultiSelection(json,selection.anchorPath,selection.focusPath);}return null;}if(caret&&previous){return fromCaretPosition(previous);}var parentPath=initial(selection.focusPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(isValueSelection(selection)&&Array.isArray(parent)){return createMultiSelection(json,selection.focusPath,selection.focusPath);}if(isMultiSelection(selection)&&!Array.isArray(parent)){return createKeySelection(selection.focusPath,false);}return null;}function getSelectionRight(json,documentState){var keepAnchorPath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var includeInside=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var selection=documentState.selection;var _findCaretAndSiblings2=findCaretAndSiblings(json,documentState,includeInside),caret=_findCaretAndSiblings2.caret,next=_findCaretAndSiblings2.next;if(keepAnchorPath){if(!isMultiSelection(selection)){return createMultiSelection(json,selection.anchorPath,selection.focusPath);}return null;}if(caret&&next){return fromCaretPosition(next);}if(isMultiSelection(selection)){return createValueSelection(selection.focusPath,false);}return null;}/**
 * Get a proper initial selection based on what is visible
 */function getInitialSelection(json,documentState){var visiblePaths=getVisiblePaths(json,documentState);// find the first, deepest nested entry (normally a value, not an Object/Array)
var index=0;while(index<visiblePaths.length-1&&visiblePaths[index+1].length>visiblePaths[index].length){index++;}var path=visiblePaths[index];return path.length===0||Array.isArray(immutableJSONPatch.exports.getIn(json,initial(path)))?createValueSelection(path,false)// Array items and root object/array do not have a key, so select value in that case
:createKeySelection(path,false);}function createSelectionFromOperations(json,operations){if(operations.length===1){var operation=head(operations);if(operation.op==='replace'||operation.op==='move'){// replaced value
var path=immutableJSONPatch.exports.parsePath(json,operation.path);return createValueSelection(path,false);}}if(!isEmpty(operations)&&operations.every(function(operation){return operation.op==='move';})){var firstOp=head(operations);var otherOps=operations.slice(1);if((immutableJSONPatch.exports.isJSONPatchCopy(firstOp)||immutableJSONPatch.exports.isJSONPatchMove(firstOp))&&firstOp.from!==firstOp.path&&otherOps.every(function(op){return(immutableJSONPatch.exports.isJSONPatchCopy(op)||immutableJSONPatch.exports.isJSONPatchMove(op))&&op.from===op.path;})){// a renamed key
var _path=immutableJSONPatch.exports.parsePath(json,firstOp.path);return createKeySelection(_path,false);}}var paths=operations.filter(function(operation){return operation.op!=='test'&&operation.op!=='remove'&&(operation.op!=='move'||operation.from!==operation.path)&&typeof operation.path==='string';}).map(function(operation){return immutableJSONPatch.exports.parsePath(json,operation.path);});if(isEmpty(paths)){return null;}// TODO: make this function robust against operations which do not have consecutive paths or have wrongly ordered paths
return{type:SelectionType.multi,paths:paths,anchorPath:head(paths),focusPath:last(paths),pointersMap:createPointersMap(paths)};}// TODO: write unit tests
function createPointersMap(paths){var pointersMap={};paths.forEach(function(path){pointersMap[immutableJSONPatch.exports.compileJSONPointer(path)]=true;});return pointersMap;}// TODO: write unit tests
function createSinglePointersMap(path){return _defineProperty2({},immutableJSONPatch.exports.compileJSONPointer(path),true);}/**
 * Find the common path of two paths.
 * For example findCommonRoot(['arr', '1', 'name'], ['arr', '1', 'address', 'contact']) returns ['arr', '1']
 */ // TODO: write unit tests for findSharedPath
function findSharedPath(path1,path2){var i=0;while(i<path1.length&&i<path2.length&&path1[i]===path2[i]){i++;}return path1.slice(0,i);}function singleItemSelected(selection){return selection&&(isKeySelection(selection)||isValueSelection(selection)||isMultiSelection(selection)&&selection.paths.length===1);}function findRootPath(json,selection){return singleItemSelected(selection)&&isObjectOrArray(immutableJSONPatch.exports.getIn(json,selection.focusPath))?selection.focusPath:initial(selection.focusPath);// the parent path of the paths
}// TODO: unit test
function pathStartsWith(path,parentPath){if(path.length<parentPath.length){return false;}for(var _i235=0;_i235<parentPath.length;_i235++){if(path[_i235]!==parentPath[_i235]){return false;}}return true;}// TODO: write unit tests
function removeEditModeFromSelection(documentState){var selection=documentState.selection;if((isKeySelection(selection)||isValueSelection(selection))&&selection.edit){return _objectSpread2(_objectSpread2({},documentState),{},{selection:_objectSpread2(_objectSpread2({},selection),{},{edit:false})});}return documentState;}function createKeySelection(path,edit){return{type:SelectionType.key,anchorPath:path,focusPath:path,pointersMap:createSinglePointersMap(path),edit:edit};}function createValueSelection(path,edit){return{type:SelectionType.value,anchorPath:path,focusPath:path,pointersMap:createSinglePointersMap(path),edit:edit};}function createInsideSelection(path){return{type:SelectionType.inside,anchorPath:path,focusPath:path,pointersMap:createSinglePointersMap(path)};}function createAfterSelection(path){return{type:SelectionType.after,anchorPath:path,focusPath:path,pointersMap:createSinglePointersMap(path)};}function createMultiSelection(json,anchorPath,focusPath){var paths=expandSelection(json,anchorPath,focusPath);// the original anchorPath or focusPath may be somewhere inside the
// returned paths: when one of the two paths is inside an object and the
// other is outside. Then the selection is enlarged to span the whole object.
var focusPathLast=pathStartsWith(focusPath,last(paths))||pathStartsWith(anchorPath,head(paths));return{type:SelectionType.multi,anchorPath:focusPathLast?head(paths):last(paths),focusPath:focusPathLast?last(paths):head(paths),paths:paths,pointersMap:createPointersMap(paths)};}/**
 * Turn selected contents into plain text partial JSON, usable for copying to
 * clipboard for example.
 */function selectionToPartialJson(json,selection,indentation,parser){if(isKeySelection(selection)){return String(last(selection.focusPath));}if(isValueSelection(selection)){var value=immutableJSONPatch.exports.getIn(json,selection.focusPath);return typeof value==='string'?value:parser.stringify(value,null,indentation);// TODO: customizable indentation?
}if(isMultiSelection(selection)){if(isEmpty(selection.focusPath)){// root object -> does not have a parent key/index
return parser.stringify(json,null,indentation);}var parentPath=getParentPath(selection);var _parent20=immutableJSONPatch.exports.getIn(json,parentPath);if(Array.isArray(_parent20)){if(selection.paths.length===1){// do not suffix a single selected array item with a comma
var item=immutableJSONPatch.exports.getIn(json,head(selection.paths));return parser.stringify(item,null,indentation);}else{return selection.paths.map(function(path){var item=immutableJSONPatch.exports.getIn(json,path);return"".concat(parser.stringify(item,null,indentation),",");}).join('\n');}}else{// parent is Object
return selection.paths.map(function(path){var key=last(path);var value=immutableJSONPatch.exports.getIn(json,path);return"".concat(parser.stringify(key),": ").concat(parser.stringify(value,null,indentation),",");}).join('\n');}}return null;}function getSelectionPaths(selection){return isMultiSelection(selection)?selection.paths:[selection.focusPath];}function isEditingSelection(selection){return(isKeySelection(selection)||isValueSelection(selection))&&selection.edit;}function updateSelectionInDocumentState(documentState,selection){var replaceIfUndefined=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(selection===undefined&&!replaceIfUndefined){return documentState;}return _objectSpread2(_objectSpread2({},documentState),{},{selection:selection});}/**
 * Create a selection which selects the whole document
 */ // TODO: write tests
function selectAll(){return createValueSelection([],false);}/**
 * Test whether the current selection can be converted.
 * That is the case when the selection is a key/value, or a multi selection with only one path
 */function canConvert(selection){if(!selection){return false;}if(isKeySelection(selection)||isValueSelection(selection)){return true;}if(isMultiSelection(selection)&&selection.paths.length===1){return true;}}// TODO: unit test
function fromCaretPosition(caretPosition){switch(caretPosition.type){case CaretType.key:return createKeySelection(caretPosition.path,false);case CaretType.value:return createValueSelection(caretPosition.path,false);case CaretType.after:return createAfterSelection(caretPosition.path);case CaretType.inside:return createInsideSelection(caretPosition.path);}}// TODO: unit test
function fromSelectionType(json,selectionType,path){switch(selectionType){case SelectionType.key:return createKeySelection(path,false);case SelectionType.value:return createValueSelection(path,false);case SelectionType.after:return createAfterSelection(path);case SelectionType.inside:return createInsideSelection(path);case SelectionType.multi:return createMultiSelection(json,path,path);}}function selectionIfOverlapping(selection,pointer){if(!selection){return undefined;}return Object.keys(selection.pointersMap).some(function(p){return immutableJSONPatch.exports.startsWithJSONPointer(p,pointer)||immutableJSONPatch.exports.startsWithJSONPointer(pointer,p);})?selection:undefined;}/**
 * Create a JSONPatch for an insert operation.
 *
 * This function needs the current data in order to be able to determine
 * a unique property name for the inserted node in case of duplicating
 * and object property
 */ // TODO: write tests
function insertBefore(json,path,values){var parentPath=initial(path);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONArray(parent)){// the path is parsed from a JSONPatch operation,
// so array indices are a string which we have to parse into a number
var offset=_int(last(path));return values.map(function(entry,index){return{op:'add',path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(offset+index))),value:entry.value};});}else if(immutableJSONPatch.exports.isJSONObject(parent)){// 'object'
var afterKey=last(path);var _keys7=Object.keys(parent);var nextKeys=getNextKeys(_keys7,afterKey,true);return[].concat(_toConsumableArray2(values.map(function(entry){var newProp=findUniqueName(entry.key,_keys7);return{op:'add',path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(newProp)),value:entry.value};})),_toConsumableArray2(nextKeys.map(function(key){return moveDown(parentPath,key);})));}else{throw new Error('Cannot create insert operations: parent must be an Object or Array');}}/**
 * Create a JSONPatch for an append operation. The values will be appended
 * to the end of the array or object.
 *
 * This function needs the current data in order to be able to determine
 * a unique property name for the inserted node in case of duplicating
 * and object property
 */function append(json,path,values){var parent=immutableJSONPatch.exports.getIn(json,path);if(Array.isArray(parent)){var offset=parent.length;return values.map(function(entry,index){return{op:'add',path:immutableJSONPatch.exports.compileJSONPointer(path.concat(String(offset+index))),value:entry.value};});}else{// 'object'
return values.map(function(entry){var newProp=findUniqueName(entry.key,Object.keys(parent));return{op:'add',path:immutableJSONPatch.exports.compileJSONPointer(path.concat(newProp)),value:entry.value};});}}/**
 * Rename an object key
 * Not applicable to arrays
 */function rename(parentPath,keys,oldKey,newKey){var filteredKeys=keys.filter(function(key){return key!==oldKey;});var newKeyUnique=findUniqueName(newKey,filteredKeys);var nextKeys=getNextKeys(keys,oldKey,false);return[// rename a key
{op:'move',from:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(oldKey)),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(newKeyUnique))}].concat(_toConsumableArray2(nextKeys.map(function(key){return moveDown(parentPath,key);})));}/**
 * Create a JSONPatch for an insert operation.
 *
 * This function needs the current data in order to be able to determine
 * a unique property name for the inserted node in case of duplicating
 * and object property
 */function replace(json,paths,values){var firstPath=head(paths);var parentPath=initial(firstPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONArray(parent)){var _firstPath=head(paths);var offset=_firstPath?_int(last(_firstPath)):0;return[].concat(_toConsumableArray2(removeAll(paths)),_toConsumableArray2(values.map(function(entry,index){var operation={op:'add',path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(index+offset))),value:entry.value};return operation;})));}else if(immutableJSONPatch.exports.isJSONObject(parent)){// parent is Object
// if we're going to replace an existing object with key "a" with a new
// key "a", we must not create a new unique name "a (copy)".
var lastPath=last(paths);var _parentPath=initial(lastPath);var beforeKey=last(lastPath);var _keys8=Object.keys(parent);var nextKeys=getNextKeys(_keys8,beforeKey,false);var removeKeys=new Set(paths.map(function(path){return last(path);}));var filteredKeys=_keys8.filter(function(key){return!removeKeys.has(key);});return[].concat(_toConsumableArray2(removeAll(paths)),_toConsumableArray2(values.map(function(entry){var newProp=findUniqueName(entry.key,filteredKeys);return{op:'add',path:immutableJSONPatch.exports.compileJSONPointer(_parentPath.concat(newProp)),value:entry.value};})),_toConsumableArray2(nextKeys.map(function(key){return moveDown(_parentPath,key);})));}else{throw new Error('Cannot create replace operations: parent must be an Object or Array');}}/**
 * Create a JSONPatch for a duplicate action.
 *
 * This function needs the current data in order to be able to determine
 * a unique property name for the duplicated node in case of duplicating
 * and object property
 */function duplicate(json,paths){// FIXME: here we assume selection.paths is sorted correctly, that's a dangerous assumption
var lastPath=last(paths);if(isEmpty(lastPath)){throw new Error('Cannot duplicate root object');}var parentPath=initial(lastPath);var beforeKey=last(lastPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONArray(parent)){var _lastPath=last(paths);var offset=_lastPath?_int(last(_lastPath))+1:0;return _toConsumableArray2(paths.map(function(path,index){var operation={op:'copy',from:immutableJSONPatch.exports.compileJSONPointer(path),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(index+offset)))};return operation;}));}else if(immutableJSONPatch.exports.isJSONObject(parent)){// 'object'
var _keys9=Object.keys(parent);var nextKeys=getNextKeys(_keys9,beforeKey,false);return[].concat(_toConsumableArray2(paths.map(function(path){var prop=last(path);var newProp=findUniqueName(prop,_keys9);return{op:'copy',from:immutableJSONPatch.exports.compileJSONPointer(path),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(newProp))};})),_toConsumableArray2(nextKeys.map(function(key){return moveDown(parentPath,key);})));}else{throw new Error('Cannot create duplicate operations: parent must be an Object or Array');}}/**
 * Create a JSONPatch for an extract action.
 */ // TODO: write unit tests
function extract(json,selection){if(isValueSelection(selection)){return[{op:'move',from:immutableJSONPatch.exports.compileJSONPointer(selection.focusPath),path:''}];}if(isMultiSelection(selection)){var parentPath=initial(selection.focusPath);var _parent21=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONArray(_parent21)){var value=selection.paths.map(function(path){var index=_int(last(path));return _parent21[index];});return[{op:'replace',path:'',value:value}];}else if(immutableJSONPatch.exports.isJSONObject(_parent21)){// object
var _value2={};selection.paths.forEach(function(path){var key=String(last(path));_value2[key]=_parent21[key];});return[{op:'replace',path:'',value:_value2}];}}else{throw new Error('Cannot create extract operations: parent must be an Object or Array');}// this should never happen
throw new Error('Cannot extract: unsupported type of selection '+JSON.stringify(selection));}// TODO: write unit tests
function insert(json,selection,clipboardText,parser){if(isKeySelection(selection)){// rename key
var clipboard=parseAndRepairOrUndefined(clipboardText,parser);var parentPath=initial(selection.focusPath);var _parent22=immutableJSONPatch.exports.getIn(json,parentPath);var _keys10=Object.keys(_parent22);var oldKey=last(selection.focusPath);var newKey=typeof clipboard==='string'?clipboard:clipboardText;return rename(parentPath,_keys10,oldKey,newKey);}if(isValueSelection(selection)||isMultiSelection(selection)&&isEmpty(selection.focusPath)// root selected
){// replace selected value (new value can be primitive or an array/object with contents)
try{return[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(selection.focusPath),value:parsePartialJson(clipboardText,function(text){return parseAndRepair(text,parser);})}];}catch(err){// parsing failed -> just paste the raw text as value
return[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(selection.focusPath),value:clipboardText}];}}if(isMultiSelection(selection)){var newValues=clipboardToValues(clipboardText,parser);return replace(json,selection.paths,newValues);}if(isAfterSelection(selection)){var _newValues=clipboardToValues(clipboardText,parser);var path=selection.focusPath;var _parentPath2=initial(path);var _parent23=immutableJSONPatch.exports.getIn(json,_parentPath2);if(immutableJSONPatch.exports.isJSONArray(_parent23)){var index=_int(last(path));var nextItemPath=_parentPath2.concat(String(index+1));return insertBefore(json,nextItemPath,_newValues);}else if(immutableJSONPatch.exports.isJSONObject(_parent23)){// value is an Object
var key=String(last(path));var _keys11=Object.keys(_parent23);if(isEmpty(_keys11)||last(_keys11)===key){return append(json,_parentPath2,_newValues);}else{var _index=_keys11.indexOf(key);var nextKey=_keys11[_index+1];var nextKeyPath=_parentPath2.concat(nextKey);return insertBefore(json,nextKeyPath,_newValues);}}else{throw new Error('Cannot create insert operations: parent must be an Object or Array');}}if(isInsideSelection(selection)){var _newValues2=clipboardToValues(clipboardText,parser);var _path2=selection.focusPath;var value=immutableJSONPatch.exports.getIn(json,_path2);if(immutableJSONPatch.exports.isJSONArray(value)){var firstItemPath=_path2.concat('0');return insertBefore(json,firstItemPath,_newValues2);}else if(immutableJSONPatch.exports.isJSONObject(value)){// value is an Object
var _keys12=Object.keys(value);if(isEmpty(_keys12)){return append(json,_path2,_newValues2);}else{var firstKey=head(_keys12);var firstKeyPath=_path2.concat(firstKey);return insertBefore(json,firstKeyPath,_newValues2);}}else{throw new Error('Cannot create insert operations: parent must be an Object or Array');}}// this should never happen
throw new Error('Cannot insert: unsupported type of selection '+JSON.stringify(selection));}function moveInsideParent(json,selection,dragInsideAction){var beforePath=dragInsideAction['beforePath'];var append=dragInsideAction['append'];var parentPath=initial(selection.focusPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(!append&&!(beforePath&&pathStartsWith(beforePath,parentPath)&&beforePath.length>parentPath.length)){return[];}var startPath=getStartPath(selection);var endPath=getEndPath(selection);var startKey=last(startPath);var endKey=last(endPath);var toKey=beforePath?beforePath[parentPath.length]:undefined;if(immutableJSONPatch.exports.isJSONObject(parent)){var _keys13=Object.keys(parent);var startIndex=_keys13.indexOf(startKey);var endIndex=_keys13.indexOf(endKey);var toIndex=append?_keys13.length:_keys13.indexOf(toKey);if(startIndex!==-1&&endIndex!==-1&&toIndex!==-1){if(toIndex>startIndex){// moving down
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return[].concat(_toConsumableArray2(_keys13.slice(startIndex,endIndex+1)),_toConsumableArray2(_keys13.slice(toIndex,_keys13.length))).map(function(key){return moveDown(parentPath,key);});}else{// moving up
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
return[].concat(_toConsumableArray2(_keys13.slice(toIndex,startIndex)),_toConsumableArray2(_keys13.slice(endIndex+1,_keys13.length))).map(function(key){return moveDown(parentPath,key);});}}}else if(immutableJSONPatch.exports.isJSONArray(parent)){// array
var _startIndex2=_int(startKey);var _endIndex2=_int(endKey);var _toIndex=toKey!==undefined?_int(toKey):parent.length;var count=_endIndex2-_startIndex2+1;if(_toIndex<_startIndex2){// move up
return times(count,function(offset){return{op:'move',from:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(_startIndex2+offset))),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(_toIndex+offset)))};});}else{// move down
return times(count,function(){return{op:'move',from:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(_startIndex2))),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(String(_toIndex)))};});}}else{throw new Error('Cannot create move operations: parent must be an Object or Array');}}function createNewValue(json,selection,valueType){if(valueType==='object'){return{};}if(valueType==='array'){return[];}if(valueType==='structure'){var parentPath=getParentPath(selection);var _parent24=immutableJSONPatch.exports.getIn(json,parentPath);if(Array.isArray(_parent24)&&!isEmpty(_parent24)){var jsonExample=head(_parent24);if(isObjectOrArray(jsonExample)){return cloneDeepWith(jsonExample,function(value){return Array.isArray(value)?[]:isObject$1(value)?undefined// leave object as is, will recurse into it
:'';});}else{// just a primitive value
return'';}}}// type === value,
// or type === structure but the parent is no array or an array containing
// primitive values (and no objects having any structure).
return'';}/**
 * Create a JSONPatch for a multiple remove operation
 */function removeAll(paths){return paths.map(function(path){var operation={op:'remove',path:immutableJSONPatch.exports.compileJSONPointer(path)};return operation;}).reverse();// reverse is needed for arrays: delete the last index first
}// helper function to move a key down in an object,
// so another key can get positioned before the moved down keys
function moveDown(parentPath,key){return{op:'move',from:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(key)),path:immutableJSONPatch.exports.compileJSONPointer(parentPath.concat(key))};}function clipboardToValues(clipboardText,parser){var textIsObject=/^\s*{/.test(clipboardText);var textIsArray=/^\s*\[/.test(clipboardText);var clipboardOriginal=parseAndRepairOrUndefined(clipboardText,parser);var clipboardRepaired=clipboardOriginal!==undefined?clipboardOriginal:parsePartialJson(clipboardText,function(text){return parseAndRepair(text,parser);});if(textIsObject&&isObject$1(clipboardRepaired)||textIsArray&&Array.isArray(clipboardRepaired)){return[{key:'New item',value:clipboardRepaired}];}if(Array.isArray(clipboardRepaired)){return clipboardRepaired.map(function(value,index){return{key:'New item '+index,value:value};});}if(isObject$1(clipboardRepaired)){return Object.keys(clipboardRepaired).map(function(key){return{key:key,value:clipboardRepaired[key]};});}// regular value
return[{key:'New item',value:clipboardRepaired}];}// TODO: write unit tests
function createRemoveOperations(json,selection){if(isKeySelection(selection)){// FIXME: DOESN'T work yet
var parentPath=initial(selection.focusPath);var _parent25=immutableJSONPatch.exports.getIn(json,parentPath);var _keys14=Object.keys(_parent25);var oldKey=last(selection.focusPath);var newKey='';var operations=rename(parentPath,_keys14,oldKey,newKey);var newSelection=createSelectionFromOperations(json,operations);return{operations:operations,newSelection:newSelection};}if(isValueSelection(selection)){var _operations=[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(selection.focusPath),value:''}];return{operations:_operations,newSelection:selection};}if(isMultiSelection(selection)){var _operations2=removeAll(selection.paths);var lastPath=last(selection.paths);if(isEmpty(lastPath)){// there is no parent, this is the root document
var _operations3=[{op:'replace',path:'',value:''}];var _newSelection=createValueSelection([],false);return{operations:_operations3,newSelection:_newSelection};}var _parentPath3=initial(lastPath);var _parent26=immutableJSONPatch.exports.getIn(json,_parentPath3);if(immutableJSONPatch.exports.isJSONArray(_parent26)){var firstPath=head(selection.paths);var index=_int(last(firstPath));var _newSelection2=index===0?createInsideSelection(_parentPath3):createAfterSelection(_parentPath3.concat(String(index-1)));return{operations:_operations2,newSelection:_newSelection2};}else if(immutableJSONPatch.exports.isJSONObject(_parent26)){// parent is object
var _keys15=Object.keys(_parent26);var _firstPath2=head(selection.paths);var key=last(_firstPath2);var _index2=_keys15.indexOf(key);var previousKey=_keys15[_index2-1];var _newSelection3=_index2===0?createInsideSelection(_parentPath3):createAfterSelection(_parentPath3.concat(previousKey));return{operations:_operations2,newSelection:_newSelection3};}else{throw new Error('Cannot create remove operations: parent must be an Object or Array');}}// this should never happen
throw new Error('Cannot remove: unsupported type of selection '+JSON.stringify(selection));}function revertJSONPatchWithMoveOperations(json,operations){return immutableJSONPatch.exports.revertJSONPatch(json,operations,{before:function before(json,operation,revertOperations){if(immutableJSONPatch.exports.isJSONPatchRemove(operation)){var path=immutableJSONPatch.exports.parseJSONPointer(operation.path);return{revertOperations:[].concat(_toConsumableArray2(revertOperations),_toConsumableArray2(createRevertMoveOperations(json,path)))};}if(immutableJSONPatch.exports.isJSONPatchMove(operation)){var from=immutableJSONPatch.exports.parseJSONPointer(operation.from);return{revertOperations:[].concat(_toConsumableArray2(revertOperations),_toConsumableArray2(createRevertMoveOperations(json,from)))};}return{revertOperations:revertOperations};}});}function createRevertMoveOperations(json,path){var parentPath=initial(path);var afterKey=last(path);var parent=immutableJSONPatch.exports.getIn(json,parentPath);if(immutableJSONPatch.exports.isJSONObject(parent)){var _keys16=Object.keys(parent);var nextKeys=getNextKeys(_keys16,afterKey,false);// move all lower down keys so the inserted key will maintain its position
return nextKeys.map(function(key){return moveDown(parentPath,key);});}return[];}// TODO: comment
// TODO: unit test
function updateSearchResult(json,newResultItems,previousResult){var activePath=previousResult!==null&&previousResult!==void 0&&previousResult.activeItem?getSearchResultPath(previousResult.activeItem):undefined;var matchingActiveIndex=newResultItems.findIndex(function(item){return isEqual$1(activePath,getSearchResultPath(item));});var activeIndex=matchingActiveIndex!==-1?matchingActiveIndex:(previousResult===null||previousResult===void 0?void 0:previousResult.activeIndex)<newResultItems.length?previousResult===null||previousResult===void 0?void 0:previousResult.activeIndex:newResultItems.length>0?0:-1;var items=newResultItems.map(function(item,index){return _objectSpread2(_objectSpread2({},item),{},{active:index===activeIndex});});var activeItem=items[activeIndex];return{items:items,itemsMap:groupBy(items,function(item){return immutableJSONPatch.exports.compileJSONPointer(item.path);}),activeItem:activeItem,activeIndex:activeIndex};}// TODO: unit test
function searchNext(searchResult){var nextActiveIndex=searchResult.activeIndex<searchResult.items.length-1?searchResult.activeIndex+1:searchResult.items.length>0?0:-1;var nextActiveItem=searchResult.items[nextActiveIndex];var items=searchResult.items.map(function(item,index){return _objectSpread2(_objectSpread2({},item),{},{active:index===nextActiveIndex});});return _objectSpread2(_objectSpread2({},searchResult),{},{items:items,itemsMap:groupBy(items,function(item){return immutableJSONPatch.exports.compileJSONPointer(item.path);}),activeItem:nextActiveItem,activeIndex:nextActiveIndex});}// TODO: unit test
function searchPrevious(searchResult){var previousActiveIndex=searchResult.activeIndex>0?searchResult.activeIndex-1:searchResult.items.length-1;var previousActiveItem=searchResult.items[previousActiveIndex];var items=searchResult.items.map(function(item,index){return _objectSpread2(_objectSpread2({},item),{},{active:index===previousActiveIndex});});return _objectSpread2(_objectSpread2({},searchResult),{},{items:items,itemsMap:groupBy(items,function(item){return immutableJSONPatch.exports.compileJSONPointer(item.path);}),activeItem:previousActiveItem,activeIndex:previousActiveIndex});}// TODO: comment
function search(searchText,json,documentState){var maxResults=arguments.length>3&&arguments[3]!==undefined?arguments[3]:Infinity;var results=[];var path=[];// we reuse the same Array recursively, this is *much* faster than creating a new path every time
function onMatch(match){if(results.length<maxResults){results.push(match);}}function searchRecursive(searchTextLowerCase,value){if(immutableJSONPatch.exports.isJSONArray(value)){var level=path.length;path.push('0');for(var _i236=0;_i236<value.length;_i236++){path[level]=String(_i236);searchRecursive(searchTextLowerCase,value[_i236]);if(results.length>=maxResults){return;}}path.pop();}else if(immutableJSONPatch.exports.isJSONObject(value)){var _keys17=Object.keys(value);var _level=path.length;path.push('');for(var _i237=0,_keys18=_keys17;_i237<_keys18.length;_i237++){var key=_keys18[_i237];path[_level]=key;findCaseInsensitiveMatches(key,searchTextLowerCase,path,SearchField.key,onMatch);searchRecursive(searchTextLowerCase,value[key]);if(results.length>=maxResults){return;}}path.pop();}else{// type is a value
findCaseInsensitiveMatches(String(value),searchTextLowerCase,path,SearchField.value,onMatch);}}if(typeof searchText==='string'&&searchText!==''){var searchTextLowerCase=searchText.toLowerCase();searchRecursive(searchTextLowerCase,json);}return results;}/**
 * Do a case-insensitive search for a search text in a text
 */function findCaseInsensitiveMatches(text,searchTextLowerCase,path,field,onMatch){var textLower=text.toLowerCase();var fieldIndex=0;var position=-1;var index=-1;do{index=textLower.indexOf(searchTextLowerCase,position);if(index!==-1){position=index+searchTextLowerCase.length;onMatch({path:path.slice(0),field:field,fieldIndex:fieldIndex,start:index,end:position});fieldIndex++;}}while(index!==-1);}/**
 * Replace a search result item with a replacement text
 */function replaceText(text,replacementText,start,end){return text.substring(0,start)+replacementText+text.substring(end);}/**
 * Replace all matches with a replacement text
 */function replaceAllText(text,replacementText,occurrences){var updatedText=text;forEachRight(occurrences,function(occurrence){updatedText=replaceText(updatedText,replacementText,occurrence.start,occurrence.end);});return updatedText;}function createSearchAndReplaceOperations(json,documentState,replacementText,searchResultItem,parser){var field=searchResultItem.field,path=searchResultItem.path,start=searchResultItem.start,end=searchResultItem.end;if(field===SearchField.key){// replace a key
var parentPath=initial(path);var _parent27=immutableJSONPatch.exports.getIn(json,parentPath);var oldKey=last(path);var _keys19=Object.keys(_parent27);var newKey=replaceText(oldKey,replacementText,start,end);var operations=rename(parentPath,_keys19,oldKey,newKey);var newSelection=createSelectionFromOperations(json,operations);return{newSelection:newSelection,operations:operations};}else if(field===SearchField.value){// replace a value
var currentValue=immutableJSONPatch.exports.getIn(json,path);if(currentValue===undefined){throw new Error("Cannot replace: path not found ".concat(immutableJSONPatch.exports.compileJSONPointer(path)));}var currentValueText=typeof currentValue==='string'?currentValue:String(currentValue);var pointer=immutableJSONPatch.exports.compileJSONPointer(path);var enforceString=getEnforceString(currentValue,documentState.enforceStringMap,pointer,parser);var value=replaceText(currentValueText,replacementText,start,end);var _operations4=[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:enforceString?value:stringConvert(value,parser)}];var _newSelection4=createSelectionFromOperations(json,_operations4);return{newSelection:_newSelection4,operations:_operations4};}else{throw new Error("Cannot replace: unknown type of search result field ".concat(field));}}function createSearchAndReplaceAllOperations(json,documentState,searchText,replacementText,parser){// TODO: to improve performance, we could reuse existing search results (except when hitting a maxResult limit)
var searchResultItems=search(searchText,json,documentState,Infinity/* maxResults */);// step 1: deduplicate matches inside the same field/value
// (filter, map, and group)
var deduplicatedMatches=[];for(var _i238=0;_i238<searchResultItems.length;_i238++){var previousItem=searchResultItems[_i238-1];var item=searchResultItems[_i238];if(_i238===0||item.field!==previousItem.field||!isEqual$1(item.path,previousItem.path)){deduplicatedMatches.push({path:item.path,field:item.field,items:[item]});}else{last(deduplicatedMatches).items.push(item);}}// step 2: sort from deepest nested to least nested
// this is needed to replace in that order because paths may change
// if there are replacements in keys
deduplicatedMatches.sort(function(a,b){// sort values first, properties next
if(a.field!==b.field){if(a.field===SearchField.key){return 1;}else{return-1;}}// sort longest paths first, shortest last
return b.path.length-a.path.length;});// step 3: call createSearchAndReplaceOperations for each of the matches
var allOperations=[];var lastNewSelection=undefined;deduplicatedMatches.forEach(function(match){// TODO: there is overlap with the logic of createSearchAndReplaceOperations. Can we extract and reuse this logic?
var field=match.field,path=match.path,items=match.items;if(field===SearchField.key){// replace a key
var parentPath=initial(path);var _parent28=immutableJSONPatch.exports.getIn(json,parentPath);var oldKey=last(path);var _keys20=Object.keys(_parent28);var newKey=replaceAllText(oldKey,replacementText,items);var operations=rename(parentPath,_keys20,oldKey,newKey);allOperations=allOperations.concat(operations);lastNewSelection=createSelectionFromOperations(json,operations);}else if(field===SearchField.value){// replace a value
var currentValue=immutableJSONPatch.exports.getIn(json,path);if(currentValue===undefined){throw new Error("Cannot replace: path not found ".concat(immutableJSONPatch.exports.compileJSONPointer(path)));}var currentValueText=typeof currentValue==='string'?currentValue:String(currentValue);var pointer=immutableJSONPatch.exports.compileJSONPointer(path);var enforceString=getEnforceString(currentValue,documentState.enforceStringMap,pointer,parser);var value=replaceAllText(currentValueText,replacementText,items);var _operations5=[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:enforceString?value:stringConvert(value,parser)}];allOperations=allOperations.concat(_operations5);lastNewSelection=createSelectionFromOperations(json,_operations5);}else{throw new Error("Cannot replace: unknown type of search result field ".concat(field));}});return{operations:allOperations,newSelection:lastNewSelection};}/**
 * Split the text into separate parts for each search result and the text
 * in between.
 */function splitValue(text,matches){var parts=[];var previousEnd=0;var _iterator215=_createForOfIteratorHelper(matches),_step215;try{for(_iterator215.s();!(_step215=_iterator215.n()).done;){var match=_step215.value;var precedingText=text.slice(previousEnd,match.start);if(precedingText!==''){parts.push({type:'normal',text:precedingText,active:false});}var matchingText=text.slice(match.start,match.end);parts.push({type:'highlight',text:matchingText,active:match.active});previousEnd=match.end;}}catch(err){_iterator215.e(err);}finally{_iterator215.f();}var lastMatch=last(matches);if(lastMatch.end<text.length){parts.push({type:'normal',text:text.slice(lastMatch.end),active:false});}return parts;}/**
 * Get the path of the search result property on a nested search result
 */function getSearchResultPath(searchResultItem){return searchResultItem.path.concat(searchResultItem.field,String(searchResultItem.fieldIndex));}// TODO: write unit tests
function filterKeySearchResults(map,pointer){var _map$pointer;var items=map===null||map===void 0?void 0:(_map$pointer=map[pointer])===null||_map$pointer===void 0?void 0:_map$pointer.filter(function(item){return item.field===SearchField.key;});if(!items||items.length===0){return undefined;}return items;}// TODO: write unit tests
function filterValueSearchResults(map,pointer){var _map$pointer2;var items=map===null||map===void 0?void 0:(_map$pointer2=map[pointer])===null||_map$pointer2===void 0?void 0:_map$pointer2.filter(function(item){return item.field===SearchField.value;});if(!items||items.length===0){return undefined;}return items;}function copyToClipBoard(text){var _document$queryComman,_document;if(navigator.clipboard){return navigator.clipboard.writeText(text);}// Compatible with old browsers such as Chrome <=65, Edge <=18 & IE
// Compatible with HTTP
else if((_document$queryComman=(_document=document).queryCommandSupported)!==null&&_document$queryComman!==void 0&&_document$queryComman.call(_document,'copy')){var textarea=document.createElement('textarea');textarea.value=text;textarea.style.position='fixed';// Avoid scrolling to bottom
textarea.style.opacity='0';document.body.appendChild(textarea);textarea.select();// Security exception may be thrown by some browsers
try{document.execCommand('copy');}catch(e){console.error(e);}finally{document.body.removeChild(textarea);}}else{console.error('Copy failed.');}}/* src/lib/components/modals/Header.svelte generated by Svelte v3.51.0 */function add_css$C(target){append_styles(target,"svelte-d01h2s",".jse-header.svelte-d01h2s.svelte-d01h2s{display:flex;background:var(--jse-theme-color);color:var(--jse-menu-color)}.jse-header.svelte-d01h2s .jse-title.svelte-d01h2s{flex:1;padding:5px;vertical-align:middle}.jse-header.svelte-d01h2s button.svelte-d01h2s{border:none;background:transparent;min-width:32px;color:inherit;cursor:pointer}.jse-header.svelte-d01h2s button.svelte-d01h2s:hover{background:rgba(255, 255, 255, 0.1)}");}function create_fragment$G(ctx){var div1;var div0;var t0;var t1;var button;var icon;var current;var mounted;var dispose;icon=new Icon({props:{data:faTimes}});return{c:function c(){div1=element("div");div0=element("div");t0=text(/*title*/ctx[0]);t1=space();button=element("button");create_component(icon.$$.fragment);attr(div0,"class","jse-title svelte-d01h2s");attr(button,"type","button");attr(button,"class","jse-close svelte-d01h2s");attr(div1,"class","jse-header svelte-d01h2s");},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);append$1(div0,t0);append$1(div1,t1);append$1(div1,button);mount_component(icon,button,null);current=true;if(!mounted){dispose=listen(button,"click",/*close*/ctx[1]);mounted=true;}},p:function p(ctx,_ref104){var _ref105=_slicedToArray(_ref104,1),dirty=_ref105[0];if(!current||dirty&/*title*/1)set_data(t0,/*title*/ctx[0]);},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div1);destroy_component(icon);mounted=false;dispose();}};}function instance$G($$self,$$props,$$invalidate){var _$$props$title=$$props.title,title=_$$props$title===void 0?'Modal':_$$props$title;var _getContext=getContext('simple-modal'),close=_getContext.close;$$self.$$set=function($$props){if('title'in $$props)$$invalidate(0,title=$$props.title);};return[title,close];}var Header=/*#__PURE__*/function(_SvelteComponent16){_inherits(Header,_SvelteComponent16);var _super57=_createSuper(Header);function Header(options){var _this111;_classCallCheck(this,Header);_this111=_super57.call(this);init(_assertThisInitialized(_this111),options,instance$G,create_fragment$G,not_equal,{title:0},add_css$C);return _this111;}return _createClass(Header);}(SvelteComponent);var Header$1=Header;/* src/lib/components/modals/CopyPasteModal.svelte generated by Svelte v3.51.0 */function add_css$B(target){append_styles(target,"svelte-t45ah0",".jse-modal.svelte-t45ah0.svelte-t45ah0{--height:36px;--multiItemHeight:28px;--multiItemMargin:2px;--multiItemPadding:2px 8px;--multiClearTop:5px;--multiItemBorderRadius:6px;--clearSelectTop:2px;--clearSelectBottom:2px;--indicatorTop:8px;flex:1;display:flex;flex-direction:column;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-t45ah0 .jse-contents.svelte-t45ah0{padding:20px;overflow:auto}.jse-modal.svelte-t45ah0 .jse-contents .jse-actions.svelte-t45ah0{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-t45ah0 .jse-contents .jse-actions button.svelte-t45ah0{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-t45ah0 .jse-contents .jse-actions button.svelte-t45ah0:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-t45ah0 .jse-contents .jse-actions button.svelte-t45ah0:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-copy-paste.svelte-t45ah0 .jse-shortcuts.svelte-t45ah0{display:flex;flex-wrap:wrap;justify-content:space-around;margin:calc(2 * var(--jse-padding)) 0}.jse-modal.jse-copy-paste.svelte-t45ah0 .jse-shortcuts .jse-shortcut .jse-key.svelte-t45ah0{font-size:200%;color:var(--jse-theme-color)}");}function create_fragment$F(ctx){var div10;var header;var t0;var div9;var div0;var t2;var div7;var div2;var div1;var t5;var t6;var div4;var div3;var t9;var t10;var div6;var div5;var t13;var t14;var div8;var button;var current;var mounted;var dispose;header=new Header$1({props:{title:"Copying and pasting"}});return{c:function c(){div10=element("div");create_component(header.$$.fragment);t0=space();div9=element("div");div0=element("div");div0.textContent="These actions are unavailable via the menu. Please use:";t2=space();div7=element("div");div2=element("div");div1=element("div");div1.textContent="".concat(/*ctrl*/ctx[1],"+C");t5=text("\n        for copy");t6=space();div4=element("div");div3=element("div");div3.textContent="".concat(/*ctrl*/ctx[1],"+X");t9=text("\n        for cut");t10=space();div6=element("div");div5=element("div");div5.textContent="".concat(/*ctrl*/ctx[1],"+V");t13=text("\n        for paste");t14=space();div8=element("div");button=element("button");button.textContent="Close";attr(div1,"class","jse-key svelte-t45ah0");attr(div2,"class","jse-shortcut");attr(div3,"class","jse-key svelte-t45ah0");attr(div4,"class","jse-shortcut");attr(div5,"class","jse-key svelte-t45ah0");attr(div6,"class","jse-shortcut");attr(div7,"class","jse-shortcuts svelte-t45ah0");attr(button,"type","button");attr(button,"class","jse-primary svelte-t45ah0");attr(div8,"class","jse-actions svelte-t45ah0");attr(div9,"class","jse-contents svelte-t45ah0");attr(div10,"class","jse-modal jse-copy-paste svelte-t45ah0");},m:function m(target,anchor){insert$2(target,div10,anchor);mount_component(header,div10,null);append$1(div10,t0);append$1(div10,div9);append$1(div9,div0);append$1(div9,t2);append$1(div9,div7);append$1(div7,div2);append$1(div2,div1);append$1(div2,t5);append$1(div7,t6);append$1(div7,div4);append$1(div4,div3);append$1(div4,t9);append$1(div7,t10);append$1(div7,div6);append$1(div6,div5);append$1(div6,t13);append$1(div9,t14);append$1(div9,div8);append$1(div8,button);current=true;if(!mounted){dispose=listen(button,"click",/*close*/ctx[0]);mounted=true;}},p:noop$2,i:function i(local){if(current)return;transition_in(header.$$.fragment,local);current=true;},o:function o(local){transition_out(header.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div10);destroy_component(header);mounted=false;dispose();}};}function instance$F($$self){var _getContext2=getContext('simple-modal'),close=_getContext2.close;var ctrl=IS_MAC?'':'Ctrl';return[close,ctrl];}var CopyPasteModal=/*#__PURE__*/function(_SvelteComponent17){_inherits(CopyPasteModal,_SvelteComponent17);var _super58=_createSuper(CopyPasteModal);function CopyPasteModal(options){var _this112;_classCallCheck(this,CopyPasteModal);_this112=_super58.call(this);init(_assertThisInitialized(_this112),options,instance$F,create_fragment$F,not_equal,{},add_css$B);return _this112;}return _createClass(CopyPasteModal);}(SvelteComponent);var CopyPasteModal$1=CopyPasteModal;/* src/lib/components/modals/repair/JSONRepairComponent.svelte generated by Svelte v3.51.0 */function add_css$A(target){append_styles(target,"svelte-gz09vf",".jse-json-repair-component.svelte-gz09vf.svelte-gz09vf{flex:1;display:flex;flex-direction:column;background:var(--jse-background-color);color:var(--jse-text-color)}.jse-json-repair-component.svelte-gz09vf .jse-menu .jse-info.svelte-gz09vf{padding:0 var(--jse-padding)}.jse-json-repair-component.svelte-gz09vf .jse-json-text.svelte-gz09vf{flex:1;border:none;padding:2px;font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-background-color);color:var(--jse-text-color);resize:none;outline:none}");}// (113:4) 
function create_left_slot(ctx){var div;return{c:function c(){div=element("div");div.textContent="Repair invalid JSON, then click apply";attr(div,"slot","left");attr(div,"class","jse-info svelte-gz09vf");},m:function m(target,anchor){insert$2(target,div,anchor);},p:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (123:2) {:else}
function create_else_block$c(ctx){var message;var current;message=new Message$1({props:{type:"success",message:"JSON is valid now and can be parsed.",actions:/*successActions*/ctx[5]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty&/*successActions*/32)message_changes.actions=/*successActions*/ctx[5];message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}// (116:2) {#if error}
function create_if_block$l(ctx){var message;var current;message=new Message$1({props:{type:"error",icon:faExclamationTriangle,message:"Cannot parse JSON: ".concat(/*error*/ctx[2].message),actions:/*errorActions*/ctx[6]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty&/*error*/4)message_changes.message="Cannot parse JSON: ".concat(/*error*/ctx[2].message);if(dirty&/*errorActions*/64)message_changes.actions=/*errorActions*/ctx[6];message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}function create_fragment$E(ctx){var div;var menu;var t0;var current_block_type_index;var if_block;var t1;var textarea;var current;var mounted;var dispose;menu=new Menu$1({props:{items:/*items*/ctx[7],$$slots:{left:[create_left_slot]},$$scope:{ctx:ctx}}});var if_block_creators=[create_if_block$l,create_else_block$c];var if_blocks=[];function select_block_type(ctx,dirty){if(/*error*/ctx[2])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");create_component(menu.$$.fragment);t0=space();if_block.c();t1=space();textarea=element("textarea");textarea.value=/*text*/ctx[0];textarea.readOnly=/*readOnly*/ctx[1];attr(textarea,"class","jse-json-text svelte-gz09vf");attr(textarea,"autocomplete","off");attr(textarea,"autocapitalize","off");attr(textarea,"spellcheck","false");attr(div,"class","jse-json-repair-component svelte-gz09vf");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(menu,div,null);append$1(div,t0);if_blocks[current_block_type_index].m(div,null);append$1(div,t1);append$1(div,textarea);/*textarea_binding*/ctx[19](textarea);/*div_binding*/ctx[20](div);current=true;if(!mounted){dispose=listen(textarea,"input",/*handleChange*/ctx[8]);mounted=true;}},p:function p(ctx,_ref106){var _ref107=_slicedToArray(_ref106,1),dirty=_ref107[0];var menu_changes={};if(dirty&/*items*/128)menu_changes.items=/*items*/ctx[7];if(dirty&/*$$scope*/134217728){menu_changes.$$scope={dirty:dirty,ctx:ctx};}menu.$set(menu_changes);var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,t1);}if(!current||dirty&/*text*/1){textarea.value=/*text*/ctx[0];}if(!current||dirty&/*readOnly*/2){textarea.readOnly=/*readOnly*/ctx[1];}},i:function i(local){if(current)return;transition_in(menu.$$.fragment,local);transition_in(if_block);current=true;},o:function o(local){transition_out(menu.$$.fragment,local);transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(menu);if_blocks[current_block_type_index].d();/*textarea_binding*/ctx[19](null);/*div_binding*/ctx[20](null);mounted=false;dispose();}};}function instance$E($$self,$$props,$$invalidate){var error;var repairable;var defaultItems;var items;var gotoAction;var repairAction;var errorActions;var successActions;var _$$props$text=$$props.text,text=_$$props$text===void 0?'':_$$props$text;var _$$props$readOnly2=$$props.readOnly,readOnly=_$$props$readOnly2===void 0?false:_$$props$readOnly2;var onParse=$$props.onParse;var onRepair=$$props.onRepair;var _$$props$onChange=$$props.onChange,onChange=_$$props$onChange===void 0?null:_$$props$onChange;var onApply=$$props.onApply;var onCancel=$$props.onCancel;var _$$props$onRenderMenu2=$$props.onRenderMenu,onRenderMenu=_$$props$onRenderMenu2===void 0?noop:_$$props$onRenderMenu2;var debug=createDebug('jsoneditor:JSONRepair');var domJsonRepair;var domTextArea;function getErrorMessage(jsonText){try{onParse(jsonText);return null;}catch(err){return normalizeJsonParseError(jsonText,err.message);}}function isRepairable(jsonText){try{onRepair(jsonText);return true;}catch(err){return false;}}function goToError(){if(domTextArea&&error&&error.position!=null){domTextArea.setSelectionRange(error.position,error.position);setTimeout(function(){domTextArea.focus();});}}function handleChange(event){debug('handleChange');var value=event.target.value;if(text===value){return;}$$invalidate(0,text=value);if(onChange){onChange(text);}}function handleApply(){onApply(text);}function handleRepair(){try{// TODO: simpleJsonRepair should also partially apply fixes. Now it's all or nothing
$$invalidate(0,text=onRepair(text));if(onChange){onChange(text);}}catch(err){}// no need to do something with the error
}function textarea_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){domTextArea=$$value;$$invalidate(4,domTextArea);});}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){domJsonRepair=$$value;$$invalidate(3,domJsonRepair);});}$$self.$$set=function($$props){if('text'in $$props)$$invalidate(0,text=$$props.text);if('readOnly'in $$props)$$invalidate(1,readOnly=$$props.readOnly);if('onParse'in $$props)$$invalidate(9,onParse=$$props.onParse);if('onRepair'in $$props)$$invalidate(10,onRepair=$$props.onRepair);if('onChange'in $$props)$$invalidate(11,onChange=$$props.onChange);if('onApply'in $$props)$$invalidate(12,onApply=$$props.onApply);if('onCancel'in $$props)$$invalidate(13,onCancel=$$props.onCancel);if('onRenderMenu'in $$props)$$invalidate(14,onRenderMenu=$$props.onRenderMenu);};$$self.$$.update=function(){if($$self.$$.dirty&/*text*/1){$$invalidate(2,error=getErrorMessage(text));}if($$self.$$.dirty&/*text*/1){$$invalidate(17,repairable=isRepairable(text));}if($$self.$$.dirty&/*error*/4){debug('error',error);}if($$self.$$.dirty&/*onCancel*/8192){$$invalidate(18,defaultItems=[{space:true},{icon:faTimes,title:'Cancel repair',className:'jse-cancel',onClick:onCancel}]);}if($$self.$$.dirty&/*onRenderMenu, defaultItems*/278528){$$invalidate(7,items=onRenderMenu('repair',defaultItems)||defaultItems);}if($$self.$$.dirty&/*repairable, gotoAction, repairAction*/229376){$$invalidate(6,errorActions=repairable?[gotoAction,repairAction]:[gotoAction]);}if($$self.$$.dirty&/*readOnly*/2){$$invalidate(5,successActions=[{icon:faCheck,text:'Apply',title:'Apply fixed JSON',disabled:readOnly,onClick:handleApply}]);}};$$invalidate(15,gotoAction={icon:faArrowDown,text:'Show me',title:'Scroll to the error location',onClick:goToError});$$invalidate(16,repairAction={icon:faWrench,text:'Auto repair',title:'Automatically repair JSON',onClick:handleRepair});return[text,readOnly,error,domJsonRepair,domTextArea,successActions,errorActions,items,handleChange,onParse,onRepair,onChange,onApply,onCancel,onRenderMenu,gotoAction,repairAction,repairable,defaultItems,textarea_binding,div_binding];}var JSONRepairComponent=/*#__PURE__*/function(_SvelteComponent18){_inherits(JSONRepairComponent,_SvelteComponent18);var _super59=_createSuper(JSONRepairComponent);function JSONRepairComponent(options){var _this113;_classCallCheck(this,JSONRepairComponent);_this113=_super59.call(this);init(_assertThisInitialized(_this113),options,instance$E,create_fragment$E,not_equal,{text:0,readOnly:1,onParse:9,onRepair:10,onChange:11,onApply:12,onCancel:13,onRenderMenu:14},add_css$A);return _this113;}return _createClass(JSONRepairComponent);}(SvelteComponent);var JSONRepairComponent$1=JSONRepairComponent;/* src/lib/components/modals/JSONRepairModal.svelte generated by Svelte v3.51.0 */function add_css$z(target){append_styles(target,"svelte-1ffm3pm",".jse-modal.jse-repair.svelte-1ffm3pm{flex:1;display:flex;flex-direction:column;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-background-color);color:var(--jse-text-color)}");}function create_fragment$D(ctx){var div;var jsonrepaircomponent;var updating_text;var current;function jsonrepaircomponent_text_binding(value){/*jsonrepaircomponent_text_binding*/ctx[7](value);}var jsonrepaircomponent_props={onParse:/*onParse*/ctx[1],onRepair:/*onRepair*/ctx[2],onApply:/*handleApply*/ctx[4],onCancel:/*handleCancel*/ctx[5],onRenderMenu:/*onRenderMenu*/ctx[3]};if(/*text*/ctx[0]!==void 0){jsonrepaircomponent_props.text=/*text*/ctx[0];}jsonrepaircomponent=new JSONRepairComponent$1({props:jsonrepaircomponent_props});binding_callbacks.push(function(){return bind$2(jsonrepaircomponent,'text',jsonrepaircomponent_text_binding);});return{c:function c(){div=element("div");create_component(jsonrepaircomponent.$$.fragment);attr(div,"class","jse-modal jse-repair svelte-1ffm3pm");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(jsonrepaircomponent,div,null);current=true;},p:function p(ctx,_ref108){var _ref109=_slicedToArray(_ref108,1),dirty=_ref109[0];var jsonrepaircomponent_changes={};if(dirty&/*onParse*/2)jsonrepaircomponent_changes.onParse=/*onParse*/ctx[1];if(dirty&/*onRepair*/4)jsonrepaircomponent_changes.onRepair=/*onRepair*/ctx[2];if(dirty&/*onRenderMenu*/8)jsonrepaircomponent_changes.onRenderMenu=/*onRenderMenu*/ctx[3];if(!updating_text&&dirty&/*text*/1){updating_text=true;jsonrepaircomponent_changes.text=/*text*/ctx[0];add_flush_callback(function(){return updating_text=false;});}jsonrepaircomponent.$set(jsonrepaircomponent_changes);},i:function i(local){if(current)return;transition_in(jsonrepaircomponent.$$.fragment,local);current=true;},o:function o(local){transition_out(jsonrepaircomponent.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(jsonrepaircomponent);}};}function instance$D($$self,$$props,$$invalidate){var text=$$props.text;var onParse=$$props.onParse;var onRepair=$$props.onRepair;var onApply=$$props.onApply;var onRenderMenu=$$props.onRenderMenu;var _getContext3=getContext('simple-modal'),close=_getContext3.close;function handleApply(repairedText){close();onApply(repairedText);}function handleCancel(){close();}function jsonrepaircomponent_text_binding(value){text=value;$$invalidate(0,text);}$$self.$$set=function($$props){if('text'in $$props)$$invalidate(0,text=$$props.text);if('onParse'in $$props)$$invalidate(1,onParse=$$props.onParse);if('onRepair'in $$props)$$invalidate(2,onRepair=$$props.onRepair);if('onApply'in $$props)$$invalidate(6,onApply=$$props.onApply);if('onRenderMenu'in $$props)$$invalidate(3,onRenderMenu=$$props.onRenderMenu);};return[text,onParse,onRepair,onRenderMenu,handleApply,handleCancel,onApply,jsonrepaircomponent_text_binding];}var JSONRepairModal=/*#__PURE__*/function(_SvelteComponent19){_inherits(JSONRepairModal,_SvelteComponent19);var _super60=_createSuper(JSONRepairModal);function JSONRepairModal(options){var _this114;_classCallCheck(this,JSONRepairModal);_this114=_super60.call(this);init(_assertThisInitialized(_this114),options,instance$D,create_fragment$D,not_equal,{text:0,onParse:1,onRepair:2,onApply:6,onRenderMenu:3},add_css$z);return _this114;}return _createClass(JSONRepairModal);}(SvelteComponent);var JSONRepairModal$1=JSONRepairModal;/* src/lib/components/controls/DropdownButton.svelte generated by Svelte v3.51.0 */function add_css$y(target){append_styles(target,"svelte-mojfmz",".jse-dropdown-button.svelte-mojfmz.svelte-mojfmz{flex:1;line-height:normal;border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;position:relative;padding:0;display:flex}.jse-dropdown-button.svelte-mojfmz ul.svelte-mojfmz{margin:0;padding:0}.jse-dropdown-button.svelte-mojfmz ul li.svelte-mojfmz{margin:0;padding:0;list-style-type:none}.jse-dropdown-button.svelte-mojfmz button.jse-open-dropdown.svelte-mojfmz{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:2em;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);border-radius:0}.jse-dropdown-button.svelte-mojfmz button.jse-open-dropdown.jse-visible.svelte-mojfmz{background:var(--jse-context-menu-background)}.jse-dropdown-button.svelte-mojfmz button.jse-open-dropdown.svelte-mojfmz:hover{background:var(--jse-context-menu-background-highlight)}.jse-dropdown-button.svelte-mojfmz button.jse-open-dropdown.svelte-mojfmz:disabled{color:var(--jse-context-menu-color-disabled);background:unset}.jse-dropdown-button.svelte-mojfmz .jse-dropdown-items.svelte-mojfmz{display:none;position:absolute;top:100%;left:0;z-index:1;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);box-shadow:var(--jse-controls-box-shadow)}.jse-dropdown-button.svelte-mojfmz .jse-dropdown-items.jse-visible.svelte-mojfmz{display:block}.jse-dropdown-button.svelte-mojfmz .jse-dropdown-items button.svelte-mojfmz{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;width:100%;text-align:left;padding:var(--jse-padding);margin:0}.jse-dropdown-button.svelte-mojfmz .jse-dropdown-items button.svelte-mojfmz:hover{background:var(--jse-context-menu-background-highlight)}.jse-dropdown-button.svelte-mojfmz .jse-dropdown-items button.svelte-mojfmz:disabled{color:var(--jse-context-menu-color-disabled);background:unset}");}function get_each_context$c(ctx,list,i){var child_ctx=ctx.slice();child_ctx[11]=list[i];return child_ctx;}var get_defaultItem_slot_changes=function get_defaultItem_slot_changes(dirty){return{};};var get_defaultItem_slot_context=function get_defaultItem_slot_context(ctx){return{};};// (61:12) {#if item.icon}
function create_if_block$k(ctx){var icon;var current;icon=new Icon({props:{data:/*item*/ctx[11].icon}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:function p(ctx,dirty){var icon_changes={};if(dirty&/*items*/1)icon_changes.data=/*item*/ctx[11].icon;icon.$set(icon_changes);},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (53:6) {#each items as item}
function create_each_block$c(ctx){var li;var button;var t0;var t1_value=/*item*/ctx[11].text+"";var t1;var button_title_value;var button_disabled_value;var t2;var current;var mounted;var dispose;var if_block=/*item*/ctx[11].icon&&create_if_block$k(ctx);function click_handler(){return(/*click_handler*/ctx[9](/*item*/ctx[11]));}return{c:function c(){li=element("li");button=element("button");if(if_block)if_block.c();t0=space();t1=text(t1_value);t2=space();attr(button,"type","button");attr(button,"title",button_title_value=/*item*/ctx[11].title);button.disabled=button_disabled_value=/*item*/ctx[11].disabled;attr(button,"class","svelte-mojfmz");attr(li,"class","svelte-mojfmz");},m:function m(target,anchor){insert$2(target,li,anchor);append$1(li,button);if(if_block)if_block.m(button,null);append$1(button,t0);append$1(button,t1);append$1(li,t2);current=true;if(!mounted){dispose=listen(button,"click",click_handler);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(/*item*/ctx[11].icon){if(if_block){if_block.p(ctx,dirty);if(dirty&/*items*/1){transition_in(if_block,1);}}else{if_block=create_if_block$k(ctx);if_block.c();transition_in(if_block,1);if_block.m(button,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}if((!current||dirty&/*items*/1)&&t1_value!==(t1_value=/*item*/ctx[11].text+""))set_data(t1,t1_value);if(!current||dirty&/*items*/1&&button_title_value!==(button_title_value=/*item*/ctx[11].title)){attr(button,"title",button_title_value);}if(!current||dirty&/*items*/1&&button_disabled_value!==(button_disabled_value=/*item*/ctx[11].disabled)){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(li);if(if_block)if_block.d();mounted=false;dispose();}};}function create_fragment$C(ctx){var div1;var t0;var button;var icon;var t1;var div0;var ul;var current;var mounted;var dispose;var defaultItem_slot_template=/*#slots*/ctx[8].defaultItem;var defaultItem_slot=create_slot(defaultItem_slot_template,ctx,/*$$scope*/ctx[7],get_defaultItem_slot_context);icon=new Icon({props:{data:faCaretDown}});var each_value=/*items*/ctx[0];var each_blocks=[];for(var _i239=0;_i239<each_value.length;_i239+=1){each_blocks[_i239]=create_each_block$c(get_each_context$c(ctx,each_value,_i239));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){div1=element("div");if(defaultItem_slot)defaultItem_slot.c();t0=space();button=element("button");create_component(icon.$$.fragment);t1=space();div0=element("div");ul=element("ul");for(var _i240=0;_i240<each_blocks.length;_i240+=1){each_blocks[_i240].c();}attr(button,"type","button");attr(button,"class","jse-open-dropdown svelte-mojfmz");attr(button,"data-type","jse-open-dropdown");button.disabled=/*allItemsDisabled*/ctx[4];toggle_class(button,"jse-visible",/*visible*/ctx[3]);attr(ul,"class","svelte-mojfmz");attr(div0,"class","jse-dropdown-items svelte-mojfmz");set_style(div0,"width",/*width*/ctx[2]);toggle_class(div0,"jse-visible",/*visible*/ctx[3]);attr(div1,"class","jse-dropdown-button svelte-mojfmz");attr(div1,"title",/*title*/ctx[1]);},m:function m(target,anchor){insert$2(target,div1,anchor);if(defaultItem_slot){defaultItem_slot.m(div1,null);}append$1(div1,t0);append$1(div1,button);mount_component(icon,button,null);append$1(div1,t1);append$1(div1,div0);append$1(div0,ul);for(var _i241=0;_i241<each_blocks.length;_i241+=1){each_blocks[_i241].m(ul,null);}current=true;if(!mounted){dispose=[listen(button,"click",/*toggleShow*/ctx[5]),listen(div1,"click",/*handleClick*/ctx[6])];mounted=true;}},p:function p(ctx,_ref110){var _ref111=_slicedToArray(_ref110,1),dirty=_ref111[0];if(defaultItem_slot){if(defaultItem_slot.p&&(!current||dirty&/*$$scope*/128)){update_slot_base(defaultItem_slot,defaultItem_slot_template,ctx,/*$$scope*/ctx[7],!current?get_all_dirty_from_scope(/*$$scope*/ctx[7]):get_slot_changes(defaultItem_slot_template,/*$$scope*/ctx[7],dirty,get_defaultItem_slot_changes),get_defaultItem_slot_context);}}if(!current||dirty&/*allItemsDisabled*/16){button.disabled=/*allItemsDisabled*/ctx[4];}if(!current||dirty&/*visible*/8){toggle_class(button,"jse-visible",/*visible*/ctx[3]);}if(dirty&/*items*/1){each_value=/*items*/ctx[0];var _i242;for(_i242=0;_i242<each_value.length;_i242+=1){var child_ctx=get_each_context$c(ctx,each_value,_i242);if(each_blocks[_i242]){each_blocks[_i242].p(child_ctx,dirty);transition_in(each_blocks[_i242],1);}else{each_blocks[_i242]=create_each_block$c(child_ctx);each_blocks[_i242].c();transition_in(each_blocks[_i242],1);each_blocks[_i242].m(ul,null);}}group_outros();for(_i242=each_value.length;_i242<each_blocks.length;_i242+=1){out(_i242);}check_outros();}if(!current||dirty&/*width*/4){set_style(div0,"width",/*width*/ctx[2]);}if(!current||dirty&/*visible*/8){toggle_class(div0,"jse-visible",/*visible*/ctx[3]);}if(!current||dirty&/*title*/2){attr(div1,"title",/*title*/ctx[1]);}},i:function i(local){if(current)return;transition_in(defaultItem_slot,local);transition_in(icon.$$.fragment,local);for(var _i243=0;_i243<each_value.length;_i243+=1){transition_in(each_blocks[_i243]);}current=true;},o:function o(local){transition_out(defaultItem_slot,local);transition_out(icon.$$.fragment,local);each_blocks=each_blocks.filter(Boolean);for(var _i244=0;_i244<each_blocks.length;_i244+=1){transition_out(each_blocks[_i244]);}current=false;},d:function d(detaching){if(detaching)detach(div1);if(defaultItem_slot)defaultItem_slot.d(detaching);destroy_component(icon);destroy_each(each_blocks,detaching);mounted=false;run_all(dispose);}};}function instance$C($$self,$$props,$$invalidate){var allItemsDisabled;var _$$props$$$slots6=$$props.$$slots,slots=_$$props$$$slots6===void 0?{}:_$$props$$$slots6,$$scope=$$props.$$scope;var _$$props$items2=$$props.items,items=_$$props$items2===void 0?[]:_$$props$items2;var _$$props$title2=$$props.title,title=_$$props$title2===void 0?undefined:_$$props$title2;var _$$props$width=$$props.width,width=_$$props$width===void 0?'120px':_$$props$width;var visible=false;function toggleShow(){var wasVisible=visible;// trigger *after* the handleClick which changes visibility to false
setTimeout(function(){return $$invalidate(3,visible=!wasVisible);});}function handleClick(){$$invalidate(3,visible=false);}function handleKeyDown(event){var combo=keyComboFromEvent(event);if(combo==='Escape'){event.preventDefault();$$invalidate(3,visible=false);}}onMount(function(){document.addEventListener('click',handleClick);document.addEventListener('keydown',handleKeyDown);});onDestroy(function(){document.removeEventListener('click',handleClick);document.removeEventListener('keydown',handleKeyDown);});var click_handler=function click_handler(item){return item.onClick();};$$self.$$set=function($$props){if('items'in $$props)$$invalidate(0,items=$$props.items);if('title'in $$props)$$invalidate(1,title=$$props.title);if('width'in $$props)$$invalidate(2,width=$$props.width);if('$$scope'in $$props)$$invalidate(7,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty&/*items*/1){$$invalidate(4,allItemsDisabled=items.every(function(item){return item.disabled===true;}));}};return[items,title,width,visible,allItemsDisabled,toggleShow,handleClick,$$scope,slots,click_handler];}var DropdownButton=/*#__PURE__*/function(_SvelteComponent20){_inherits(DropdownButton,_SvelteComponent20);var _super61=_createSuper(DropdownButton);function DropdownButton(options){var _this115;_classCallCheck(this,DropdownButton);_this115=_super61.call(this);init(_assertThisInitialized(_this115),options,instance$C,create_fragment$C,not_equal,{items:0,title:1,width:2},add_css$y);return _this115;}return _createClass(DropdownButton);}(SvelteComponent);var DropdownButton$1=DropdownButton;var faLightbulb={prefix:'far',iconName:'lightbulb',icon:[384,512,[128161],"f0eb","M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM192 0C90.02 .3203 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.8 289.2 .0039 192 0zM288.4 260.1c-15.66 17.85-35.04 46.3-49.05 75.89h-94.61c-14.01-29.59-33.39-58.04-49.04-75.88C75.24 236.8 64 206.1 64 175.1C64 113.3 112.1 48.25 191.1 48C262.6 48 320 105.4 320 175.1C320 206.1 308.8 236.8 288.4 260.1zM176 80C131.9 80 96 115.9 96 160c0 8.844 7.156 16 16 16S128 168.8 128 160c0-26.47 21.53-48 48-48c8.844 0 16-7.148 16-15.99S184.8 80 176 80z"]};var faSquareCheck={prefix:'far',iconName:'square-check',icon:[448,512,[9745,9989,61510,"check-square"],"f14a","M211.8 339.8C200.9 350.7 183.1 350.7 172.2 339.8L108.2 275.8C97.27 264.9 97.27 247.1 108.2 236.2C119.1 225.3 136.9 225.3 147.8 236.2L192 280.4L300.2 172.2C311.1 161.3 328.9 161.3 339.8 172.2C350.7 183.1 350.7 200.9 339.8 211.8L211.8 339.8zM0 96C0 60.65 28.65 32 64 32H384C419.3 32 448 60.65 448 96V416C448 451.3 419.3 480 384 480H64C28.65 480 0 451.3 0 416V96zM48 96V416C48 424.8 55.16 432 64 432H384C392.8 432 400 424.8 400 416V96C400 87.16 392.8 80 384 80H64C55.16 80 48 87.16 48 96z"]};var faCheckSquare=faSquareCheck;var faSquare={prefix:'far',iconName:'square',icon:[448,512,[9632,9723,9724,61590],"f0c8","M384 32C419.3 32 448 60.65 448 96V416C448 451.3 419.3 480 384 480H64C28.65 480 0 451.3 0 416V96C0 60.65 28.65 32 64 32H384zM384 80H64C55.16 80 48 87.16 48 96V416C48 424.8 55.16 432 64 432H384C392.8 432 400 424.8 400 416V96C400 87.16 392.8 80 384 80z"]};var faClock={prefix:'far',iconName:'clock',icon:[512,512,[128339,"clock-four"],"f017","M232 120C232 106.7 242.7 96 256 96C269.3 96 280 106.7 280 120V243.2L365.3 300C376.3 307.4 379.3 322.3 371.1 333.3C364.6 344.3 349.7 347.3 338.7 339.1L242.7 275.1C236 271.5 232 264 232 255.1L232 120zM256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0zM48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 48 256 48C141.1 48 48 141.1 48 256z"]};/* src/lib/components/modes/treemode/contextmenu/ContextMenu.svelte generated by Svelte v3.51.0 */function add_css$x(target){append_styles(target,"svelte-1yai37q",".jse-contextmenu.svelte-1yai37q.svelte-1yai37q{box-shadow:var(--jse-controls-box-shadow);font-family:var(--jse-font-family);font-size:var(--jse-font-size);background:var(--jse-context-menu-background);color:var(--jse-context-menu-color)}.jse-contextmenu.svelte-1yai37q button.svelte-1yai37q{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0}.jse-contextmenu.svelte-1yai37q button.svelte-1yai37q:focus{background:var(--jse-context-menu-background-highlight)}.jse-contextmenu.svelte-1yai37q .jse-row.svelte-1yai37q{display:flex;flex-direction:row;align-items:flex-start;justify-content:stretch}.jse-contextmenu.svelte-1yai37q .jse-row div.jse-label.svelte-1yai37q{flex:1;white-space:nowrap;padding:var(--jse-padding);color:var(--jse-context-menu-color-disabled);line-height:normal}.jse-contextmenu.svelte-1yai37q .jse-row div.jse-tip.svelte-1yai37q{flex:1;background:var(--jse-context-menu-tip-background);color:var(--jse-context-menu-tip-color);margin:calc(0.5 * var(--jse-padding));padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);font-size:80%;line-height:1.3em;display:flex;flex-direction:row;align-items:center;gap:var(--jse-padding);border-radius:3px}.jse-contextmenu.svelte-1yai37q .jse-row div.jse-tip div.svelte-1yai37q{vertical-align:middle}.jse-contextmenu.svelte-1yai37q .jse-row button.svelte-1yai37q{flex:1;white-space:nowrap;padding:var(--jse-padding);color:inherit}.jse-contextmenu.svelte-1yai37q .jse-row button.svelte-1yai37q:hover{background:var(--jse-context-menu-background-highlight)}.jse-contextmenu.svelte-1yai37q .jse-row button.svelte-1yai37q:disabled{color:var(--jse-context-menu-color-disabled);background:unset}.jse-contextmenu.svelte-1yai37q .jse-row button .jse-insert.svelte-1yai37q{display:inline-block;position:relative;width:18px;height:18px;font-family:var(--jse-font-family-mono);font-weight:bold;font-size:16px}.jse-contextmenu.svelte-1yai37q .jse-row button .jse-insert .jse-quote.svelte-1yai37q,.jse-contextmenu.svelte-1yai37q .jse-row button .jse-insert .jse-plus.svelte-1yai37q{position:absolute;top:-4px;left:2px;font-size:24px}.jse-contextmenu.svelte-1yai37q .jse-column.svelte-1yai37q{flex:1;display:flex;flex-direction:column;align-items:stretch}.jse-contextmenu.svelte-1yai37q .jse-column.svelte-1yai37q:not(:last-child){border-right:1px solid var(--jse-context-menu-separator-color)}.jse-contextmenu.svelte-1yai37q .jse-column button.svelte-1yai37q{text-align:left;min-width:130px}.jse-contextmenu.svelte-1yai37q .jse-separator.svelte-1yai37q{width:100%;height:1px;background:var(--jse-context-menu-separator-color)}");}// (231:6) 
function create_defaultItem_slot_2(ctx){var button;var icon;var t;var button_disabled_value;var current;var mounted;var dispose;icon=new Icon({props:{data:faPen}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);t=text(" Edit value");attr(button,"type","button");attr(button,"slot","defaultItem");attr(button,"title","Edit the value (Double-click on the value)");button.disabled=button_disabled_value=!/*canEditValue*/ctx[2];attr(button,"class","svelte-1yai37q");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);append$1(button,t);current=true;if(!mounted){dispose=listen(button,"click",/*handleEditValue*/ctx[18]);mounted=true;}},p:function p(ctx,dirty){if(!current||dirty[0]&/*canEditValue*/4&&button_disabled_value!==(button_disabled_value=!/*canEditValue*/ctx[2])){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (245:6) 
function create_defaultItem_slot_1(ctx){var button;var icon;var t;var button_disabled_value;var current;var mounted;var dispose;icon=new Icon({props:{data:faCut}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);t=text(" Cut");attr(button,"type","button");attr(button,"slot","defaultItem");attr(button,"title","Cut selected contents, formatted with indentation (Ctrl+X)");button.disabled=button_disabled_value=!/*hasSelectionContents*/ctx[1];attr(button,"class","svelte-1yai37q");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);append$1(button,t);current=true;if(!mounted){dispose=listen(button,"click",/*handleCut*/ctx[19]);mounted=true;}},p:function p(ctx,dirty){if(!current||dirty[0]&/*hasSelectionContents*/2&&button_disabled_value!==(button_disabled_value=!/*hasSelectionContents*/ctx[1])){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (256:6) 
function create_defaultItem_slot(ctx){var button;var icon;var t;var button_disabled_value;var current;var mounted;var dispose;icon=new Icon({props:{data:faCopy}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);t=text(" Copy");attr(button,"type","button");attr(button,"slot","defaultItem");attr(button,"title","Copy selected contents, formatted with indentation (Ctrl+C)");button.disabled=button_disabled_value=!/*hasSelectionContents*/ctx[1];attr(button,"class","svelte-1yai37q");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);append$1(button,t);current=true;if(!mounted){dispose=listen(button,"click",/*handleCopy*/ctx[20]);mounted=true;}},p:function p(ctx,dirty){if(!current||dirty[0]&/*hasSelectionContents*/2&&button_disabled_value!==(button_disabled_value=!/*hasSelectionContents*/ctx[1])){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (376:2) {#if showTip}
function create_if_block$j(ctx){var div3;var div2;var div0;var icon;var t0;var div1;var current;icon=new Icon({props:{data:faLightbulb}});return{c:function c(){div3=element("div");div2=element("div");div0=element("div");create_component(icon.$$.fragment);t0=space();div1=element("div");div1.textContent="Tip: you can open this context menu via right-click or with Ctrl+Q";attr(div0,"class","svelte-1yai37q");attr(div1,"class","svelte-1yai37q");attr(div2,"class","jse-tip svelte-1yai37q");attr(div3,"class","jse-row svelte-1yai37q");},m:function m(target,anchor){insert$2(target,div3,anchor);append$1(div3,div2);append$1(div2,div0);mount_component(icon,div0,null);append$1(div2,t0);append$1(div2,div1);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div3);destroy_component(icon);}};}function create_fragment$B(ctx){var div10;var div0;var button0;var icon0;var t0;var button0_disabled_value;var t1;var dropdownbutton0;var t2;var div1;var t3;var div2;var dropdownbutton1;var t4;var dropdownbutton2;var t5;var button1;var icon1;var t6;var button1_disabled_value;var t7;var div3;var t8;var div7;var div4;var button2;var icon2;var t9;var button2_disabled_value;var t10;var button3;var icon3;var t11;var button3_disabled_value;var t12;var button4;var icon4;var t13;var button4_disabled_value;var t14;var button5;var icon5;var t15;var button5_disabled_value;var t16;var button6;var icon6;var t17;var button6_disabled_value;var t18;var div6;var div5;var t19;var t20;var t21;var button7;var span1;var span0;var t23;var button7_title_value;var button7_disabled_value;var t24;var button8;var span2;var t26;var button8_title_value;var button8_disabled_value;var t27;var button9;var span3;var t29;var button9_title_value;var button9_disabled_value;var t30;var button10;var span5;var t32;var button10_title_value;var button10_disabled_value;var t33;var div8;var t34;var div9;var button11;var icon7;var t35;var button11_disabled_value;var t36;var button12;var icon8;var t37;var button12_disabled_value;var t38;var current;var mounted;var dispose;icon0=new Icon({props:{data:faPen}});dropdownbutton0=new DropdownButton$1({props:{width:"11em",items:/*editValueDropdownItems*/ctx[8],$$slots:{defaultItem:[create_defaultItem_slot_2]},$$scope:{ctx:ctx}}});dropdownbutton1=new DropdownButton$1({props:{width:"10em",items:/*cutDropdownItems*/ctx[7],$$slots:{defaultItem:[create_defaultItem_slot_1]},$$scope:{ctx:ctx}}});dropdownbutton2=new DropdownButton$1({props:{width:"12em",items:/*copyDropdownItems*/ctx[6],$$slots:{defaultItem:[create_defaultItem_slot]},$$scope:{ctx:ctx}}});icon1=new Icon({props:{data:faPaste}});icon2=new Icon({props:{data:faTimes}});icon3=new Icon({props:{data:faClone}});icon4=new Icon({props:{data:faCropAlt}});icon5=new Icon({props:{data:faSortAmountDownAlt}});icon6=new Icon({props:{data:faFilter}});icon7=new Icon({props:{data:faCaretSquareUp}});icon8=new Icon({props:{data:faCaretSquareDown}});var if_block=/*showTip*/ctx[0]&&create_if_block$j();return{c:function c(){div10=element("div");div0=element("div");button0=element("button");create_component(icon0.$$.fragment);t0=text(" Edit key");t1=space();create_component(dropdownbutton0.$$.fragment);t2=space();div1=element("div");t3=space();div2=element("div");create_component(dropdownbutton1.$$.fragment);t4=space();create_component(dropdownbutton2.$$.fragment);t5=space();button1=element("button");create_component(icon1.$$.fragment);t6=text(" Paste");t7=space();div3=element("div");t8=space();div7=element("div");div4=element("div");button2=element("button");create_component(icon2.$$.fragment);t9=text(" Remove");t10=space();button3=element("button");create_component(icon3.$$.fragment);t11=text(" Duplicate");t12=space();button4=element("button");create_component(icon4.$$.fragment);t13=text(" Extract");t14=space();button5=element("button");create_component(icon5.$$.fragment);t15=text(" Sort");t16=space();button6=element("button");create_component(icon6.$$.fragment);t17=text(" Transform");t18=space();div6=element("div");div5=element("div");t19=text(/*insertOrConvertText*/ctx[13]);t20=text(":");t21=space();button7=element("button");span1=element("span");span0=element("span");span0.textContent='+';t23=text(" Structure");t24=space();button8=element("button");span2=element("span");span2.textContent='{}';t26=text(" Object");t27=space();button9=element("button");span3=element("span");span3.textContent="[]";t29=text(" Array");t30=space();button10=element("button");span5=element("span");span5.innerHTML="<span class=\"jse-quote svelte-1yai37q\">&quot;</span>";t32=text(" Value");t33=space();div8=element("div");t34=space();div9=element("div");button11=element("button");create_component(icon7.$$.fragment);t35=text(" Insert before");t36=space();button12=element("button");create_component(icon8.$$.fragment);t37=text(" Insert after");t38=space();if(if_block)if_block.c();attr(button0,"type","button");attr(button0,"title","Edit the key (Double-click on the key)");button0.disabled=button0_disabled_value=!/*canEditKey*/ctx[14];attr(button0,"class","svelte-1yai37q");attr(div0,"class","jse-row svelte-1yai37q");attr(div1,"class","jse-separator svelte-1yai37q");attr(button1,"type","button");attr(button1,"title","Paste clipboard contents (Ctrl+V)");button1.disabled=button1_disabled_value=!/*hasSelection*/ctx[3];attr(button1,"class","svelte-1yai37q");attr(div2,"class","jse-row svelte-1yai37q");attr(div3,"class","jse-separator svelte-1yai37q");attr(button2,"type","button");attr(button2,"title","Remove selected contents (Delete)");button2.disabled=button2_disabled_value=!/*hasSelectionContents*/ctx[1];attr(button2,"class","svelte-1yai37q");attr(button3,"type","button");attr(button3,"title","Duplicate selected contents (Ctrl+D)");button3.disabled=button3_disabled_value=!/*canDuplicate*/ctx[16];attr(button3,"class","svelte-1yai37q");attr(button4,"type","button");attr(button4,"title","Extract selected contents");button4.disabled=button4_disabled_value=!/*canExtract*/ctx[15];attr(button4,"class","svelte-1yai37q");attr(button5,"type","button");attr(button5,"title","Sort array or object contents");button5.disabled=button5_disabled_value=!/*hasSelectionContents*/ctx[1];attr(button5,"class","svelte-1yai37q");attr(button6,"type","button");attr(button6,"title","Transform array or object contents (filter, sort, project)");button6.disabled=button6_disabled_value=!/*hasSelectionContents*/ctx[1];attr(button6,"class","svelte-1yai37q");attr(div4,"class","jse-column svelte-1yai37q");attr(div5,"class","jse-label svelte-1yai37q");attr(span0,"class","jse-plus svelte-1yai37q");attr(span1,"class","jse-insert svelte-1yai37q");attr(button7,"type","button");attr(button7,"title",button7_title_value=""+(/*insertOrConvertText*/ctx[13]+" structure"));button7.disabled=button7_disabled_value=!/*canInsertOrConvertStructure*/ctx[12];attr(button7,"class","svelte-1yai37q");attr(span2,"class","jse-insert svelte-1yai37q");attr(button8,"type","button");attr(button8,"title",button8_title_value=""+(/*insertOrConvertText*/ctx[13]+" object"));button8.disabled=button8_disabled_value=!/*canInsertOrConvertObject*/ctx[11];attr(button8,"class","svelte-1yai37q");attr(span3,"class","jse-insert svelte-1yai37q");attr(button9,"type","button");attr(button9,"title",button9_title_value=""+(/*insertOrConvertText*/ctx[13]+" array"));button9.disabled=button9_disabled_value=!/*canInsertOrConvertArray*/ctx[10];attr(button9,"class","svelte-1yai37q");attr(span5,"class","jse-insert svelte-1yai37q");attr(button10,"type","button");attr(button10,"title",button10_title_value=""+(/*insertOrConvertText*/ctx[13]+" value"));button10.disabled=button10_disabled_value=!/*canInsertOrConvertValue*/ctx[9];attr(button10,"class","svelte-1yai37q");attr(div6,"class","jse-column svelte-1yai37q");attr(div7,"class","jse-row svelte-1yai37q");attr(div8,"class","jse-separator svelte-1yai37q");attr(button11,"type","button");attr(button11,"title","Select area before current entry to insert or paste contents");button11.disabled=button11_disabled_value=!/*hasSelectionContents*/ctx[1]||/*rootSelected*/ctx[4];attr(button11,"class","svelte-1yai37q");attr(button12,"type","button");attr(button12,"title","Select area after current entry to insert or paste contents");button12.disabled=button12_disabled_value=!/*hasSelectionContents*/ctx[1]||/*rootSelected*/ctx[4];attr(button12,"class","svelte-1yai37q");attr(div9,"class","jse-row svelte-1yai37q");attr(div10,"class","jse-contextmenu svelte-1yai37q");},m:function m(target,anchor){insert$2(target,div10,anchor);append$1(div10,div0);append$1(div0,button0);mount_component(icon0,button0,null);append$1(button0,t0);append$1(div0,t1);mount_component(dropdownbutton0,div0,null);append$1(div10,t2);append$1(div10,div1);append$1(div10,t3);append$1(div10,div2);mount_component(dropdownbutton1,div2,null);append$1(div2,t4);mount_component(dropdownbutton2,div2,null);append$1(div2,t5);append$1(div2,button1);mount_component(icon1,button1,null);append$1(button1,t6);append$1(div10,t7);append$1(div10,div3);append$1(div10,t8);append$1(div10,div7);append$1(div7,div4);append$1(div4,button2);mount_component(icon2,button2,null);append$1(button2,t9);append$1(div4,t10);append$1(div4,button3);mount_component(icon3,button3,null);append$1(button3,t11);append$1(div4,t12);append$1(div4,button4);mount_component(icon4,button4,null);append$1(button4,t13);append$1(div4,t14);append$1(div4,button5);mount_component(icon5,button5,null);append$1(button5,t15);append$1(div4,t16);append$1(div4,button6);mount_component(icon6,button6,null);append$1(button6,t17);append$1(div7,t18);append$1(div7,div6);append$1(div6,div5);append$1(div5,t19);append$1(div5,t20);append$1(div6,t21);append$1(div6,button7);append$1(button7,span1);append$1(span1,span0);append$1(button7,t23);append$1(div6,t24);append$1(div6,button8);append$1(button8,span2);append$1(button8,t26);append$1(div6,t27);append$1(div6,button9);append$1(button9,span3);append$1(button9,t29);append$1(div6,t30);append$1(div6,button10);append$1(button10,span5);append$1(button10,t32);append$1(div10,t33);append$1(div10,div8);append$1(div10,t34);append$1(div10,div9);append$1(div9,button11);mount_component(icon7,button11,null);append$1(button11,t35);append$1(div9,t36);append$1(div9,button12);mount_component(icon8,button12,null);append$1(button12,t37);append$1(div10,t38);if(if_block)if_block.m(div10,null);/*div10_binding*/ctx[59](div10);current=true;if(!mounted){dispose=[listen(button0,"click",/*handleEditKey*/ctx[17]),listen(button1,"click",/*handlePaste*/ctx[21]),listen(button2,"click",/*handleRemove*/ctx[22]),listen(button3,"click",/*handleDuplicate*/ctx[23]),listen(button4,"click",/*handleExtract*/ctx[24]),listen(button5,"click",/*handleSort*/ctx[26]),listen(button6,"click",/*handleTransform*/ctx[27]),listen(button7,"click",/*click_handler*/ctx[55]),listen(button8,"click",/*click_handler_1*/ctx[56]),listen(button9,"click",/*click_handler_2*/ctx[57]),listen(button10,"click",/*click_handler_3*/ctx[58]),listen(button11,"click",/*handleInsertBefore*/ctx[28]),listen(button12,"click",/*handleInsertAfter*/ctx[29]),listen(div10,"keydown",/*handleKeyDown*/ctx[30])];mounted=true;}},p:function p(ctx,dirty){if(!current||dirty[0]&/*canEditKey*/16384&&button0_disabled_value!==(button0_disabled_value=!/*canEditKey*/ctx[14])){button0.disabled=button0_disabled_value;}var dropdownbutton0_changes={};if(dirty[0]&/*editValueDropdownItems*/256)dropdownbutton0_changes.items=/*editValueDropdownItems*/ctx[8];if(dirty[0]&/*canEditValue*/4|dirty[2]&/*$$scope*/2){dropdownbutton0_changes.$$scope={dirty:dirty,ctx:ctx};}dropdownbutton0.$set(dropdownbutton0_changes);var dropdownbutton1_changes={};if(dirty[0]&/*cutDropdownItems*/128)dropdownbutton1_changes.items=/*cutDropdownItems*/ctx[7];if(dirty[0]&/*hasSelectionContents*/2|dirty[2]&/*$$scope*/2){dropdownbutton1_changes.$$scope={dirty:dirty,ctx:ctx};}dropdownbutton1.$set(dropdownbutton1_changes);var dropdownbutton2_changes={};if(dirty[0]&/*copyDropdownItems*/64)dropdownbutton2_changes.items=/*copyDropdownItems*/ctx[6];if(dirty[0]&/*hasSelectionContents*/2|dirty[2]&/*$$scope*/2){dropdownbutton2_changes.$$scope={dirty:dirty,ctx:ctx};}dropdownbutton2.$set(dropdownbutton2_changes);if(!current||dirty[0]&/*hasSelection*/8&&button1_disabled_value!==(button1_disabled_value=!/*hasSelection*/ctx[3])){button1.disabled=button1_disabled_value;}if(!current||dirty[0]&/*hasSelectionContents*/2&&button2_disabled_value!==(button2_disabled_value=!/*hasSelectionContents*/ctx[1])){button2.disabled=button2_disabled_value;}if(!current||dirty[0]&/*canDuplicate*/65536&&button3_disabled_value!==(button3_disabled_value=!/*canDuplicate*/ctx[16])){button3.disabled=button3_disabled_value;}if(!current||dirty[0]&/*canExtract*/32768&&button4_disabled_value!==(button4_disabled_value=!/*canExtract*/ctx[15])){button4.disabled=button4_disabled_value;}if(!current||dirty[0]&/*hasSelectionContents*/2&&button5_disabled_value!==(button5_disabled_value=!/*hasSelectionContents*/ctx[1])){button5.disabled=button5_disabled_value;}if(!current||dirty[0]&/*hasSelectionContents*/2&&button6_disabled_value!==(button6_disabled_value=!/*hasSelectionContents*/ctx[1])){button6.disabled=button6_disabled_value;}if(!current||dirty[0]&/*insertOrConvertText*/8192)set_data(t19,/*insertOrConvertText*/ctx[13]);if(!current||dirty[0]&/*insertOrConvertText*/8192&&button7_title_value!==(button7_title_value=""+(/*insertOrConvertText*/ctx[13]+" structure"))){attr(button7,"title",button7_title_value);}if(!current||dirty[0]&/*canInsertOrConvertStructure*/4096&&button7_disabled_value!==(button7_disabled_value=!/*canInsertOrConvertStructure*/ctx[12])){button7.disabled=button7_disabled_value;}if(!current||dirty[0]&/*insertOrConvertText*/8192&&button8_title_value!==(button8_title_value=""+(/*insertOrConvertText*/ctx[13]+" object"))){attr(button8,"title",button8_title_value);}if(!current||dirty[0]&/*canInsertOrConvertObject*/2048&&button8_disabled_value!==(button8_disabled_value=!/*canInsertOrConvertObject*/ctx[11])){button8.disabled=button8_disabled_value;}if(!current||dirty[0]&/*insertOrConvertText*/8192&&button9_title_value!==(button9_title_value=""+(/*insertOrConvertText*/ctx[13]+" array"))){attr(button9,"title",button9_title_value);}if(!current||dirty[0]&/*canInsertOrConvertArray*/1024&&button9_disabled_value!==(button9_disabled_value=!/*canInsertOrConvertArray*/ctx[10])){button9.disabled=button9_disabled_value;}if(!current||dirty[0]&/*insertOrConvertText*/8192&&button10_title_value!==(button10_title_value=""+(/*insertOrConvertText*/ctx[13]+" value"))){attr(button10,"title",button10_title_value);}if(!current||dirty[0]&/*canInsertOrConvertValue*/512&&button10_disabled_value!==(button10_disabled_value=!/*canInsertOrConvertValue*/ctx[9])){button10.disabled=button10_disabled_value;}if(!current||dirty[0]&/*hasSelectionContents, rootSelected*/18&&button11_disabled_value!==(button11_disabled_value=!/*hasSelectionContents*/ctx[1]||/*rootSelected*/ctx[4])){button11.disabled=button11_disabled_value;}if(!current||dirty[0]&/*hasSelectionContents, rootSelected*/18&&button12_disabled_value!==(button12_disabled_value=!/*hasSelectionContents*/ctx[1]||/*rootSelected*/ctx[4])){button12.disabled=button12_disabled_value;}if(/*showTip*/ctx[0]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*showTip*/1){transition_in(if_block,1);}}else{if_block=create_if_block$j();if_block.c();transition_in(if_block,1);if_block.m(div10,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(icon0.$$.fragment,local);transition_in(dropdownbutton0.$$.fragment,local);transition_in(dropdownbutton1.$$.fragment,local);transition_in(dropdownbutton2.$$.fragment,local);transition_in(icon1.$$.fragment,local);transition_in(icon2.$$.fragment,local);transition_in(icon3.$$.fragment,local);transition_in(icon4.$$.fragment,local);transition_in(icon5.$$.fragment,local);transition_in(icon6.$$.fragment,local);transition_in(icon7.$$.fragment,local);transition_in(icon8.$$.fragment,local);transition_in(if_block);current=true;},o:function o(local){transition_out(icon0.$$.fragment,local);transition_out(dropdownbutton0.$$.fragment,local);transition_out(dropdownbutton1.$$.fragment,local);transition_out(dropdownbutton2.$$.fragment,local);transition_out(icon1.$$.fragment,local);transition_out(icon2.$$.fragment,local);transition_out(icon3.$$.fragment,local);transition_out(icon4.$$.fragment,local);transition_out(icon5.$$.fragment,local);transition_out(icon6.$$.fragment,local);transition_out(icon7.$$.fragment,local);transition_out(icon8.$$.fragment,local);transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div10);destroy_component(icon0);destroy_component(dropdownbutton0);destroy_component(dropdownbutton1);destroy_component(dropdownbutton2);destroy_component(icon1);destroy_component(icon2);destroy_component(icon3);destroy_component(icon4);destroy_component(icon5);destroy_component(icon6);destroy_component(icon7);destroy_component(icon8);if(if_block)if_block.d();/*div10_binding*/ctx[59](null);mounted=false;run_all(dispose);}};}function instance$B($$self,$$props,$$invalidate){var selection;var hasJson;var hasSelection;var rootSelected;var focusValue;var hasSelectionContents;var canDuplicate;var canExtract;var canEditKey;var canEditValue;var convertMode;var insertOrConvertText;var canInsertOrConvertStructure;var canInsertOrConvertObject;var canInsertOrConvertArray;var canInsertOrConvertValue;var enforceString;var editValueDropdownItems;var cutDropdownItems;var copyDropdownItems;var json=$$props.json;var documentState=$$props.documentState;var parser=$$props.parser;var showTip=$$props.showTip;var onCloseContextMenu=$$props.onCloseContextMenu;var onEditKey=$$props.onEditKey;var onEditValue=$$props.onEditValue;var onToggleEnforceString=$$props.onToggleEnforceString;var onCut=$$props.onCut;var onCopy=$$props.onCopy;var onPaste=$$props.onPaste;var onRemove=$$props.onRemove;var onDuplicate=$$props.onDuplicate;var onExtract=$$props.onExtract;var onInsertBefore=$$props.onInsertBefore;var onInsert=$$props.onInsert;var onConvert=$$props.onConvert;var onInsertAfter=$$props.onInsertAfter;var onSort=$$props.onSort;var onTransform=$$props.onTransform;var refContextMenu;onMount(function(){setTimeout(function(){var firstEnabledButton=_toConsumableArray2(refContextMenu.querySelectorAll('button')).find(function(button){return!button.disabled;});if(firstEnabledButton){firstEnabledButton.focus();}});});function handleEditKey(){onCloseContextMenu();onEditKey();}function handleEditValue(){onCloseContextMenu();onEditValue();}function handleToggleEnforceString(){onCloseContextMenu();onToggleEnforceString();}function handleCut(){onCloseContextMenu();onCut(true);}function handleCutCompact(){onCloseContextMenu();onCut(false);}function handleCopy(){onCloseContextMenu();onCopy(true);}function handleCopyCompact(){onCloseContextMenu();onCopy(false);}function handlePaste(){onCloseContextMenu();onPaste();}function handleRemove(){onCloseContextMenu();onRemove();}function handleDuplicate(){onCloseContextMenu();onDuplicate();}function handleExtract(){onCloseContextMenu();onExtract();}function handleInsertOrConvert(type){onCloseContextMenu();if(hasSelectionContents){onConvert(type);}else{onInsert(type);}}function handleSort(){onCloseContextMenu();onSort();}function handleTransform(){onCloseContextMenu();onTransform();}function handleInsertBefore(){onCloseContextMenu();onInsertBefore();}function handleInsertAfter(){onCloseContextMenu();onInsertAfter();}function handleKeyDown(event){var combo=keyComboFromEvent(event).replace(/^Command\+/,'Ctrl+');if(combo==='Up'||combo==='Down'||combo==='Left'||combo==='Right'){event.preventDefault();var buttons=Array.from(refContextMenu.querySelectorAll('button:not([disabled])'));var nearest=findNearestElement({allElements:buttons,currentElement:event.target,direction:combo,hasPrio:function hasPrio(element){return element.getAttribute('data-type')!=='jse-open-dropdown';}});if(nearest){nearest.focus();}}}var click_handler=function click_handler(){return handleInsertOrConvert('structure');};var click_handler_1=function click_handler_1(){return handleInsertOrConvert('object');};var click_handler_2=function click_handler_2(){return handleInsertOrConvert('array');};var click_handler_3=function click_handler_3(){return handleInsertOrConvert('value');};function div10_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refContextMenu=$$value;$$invalidate(5,refContextMenu);});}$$self.$$set=function($$props){if('json'in $$props)$$invalidate(31,json=$$props.json);if('documentState'in $$props)$$invalidate(32,documentState=$$props.documentState);if('parser'in $$props)$$invalidate(33,parser=$$props.parser);if('showTip'in $$props)$$invalidate(0,showTip=$$props.showTip);if('onCloseContextMenu'in $$props)$$invalidate(34,onCloseContextMenu=$$props.onCloseContextMenu);if('onEditKey'in $$props)$$invalidate(35,onEditKey=$$props.onEditKey);if('onEditValue'in $$props)$$invalidate(36,onEditValue=$$props.onEditValue);if('onToggleEnforceString'in $$props)$$invalidate(37,onToggleEnforceString=$$props.onToggleEnforceString);if('onCut'in $$props)$$invalidate(38,onCut=$$props.onCut);if('onCopy'in $$props)$$invalidate(39,onCopy=$$props.onCopy);if('onPaste'in $$props)$$invalidate(40,onPaste=$$props.onPaste);if('onRemove'in $$props)$$invalidate(41,onRemove=$$props.onRemove);if('onDuplicate'in $$props)$$invalidate(42,onDuplicate=$$props.onDuplicate);if('onExtract'in $$props)$$invalidate(43,onExtract=$$props.onExtract);if('onInsertBefore'in $$props)$$invalidate(44,onInsertBefore=$$props.onInsertBefore);if('onInsert'in $$props)$$invalidate(45,onInsert=$$props.onInsert);if('onConvert'in $$props)$$invalidate(46,onConvert=$$props.onConvert);if('onInsertAfter'in $$props)$$invalidate(47,onInsertAfter=$$props.onInsertAfter);if('onSort'in $$props)$$invalidate(48,onSort=$$props.onSort);if('onTransform'in $$props)$$invalidate(49,onTransform=$$props.onTransform);};$$self.$$.update=function(){if($$self.$$.dirty[1]&/*documentState*/2){$$invalidate(51,selection=documentState.selection);}if($$self.$$.dirty[1]&/*json*/1){$$invalidate(54,hasJson=json!==undefined);}if($$self.$$.dirty[1]&/*selection*/1048576){$$invalidate(3,hasSelection=selection!=null);}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*selection*/1048576){$$invalidate(4,rootSelected=hasSelection&&isEmpty(selection.focusPath));}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*json, selection*/1048577){$$invalidate(52,focusValue=hasSelection?immutableJSONPatch.exports.getIn(json,selection.focusPath):undefined);}if($$self.$$.dirty[1]&/*hasJson, selection*/9437184){$$invalidate(1,hasSelectionContents=hasJson&&(isMultiSelection(selection)||isKeySelection(selection)||isValueSelection(selection)));}if($$self.$$.dirty[0]&/*hasSelectionContents, rootSelected*/18|$$self.$$.dirty[1]&/*hasJson*/8388608){$$invalidate(16,canDuplicate=hasJson&&hasSelectionContents&&!rootSelected);// must not be root
}if($$self.$$.dirty[0]&/*rootSelected*/16|$$self.$$.dirty[1]&/*hasJson, selection*/9437184){$$invalidate(15,canExtract=hasJson&&selection!=null&&(isMultiSelection(selection)||isValueSelection(selection))&&!rootSelected);// must not be root
}if($$self.$$.dirty[0]&/*rootSelected*/16|$$self.$$.dirty[1]&/*hasJson, selection, json*/9437185){$$invalidate(14,canEditKey=hasJson&&selection!=null&&singleItemSelected(selection)&&!rootSelected&&!Array.isArray(immutableJSONPatch.exports.getIn(json,initial(selection.focusPath))));}if($$self.$$.dirty[1]&/*hasJson, selection, focusValue*/11534336){$$invalidate(2,canEditValue=hasJson&&selection!=null&&singleItemSelected(selection)&&!isObjectOrArray(focusValue));}if($$self.$$.dirty[0]&/*hasSelectionContents*/2){$$invalidate(53,convertMode=hasSelectionContents);}if($$self.$$.dirty[1]&/*convertMode*/4194304){$$invalidate(13,insertOrConvertText=convertMode?'Convert to':'Insert');}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*convertMode*/4194304){$$invalidate(12,canInsertOrConvertStructure=convertMode?false:hasSelection);}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*convertMode, selection, focusValue*/7340032){$$invalidate(11,canInsertOrConvertObject=convertMode?canConvert(selection)&&!isObject$1(focusValue):hasSelection);}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*convertMode, selection, focusValue*/7340032){$$invalidate(10,canInsertOrConvertArray=convertMode?canConvert(selection)&&!Array.isArray(focusValue):hasSelection);}if($$self.$$.dirty[0]&/*hasSelection*/8|$$self.$$.dirty[1]&/*convertMode, selection, focusValue*/7340032){$$invalidate(9,canInsertOrConvertValue=convertMode?canConvert(selection)&&isObjectOrArray(focusValue):hasSelection);}if($$self.$$.dirty[1]&/*selection, focusValue, documentState, parser*/3145734){$$invalidate(50,enforceString=selection!=null?getEnforceString(focusValue,documentState.enforceStringMap,immutableJSONPatch.exports.compileJSONPointer(selection.focusPath),parser):false);}if($$self.$$.dirty[0]&/*canEditValue*/4|$$self.$$.dirty[1]&/*enforceString*/524288){$$invalidate(8,editValueDropdownItems=[{icon:faPen,text:'Edit value',title:'Edit the value (Double-click on the value)',onClick:handleEditValue,disabled:!canEditValue},{icon:enforceString?faCheckSquare:faSquare,text:'Enforce string',title:'Enforce keeping the value as string when it contains a numeric value',onClick:handleToggleEnforceString,disabled:!canEditValue}]);}if($$self.$$.dirty[0]&/*hasSelectionContents*/2){$$invalidate(7,cutDropdownItems=[{icon:faCut,text:'Cut formatted',title:'Cut selected contents, formatted with indentation (Ctrl+X)',onClick:handleCut,disabled:!hasSelectionContents},{icon:faCut,text:'Cut compacted',title:'Cut selected contents, without indentation (Ctrl+Shift+X)',onClick:handleCutCompact,disabled:!hasSelectionContents}]);}if($$self.$$.dirty[0]&/*hasSelectionContents*/2){$$invalidate(6,copyDropdownItems=[{icon:faCopy,text:'Copy formatted',title:'Copy selected contents, formatted with indentation (Ctrl+C)',onClick:handleCopy,disabled:!hasSelectionContents},{icon:faCopy,text:'Copy compacted',title:'Copy selected contents, without indentation (Ctrl+Shift+C)',onClick:handleCopyCompact,disabled:!hasSelectionContents}]);}};return[showTip,hasSelectionContents,canEditValue,hasSelection,rootSelected,refContextMenu,copyDropdownItems,cutDropdownItems,editValueDropdownItems,canInsertOrConvertValue,canInsertOrConvertArray,canInsertOrConvertObject,canInsertOrConvertStructure,insertOrConvertText,canEditKey,canExtract,canDuplicate,handleEditKey,handleEditValue,handleCut,handleCopy,handlePaste,handleRemove,handleDuplicate,handleExtract,handleInsertOrConvert,handleSort,handleTransform,handleInsertBefore,handleInsertAfter,handleKeyDown,json,documentState,parser,onCloseContextMenu,onEditKey,onEditValue,onToggleEnforceString,onCut,onCopy,onPaste,onRemove,onDuplicate,onExtract,onInsertBefore,onInsert,onConvert,onInsertAfter,onSort,onTransform,enforceString,selection,focusValue,convertMode,hasJson,click_handler,click_handler_1,click_handler_2,click_handler_3,div10_binding];}var ContextMenu=/*#__PURE__*/function(_SvelteComponent21){_inherits(ContextMenu,_SvelteComponent21);var _super62=_createSuper(ContextMenu);function ContextMenu(options){var _this116;_classCallCheck(this,ContextMenu);_this116=_super62.call(this);init(_assertThisInitialized(_this116),options,instance$B,create_fragment$B,not_equal,{json:31,documentState:32,parser:33,showTip:0,onCloseContextMenu:34,onEditKey:35,onEditValue:36,onToggleEnforceString:37,onCut:38,onCopy:39,onPaste:40,onRemove:41,onDuplicate:42,onExtract:43,onInsertBefore:44,onInsert:45,onConvert:46,onInsertAfter:47,onSort:48,onTransform:49},add_css$x,[-1,-1,-1]);return _this116;}return _createClass(ContextMenu);}(SvelteComponent);var ContextMenu$1=ContextMenu;var classnames$1={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(module){/* global define */(function(){var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=_typeof2(arg);if(argType==='string'||argType==='number'){classes.push(arg);}else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner);}}}else if(argType==='object'){if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes('[native code]')){classes.push(arg.toString());continue;}for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key);}}}}return classes.join(' ');}if(module.exports){classNames["default"]=classNames;module.exports=classNames;}else{window.classNames=classNames;}})();})(classnames$1);var classnames=classnames$1.exports;/* src/lib/components/modes/treemode/CollapsedItems.svelte generated by Svelte v3.51.0 */function add_css$w(target){append_styles(target,"svelte-1knbf5w","div.jse-collapsed-items.svelte-1knbf5w.svelte-1knbf5w{font-family:var(--jse-font-family);font-size:var(--jse-font-size);color:var(--jse-collapsed-items-link-color);padding:calc(0.5 * var(--jse-padding));border:8px solid transparent;border-width:8px 0;background-color:transparent;background-image:linear-gradient(var(--jse-collapsed-items-background-color), var(--jse-collapsed-items-background-color)), linear-gradient(to bottom right, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to bottom left, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to top right, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%), linear-gradient(to top left, transparent 50.5%, var(--jse-collapsed-items-background-color) 50.5%);background-repeat:repeat, repeat-x, repeat-x, repeat-x, repeat-x;background-position:0 0, 8px 0, 8px 0, 8px 100%, 8px 100%;background-size:auto auto, 16px 16px, 16px 16px, 16px 16px, 16px 16px;background-clip:padding-box, border-box, border-box, border-box, border-box;background-origin:padding-box, border-box, border-box, border-box, border-box;display:flex}div.jse-collapsed-items.svelte-1knbf5w div.jse-text.svelte-1knbf5w,div.jse-collapsed-items.svelte-1knbf5w button.jse-expand-items.svelte-1knbf5w{margin:0 calc(0.5 * var(--jse-padding))}div.jse-collapsed-items.svelte-1knbf5w div.jse-text.svelte-1knbf5w{display:inline}div.jse-collapsed-items.svelte-1knbf5w button.jse-expand-items.svelte-1knbf5w{font-family:inherit;font-size:inherit;color:var(--jse-collapsed-items-link-color);background:none;border:none;padding:0;text-decoration:underline;cursor:pointer}div.jse-collapsed-items.svelte-1knbf5w button.jse-expand-items.svelte-1knbf5w:hover,div.jse-collapsed-items.svelte-1knbf5w button.jse-expand-items.svelte-1knbf5w:focus{color:var(--jse-collapsed-items-link-color-highlight)}");}function get_each_context$b(ctx,list,i){var child_ctx=ctx.slice();child_ctx[13]=list[i];return child_ctx;}// (39:4) {#each expandItemsSections as expandItemsSection}
function create_each_block$b(ctx){var button;var t0;var t1_value=/*expandItemsSection*/ctx[13].start+"";var t1;var t2;var t3_value=/*expandItemsSection*/ctx[13].end+"";var t3;var t4;var mounted;var dispose;function click_handler(){return(/*click_handler*/ctx[12](/*expandItemsSection*/ctx[13]));}return{c:function c(){button=element("button");t0=text("show ");t1=text(t1_value);t2=text("-");t3=text(t3_value);t4=space();attr(button,"type","button");attr(button,"class","jse-expand-items svelte-1knbf5w");},m:function m(target,anchor){insert$2(target,button,anchor);append$1(button,t0);append$1(button,t1);append$1(button,t2);append$1(button,t3);append$1(button,t4);if(!mounted){dispose=listen(button,"click",click_handler);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(dirty&/*expandItemsSections*/16&&t1_value!==(t1_value=/*expandItemsSection*/ctx[13].start+""))set_data(t1,t1_value);if(dirty&/*expandItemsSections*/16&&t3_value!==(t3_value=/*expandItemsSection*/ctx[13].end+""))set_data(t3,t3_value);},d:function d(detaching){if(detaching)detach(button);mounted=false;dispose();}};}function create_fragment$A(ctx){var div2;var div1;var div0;var t0;var t1;var t2;var t3;var t4;var div2_style_value;var mounted;var dispose;var each_value=/*expandItemsSections*/ctx[4];var each_blocks=[];for(var _i245=0;_i245<each_value.length;_i245+=1){each_blocks[_i245]=create_each_block$b(get_each_context$b(ctx,each_value,_i245));}return{c:function c(){div2=element("div");div1=element("div");div0=element("div");t0=text("Items ");t1=text(/*startIndex*/ctx[3]);t2=text("-");t3=text(/*endIndex*/ctx[2]);t4=space();for(var _i246=0;_i246<each_blocks.length;_i246+=1){each_blocks[_i246].c();}attr(div0,"class","jse-text svelte-1knbf5w");attr(div2,"class","jse-collapsed-items svelte-1knbf5w");attr(div2,"style",div2_style_value=getIndentationStyle$1(/*path*/ctx[0].length+2));toggle_class(div2,"jse-selected",/*selected*/ctx[5]);},m:function m(target,anchor){insert$2(target,div2,anchor);append$1(div2,div1);append$1(div1,div0);append$1(div0,t0);append$1(div0,t1);append$1(div0,t2);append$1(div0,t3);append$1(div1,t4);for(var _i247=0;_i247<each_blocks.length;_i247+=1){each_blocks[_i247].m(div1,null);}if(!mounted){dispose=listen(div2,"mousemove",handleMouseMove);mounted=true;}},p:function p(ctx,_ref112){var _ref113=_slicedToArray(_ref112,1),dirty=_ref113[0];if(dirty&/*startIndex*/8)set_data(t1,/*startIndex*/ctx[3]);if(dirty&/*endIndex*/4)set_data(t3,/*endIndex*/ctx[2]);if(dirty&/*onExpandSection, path, expandItemsSections*/19){each_value=/*expandItemsSections*/ctx[4];var _i248;for(_i248=0;_i248<each_value.length;_i248+=1){var child_ctx=get_each_context$b(ctx,each_value,_i248);if(each_blocks[_i248]){each_blocks[_i248].p(child_ctx,dirty);}else{each_blocks[_i248]=create_each_block$b(child_ctx);each_blocks[_i248].c();each_blocks[_i248].m(div1,null);}}for(;_i248<each_blocks.length;_i248+=1){each_blocks[_i248].d(1);}each_blocks.length=each_value.length;}if(dirty&/*path*/1&&div2_style_value!==(div2_style_value=getIndentationStyle$1(/*path*/ctx[0].length+2))){attr(div2,"style",div2_style_value);}if(dirty&/*selected*/32){toggle_class(div2,"jse-selected",/*selected*/ctx[5]);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div2);destroy_each(each_blocks,detaching);mounted=false;dispose();}};}function getIndentationStyle$1(level){return"margin-left: calc(".concat(level," * var(--jse-indent-size))");}function handleMouseMove(event){// prevent the whole array from being selected whilst dragging over
// a section with collapsed items
event.stopPropagation();}function instance$A($$self,$$props,$$invalidate){var visibleSection;var startIndex;var endIndex;var selected;var expandItemsSections;var visibleSections=$$props.visibleSections;var sectionIndex=$$props.sectionIndex;var total=$$props.total;var path=$$props.path;var pointer=$$props.pointer;var selection=$$props.selection;var onExpandSection=$$props.onExpandSection;var click_handler=function click_handler(expandItemsSection){return onExpandSection(path,expandItemsSection);};$$self.$$set=function($$props){if('visibleSections'in $$props)$$invalidate(6,visibleSections=$$props.visibleSections);if('sectionIndex'in $$props)$$invalidate(7,sectionIndex=$$props.sectionIndex);if('total'in $$props)$$invalidate(8,total=$$props.total);if('path'in $$props)$$invalidate(0,path=$$props.path);if('pointer'in $$props)$$invalidate(9,pointer=$$props.pointer);if('selection'in $$props)$$invalidate(10,selection=$$props.selection);if('onExpandSection'in $$props)$$invalidate(1,onExpandSection=$$props.onExpandSection);};$$self.$$.update=function(){if($$self.$$.dirty&/*visibleSections, sectionIndex*/192){$$invalidate(11,visibleSection=visibleSections[sectionIndex]);}if($$self.$$.dirty&/*visibleSection*/2048){$$invalidate(3,startIndex=visibleSection.end);}if($$self.$$.dirty&/*visibleSections, sectionIndex, total*/448){$$invalidate(2,endIndex=visibleSections[sectionIndex+1]?visibleSections[sectionIndex+1].start:total);}if($$self.$$.dirty&/*selection, pointer, startIndex*/1544){$$invalidate(5,selected=isMultiSelection(selection)?selection.pointersMap[immutableJSONPatch.exports.appendToJSONPointer(pointer,startIndex)]===true:false);}if($$self.$$.dirty&/*startIndex, endIndex*/12){$$invalidate(4,expandItemsSections=getExpandItemsSections(startIndex,endIndex));}};return[path,onExpandSection,endIndex,startIndex,expandItemsSections,selected,visibleSections,sectionIndex,total,pointer,selection,visibleSection,click_handler];}var CollapsedItems=/*#__PURE__*/function(_SvelteComponent22){_inherits(CollapsedItems,_SvelteComponent22);var _super63=_createSuper(CollapsedItems);function CollapsedItems(options){var _this117;_classCallCheck(this,CollapsedItems);_this117=_super63.call(this);init(_assertThisInitialized(_this117),options,instance$A,create_fragment$A,not_equal,{visibleSections:6,sectionIndex:7,total:8,path:0,pointer:9,selection:10,onExpandSection:1},add_css$w);return _this117;}return _createClass(CollapsedItems);}(SvelteComponent);var CollapsedItems$1=CollapsedItems;/* src/lib/components/modes/treemode/contextmenu/ContextMenuButton.svelte generated by Svelte v3.51.0 */function add_css$v(target){append_styles(target,"svelte-dol684",".jse-context-menu-button.svelte-dol684{position:absolute;top:calc(-0.5 * var(--jse-context-menu-button-size));right:calc(-0.5 * var(--jse-context-menu-button-size));width:var(--jse-context-menu-button-size);height:var(--jse-context-menu-button-size);padding:0;margin:0;z-index:2;cursor:pointer;background:transparent;border-radius:2px;background:var(--jse-context-menu-button-background);color:var(--jse-context-menu-button-color);border:none;box-shadow:var(--jse-controls-box-shadow)}.jse-context-menu-button.svelte-dol684:hover{background:var(--jse-context-menu-button-background-highlight)}");}function create_fragment$z(ctx){var button;var icon;var current;var mounted;var dispose;icon=new Icon({props:{data:faCaretDown}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-context-menu-button svelte-dol684");attr(button,"title",CONTEXT_MENU_EXPLANATION);toggle_class(button,"jse-selected",/*selected*/ctx[0]);},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);current=true;if(!mounted){dispose=listen(button,"click",/*handleClick*/ctx[1]);mounted=true;}},p:function p(ctx,_ref114){var _ref115=_slicedToArray(_ref114,1),dirty=_ref115[0];if(!current||dirty&/*selected*/1){toggle_class(button,"jse-selected",/*selected*/ctx[0]);}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}function instance$z($$self,$$props,$$invalidate){var selected=$$props.selected;var onContextMenu=$$props.onContextMenu;function handleClick(event){var buttonElem=event.target;while(buttonElem&&buttonElem.nodeName!=='BUTTON'){buttonElem=buttonElem.parentNode;}if(buttonElem){onContextMenu({anchor:buttonElem,left:0,top:0,width:CONTEXT_MENU_WIDTH,height:CONTEXT_MENU_HEIGHT,offsetTop:2,offsetLeft:0,showTip:true});}}$$self.$$set=function($$props){if('selected'in $$props)$$invalidate(0,selected=$$props.selected);if('onContextMenu'in $$props)$$invalidate(2,onContextMenu=$$props.onContextMenu);};return[selected,handleClick,onContextMenu];}var ContextMenuButton=/*#__PURE__*/function(_SvelteComponent23){_inherits(ContextMenuButton,_SvelteComponent23);var _super64=_createSuper(ContextMenuButton);function ContextMenuButton(options){var _this118;_classCallCheck(this,ContextMenuButton);_this118=_super64.call(this);init(_assertThisInitialized(_this118),options,instance$z,create_fragment$z,not_equal,{selected:0,onContextMenu:2},add_css$v);return _this118;}return _createClass(ContextMenuButton);}(SvelteComponent);var ContextMenuButton$1=ContextMenuButton;/* src/lib/components/modes/treemode/highlight/SearchResultHighlighter.svelte generated by Svelte v3.51.0 */function add_css$u(target){append_styles(target,"svelte-s6kbew",".jse-highlight.svelte-s6kbew{background-color:var(--jse-search-match-color);outline:var(--jse-search-match-outline)}.jse-highlight.jse-active.svelte-s6kbew{background-color:var(--jse-search-match-active-color);outline:var(--jse-search-match-active-outline)}");}function get_each_context$a(ctx,list,i){var child_ctx=ctx.slice();child_ctx[3]=list[i];return child_ctx;}// (11:2) {:else}
function create_else_block$b(ctx){var span;var t_value=addNewLineSuffix(/*part*/ctx[3].text)+"";var t;return{c:function c(){span=element("span");t=text(t_value);attr(span,"class","jse-highlight svelte-s6kbew");toggle_class(span,"jse-active",/*part*/ctx[3].active);},m:function m(target,anchor){insert$2(target,span,anchor);append$1(span,t);},p:function p(ctx,dirty){if(dirty&/*parts*/1&&t_value!==(t_value=addNewLineSuffix(/*part*/ctx[3].text)+""))set_data(t,t_value);if(dirty&/*parts*/1){toggle_class(span,"jse-active",/*part*/ctx[3].active);}},d:function d(detaching){if(detaching)detach(span);}};}// (9:2) {#if part.type === 'normal'}
function create_if_block$i(ctx){var t_value=/*part*/ctx[3].text+"";var t;return{c:function c(){t=text(t_value);},m:function m(target,anchor){insert$2(target,t,anchor);},p:function p(ctx,dirty){if(dirty&/*parts*/1&&t_value!==(t_value=/*part*/ctx[3].text+""))set_data(t,t_value);},d:function d(detaching){if(detaching)detach(t);}};}// (8:0) {#each parts as part}
function create_each_block$a(ctx){var if_block_anchor;function select_block_type(ctx,dirty){if(/*part*/ctx[3].type==='normal')return create_if_block$i;return create_else_block$b;}var current_block_type=select_block_type(ctx);var if_block=current_block_type(ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);},p:function p(ctx,dirty){if(current_block_type===(current_block_type=select_block_type(ctx))&&if_block){if_block.p(ctx,dirty);}else{if_block.d(1);if_block=current_block_type(ctx);if(if_block){if_block.c();if_block.m(if_block_anchor.parentNode,if_block_anchor);}}},d:function d(detaching){if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}function create_fragment$y(ctx){var each_1_anchor;var each_value=/*parts*/ctx[0];var each_blocks=[];for(var _i249=0;_i249<each_value.length;_i249+=1){each_blocks[_i249]=create_each_block$a(get_each_context$a(ctx,each_value,_i249));}return{c:function c(){for(var _i250=0;_i250<each_blocks.length;_i250+=1){each_blocks[_i250].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i251=0;_i251<each_blocks.length;_i251+=1){each_blocks[_i251].m(target,anchor);}insert$2(target,each_1_anchor,anchor);},p:function p(ctx,_ref116){var _ref117=_slicedToArray(_ref116,1),dirty=_ref117[0];if(dirty&/*parts, addNewLineSuffix*/1){each_value=/*parts*/ctx[0];var _i252;for(_i252=0;_i252<each_value.length;_i252+=1){var child_ctx=get_each_context$a(ctx,each_value,_i252);if(each_blocks[_i252]){each_blocks[_i252].p(child_ctx,dirty);}else{each_blocks[_i252]=create_each_block$a(child_ctx);each_blocks[_i252].c();each_blocks[_i252].m(each_1_anchor.parentNode,each_1_anchor);}}for(;_i252<each_blocks.length;_i252+=1){each_blocks[_i252].d(1);}each_blocks.length=each_value.length;}},i:noop$2,o:noop$2,d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}function instance$y($$self,$$props,$$invalidate){var parts;var text=$$props.text;var searchResultItems=$$props.searchResultItems;$$self.$$set=function($$props){if('text'in $$props)$$invalidate(1,text=$$props.text);if('searchResultItems'in $$props)$$invalidate(2,searchResultItems=$$props.searchResultItems);};$$self.$$.update=function(){if($$self.$$.dirty&/*text, searchResultItems*/6){$$invalidate(0,parts=splitValue(String(text),searchResultItems));}};return[parts,text,searchResultItems];}var SearchResultHighlighter=/*#__PURE__*/function(_SvelteComponent24){_inherits(SearchResultHighlighter,_SvelteComponent24);var _super65=_createSuper(SearchResultHighlighter);function SearchResultHighlighter(options){var _this119;_classCallCheck(this,SearchResultHighlighter);_this119=_super65.call(this);init(_assertThisInitialized(_this119),options,instance$y,create_fragment$y,safe_not_equal,{text:1,searchResultItems:2},add_css$u);return _this119;}return _createClass(SearchResultHighlighter);}(SvelteComponent);var SearchResultHighlighter$1=SearchResultHighlighter;/* src/lib/components/controls/EditableDiv.svelte generated by Svelte v3.51.0 */function add_css$t(target){append_styles(target,"svelte-rw77oa",".jse-value.jse-string.svelte-rw77oa{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-rw77oa,.jse-value.jse-array.svelte-rw77oa{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-rw77oa{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-rw77oa{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-rw77oa{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-rw77oa{color:var(--jse-text-color)}.jse-value.jse-url.svelte-rw77oa{color:var(--jse-value-color-url);text-decoration:underline}div.jse-editable-div.svelte-rw77oa{min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;word-break:normal;white-space:pre-wrap;overflow-wrap:anywhere}div.jse-editable-div.jse-short-text.svelte-rw77oa{overflow-wrap:normal}div.jse-editable-div[contenteditable=true].svelte-rw77oa{outline:var(--jse-edit-outline);background:inherit !important;position:relative;border-radius:0;z-index:3}div.jse-editable-div.jse-empty.svelte-rw77oa:not(:focus){outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}div.jse-editable-div.jse-empty.svelte-rw77oa::after{pointer-events:none;color:var(--jse-tag-background)}");}function create_fragment$x(ctx){var div;var div_class_value;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class",div_class_value=""+(null_to_empty(classnames('jse-editable-div',/*valueClass*/ctx[2],{'jse-short-text':/*shortText*/ctx[0]}))+" svelte-rw77oa"));attr(div,"contenteditable","true");attr(div,"spellcheck","false");},m:function m(target,anchor){insert$2(target,div,anchor);/*div_binding*/ctx[13](div);if(!mounted){dispose=[listen(div,"input",/*handleValueInput*/ctx[3]),listen(div,"keydown",/*handleValueKeyDown*/ctx[4]),listen(div,"paste",/*handleValuePaste*/ctx[5]),listen(div,"blur",/*handleBlur*/ctx[6])];mounted=true;}},p:function p(ctx,_ref118){var _ref119=_slicedToArray(_ref118,1),dirty=_ref119[0];if(dirty&/*valueClass, shortText*/5&&div_class_value!==(div_class_value=""+(null_to_empty(classnames('jse-editable-div',/*valueClass*/ctx[2],{'jse-short-text':/*shortText*/ctx[0]}))+" svelte-rw77oa"))){attr(div,"class",div_class_value);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);/*div_binding*/ctx[13](null);mounted=false;run_all(dispose);}};}function instance$x($$self,$$props,$$invalidate){var debug=createDebug('jsoneditor:EditableDiv');var value=$$props.value;var _$$props$shortText=$$props.shortText,shortText=_$$props$shortText===void 0?false:_$$props$shortText;var onChange=$$props.onChange;var onCancel=$$props.onCancel;var onFind=$$props.onFind;var _$$props$onPaste=$$props.onPaste,onPaste=_$$props$onPaste===void 0?noop:_$$props$onPaste;var _$$props$onValueClass=$$props.onValueClass,onValueClass=_$$props$onValueClass===void 0?function(){return'';}:_$$props$onValueClass;var domValue;var valueClass=onValueClass(value);var closed=false;onMount(function(){debug('onMount',{value:value});setDomValue(value);// focus
setTimeout(function(){return setCursorToEnd(domValue);});});onDestroy(function(){var newValue=getDomValue();debug('onDestroy',{closed:closed,value:value,newValue:newValue});if(!closed&&newValue!==value){onChange(newValue,UPDATE_SELECTION.NO);}});function getDomValue(){return removeNewLineSuffix(domValue.innerText);}function setDomValue(updatedValue){$$invalidate(1,domValue.innerText=addNewLineSuffix(updatedValue),domValue);}function handleValueInput(){var newValue=getDomValue();if(newValue===''){// immediately update to clean up any left over <br/>
setDomValue('');}// update class
$$invalidate(2,valueClass=onValueClass(newValue));}function handleValueKeyDown(event){event.stopPropagation();var combo=keyComboFromEvent(event).replace(/^Command\+/,'Ctrl+');if(combo==='Escape'){// cancel changes (needed to prevent triggering a change onDestroy)
closed=true;onCancel();}if(combo==='Enter'||combo==='Tab'){// apply changes
closed=true;var newValue=getDomValue();onChange(newValue,UPDATE_SELECTION.NEXT_INSIDE);}if(combo==='Ctrl+F'){event.preventDefault();onFind(false);}if(combo==='Ctrl+H'){event.preventDefault();onFind(true);}}function handleValuePaste(event){if(!onPaste){return;}var clipboardText=event.clipboardData.getData('text/plain');onPaste(clipboardText);}function handleBlur(){var hasFocus=document.hasFocus();var newValue=getDomValue();debug('handleBlur',{hasFocus:hasFocus,closed:closed,value:value,newValue:newValue});// we only want to close the editable div when the focus did go to another
// element on the same page, but not when the user switches to another
// application or browser tab to copy/paste something whilst still editing
// the value, hence the check for document.hasFocus()
if(document.hasFocus()&&!closed){closed=true;if(newValue!==value){onChange(newValue,UPDATE_SELECTION.SELF);}else{onCancel();}}}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){domValue=$$value;$$invalidate(1,domValue);});}$$self.$$set=function($$props){if('value'in $$props)$$invalidate(7,value=$$props.value);if('shortText'in $$props)$$invalidate(0,shortText=$$props.shortText);if('onChange'in $$props)$$invalidate(8,onChange=$$props.onChange);if('onCancel'in $$props)$$invalidate(9,onCancel=$$props.onCancel);if('onFind'in $$props)$$invalidate(10,onFind=$$props.onFind);if('onPaste'in $$props)$$invalidate(11,onPaste=$$props.onPaste);if('onValueClass'in $$props)$$invalidate(12,onValueClass=$$props.onValueClass);};return[shortText,domValue,valueClass,handleValueInput,handleValueKeyDown,handleValuePaste,handleBlur,value,onChange,onCancel,onFind,onPaste,onValueClass,div_binding];}var EditableDiv=/*#__PURE__*/function(_SvelteComponent25){_inherits(EditableDiv,_SvelteComponent25);var _super66=_createSuper(EditableDiv);function EditableDiv(options){var _this120;_classCallCheck(this,EditableDiv);_this120=_super66.call(this);init(_assertThisInitialized(_this120),options,instance$x,create_fragment$x,not_equal,{value:7,shortText:0,onChange:8,onCancel:9,onFind:10,onPaste:11,onValueClass:12},add_css$t);return _this120;}return _createClass(EditableDiv);}(SvelteComponent);var EditableDiv$1=EditableDiv;/* src/lib/components/modes/treemode/JSONKey.svelte generated by Svelte v3.51.0 */function add_css$s(target){append_styles(target,"svelte-566egb",".jse-key.svelte-566egb{display:inline-block;min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;color:var(--jse-key-color);word-break:normal;overflow-wrap:normal;white-space:pre-wrap}.jse-key.svelte-566egb:hover{background:var(--jse-hover-background-color)}.jse-key.svelte-566egb:hover{background:var(--jse-hover-background-color)}.jse-key.jse-empty.svelte-566egb{min-width:3em;outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}.jse-key.jse-empty.svelte-566egb::after{pointer-events:none;color:var(--jse-tag-background);content:\"key\"}");}// (59:0) {:else}
function create_else_block$a(ctx){var div;var current_block_type_index;var if_block;var div_class_value;var current;var mounted;var dispose;var if_block_creators=[create_if_block_2$6,create_else_block_1$4];var if_blocks=[];function select_block_type_1(ctx,dirty){if(/*searchResultItems*/ctx[1])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if_block.c();attr(div,"data-type","selectable-key");attr(div,"class",div_class_value=""+(null_to_empty(/*getKeyClass*/ctx[6](/*key*/ctx[0]))+" svelte-566egb"));},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);current=true;if(!mounted){dispose=listen(div,"dblclick",/*handleKeyDoubleClick*/ctx[5]);mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,null);}if(!current||dirty&/*key*/1&&div_class_value!==(div_class_value=""+(null_to_empty(/*getKeyClass*/ctx[6](/*key*/ctx[0]))+" svelte-566egb"))){attr(div,"class",div_class_value);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();mounted=false;dispose();}};}// (51:0) {#if isEditingKey}
function create_if_block_1$9(ctx){var editablediv;var current;editablediv=new EditableDiv$1({props:{value:/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]),shortText:true,onChange:/*handleChangeValue*/ctx[7],onCancel:/*handleCancelChange*/ctx[8],onFind:/*context*/ctx[2].onFind}});return{c:function c(){create_component(editablediv.$$.fragment);},m:function m(target,anchor){mount_component(editablediv,target,anchor);current=true;},p:function p(ctx,dirty){var editablediv_changes={};if(dirty&/*context, key*/5)editablediv_changes.value=/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]);if(dirty&/*context*/4)editablediv_changes.onFind=/*context*/ctx[2].onFind;editablediv.$set(editablediv_changes);},i:function i(local){if(current)return;transition_in(editablediv.$$.fragment,local);current=true;},o:function o(local){transition_out(editablediv.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(editablediv,detaching);}};}// (63:4) {:else}
function create_else_block_1$4(ctx){var t_value=addNewLineSuffix(/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]))+"";var t;return{c:function c(){t=text(t_value);},m:function m(target,anchor){insert$2(target,t,anchor);},p:function p(ctx,dirty){if(dirty&/*context, key*/5&&t_value!==(t_value=addNewLineSuffix(/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]))+""))set_data(t,t_value);},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(t);}};}// (61:4) {#if searchResultItems}
function create_if_block_2$6(ctx){var searchresulthighlighter;var current;searchresulthighlighter=new SearchResultHighlighter$1({props:{text:/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]),searchResultItems:/*searchResultItems*/ctx[1]}});return{c:function c(){create_component(searchresulthighlighter.$$.fragment);},m:function m(target,anchor){mount_component(searchresulthighlighter,target,anchor);current=true;},p:function p(ctx,dirty){var searchresulthighlighter_changes={};if(dirty&/*context, key*/5)searchresulthighlighter_changes.text=/*context*/ctx[2].normalization.escapeValue(/*key*/ctx[0]);if(dirty&/*searchResultItems*/2)searchresulthighlighter_changes.searchResultItems=/*searchResultItems*/ctx[1];searchresulthighlighter.$set(searchresulthighlighter_changes);},i:function i(local){if(current)return;transition_in(searchresulthighlighter.$$.fragment,local);current=true;},o:function o(local){transition_out(searchresulthighlighter.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(searchresulthighlighter,detaching);}};}// (68:0) {#if !context.readOnly && isSelected && !isEditingKey}
function create_if_block$h(ctx){var contextmenubutton;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:true,onContextMenu:/*context*/ctx[2].onContextMenu}});return{c:function c(){create_component(contextmenubutton.$$.fragment);},m:function m(target,anchor){mount_component(contextmenubutton,target,anchor);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty&/*context*/4)contextmenubutton_changes.onContextMenu=/*context*/ctx[2].onContextMenu;contextmenubutton.$set(contextmenubutton_changes);},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(contextmenubutton,detaching);}};}function create_fragment$w(ctx){var current_block_type_index;var if_block0;var t;var if_block1_anchor;var current;var if_block_creators=[create_if_block_1$9,create_else_block$a];var if_blocks=[];function select_block_type(ctx,dirty){if(/*isEditingKey*/ctx[4])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);var if_block1=!/*context*/ctx[2].readOnly&&/*isSelected*/ctx[3]&&!/*isEditingKey*/ctx[4]&&create_if_block$h(ctx);return{c:function c(){if_block0.c();t=space();if(if_block1)if_block1.c();if_block1_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,t,anchor);if(if_block1)if_block1.m(target,anchor);insert$2(target,if_block1_anchor,anchor);current=true;},p:function p(ctx,_ref120){var _ref121=_slicedToArray(_ref120,1),dirty=_ref121[0];var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block0=if_blocks[current_block_type_index];if(!if_block0){if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block0.c();}else{if_block0.p(ctx,dirty);}transition_in(if_block0,1);if_block0.m(t.parentNode,t);}if(!/*context*/ctx[2].readOnly&&/*isSelected*/ctx[3]&&!/*isEditingKey*/ctx[4]){if(if_block1){if_block1.p(ctx,dirty);if(dirty&/*context, isSelected, isEditingKey*/28){transition_in(if_block1,1);}}else{if_block1=create_if_block$h(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(if_block1_anchor.parentNode,if_block1_anchor);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(t);if(if_block1)if_block1.d(detaching);if(detaching)detach(if_block1_anchor);}};}function instance$w($$self,$$props,$$invalidate){var isSelected;var isEditingKey;var path=$$props.path;var pointer=$$props.pointer;var key=$$props.key;var selection=$$props.selection;var searchResultItems=$$props.searchResultItems;var onUpdateKey=$$props.onUpdateKey;var context=$$props.context;function handleKeyDoubleClick(event){if(!isEditingKey&&!context.readOnly){event.preventDefault();context.onSelect(createKeySelection(path,true));}}function getKeyClass(key){return classnames('jse-key',{'jse-empty':key===''});}function handleChangeValue(newKey,updateSelection){var updatedKey=onUpdateKey(key,context.normalization.unescapeValue(newKey));var updatedPath=initial(path).concat(updatedKey);context.onSelect(updateSelection===UPDATE_SELECTION.NEXT_INSIDE?createValueSelection(updatedPath,false):createKeySelection(updatedPath,false));if(updateSelection!==UPDATE_SELECTION.SELF){context.focus();}}function handleCancelChange(){context.onSelect(createKeySelection(path,false));context.focus();}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(9,path=$$props.path);if('pointer'in $$props)$$invalidate(10,pointer=$$props.pointer);if('key'in $$props)$$invalidate(0,key=$$props.key);if('selection'in $$props)$$invalidate(11,selection=$$props.selection);if('searchResultItems'in $$props)$$invalidate(1,searchResultItems=$$props.searchResultItems);if('onUpdateKey'in $$props)$$invalidate(12,onUpdateKey=$$props.onUpdateKey);if('context'in $$props)$$invalidate(2,context=$$props.context);};$$self.$$.update=function(){if($$self.$$.dirty&/*selection, pointer*/3072){$$invalidate(3,isSelected=selection?selection.pointersMap[pointer]===true&&isKeySelection(selection):undefined);}if($$self.$$.dirty&/*isSelected, selection*/2056){$$invalidate(4,isEditingKey=isSelected&&isEditingSelection(selection));}};return[key,searchResultItems,context,isSelected,isEditingKey,handleKeyDoubleClick,getKeyClass,handleChangeValue,handleCancelChange,path,pointer,selection,onUpdateKey];}var JSONKey=/*#__PURE__*/function(_SvelteComponent26){_inherits(JSONKey,_SvelteComponent26);var _super67=_createSuper(JSONKey);function JSONKey(options){var _this121;_classCallCheck(this,JSONKey);_this121=_super67.call(this);init(_assertThisInitialized(_this121),options,instance$w,create_fragment$w,not_equal,{path:9,pointer:10,key:0,selection:11,searchResultItems:1,onUpdateKey:12,context:2},add_css$s);return _this121;}return _createClass(JSONKey);}(SvelteComponent);var JSONKey$1=JSONKey;/* src/lib/components/modes/treemode/JSONValue.svelte generated by Svelte v3.51.0 */function get_each_context$9(ctx,list,i){var child_ctx=ctx.slice();child_ctx[9]=list[i];return child_ctx;}// (31:0) {#each renderers as renderer}
function create_each_block$9(ctx){var switch_instance;var switch_instance_anchor;var current;var switch_instance_spread_levels=[/*renderer*/ctx[9].props];var switch_value=/*renderer*/ctx[9].component;function switch_props(ctx){var switch_instance_props={};for(var _i253=0;_i253<switch_instance_spread_levels.length;_i253+=1){switch_instance_props=assign$1(switch_instance_props,switch_instance_spread_levels[_i253]);}return{props:switch_instance_props};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){var switch_instance_changes=dirty&/*renderers*/1?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*renderer*/ctx[9].props)]):{};if(switch_value!==(switch_value=/*renderer*/ctx[9].component)){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}function create_fragment$v(ctx){var each_1_anchor;var current;var each_value=/*renderers*/ctx[0];var each_blocks=[];for(var _i254=0;_i254<each_value.length;_i254+=1){each_blocks[_i254]=create_each_block$9(get_each_context$9(ctx,each_value,_i254));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){for(var _i255=0;_i255<each_blocks.length;_i255+=1){each_blocks[_i255].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i256=0;_i256<each_blocks.length;_i256+=1){each_blocks[_i256].m(target,anchor);}insert$2(target,each_1_anchor,anchor);current=true;},p:function p(ctx,_ref122){var _ref123=_slicedToArray(_ref122,1),dirty=_ref123[0];if(dirty&/*renderers*/1){each_value=/*renderers*/ctx[0];var _i257;for(_i257=0;_i257<each_value.length;_i257+=1){var child_ctx=get_each_context$9(ctx,each_value,_i257);if(each_blocks[_i257]){each_blocks[_i257].p(child_ctx,dirty);transition_in(each_blocks[_i257],1);}else{each_blocks[_i257]=create_each_block$9(child_ctx);each_blocks[_i257].c();transition_in(each_blocks[_i257],1);each_blocks[_i257].m(each_1_anchor.parentNode,each_1_anchor);}}group_outros();for(_i257=each_value.length;_i257<each_blocks.length;_i257+=1){out(_i257);}check_outros();}},i:function i(local){if(current)return;for(var _i258=0;_i258<each_value.length;_i258+=1){transition_in(each_blocks[_i258]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i259=0;_i259<each_blocks.length;_i259+=1){transition_out(each_blocks[_i259]);}current=false;},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}function instance$v($$self,$$props,$$invalidate){var isEditing;var renderers;var path=$$props.path;var value=$$props.value;var context=$$props.context;var isSelected=$$props.isSelected;var enforceString=$$props.enforceString;var selection=$$props.selection;var searchResultItems=$$props.searchResultItems;$$self.$$set=function($$props){if('path'in $$props)$$invalidate(1,path=$$props.path);if('value'in $$props)$$invalidate(2,value=$$props.value);if('context'in $$props)$$invalidate(3,context=$$props.context);if('isSelected'in $$props)$$invalidate(4,isSelected=$$props.isSelected);if('enforceString'in $$props)$$invalidate(5,enforceString=$$props.enforceString);if('selection'in $$props)$$invalidate(6,selection=$$props.selection);if('searchResultItems'in $$props)$$invalidate(7,searchResultItems=$$props.searchResultItems);};$$self.$$.update=function(){if($$self.$$.dirty&/*context, selection*/72){$$invalidate(8,isEditing=!context.readOnly&&isValueSelection(selection)&&isEditingSelection(selection));}if($$self.$$.dirty&/*context, path, value, enforceString, isSelected, isEditing, selection, searchResultItems*/510){$$invalidate(0,renderers=context.onRenderValue({path:path,value:value,readOnly:context.readOnly,enforceString:enforceString,isSelected:isSelected,isEditing:isEditing,parser:context.parser,normalization:context.normalization,selection:selection,searchResultItems:searchResultItems,onPatch:context.onPatch,onPasteJson:context.onPasteJson,onSelect:context.onSelect,onFind:context.onFind,focus:context.focus}));}};return[renderers,path,value,context,isSelected,enforceString,selection,searchResultItems,isEditing];}var JSONValue=/*#__PURE__*/function(_SvelteComponent27){_inherits(JSONValue,_SvelteComponent27);var _super68=_createSuper(JSONValue);function JSONValue(options){var _this122;_classCallCheck(this,JSONValue);_this122=_super68.call(this);init(_assertThisInitialized(_this122),options,instance$v,create_fragment$v,not_equal,{path:1,value:2,context:3,isSelected:4,enforceString:5,selection:6,searchResultItems:7});return _this122;}return _createClass(JSONValue);}(SvelteComponent);var JSONValue$1=JSONValue;var singleton={selecting:false,selectionAnchor:null,selectionAnchorType:null,selectionFocus:null,dragging:false};function onMoveSelection(_ref124){var json=_ref124.json,documentState=_ref124.documentState,deltaY=_ref124.deltaY,items=_ref124.items;var selection=documentState.selection;var dragInsideAction=deltaY<0?findSwapPathUp({json:json,selection:selection,deltaY:deltaY,items:items}):findSwapPathDown({json:json,selection:selection,deltaY:deltaY,items:items});if(!dragInsideAction||dragInsideAction.offset===0){return{operations:undefined,updatedSelection:undefined,offset:0};}var operations=moveInsideParent(json,documentState.selection,dragInsideAction);var path=initial(getStartPath(selection));var value=immutableJSONPatch.exports.getIn(json,path);if(Array.isArray(value)){var updatedSelection=createUpdatedArraySelection({items:items,json:json,selection:selection,offset:dragInsideAction.offset});return{operations:operations,updatedSelection:updatedSelection,offset:dragInsideAction.offset};}else{// object
return{operations:operations,updatedSelection:undefined,offset:dragInsideAction.offset};}}function findSwapPathUp(_ref125){var items=_ref125.items,selection=_ref125.selection,deltaY=_ref125.deltaY;var initialPath=getStartPath(selection);var initialIndex=items.findIndex(function(item){return isEqual$1(item.path,initialPath);});var prevHeight=function prevHeight(){var _items2;return(_items2=items[index-1])===null||_items2===void 0?void 0:_items2.height;};var index=initialIndex;var cumulativeHeight=0;while(prevHeight()!==undefined&&Math.abs(deltaY)>cumulativeHeight+prevHeight()/2){cumulativeHeight+=prevHeight();index-=1;}var beforePath=items[index].path;var offset=index-initialIndex;return index!==initialIndex&&items[index]!==undefined?{beforePath:beforePath,offset:offset}:undefined;}function findSwapPathDown(_ref126){var _items$beforeIndex;var json=_ref126.json,items=_ref126.items,selection=_ref126.selection,deltaY=_ref126.deltaY;var initialPath=getEndPath(selection);var initialIndex=items.findIndex(function(item){return isEqual$1(item.path,initialPath);});var cumulativeHeight=0;var index=initialIndex;var nextHeight=function nextHeight(){var _items3;return(_items3=items[index+1])===null||_items3===void 0?void 0:_items3.height;};while(nextHeight()!==undefined&&Math.abs(deltaY)>cumulativeHeight+nextHeight()/2){cumulativeHeight+=nextHeight();index+=1;}var parentPath=initial(initialPath);var parent=immutableJSONPatch.exports.getIn(json,parentPath);var isArray=Array.isArray(parent);var beforeIndex=isArray?index:index+1;var beforePath=(_items$beforeIndex=items[beforeIndex])===null||_items$beforeIndex===void 0?void 0:_items$beforeIndex.path;var offset=index-initialIndex;return beforePath?{beforePath:beforePath,offset:offset}:{append:true,offset:offset};}function createUpdatedArraySelection(_ref127){var _items4,_items5;var items=_ref127.items,json=_ref127.json,selection=_ref127.selection,offset=_ref127.offset;var startPath=getStartPath(selection);var endPath=getEndPath(selection);var startIndex=items.findIndex(function(item){return isEqual$1(item.path,startPath);});var endIndex=items.findIndex(function(item){return isEqual$1(item.path,endPath);});var anchorPath=(_items4=items[startIndex+offset])===null||_items4===void 0?void 0:_items4.path;var focusPath=(_items5=items[endIndex+offset])===null||_items5===void 0?void 0:_items5.path;return createMultiSelection(json,anchorPath,focusPath);}// TODO: write unit tests
function filterMapOrUndefined(map,filter){if(!map){return undefined;}var filteredMap={};for(var _i260=0,_Object$keys5=Object.keys(map);_i260<_Object$keys5.length;_i260++){var _p9=_Object$keys5[_i260];if(filter(_p9,map[_p9])){filteredMap[_p9]=map[_p9];}}return Object.keys(filteredMap).length>0?filteredMap:undefined;}// TODO: write unit tests
function filterPointerOrUndefined(map,pointer){return filterMapOrUndefined(map,function(p){return immutableJSONPatch.exports.startsWithJSONPointer(p,pointer);});}/* src/lib/components/controls/tooltip/Tooltip.svelte generated by Svelte v3.51.0 */function add_css$r(target){append_styles(target,"svelte-r4omvg",".jse-tooltip.svelte-r4omvg{font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);border-radius:3px;background:var(--jse-context-menu-background);color:var(--jse-context-menu-color);white-space:nowrap;box-shadow:var(--jse-controls-box-shadow)}");}function create_fragment$u(ctx){var div;var t;return{c:function c(){div=element("div");t=text(/*text*/ctx[0]);attr(div,"class","jse-tooltip svelte-r4omvg");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t);},p:function p(ctx,_ref128){var _ref129=_slicedToArray(_ref128,1),dirty=_ref129[0];if(dirty&/*text*/1)set_data(t,/*text*/ctx[0]);},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}function instance$u($$self,$$props,$$invalidate){var text=$$props.text;$$self.$$set=function($$props){if('text'in $$props)$$invalidate(0,text=$$props.text);};return[text];}var Tooltip=/*#__PURE__*/function(_SvelteComponent28){_inherits(Tooltip,_SvelteComponent28);var _super69=_createSuper(Tooltip);function Tooltip(options){var _this123;_classCallCheck(this,Tooltip);_this123=_super69.call(this);init(_assertThisInitialized(_this123),options,instance$u,create_fragment$u,safe_not_equal,{text:0},add_css$r);return _this123;}return _createClass(Tooltip);}(SvelteComponent);var Tooltip$1=Tooltip;function tooltip(node,_ref130){var text=_ref130.text,openAbsolutePopup=_ref130.openAbsolutePopup,closeAbsolutePopup=_ref130.closeAbsolutePopup;var popupId;function handleMouseEnter(){var props={text:text};// opening popup will fail if there is already a popup open
popupId=openAbsolutePopup(Tooltip$1,props,{position:'top',width:10*text.length,offsetTop:3,anchor:node,closeOnOuterClick:true});}function handleMouseLeave(){closeAbsolutePopup(popupId);}node.addEventListener('mouseenter',handleMouseEnter);node.addEventListener('mouseleave',handleMouseLeave);return{destroy:function destroy(){node.removeEventListener('mouseenter',handleMouseEnter);node.removeEventListener('mouseleave',handleMouseLeave);}};}/* src/lib/components/modes/treemode/ValidationErrorIcon.svelte generated by Svelte v3.51.0 */function add_css$q(target){append_styles(target,"svelte-1q62mys","button.jse-validation-error.svelte-1q62mys{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;color:var(--jse-warning-color);padding:0 5px;margin:0;font-size:var(--jse-font-size-mono);height:var(--jse-line-height);overflow:hidden}");}function create_fragment$t(ctx){var button;var icon;var tooltip_action;var current;var mounted;var dispose;icon=new Icon({props:{data:faExclamationTriangle}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-validation-error svelte-1q62mys");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);current=true;if(!mounted){dispose=[listen(button,"click",function(){if(is_function(/*onExpand*/ctx[0]))/*onExpand*/ctx[0].apply(this,arguments);}),action_destroyer(tooltip_action=tooltip.call(null,button,_objectSpread2({text:/*text*/ctx[1]},/*absolutePopupContext*/ctx[2])))];mounted=true;}},p:function p(new_ctx,_ref131){var _ref132=_slicedToArray(_ref131,1),dirty=_ref132[0];ctx=new_ctx;if(tooltip_action&&is_function(tooltip_action.update)&&dirty&/*text*/2)tooltip_action.update.call(null,_objectSpread2({text:/*text*/ctx[1]},/*absolutePopupContext*/ctx[2]));},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;run_all(dispose);}};}function instance$t($$self,$$props,$$invalidate){var text;var absolutePopupContext=getContext('absolute-popup');var validationError=$$props.validationError;var onExpand=$$props.onExpand;$$self.$$set=function($$props){if('validationError'in $$props)$$invalidate(3,validationError=$$props.validationError);if('onExpand'in $$props)$$invalidate(0,onExpand=$$props.onExpand);};$$self.$$.update=function(){if($$self.$$.dirty&/*validationError*/8){$$invalidate(1,text=validationError.isChildError?'Contains invalid data':validationError.message);}};return[onExpand,text,absolutePopupContext,validationError];}var ValidationErrorIcon=/*#__PURE__*/function(_SvelteComponent29){_inherits(ValidationErrorIcon,_SvelteComponent29);var _super70=_createSuper(ValidationErrorIcon);function ValidationErrorIcon(options){var _this124;_classCallCheck(this,ValidationErrorIcon);_this124=_super70.call(this);init(_assertThisInitialized(_this124),options,instance$t,create_fragment$t,safe_not_equal,{validationError:3,onExpand:0},add_css$q);return _this124;}return _createClass(ValidationErrorIcon);}(SvelteComponent);var ValidationErrorIcon$1=ValidationErrorIcon;/* src/lib/components/modes/treemode/JSONNode.svelte generated by Svelte v3.51.0 */function add_css$p(target){append_styles(target,"svelte-uj4yd7",".jse-json-node.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{position:relative;color:var(--jse-text-color)}.jse-json-node.jse-root.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{min-height:100%;padding-bottom:2px;box-sizing:border-box}.jse-json-node.jse-root.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7 .jse-context-menu-button,.jse-json-node.jse-root.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7 .jse-context-menu-button{top:0;right:calc(-2px - var(--jse-context-menu-button-size))}.jse-json-node.jse-root.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7.svelte-uj4yd7{padding-left:0}.jse-json-node.jse-hovered.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7,.jse-json-node.jse-hovered.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-hovered.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-hovered.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-hovered.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-hovered.svelte-uj4yd7 .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{background:var(--jse-hover-background-color)}.jse-json-node.svelte-uj4yd7 .jse-props.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.svelte-uj4yd7 .jse-items.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{position:relative}.jse-json-node.svelte-uj4yd7 .jse-header-outer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.svelte-uj4yd7 .jse-footer-outer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:flex}.jse-json-node.svelte-uj4yd7 .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{position:relative}.jse-json-node.svelte-uj4yd7 .jse-header .jse-meta.svelte-uj4yd7>.jse-meta-inner.svelte-uj4yd7.svelte-uj4yd7{display:flex;justify-content:center}.jse-json-node.svelte-uj4yd7 .jse-contents-outer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:flex}.jse-json-node.svelte-uj4yd7 .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.svelte-uj4yd7 .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:flex;flex-direction:row}.jse-json-node.svelte-uj4yd7 .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{padding-left:var(--jse-indent-size)}.jse-json-node.svelte-uj4yd7 .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:inline-flex;padding-left:calc(var(--jse-indent-size) + 5px)}.jse-json-node.svelte-uj4yd7 .jse-insert-selection-area.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{visibility:hidden;padding:0 calc(0.5 * var(--jse-padding));flex:1}.jse-json-node.svelte-uj4yd7 .jse-insert-selection-area.jse-inside.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:inline-flex;align-items:center}.jse-json-node.svelte-uj4yd7 .jse-insert-selection-area.jse-after.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:flex;align-items:flex-end}.jse-json-node.svelte-uj4yd7:hover>.jse-contents-outer .jse-insert-selection-area.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7:not(.jse-selected),.jse-json-node.svelte-uj4yd7 .jse-header-outer.svelte-uj4yd7:hover>.jse-insert-selection-area.svelte-uj4yd7.svelte-uj4yd7:not(.jse-selected),.jse-json-node.svelte-uj4yd7 .jse-footer-outer:hover .jse-insert-selection-area.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7:not(.jse-selected){visibility:visible;z-index:1}.jse-json-node.svelte-uj4yd7 .jse-context-menu-button-anchor.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{position:relative}.jse-json-node.svelte-uj4yd7 .jse-insert-area.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{display:flex;position:relative;max-width:250px;min-width:100px;height:0;margin-right:calc(0.5 * var(--jse-padding));outline:1px solid}.jse-json-node.svelte-uj4yd7 .jse-insert-area.svelte-uj4yd7 .jse-context-menu-button{right:-1px;background:var(--jse-selection-background-color)}.jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-hovered.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{outline-color:var(--jse-selection-background-color)}.jse-json-node.jse-selected.svelte-uj4yd7 .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-meta.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-value{background:var(--jse-selection-background-color) !important;cursor:grab}.jse-json-node.jse-selected.svelte-uj4yd7 .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{cursor:pointer}.jse-json-node.jse-selected-key.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7>.jse-identifier>.jse-key,.jse-json-node.jse-selected-key.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-identifier>.jse-key{background:var(--jse-selection-background-color);cursor:grab}.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7>.jse-value{background:var(--jse-selection-background-color);cursor:grab}.jse-json-node.svelte-uj4yd7 .jse-collapsed-items.jse-selected,.jse-json-node.jse-selected.svelte-uj4yd7 .jse-collapsed-items,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-collapsed-items{background-color:var(--jse-selection-background-color);cursor:grab;background-image:linear-gradient(var(--jse-collapsed-items-selected-background-color), var(--jse-collapsed-items-selected-background-color)), linear-gradient(to bottom right, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to bottom left, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to top right, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to top left, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%)}.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{background:var(--jse-selection-background-color) !important}.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7 .jse-value,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7 .jse-key,.jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7 .jse-value{background:var(--jse-selection-background-color);cursor:grab}.jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{z-index:2;outline-color:var(--jse-context-menu-button-background)}.jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7 .jse-context-menu-button{background:var(--jse-context-menu-button-background)}.jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7 .jse-context-menu-button:hover{background:var(--jse-context-menu-button-background-highlight)}.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-meta.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-value{background:var(--jse-selection-background-light-color) !important;cursor:grab}.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{cursor:pointer}.jse-main:not(.jse-focus) .jse-json-node.jse-selected-key.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7>.jse-identifier>.jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-key.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-identifier>.jse-key{background:var(--jse-selection-background-light-color);cursor:grab}.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-contents-outer.svelte-uj4yd7>.jse-contents.svelte-uj4yd7>.jse-value{background:var(--jse-selection-background-light-color);cursor:grab}.jse-main:not(.jse-focus) .jse-json-node.svelte-uj4yd7 .jse-collapsed-items.jse-selected,.jse-main:not(.jse-focus) .jse-json-node.jse-selected.svelte-uj4yd7 .jse-collapsed-items,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-collapsed-items{background-color:var(--jse-selection-background-light-color);cursor:grab;background-image:linear-gradient(var(--jse-collapsed-items-selected-background-color), var(--jse-collapsed-items-selected-background-color)), linear-gradient(to bottom right, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to bottom left, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to top right, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%), linear-gradient(to top left, transparent 50.5%, var(--jse-collapsed-items-selected-background-color) 50.5%)}.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{background:var(--jse-selection-background-light-color) !important}.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-meta.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-header-outer.svelte-uj4yd7>.jse-header.svelte-uj4yd7>.jse-meta.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7>.jse-footer-outer.svelte-uj4yd7>.jse-footer.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-contents.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-header.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-footer.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-props .jse-expand.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-contents.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-header.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-footer.svelte-uj4yd7 .jse-value,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7 .jse-key,.jse-main:not(.jse-focus) .jse-json-node.jse-selected-value.svelte-uj4yd7 .jse-items .jse-expand.svelte-uj4yd7 .jse-value{background:var(--jse-selection-background-light-color);cursor:grab}.jse-main:not(.jse-focus) .jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{z-index:2;outline-color:var(--jse-selection-background-color)}.jse-main:not(.jse-focus) .jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7 .jse-context-menu-button{background:var(--jse-selection-background-color)}.jse-main:not(.jse-focus) .jse-json-node.svelte-uj4yd7 .jse-insert-area.jse-selected.svelte-uj4yd7 .jse-context-menu-button:hover{background:var(--jse-selection-background-color)}.jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{width:var(--jse-indent-size);padding:0;margin:0;border:none;cursor:pointer;background:transparent;color:var(--jse-delimiter-color);font-size:var(--jse-font-size-mono);height:var(--jse-line-height)}.jse-expand.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7:hover{opacity:0.8}.jse-meta.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-separator.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-index.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7,.jse-bracket.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{vertical-align:top;color:var(--jse-delimiter-color)}.jse-index.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{padding:0 calc(0.5 * var(--jse-padding))}.jse-bracket.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{padding:0 2px}.jse-bracket.jse-expanded.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{padding-right:var(--jse-padding)}.jse-tag.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{border:none;font-size:80%;font-family:var(--jse-font-family);color:var(--jse-tag-color);background:var(--jse-tag-background);border-radius:2px;cursor:pointer;position:relative;display:inline-block;padding:0 4px;line-height:normal;margin:1px 0}.jse-tag.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7:hover{opacity:0.8}.jse-tag.jse-expanded.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{opacity:0.7;cursor:inherit}.jse-identifier.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7.svelte-uj4yd7{vertical-align:top;position:relative}");}var get_identifier_slot_changes_2=function get_identifier_slot_changes_2(dirty){return{};};var get_identifier_slot_context_2=function get_identifier_slot_context_2(ctx){return{};};function get_each_context_2(ctx,list,i){var child_ctx=ctx.slice();child_ctx[53]=list[i];return child_ctx;}var get_identifier_slot_changes_1=function get_identifier_slot_changes_1(dirty){return{};};var get_identifier_slot_context_1=function get_identifier_slot_context_1(ctx){return{};};function get_each_context$8(ctx,list,i){var child_ctx=ctx.slice();child_ctx[47]=list[i];child_ctx[49]=i;return child_ctx;}function get_each_context_1(ctx,list,i){var child_ctx=ctx.slice();child_ctx[50]=list[i];return child_ctx;}var get_identifier_slot_changes=function get_identifier_slot_changes(dirty){return{};};var get_identifier_slot_context=function get_identifier_slot_context(ctx){return{};};// (676:2) {:else}
function create_else_block_5(ctx){var div1;var div0;var t0;var t1;var jsonvalue;var t2;var show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);var t3;var t4;var current;var identifier_slot_template=/*#slots*/ctx[34].identifier;var identifier_slot=create_slot(identifier_slot_template,ctx,/*$$scope*/ctx[35],get_identifier_slot_context_2);var if_block0=!/*root*/ctx[17]&&create_if_block_26();jsonvalue=new JSONValue$1({props:{path:/*path*/ctx[1],value:/*value*/ctx[0],enforceString:/*enforceString*/ctx[13],isSelected:/*isSelected*/ctx[16],selection:/*isSelected*/ctx[16]?/*selection*/ctx[7]:undefined,searchResultItems:filterValueSearchResults(/*searchResultItemsMap*/ctx[6],/*pointer*/ctx[9]),context:/*context*/ctx[8]}});var if_block1=show_if&&create_if_block_25(ctx);var if_block2=/*validationError*/ctx[15]&&create_if_block_24(ctx);var if_block3=!/*root*/ctx[17]&&create_if_block_23(ctx);return{c:function c(){div1=element("div");div0=element("div");if(identifier_slot)identifier_slot.c();t0=space();if(if_block0)if_block0.c();t1=space();create_component(jsonvalue.$$.fragment);t2=space();if(if_block1)if_block1.c();t3=space();if(if_block2)if_block2.c();t4=space();if(if_block3)if_block3.c();attr(div0,"class","jse-contents svelte-uj4yd7");attr(div1,"class","jse-contents-outer svelte-uj4yd7");attr(div1,"style",/*indentationStyle*/ctx[18]);},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);if(identifier_slot){identifier_slot.m(div0,null);}append$1(div0,t0);if(if_block0)if_block0.m(div0,null);append$1(div0,t1);mount_component(jsonvalue,div0,null);append$1(div0,t2);if(if_block1)if_block1.m(div0,null);append$1(div1,t3);if(if_block2)if_block2.m(div1,null);append$1(div1,t4);if(if_block3)if_block3.m(div1,null);current=true;},p:function p(ctx,dirty){if(identifier_slot){if(identifier_slot.p&&(!current||dirty[1]&/*$$scope*/16)){update_slot_base(identifier_slot,identifier_slot_template,ctx,/*$$scope*/ctx[35],!current?get_all_dirty_from_scope(/*$$scope*/ctx[35]):get_slot_changes(identifier_slot_template,/*$$scope*/ctx[35],dirty,get_identifier_slot_changes_2),get_identifier_slot_context_2);}}if(!/*root*/ctx[17]){if(if_block0);else{if_block0=create_if_block_26();if_block0.c();if_block0.m(div0,t1);}}else if(if_block0){if_block0.d(1);if_block0=null;}var jsonvalue_changes={};if(dirty[0]&/*path*/2)jsonvalue_changes.path=/*path*/ctx[1];if(dirty[0]&/*value*/1)jsonvalue_changes.value=/*value*/ctx[0];if(dirty[0]&/*enforceString*/8192)jsonvalue_changes.enforceString=/*enforceString*/ctx[13];if(dirty[0]&/*isSelected*/65536)jsonvalue_changes.isSelected=/*isSelected*/ctx[16];if(dirty[0]&/*isSelected, selection*/65664)jsonvalue_changes.selection=/*isSelected*/ctx[16]?/*selection*/ctx[7]:undefined;if(dirty[0]&/*searchResultItemsMap, pointer*/576)jsonvalue_changes.searchResultItems=filterValueSearchResults(/*searchResultItemsMap*/ctx[6],/*pointer*/ctx[9]);if(dirty[0]&/*context*/256)jsonvalue_changes.context=/*context*/ctx[8];jsonvalue.$set(jsonvalue_changes);if(dirty[0]&/*context, isSelected, selection, path*/65922)show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);if(show_if){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*context, isSelected, selection, path*/65922){transition_in(if_block1,1);}}else{if_block1=create_if_block_25(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div0,null);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(/*validationError*/ctx[15]){if(if_block2){if_block2.p(ctx,dirty);if(dirty[0]&/*validationError*/32768){transition_in(if_block2,1);}}else{if_block2=create_if_block_24(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(div1,t4);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,function(){if_block2=null;});check_outros();}if(!/*root*/ctx[17]){if(if_block3){if_block3.p(ctx,dirty);}else{if_block3=create_if_block_23(ctx);if_block3.c();if_block3.m(div1,null);}}else if(if_block3){if_block3.d(1);if_block3=null;}if(!current||dirty[0]&/*indentationStyle*/262144){attr(div1,"style",/*indentationStyle*/ctx[18]);}},i:function i(local){if(current)return;transition_in(identifier_slot,local);transition_in(jsonvalue.$$.fragment,local);transition_in(if_block1);transition_in(if_block2);current=true;},o:function o(local){transition_out(identifier_slot,local);transition_out(jsonvalue.$$.fragment,local);transition_out(if_block1);transition_out(if_block2);current=false;},d:function d(detaching){if(detaching)detach(div1);if(identifier_slot)identifier_slot.d(detaching);if(if_block0)if_block0.d();destroy_component(jsonvalue);if(if_block1)if_block1.d();if(if_block2)if_block2.d();if(if_block3)if_block3.d();}};}// (563:28) 
function create_if_block_12(ctx){var div3;var div2;var button;var current_block_type_index;var if_block0;var t0;var t1;var t2;var div1;var div0;var t3;var show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);var t4;var t5;var t6;var if_block6_anchor;var current;var mounted;var dispose;var if_block_creators=[create_if_block_22,create_else_block_4];var if_blocks=[];function select_block_type_4(ctx,dirty){if(/*expanded*/ctx[12])return 0;return 1;}current_block_type_index=select_block_type_4(ctx);if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);var identifier_slot_template=/*#slots*/ctx[34].identifier;var identifier_slot=create_slot(identifier_slot_template,ctx,/*$$scope*/ctx[35],get_identifier_slot_context_1);var if_block1=!/*root*/ctx[17]&&create_if_block_21();function select_block_type_5(ctx,dirty){if(/*expanded*/ctx[12])return create_if_block_20;return create_else_block_3;}var current_block_type=select_block_type_5(ctx);var if_block2=current_block_type(ctx);var if_block3=show_if&&create_if_block_19(ctx);var if_block4=/*validationError*/ctx[15]&&(!/*expanded*/ctx[12]||!/*validationError*/ctx[15].isChildError)&&create_if_block_18(ctx);function select_block_type_6(ctx,dirty){if(/*expanded*/ctx[12])return create_if_block_16;if(!/*root*/ctx[17])return create_if_block_17;}var current_block_type_1=select_block_type_6(ctx);var if_block5=current_block_type_1&&current_block_type_1(ctx);var if_block6=/*expanded*/ctx[12]&&create_if_block_13(ctx);return{c:function c(){div3=element("div");div2=element("div");button=element("button");if_block0.c();t0=space();if(identifier_slot)identifier_slot.c();t1=space();if(if_block1)if_block1.c();t2=space();div1=element("div");div0=element("div");if_block2.c();t3=space();if(if_block3)if_block3.c();t4=space();if(if_block4)if_block4.c();t5=space();if(if_block5)if_block5.c();t6=space();if(if_block6)if_block6.c();if_block6_anchor=empty$1();attr(button,"type","button");attr(button,"class","jse-expand svelte-uj4yd7");attr(button,"title","Expand or collapse this object (Ctrl+Click to expand/collapse recursively)");attr(div0,"class","jse-meta-inner svelte-uj4yd7");attr(div1,"class","jse-meta svelte-uj4yd7");attr(div1,"data-type","selectable-value");attr(div2,"class","jse-header svelte-uj4yd7");attr(div3,"class","jse-header-outer svelte-uj4yd7");attr(div3,"style",/*indentationStyle*/ctx[18]);},m:function m(target,anchor){insert$2(target,div3,anchor);append$1(div3,div2);append$1(div2,button);if_blocks[current_block_type_index].m(button,null);append$1(div2,t0);if(identifier_slot){identifier_slot.m(div2,null);}append$1(div2,t1);if(if_block1)if_block1.m(div2,null);append$1(div2,t2);append$1(div2,div1);append$1(div1,div0);if_block2.m(div0,null);append$1(div2,t3);if(if_block3)if_block3.m(div2,null);append$1(div3,t4);if(if_block4)if_block4.m(div3,null);append$1(div3,t5);if(if_block5)if_block5.m(div3,null);insert$2(target,t6,anchor);if(if_block6)if_block6.m(target,anchor);insert$2(target,if_block6_anchor,anchor);current=true;if(!mounted){dispose=listen(button,"click",/*toggleExpand*/ctx[21]);mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_4(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block0=if_blocks[current_block_type_index];if(!if_block0){if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block0.c();}else{if_block0.p(ctx,dirty);}transition_in(if_block0,1);if_block0.m(button,null);}if(identifier_slot){if(identifier_slot.p&&(!current||dirty[1]&/*$$scope*/16)){update_slot_base(identifier_slot,identifier_slot_template,ctx,/*$$scope*/ctx[35],!current?get_all_dirty_from_scope(/*$$scope*/ctx[35]):get_slot_changes(identifier_slot_template,/*$$scope*/ctx[35],dirty,get_identifier_slot_changes_1),get_identifier_slot_context_1);}}if(!/*root*/ctx[17]){if(if_block1);else{if_block1=create_if_block_21();if_block1.c();if_block1.m(div2,t2);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(current_block_type===(current_block_type=select_block_type_5(ctx))&&if_block2){if_block2.p(ctx,dirty);}else{if_block2.d(1);if_block2=current_block_type(ctx);if(if_block2){if_block2.c();if_block2.m(div0,null);}}if(dirty[0]&/*context, isSelected, selection, path*/65922)show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);if(show_if){if(if_block3){if_block3.p(ctx,dirty);if(dirty[0]&/*context, isSelected, selection, path*/65922){transition_in(if_block3,1);}}else{if_block3=create_if_block_19(ctx);if_block3.c();transition_in(if_block3,1);if_block3.m(div2,null);}}else if(if_block3){group_outros();transition_out(if_block3,1,1,function(){if_block3=null;});check_outros();}if(/*validationError*/ctx[15]&&(!/*expanded*/ctx[12]||!/*validationError*/ctx[15].isChildError)){if(if_block4){if_block4.p(ctx,dirty);if(dirty[0]&/*validationError, expanded*/36864){transition_in(if_block4,1);}}else{if_block4=create_if_block_18(ctx);if_block4.c();transition_in(if_block4,1);if_block4.m(div3,t5);}}else if(if_block4){group_outros();transition_out(if_block4,1,1,function(){if_block4=null;});check_outros();}if(current_block_type_1===(current_block_type_1=select_block_type_6(ctx))&&if_block5){if_block5.p(ctx,dirty);}else{if(if_block5)if_block5.d(1);if_block5=current_block_type_1&&current_block_type_1(ctx);if(if_block5){if_block5.c();if_block5.m(div3,null);}}if(!current||dirty[0]&/*indentationStyle*/262144){attr(div3,"style",/*indentationStyle*/ctx[18]);}if(/*expanded*/ctx[12]){if(if_block6){if_block6.p(ctx,dirty);if(dirty[0]&/*expanded*/4096){transition_in(if_block6,1);}}else{if_block6=create_if_block_13(ctx);if_block6.c();transition_in(if_block6,1);if_block6.m(if_block6_anchor.parentNode,if_block6_anchor);}}else if(if_block6){group_outros();transition_out(if_block6,1,1,function(){if_block6=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(identifier_slot,local);transition_in(if_block3);transition_in(if_block4);transition_in(if_block6);current=true;},o:function o(local){transition_out(if_block0);transition_out(identifier_slot,local);transition_out(if_block3);transition_out(if_block4);transition_out(if_block6);current=false;},d:function d(detaching){if(detaching)detach(div3);if_blocks[current_block_type_index].d();if(identifier_slot)identifier_slot.d(detaching);if(if_block1)if_block1.d();if_block2.d();if(if_block3)if_block3.d();if(if_block4)if_block4.d();if(if_block5){if_block5.d();}if(detaching)detach(t6);if(if_block6)if_block6.d(detaching);if(detaching)detach(if_block6_anchor);mounted=false;dispose();}};}// (441:2) {#if Array.isArray(value)}
function create_if_block_1$8(ctx){var div3;var div2;var button;var current_block_type_index;var if_block0;var t0;var t1;var t2;var div1;var div0;var t3;var show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);var t4;var t5;var t6;var if_block6_anchor;var current;var mounted;var dispose;var if_block_creators=[create_if_block_11,create_else_block_2$2];var if_blocks=[];function select_block_type_1(ctx,dirty){if(/*expanded*/ctx[12])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);var identifier_slot_template=/*#slots*/ctx[34].identifier;var identifier_slot=create_slot(identifier_slot_template,ctx,/*$$scope*/ctx[35],get_identifier_slot_context);var if_block1=!/*root*/ctx[17]&&create_if_block_10$1();function select_block_type_2(ctx,dirty){if(/*expanded*/ctx[12])return create_if_block_9$1;return create_else_block_1$3;}var current_block_type=select_block_type_2(ctx);var if_block2=current_block_type(ctx);var if_block3=show_if&&create_if_block_8$1(ctx);var if_block4=/*validationError*/ctx[15]&&(!/*expanded*/ctx[12]||!/*validationError*/ctx[15].isChildError)&&create_if_block_7$1(ctx);function select_block_type_3(ctx,dirty){if(/*expanded*/ctx[12])return create_if_block_6$2;return create_else_block$9;}var current_block_type_1=select_block_type_3(ctx);var if_block5=current_block_type_1(ctx);var if_block6=/*expanded*/ctx[12]&&create_if_block_2$5(ctx);return{c:function c(){div3=element("div");div2=element("div");button=element("button");if_block0.c();t0=space();if(identifier_slot)identifier_slot.c();t1=space();if(if_block1)if_block1.c();t2=space();div1=element("div");div0=element("div");if_block2.c();t3=space();if(if_block3)if_block3.c();t4=space();if(if_block4)if_block4.c();t5=space();if_block5.c();t6=space();if(if_block6)if_block6.c();if_block6_anchor=empty$1();attr(button,"type","button");attr(button,"class","jse-expand svelte-uj4yd7");attr(button,"title","Expand or collapse this array (Ctrl+Click to expand/collapse recursively)");attr(div0,"class","jse-meta-inner svelte-uj4yd7");attr(div0,"data-type","selectable-value");attr(div1,"class","jse-meta svelte-uj4yd7");attr(div2,"class","jse-header svelte-uj4yd7");attr(div3,"class","jse-header-outer svelte-uj4yd7");attr(div3,"style",/*indentationStyle*/ctx[18]);},m:function m(target,anchor){insert$2(target,div3,anchor);append$1(div3,div2);append$1(div2,button);if_blocks[current_block_type_index].m(button,null);append$1(div2,t0);if(identifier_slot){identifier_slot.m(div2,null);}append$1(div2,t1);if(if_block1)if_block1.m(div2,null);append$1(div2,t2);append$1(div2,div1);append$1(div1,div0);if_block2.m(div0,null);append$1(div2,t3);if(if_block3)if_block3.m(div2,null);append$1(div3,t4);if(if_block4)if_block4.m(div3,null);append$1(div3,t5);if_block5.m(div3,null);insert$2(target,t6,anchor);if(if_block6)if_block6.m(target,anchor);insert$2(target,if_block6_anchor,anchor);current=true;if(!mounted){dispose=listen(button,"click",/*toggleExpand*/ctx[21]);mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block0=if_blocks[current_block_type_index];if(!if_block0){if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block0.c();}else{if_block0.p(ctx,dirty);}transition_in(if_block0,1);if_block0.m(button,null);}if(identifier_slot){if(identifier_slot.p&&(!current||dirty[1]&/*$$scope*/16)){update_slot_base(identifier_slot,identifier_slot_template,ctx,/*$$scope*/ctx[35],!current?get_all_dirty_from_scope(/*$$scope*/ctx[35]):get_slot_changes(identifier_slot_template,/*$$scope*/ctx[35],dirty,get_identifier_slot_changes),get_identifier_slot_context);}}if(!/*root*/ctx[17]){if(if_block1);else{if_block1=create_if_block_10$1();if_block1.c();if_block1.m(div2,t2);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(current_block_type===(current_block_type=select_block_type_2(ctx))&&if_block2){if_block2.p(ctx,dirty);}else{if_block2.d(1);if_block2=current_block_type(ctx);if(if_block2){if_block2.c();if_block2.m(div0,null);}}if(dirty[0]&/*context, isSelected, selection, path*/65922)show_if=!/*context*/ctx[8].readOnly&&/*isSelected*/ctx[16]&&/*selection*/ctx[7]&&(isValueSelection(/*selection*/ctx[7])||isMultiSelection(/*selection*/ctx[7]))&&!/*selection*/ctx[7].edit&&isEqual$1(/*selection*/ctx[7].focusPath,/*path*/ctx[1]);if(show_if){if(if_block3){if_block3.p(ctx,dirty);if(dirty[0]&/*context, isSelected, selection, path*/65922){transition_in(if_block3,1);}}else{if_block3=create_if_block_8$1(ctx);if_block3.c();transition_in(if_block3,1);if_block3.m(div2,null);}}else if(if_block3){group_outros();transition_out(if_block3,1,1,function(){if_block3=null;});check_outros();}if(/*validationError*/ctx[15]&&(!/*expanded*/ctx[12]||!/*validationError*/ctx[15].isChildError)){if(if_block4){if_block4.p(ctx,dirty);if(dirty[0]&/*validationError, expanded*/36864){transition_in(if_block4,1);}}else{if_block4=create_if_block_7$1(ctx);if_block4.c();transition_in(if_block4,1);if_block4.m(div3,t5);}}else if(if_block4){group_outros();transition_out(if_block4,1,1,function(){if_block4=null;});check_outros();}if(current_block_type_1===(current_block_type_1=select_block_type_3(ctx))&&if_block5){if_block5.p(ctx,dirty);}else{if_block5.d(1);if_block5=current_block_type_1(ctx);if(if_block5){if_block5.c();if_block5.m(div3,null);}}if(!current||dirty[0]&/*indentationStyle*/262144){attr(div3,"style",/*indentationStyle*/ctx[18]);}if(/*expanded*/ctx[12]){if(if_block6){if_block6.p(ctx,dirty);if(dirty[0]&/*expanded*/4096){transition_in(if_block6,1);}}else{if_block6=create_if_block_2$5(ctx);if_block6.c();transition_in(if_block6,1);if_block6.m(if_block6_anchor.parentNode,if_block6_anchor);}}else if(if_block6){group_outros();transition_out(if_block6,1,1,function(){if_block6=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(identifier_slot,local);transition_in(if_block3);transition_in(if_block4);transition_in(if_block6);current=true;},o:function o(local){transition_out(if_block0);transition_out(identifier_slot,local);transition_out(if_block3);transition_out(if_block4);transition_out(if_block6);current=false;},d:function d(detaching){if(detaching)detach(div3);if_blocks[current_block_type_index].d();if(identifier_slot)identifier_slot.d(detaching);if(if_block1)if_block1.d();if_block2.d();if(if_block3)if_block3.d();if(if_block4)if_block4.d();if_block5.d();if(detaching)detach(t6);if(if_block6)if_block6.d(detaching);if(detaching)detach(if_block6_anchor);mounted=false;dispose();}};}// (680:8) {#if !root}
function create_if_block_26(ctx){var div;return{c:function c(){div=element("div");div.textContent=":";attr(div,"class","jse-separator svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);},d:function d(detaching){if(detaching)detach(div);}};}// (692:8) {#if !context.readOnly && isSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !selection.edit && isEqual(selection.focusPath, path)}
function create_if_block_25(ctx){var div;var contextmenubutton;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:true,onContextMenu:/*context*/ctx[8].onContextMenu}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-context-menu-button-anchor svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*context*/256)contextmenubutton_changes.onContextMenu=/*context*/ctx[8].onContextMenu;contextmenubutton.$set(contextmenubutton_changes);},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}// (698:6) {#if validationError}
function create_if_block_24(ctx){var validationerroricon;var current;validationerroricon=new ValidationErrorIcon$1({props:{validationError:/*validationError*/ctx[15],onExpand:/*handleExpand*/ctx[22]}});return{c:function c(){create_component(validationerroricon.$$.fragment);},m:function m(target,anchor){mount_component(validationerroricon,target,anchor);current=true;},p:function p(ctx,dirty){var validationerroricon_changes={};if(dirty[0]&/*validationError*/32768)validationerroricon_changes.validationError=/*validationError*/ctx[15];validationerroricon.$set(validationerroricon_changes);},i:function i(local){if(current)return;transition_in(validationerroricon.$$.fragment,local);current=true;},o:function o(local){transition_out(validationerroricon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(validationerroricon,detaching);}};}// (701:6) {#if !root}
function create_if_block_23(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertAfter*/ctx[30]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (574:10) {:else}
function create_else_block_4(ctx){var icon;var current;icon=new Icon({props:{data:faCaretRight}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (572:10) {#if expanded}
function create_if_block_22(ctx){var icon;var current;icon=new Icon({props:{data:faCaretDown}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (579:8) {#if !root}
function create_if_block_21(ctx){var div;return{c:function c(){div=element("div");div.textContent=":";attr(div,"class","jse-separator svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);},d:function d(detaching){if(detaching)detach(div);}};}// (586:12) {:else}
function create_else_block_3(ctx){var div0;var t1;var button;var t2_value=Object.keys(/*value*/ctx[0]).length+"";var t2;var t3;var t4_value=(Object.keys(/*value*/ctx[0]).length===1?'prop':'props')+"";var t4;var t5;var div1;var mounted;var dispose;return{c:function c(){div0=element("div");div0.textContent="{";t1=space();button=element("button");t2=text(t2_value);t3=space();t4=text(t4_value);t5=space();div1=element("div");div1.textContent="}";attr(div0,"class","jse-bracket svelte-uj4yd7");attr(button,"type","button");attr(button,"class","jse-tag svelte-uj4yd7");attr(div1,"class","jse-bracket svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div0,anchor);insert$2(target,t1,anchor);insert$2(target,button,anchor);append$1(button,t2);append$1(button,t3);append$1(button,t4);insert$2(target,t5,anchor);insert$2(target,div1,anchor);if(!mounted){dispose=listen(button,"click",/*handleExpand*/ctx[22]);mounted=true;}},p:function p(ctx,dirty){if(dirty[0]&/*value*/1&&t2_value!==(t2_value=Object.keys(/*value*/ctx[0]).length+""))set_data(t2,t2_value);if(dirty[0]&/*value*/1&&t4_value!==(t4_value=(Object.keys(/*value*/ctx[0]).length===1?'prop':'props')+""))set_data(t4,t4_value);},d:function d(detaching){if(detaching)detach(div0);if(detaching)detach(t1);if(detaching)detach(button);if(detaching)detach(t5);if(detaching)detach(div1);mounted=false;dispose();}};}// (584:12) {#if expanded}
function create_if_block_20(ctx){var div;return{c:function c(){div=element("div");div.textContent="{";attr(div,"class","jse-bracket jse-expanded svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);},p:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (596:8) {#if !context.readOnly && isSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !selection.edit && isEqual(selection.focusPath, path)}
function create_if_block_19(ctx){var div;var contextmenubutton;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:true,onContextMenu:/*context*/ctx[8].onContextMenu}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-context-menu-button-anchor svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*context*/256)contextmenubutton_changes.onContextMenu=/*context*/ctx[8].onContextMenu;contextmenubutton.$set(contextmenubutton_changes);},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}// (602:6) {#if validationError && (!expanded || !validationError.isChildError)}
function create_if_block_18(ctx){var validationerroricon;var current;validationerroricon=new ValidationErrorIcon$1({props:{validationError:/*validationError*/ctx[15],onExpand:/*handleExpand*/ctx[22]}});return{c:function c(){create_component(validationerroricon.$$.fragment);},m:function m(target,anchor){mount_component(validationerroricon,target,anchor);current=true;},p:function p(ctx,dirty){var validationerroricon_changes={};if(dirty[0]&/*validationError*/32768)validationerroricon_changes.validationError=/*validationError*/ctx[15];validationerroricon.$set(validationerroricon_changes);},i:function i(local){if(current)return;transition_in(validationerroricon.$$.fragment,local);current=true;},o:function o(local){transition_out(validationerroricon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(validationerroricon,detaching);}};}// (611:22) 
function create_if_block_17(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertAfter*/ctx[30]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (605:6) {#if expanded}
function create_if_block_16(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-inside svelte-uj4yd7");attr(div,"data-type","insert-selection-area-inside");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertInside*/ctx[29]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (619:4) {#if expanded}
function create_if_block_13(ctx){var div0;var show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_INSIDE||/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));var t0;var t1;var div3;var div2;var t3;var current;var if_block0=show_if&&create_if_block_15(ctx);var each_value_2=/*getProps*/ctx[19](/*path*/ctx[1],/*value*/ctx[0],/*expandedMap*/ctx[2],/*enforceStringMap*/ctx[3],/*visibleSectionsMap*/ctx[4],/*validationErrorsMap*/ctx[5],/*searchResultItemsMap*/ctx[6],/*selection*/ctx[7],/*dragging*/ctx[11]);var each_blocks=[];for(var _i261=0;_i261<each_value_2.length;_i261+=1){each_blocks[_i261]=create_each_block_2(get_each_context_2(ctx,each_value_2,_i261));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};var if_block1=!/*root*/ctx[17]&&create_if_block_14(ctx);return{c:function c(){div0=element("div");if(if_block0)if_block0.c();t0=space();for(var _i262=0;_i262<each_blocks.length;_i262+=1){each_blocks[_i262].c();}t1=space();div3=element("div");div2=element("div");div2.innerHTML="<div class=\"jse-bracket svelte-uj4yd7\">}</div>";t3=space();if(if_block1)if_block1.c();attr(div0,"class","jse-props svelte-uj4yd7");attr(div2,"data-type","selectable-value");attr(div2,"class","jse-footer svelte-uj4yd7");attr(div3,"class","jse-footer-outer svelte-uj4yd7");attr(div3,"style",/*indentationStyle*/ctx[18]);},m:function m(target,anchor){insert$2(target,div0,anchor);if(if_block0)if_block0.m(div0,null);append$1(div0,t0);for(var _i263=0;_i263<each_blocks.length;_i263+=1){each_blocks[_i263].m(div0,null);}insert$2(target,t1,anchor);insert$2(target,div3,anchor);append$1(div3,div2);append$1(div3,t3);if(if_block1)if_block1.m(div3,null);current=true;},p:function p(ctx,dirty){if(dirty[0]&/*context, hover, isSelected, selection*/66944)show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_INSIDE||/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));if(show_if){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*context, hover, isSelected, selection*/66944){transition_in(if_block0,1);}}else{if_block0=create_if_block_15(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div0,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(dirty[0]&/*getProps, path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging, context, handleDragSelectionStart, handleUpdateKey*/76024319){each_value_2=/*getProps*/ctx[19](/*path*/ctx[1],/*value*/ctx[0],/*expandedMap*/ctx[2],/*enforceStringMap*/ctx[3],/*visibleSectionsMap*/ctx[4],/*validationErrorsMap*/ctx[5],/*searchResultItemsMap*/ctx[6],/*selection*/ctx[7],/*dragging*/ctx[11]);var _i264;for(_i264=0;_i264<each_value_2.length;_i264+=1){var child_ctx=get_each_context_2(ctx,each_value_2,_i264);if(each_blocks[_i264]){each_blocks[_i264].p(child_ctx,dirty);transition_in(each_blocks[_i264],1);}else{each_blocks[_i264]=create_each_block_2(child_ctx);each_blocks[_i264].c();transition_in(each_blocks[_i264],1);each_blocks[_i264].m(div0,null);}}group_outros();for(_i264=each_value_2.length;_i264<each_blocks.length;_i264+=1){out(_i264);}check_outros();}if(!/*root*/ctx[17]){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_14(ctx);if_block1.c();if_block1.m(div3,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty[0]&/*indentationStyle*/262144){attr(div3,"style",/*indentationStyle*/ctx[18]);}},i:function i(local){if(current)return;transition_in(if_block0);for(var _i265=0;_i265<each_value_2.length;_i265+=1){transition_in(each_blocks[_i265]);}current=true;},o:function o(local){transition_out(if_block0);each_blocks=each_blocks.filter(Boolean);for(var _i266=0;_i266<each_blocks.length;_i266+=1){transition_out(each_blocks[_i266]);}current=false;},d:function d(detaching){if(detaching)detach(div0);if(if_block0)if_block0.d();destroy_each(each_blocks,detaching);if(detaching)detach(t1);if(detaching)detach(div3);if(if_block1)if_block1.d();}};}// (621:8) {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isSelected && isInsideSelection(selection)))}
function create_if_block_15(ctx){var div;var contextmenubutton;var div_style_value;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]),onContextMenu:/*handleInsertInsideOpenContextMenu*/ctx[31]}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-insert-area jse-inside svelte-uj4yd7");attr(div,"data-type","insert-selection-area-inside");attr(div,"style",div_style_value=getIndentationStyle(/*path*/ctx[1].length+1));attr(div,"title",INSERT_EXPLANATION);toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_INSIDE);toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*isSelected, selection*/65664)contextmenubutton_changes.selected=/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]);contextmenubutton.$set(contextmenubutton_changes);if(!current||dirty[0]&/*path*/2&&div_style_value!==(div_style_value=getIndentationStyle(/*path*/ctx[1].length+1))){attr(div,"style",div_style_value);}if(!current||dirty[0]&/*hover*/1024){toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_INSIDE);}if(!current||dirty[0]&/*isSelected, selection*/65664){toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));}},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}// (649:12) 
function create_identifier_slot_1(ctx){var div;var jsonkey;var t;var current;jsonkey=new JSONKey$1({props:{path:/*prop*/ctx[53].path,pointer:/*prop*/ctx[53].pointer,key:/*prop*/ctx[53].key,selection:/*prop*/ctx[53].selection,searchResultItems:/*prop*/ctx[53].keySearchResultItemsMap,context:/*context*/ctx[8],onUpdateKey:/*handleUpdateKey*/ctx[23]}});return{c:function c(){div=element("div");create_component(jsonkey.$$.fragment);t=space();attr(div,"slot","identifier");attr(div,"class","jse-identifier svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(jsonkey,div,null);append$1(div,t);current=true;},p:function p(ctx,dirty){var jsonkey_changes={};if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonkey_changes.path=/*prop*/ctx[53].path;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonkey_changes.pointer=/*prop*/ctx[53].pointer;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonkey_changes.key=/*prop*/ctx[53].key;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonkey_changes.selection=/*prop*/ctx[53].selection;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonkey_changes.searchResultItems=/*prop*/ctx[53].keySearchResultItemsMap;if(dirty[0]&/*context*/256)jsonkey_changes.context=/*context*/ctx[8];jsonkey.$set(jsonkey_changes);},i:function i(local){if(current)return;transition_in(jsonkey.$$.fragment,local);current=true;},o:function o(local){transition_out(jsonkey.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(jsonkey);}};}// (636:8) {#each getProps(path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging) as prop}
function create_each_block_2(ctx){var jsonnode;var current;jsonnode=new JSONNode({props:{value:/*prop*/ctx[53].value,path:/*prop*/ctx[53].path,expandedMap:/*prop*/ctx[53].expandedMap,enforceStringMap:/*prop*/ctx[53].enforceStringMap,visibleSectionsMap:/*prop*/ctx[53].visibleSectionsMap,validationErrorsMap:/*prop*/ctx[53].validationErrorsMap,searchResultItemsMap:/*prop*/ctx[53].valueSearchResultItemsMap,selection:/*prop*/ctx[53].selection,context:/*context*/ctx[8],onDragSelectionStart:/*handleDragSelectionStart*/ctx[26],$$slots:{identifier:[create_identifier_slot_1]},$$scope:{ctx:ctx}}});return{c:function c(){create_component(jsonnode.$$.fragment);},m:function m(target,anchor){mount_component(jsonnode,target,anchor);current=true;},p:function p(ctx,dirty){var jsonnode_changes={};if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.value=/*prop*/ctx[53].value;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.path=/*prop*/ctx[53].path;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.expandedMap=/*prop*/ctx[53].expandedMap;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.enforceStringMap=/*prop*/ctx[53].enforceStringMap;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.visibleSectionsMap=/*prop*/ctx[53].visibleSectionsMap;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.validationErrorsMap=/*prop*/ctx[53].validationErrorsMap;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.searchResultItemsMap=/*prop*/ctx[53].valueSearchResultItemsMap;if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/2303)jsonnode_changes.selection=/*prop*/ctx[53].selection;if(dirty[0]&/*context*/256)jsonnode_changes.context=/*context*/ctx[8];if(dirty[0]&/*path, value, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging, context*/2559|dirty[1]&/*$$scope*/16){jsonnode_changes.$$scope={dirty:dirty,ctx:ctx};}jsonnode.$set(jsonnode_changes);},i:function i(local){if(current)return;transition_in(jsonnode.$$.fragment,local);current=true;},o:function o(local){transition_out(jsonnode.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(jsonnode,detaching);}};}// (667:8) {#if !root}
function create_if_block_14(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertAfter*/ctx[30]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (452:10) {:else}
function create_else_block_2$2(ctx){var icon;var current;icon=new Icon({props:{data:faCaretRight}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (450:10) {#if expanded}
function create_if_block_11(ctx){var icon;var current;icon=new Icon({props:{data:faCaretDown}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (457:8) {#if !root}
function create_if_block_10$1(ctx){var div;return{c:function c(){div=element("div");div.textContent=":";attr(div,"class","jse-separator svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);},d:function d(detaching){if(detaching)detach(div);}};}// (468:12) {:else}
function create_else_block_1$3(ctx){var div0;var t1;var button;var t2_value=/*value*/ctx[0].length+"";var t2;var t3;var t4_value=(/*value*/ctx[0].length===1?'item':'items')+"";var t4;var t5;var div1;var mounted;var dispose;return{c:function c(){div0=element("div");div0.textContent="[";t1=space();button=element("button");t2=text(t2_value);t3=space();t4=text(t4_value);t5=space();div1=element("div");div1.textContent="]";attr(div0,"class","jse-bracket svelte-uj4yd7");attr(button,"type","button");attr(button,"class","jse-tag svelte-uj4yd7");attr(div1,"class","jse-bracket svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div0,anchor);insert$2(target,t1,anchor);insert$2(target,button,anchor);append$1(button,t2);append$1(button,t3);append$1(button,t4);insert$2(target,t5,anchor);insert$2(target,div1,anchor);if(!mounted){dispose=listen(button,"click",/*handleExpand*/ctx[22]);mounted=true;}},p:function p(ctx,dirty){if(dirty[0]&/*value*/1&&t2_value!==(t2_value=/*value*/ctx[0].length+""))set_data(t2,t2_value);if(dirty[0]&/*value*/1&&t4_value!==(t4_value=(/*value*/ctx[0].length===1?'item':'items')+""))set_data(t4,t4_value);},d:function d(detaching){if(detaching)detach(div0);if(detaching)detach(t1);if(detaching)detach(button);if(detaching)detach(t5);if(detaching)detach(div1);mounted=false;dispose();}};}// (462:12) {#if expanded}
function create_if_block_9$1(ctx){var div;var t1;var span;var t2_value=/*value*/ctx[0].length+"";var t2;var t3;var t4_value=(/*value*/ctx[0].length===1?'item':'items')+"";var t4;return{c:function c(){div=element("div");div.textContent="[";t1=space();span=element("span");t2=text(t2_value);t3=space();t4=text(t4_value);attr(div,"class","jse-bracket svelte-uj4yd7");attr(span,"class","jse-tag jse-expanded svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);insert$2(target,t1,anchor);insert$2(target,span,anchor);append$1(span,t2);append$1(span,t3);append$1(span,t4);},p:function p(ctx,dirty){if(dirty[0]&/*value*/1&&t2_value!==(t2_value=/*value*/ctx[0].length+""))set_data(t2,t2_value);if(dirty[0]&/*value*/1&&t4_value!==(t4_value=(/*value*/ctx[0].length===1?'item':'items')+""))set_data(t4,t4_value);},d:function d(detaching){if(detaching)detach(div);if(detaching)detach(t1);if(detaching)detach(span);}};}// (478:8) {#if !context.readOnly && isSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !selection.edit && isEqual(selection.focusPath, path)}
function create_if_block_8$1(ctx){var div;var contextmenubutton;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:true,onContextMenu:/*context*/ctx[8].onContextMenu}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-context-menu-button-anchor svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*context*/256)contextmenubutton_changes.onContextMenu=/*context*/ctx[8].onContextMenu;contextmenubutton.$set(contextmenubutton_changes);},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}// (484:6) {#if validationError && (!expanded || !validationError.isChildError)}
function create_if_block_7$1(ctx){var validationerroricon;var current;validationerroricon=new ValidationErrorIcon$1({props:{validationError:/*validationError*/ctx[15],onExpand:/*handleExpand*/ctx[22]}});return{c:function c(){create_component(validationerroricon.$$.fragment);},m:function m(target,anchor){mount_component(validationerroricon,target,anchor);current=true;},p:function p(ctx,dirty){var validationerroricon_changes={};if(dirty[0]&/*validationError*/32768)validationerroricon_changes.validationError=/*validationError*/ctx[15];validationerroricon.$set(validationerroricon_changes);},i:function i(local){if(current)return;transition_in(validationerroricon.$$.fragment,local);current=true;},o:function o(local){transition_out(validationerroricon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(validationerroricon,detaching);}};}// (493:6) {:else}
function create_else_block$9(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertAfter*/ctx[30]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (487:6) {#if expanded}
function create_if_block_6$2(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-inside svelte-uj4yd7");attr(div,"data-type","insert-selection-area-inside");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertInside*/ctx[29]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (501:4) {#if expanded}
function create_if_block_2$5(ctx){var div0;var show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_INSIDE||/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));var t0;var each_blocks=[];var each_1_lookup=new Map();var t1;var div2;var div1;var t3;var current;var if_block0=show_if&&create_if_block_5$2(ctx);var each_value=/*visibleSections*/ctx[14]||DEFAULT_VISIBLE_SECTIONS;var get_key=function get_key(ctx){return(/*sectionIndex*/ctx[49]);};for(var _i267=0;_i267<each_value.length;_i267+=1){var child_ctx=get_each_context$8(ctx,each_value,_i267);var key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[_i267]=create_each_block$8(key,child_ctx));}var if_block1=!/*root*/ctx[17]&&create_if_block_3$4(ctx);return{c:function c(){div0=element("div");if(if_block0)if_block0.c();t0=space();for(var _i268=0;_i268<each_blocks.length;_i268+=1){each_blocks[_i268].c();}t1=space();div2=element("div");div1=element("div");div1.innerHTML="<span class=\"jse-bracket svelte-uj4yd7\">]</span>";t3=space();if(if_block1)if_block1.c();attr(div0,"class","jse-items svelte-uj4yd7");attr(div1,"data-type","selectable-value");attr(div1,"class","jse-footer svelte-uj4yd7");attr(div2,"class","jse-footer-outer svelte-uj4yd7");attr(div2,"style",/*indentationStyle*/ctx[18]);},m:function m(target,anchor){insert$2(target,div0,anchor);if(if_block0)if_block0.m(div0,null);append$1(div0,t0);for(var _i269=0;_i269<each_blocks.length;_i269+=1){each_blocks[_i269].m(div0,null);}insert$2(target,t1,anchor);insert$2(target,div2,anchor);append$1(div2,div1);append$1(div2,t3);if(if_block1)if_block1.m(div2,null);current=true;},p:function p(ctx,dirty){if(dirty[0]&/*context, hover, isSelected, selection*/66944)show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_INSIDE||/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));if(show_if){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*context, hover, isSelected, selection*/66944){transition_in(if_block0,1);}}else{if_block0=create_if_block_5$2(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div0,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(dirty[0]&/*visibleSections, value, path, pointer, context, selection, getItems, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, dragging, handleDragSelectionStart*/68176895){each_value=/*visibleSections*/ctx[14]||DEFAULT_VISIBLE_SECTIONS;group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,div0,outro_and_destroy_block,create_each_block$8,null,get_each_context$8);check_outros();}if(!/*root*/ctx[17]){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_3$4(ctx);if_block1.c();if_block1.m(div2,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty[0]&/*indentationStyle*/262144){attr(div2,"style",/*indentationStyle*/ctx[18]);}},i:function i(local){if(current)return;transition_in(if_block0);for(var _i270=0;_i270<each_value.length;_i270+=1){transition_in(each_blocks[_i270]);}current=true;},o:function o(local){transition_out(if_block0);for(var _i271=0;_i271<each_blocks.length;_i271+=1){transition_out(each_blocks[_i271]);}current=false;},d:function d(detaching){if(detaching)detach(div0);if(if_block0)if_block0.d();for(var _i272=0;_i272<each_blocks.length;_i272+=1){each_blocks[_i272].d();}if(detaching)detach(t1);if(detaching)detach(div2);if(if_block1)if_block1.d();}};}// (503:8) {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isSelected && isInsideSelection(selection)))}
function create_if_block_5$2(ctx){var div;var contextmenubutton;var div_style_value;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]),onContextMenu:/*handleInsertInsideOpenContextMenu*/ctx[31]}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-insert-area jse-inside svelte-uj4yd7");attr(div,"data-type","insert-selection-area-inside");attr(div,"style",div_style_value=getIndentationStyle(/*path*/ctx[1].length+1));attr(div,"title",INSERT_EXPLANATION);toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_INSIDE);toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*isSelected, selection*/65664)contextmenubutton_changes.selected=/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]);contextmenubutton.$set(contextmenubutton_changes);if(!current||dirty[0]&/*path*/2&&div_style_value!==(div_style_value=getIndentationStyle(/*path*/ctx[1].length+1))){attr(div,"style",div_style_value);}if(!current||dirty[0]&/*hover*/1024){toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_INSIDE);}if(!current||dirty[0]&/*isSelected, selection*/65664){toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isInsideSelection(/*selection*/ctx[7]));}},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}// (532:14) 
function create_identifier_slot(ctx){var div1;var div0;var t_value=/*item*/ctx[50].index+"";var t;return{c:function c(){div1=element("div");div0=element("div");t=text(t_value);attr(div0,"class","jse-index svelte-uj4yd7");attr(div1,"slot","identifier");attr(div1,"class","jse-identifier svelte-uj4yd7");},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);append$1(div0,t);},p:function p(ctx,dirty){if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687&&t_value!==(t_value=/*item*/ctx[50].index+""))set_data(t,t_value);},d:function d(detaching){if(detaching)detach(div1);}};}// (519:10) {#each getItems(path, value, visibleSection, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging) as item (item.index)}
function create_each_block_1(key_1,ctx){var first;var jsonnode;var current;jsonnode=new JSONNode({props:{value:/*item*/ctx[50].value,path:/*item*/ctx[50].path,expandedMap:/*item*/ctx[50].expandedMap,enforceStringMap:/*item*/ctx[50].enforceStringMap,visibleSectionsMap:/*item*/ctx[50].visibleSectionsMap,validationErrorsMap:/*item*/ctx[50].validationErrorsMap,searchResultItemsMap:/*item*/ctx[50].searchResultItemsMap,selection:/*item*/ctx[50].selection,context:/*context*/ctx[8],onDragSelectionStart:/*handleDragSelectionStart*/ctx[26],$$slots:{identifier:[create_identifier_slot]},$$scope:{ctx:ctx}}});return{key:key_1,first:null,c:function c(){first=empty$1();create_component(jsonnode.$$.fragment);this.first=first;},m:function m(target,anchor){insert$2(target,first,anchor);mount_component(jsonnode,target,anchor);current=true;},p:function p(new_ctx,dirty){ctx=new_ctx;var jsonnode_changes={};if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.value=/*item*/ctx[50].value;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.path=/*item*/ctx[50].path;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.expandedMap=/*item*/ctx[50].expandedMap;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.enforceStringMap=/*item*/ctx[50].enforceStringMap;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.visibleSectionsMap=/*item*/ctx[50].visibleSectionsMap;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.validationErrorsMap=/*item*/ctx[50].validationErrorsMap;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.searchResultItemsMap=/*item*/ctx[50].searchResultItemsMap;if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687)jsonnode_changes.selection=/*item*/ctx[50].selection;if(dirty[0]&/*context*/256)jsonnode_changes.context=/*context*/ctx[8];if(dirty[0]&/*path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging*/18687|dirty[1]&/*$$scope*/16){jsonnode_changes.$$scope={dirty:dirty,ctx:ctx};}jsonnode.$set(jsonnode_changes);},i:function i(local){if(current)return;transition_in(jsonnode.$$.fragment,local);current=true;},o:function o(local){transition_out(jsonnode.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(first);destroy_component(jsonnode,detaching);}};}// (537:10) {#if visibleSection.end < value.length}
function create_if_block_4$2(ctx){var collapseditems;var current;collapseditems=new CollapsedItems$1({props:{visibleSections:/*visibleSections*/ctx[14]||DEFAULT_VISIBLE_SECTIONS,sectionIndex:/*sectionIndex*/ctx[49],total:/*value*/ctx[0].length,path:/*path*/ctx[1],pointer:/*pointer*/ctx[9],onExpandSection:/*context*/ctx[8].onExpandSection,selection:/*selection*/ctx[7]}});return{c:function c(){create_component(collapseditems.$$.fragment);},m:function m(target,anchor){mount_component(collapseditems,target,anchor);current=true;},p:function p(ctx,dirty){var collapseditems_changes={};if(dirty[0]&/*visibleSections*/16384)collapseditems_changes.visibleSections=/*visibleSections*/ctx[14]||DEFAULT_VISIBLE_SECTIONS;if(dirty[0]&/*visibleSections*/16384)collapseditems_changes.sectionIndex=/*sectionIndex*/ctx[49];if(dirty[0]&/*value*/1)collapseditems_changes.total=/*value*/ctx[0].length;if(dirty[0]&/*path*/2)collapseditems_changes.path=/*path*/ctx[1];if(dirty[0]&/*pointer*/512)collapseditems_changes.pointer=/*pointer*/ctx[9];if(dirty[0]&/*context*/256)collapseditems_changes.onExpandSection=/*context*/ctx[8].onExpandSection;if(dirty[0]&/*selection*/128)collapseditems_changes.selection=/*selection*/ctx[7];collapseditems.$set(collapseditems_changes);},i:function i(local){if(current)return;transition_in(collapseditems.$$.fragment,local);current=true;},o:function o(local){transition_out(collapseditems.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(collapseditems,detaching);}};}// (518:8) {#each visibleSections || DEFAULT_VISIBLE_SECTIONS as visibleSection, sectionIndex (sectionIndex)}
function create_each_block$8(key_1,ctx){var first;var each_blocks=[];var each_1_lookup=new Map();var t;var if_block_anchor;var current;var each_value_1=/*getItems*/ctx[20](/*path*/ctx[1],/*value*/ctx[0],/*visibleSection*/ctx[47],/*expandedMap*/ctx[2],/*enforceStringMap*/ctx[3],/*visibleSectionsMap*/ctx[4],/*validationErrorsMap*/ctx[5],/*searchResultItemsMap*/ctx[6],/*selection*/ctx[7],/*dragging*/ctx[11]);var get_key=function get_key(ctx){return(/*item*/ctx[50].index);};for(var _i273=0;_i273<each_value_1.length;_i273+=1){var child_ctx=get_each_context_1(ctx,each_value_1,_i273);var key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[_i273]=create_each_block_1(key,child_ctx));}var if_block=/*visibleSection*/ctx[47].end</*value*/ctx[0].length&&create_if_block_4$2(ctx);return{key:key_1,first:null,c:function c(){first=empty$1();for(var _i274=0;_i274<each_blocks.length;_i274+=1){each_blocks[_i274].c();}t=space();if(if_block)if_block.c();if_block_anchor=empty$1();this.first=first;},m:function m(target,anchor){insert$2(target,first,anchor);for(var _i275=0;_i275<each_blocks.length;_i275+=1){each_blocks[_i275].m(target,anchor);}insert$2(target,t,anchor);if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(new_ctx,dirty){ctx=new_ctx;if(dirty[0]&/*getItems, path, value, visibleSections, expandedMap, enforceStringMap, visibleSectionsMap, validationErrorsMap, searchResultItemsMap, selection, dragging, context, handleDragSelectionStart*/68176383){each_value_1=/*getItems*/ctx[20](/*path*/ctx[1],/*value*/ctx[0],/*visibleSection*/ctx[47],/*expandedMap*/ctx[2],/*enforceStringMap*/ctx[3],/*visibleSectionsMap*/ctx[4],/*validationErrorsMap*/ctx[5],/*searchResultItemsMap*/ctx[6],/*selection*/ctx[7],/*dragging*/ctx[11]);group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value_1,each_1_lookup,t.parentNode,outro_and_destroy_block,create_each_block_1,t,get_each_context_1);check_outros();}if(/*visibleSection*/ctx[47].end</*value*/ctx[0].length){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*visibleSections, value*/16385){transition_in(if_block,1);}}else{if_block=create_if_block_4$2(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;for(var _i276=0;_i276<each_value_1.length;_i276+=1){transition_in(each_blocks[_i276]);}transition_in(if_block);current=true;},o:function o(local){for(var _i277=0;_i277<each_blocks.length;_i277+=1){transition_out(each_blocks[_i277]);}transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(first);for(var _i278=0;_i278<each_blocks.length;_i278+=1){each_blocks[_i278].d(detaching);}if(detaching)detach(t);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (554:8) {#if !root}
function create_if_block_3$4(ctx){var div;var mounted;var dispose;return{c:function c(){div=element("div");attr(div,"class","jse-insert-selection-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",/*handleInsertAfter*/ctx[30]);mounted=true;}},p:noop$2,d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (710:2) {#if !context.readOnly && (hover === HOVER_INSERT_AFTER || (isSelected && isAfterSelection(selection)))}
function create_if_block$g(ctx){var div;var contextmenubutton;var current;contextmenubutton=new ContextMenuButton$1({props:{selected:/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]),onContextMenu:/*handleInsertAfterOpenContextMenu*/ctx[32]}});return{c:function c(){div=element("div");create_component(contextmenubutton.$$.fragment);attr(div,"class","jse-insert-area jse-after svelte-uj4yd7");attr(div,"data-type","insert-selection-area-after");attr(div,"style",/*indentationStyle*/ctx[18]);attr(div,"title",INSERT_EXPLANATION);toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_AFTER);toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]));},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(contextmenubutton,div,null);current=true;},p:function p(ctx,dirty){var contextmenubutton_changes={};if(dirty[0]&/*isSelected, selection*/65664)contextmenubutton_changes.selected=/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]);contextmenubutton.$set(contextmenubutton_changes);if(!current||dirty[0]&/*indentationStyle*/262144){attr(div,"style",/*indentationStyle*/ctx[18]);}if(!current||dirty[0]&/*hover*/1024){toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_INSERT_AFTER);}if(!current||dirty[0]&/*isSelected, selection*/65664){toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]));}},i:function i(local){if(current)return;transition_in(contextmenubutton.$$.fragment,local);current=true;},o:function o(local){transition_out(contextmenubutton.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(contextmenubutton);}};}function create_fragment$s(ctx){var div;var show_if_1;var show_if_2;var current_block_type_index;var if_block0;var t;var show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_AFTER||/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]));var div_class_value;var div_data_path_value;var current;var mounted;var dispose;var if_block_creators=[create_if_block_1$8,create_if_block_12,create_else_block_5];var if_blocks=[];function select_block_type(ctx,dirty){if(dirty[0]&/*value*/1)show_if_1=null;if(dirty[0]&/*value*/1)show_if_2=null;if(show_if_1==null)show_if_1=!!Array.isArray(/*value*/ctx[0]);if(show_if_1)return 0;if(show_if_2==null)show_if_2=!!isObject$1(/*value*/ctx[0]);if(show_if_2)return 1;return 2;}current_block_type_index=select_block_type(ctx,[-1,-1]);if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);var if_block1=show_if&&create_if_block$g(ctx);return{c:function c(){div=element("div");if_block0.c();t=space();if(if_block1)if_block1.c();attr(div,"class",div_class_value=""+(null_to_empty(classnames('jse-json-node',{'jse-expanded':/*expanded*/ctx[12]},/*context*/ctx[8].onClassName(/*path*/ctx[1],/*value*/ctx[0])))+" svelte-uj4yd7"));attr(div,"data-path",div_data_path_value=encodeDataPath(/*path*/ctx[1]));toggle_class(div,"jse-root",/*root*/ctx[17]);toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isMultiSelection(/*selection*/ctx[7]));toggle_class(div,"jse-selected-key",/*isSelected*/ctx[16]&&isKeySelection(/*selection*/ctx[7]));toggle_class(div,"jse-selected-value",/*isSelected*/ctx[16]&&isValueSelection(/*selection*/ctx[7]));toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_COLLECTION);},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);append$1(div,t);if(if_block1)if_block1.m(div,null);current=true;if(!mounted){dispose=[listen(div,"mousedown",/*handleMouseDown*/ctx[24]),listen(div,"mousemove",/*handleMouseMove*/ctx[25]),listen(div,"mouseover",/*handleMouseOver*/ctx[27]),listen(div,"mouseout",/*handleMouseOut*/ctx[28]),listen(div,"focus",undefined),listen(div,"blur",undefined)];mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx,dirty);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block0=if_blocks[current_block_type_index];if(!if_block0){if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block0.c();}else{if_block0.p(ctx,dirty);}transition_in(if_block0,1);if_block0.m(div,t);}if(dirty[0]&/*context, hover, isSelected, selection*/66944)show_if=!/*context*/ctx[8].readOnly&&(/*hover*/ctx[10]===HOVER_INSERT_AFTER||/*isSelected*/ctx[16]&&isAfterSelection(/*selection*/ctx[7]));if(show_if){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*context, hover, isSelected, selection*/66944){transition_in(if_block1,1);}}else{if_block1=create_if_block$g(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div,null);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(!current||dirty[0]&/*expanded, context, path, value*/4355&&div_class_value!==(div_class_value=""+(null_to_empty(classnames('jse-json-node',{'jse-expanded':/*expanded*/ctx[12]},/*context*/ctx[8].onClassName(/*path*/ctx[1],/*value*/ctx[0])))+" svelte-uj4yd7"))){attr(div,"class",div_class_value);}if(!current||dirty[0]&/*path*/2&&div_data_path_value!==(div_data_path_value=encodeDataPath(/*path*/ctx[1]))){attr(div,"data-path",div_data_path_value);}if(!current||dirty[0]&/*expanded, context, path, value, root*/135427){toggle_class(div,"jse-root",/*root*/ctx[17]);}if(!current||dirty[0]&/*expanded, context, path, value, isSelected, selection*/70019){toggle_class(div,"jse-selected",/*isSelected*/ctx[16]&&isMultiSelection(/*selection*/ctx[7]));}if(!current||dirty[0]&/*expanded, context, path, value, isSelected, selection*/70019){toggle_class(div,"jse-selected-key",/*isSelected*/ctx[16]&&isKeySelection(/*selection*/ctx[7]));}if(!current||dirty[0]&/*expanded, context, path, value, isSelected, selection*/70019){toggle_class(div,"jse-selected-value",/*isSelected*/ctx[16]&&isValueSelection(/*selection*/ctx[7]));}if(!current||dirty[0]&/*expanded, context, path, value, hover*/5379){toggle_class(div,"jse-hovered",/*hover*/ctx[10]===HOVER_COLLECTION);}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();if(if_block1)if_block1.d();mounted=false;run_all(dispose);}};}function getIndentationStyle(level){return"margin-left: calc(".concat(level," * var(--jse-indent-size))");}function instance$s($$self,$$props,$$invalidate){var root;var indentationStyle;var _$$props$$$slots7=$$props.$$slots,slots=_$$props$$$slots7===void 0?{}:_$$props$$$slots7,$$scope=$$props.$$scope;var value=$$props.value;var path=$$props.path;var expandedMap=$$props.expandedMap;var enforceStringMap=$$props.enforceStringMap;var visibleSectionsMap=$$props.visibleSectionsMap;var validationErrorsMap=$$props.validationErrorsMap;var searchResultItemsMap=$$props.searchResultItemsMap;var selection=$$props.selection;var context=$$props.context;var onDragSelectionStart=$$props.onDragSelectionStart;var debug=createDebug('jsoneditor:JSONNode');var hover=undefined;var hoverTimer=undefined;var dragging=undefined;// important to prevent creating a new path for all children with every re-render,
// that would force all children to re-render
var memoizePath=createMemoizePath();var pointer;var expanded;var enforceString;var visibleSections;var validationError;var isSelected;// TODO: extract getProps into a separate function
function getProps(path,object,expandedMap,enforceStringMap,visibleSectionsMap,validationErrorsMap,searchResultItemsMap,selection,dragging){var props=Object.keys(object).map(function(key){var keyPointer=immutableJSONPatch.exports.appendToJSONPointer(pointer,key);return{key:key,value:object[key],path:memoizePath(path.concat(key)),pointer:keyPointer,expandedMap:filterPointerOrUndefined(expandedMap,keyPointer),enforceStringMap:filterPointerOrUndefined(enforceStringMap,keyPointer),visibleSectionsMap:filterPointerOrUndefined(visibleSectionsMap,keyPointer),validationErrorsMap:filterPointerOrUndefined(validationErrorsMap,keyPointer),keySearchResultItemsMap:filterKeySearchResults(searchResultItemsMap,keyPointer),valueSearchResultItemsMap:filterPointerOrUndefined(searchResultItemsMap,keyPointer),selection:selectionIfOverlapping(selection,keyPointer)};});// reorder the props when dragging
if(dragging&&dragging.offset!==0){props=moveItems(props,dragging.selectionStartIndex,dragging.selectionItemsCount,dragging.offset);}return props;}// TODO: extract getItems into a separate function
function getItems(path,array,visibleSection,expandedMap,enforceStringMap,visibleSectionsMap,validationErrorsMap,searchResultItemsMap,selection,dragging){var start=visibleSection.start;var end=Math.min(visibleSection.end,array.length);var items=[];for(var index=start;index<end;index++){var itemPointer=immutableJSONPatch.exports.appendToJSONPointer(pointer,index);items.push({index:index,value:array[index],path:memoizePath(path.concat(String(index))),pointer:itemPointer,expandedMap:filterPointerOrUndefined(expandedMap,itemPointer),enforceStringMap:filterPointerOrUndefined(enforceStringMap,itemPointer),visibleSectionsMap:filterPointerOrUndefined(visibleSectionsMap,itemPointer),validationErrorsMap:filterPointerOrUndefined(validationErrorsMap,itemPointer),searchResultItemsMap:filterPointerOrUndefined(searchResultItemsMap,itemPointer),selection:selectionIfOverlapping(selection,itemPointer)});}// reorder the items when dragging
if(dragging&&dragging.offset!==0){var originalIndexes=items.map(function(item){return item.index;});items=moveItems(items,dragging.selectionStartIndex,dragging.selectionItemsCount,dragging.offset);// maintain the original indexes. Indexes must keep the same order,
// note that the indexes can be a visible section from 200-300 for example
for(var _i279=0;_i279<items.length;_i279++){items[_i279].index=originalIndexes[_i279];}}return items;}function toggleExpand(event){event.stopPropagation();var recursive=event.ctrlKey;context.onExpand(path,!expanded,recursive);}function handleExpand(event){event.stopPropagation();context.onExpand(path,true);}function handleUpdateKey(oldKey,newKey){var operations=rename(path,Object.keys(value),oldKey,newKey);context.onPatch(operations);// It is possible that the applied key differs from newKey,
// to prevent duplicate keys. Here we figure out the actually applied key
var newKeyUnique=last(immutableJSONPatch.exports.parseJSONPointer(operations[0].path));return newKeyUnique;}function handleMouseDown(event){// check if the mouse down is not happening in the key or value input fields or on a button
if(isContentEditableDiv(event.target)||event.which===1&&isChildOfNodeName(event.target,'BUTTON')){return;// left mouse on a button
}event.stopPropagation();event.preventDefault();// we attach the mousemove and mouseup event listeners to the global document,
// so we will not miss if the mouse events happen outside the editor
document.addEventListener('mousemove',handleMouseMoveGlobal,true);document.addEventListener('mouseup',handleMouseUpGlobal);var anchorType=getSelectionTypeFromTarget(event.target);var json=context.getJson();var documentState=context.getDocumentState();// when right-clicking inside the current selection, do nothing: context menu will open
// when left-clicking inside the current selection, do nothing: it can be the start of dragging
if(isPathInsideSelection(selection,path,anchorType)){if(event.button===0){onDragSelectionStart(event);}return;}// TODO: refactor dragging, there are now two separate mechanisms handling mouse movement: with dragging.* and with singleton.*
singleton.selecting=true;singleton.selectionAnchor=path;singleton.selectionAnchorType=anchorType;singleton.selectionFocus=path;if(event.shiftKey){// Shift+Click will select multiple entries
if(selection){context.onSelect(createMultiSelection(json,selection.anchorPath,path));}}else{if(anchorType===SelectionType.multi){if(root&&event.target.hasAttribute('data-path')){var lastCaretPosition=last(getVisibleCaretPositions(value,documentState));context.onSelect(fromCaretPosition(lastCaretPosition));}else{context.onSelect(createMultiSelection(json,path,path));}}else{context.onSelect(fromSelectionType(json,anchorType,path));}}// make sure the editor has focus
context.focus();}function handleMouseMove(event){if(singleton.selecting){event.preventDefault();event.stopPropagation();if(singleton.selectionFocus==null){// First move event, no selection yet.
// Clear the default selection of the browser
if(window.getSelection){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
window.getSelection().empty();}}var selectionType=getSelectionTypeFromTarget(event.target);if(!isEqual$1(path,singleton.selectionFocus)||selectionType!==singleton.selectionAnchorType){singleton.selectionFocus=path;singleton.selectionAnchorType=selectionType;// TODO: this is a bit ugly
var _json6=context.getJson();context.onSelect(createMultiSelection(_json6,singleton.selectionAnchor,singleton.selectionFocus));}}}function handleMouseMoveGlobal(event){context.onDrag(event);}function handleMouseUpGlobal(event){if(singleton.selecting){singleton.selecting=false;event.stopPropagation();}context.onDragEnd();document.removeEventListener('mousemove',handleMouseMoveGlobal,true);document.removeEventListener('mouseup',handleMouseUpGlobal);}function findContentTop(){var _context$findElement,_context$findElement$;return((_context$findElement=context.findElement([]))===null||_context$findElement===void 0?void 0:(_context$findElement$=_context$findElement.getBoundingClientRect())===null||_context$findElement$===void 0?void 0:_context$findElement$.top)||0;}function calculateDeltaY(dragging,event){// calculate the contentOffset, this changes when scrolling
var contentTop=findContentTop();var contentOffset=contentTop-dragging.initialContentTop;// calculate the vertical mouse movement
var clientOffset=event.clientY-dragging.initialClientY;return clientOffset-contentOffset;}function handleDragSelectionStart(event){if(context.readOnly){return;}var selectionParentPath=initial(selection.focusPath);if(!isEqual$1(path,selectionParentPath)){// pass to parent
onDragSelectionStart(event);return;}// note that the returned items will be of one section only,
// and when the selection is spread over multiple sections,
// no items will be returned: this is not (yet) supported
var items=getVisibleItemsWithHeights(selection,visibleSections||DEFAULT_VISIBLE_SECTIONS);debug('dragSelectionStart',{selection:selection,items:items});if(!items){debug('Cannot drag the current selection (probably spread over multiple sections)');return;}var initialPath=getStartPath(selection);var selectionStartIndex=items.findIndex(function(item){return isEqual$1(item.path,initialPath);});var json=context.getJson();var documentState=context.getDocumentState();var _onMoveSelection=onMoveSelection({json:json,documentState:documentState,deltaY:0,items:items}),offset=_onMoveSelection.offset;$$invalidate(11,dragging={initialTarget:event.target,initialClientY:event.clientY,initialContentTop:findContentTop(),selectionStartIndex:selectionStartIndex,selectionItemsCount:getSelectionPaths(selection).length,items:items,offset:offset,didMoveItems:false// whether items have been moved during dragging or not
});singleton.dragging=true;document.addEventListener('mousemove',handleDragSelection,true);document.addEventListener('mouseup',handleDragSelectionEnd);}function handleDragSelection(event){if(dragging){var _json7=context.getJson();var documentState=context.getDocumentState();var deltaY=calculateDeltaY(dragging,event);var _onMoveSelection2=onMoveSelection({json:_json7,documentState:documentState,deltaY:deltaY,items:dragging.items}),offset=_onMoveSelection2.offset;if(offset!==dragging.offset){debug('drag selection',offset,deltaY);$$invalidate(11,dragging=_objectSpread2(_objectSpread2({},dragging),{},{offset:offset,didMoveItems:true}));}}}function handleDragSelectionEnd(event){if(dragging){var _json8=context.getJson();var documentState=context.getDocumentState();var deltaY=calculateDeltaY(dragging,event);var _onMoveSelection3=onMoveSelection({json:_json8,documentState:documentState,deltaY:deltaY,items:dragging.items}),operations=_onMoveSelection3.operations,updatedSelection=_onMoveSelection3.updatedSelection;if(operations){context.onPatch(operations,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:updatedSelection||selection})};});}else{// the user did click inside the selection and no contents have been dragged,
// select the clicked item
if(event.target===dragging.initialTarget&&!dragging.didMoveItems){var selectionType=getSelectionTypeFromTarget(event.target);var _path3=getDataPathFromTarget(event.target);if(_path3){context.onSelect(fromSelectionType(_json8,selectionType,_path3));}}}$$invalidate(11,dragging=undefined);singleton.dragging=false;document.removeEventListener('mousemove',handleDragSelection,true);document.removeEventListener('mouseup',handleDragSelectionEnd);}}/**
 * Get a list with all visible items and their rendered heights inside
 * this object or array
 */ // TODO: extract and unit test getVisibleItemsWithHeights
function getVisibleItemsWithHeights(selection,visibleSections){var items=[];function addHeight(prop){var itemPath=path.concat(prop);var element=context.findElement(itemPath);if(element!=null){items.push({path:itemPath,height:element.clientHeight});}}if(Array.isArray(value)){var startPath=getStartPath(selection);var endPath=getEndPath(selection);var startIndex=last(startPath);var endIndex=last(endPath);// find the section where the selection is
// if the selection is spread over multiple visible sections,
// we will not return any items, so dragging will not work there.
// We do this to keep things simple for now.
var currentSection=visibleSections.find(function(visibleSection){return startIndex>=visibleSection.start&&endIndex<=visibleSection.end;});if(!currentSection){return null;}var start=currentSection.start,end=currentSection.end;forEachIndex(start,Math.min(value.length,end),function(index){return addHeight(String(index));});}else{// value is Object
Object.keys(value).forEach(addHeight);}return items;}function handleMouseOver(event){if(singleton.selecting||singleton.dragging){return;}event.stopPropagation();if(isChildOfAttribute(event.target,'data-type','selectable-value')){$$invalidate(10,hover=HOVER_COLLECTION);}else if(isChildOfAttribute(event.target,'data-type','insert-selection-area-inside')){$$invalidate(10,hover=HOVER_INSERT_INSIDE);}else if(isChildOfAttribute(event.target,'data-type','insert-selection-area-after')){$$invalidate(10,hover=HOVER_INSERT_AFTER);}clearTimeout(hoverTimer);}function handleMouseOut(event){event.stopPropagation();// to prevent "flickering" in the hovering state when hovering on the edge
// of the insert area context menu button: it's visibility toggles when
// `hover` toggles, which will alternating mouseout and mouseover events
hoverTimer=setTimeout(function(){return $$invalidate(10,hover=undefined);});}function handleInsertInside(event){if(!event.shiftKey){event.stopPropagation();event.preventDefault();context.onSelect(createInsideSelection(path));}}function handleInsertAfter(event){if(!event.shiftKey){event.stopPropagation();event.preventDefault();context.onSelect(createAfterSelection(path));}}function handleInsertInsideOpenContextMenu(props){context.onSelect(createInsideSelection(path));context.onContextMenu(props);}function handleInsertAfterOpenContextMenu(props){context.onSelect(createAfterSelection(path));context.onContextMenu(props);}$$self.$$set=function($$props){if('value'in $$props)$$invalidate(0,value=$$props.value);if('path'in $$props)$$invalidate(1,path=$$props.path);if('expandedMap'in $$props)$$invalidate(2,expandedMap=$$props.expandedMap);if('enforceStringMap'in $$props)$$invalidate(3,enforceStringMap=$$props.enforceStringMap);if('visibleSectionsMap'in $$props)$$invalidate(4,visibleSectionsMap=$$props.visibleSectionsMap);if('validationErrorsMap'in $$props)$$invalidate(5,validationErrorsMap=$$props.validationErrorsMap);if('searchResultItemsMap'in $$props)$$invalidate(6,searchResultItemsMap=$$props.searchResultItemsMap);if('selection'in $$props)$$invalidate(7,selection=$$props.selection);if('context'in $$props)$$invalidate(8,context=$$props.context);if('onDragSelectionStart'in $$props)$$invalidate(33,onDragSelectionStart=$$props.onDragSelectionStart);if('$$scope'in $$props)$$invalidate(35,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*path*/2){$$invalidate(9,pointer=immutableJSONPatch.exports.compileJSONPointer(path));}if($$self.$$.dirty[0]&/*expandedMap, pointer*/516){$$invalidate(12,expanded=expandedMap?expandedMap[pointer]===true:false);}if($$self.$$.dirty[0]&/*value, enforceStringMap, pointer, context*/777){$$invalidate(13,enforceString=getEnforceString(value,enforceStringMap,pointer,context.parser));}if($$self.$$.dirty[0]&/*visibleSectionsMap, pointer*/528){$$invalidate(14,visibleSections=visibleSectionsMap?visibleSectionsMap[pointer]:undefined);}if($$self.$$.dirty[0]&/*validationErrorsMap, pointer*/544){$$invalidate(15,validationError=validationErrorsMap?validationErrorsMap[pointer]:undefined);}if($$self.$$.dirty[0]&/*selection, pointer*/640){$$invalidate(16,isSelected=selection?selection.pointersMap[pointer]===true:false);}if($$self.$$.dirty[0]&/*path*/2){$$invalidate(17,root=path.length===0);}if($$self.$$.dirty[0]&/*path*/2){$$invalidate(18,indentationStyle=getIndentationStyle(path.length));}};return[value,path,expandedMap,enforceStringMap,visibleSectionsMap,validationErrorsMap,searchResultItemsMap,selection,context,pointer,hover,dragging,expanded,enforceString,visibleSections,validationError,isSelected,root,indentationStyle,getProps,getItems,toggleExpand,handleExpand,handleUpdateKey,handleMouseDown,handleMouseMove,handleDragSelectionStart,handleMouseOver,handleMouseOut,handleInsertInside,handleInsertAfter,handleInsertInsideOpenContextMenu,handleInsertAfterOpenContextMenu,onDragSelectionStart,slots,$$scope];}var JSONNode=/*#__PURE__*/function(_SvelteComponent30){_inherits(JSONNode,_SvelteComponent30);var _super71=_createSuper(JSONNode);function JSONNode(options){var _this125;_classCallCheck(this,JSONNode);_this125=_super71.call(this);init(_assertThisInitialized(_this125),options,instance$s,create_fragment$s,not_equal,{value:0,path:1,expandedMap:2,enforceStringMap:3,visibleSectionsMap:4,validationErrorsMap:5,searchResultItemsMap:6,selection:7,context:8,onDragSelectionStart:33},add_css$p,[-1,-1]);return _this125;}return _createClass(JSONNode);}(SvelteComponent);var JSONNode$1=JSONNode;/* src/lib/components/modes/treemode/menu/TreeMenu.svelte generated by Svelte v3.51.0 */function create_fragment$r(ctx){var menu;var current;menu=new Menu$1({props:{items:/*items*/ctx[0]}});return{c:function c(){create_component(menu.$$.fragment);},m:function m(target,anchor){mount_component(menu,target,anchor);current=true;},p:function p(ctx,_ref133){var _ref134=_slicedToArray(_ref133,1),dirty=_ref134[0];var menu_changes={};if(dirty&/*items*/1)menu_changes.items=/*items*/ctx[0];menu.$set(menu_changes);},i:function i(local){if(current)return;transition_in(menu.$$.fragment,local);current=true;},o:function o(local){transition_out(menu.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(menu,detaching);}};}function instance$r($$self,$$props,$$invalidate){var hasJson;var hasSelectionContents;var expandMenuItem;var collapseMenuItem;var searchMenuItem;var defaultItems;var items;var json=$$props.json;var selection=$$props.selection;var readOnly=$$props.readOnly;var _$$props$showSearch=$$props.showSearch,showSearch=_$$props$showSearch===void 0?false:_$$props$showSearch;var historyState=$$props.historyState;var onExpandAll=$$props.onExpandAll;var onCollapseAll=$$props.onCollapseAll;var onUndo=$$props.onUndo;var onRedo=$$props.onRedo;var onSort=$$props.onSort;var onTransform=$$props.onTransform;var onContextMenu=$$props.onContextMenu;var onCopy=$$props.onCopy;var _$$props$onRenderMenu3=$$props.onRenderMenu,onRenderMenu=_$$props$onRenderMenu3===void 0?noop:_$$props$onRenderMenu3;function handleToggleSearch(){$$invalidate(1,showSearch=!showSearch);}$$self.$$set=function($$props){if('json'in $$props)$$invalidate(2,json=$$props.json);if('selection'in $$props)$$invalidate(3,selection=$$props.selection);if('readOnly'in $$props)$$invalidate(4,readOnly=$$props.readOnly);if('showSearch'in $$props)$$invalidate(1,showSearch=$$props.showSearch);if('historyState'in $$props)$$invalidate(5,historyState=$$props.historyState);if('onExpandAll'in $$props)$$invalidate(6,onExpandAll=$$props.onExpandAll);if('onCollapseAll'in $$props)$$invalidate(7,onCollapseAll=$$props.onCollapseAll);if('onUndo'in $$props)$$invalidate(8,onUndo=$$props.onUndo);if('onRedo'in $$props)$$invalidate(9,onRedo=$$props.onRedo);if('onSort'in $$props)$$invalidate(10,onSort=$$props.onSort);if('onTransform'in $$props)$$invalidate(11,onTransform=$$props.onTransform);if('onContextMenu'in $$props)$$invalidate(12,onContextMenu=$$props.onContextMenu);if('onCopy'in $$props)$$invalidate(13,onCopy=$$props.onCopy);if('onRenderMenu'in $$props)$$invalidate(14,onRenderMenu=$$props.onRenderMenu);};$$self.$$.update=function(){if($$self.$$.dirty&/*json*/4){$$invalidate(20,hasJson=json!==undefined);}if($$self.$$.dirty&/*selection*/8);if($$self.$$.dirty&/*hasJson, selection*/1048584){$$invalidate(17,hasSelectionContents=hasJson&&(isMultiSelection(selection)||isKeySelection(selection)||isValueSelection(selection)));}if($$self.$$.dirty&/*onExpandAll, json*/68){$$invalidate(19,expandMenuItem={icon:faJSONEditorExpand,title:'Expand all',className:'jse-expand-all',onClick:onExpandAll,disabled:!isObjectOrArray(json)});}if($$self.$$.dirty&/*onCollapseAll, json*/132){$$invalidate(18,collapseMenuItem={icon:faJSONEditorCollapse,title:'Collapse all',className:'jse-collapse-all',onClick:onCollapseAll,disabled:!isObjectOrArray(json)});}if($$self.$$.dirty&/*json*/4){$$invalidate(16,searchMenuItem={icon:faSearch,title:'Search (Ctrl+F)',className:'jse-search',onClick:handleToggleSearch,disabled:json===undefined});}if($$self.$$.dirty&/*readOnly, expandMenuItem, collapseMenuItem, onSort, json, onTransform, searchMenuItem, onContextMenu, onUndo, historyState, onRedo, onCopy, hasSelectionContents*/999220){/* @type {MenuItem[]} */$$invalidate(15,defaultItems=!readOnly?[expandMenuItem,collapseMenuItem,{separator:true},{icon:faSortAmountDownAlt,title:'Sort',className:'jse-sort',onClick:onSort,disabled:readOnly||json===undefined},{icon:faFilter,title:'Transform contents (filter, sort, project)',className:'jse-transform',onClick:onTransform,disabled:readOnly||json===undefined},searchMenuItem,{icon:faEllipsisV,title:CONTEXT_MENU_EXPLANATION,className:'jse-contextmenu',onClick:onContextMenu},{separator:true},{icon:faUndo,title:'Undo (Ctrl+Z)',className:'jse-undo',onClick:onUndo,disabled:!historyState.canUndo},{icon:faRedo,title:'Redo (Ctrl+Shift+Z)',className:'jse-redo',onClick:onRedo,disabled:!historyState.canRedo},{space:true}]:[expandMenuItem,collapseMenuItem,{separator:true},{icon:faCopy,title:'Copy (Ctrl+C)',className:'jse-copy',onClick:onCopy,disabled:!hasSelectionContents},{separator:true},searchMenuItem,{space:true}]);}if($$self.$$.dirty&/*onRenderMenu, defaultItems*/49152){$$invalidate(0,items=onRenderMenu('tree',defaultItems)||defaultItems);}};return[items,showSearch,json,selection,readOnly,historyState,onExpandAll,onCollapseAll,onUndo,onRedo,onSort,onTransform,onContextMenu,onCopy,onRenderMenu,defaultItems,searchMenuItem,hasSelectionContents,collapseMenuItem,expandMenuItem,hasJson];}var TreeMenu=/*#__PURE__*/function(_SvelteComponent31){_inherits(TreeMenu,_SvelteComponent31);var _super72=_createSuper(TreeMenu);function TreeMenu(options){var _this126;_classCallCheck(this,TreeMenu);_this126=_super72.call(this);init(_assertThisInitialized(_this126),options,instance$r,create_fragment$r,not_equal,{json:2,selection:3,readOnly:4,showSearch:1,historyState:5,onExpandAll:6,onCollapseAll:7,onUndo:8,onRedo:9,onSort:10,onTransform:11,onContextMenu:12,onCopy:13,onRenderMenu:14});return _this126;}return _createClass(TreeMenu);}(SvelteComponent);var TreeMenu$1=TreeMenu;/* src/lib/components/modes/treemode/Welcome.svelte generated by Svelte v3.51.0 */function add_css$o(target){append_styles(target,"svelte-1q2qkk2","@charset \"UTF-8\";.jse-welcome.svelte-1q2qkk2.svelte-1q2qkk2{flex:1;overflow:auto;font-family:var(--jse-font-family);font-size:var(--jse-font-size);display:flex;flex-direction:column;align-items:center;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-welcome.svelte-1q2qkk2.svelte-1q2qkk2:last-child{border-bottom:var(--jse-main-border)}.jse-welcome.svelte-1q2qkk2 .jse-space.jse-before.svelte-1q2qkk2{flex:1}.jse-welcome.svelte-1q2qkk2 .jse-space.jse-after.svelte-1q2qkk2{flex:2}.jse-welcome.svelte-1q2qkk2 .jse-contents.svelte-1q2qkk2{margin:2em var(--jse-padding) 0;color:var(--jse-panel-color-readonly)}.jse-welcome.svelte-1q2qkk2 .jse-contents ul.svelte-1q2qkk2{list-style:\"\";list-style-position:outside;padding-left:20px}.jse-welcome.svelte-1q2qkk2 .jse-contents ul li.svelte-1q2qkk2{padding-left:10px}.jse-welcome.svelte-1q2qkk2 .jse-contents ul li span.jse-bold.svelte-1q2qkk2{font-family:var(--jse-font-family-mono);font-weight:bold}");}// (10:4) {#if !readOnly}
function create_if_block$f(ctx){var ul;return{c:function c(){ul=element("ul");ul.innerHTML="<li class=\"svelte-1q2qkk2\">Click inside the editor</li> \n        <li class=\"svelte-1q2qkk2\">Paste clipboard data using <span class=\"jse-bold svelte-1q2qkk2\">Ctrl+V</span></li> \n        <li class=\"svelte-1q2qkk2\">Create a new object by typing <span class=\"jse-bold svelte-1q2qkk2\">{</span></li> \n        <li class=\"svelte-1q2qkk2\">Create a new array by typing <span class=\"jse-bold svelte-1q2qkk2\">[</span></li>";attr(ul,"class","svelte-1q2qkk2");},m:function m(target,anchor){insert$2(target,ul,anchor);},d:function d(detaching){if(detaching)detach(ul);}};}function create_fragment$q(ctx){var div3;var div0;var t0;var div1;var t1;var t2;var div2;var if_block=!/*readOnly*/ctx[0]&&create_if_block$f();return{c:function c(){div3=element("div");div0=element("div");t0=space();div1=element("div");t1=text("Empty document\n    ");if(if_block)if_block.c();t2=space();div2=element("div");attr(div0,"class","jse-space jse-before svelte-1q2qkk2");attr(div1,"class","jse-contents svelte-1q2qkk2");attr(div2,"class","jse-space jse-after svelte-1q2qkk2");attr(div3,"class","jse-welcome svelte-1q2qkk2");},m:function m(target,anchor){insert$2(target,div3,anchor);append$1(div3,div0);append$1(div3,t0);append$1(div3,div1);append$1(div1,t1);if(if_block)if_block.m(div1,null);append$1(div3,t2);append$1(div3,div2);},p:function p(ctx,_ref135){var _ref136=_slicedToArray(_ref135,1),dirty=_ref136[0];if(!/*readOnly*/ctx[0]){if(if_block);else{if_block=create_if_block$f();if_block.c();if_block.m(div1,null);}}else if(if_block){if_block.d(1);if_block=null;}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div3);if(if_block)if_block.d();}};}function instance$q($$self,$$props,$$invalidate){var readOnly=$$props.readOnly;$$self.$$set=function($$props){if('readOnly'in $$props)$$invalidate(0,readOnly=$$props.readOnly);};return[readOnly];}var Welcome=/*#__PURE__*/function(_SvelteComponent32){_inherits(Welcome,_SvelteComponent32);var _super73=_createSuper(Welcome);function Welcome(options){var _this127;_classCallCheck(this,Welcome);_this127=_super73.call(this);init(_assertThisInitialized(_this127),options,instance$q,create_fragment$q,not_equal,{readOnly:0},add_css$o);return _this127;}return _createClass(Welcome);}(SvelteComponent);var Welcome$1=Welcome;var naturalCompareLite={exports:{}};/*
 * @version    1.4.0
 * @date       2015-10-26
 * @stability  3 - Stable
 * @author     Lauri Rooden (https://github.com/litejs/natural-compare-lite)
 * @license    MIT License
 */var naturalCompare=function naturalCompare(a,b){var i,codeA,codeB=1,posA=0,posB=0,alphabet=String.alphabet;function getCode(str,pos,code){if(code){for(i=pos;code=getCode(str,i),code<76&&code>65;){++i;}return+str.slice(pos-1,i);}code=alphabet&&alphabet.indexOf(str.charAt(pos));return code>-1?code+76:(code=str.charCodeAt(pos)||0,code<45||code>127)?code:code<46?65// -
:code<48?code-1:code<58?code+18// 0-9
:code<65?code-11:code<91?code+11// A-Z
:code<97?code-37:code<123?code+5// a-z
:code-63;}if((a+="")!=(b+=""))for(;codeB;){codeA=getCode(a,posA++);codeB=getCode(b,posB++);if(codeA<76&&codeB<76&&codeA>66&&codeB>66){codeA=getCode(a,posA,posA);codeB=getCode(b,posB,posA=i);posB=i;}if(codeA!=codeB)return codeA<codeB?-1:1;}return 0;};try{naturalCompareLite.exports=naturalCompare;}catch(e){String.naturalCompare=naturalCompare;}function caseInsensitiveNaturalCompare(a,b){var aLower=typeof a==='string'?a.toLowerCase():a;var bLower=typeof b==='string'?b.toLowerCase():b;return naturalCompareLite.exports(aLower,bLower);}/**
 * Sort the keys of an object
 * @param json           The the JSON containg the (optionally nested)
 *                       object to be sorted
 * @param [rootPath=[]]  Relative path when the array was located
 * @param [direction=1]  Pass 1 to sort ascending, -1 to sort descending
 * @return               Returns a JSONPatch document with move operation
 *                       to get the array sorted.
 */function sortObjectKeys(json){var rootPath=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var direction=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var object=immutableJSONPatch.exports.getIn(json,rootPath);var keys=Object.keys(object);var sortedKeys=keys.slice();sortedKeys.sort(function(keyA,keyB){return direction*caseInsensitiveNaturalCompare(keyA,keyB);});// TODO: can we make this more efficient? check if the first couple of keys are already in order and if so ignore them
var operations=[];for(var _i280=0;_i280<sortedKeys.length;_i280++){var key=sortedKeys[_i280];var path=immutableJSONPatch.exports.compileJSONPointer(rootPath.concat(key));operations.push({op:'move',from:path,path:path});}return operations;}/**
 * Sort the items of an array
 * @param json               The document containing (optionally nested)
 *                           the array to be sorted.
 * @param [rootPath=[]]      Relative path when the array was located
 * @param [propertyPath=[]]  Nested path to the property on which to sort the contents
 * @param [direction=1]      Pass 1 to sort ascending, -1 to sort descending
 * @return                   Returns a JSONPatch document with move operation
 *                           to get the array sorted.
 */function sortArray(json){var rootPath=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var propertyPath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var direction=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var comparator=createObjectComparator(propertyPath,direction);// TODO: make the mechanism to sort configurable? Like use sortOperationsMove and sortOperationsMoveAdvanced
var array=immutableJSONPatch.exports.getIn(json,rootPath);return[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(rootPath),value:array.slice(0).sort(comparator)}];}/**
 * Create a comparator function to compare nested properties in an array
 */function createObjectComparator(propertyPath,direction){return function comparator(a,b){var valueA=immutableJSONPatch.exports.getIn(a,propertyPath);var valueB=immutableJSONPatch.exports.getIn(b,propertyPath);if(valueA===undefined){return direction;}if(valueB===undefined){return-direction;}if(typeof valueA!=='string'&&typeof valueB!=='string'){// both values are a number, boolean, or null -> use simple, fast sorting
return valueA>valueB?direction:valueA<valueB?-direction:0;}return direction*caseInsensitiveNaturalCompare(valueA,valueB);};}/* src/lib/components/controls/navigationBar/NavigationBarDropdown.svelte generated by Svelte v3.51.0 */function add_css$n(target){append_styles(target,"svelte-6hb2gf",".jse-navigation-bar-dropdown.svelte-6hb2gf.svelte-6hb2gf{position:absolute;top:100%;left:0;z-index:3;background:var(--jse-navigation-bar-background);color:var(--jse-navigation-bar-dropdown-color);box-shadow:var(--jse-controls-box-shadow);display:flex;flex-direction:column;max-height:300px;overflow:auto;min-width:80px}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);border:none;background:transparent;color:inherit;cursor:pointer;outline:none;text-align:left;white-space:nowrap;box-sizing:border-box;padding:calc(0.5 * var(--jse-padding)) 36px}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf:focus,.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.svelte-6hb2gf:hover{background:var(--jse-navigation-bar-background-highlight)}.jse-navigation-bar-dropdown.svelte-6hb2gf button.jse-navigation-bar-dropdown-item.jse-selected.svelte-6hb2gf{background:var(--jse-navigation-bar-dropdown-color);color:var(--jse-navigation-bar-background)}");}function get_each_context$7(ctx,list,i){var child_ctx=ctx.slice();child_ctx[4]=list[i];return child_ctx;}// (13:2) {#each limit(items, MAX_ITEMS) as item (item)}
function create_each_block$7(key_1,ctx){var button;var t_value=truncate(/*item*/ctx[4],MAX_ITEM_CHARACTERS)+"";var t;var button_title_value;var mounted;var dispose;function click_handler(){return(/*click_handler*/ctx[3](/*item*/ctx[4]));}return{key:key_1,first:null,c:function c(){button=element("button");t=text(t_value);attr(button,"type","button");attr(button,"class","jse-navigation-bar-dropdown-item svelte-6hb2gf");attr(button,"title",button_title_value=/*item*/ctx[4]);toggle_class(button,"jse-selected",/*item*/ctx[4]===/*selectedItem*/ctx[1]);this.first=button;},m:function m(target,anchor){insert$2(target,button,anchor);append$1(button,t);if(!mounted){dispose=listen(button,"click",stop_propagation(click_handler));mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(dirty&/*items*/1&&t_value!==(t_value=truncate(/*item*/ctx[4],MAX_ITEM_CHARACTERS)+""))set_data(t,t_value);if(dirty&/*items*/1&&button_title_value!==(button_title_value=/*item*/ctx[4])){attr(button,"title",button_title_value);}if(dirty&/*limit, items, MAX_ITEMS, selectedItem*/3){toggle_class(button,"jse-selected",/*item*/ctx[4]===/*selectedItem*/ctx[1]);}},d:function d(detaching){if(detaching)detach(button);mounted=false;dispose();}};}// (24:2) {#if items.length > MAX_ITEMS}
function create_if_block$e(ctx){var button;var t;return{c:function c(){button=element("button");t=text("...");attr(button,"type","button");attr(button,"class","jse-navigation-bar-dropdown-item svelte-6hb2gf");attr(button,"title","Limited to "+MAX_ITEMS+" items");},m:function m(target,anchor){insert$2(target,button,anchor);append$1(button,t);},p:noop$2,d:function d(detaching){if(detaching)detach(button);}};}function create_fragment$p(ctx){var div;var each_blocks=[];var each_1_lookup=new Map();var t;var each_value=limit(/*items*/ctx[0],MAX_ITEMS);var get_key=function get_key(ctx){return(/*item*/ctx[4]);};for(var _i281=0;_i281<each_value.length;_i281+=1){var child_ctx=get_each_context$7(ctx,each_value,_i281);var key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[_i281]=create_each_block$7(key,child_ctx));}var if_block=/*items*/ctx[0].length>MAX_ITEMS&&create_if_block$e();return{c:function c(){div=element("div");for(var _i282=0;_i282<each_blocks.length;_i282+=1){each_blocks[_i282].c();}t=space();if(if_block)if_block.c();attr(div,"class","jse-navigation-bar-dropdown svelte-6hb2gf");},m:function m(target,anchor){insert$2(target,div,anchor);for(var _i283=0;_i283<each_blocks.length;_i283+=1){each_blocks[_i283].m(div,null);}append$1(div,t);if(if_block)if_block.m(div,null);},p:function p(ctx,_ref137){var _ref138=_slicedToArray(_ref137,1),dirty=_ref138[0];if(dirty&/*limit, items, MAX_ITEMS, selectedItem, onSelect, truncate, MAX_ITEM_CHARACTERS*/7){each_value=limit(/*items*/ctx[0],MAX_ITEMS);each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,div,destroy_block,create_each_block$7,t,get_each_context$7);}if(/*items*/ctx[0].length>MAX_ITEMS){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block$e();if_block.c();if_block.m(div,null);}}else if(if_block){if_block.d(1);if_block=null;}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);for(var _i284=0;_i284<each_blocks.length;_i284+=1){each_blocks[_i284].d();}if(if_block)if_block.d();}};}var MAX_ITEMS=100;var MAX_ITEM_CHARACTERS=30;function instance$p($$self,$$props,$$invalidate){var items=$$props.items;var selectedItem=$$props.selectedItem;var onSelect=$$props.onSelect;var click_handler=function click_handler(item){return onSelect(item);};$$self.$$set=function($$props){if('items'in $$props)$$invalidate(0,items=$$props.items);if('selectedItem'in $$props)$$invalidate(1,selectedItem=$$props.selectedItem);if('onSelect'in $$props)$$invalidate(2,onSelect=$$props.onSelect);};return[items,selectedItem,onSelect,click_handler];}var NavigationBarDropdown=/*#__PURE__*/function(_SvelteComponent33){_inherits(NavigationBarDropdown,_SvelteComponent33);var _super74=_createSuper(NavigationBarDropdown);function NavigationBarDropdown(options){var _this128;_classCallCheck(this,NavigationBarDropdown);_this128=_super74.call(this);init(_assertThisInitialized(_this128),options,instance$p,create_fragment$p,not_equal,{items:0,selectedItem:1,onSelect:2},add_css$n);return _this128;}return _createClass(NavigationBarDropdown);}(SvelteComponent);var NavigationBarDropdown$1=NavigationBarDropdown;/* src/lib/components/controls/navigationBar/NavigationBarItem.svelte generated by Svelte v3.51.0 */function add_css$m(target){append_styles(target,"svelte-1r1k9th",".jse-navigation-bar-item.svelte-1r1k9th.svelte-1r1k9th{position:relative;display:flex}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th{font-family:inherit;font-size:inherit;padding:calc(0.5 * var(--jse-padding)) 2px;border:none;background:transparent;color:inherit;cursor:pointer;outline:none;min-width:2em;white-space:nowrap}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th:focus,.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.svelte-1r1k9th:hover{background:var(--jse-panel-button-background-highlight);color:var(--jse-panel-button-color-highlight)}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.jse-navigation-bar-arrow.svelte-1r1k9th{padding:2px var(--jse-padding) 0}.jse-navigation-bar-item.svelte-1r1k9th button.jse-navigation-bar-button.jse-navigation-bar-arrow.jse-open.svelte-1r1k9th{background:var(--jse-navigation-bar-background);color:var(--jse-navigation-bar-dropdown-color)}.jse-navigation-bar-item.svelte-1r1k9th.svelte-1r1k9th:last-child{padding-right:var(--jse-padding)}");}// (49:2) {#if selectedItem !== undefined}
function create_if_block$d(ctx){var button;var t;var mounted;var dispose;return{c:function c(){button=element("button");t=text(/*selectedItem*/ctx[2]);attr(button,"type","button");attr(button,"class","jse-navigation-bar-button svelte-1r1k9th");},m:function m(target,anchor){insert$2(target,button,anchor);append$1(button,t);if(!mounted){dispose=listen(button,"click",/*click_handler*/ctx[9]);mounted=true;}},p:function p(ctx,dirty){if(dirty&/*selectedItem*/4)set_data(t,/*selectedItem*/ctx[2]);},d:function d(detaching){if(detaching)detach(button);mounted=false;dispose();}};}function create_fragment$o(ctx){var div;var button;var icon;var t;var current;var mounted;var dispose;icon=new Icon({props:{data:faAngleRight}});var if_block=/*selectedItem*/ctx[2]!==undefined&&create_if_block$d(ctx);return{c:function c(){div=element("div");button=element("button");create_component(icon.$$.fragment);t=space();if(if_block)if_block.c();attr(button,"type","button");attr(button,"class","jse-navigation-bar-button jse-navigation-bar-arrow svelte-1r1k9th");toggle_class(button,"jse-open",/*open*/ctx[1]);attr(div,"class","jse-navigation-bar-item svelte-1r1k9th");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,button);mount_component(icon,button,null);append$1(div,t);if(if_block)if_block.m(div,null);/*div_binding*/ctx[10](div);current=true;if(!mounted){dispose=listen(button,"click",/*openDropdown*/ctx[4]);mounted=true;}},p:function p(ctx,_ref139){var _ref140=_slicedToArray(_ref139,1),dirty=_ref140[0];if(!current||dirty&/*open*/2){toggle_class(button,"jse-open",/*open*/ctx[1]);}if(/*selectedItem*/ctx[2]!==undefined){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block$d(ctx);if_block.c();if_block.m(div,null);}}else if(if_block){if_block.d(1);if_block=null;}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(icon);if(if_block)if_block.d();/*div_binding*/ctx[10](null);mounted=false;dispose();}};}function instance$o($$self,$$props,$$invalidate){var itemPath;var selectedItem;var _getContext4=getContext('absolute-popup'),openAbsolutePopup=_getContext4.openAbsolutePopup,closeAbsolutePopup=_getContext4.closeAbsolutePopup;var path=$$props.path;var index=$$props.index;var onSelect=$$props.onSelect;var getItems=$$props.getItems;var refNavigationBarItem;var open=false;var popupId;function handleSelectItem(item){closeAbsolutePopup(popupId);onSelect(itemPath.concat(item));}function openDropdown(){if(refNavigationBarItem){$$invalidate(1,open=true);var props={items:getItems(itemPath),selectedItem:selectedItem,onSelect:handleSelectItem};popupId=openAbsolutePopup(NavigationBarDropdown$1,props,{anchor:refNavigationBarItem,closeOnOuterClick:true,onClose:function onClose(){$$invalidate(1,open=false);}});}}var click_handler=function click_handler(){return handleSelectItem(selectedItem);};function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refNavigationBarItem=$$value;$$invalidate(0,refNavigationBarItem);});}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(5,path=$$props.path);if('index'in $$props)$$invalidate(6,index=$$props.index);if('onSelect'in $$props)$$invalidate(7,onSelect=$$props.onSelect);if('getItems'in $$props)$$invalidate(8,getItems=$$props.getItems);};$$self.$$.update=function(){if($$self.$$.dirty&/*path, index*/96){itemPath=path.slice(0,index);}if($$self.$$.dirty&/*path, index*/96){$$invalidate(2,selectedItem=path[index]);}};return[refNavigationBarItem,open,selectedItem,handleSelectItem,openDropdown,path,index,onSelect,getItems,click_handler,div_binding];}var NavigationBarItem=/*#__PURE__*/function(_SvelteComponent34){_inherits(NavigationBarItem,_SvelteComponent34);var _super75=_createSuper(NavigationBarItem);function NavigationBarItem(options){var _this129;_classCallCheck(this,NavigationBarItem);_this129=_super75.call(this);init(_assertThisInitialized(_this129),options,instance$o,create_fragment$o,not_equal,{path:5,index:6,onSelect:7,getItems:8},add_css$m);return _this129;}return _createClass(NavigationBarItem);}(SvelteComponent);var NavigationBarItem$1=NavigationBarItem;/* src/lib/components/controls/navigationBar/NavigationBarPathEditor.svelte generated by Svelte v3.51.0 */function add_css$l(target){append_styles(target,"svelte-g0evpe",".jse-navigation-bar-path-editor.svelte-g0evpe.svelte-g0evpe{flex:1;display:flex;border:var(--jse-edit-outline);background:var(--jse-background-color)}.jse-navigation-bar-path-editor.svelte-g0evpe input.jse-navigation-bar-text.svelte-g0evpe{flex:1;font-family:inherit;font-size:inherit;padding:0 5px 1px;background:var(--jse-background-color);color:var(--jse-text-color);border:none;outline:none}.jse-navigation-bar-path-editor.svelte-g0evpe button.svelte-g0evpe{border:none;background:var(--jse-background-color);cursor:pointer;font-family:inherit;font-size:80%;color:inherit}.jse-navigation-bar-path-editor.svelte-g0evpe button.jse-navigation-bar-copy.copied.svelte-g0evpe{color:var(--jse-message-success-background)}.jse-navigation-bar-path-editor.svelte-g0evpe button.jse-navigation-bar-validation-error.svelte-g0evpe{color:var(--jse-error-color)}.jse-navigation-bar-path-editor.error.svelte-g0evpe.svelte-g0evpe{border-color:var(--jse-error-color)}.jse-navigation-bar-path-editor.error.svelte-g0evpe input.jse-navigation-bar-text.svelte-g0evpe{color:var(--jse-error-color)}.jse-navigation-bar-path-editor.svelte-g0evpe .jse-copied-text.svelte-g0evpe{background:var(--jse-message-success-background);color:var(--jse-message-success-color);position:relative;margin:2px;padding:0 5px;border-radius:3px}");}// (88:2) {#if inputValidationError}
function create_if_block_1$7(ctx){var button;var icon;var tooltip_action;var current;var mounted;var dispose;icon=new Icon({props:{data:faExclamationTriangle}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-navigation-bar-validation-error svelte-g0evpe");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);current=true;if(!mounted){dispose=action_destroyer(tooltip_action=tooltip.call(null,button,_objectSpread2({text:/*inputValidationError*/ctx[3]},/*absolutePopupContext*/ctx[4])));mounted=true;}},p:function p(ctx,dirty){if(tooltip_action&&is_function(tooltip_action.update)&&dirty&/*inputValidationError*/8)tooltip_action.update.call(null,_objectSpread2({text:/*inputValidationError*/ctx[3]},/*absolutePopupContext*/ctx[4]));},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (100:2) {#if copied}
function create_if_block$c(ctx){var div;return{c:function c(){div=element("div");div.textContent="Copied!";attr(div,"class","jse-copied-text svelte-g0evpe");},m:function m(target,anchor){insert$2(target,div,anchor);},d:function d(detaching){if(detaching)detach(div);}};}function create_fragment$n(ctx){var div;var input;var t0;var t1;var t2;var button;var icon;var current;var mounted;var dispose;var if_block0=/*inputValidationError*/ctx[3]&&create_if_block_1$7(ctx);var if_block1=/*copied*/ctx[2]&&create_if_block$c();icon=new Icon({props:{data:faCopy}});return{c:function c(){div=element("div");input=element("input");t0=space();if(if_block0)if_block0.c();t1=space();if(if_block1)if_block1.c();t2=space();button=element("button");create_component(icon.$$.fragment);attr(input,"type","text");attr(input,"class","jse-navigation-bar-text svelte-g0evpe");input.value=/*inputPath*/ctx[0];attr(button,"type","button");attr(button,"class","jse-navigation-bar-copy svelte-g0evpe");attr(button,"title","Copy selected path to the clipboard");toggle_class(button,"copied",/*copied*/ctx[2]);attr(div,"class","jse-navigation-bar-path-editor svelte-g0evpe");toggle_class(div,"error",/*inputValidationError*/ctx[3]);},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,input);/*input_binding*/ctx[15](input);append$1(div,t0);if(if_block0)if_block0.m(div,null);append$1(div,t1);if(if_block1)if_block1.m(div,null);append$1(div,t2);append$1(div,button);mount_component(icon,button,null);current=true;if(!mounted){dispose=[listen(input,"keydown",stop_propagation(/*handleKeyDown*/ctx[6])),listen(input,"input",/*handleInput*/ctx[5]),listen(button,"click",/*handleCopy*/ctx[7])];mounted=true;}},p:function p(ctx,_ref141){var _ref142=_slicedToArray(_ref141,1),dirty=_ref142[0];if(!current||dirty&/*inputPath*/1&&input.value!==/*inputPath*/ctx[0]){input.value=/*inputPath*/ctx[0];}if(/*inputValidationError*/ctx[3]){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*inputValidationError*/8){transition_in(if_block0,1);}}else{if_block0=create_if_block_1$7(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div,t1);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(/*copied*/ctx[2]){if(if_block1);else{if_block1=create_if_block$c();if_block1.c();if_block1.m(div,t2);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty&/*copied*/4){toggle_class(button,"copied",/*copied*/ctx[2]);}if(!current||dirty&/*inputValidationError*/8){toggle_class(div,"error",/*inputValidationError*/ctx[3]);}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(if_block0);transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);/*input_binding*/ctx[15](null);if(if_block0)if_block0.d();if(if_block1)if_block1.d();destroy_component(icon);mounted=false;run_all(dispose);}};}var copiedDelay=1000;// ms
function instance$n($$self,$$props,$$invalidate){var inputValidationError;var absolutePopupContext=getContext('absolute-popup');var path=$$props.path;var pathParser=$$props.pathParser;var onChange=$$props.onChange;var onClose=$$props.onClose;var onError=$$props.onError;var pathExists=$$props.pathExists;var inputRef;var inputPath;var validationActive=false;var copiedTimer=undefined;var copied=false;onMount(function(){focus();});onDestroy(function(){clearTimeout(copiedTimer);});function focus(){inputRef.focus();}function parseAndValidate(pathStr){try{var _path4=pathParser.parse(pathStr);validatePathExists(_path4);return{path:_path4,error:undefined};}catch(error){return{path:undefined,error:error};}}function validatePathExists(path){if(!pathExists(path)){throw new Error('Path does not exist in current document');}}function handleInput(event){$$invalidate(0,inputPath=event.currentTarget.value);}function handleKeyDown(event){var combo=keyComboFromEvent(event);if(combo==='Escape'){onClose();}if(combo==='Enter'){$$invalidate(14,validationActive=true);var _result10=parseAndValidate(inputPath);if(_result10.path!==undefined){onChange(_result10.path);}else{onError(_result10.error);}}}function handleCopy(){copyToClipBoard(inputPath);$$invalidate(2,copied=true);copiedTimer=setTimeout(function(){return $$invalidate(2,copied=false);},copiedDelay);focus();}function input_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){inputRef=$$value;$$invalidate(1,inputRef);});}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(8,path=$$props.path);if('pathParser'in $$props)$$invalidate(9,pathParser=$$props.pathParser);if('onChange'in $$props)$$invalidate(10,onChange=$$props.onChange);if('onClose'in $$props)$$invalidate(11,onClose=$$props.onClose);if('onError'in $$props)$$invalidate(12,onError=$$props.onError);if('pathExists'in $$props)$$invalidate(13,pathExists=$$props.pathExists);};$$self.$$.update=function(){if($$self.$$.dirty&/*pathParser, path*/768){$$invalidate(0,inputPath=pathParser.stringify(path));}if($$self.$$.dirty&/*validationActive, inputPath*/16385){$$invalidate(3,inputValidationError=validationActive?parseAndValidate(inputPath).error:undefined);}};return[inputPath,inputRef,copied,inputValidationError,absolutePopupContext,handleInput,handleKeyDown,handleCopy,path,pathParser,onChange,onClose,onError,pathExists,validationActive,input_binding];}var NavigationBarPathEditor=/*#__PURE__*/function(_SvelteComponent35){_inherits(NavigationBarPathEditor,_SvelteComponent35);var _super76=_createSuper(NavigationBarPathEditor);function NavigationBarPathEditor(options){var _this130;_classCallCheck(this,NavigationBarPathEditor);_this130=_super76.call(this);init(_assertThisInitialized(_this130),options,instance$n,create_fragment$n,safe_not_equal,{path:8,pathParser:9,onChange:10,onClose:11,onError:12,pathExists:13},add_css$l);return _this130;}return _createClass(NavigationBarPathEditor);}(SvelteComponent);var NavigationBarPathEditor$1=NavigationBarPathEditor;/* src/lib/components/controls/navigationBar/NavigationBar.svelte generated by Svelte v3.51.0 */function add_css$k(target){append_styles(target,"svelte-15r3ahw",".jse-navigation-bar.svelte-15r3ahw.svelte-15r3ahw{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);background:var(--jse-panel-background);color:var(--jse-panel-button-color);padding:0;margin:0;display:flex;overflow:auto;border-left:var(--jse-main-border);border-right:var(--jse-main-border)}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw{font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);padding:calc(0.5 * var(--jse-padding)) var(--jse-padding);color:var(--jse-panel-color-readonly);background:transparent;border:none;display:flex;cursor:pointer;outline:none;align-items:center}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.flex.svelte-15r3ahw{flex:1}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw:focus,.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.svelte-15r3ahw:hover,.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit.editing.svelte-15r3ahw{background:var(--jse-panel-button-background-highlight);color:var(--jse-panel-button-color-highlight);transition:color 0.2s ease-in, background 0.2s ease-in}.jse-navigation-bar.svelte-15r3ahw .jse-navigation-bar-edit .jse-navigation-bar-space.svelte-15r3ahw{flex:1;text-align:left}");}function get_each_context$6(ctx,list,i){var child_ctx=ctx.slice();child_ctx[20]=list[i];child_ctx[22]=i;return child_ctx;}// (81:2) {:else}
function create_else_block$8(ctx){var navigationbarpatheditor;var current;navigationbarpatheditor=new NavigationBarPathEditor$1({props:{path:/*path*/ctx[3],onClose:/*handleCloseEditor*/ctx[12],onChange:/*handleChangePath*/ctx[13],onError:/*onError*/ctx[1],pathExists:/*pathExists*/ctx[9],pathParser:/*pathParser*/ctx[2]}});return{c:function c(){create_component(navigationbarpatheditor.$$.fragment);},m:function m(target,anchor){mount_component(navigationbarpatheditor,target,anchor);current=true;},p:function p(ctx,dirty){var navigationbarpatheditor_changes={};if(dirty&/*path*/8)navigationbarpatheditor_changes.path=/*path*/ctx[3];if(dirty&/*onError*/2)navigationbarpatheditor_changes.onError=/*onError*/ctx[1];if(dirty&/*pathParser*/4)navigationbarpatheditor_changes.pathParser=/*pathParser*/ctx[2];navigationbarpatheditor.$set(navigationbarpatheditor_changes);},i:function i(local){if(current)return;transition_in(navigationbarpatheditor.$$.fragment,local);current=true;},o:function o(local){transition_out(navigationbarpatheditor.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(navigationbarpatheditor,detaching);}};}// (74:2) {#if !editing}
function create_if_block$b(ctx){var each_blocks=[];var each_1_lookup=new Map();var t;var if_block_anchor;var current;var each_value=/*path*/ctx[3];var get_key=function get_key(ctx){return(/*index*/ctx[22]);};for(var _i285=0;_i285<each_value.length;_i285+=1){var child_ctx=get_each_context$6(ctx,each_value,_i285);var key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[_i285]=create_each_block$6(key,child_ctx));}var if_block=/*hasNextItem*/ctx[7]&&create_if_block_1$6(ctx);return{c:function c(){for(var _i286=0;_i286<each_blocks.length;_i286+=1){each_blocks[_i286].c();}t=space();if(if_block)if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){for(var _i287=0;_i287<each_blocks.length;_i287+=1){each_blocks[_i287].m(target,anchor);}insert$2(target,t,anchor);if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){if(dirty&/*getItems, path, handleSelect*/1288){each_value=/*path*/ctx[3];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,t.parentNode,outro_and_destroy_block,create_each_block$6,t,get_each_context$6);check_outros();}if(/*hasNextItem*/ctx[7]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*hasNextItem*/128){transition_in(if_block,1);}}else{if_block=create_if_block_1$6(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;for(var _i288=0;_i288<each_value.length;_i288+=1){transition_in(each_blocks[_i288]);}transition_in(if_block);current=true;},o:function o(local){for(var _i289=0;_i289<each_blocks.length;_i289+=1){transition_out(each_blocks[_i289]);}transition_out(if_block);current=false;},d:function d(detaching){for(var _i290=0;_i290<each_blocks.length;_i290+=1){each_blocks[_i290].d(detaching);}if(detaching)detach(t);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (75:4) {#each path as item, index (index)}
function create_each_block$6(key_1,ctx){var first;var navigationbaritem;var current;navigationbaritem=new NavigationBarItem$1({props:{getItems:/*getItems*/ctx[8],path:/*path*/ctx[3],index:/*index*/ctx[22],onSelect:/*handleSelect*/ctx[10]}});return{key:key_1,first:null,c:function c(){first=empty$1();create_component(navigationbaritem.$$.fragment);this.first=first;},m:function m(target,anchor){insert$2(target,first,anchor);mount_component(navigationbaritem,target,anchor);current=true;},p:function p(new_ctx,dirty){ctx=new_ctx;var navigationbaritem_changes={};if(dirty&/*path*/8)navigationbaritem_changes.path=/*path*/ctx[3];if(dirty&/*path*/8)navigationbaritem_changes.index=/*index*/ctx[22];navigationbaritem.$set(navigationbaritem_changes);},i:function i(local){if(current)return;transition_in(navigationbaritem.$$.fragment,local);current=true;},o:function o(local){transition_out(navigationbaritem.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(first);destroy_component(navigationbaritem,detaching);}};}// (78:4) {#if hasNextItem}
function create_if_block_1$6(ctx){var navigationbaritem;var current;navigationbaritem=new NavigationBarItem$1({props:{getItems:/*getItems*/ctx[8],path:/*path*/ctx[3],index:undefined,onSelect:/*handleSelect*/ctx[10]}});return{c:function c(){create_component(navigationbaritem.$$.fragment);},m:function m(target,anchor){mount_component(navigationbaritem,target,anchor);current=true;},p:function p(ctx,dirty){var navigationbaritem_changes={};if(dirty&/*path*/8)navigationbaritem_changes.path=/*path*/ctx[3];navigationbaritem.$set(navigationbaritem_changes);},i:function i(local){if(current)return;transition_in(navigationbaritem.$$.fragment,local);current=true;},o:function o(local){transition_out(navigationbaritem.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(navigationbaritem,detaching);}};}function create_fragment$m(ctx){var div;var current_block_type_index;var if_block;var t0;var button;var span;var t1_value=(!isObjectOrArray(/*json*/ctx[0])&&!/*editing*/ctx[6]?'Navigation bar':"\xA0")+"";var t1;var t2;var icon;var button_title_value;var current;var mounted;var dispose;var if_block_creators=[create_if_block$b,create_else_block$8];var if_blocks=[];function select_block_type(ctx,dirty){if(!/*editing*/ctx[6])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);icon=new Icon({props:{data:/*editing*/ctx[6]?faClose:faEdit}});return{c:function c(){div=element("div");if_block.c();t0=space();button=element("button");span=element("span");t1=text(t1_value);t2=space();create_component(icon.$$.fragment);attr(span,"class","jse-navigation-bar-space svelte-15r3ahw");attr(button,"type","button");attr(button,"class","jse-navigation-bar-edit svelte-15r3ahw");attr(button,"title",button_title_value=/*editing*/ctx[6]?'Cancel editing the selected path':'Edit the selected path');toggle_class(button,"flex",!/*editing*/ctx[6]);toggle_class(button,"editing",/*editing*/ctx[6]);attr(div,"class","jse-navigation-bar svelte-15r3ahw");},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);append$1(div,t0);append$1(div,button);append$1(button,span);append$1(span,t1);append$1(button,t2);mount_component(icon,button,null);/*button_binding*/ctx[16](button);/*div_binding*/ctx[17](div);current=true;if(!mounted){dispose=listen(button,"click",/*toggleEditing*/ctx[11]);mounted=true;}},p:function p(ctx,_ref143){var _ref144=_slicedToArray(_ref143,1),dirty=_ref144[0];var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,t0);}if((!current||dirty&/*json, editing*/65)&&t1_value!==(t1_value=(!isObjectOrArray(/*json*/ctx[0])&&!/*editing*/ctx[6]?'Navigation bar':"\xA0")+""))set_data(t1,t1_value);var icon_changes={};if(dirty&/*editing*/64)icon_changes.data=/*editing*/ctx[6]?faClose:faEdit;icon.$set(icon_changes);if(!current||dirty&/*editing*/64&&button_title_value!==(button_title_value=/*editing*/ctx[6]?'Cancel editing the selected path':'Edit the selected path')){attr(button,"title",button_title_value);}if(!current||dirty&/*editing*/64){toggle_class(button,"flex",!/*editing*/ctx[6]);}if(!current||dirty&/*editing*/64){toggle_class(button,"editing",/*editing*/ctx[6]);}},i:function i(local){if(current)return;transition_in(if_block);transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(if_block);transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();destroy_component(icon);/*button_binding*/ctx[16](null);/*div_binding*/ctx[17](null);mounted=false;dispose();}};}function instance$m($$self,$$props,$$invalidate){var path;var hasNextItem;var debug=createDebug('jsoneditor:NavigationBar');var json=$$props.json;var documentState=$$props.documentState;var onSelect=$$props.onSelect;var onError=$$props.onError;var pathParser=$$props.pathParser;var refNavigationBar;var refEditButton;var editing=false;function scrollToLastItem(){setTimeout(function(){if(refNavigationBar&&refNavigationBar.scrollTo){var left=refNavigationBar.scrollWidth-refNavigationBar.clientWidth;if(left>0){debug('scrollTo ',left);refNavigationBar.scrollTo({left:left,behavior:'smooth'});}}});}function getItems(path){debug('get items for path',path);var node=immutableJSONPatch.exports.getIn(json,path);if(Array.isArray(node)){return range(0,node.length).map(String);}else if(isObject$1(node)){var _keys21=Object.keys(node);var sortedKeys=_keys21.slice(0);sortedKeys.sort(caseInsensitiveNaturalCompare);return sortedKeys;}else{// never happens but just for robustness...
return[];}}function pathExists(path){return immutableJSONPatch.exports.existsIn(json,path);}function handleSelect(path){debug('select path',JSON.stringify(path));onSelect(createMultiSelection(json,path,path));}function toggleEditing(){$$invalidate(6,editing=!editing);}function handleCloseEditor(){$$invalidate(6,editing=false);}function handleChangePath(path){handleCloseEditor();handleSelect(path);}function button_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refEditButton=$$value;$$invalidate(5,refEditButton);});}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refNavigationBar=$$value;$$invalidate(4,refNavigationBar);});}$$self.$$set=function($$props){if('json'in $$props)$$invalidate(0,json=$$props.json);if('documentState'in $$props)$$invalidate(14,documentState=$$props.documentState);if('onSelect'in $$props)$$invalidate(15,onSelect=$$props.onSelect);if('onError'in $$props)$$invalidate(1,onError=$$props.onError);if('pathParser'in $$props)$$invalidate(2,pathParser=$$props.pathParser);};$$self.$$.update=function(){if($$self.$$.dirty&/*documentState*/16384){$$invalidate(3,path=documentState.selection?documentState.selection.focusPath:[]);}if($$self.$$.dirty&/*json, path*/9){$$invalidate(7,hasNextItem=isObjectOrArray(immutableJSONPatch.exports.getIn(json,path)));}if($$self.$$.dirty&/*path*/8){// trigger scrollToLastItem when path changes
scrollToLastItem();}};return[json,onError,pathParser,path,refNavigationBar,refEditButton,editing,hasNextItem,getItems,pathExists,handleSelect,toggleEditing,handleCloseEditor,handleChangePath,documentState,onSelect,button_binding,div_binding];}var NavigationBar=/*#__PURE__*/function(_SvelteComponent36){_inherits(NavigationBar,_SvelteComponent36);var _super77=_createSuper(NavigationBar);function NavigationBar(options){var _this131;_classCallCheck(this,NavigationBar);_this131=_super77.call(this);init(_assertThisInitialized(_this131),options,instance$m,create_fragment$m,not_equal,{json:0,documentState:14,onSelect:15,onError:1,pathParser:2},add_css$k);return _this131;}return _createClass(NavigationBar);}(SvelteComponent);var NavigationBar$1=NavigationBar;/* src/lib/components/modes/treemode/menu/SearchBox.svelte generated by Svelte v3.51.0 */function add_css$j(target){append_styles(target,"svelte-18vllqh",".jse-search-box.svelte-18vllqh.svelte-18vllqh{border:var(--jse-panel-border);border-radius:3px;font-family:var(--jse-font-family);font-size:var(--jse-font-size);background:var(--jse-panel-background);color:var(--jse-panel-color-readonly);box-shadow:var(--jse-controls-box-shadow);display:inline-block;width:400px;max-width:100%;overflow:auto}.jse-search-box.svelte-18vllqh .jse-search-form.svelte-18vllqh{display:flex;align-items:stretch}.jse-search-box.svelte-18vllqh .jse-search-form button.svelte-18vllqh,.jse-search-box.svelte-18vllqh .jse-search-form input.svelte-18vllqh{font-family:inherit;font-size:inherit}.jse-search-box.svelte-18vllqh .jse-search-form button.svelte-18vllqh{display:block;text-align:center;border:none;padding:0 5px;margin:0;cursor:pointer;color:var(--jse-panel-button-color);background:var(--jse-panel-button-background)}.jse-search-box.svelte-18vllqh .jse-search-form button.svelte-18vllqh:hover{color:var(--jse-panel-button-color-highlight);background:var(--jse-panel-button-background-highlight)}.jse-search-box.svelte-18vllqh .jse-search-form input.svelte-18vllqh{color:var(--jse-panel-color);border:var(--jse-input-border);border-radius:3px;background:var(--jse-input-background);height:28px;padding:0 5px;margin:0;flex:1;outline:none}.jse-search-box.svelte-18vllqh .jse-search-form .jse-replace-toggle.svelte-18vllqh{padding:var(--jse-padding) calc(0.5 * var(--jse-padding));min-width:20px;background:var(--jse-panel-button-background-highlight)}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents.svelte-18vllqh{flex:1;display:flex;flex-direction:column;padding:calc(0.5 * var(--jse-padding));gap:calc(0.5 * var(--jse-padding))}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-search-section.svelte-18vllqh{flex:1;display:flex;align-items:center;position:relative;padding-left:32px}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-search-section .jse-search-icon.svelte-18vllqh{color:inherit;cursor:inherit;background:inherit;position:absolute;top:calc(0.5 * var(--jse-padding));left:calc(0.5 * var(--jse-padding))}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-search-section label.jse-search-input-label.svelte-18vllqh{flex:1;display:flex}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-search-section .jse-search-count.svelte-18vllqh{color:inherit;font-size:80%;visibility:hidden;padding:0 5px;min-width:36px;text-align:center}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-search-section .jse-search-count.jse-visible.svelte-18vllqh{visibility:visible}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-replace-section.svelte-18vllqh{padding-left:32px;flex:1;display:flex}.jse-search-box.svelte-18vllqh .jse-search-form .jse-search-contents .jse-replace-section button.svelte-18vllqh{width:auto}");}// (99:0) {#if show}
function create_if_block$a(ctx){var div4;var form;var t0;var div3;var div2;var div0;var current_block_type_index;var if_block1;var t1;var label;var input;var t2;var div1;var t3_value=(/*activeIndex*/ctx[3]!==-1?"".concat(/*activeIndex*/ctx[3]+1,"/"):'')+"";var t3;var t4;var t5;var button0;var icon0;var t6;var button1;var icon1;var t7;var button2;var icon2;var t8;var current;var mounted;var dispose;var if_block0=!/*readOnly*/ctx[4]&&create_if_block_3$3(ctx);var if_block_creators=[create_if_block_2$4,create_else_block$7];var if_blocks=[];function select_block_type(ctx,dirty){if(/*searching*/ctx[2])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block1=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);icon0=new Icon({props:{data:faChevronDown}});icon1=new Icon({props:{data:faChevronUp}});icon2=new Icon({props:{data:faTimes}});var if_block2=/*showReplace*/ctx[0]&&!/*readOnly*/ctx[4]&&create_if_block_1$5(ctx);return{c:function c(){div4=element("div");form=element("form");if(if_block0)if_block0.c();t0=space();div3=element("div");div2=element("div");div0=element("div");if_block1.c();t1=space();label=element("label");input=element("input");t2=space();div1=element("div");t3=text(t3_value);t4=text(/*formattedResultCount*/ctx[10]);t5=space();button0=element("button");create_component(icon0.$$.fragment);t6=space();button1=element("button");create_component(icon1.$$.fragment);t7=space();button2=element("button");create_component(icon2.$$.fragment);t8=space();if(if_block2)if_block2.c();attr(div0,"class","jse-search-icon svelte-18vllqh");attr(input,"class","jse-search-input svelte-18vllqh");attr(input,"title","Enter text to search");attr(input,"type","text");attr(input,"placeholder","Find");attr(label,"class","jse-search-input-label svelte-18vllqh");attr(label,"about","jse-search input");attr(div1,"class","jse-search-count svelte-18vllqh");toggle_class(div1,"jse-visible",/*text*/ctx[8]!=='');attr(button0,"type","button");attr(button0,"class","jse-search-next svelte-18vllqh");attr(button0,"title","Go to next search result (Enter)");attr(button1,"type","button");attr(button1,"class","jse-search-previous svelte-18vllqh");attr(button1,"title","Go to previous search result (Shift+Enter)");attr(button2,"type","button");attr(button2,"class","jse-search-clear svelte-18vllqh");attr(button2,"title","Close search box (Esc)");attr(div2,"class","jse-search-section svelte-18vllqh");attr(div3,"class","jse-search-contents svelte-18vllqh");attr(form,"class","jse-search-form svelte-18vllqh");attr(div4,"class","jse-search-box svelte-18vllqh");},m:function m(target,anchor){insert$2(target,div4,anchor);append$1(div4,form);if(if_block0)if_block0.m(form,null);append$1(form,t0);append$1(form,div3);append$1(div3,div2);append$1(div2,div0);if_blocks[current_block_type_index].m(div0,null);append$1(div2,t1);append$1(div2,label);append$1(label,input);set_input_value(input,/*text*/ctx[8]);append$1(div2,t2);append$1(div2,div1);append$1(div1,t3);append$1(div1,t4);append$1(div2,t5);append$1(div2,button0);mount_component(icon0,button0,null);append$1(div2,t6);append$1(div2,button1);mount_component(icon1,button1,null);append$1(div2,t7);append$1(div2,button2);mount_component(icon2,button2,null);append$1(div3,t8);if(if_block2)if_block2.m(div3,null);current=true;if(!mounted){dispose=[listen(input,"input",/*input_input_handler*/ctx[21]),action_destroyer(initSearchInput.call(null,input)),listen(button0,"click",/*click_handler*/ctx[22]),listen(button1,"click",/*click_handler_1*/ctx[23]),listen(button2,"click",/*click_handler_2*/ctx[24]),listen(form,"submit",/*handleSubmit*/ctx[12]),listen(form,"keydown",/*handleKeyDown*/ctx[13])];mounted=true;}},p:function p(ctx,dirty){if(!/*readOnly*/ctx[4]){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*readOnly*/16){transition_in(if_block0,1);}}else{if_block0=create_if_block_3$3(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(form,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block1=if_blocks[current_block_type_index];if(!if_block1){if_block1=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block1.c();}else{if_block1.p(ctx,dirty);}transition_in(if_block1,1);if_block1.m(div0,null);}if(dirty&/*text*/256&&input.value!==/*text*/ctx[8]){set_input_value(input,/*text*/ctx[8]);}if((!current||dirty&/*activeIndex*/8)&&t3_value!==(t3_value=(/*activeIndex*/ctx[3]!==-1?"".concat(/*activeIndex*/ctx[3]+1,"/"):'')+""))set_data(t3,t3_value);if(!current||dirty&/*formattedResultCount*/1024)set_data(t4,/*formattedResultCount*/ctx[10]);if(!current||dirty&/*text*/256){toggle_class(div1,"jse-visible",/*text*/ctx[8]!=='');}if(/*showReplace*/ctx[0]&&!/*readOnly*/ctx[4]){if(if_block2){if_block2.p(ctx,dirty);}else{if_block2=create_if_block_1$5(ctx);if_block2.c();if_block2.m(div3,null);}}else if(if_block2){if_block2.d(1);if_block2=null;}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(icon0.$$.fragment,local);transition_in(icon1.$$.fragment,local);transition_in(icon2.$$.fragment,local);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);transition_out(icon0.$$.fragment,local);transition_out(icon1.$$.fragment,local);transition_out(icon2.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div4);if(if_block0)if_block0.d();if_blocks[current_block_type_index].d();destroy_component(icon0);destroy_component(icon1);destroy_component(icon2);if(if_block2)if_block2.d();mounted=false;run_all(dispose);}};}// (102:6) {#if !readOnly}
function create_if_block_3$3(ctx){var button;var icon;var current;var mounted;var dispose;icon=new Icon({props:{data:/*showReplace*/ctx[0]?faCaretDown:faCaretRight}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-replace-toggle svelte-18vllqh");attr(button,"title","Toggle visibility of replace options (Ctrl+H)");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);current=true;if(!mounted){dispose=listen(button,"click",/*toggleShowReplace*/ctx[11]);mounted=true;}},p:function p(ctx,dirty){var icon_changes={};if(dirty&/*showReplace*/1)icon_changes.data=/*showReplace*/ctx[0]?faCaretDown:faCaretRight;icon.$set(icon_changes);},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);mounted=false;dispose();}};}// (117:12) {:else}
function create_else_block$7(ctx){var icon;var current;icon=new Icon({props:{data:faSearch}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (115:12) {#if searching}
function create_if_block_2$4(ctx){var icon;var current;icon=new Icon({props:{data:faCircleNotch,spin:true}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (159:8) {#if showReplace && !readOnly}
function create_if_block_1$5(ctx){var div;var input;var t0;var button0;var t2;var button1;var mounted;var dispose;return{c:function c(){div=element("div");input=element("input");t0=space();button0=element("button");button0.textContent="Replace";t2=space();button1=element("button");button1.textContent="All";attr(input,"class","jse-replace-input svelte-18vllqh");attr(input,"title","Enter replacement text");attr(input,"type","text");attr(input,"placeholder","Replace");attr(button0,"type","button");attr(button0,"title","Replace current occurrence (Ctrl+Enter)");attr(button0,"class","svelte-18vllqh");attr(button1,"type","button");attr(button1,"title","Replace all occurrences");attr(button1,"class","svelte-18vllqh");attr(div,"class","jse-replace-section svelte-18vllqh");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,input);set_input_value(input,/*replaceText*/ctx[9]);append$1(div,t0);append$1(div,button0);append$1(div,t2);append$1(div,button1);if(!mounted){dispose=[listen(input,"input",/*input_input_handler_1*/ctx[25]),listen(button0,"click",/*handleReplace*/ctx[14]),listen(button1,"click",/*handleReplaceAll*/ctx[15])];mounted=true;}},p:function p(ctx,dirty){if(dirty&/*replaceText*/512&&input.value!==/*replaceText*/ctx[9]){set_input_value(input,/*replaceText*/ctx[9]);}},d:function d(detaching){if(detaching)detach(div);mounted=false;run_all(dispose);}};}function create_fragment$l(ctx){var if_block_anchor;var current;var if_block=/*show*/ctx[1]&&create_if_block$a(ctx);return{c:function c(){if(if_block)if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,_ref145){var _ref146=_slicedToArray(_ref145,1),dirty=_ref146[0];if(/*show*/ctx[1]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*show*/2){transition_in(if_block,1);}}else{if_block=create_if_block$a(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}function initSearchInput(element){element.select();}function instance$l($$self,$$props,$$invalidate){var formattedResultCount;var onChangeDebounced;var _$$props$show2=$$props.show,show=_$$props$show2===void 0?false:_$$props$show2;var searching=$$props.searching;var _$$props$resultCount=$$props.resultCount,resultCount=_$$props$resultCount===void 0?0:_$$props$resultCount;var _$$props$activeIndex=$$props.activeIndex,activeIndex=_$$props$activeIndex===void 0?0:_$$props$activeIndex;var _$$props$showReplace=$$props.showReplace,showReplace=_$$props$showReplace===void 0?false:_$$props$showReplace;var _$$props$readOnly3=$$props.readOnly,readOnly=_$$props$readOnly3===void 0?false:_$$props$readOnly3;var _$$props$onChange2=$$props.onChange,onChange=_$$props$onChange2===void 0?noop:_$$props$onChange2;var _$$props$onPrevious=$$props.onPrevious,onPrevious=_$$props$onPrevious===void 0?noop:_$$props$onPrevious;var _$$props$onNext=$$props.onNext,onNext=_$$props$onNext===void 0?noop:_$$props$onNext;var _$$props$onReplace=$$props.onReplace,onReplace=_$$props$onReplace===void 0?noop:_$$props$onReplace;var _$$props$onReplaceAll=$$props.onReplaceAll,onReplaceAll=_$$props$onReplaceAll===void 0?noop:_$$props$onReplaceAll;var _$$props$onClose=$$props.onClose,onClose=_$$props$onClose===void 0?noop:_$$props$onClose;var text='';var previousText='';var replaceText='';function initShow(){if(text!==''){onChange(text);}}function toggleShowReplace(){$$invalidate(0,showReplace=!showReplace&&!readOnly);}function handleSubmit(event){event.preventDefault();var pendingChanges=text!==previousText;if(pendingChanges){previousText=text;onChangeDebounced.cancel();onChange(text);}else{onNext();}}function handleKeyDown(event){// key events must not be handled by the generic keydown handler of the
// whole JSONEditor.
event.stopPropagation();var combo=keyComboFromEvent(event);if(combo==='Enter'){event.preventDefault();onNext();}if(combo==='Shift+Enter'){event.preventDefault();onPrevious();}if(combo==='Ctrl+Enter'||combo==='Command+Enter'){event.preventDefault();if(showReplace){handleReplace();}else{onNext();}// TODO: move focus to the active element
}if(combo==='Ctrl+H'){event.preventDefault();toggleShowReplace();}if(combo==='Escape'){event.preventDefault();onClose();}}function handleReplace(){if(readOnly){return;}onReplace(text,replaceText);}function handleReplaceAll(){if(readOnly){return;}onReplaceAll(text,replaceText);}function input_input_handler(){text=this.value;$$invalidate(8,text);}var click_handler=function click_handler(){return onNext();};var click_handler_1=function click_handler_1(){return onPrevious();};var click_handler_2=function click_handler_2(){return onClose();};function input_input_handler_1(){replaceText=this.value;$$invalidate(9,replaceText);}$$self.$$set=function($$props){if('show'in $$props)$$invalidate(1,show=$$props.show);if('searching'in $$props)$$invalidate(2,searching=$$props.searching);if('resultCount'in $$props)$$invalidate(16,resultCount=$$props.resultCount);if('activeIndex'in $$props)$$invalidate(3,activeIndex=$$props.activeIndex);if('showReplace'in $$props)$$invalidate(0,showReplace=$$props.showReplace);if('readOnly'in $$props)$$invalidate(4,readOnly=$$props.readOnly);if('onChange'in $$props)$$invalidate(17,onChange=$$props.onChange);if('onPrevious'in $$props)$$invalidate(5,onPrevious=$$props.onPrevious);if('onNext'in $$props)$$invalidate(6,onNext=$$props.onNext);if('onReplace'in $$props)$$invalidate(18,onReplace=$$props.onReplace);if('onReplaceAll'in $$props)$$invalidate(19,onReplaceAll=$$props.onReplaceAll);if('onClose'in $$props)$$invalidate(7,onClose=$$props.onClose);};$$self.$$.update=function(){if($$self.$$.dirty&/*resultCount*/65536){$$invalidate(10,formattedResultCount=resultCount>=MAX_SEARCH_RESULTS?"".concat(MAX_SEARCH_RESULTS-1,"+"):String(resultCount));}if($$self.$$.dirty&/*onChange*/131072){$$invalidate(20,onChangeDebounced=debounce$1(onChange,DEBOUNCE_DELAY));}if($$self.$$.dirty&/*onChangeDebounced, text*/1048832){onChangeDebounced(text);}if($$self.$$.dirty&/*show*/2){if(show){initShow();}}};return[showReplace,show,searching,activeIndex,readOnly,onPrevious,onNext,onClose,text,replaceText,formattedResultCount,toggleShowReplace,handleSubmit,handleKeyDown,handleReplace,handleReplaceAll,resultCount,onChange,onReplace,onReplaceAll,onChangeDebounced,input_input_handler,click_handler,click_handler_1,click_handler_2,input_input_handler_1];}var SearchBox=/*#__PURE__*/function(_SvelteComponent37){_inherits(SearchBox,_SvelteComponent37);var _super78=_createSuper(SearchBox);function SearchBox(options){var _this132;_classCallCheck(this,SearchBox);_this132=_super78.call(this);init(_assertThisInitialized(_this132),options,instance$l,create_fragment$l,not_equal,{show:1,searching:2,resultCount:16,activeIndex:3,showReplace:0,readOnly:4,onChange:17,onPrevious:5,onNext:6,onReplace:18,onReplaceAll:19,onClose:7},add_css$j);return _this132;}return _createClass(SearchBox);}(SvelteComponent);var SearchBox$1=SearchBox;/* src/lib/components/modes/treemode/TreeMode.svelte generated by Svelte v3.51.0 */var window_1=globals.window;function add_css$i(target){append_styles(target,"svelte-1chflnh",".jse-tree-mode.svelte-1chflnh.svelte-1chflnh{flex:1;display:flex;flex-direction:column;position:relative;background:var(--jse-background-color);min-width:0;min-height:0;font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:var(--jse-text-color);line-height:var(--jse-line-height)}.jse-tree-mode.svelte-1chflnh .jse-hidden-input-label.svelte-1chflnh{position:fixed;right:0;top:0;width:0;height:0}.jse-tree-mode.svelte-1chflnh .jse-hidden-input-label .jse-hidden-input.svelte-1chflnh{width:0;height:0;padding:0;border:0;outline:none}.jse-tree-mode.svelte-1chflnh .jse-search-box-container.svelte-1chflnh{position:relative;height:0;top:var(--jse-padding);margin-right:calc(var(--jse-padding) + 20px);margin-left:var(--jse-padding);text-align:right;z-index:3}.jse-tree-mode.no-main-menu.svelte-1chflnh.svelte-1chflnh{border-top:var(--jse-main-border)}.jse-tree-mode.svelte-1chflnh .jse-contents.svelte-1chflnh{border-left:var(--jse-main-border);border-right:var(--jse-main-border);flex:1;overflow:auto;position:relative;padding:2px;display:flex;flex-direction:column}.jse-tree-mode.svelte-1chflnh .jse-contents.svelte-1chflnh:last-child{border-bottom:var(--jse-main-border)}.jse-tree-mode.svelte-1chflnh .jse-contents .jse-loading-space.svelte-1chflnh{flex:1}.jse-tree-mode.svelte-1chflnh .jse-contents .jse-loading.svelte-1chflnh{flex:2;text-align:center;color:var(--jse-panel-color-readonly);box-sizing:border-box;font-family:var(--jse-font-family);font-size:var(--jse-font-size)}.jse-tree-mode.svelte-1chflnh .jse-preview.svelte-1chflnh{flex:1;color:var(--jse-panel-color-readonly);overflow:auto;white-space:pre-wrap;padding:2px}");}// (1743:2) {#if mainMenuBar}
function create_if_block_6$1(ctx){var treemenu;var updating_showSearch;var current;function treemenu_showSearch_binding(value){/*treemenu_showSearch_binding*/ctx[73](value);}var treemenu_props={json:/*json*/ctx[9],selection:/*documentState*/ctx[15].selection,readOnly:/*readOnly*/ctx[0],historyState:/*historyState*/ctx[21],onExpandAll:/*handleExpandAll*/ctx[39],onCollapseAll:/*handleCollapseAll*/ctx[40],onUndo:/*handleUndo*/ctx[35],onRedo:/*handleRedo*/ctx[36],onSort:/*handleSortAll*/ctx[37],onTransform:/*handleTransformAll*/ctx[38],onContextMenu:/*handleContextMenuFromTreeMenu*/ctx[44],onCopy:/*handleCopy*/ctx[33],onRenderMenu:/*onRenderMenu*/ctx[6]};if(/*showSearch*/ctx[18]!==void 0){treemenu_props.showSearch=/*showSearch*/ctx[18];}treemenu=new TreeMenu$1({props:treemenu_props});binding_callbacks.push(function(){return bind$2(treemenu,'showSearch',treemenu_showSearch_binding);});return{c:function c(){create_component(treemenu.$$.fragment);},m:function m(target,anchor){mount_component(treemenu,target,anchor);current=true;},p:function p(ctx,dirty){var treemenu_changes={};if(dirty[0]&/*json*/512)treemenu_changes.json=/*json*/ctx[9];if(dirty[0]&/*documentState*/32768)treemenu_changes.selection=/*documentState*/ctx[15].selection;if(dirty[0]&/*readOnly*/1)treemenu_changes.readOnly=/*readOnly*/ctx[0];if(dirty[0]&/*historyState*/2097152)treemenu_changes.historyState=/*historyState*/ctx[21];if(dirty[0]&/*onRenderMenu*/64)treemenu_changes.onRenderMenu=/*onRenderMenu*/ctx[6];if(!updating_showSearch&&dirty[0]&/*showSearch*/262144){updating_showSearch=true;treemenu_changes.showSearch=/*showSearch*/ctx[18];add_flush_callback(function(){return updating_showSearch=false;});}treemenu.$set(treemenu_changes);},i:function i(local){if(current)return;transition_in(treemenu.$$.fragment,local);current=true;},o:function o(local){transition_out(treemenu.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(treemenu,detaching);}};}// (1762:2) {#if navigationBar}
function create_if_block_5$1(ctx){var navigationbar;var current;navigationbar=new NavigationBar$1({props:{json:/*json*/ctx[9],documentState:/*documentState*/ctx[15],onSelect:/*handleNavigationBarSelect*/ctx[47],onError:/*onError*/ctx[4],pathParser:/*pathParser*/ctx[3]}});return{c:function c(){create_component(navigationbar.$$.fragment);},m:function m(target,anchor){mount_component(navigationbar,target,anchor);current=true;},p:function p(ctx,dirty){var navigationbar_changes={};if(dirty[0]&/*json*/512)navigationbar_changes.json=/*json*/ctx[9];if(dirty[0]&/*documentState*/32768)navigationbar_changes.documentState=/*documentState*/ctx[15];if(dirty[0]&/*onError*/16)navigationbar_changes.onError=/*onError*/ctx[4];if(dirty[0]&/*pathParser*/8)navigationbar_changes.pathParser=/*pathParser*/ctx[3];navigationbar.$set(navigationbar_changes);},i:function i(local){if(current)return;transition_in(navigationbar.$$.fragment,local);current=true;},o:function o(local){transition_out(navigationbar.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(navigationbar,detaching);}};}// (1883:2) {:else}
function create_else_block_2$1(ctx){var div2;return{c:function c(){div2=element("div");div2.innerHTML="<div class=\"jse-loading-space svelte-1chflnh\"></div> \n      <div class=\"jse-loading svelte-1chflnh\">loading...</div>";attr(div2,"class","jse-contents svelte-1chflnh");},m:function m(target,anchor){insert$2(target,div2,anchor);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div2);}};}// (1772:2) {#if !isSSR}
function create_if_block$9(ctx){var label;var input;var t;var current_block_type_index;var if_block;var if_block_anchor;var current;var mounted;var dispose;var if_block_creators=[create_if_block_1$4,create_else_block_1$2];var if_blocks=[];function select_block_type_1(ctx,dirty){if(/*json*/ctx[9]===undefined)return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){label=element("label");input=element("input");t=space();if_block.c();if_block_anchor=empty$1();attr(input,"type","text");input.readOnly="readonly";attr(input,"tabindex","-1");attr(input,"class","jse-hidden-input svelte-1chflnh");attr(label,"class","jse-hidden-input-label svelte-1chflnh");},m:function m(target,anchor){insert$2(target,label,anchor);append$1(label,input);/*input_binding*/ctx[74](input);insert$2(target,t,anchor);if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;if(!mounted){dispose=listen(input,"paste",/*handlePaste*/ctx[34]);mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(label);/*input_binding*/ctx[74](null);if(detaching)detach(t);if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);mounted=false;dispose();}};}// (1804:4) {:else}
function create_else_block_1$2(ctx){var _ctx$,_ctx$$items,_ctx$2,_ctx$3;var div0;var searchbox;var t0;var div1;var jsonnode;var t1;var t2;var t3;var validationerrorsoverview;var current;searchbox=new SearchBox$1({props:{show:/*showSearch*/ctx[18],resultCount:/*searchResult*/((_ctx$=ctx[16])===null||_ctx$===void 0?void 0:(_ctx$$items=_ctx$.items)===null||_ctx$$items===void 0?void 0:_ctx$$items.length)||0,activeIndex:/*searchResult*/((_ctx$2=ctx[16])===null||_ctx$2===void 0?void 0:_ctx$2.activeIndex)||0,showReplace:/*showReplace*/ctx[19],searching:/*searching*/ctx[20],readOnly:/*readOnly*/ctx[0],onChange:/*handleSearchText*/ctx[26],onNext:/*handleNextSearchResult*/ctx[27],onPrevious:/*handlePreviousSearchResult*/ctx[28],onReplace:/*handleReplace*/ctx[29],onReplaceAll:/*handleReplaceAll*/ctx[30],onClose:/*clearSearchResult*/ctx[31]}});jsonnode=new JSONNode$1({props:{value:/*json*/ctx[9],path:/*rootPath*/ctx[25],expandedMap:/*documentState*/ctx[15].expandedMap,enforceStringMap:/*documentState*/ctx[15].enforceStringMap,visibleSectionsMap:/*documentState*/ctx[15].visibleSectionsMap,validationErrorsMap:/*validationErrorsMap*/ctx[23],searchResultItemsMap:/*searchResult*/(_ctx$3=ctx[16])===null||_ctx$3===void 0?void 0:_ctx$3.itemsMap,selection:/*documentState*/ctx[15].selection,context:/*context*/ctx[12],onDragSelectionStart:noop}});var if_block0=/*pastedJson*/ctx[17]&&create_if_block_4$1(ctx);var if_block1=/*textIsRepaired*/ctx[22]&&create_if_block_3$2(ctx);validationerrorsoverview=new ValidationErrorsOverview$1({props:{validationErrors:/*validationErrors*/ctx[11],selectError:/*handleSelectValidationError*/ctx[32]}});return{c:function c(){div0=element("div");create_component(searchbox.$$.fragment);t0=space();div1=element("div");create_component(jsonnode.$$.fragment);t1=space();if(if_block0)if_block0.c();t2=space();if(if_block1)if_block1.c();t3=space();create_component(validationerrorsoverview.$$.fragment);attr(div0,"class","jse-search-box-container svelte-1chflnh");attr(div1,"class","jse-contents svelte-1chflnh");attr(div1,"data-jsoneditor-scrollable-contents",true);},m:function m(target,anchor){insert$2(target,div0,anchor);mount_component(searchbox,div0,null);insert$2(target,t0,anchor);insert$2(target,div1,anchor);mount_component(jsonnode,div1,null);/*div1_binding*/ctx[75](div1);insert$2(target,t1,anchor);if(if_block0)if_block0.m(target,anchor);insert$2(target,t2,anchor);if(if_block1)if_block1.m(target,anchor);insert$2(target,t3,anchor);mount_component(validationerrorsoverview,target,anchor);current=true;},p:function p(ctx,dirty){var _ctx$4,_ctx$4$items,_ctx$5,_ctx$6;var searchbox_changes={};if(dirty[0]&/*showSearch*/262144)searchbox_changes.show=/*showSearch*/ctx[18];if(dirty[0]&/*searchResult*/65536)searchbox_changes.resultCount=/*searchResult*/((_ctx$4=ctx[16])===null||_ctx$4===void 0?void 0:(_ctx$4$items=_ctx$4.items)===null||_ctx$4$items===void 0?void 0:_ctx$4$items.length)||0;if(dirty[0]&/*searchResult*/65536)searchbox_changes.activeIndex=/*searchResult*/((_ctx$5=ctx[16])===null||_ctx$5===void 0?void 0:_ctx$5.activeIndex)||0;if(dirty[0]&/*showReplace*/524288)searchbox_changes.showReplace=/*showReplace*/ctx[19];if(dirty[0]&/*searching*/1048576)searchbox_changes.searching=/*searching*/ctx[20];if(dirty[0]&/*readOnly*/1)searchbox_changes.readOnly=/*readOnly*/ctx[0];searchbox.$set(searchbox_changes);var jsonnode_changes={};if(dirty[0]&/*json*/512)jsonnode_changes.value=/*json*/ctx[9];if(dirty[0]&/*documentState*/32768)jsonnode_changes.expandedMap=/*documentState*/ctx[15].expandedMap;if(dirty[0]&/*documentState*/32768)jsonnode_changes.enforceStringMap=/*documentState*/ctx[15].enforceStringMap;if(dirty[0]&/*documentState*/32768)jsonnode_changes.visibleSectionsMap=/*documentState*/ctx[15].visibleSectionsMap;if(dirty[0]&/*validationErrorsMap*/8388608)jsonnode_changes.validationErrorsMap=/*validationErrorsMap*/ctx[23];if(dirty[0]&/*searchResult*/65536)jsonnode_changes.searchResultItemsMap=/*searchResult*/(_ctx$6=ctx[16])===null||_ctx$6===void 0?void 0:_ctx$6.itemsMap;if(dirty[0]&/*documentState*/32768)jsonnode_changes.selection=/*documentState*/ctx[15].selection;if(dirty[0]&/*context*/4096)jsonnode_changes.context=/*context*/ctx[12];jsonnode.$set(jsonnode_changes);if(/*pastedJson*/ctx[17]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*pastedJson*/131072){transition_in(if_block0,1);}}else{if_block0=create_if_block_4$1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t2.parentNode,t2);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(/*textIsRepaired*/ctx[22]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*textIsRepaired*/4194304){transition_in(if_block1,1);}}else{if_block1=create_if_block_3$2(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(t3.parentNode,t3);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}var validationerrorsoverview_changes={};if(dirty[0]&/*validationErrors*/2048)validationerrorsoverview_changes.validationErrors=/*validationErrors*/ctx[11];validationerrorsoverview.$set(validationerrorsoverview_changes);},i:function i(local){if(current)return;transition_in(searchbox.$$.fragment,local);transition_in(jsonnode.$$.fragment,local);transition_in(if_block0);transition_in(if_block1);transition_in(validationerrorsoverview.$$.fragment,local);current=true;},o:function o(local){transition_out(searchbox.$$.fragment,local);transition_out(jsonnode.$$.fragment,local);transition_out(if_block0);transition_out(if_block1);transition_out(validationerrorsoverview.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div0);destroy_component(searchbox);if(detaching)detach(t0);if(detaching)detach(div1);destroy_component(jsonnode);/*div1_binding*/ctx[75](null);if(detaching)detach(t1);if(if_block0)if_block0.d(detaching);if(detaching)detach(t2);if(if_block1)if_block1.d(detaching);if(detaching)detach(t3);destroy_component(validationerrorsoverview,detaching);}};}// (1783:4) {#if json === undefined}
function create_if_block_1$4(ctx){var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block_2$3,create_else_block$6];var if_blocks=[];function select_block_type_2(ctx,dirty){if(/*text*/ctx[10]===''||/*text*/ctx[10]===undefined)return 0;return 1;}current_block_type_index=select_block_type_2(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_2(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (1836:6) {#if pastedJson}
function create_if_block_4$1(ctx){var message;var current;message=new Message$1({props:{type:"info",message:"You pasted a JSON ".concat(Array.isArray(/*pastedJson*/ctx[17].contents)?'array':'object'," as text"),actions:[{icon:faWrench,text:'Paste as JSON instead',// We use mousedown here instead of click: this message pops up
// whilst the user is editing a value. When clicking this button,
// the actual value is applied and the event is not propagated
// and an onClick on this button never happens.
onMouseDown:/*handleParsePastedJson*/ctx[45]},{text:'Leave as is',onClick:/*handleClearPastedJson*/ctx[46]}]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty[0]&/*pastedJson*/131072)message_changes.message="You pasted a JSON ".concat(Array.isArray(/*pastedJson*/ctx[17].contents)?'array':'object'," as text");message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}// (1860:6) {#if textIsRepaired}
function create_if_block_3$2(ctx){var message;var current;message=new Message$1({props:{type:"success",message:"The loaded JSON document was invalid but is successfully repaired.",actions:!/*readOnly*/ctx[0]?[{icon:faCheck,text:'Ok',onClick:/*acceptAutoRepair*/ctx[7]},{icon:faCode,text:'Repair manually instead',onClick:/*onRequestRepair*/ctx[5]}]:[]}});return{c:function c(){create_component(message.$$.fragment);},m:function m(target,anchor){mount_component(message,target,anchor);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty[0]&/*readOnly, onRequestRepair*/33)message_changes.actions=!/*readOnly*/ctx[0]?[{icon:faCheck,text:'Ok',onClick:/*acceptAutoRepair*/ctx[7]},{icon:faCode,text:'Repair manually instead',onClick:/*onRequestRepair*/ctx[5]}]:[];message.$set(message_changes);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);}};}// (1786:6) {:else}
function create_else_block$6(ctx){var message;var t0;var div;var t1_value=truncate(/*text*/ctx[10],MAX_CHARACTERS_TEXT_PREVIEW)+"";var t1;var current;message=new Message$1({props:{type:"error",message:"The loaded JSON document is invalid and could not be repaired automatically.",actions:!/*readOnly*/ctx[0]?[{icon:faCode,text:'Repair manually',onClick:/*onRequestRepair*/ctx[5]}]:[]}});return{c:function c(){create_component(message.$$.fragment);t0=space();div=element("div");t1=text(t1_value);attr(div,"class","jse-preview svelte-1chflnh");},m:function m(target,anchor){mount_component(message,target,anchor);insert$2(target,t0,anchor);insert$2(target,div,anchor);append$1(div,t1);current=true;},p:function p(ctx,dirty){var message_changes={};if(dirty[0]&/*readOnly, onRequestRepair*/33)message_changes.actions=!/*readOnly*/ctx[0]?[{icon:faCode,text:'Repair manually',onClick:/*onRequestRepair*/ctx[5]}]:[];message.$set(message_changes);if((!current||dirty[0]&/*text*/1024)&&t1_value!==(t1_value=truncate(/*text*/ctx[10],MAX_CHARACTERS_TEXT_PREVIEW)+""))set_data(t1,t1_value);},i:function i(local){if(current)return;transition_in(message.$$.fragment,local);current=true;},o:function o(local){transition_out(message.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(message,detaching);if(detaching)detach(t0);if(detaching)detach(div);}};}// (1784:6) {#if text === '' || text === undefined}
function create_if_block_2$3(ctx){var welcome;var current;welcome=new Welcome$1({props:{readOnly:/*readOnly*/ctx[0]}});return{c:function c(){create_component(welcome.$$.fragment);},m:function m(target,anchor){mount_component(welcome,target,anchor);current=true;},p:function p(ctx,dirty){var welcome_changes={};if(dirty[0]&/*readOnly*/1)welcome_changes.readOnly=/*readOnly*/ctx[0];welcome.$set(welcome_changes);},i:function i(local){if(current)return;transition_in(welcome.$$.fragment,local);current=true;},o:function o(local){transition_out(welcome.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(welcome,detaching);}};}function create_fragment$k(ctx){var div;var t0;var t1;var current_block_type_index;var if_block2;var current;var mounted;var dispose;var if_block0=/*mainMenuBar*/ctx[1]&&create_if_block_6$1(ctx);var if_block1=/*navigationBar*/ctx[2]&&create_if_block_5$1(ctx);var if_block_creators=[create_if_block$9,create_else_block_2$1];var if_blocks=[];function select_block_type(ctx,dirty){if(!/*isSSR*/ctx[24])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if_block2.c();attr(div,"class","jse-tree-mode svelte-1chflnh");toggle_class(div,"no-main-menu",!/*mainMenuBar*/ctx[1]);},m:function m(target,anchor){insert$2(target,div,anchor);if(if_block0)if_block0.m(div,null);append$1(div,t0);if(if_block1)if_block1.m(div,null);append$1(div,t1);if_blocks[current_block_type_index].m(div,null);/*div_binding*/ctx[76](div);current=true;if(!mounted){dispose=[listen(window_1,"mousedown",/*handleWindowMouseDown*/ctx[48]),listen(div,"keydown",/*handleKeyDown*/ctx[41]),listen(div,"mousedown",/*handleMouseDown*/ctx[42]),listen(div,"contextmenu",/*handleContextMenu*/ctx[43])];mounted=true;}},p:function p(ctx,dirty){if(/*mainMenuBar*/ctx[1]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*mainMenuBar*/2){transition_in(if_block0,1);}}else{if_block0=create_if_block_6$1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(/*navigationBar*/ctx[2]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*navigationBar*/4){transition_in(if_block1,1);}}else{if_block1=create_if_block_5$1(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div,t1);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if_block2.p(ctx,dirty);if(!current||dirty[0]&/*mainMenuBar*/2){toggle_class(div,"no-main-menu",!/*mainMenuBar*/ctx[1]);}},i:function i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);current=true;},o:function o(local){transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);current=false;},d:function d(detaching){if(detaching)detach(div);if(if_block0)if_block0.d();if(if_block1)if_block1.d();if_blocks[current_block_type_index].d();/*div_binding*/ctx[76](null);mounted=false;run_all(dispose);}};}function expandMinimal(path){return path.length===0?true:path.length===1&&path[0]==='0';// first item of an array
}function expandAll(){return true;}function instance$k($$self,$$props,$$invalidate){var autoScrollHandler;var debug=createDebug('jsoneditor:TreeMode');var isSSR=typeof window==='undefined';debug('isSSR:',isSSR);var _getContext5=getContext('simple-modal'),open=_getContext5.open;var sortModalId=uniqueId();var transformModalId=uniqueId();var _getContext6=getContext('absolute-popup'),openAbsolutePopup=_getContext6.openAbsolutePopup,closeAbsolutePopup=_getContext6.closeAbsolutePopup;var refContents;var refHiddenInput;var refJsonEditor;var hasFocus=false;var jump=createJump();var readOnly=$$props.readOnly;var externalContent=$$props.externalContent;var mainMenuBar=$$props.mainMenuBar;var navigationBar=$$props.navigationBar;var escapeControlCharacters=$$props.escapeControlCharacters;var escapeUnicodeCharacters=$$props.escapeUnicodeCharacters;var parser=$$props.parser;var validator=$$props.validator;var validationParser=$$props.validationParser;var pathParser=$$props.pathParser;var indentation=$$props.indentation;var onError=$$props.onError;var onChange=$$props.onChange;var onRenderValue=$$props.onRenderValue;var onRequestRepair=$$props.onRequestRepair;var onRenderMenu=$$props.onRenderMenu;var onClassName=$$props.onClassName;var _onFocus=$$props.onFocus;var _onBlur=$$props.onBlur;var onSortModal=$$props.onSortModal;var onTransformModal=$$props.onTransformModal;// modalOpen is true when one of the modals is open.
// This is used to track whether the editor still has focus
var modalOpen=false;createFocusTracker({onMount:onMount,onDestroy:onDestroy,getWindow:function getWindow(){return _getWindow(refJsonEditor);},hasFocus:function hasFocus(){return modalOpen&&document.hasFocus()||activeElementIsChildOf(refJsonEditor);},onFocus:function onFocus(){hasFocus=true;if(_onFocus){_onFocus();}},onBlur:function onBlur(){hasFocus=false;if(_onBlur){_onBlur();}}});var json;var text;var rootPath=[];// create the array only once
var parseError=undefined;function updateSelection(selection){debug('updateSelection',selection);var updatedSelection=typeof selection==='function'?selection(documentState.selection):selection;if(!isEqual$1(updatedSelection,documentState.selection)){$$invalidate(15,documentState=_objectSpread2(_objectSpread2({},documentState),{},{selection:updatedSelection}));}}var documentStateInitialized=false;var documentState=createDocumentState();var searchResult;var normalization;var pastedJson;function getDefaultExpand(json){return isLargeContent({json:json},MAX_DOCUMENT_SIZE_EXPAND_ALL)?expandMinimal:expandAll;}var showSearch=false;var showReplace=false;var searching=false;var searchText='';function handleSearchText(_x2){return _handleSearchText.apply(this,arguments);}function _handleSearchText(){_handleSearchText=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(text){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:debug('search text updated',text);$$invalidate(72,searchText=text);_context4.next=4;return tick();case 4:_context4.next=6;return focusActiveSearchResult();case 6:case"end":return _context4.stop();}}},_callee4);}));return _handleSearchText.apply(this,arguments);}function handleNextSearchResult(){return _handleNextSearchResult.apply(this,arguments);}function _handleNextSearchResult(){_handleNextSearchResult=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:$$invalidate(16,searchResult=searchResult?searchNext(searchResult):undefined);_context5.next=3;return focusActiveSearchResult();case 3:case"end":return _context5.stop();}}},_callee5);}));return _handleNextSearchResult.apply(this,arguments);}function handlePreviousSearchResult(){return _handlePreviousSearchResult.apply(this,arguments);}function _handlePreviousSearchResult(){_handlePreviousSearchResult=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:$$invalidate(16,searchResult=searchResult?searchPrevious(searchResult):undefined);_context6.next=3;return focusActiveSearchResult();case 3:case"end":return _context6.stop();}}},_callee6);}));return _handlePreviousSearchResult.apply(this,arguments);}function handleReplace(_x3,_x4){return _handleReplace.apply(this,arguments);}function _handleReplace(){_handleReplace=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(text,replacementText){var _searchResult;var activeItem,_createSearchAndRepla,operations,newSelection;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:activeItem=(_searchResult=searchResult)===null||_searchResult===void 0?void 0:_searchResult.activeItem;debug('handleReplace',{replacementText:replacementText,activeItem:activeItem});if(activeItem){_context7.next=4;break;}return _context7.abrupt("return");case 4:_createSearchAndRepla=createSearchAndReplaceOperations(json,documentState,replacementText,activeItem,parser),operations=_createSearchAndRepla.operations,newSelection=_createSearchAndRepla.newSelection;handlePatch(operations,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:newSelection})};});_context7.next=8;return tick();case 8:_context7.next=10;return focusActiveSearchResult();case 10:case"end":return _context7.stop();}}},_callee7);}));return _handleReplace.apply(this,arguments);}function handleReplaceAll(_x5,_x6){return _handleReplaceAll.apply(this,arguments);}function _handleReplaceAll(){_handleReplaceAll=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(text,replacementText){var _createSearchAndRepla2,operations,newSelection;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:debug('handleReplaceAll',{text:text,replacementText:replacementText});_createSearchAndRepla2=createSearchAndReplaceAllOperations(json,documentState,text,replacementText,parser),operations=_createSearchAndRepla2.operations,newSelection=_createSearchAndRepla2.newSelection;handlePatch(operations,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:newSelection})};});_context8.next=5;return tick();case 5:_context8.next=7;return focusActiveSearchResult();case 7:case"end":return _context8.stop();}}},_callee8);}));return _handleReplaceAll.apply(this,arguments);}function clearSearchResult(){$$invalidate(18,showSearch=false);$$invalidate(19,showReplace=false);handleSearchText('');focus();}function focusActiveSearchResult(){return _focusActiveSearchResult.apply(this,arguments);}function _focusActiveSearchResult(){_focusActiveSearchResult=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(){var _searchResult2;var activeItem,path;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:activeItem=(_searchResult2=searchResult)===null||_searchResult2===void 0?void 0:_searchResult2.activeItem;debug('focusActiveSearchResult',searchResult);if(!activeItem){_context9.next=9;break;}path=activeItem.path;$$invalidate(15,documentState=_objectSpread2(_objectSpread2({},expandPath(json,documentState,path)),{},{selection:undefined// navigation path of current selection would be confusing
}));_context9.next=7;return tick();case 7:_context9.next=9;return scrollTo(path);case 9:case"end":return _context9.stop();}}},_callee9);}));return _focusActiveSearchResult.apply(this,arguments);}function applySearch(){if(searchText===''){debug('clearing search result');if(searchResult!==undefined){$$invalidate(16,searchResult=undefined);}return;}$$invalidate(20,searching=true);// setTimeout is to wait until the search icon has been rendered
setTimeout(function(){debug('searching...',searchText);// console.time('search') // TODO: cleanup
var newResultItems=search(searchText,json,documentState,MAX_SEARCH_RESULTS);$$invalidate(16,searchResult=updateSearchResult(json,newResultItems,searchResult));// console.timeEnd('search') // TODO: cleanup
$$invalidate(20,searching=false);});}function handleSelectValidationError(error){debug('select validation error',error);updateSelection(createValueSelection(error.path,false));scrollTo(error.path);}var history=createHistory({onChange:function onChange(state){$$invalidate(21,historyState=state);}});var historyState=history.getState();function expand(){var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){return true;};debug('expand');// clear the expanded state and visible sections (else you can't collapse anything)
var cleanDocumentState=_objectSpread2(_objectSpread2({},documentState),{},{expandedMap:{},visibleSectionsMap:{}});$$invalidate(15,documentState=expandWithCallback(json,cleanDocumentState,rootPath,callback));}// we pass non-used arguments searchText and json to trigger search when these variables change
var applySearchThrottled=throttle(applySearch,SEARCH_UPDATE_THROTTLE);var textIsRepaired=false;var validationErrors=[];var validationErrorsMap;// because onChange returns the validation errors and there is also a separate listener,
// we would execute validation twice. Memoizing the last result solves this.
var memoizedValidate=memoizeOne(validateJSON);function updateValidationErrors(json,validator,parser,validationParser){measure(function(){var newValidationErrors;try{newValidationErrors=memoizedValidate(json,validator,parser,validationParser);}catch(err){newValidationErrors=[{path:[],message:'Failed to validate: '+err.message,severity:ValidationSeverity.warning}];}if(!isEqual$1(newValidationErrors,validationErrors)){debug('validationErrors changed:',newValidationErrors);$$invalidate(11,validationErrors=newValidationErrors);}},function(duration){return debug("validationErrors updated in ".concat(duration," ms"));});}function validate(){debug('validate');if(parseError){return{parseError:parseError,isRepairable:false// not applicable, if repairable, we will not have a parseError
};}// make sure the validation results are up-to-date
// normally, they are only updated on the next tick after the json is changed
updateValidationErrors(json,validator,parser,validationParser);return{validationErrors:validationErrors};}function getJson(){return json;}function getDocumentState(){return documentState;}function applyExternalContent(updatedContent){if(updatedContent.json!==undefined){applyExternalJson(updatedContent.json);}if(updatedContent.text!==undefined){applyExternalText(updatedContent.text);}}function applyExternalJson(updatedJson){if(updatedJson===undefined){return;}// TODO: this is inefficient. Make an optional flag promising that the updates are immutable so we don't have to do a deep equality check? First do some profiling!
var isChanged=!isEqual$1(json,updatedJson);debug('update external json',{isChanged:isChanged,currentlyText:json===undefined});if(!isChanged){// no actual change, don't do anything
return;}var previousContent={json:json,text:text};var previousState=documentState;var previousJson=json;var previousText=text;var previousTextIsRepaired=textIsRepaired;$$invalidate(9,json=updatedJson);expandWhenNotInitialized(json);$$invalidate(10,text=undefined);$$invalidate(22,textIsRepaired=false);clearSelectionWhenNotExisting(json);addHistoryItem({previousJson:previousJson,previousState:previousState,previousText:previousText,previousTextIsRepaired:previousTextIsRepaired});// we could work out a patchResult, or use patch(), but only when the previous and new
// contents are both json and not text. We go for simplicity and consistency here and
// let the functions applyExternalJson and applyExternalText _not_ return
// a patchResult ever.
var patchResult=null;emitOnChange(previousContent,patchResult);}function applyExternalText(updatedText){if(updatedText===undefined||externalContent.json!==undefined){return;}var isChanged=updatedText===text;debug('update external text',{isChanged:isChanged});if(isChanged){// no actual change, don't do anything
return;}var previousContent={json:json,text:text};var previousJson=json;var previousState=documentState;var previousText=text;var previousTextIsRepaired=textIsRepaired;try{$$invalidate(9,json=parser.parse(updatedText));expandWhenNotInitialized(json);$$invalidate(10,text=updatedText);$$invalidate(22,textIsRepaired=false);parseError=undefined;clearSelectionWhenNotExisting(json);}catch(err){try{$$invalidate(9,json=parser.parse(jsonrepair(updatedText)));expandWhenNotInitialized(json);$$invalidate(10,text=updatedText);$$invalidate(22,textIsRepaired=true);parseError=undefined;clearSelectionWhenNotExisting(json);}catch(repairError){// no valid JSON, will show empty document or invalid json
$$invalidate(9,json=undefined);$$invalidate(10,text=externalContent.text);$$invalidate(22,textIsRepaired=false);parseError=normalizeJsonParseError(text,err.message||err.toString());clearSelectionWhenNotExisting(json);}}addHistoryItem({previousJson:previousJson,previousState:previousState,previousText:previousText,previousTextIsRepaired:previousTextIsRepaired});// we could work out a patchResult, or use patch(), but only when the previous and new
// contents are both json and not text. We go for simplicity and consistency here and
// let the functions applyExternalJson and applyExternalText _not_ return
// a patchResult ever.
var patchResult=null;emitOnChange(previousContent,patchResult);}function expandWhenNotInitialized(json){if(!documentStateInitialized){documentStateInitialized=true;$$invalidate(15,documentState=expandWithCallback(json,documentState,rootPath,getDefaultExpand(json)));}}function clearSelectionWhenNotExisting(json){if(documentState.selection===undefined){return;}if(documentState.selection&&immutableJSONPatch.exports.existsIn(json,documentState.selection.anchorPath)&&immutableJSONPatch.exports.existsIn(json,documentState.selection.focusPath)){return;}debug('clearing selection: path does not exist anymore',documentState.selection);$$invalidate(15,documentState=_objectSpread2(_objectSpread2({},documentState),{},{selection:undefined}));}function addHistoryItem(_ref99){var previousJson=_ref99.previousJson,previousState=_ref99.previousState,previousText=_ref99.previousText,previousTextIsRepaired=_ref99.previousTextIsRepaired;if(previousJson===undefined&&previousText===undefined){// initialization -> do not create a history item
return;}if(json!==undefined){if(previousJson!==undefined){// regular undo/redo with JSON patch
history.add({undo:{patch:[{op:'replace',path:'',value:previousJson}],state:removeEditModeFromSelection(previousState),json:undefined,text:previousText,textIsRepaired:previousTextIsRepaired},redo:{patch:[{op:'replace',path:'',value:json}],state:removeEditModeFromSelection(documentState),json:undefined,text:text,textIsRepaired:textIsRepaired}});}else{history.add({undo:{patch:undefined,json:undefined,text:previousText,state:removeEditModeFromSelection(previousState),textIsRepaired:previousTextIsRepaired},redo:{patch:undefined,json:json,state:removeEditModeFromSelection(documentState),text:text,textIsRepaired:textIsRepaired}});}}else{if(previousJson!==undefined){history.add({undo:{patch:undefined,json:previousJson,state:removeEditModeFromSelection(previousState),text:previousText,textIsRepaired:previousTextIsRepaired},redo:{patch:undefined,json:undefined,text:text,textIsRepaired:textIsRepaired,state:removeEditModeFromSelection(documentState)}});}// this cannot happen. Nothing to do, no change
}}function createDefaultSelection(){debug('createDefaultSelection');$$invalidate(15,documentState=_objectSpread2(_objectSpread2({},documentState),{},{selection:createMultiSelection(json||{},[],[])}));}function patch(operations,afterPatch){debug('patch',operations,afterPatch);if(json===undefined){throw new Error('Cannot apply patch: no JSON');}var previousContent={json:json,text:text};var previousJson=json;var previousState=documentState;var previousText=text;var previousTextIsRepaired=textIsRepaired;// execute the patch operations
var undo=revertJSONPatchWithMoveOperations(json,operations);var patched=documentStatePatch(json,documentState,operations);// update the selection based on the operations
var updatedSelection=createSelectionFromOperations(json,operations);var patchedDocumentState=updateSelectionInDocumentState(patched.documentState,updatedSelection,false);debug('patch updatedSelection',updatedSelection);var callback=typeof afterPatch==='function'?afterPatch(patched.json,patchedDocumentState):undefined;$$invalidate(9,json=callback&&callback.json!==undefined?callback.json:patched.json);var newState=callback&&callback.state!==undefined?callback.state:patchedDocumentState;$$invalidate(15,documentState=newState);$$invalidate(10,text=undefined);$$invalidate(22,textIsRepaired=false);// ensure the selection is valid
clearSelectionWhenNotExisting(json);history.add({undo:{patch:undo,json:undefined,text:previousText,state:removeEditModeFromSelection(previousState),textIsRepaired:previousTextIsRepaired},redo:{patch:operations,json:undefined,state:removeEditModeFromSelection(newState),text:text,textIsRepaired:textIsRepaired}});var patchResult={json:json,previousJson:previousJson,undo:undo,redo:operations};emitOnChange(previousContent,patchResult);return patchResult;}// TODO: cleanup logging
// $: debug('json', json)
// $: debug('state', state)
// $: debug('selection', selection)
function hasSelectionContents(selection){return isMultiSelection(selection)||isKeySelection(selection)||isValueSelection(selection);}function handleEditKey(){if(readOnly||!documentState.selection){return;}updateSelection(createKeySelection(documentState.selection.focusPath,true));}function handleEditValue(){if(readOnly||!documentState.selection){return;}updateSelection(createValueSelection(documentState.selection.focusPath,true));}function handleToggleEnforceString(){if(readOnly||!isValueSelection(documentState.selection)){return;}var path=documentState.selection.focusPath;var pointer=immutableJSONPatch.exports.compileJSONPointer(path);var value=immutableJSONPatch.exports.getIn(json,path);var enforceString=!getEnforceString(value,documentState.enforceStringMap,pointer,parser);var updatedValue=enforceString?String(value):stringConvert(String(value),parser);debug('handleToggleEnforceString',{enforceString:enforceString,value:value,updatedValue:updatedValue});handlePatch([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:updatedValue}],function(patchedJson,patchedState){return{state:setEnforceString(patchedState,pointer,enforceString)};});}function acceptAutoRepair(){if(textIsRepaired&&json!==undefined){handleReplaceJson(json);}return{json:json,text:text};}function handleCut(){return _handleCut.apply(this,arguments);}function _handleCut(){_handleCut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(){var indent,cutIndentation,clipboard,_createRemoveOperatio2,operations,newSelection,_args8=arguments;return _regeneratorRuntime().wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:indent=_args8.length>0&&_args8[0]!==undefined?_args8[0]:true;if(!(readOnly||!hasSelectionContents(documentState.selection))){_context10.next=3;break;}return _context10.abrupt("return");case 3:cutIndentation=indent?indentation:null;clipboard=selectionToPartialJson(json,documentState.selection,cutIndentation,parser);if(!(clipboard==null)){_context10.next=7;break;}return _context10.abrupt("return");case 7:debug('cut',{selection:documentState.selection,clipboard:clipboard,indent:indent});_context10.next=10;return copyToClipBoard(clipboard);case 10:_createRemoveOperatio2=createRemoveOperations(json,documentState.selection),operations=_createRemoveOperatio2.operations,newSelection=_createRemoveOperatio2.newSelection;handlePatch(operations,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:newSelection})};});case 12:case"end":return _context10.stop();}}},_callee10);}));return _handleCut.apply(this,arguments);}function handleCopy(){return _handleCopy.apply(this,arguments);}function _handleCopy(){_handleCopy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(){var indent,copyIndentation,clipboard,_args9=arguments;return _regeneratorRuntime().wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:indent=_args9.length>0&&_args9[0]!==undefined?_args9[0]:true;copyIndentation=indent?indentation:null;clipboard=selectionToPartialJson(json,documentState.selection,copyIndentation,parser);if(!(clipboard==null)){_context11.next=5;break;}return _context11.abrupt("return");case 5:debug('copy',{clipboard:clipboard,indent:indent});_context11.next=8;return copyToClipBoard(clipboard);case 8:case"end":return _context11.stop();}}},_callee11);}));return _handleCopy.apply(this,arguments);}function handlePaste(event){event.preventDefault();if(readOnly){return;}var clipboardText=event.clipboardData.getData('text/plain');try{doPaste(clipboardText);}catch(err){openRepairModal(clipboardText,function(repairedText){debug('repaired pasted text: ',repairedText);doPaste(repairedText);});}}function handlePasteFromMenu(){open(CopyPasteModal$1,{},_objectSpread2(_objectSpread2({},SIMPLE_MODAL_OPTIONS),{},{styleWindow:{width:'450px'}}),{onClose:function onClose(){return focus();}});}function doPaste(clipboardText){if(json!==undefined){if(!documentState.selection){createDefaultSelection();}var operations=insert(json,documentState.selection,clipboardText,parser);debug('paste',{clipboardText:clipboardText,operations:operations,selection:documentState.selection});handlePatch(operations,function(patchedJson,patchedState){var updatedState=patchedState;// expand newly inserted object/array
operations.filter(function(operation){return(immutableJSONPatch.exports.isJSONPatchAdd(operation)||immutableJSONPatch.exports.isJSONPatchReplace(operation))&&isObjectOrArray(operation.value);}).forEach(function(operation){var path=immutableJSONPatch.exports.parsePath(json,operation.path);updatedState=expandRecursive(patchedJson,updatedState,path);});return{state:updatedState};});}else{debug('paste text',{clipboardText:clipboardText});handleChangeText(clipboardText,function(patchedJson,patchedState){if(patchedJson){var path=[];return{state:expandRecursive(patchedJson,patchedState,path)};}});}}function openRepairModal(text,onApply){open(JSONRepairModal$1,{text:text,onParse:parsePartialJson,onRepair:repairPartialJson,onApply:onApply,onRenderMenu:onRenderMenu},_objectSpread2(_objectSpread2({},SIMPLE_MODAL_OPTIONS),{},{styleWindow:{width:'600px',height:'500px'},styleContent:{padding:0,height:'100%'}}),{onClose:function onClose(){return focus();}});}function handleRemove(){if(readOnly||!documentState.selection){return;}// in case of a selected key or value, we change the selection to the whole
// entry to remove this, we do not want to clear a key or value only.
var removeSelection=isKeySelection(documentState.selection)||isValueSelection(documentState.selection)?createMultiSelection(json,documentState.selection.anchorPath,documentState.selection.focusPath):documentState.selection;if(isEmpty(documentState.selection.focusPath)){// root selected -> clear complete document
debug('remove root',{selection:documentState.selection});onChange({text:'',json:undefined},{text:text,json:json},{contentErrors:validate(),patchResult:null});}else{// remove selection
var _createRemoveOperatio=createRemoveOperations(json,removeSelection),operations=_createRemoveOperatio.operations,newSelection=_createRemoveOperatio.newSelection;debug('remove',{operations:operations,selection:documentState.selection,newSelection:newSelection});handlePatch(operations,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:newSelection})};});}}function handleDuplicate(){if(readOnly||!hasSelectionContents(documentState.selection)||isEmpty(documentState.selection.focusPath)){return;// root selected, cannot duplicate
}debug('duplicate',{selection:documentState.selection});var operations=duplicate(json,getSelectionPaths(documentState.selection));handlePatch(operations);}function handleExtract(){if(readOnly||!documentState.selection||!isMultiSelection(documentState.selection)&&!isValueSelection(documentState.selection)||isEmpty(documentState.selection.focusPath)){return;// root selected, cannot extract
}debug('extract',{selection:documentState.selection});var operations=extract(json,documentState.selection);handlePatch(operations,function(patchedJson,patchedState){if(isObjectOrArray(patchedJson)){// expand extracted object/array
var path=[];return{state:expandRecursive(patchedJson,patchedState,path)};}});}function handleInsert(type){if(readOnly||!documentState.selection){return;}var newValue=createNewValue(json,documentState.selection,type);if(json!==undefined){var data=parser.stringify(newValue);var operations=insert(json,documentState.selection,data,parser);debug('handleInsert',{type:type,operations:operations,newValue:newValue,data:data});var operation=last(operations.filter(function(operation){return operation.op==='add'||operation.op==='replace';}));handlePatch(operations,function(patchedJson,patchedState){// TODO: extract determining the newSelection in a separate function
if(operation){var path=immutableJSONPatch.exports.parsePath(patchedJson,operation.path);if(isObjectOrArray(newValue)){return{state:_objectSpread2(_objectSpread2({},expandWithCallback(patchedJson,patchedState,path,expandAll)),{},{selection:createInsideSelection(path)})};}if(newValue===''){// open the newly inserted value in edit mode
var _parent29=!isEmpty(path)?immutableJSONPatch.exports.getIn(patchedJson,initial(path)):null;debug('test A',path,createInsideSelection(path));return{// expandPath is invoked to make sure that visibleSections is extended when needed
state:expandPath(patchedJson,_objectSpread2(_objectSpread2({},documentState),{},{selection:isObject$1(_parent29)?createKeySelection(path,true):createValueSelection(path,true)}),path)};}return undefined;}});debug('after patch');if(operation){if(newValue===''){// open the newly inserted value in edit mode
tick().then(function(){setTimeout(function(){return insertActiveElementContents('',true);});});}}}else{// document is empty or invalid (in that case it has text but no json)
debug('handleInsert',{type:type,newValue:newValue});var path=[];handleReplaceJson(newValue,function(patchedJson,patchedState){return{state:_objectSpread2(_objectSpread2({},expandRecursive(patchedJson,patchedState,path)),{},{selection:createInsideSelection(path)})};});}}/**
 * @param {'value' | 'object' | 'array' | 'structure'} type
 */function handleInsertFromContextMenu(type){if(isKeySelection(documentState.selection)){// in this case, we do not want to rename the key, but replace the property
updateSelection(createValueSelection(documentState.selection.focusPath,false));}handleInsert(type);}/**
 * @param {'value' | 'object' | 'array'} type
 */function handleConvert(type){if(readOnly||!documentState.selection){return;}if(!canConvert(documentState.selection)){onError(new Error("Cannot convert current selection to ".concat(type)));return;}try{var path=documentState.selection.anchorPath;var currentValue=immutableJSONPatch.exports.getIn(json,path);var convertedValue=convertValue(currentValue,type,parser);if(convertedValue===currentValue){// no change, do nothing
return;}var operations=[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:convertedValue}];debug('handleConvert',{selection:documentState.selection,path:path,type:type,operations:operations});handlePatch(operations,function(patchedJson,patchedState){// expand converted object/array
return{state:expandRecursive(patchedJson,patchedState,documentState.selection.focusPath)};});}catch(err){onError(err);}}function handleInsertBefore(){var selectionBefore=getSelectionUp(json,documentState,false);var parentPath=initial(documentState.selection.focusPath);if(!isEmpty(selectionBefore.focusPath)&&isEqual$1(parentPath,initial(selectionBefore.focusPath))){updateSelection(createAfterSelection(selectionBefore.focusPath));}else{updateSelection(createInsideSelection(parentPath));}debug('insert before',{selection:documentState.selection,selectionBefore:selectionBefore,parentPath:parentPath});tick().then(handleContextMenu);}function handleInsertAfter(){var path=isMultiSelection(documentState.selection)?last(documentState.selection.paths):documentState.selection.focusPath;debug('insert after',path);updateSelection(createAfterSelection(path));tick().then(handleContextMenu);}/**
 * Insert (append or replace) the text contents of the current active element
 * @param {string} char
 * @param {boolean} replaceContents
 */function insertActiveElementContents(_char12,replaceContents){var activeElement=_getWindow(refJsonEditor).document.activeElement;if(activeElement.isContentEditable){activeElement.textContent=replaceContents?_char12:activeElement.textContent+_char12;setCursorToEnd(activeElement);}// FIXME: should trigger an oninput, else the component will not update it's newKey/newValue variable
}function handleInsertCharacter(_x7){return _handleInsertCharacter.apply(this,arguments);}function _handleInsertCharacter(){_handleInsertCharacter=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(_char13){var replaceContents,_replaceContents;return _regeneratorRuntime().wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(!(readOnly||!documentState.selection)){_context12.next=2;break;}return _context12.abrupt("return");case 2:if(!isKeySelection(documentState.selection)){_context12.next=9;break;}// only replace contents when not yet in edit mode (can happen when entering
// multiple characters very quickly after each other due to the async handling)
replaceContents=!documentState.selection.edit;updateSelection(_objectSpread2(_objectSpread2({},documentState.selection),{},{edit:true}));_context12.next=7;return tick();case 7:setTimeout(function(){return insertActiveElementContents(_char13,replaceContents);});return _context12.abrupt("return");case 9:if(!(_char13==='{')){_context12.next=13;break;}handleInsert('object');_context12.next=28;break;case 13:if(!(_char13==='[')){_context12.next=17;break;}handleInsert('array');_context12.next=28;break;case 17:if(!isValueSelection(documentState.selection)){_context12.next=26;break;}if(isObjectOrArray(immutableJSONPatch.exports.getIn(json,documentState.selection.focusPath))){_context12.next=24;break;}// only replace contents when not yet in edit mode (can happen when entering
// multiple characters very quickly after each other due to the async handling)
_replaceContents=!documentState.selection.edit;updateSelection(_objectSpread2(_objectSpread2({},documentState.selection),{},{edit:true}));_context12.next=23;return tick();case 23:setTimeout(function(){return insertActiveElementContents(_char13,_replaceContents);});case 24:_context12.next=28;break;case 26:_context12.next=28;return handleInsertValueWithCharacter(_char13);case 28:case"end":return _context12.stop();}}},_callee12);}));return _handleInsertCharacter.apply(this,arguments);}function handleInsertValueWithCharacter(_x8){return _handleInsertValueWithCharacter.apply(this,arguments);}function _handleInsertValueWithCharacter(){_handleInsertValueWithCharacter=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13(_char14){var replaceContents,path,parent;return _regeneratorRuntime().wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(!(readOnly||!documentState.selection)){_context13.next=2;break;}return _context13.abrupt("return");case 2:// first insert a new value
handleInsert('value');// only replace contents when not yet in edit mode (can happen when entering
// multiple characters very quickly after each other due to the async handling)
replaceContents=!isEditingSelection(documentState.selection);// next, open the new value in edit mode and apply the current character
path=documentState.selection.focusPath;parent=immutableJSONPatch.exports.getIn(json,initial(path));if(Array.isArray(parent)||!parent||isValueSelection(documentState.selection)){updateSelection(createValueSelection(path,true));}else{updateSelection(createKeySelection(path,true));}_context13.next=9;return tick();case 9:setTimeout(function(){return insertActiveElementContents(_char14,replaceContents);});case 10:case"end":return _context13.stop();}}},_callee13);}));return _handleInsertValueWithCharacter.apply(this,arguments);}function handleUndo(){if(readOnly){return;}if(!history.getState().canUndo){return;}var item=history.undo();if(!item){return;}var previousContent={json:json,text:text};$$invalidate(9,json=item.undo.patch?immutableJSONPatch.exports.immutableJSONPatch(json,item.undo.patch):item.undo.json);$$invalidate(15,documentState=item.undo.state);$$invalidate(10,text=item.undo.text);$$invalidate(22,textIsRepaired=item.undo.textIsRepaired);debug('undo',{item:item,json:json,documentState:documentState});var patchResult={json:json,previousJson:previousContent.json,redo:item.undo.patch,undo:item.redo.patch};emitOnChange(previousContent,patchResult);focus();if(documentState.selection){scrollTo(documentState.selection.focusPath,false);}}function handleRedo(){if(readOnly){return;}if(!history.getState().canRedo){return;}var item=history.redo();if(!item){return;}var previousContent={json:json,text:text};$$invalidate(9,json=item.redo.patch?immutableJSONPatch.exports.immutableJSONPatch(json,item.redo.patch):item.redo.json);$$invalidate(15,documentState=item.redo.state);$$invalidate(10,text=item.redo.text);$$invalidate(22,textIsRepaired=item.redo.textIsRepaired);debug('redo',{item:item,json:json,documentState:documentState});var patchResult={json:json,previousJson:previousContent.json,redo:item.redo.patch,undo:item.undo.patch};emitOnChange(previousContent,patchResult);focus();if(documentState.selection){scrollTo(documentState.selection.focusPath,false);}}function openSortModal(selectedPath){if(readOnly){return;}modalOpen=true;onSortModal({id:sortModalId,json:json,selectedPath:selectedPath,onSort:function(){var _onSort2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(operations){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:debug('onSort',selectedPath,operations);handlePatch(operations,function(patchedJson,patchedState){return{// expand the newly replaced array and select it
state:_objectSpread2(_objectSpread2({},expandRecursive(patchedJson,patchedState,selectedPath)),{},{selection:createValueSelection(selectedPath,false)})};});case 2:case"end":return _context3.stop();}}},_callee3);}));function onSort(_x9){return _onSort2.apply(this,arguments);}return onSort;}(),onClose:function onClose(){modalOpen=false;focus();}});}function handleSortSelection(){if(!documentState.selection){return;}var selectedPath=findRootPath(json,documentState.selection);openSortModal(selectedPath);}function handleSortAll(){var selectedPath=[];openSortModal(selectedPath);}function openTransformModal(_ref103){var id=_ref103.id,selectedPath=_ref103.selectedPath,onTransform=_ref103.onTransform,_onClose2=_ref103.onClose;modalOpen=true;onTransformModal({id:id||transformModalId,json:json,selectedPath:selectedPath,onTransform:onTransform?function(operations){onTransform({operations:operations,json:json,transformedJson:immutableJSONPatch.exports.immutableJSONPatch(json,operations)});}:function(operations){debug('onTransform',selectedPath,operations);handlePatch(operations,function(patchedJson,patchedState){return{// expand the newly replaced array and select it
state:_objectSpread2(_objectSpread2({},expandRecursive(patchedJson,patchedState,selectedPath)),{},{selection:createValueSelection(selectedPath,false)})};});},onClose:function onClose(){modalOpen=false;focus();if(_onClose2){_onClose2();}}});}function handleTransformSelection(){if(!documentState.selection){return;}var selectedPath=findRootPath(json,documentState.selection);openTransformModal({selectedPath:selectedPath});}function handleTransformAll(){openTransformModal({selectedPath:[]});}function scrollTo(_x10){return _scrollTo.apply(this,arguments);}function _scrollTo(){_scrollTo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee14(path){var scrollToWhenVisible,elem,viewPortRect,elemRect,offset,_args12=arguments;return _regeneratorRuntime().wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:scrollToWhenVisible=_args12.length>1&&_args12[1]!==undefined?_args12[1]:true;$$invalidate(15,documentState=expandPath(json,documentState,initial(path)));_context14.next=4;return tick();case 4:elem=findElement(path);if(!elem){_context14.next=14;break;}debug('scrollTo',{path:path,elem:elem,refContents:refContents});viewPortRect=refContents.getBoundingClientRect();elemRect=elem.getBoundingClientRect();if(scrollToWhenVisible){_context14.next=12;break;}if(!(elemRect.bottom>viewPortRect.top&&elemRect.top<viewPortRect.bottom)){_context14.next=12;break;}return _context14.abrupt("return");case 12:offset=-(viewPortRect.height/4);jump(elem,{container:refContents,offset:offset,duration:SCROLL_DURATION});case 14:case"end":return _context14.stop();}}},_callee14);}));return _scrollTo.apply(this,arguments);}function findElement(path){return refContents?refContents.querySelector("div[data-path=\"".concat(encodeDataPath(path),"\"]")):null;}/**
 * If given path is outside the visible viewport, scroll up/down.
 * When the path is already in view, nothing is done
 */function scrollIntoView(path){var elem=findElement(path);if(!elem||!refContents){return;}var viewPortRect=refContents.getBoundingClientRect();var elemRect=elem.getBoundingClientRect();var margin=20;var elemHeight=isObjectOrArray(immutableJSONPatch.exports.getIn(json,path))?margin:elemRect.height;// do not use real height when array or object
if(elemRect.top<viewPortRect.top+margin){// scroll down
jump(elem,{container:refContents,offset:-margin,duration:0});}else if(elemRect.top+elemHeight>viewPortRect.bottom-margin){// scroll up
jump(elem,{container:refContents,offset:-(viewPortRect.height-elemHeight-margin),duration:0});}}function emitOnChange(previousContent,patchResult){// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-ignore
if(previousContent.json===undefined&&(previousContent===null||previousContent===void 0?void 0:previousContent.text)===undefined){// initialization -> do not fire an onChange event
return;}// make sure we cannot send an invalid contents like having both
// json and text defined, or having none defined
if(text!==undefined){onChange({text:text,json:undefined},previousContent,{contentErrors:validate(),patchResult:patchResult});}else if(json!==undefined){onChange({text:undefined,json:json},previousContent,{contentErrors:validate(),patchResult:patchResult});}}function handlePatch(operations,afterPatch){if(readOnly){return;}debug('handlePatch',operations,afterPatch);var patchResult=patch(operations,afterPatch);$$invalidate(17,pastedJson=undefined);return patchResult;}function handleReplaceJson(updatedJson,afterPatch){var previousState=documentState;var previousJson=json;var previousText=text;var previousContent={json:json,text:text};var previousTextIsRepaired=textIsRepaired;var updatedState=expandWithCallback(json,documentState,rootPath,expandMinimal);var callback=typeof afterPatch==='function'?afterPatch(updatedJson,updatedState):undefined;$$invalidate(9,json=callback&&callback.json!==undefined?callback.json:updatedJson);$$invalidate(15,documentState=callback&&callback.state!==undefined?callback.state:updatedState);$$invalidate(10,text=undefined);$$invalidate(22,textIsRepaired=false);// make sure the selection is valid
clearSelectionWhenNotExisting(json);addHistoryItem({previousJson:previousJson,previousState:previousState,previousText:previousText,previousTextIsRepaired:previousTextIsRepaired});// we could work out a patchResult, or use patch(), but only when the previous and new
// contents are both json and not text. We go for simplicity and consistency here and
// do _not_ return a patchResult ever.
var patchResult=null;emitOnChange(previousContent,patchResult);}function handleChangeText(updatedText,afterPatch){debug('handleChangeText');var previousState=documentState;var previousJson=json;var previousText=text;var previousContent={json:json,text:text};var previousTextIsRepaired=textIsRepaired;try{$$invalidate(9,json=parser.parse(updatedText));$$invalidate(15,documentState=expandWithCallback(json,documentState,rootPath,expandMinimal));$$invalidate(10,text=undefined);$$invalidate(22,textIsRepaired=false);}catch(err){try{$$invalidate(9,json=parser.parse(jsonrepair(updatedText)));$$invalidate(15,documentState=expandWithCallback(json,documentState,rootPath,expandMinimal));$$invalidate(10,text=updatedText);$$invalidate(22,textIsRepaired=true);}catch(err){// no valid JSON, will show empty document or invalid json
$$invalidate(9,json=undefined);$$invalidate(15,documentState=createDocumentState({json:json,expand:expandMinimal}));$$invalidate(10,text=updatedText);$$invalidate(22,textIsRepaired=false);}}if(typeof afterPatch==='function'){var callback=afterPatch(json,documentState);$$invalidate(9,json=callback&&callback.json?callback.json:json);$$invalidate(15,documentState=callback&&callback.state?callback.state:documentState);}// ensure the selection is valid
clearSelectionWhenNotExisting(json);addHistoryItem({previousJson:previousJson,previousState:previousState,previousText:previousText,previousTextIsRepaired:previousTextIsRepaired});// no JSON patch actions available in text mode
var patchResult=null;emitOnChange(previousContent,patchResult);}/**
 * Expand recursively when the expanded contents is small enough,
 * else expand in a minimalistic way
 */function expandRecursive(json,documentState,path){var expandContents=immutableJSONPatch.exports.getIn(json,path);var expandAllRecursive=!isLargeContent({json:expandContents},MAX_DOCUMENT_SIZE_EXPAND_ALL);var expandCallback=expandAllRecursive?expandAll:expandMinimal;return expandWithCallback(json,documentState,path,expandCallback);}/**
 * Toggle expanded state of a node
 * @param path The path to be expanded
 * @param expanded  True to expand, false to collapse
 * @param [recursive=false]  Only applicable when expanding
 */function handleExpand(path,expanded){var recursive=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;debug('expand',{path:path,expanded:expanded,recursive:recursive});if(expanded){if(recursive){$$invalidate(15,documentState=expandWithCallback(json,documentState,path,expandAll));}else{$$invalidate(15,documentState=expandSingleItem(documentState,path));}}else{$$invalidate(15,documentState=collapsePath(documentState,path));}if(documentState.selection&&!expanded){// check whether the selection is still visible and not collapsed
if(isSelectionInsidePath(documentState.selection,path)){// remove selection when not visible anymore
updateSelection(undefined);}}// set focus to the hidden input, so we can capture quick keys like Ctrl+X, Ctrl+C, Ctrl+V
setTimeout(function(){if(!activeElementIsChildOf(refJsonEditor)){focus();}});}function handleExpandAll(){handleExpand([],true,true);}function handleCollapseAll(){handleExpand([],false,true);}function openFind(findAndReplace){debug('openFind',{findAndReplace:findAndReplace});$$invalidate(18,showSearch=false);$$invalidate(19,showReplace=false);tick().then(function(){// trick to make sure the focus goes to the search box
$$invalidate(18,showSearch=true);$$invalidate(19,showReplace=findAndReplace);});}function handleExpandSection(path,section){debug('handleExpandSection',path,section);var pointer=immutableJSONPatch.exports.compileJSONPointer(path);$$invalidate(15,documentState=expandSection(json,documentState,pointer,section));}function handlePasteJson(newPastedJson){debug('pasted json as text',newPastedJson);$$invalidate(17,pastedJson=newPastedJson);}function handleKeyDown(event){// get key combo, and normalize key combo from Mac: replace "Command+X" with "Ctrl+X" etc
var combo=keyComboFromEvent(event).replace(/^Command\+/,'Ctrl+');var keepAnchorPath=event.shiftKey;debug('keydown',{combo:combo,key:event.key});if(combo==='Ctrl+X'){// cut formatted
event.preventDefault();handleCut(true);}if(combo==='Ctrl+Shift+X'){// cut compact
event.preventDefault();handleCut(false);}if(combo==='Ctrl+C'){// copy formatted
event.preventDefault();handleCopy(true);}if(combo==='Ctrl+Shift+C'){// copy compact
event.preventDefault();handleCopy(false);}// Ctrl+V (paste) is handled by the on:paste event
if(combo==='Ctrl+D'){event.preventDefault();handleDuplicate();}if(combo==='Delete'||combo==='Backspace'){event.preventDefault();handleRemove();}if(combo==='Insert'){event.preventDefault();handleInsert('structure');}if(combo==='Ctrl+A'){event.preventDefault();updateSelection(selectAll());}if(combo==='Ctrl+Q'){handleContextMenu(event);}if(combo==='Up'||combo==='Shift+Up'){event.preventDefault();var newSelection=documentState.selection?getSelectionUp(json,documentState,keepAnchorPath,true)||documentState.selection:getInitialSelection(json,documentState);updateSelection(newSelection);scrollIntoView(newSelection.focusPath);}if(combo==='Down'||combo==='Shift+Down'){event.preventDefault();var _newSelection5=documentState.selection?getSelectionDown(json,documentState,keepAnchorPath,true)||documentState.selection:getInitialSelection(json,documentState);updateSelection(_newSelection5);scrollIntoView(_newSelection5.focusPath);}if(combo==='Left'||combo==='Shift+Left'){event.preventDefault();var _newSelection6=documentState.selection?getSelectionLeft(json,documentState,keepAnchorPath,!readOnly)||documentState.selection:getInitialSelection(json,documentState);updateSelection(_newSelection6);scrollIntoView(_newSelection6.focusPath);}if(combo==='Right'||combo==='Shift+Right'){event.preventDefault();var _newSelection7=documentState.selection?getSelectionRight(json,documentState,keepAnchorPath,!readOnly)||documentState.selection:getInitialSelection(json,documentState);updateSelection(_newSelection7);scrollIntoView(_newSelection7.focusPath);}if(combo==='Enter'&&documentState.selection){// when the selection consists of a single Array item, change selection to editing its value
if(!readOnly&&isMultiSelection(documentState.selection)&&documentState.selection.paths.length===1){var path=documentState.selection.focusPath;var _parent30=immutableJSONPatch.exports.getIn(json,initial(path));if(Array.isArray(_parent30)){// change into selection of the value
updateSelection(createValueSelection(path,false));}}if(!readOnly&&isKeySelection(documentState.selection)){// go to key edit mode
event.preventDefault();updateSelection(_objectSpread2(_objectSpread2({},documentState.selection),{},{edit:true}));}if(isValueSelection(documentState.selection)){event.preventDefault();var value=immutableJSONPatch.exports.getIn(json,documentState.selection.focusPath);if(isObjectOrArray(value)){// expand object/array
handleExpand(documentState.selection.focusPath,true);}else{if(!readOnly){// go to value edit mode
updateSelection(_objectSpread2(_objectSpread2({},documentState.selection),{},{edit:true}));}}}}var normalizedCombo=combo.replace(/^Shift\+/,'').replace(/^Numpad_/,'');// replace 'Shift+A' with 'A'
// replace 'Numpad_4' with '4'
if(normalizedCombo.length===1&&documentState.selection){// a regular key like a, A, _, etc is entered.
// Replace selected contents with a new value having this first character as text
event.preventDefault();handleInsertCharacter(event.key);return;}if(combo==='Enter'&&(isAfterSelection(documentState.selection)||isInsideSelection(documentState.selection))){// Enter on an insert area -> open the area in edit mode
event.preventDefault();handleInsertCharacter('');return;}if(combo==='Ctrl+Enter'&&isValueSelection(documentState.selection)){var _value3=immutableJSONPatch.exports.getIn(json,documentState.selection.focusPath);if(isUrl(_value3)){// open url in new page
window.open(String(_value3),'_blank');}}if(combo==='Escape'&&documentState.selection){event.preventDefault();updateSelection(undefined);}if(combo==='Ctrl+F'){event.preventDefault();openFind(false);}if(combo==='Ctrl+H'){event.preventDefault();openFind(true);}if(combo==='Ctrl+Z'){event.preventDefault();// TODO: find a better way to restore focus
// TODO: implement a proper TypeScript solution to check whether this is an element with blur, focus, select
var activeElement=document.activeElement;if(activeElement&&activeElement.blur&&activeElement.focus){activeElement.blur();setTimeout(function(){handleUndo();setTimeout(function(){return activeElement.select();});});}else{handleUndo();}}if(combo==='Ctrl+Shift+Z'){event.preventDefault();// TODO: find a better way to restore focus
// TODO: implement a proper TypeScript solution to check whether this is an element with blur, focus, select
var _activeElement=document.activeElement;if(_activeElement&&_activeElement.blur&&_activeElement.focus){_activeElement.blur();setTimeout(function(){handleRedo();setTimeout(function(){return _activeElement.select();});});}else{handleRedo();}}}function handleMouseDown(event){debug('handleMouseDown',event);// TODO: ugly to have to have two setTimeout here. Without it, hiddenInput will blur
setTimeout(function(){setTimeout(function(){if(!hasFocus&&!isChildOfNodeName(event.target,'BUTTON')){// for example when clicking on the empty area in the main menu
focus();if(!documentState.selection&&json===undefined&&(text===''||text===undefined)){createDefaultSelection();}}});});}function openContextMenu(_ref147){var anchor=_ref147.anchor,left=_ref147.left,top=_ref147.top,width=_ref147.width,height=_ref147.height,offsetTop=_ref147.offsetTop,offsetLeft=_ref147.offsetLeft,showTip=_ref147.showTip;var props={json:json,documentState:documentState,parser:parser,showTip:showTip,onEditKey:handleEditKey,onEditValue:handleEditValue,onToggleEnforceString:handleToggleEnforceString,onCut:handleCut,onCopy:handleCopy,onPaste:handlePasteFromMenu,onRemove:handleRemove,onDuplicate:handleDuplicate,onExtract:handleExtract,onInsertBefore:handleInsertBefore,onInsert:handleInsertFromContextMenu,onConvert:handleConvert,onInsertAfter:handleInsertAfter,onSort:handleSortSelection,onTransform:handleTransformSelection,onCloseContextMenu:function onCloseContextMenu(){closeAbsolutePopup(popupId);focus();}};modalOpen=true;var popupId=openAbsolutePopup(ContextMenu$1,props,{left:left,top:top,offsetTop:offsetTop,offsetLeft:offsetLeft,width:width,height:height,anchor:anchor,closeOnOuterClick:true,onClose:function onClose(){modalOpen=false;focus();}});}function handleContextMenu(event){if(readOnly||isEditingSelection(documentState.selection)){return;}if(event){event.stopPropagation();event.preventDefault();}if(event&&event.type==='contextmenu'&&event.target!==refHiddenInput){// right mouse click to open context menu
openContextMenu({left:event.clientX,top:event.clientY,width:CONTEXT_MENU_WIDTH,height:CONTEXT_MENU_HEIGHT,showTip:false});}else{var _refContents;// type === 'keydown' (from the quick key Ctrl+Q)
// or target is hidden input -> context menu button on keyboard
var anchor=(_refContents=refContents)===null||_refContents===void 0?void 0:_refContents.querySelector('.jse-context-menu-button.jse-selected');if(anchor){openContextMenu({anchor:anchor,offsetTop:2,width:CONTEXT_MENU_WIDTH,height:CONTEXT_MENU_HEIGHT,showTip:false});}else{var _refContents2;// fallback on just displaying the ContextMenu top left
var rect=(_refContents2=refContents)===null||_refContents2===void 0?void 0:_refContents2.getBoundingClientRect();if(rect){openContextMenu({top:rect.top+2,left:rect.left+2,width:CONTEXT_MENU_WIDTH,height:CONTEXT_MENU_HEIGHT,showTip:false});}}}return false;}function handleContextMenuFromTreeMenu(event){if(readOnly){return;}openContextMenu({anchor:findParentWithNodeName(event.target,'BUTTON'),offsetTop:0,width:CONTEXT_MENU_WIDTH,height:CONTEXT_MENU_HEIGHT,showTip:true});}function handleParsePastedJson(){return _handleParsePastedJson.apply(this,arguments);}function _handleParsePastedJson(){_handleParsePastedJson=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee15(){var _pastedJson,path,contents,operations;return _regeneratorRuntime().wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:debug('apply pasted json',pastedJson);_pastedJson=pastedJson,path=_pastedJson.path,contents=_pastedJson.contents;// exit edit mode
updateSelection(createValueSelection(path,false));_context15.next=5;return tick();case 5:// replace the value with the JSON object/array
operations=[{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:contents}];handlePatch(operations,function(patchedJson,patchedState){return{state:expandRecursive(patchedJson,patchedState,path)};});case 7:case"end":return _context15.stop();}}},_callee15);}));return _handleParsePastedJson.apply(this,arguments);}function handleClearPastedJson(){debug('clear pasted json');$$invalidate(17,pastedJson=undefined);}function handleNavigationBarSelect(newSelection){updateSelection(newSelection);focus();scrollTo(newSelection.focusPath);}function focus(){debug('focus');// with just .focus(), sometimes the input doesn't react on onpaste events
// in Chrome when having a large document open and then doing cut/paste.
// Calling both .focus() and .select() did solve this issue.
if(refHiddenInput){refHiddenInput.focus();refHiddenInput.select();}}function handleWindowMouseDown(event){var outsideEditor=!isChildOf(event.target,function(element){return element===refJsonEditor;});if(outsideEditor){if(isEditingSelection(documentState.selection)){debug('click outside the editor, stop edit mode');updateSelection(function(selection){if(isKeySelection(selection)){return _objectSpread2(_objectSpread2({},selection),{},{edit:false});}else if(isValueSelection(selection)){return _objectSpread2(_objectSpread2({},selection),{},{edit:false});}else{return selection;}});if(hasFocus&&refHiddenInput){refHiddenInput.focus();refHiddenInput.blur();}// This is ugly: we need to wait until the EditableDiv has triggered onSelect,
//  and have onSelect call refHiddenInput.focus(). After that we can call blur()
//  to remove the focus.
// TODO: find a better solution
tick().then(function(){setTimeout(function(){if(refHiddenInput){refHiddenInput.blur();}});});}}}function handleDrag(event){if(autoScrollHandler){autoScrollHandler.onDrag(event);}}function handleDragEnd(){if(autoScrollHandler){autoScrollHandler.onDragEnd();}}// Note that we want the context to change as little as possible since it forces all nodes to re-render,
// it should only change when a config option like readOnly or onClassName is changed
var context;function treemenu_showSearch_binding(value){showSearch=value;$$invalidate(18,showSearch);}function input_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refHiddenInput=$$value;$$invalidate(13,refHiddenInput);});}function div1_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refContents=$$value;$$invalidate(8,refContents);});}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refJsonEditor=$$value;$$invalidate(14,refJsonEditor);});}$$self.$$set=function($$props){if('readOnly'in $$props)$$invalidate(0,readOnly=$$props.readOnly);if('externalContent'in $$props)$$invalidate(49,externalContent=$$props.externalContent);if('mainMenuBar'in $$props)$$invalidate(1,mainMenuBar=$$props.mainMenuBar);if('navigationBar'in $$props)$$invalidate(2,navigationBar=$$props.navigationBar);if('escapeControlCharacters'in $$props)$$invalidate(50,escapeControlCharacters=$$props.escapeControlCharacters);if('escapeUnicodeCharacters'in $$props)$$invalidate(51,escapeUnicodeCharacters=$$props.escapeUnicodeCharacters);if('parser'in $$props)$$invalidate(52,parser=$$props.parser);if('validator'in $$props)$$invalidate(53,validator=$$props.validator);if('validationParser'in $$props)$$invalidate(54,validationParser=$$props.validationParser);if('pathParser'in $$props)$$invalidate(3,pathParser=$$props.pathParser);if('indentation'in $$props)$$invalidate(55,indentation=$$props.indentation);if('onError'in $$props)$$invalidate(4,onError=$$props.onError);if('onChange'in $$props)$$invalidate(56,onChange=$$props.onChange);if('onRenderValue'in $$props)$$invalidate(57,onRenderValue=$$props.onRenderValue);if('onRequestRepair'in $$props)$$invalidate(5,onRequestRepair=$$props.onRequestRepair);if('onRenderMenu'in $$props)$$invalidate(6,onRenderMenu=$$props.onRenderMenu);if('onClassName'in $$props)$$invalidate(58,onClassName=$$props.onClassName);if('onFocus'in $$props)$$invalidate(59,_onFocus=$$props.onFocus);if('onBlur'in $$props)$$invalidate(60,_onBlur=$$props.onBlur);if('onSortModal'in $$props)$$invalidate(61,onSortModal=$$props.onSortModal);if('onTransformModal'in $$props)$$invalidate(62,onTransformModal=$$props.onTransformModal);};$$self.$$.update=function(){if($$self.$$.dirty[1]&/*escapeControlCharacters, escapeUnicodeCharacters*/1572864){$$invalidate(71,normalization=createNormalizationFunctions({escapeControlCharacters:escapeControlCharacters,escapeUnicodeCharacters:escapeUnicodeCharacters}));}if($$self.$$.dirty[1]&/*externalContent*/262144){// two-way binding of externalContent and internal json and text (
// when receiving an updated prop, we have to update state for example
applyExternalContent(externalContent);}if($$self.$$.dirty[0]&/*json*/512|$$self.$$.dirty[2]&/*searchText*/1024){applySearchThrottled(searchText,json);}if($$self.$$.dirty[0]&/*text, json*/1536);if($$self.$$.dirty[0]&/*json*/512|$$self.$$.dirty[1]&/*validator, parser, validationParser*/14680064){updateValidationErrors(json,validator,parser,validationParser);}if($$self.$$.dirty[0]&/*validationErrors*/2048){$$invalidate(23,validationErrorsMap=mapValidationErrors(validationErrors));}if($$self.$$.dirty[0]&/*refContents*/256){autoScrollHandler=refContents?createAutoScrollHandler(refContents):undefined;}if($$self.$$.dirty[0]&/*readOnly*/1|$$self.$$.dirty[1]&/*parser, onRenderValue, onClassName*/203423744|$$self.$$.dirty[2]&/*normalization*/512){$$invalidate(12,context={readOnly:readOnly,parser:parser,normalization:normalization,getJson:getJson,getDocumentState:getDocumentState,findElement:findElement,focus:focus,onPatch:handlePatch,onInsert:handleInsert,onExpand:handleExpand,onSelect:updateSelection,onFind:openFind,onExpandSection:handleExpandSection,onPasteJson:handlePasteJson,onRenderValue:onRenderValue,onContextMenu:openContextMenu,onClassName:onClassName||function(){return undefined;},onDrag:handleDrag,onDragEnd:handleDragEnd});}if($$self.$$.dirty[0]&/*context*/4096){debug('context changed',context);}};return[readOnly,mainMenuBar,navigationBar,pathParser,onError,onRequestRepair,onRenderMenu,acceptAutoRepair,refContents,json,text,validationErrors,context,refHiddenInput,refJsonEditor,documentState,searchResult,pastedJson,showSearch,showReplace,searching,historyState,textIsRepaired,validationErrorsMap,isSSR,rootPath,handleSearchText,handleNextSearchResult,handlePreviousSearchResult,handleReplace,handleReplaceAll,clearSearchResult,handleSelectValidationError,handleCopy,handlePaste,handleUndo,handleRedo,handleSortAll,handleTransformAll,handleExpandAll,handleCollapseAll,handleKeyDown,handleMouseDown,handleContextMenu,handleContextMenuFromTreeMenu,handleParsePastedJson,handleClearPastedJson,handleNavigationBarSelect,handleWindowMouseDown,externalContent,escapeControlCharacters,escapeUnicodeCharacters,parser,validator,validationParser,indentation,onChange,onRenderValue,onClassName,_onFocus,_onBlur,onSortModal,onTransformModal,expand,validate,getJson,patch,openTransformModal,scrollTo,findElement,focus,normalization,searchText,treemenu_showSearch_binding,input_binding,div1_binding,div_binding];}var TreeMode=/*#__PURE__*/function(_SvelteComponent38){_inherits(TreeMode,_SvelteComponent38);var _super79=_createSuper(TreeMode);function TreeMode(options){var _this133;_classCallCheck(this,TreeMode);_this133=_super79.call(this);init(_assertThisInitialized(_this133),options,instance$k,create_fragment$k,not_equal,{readOnly:0,externalContent:49,mainMenuBar:1,navigationBar:2,escapeControlCharacters:50,escapeUnicodeCharacters:51,parser:52,validator:53,validationParser:54,pathParser:3,indentation:55,onError:4,onChange:56,onRenderValue:57,onRequestRepair:5,onRenderMenu:6,onClassName:58,onFocus:59,onBlur:60,onSortModal:61,onTransformModal:62,expand:63,validate:64,getJson:65,patch:66,acceptAutoRepair:7,openTransformModal:67,scrollTo:68,findElement:69,focus:70},add_css$i,[-1,-1,-1,-1,-1]);return _this133;}_createClass(TreeMode,[{key:"expand",get:function get(){return this.$$.ctx[63];}},{key:"validate",get:function get(){return this.$$.ctx[64];}},{key:"getJson",get:function get(){return this.$$.ctx[65];}},{key:"patch",get:function get(){return this.$$.ctx[66];}},{key:"acceptAutoRepair",get:function get(){return this.$$.ctx[7];}},{key:"openTransformModal",get:function get(){return this.$$.ctx[67];}},{key:"scrollTo",get:function get(){return this.$$.ctx[68];}},{key:"findElement",get:function get(){return this.$$.ctx[69];}},{key:"focus",get:function get(){return this.$$.ctx[70];}}]);return TreeMode;}(SvelteComponent);var TreeMode$1=TreeMode;var description$2="\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n</p>\n";var javascriptQueryLanguage={id:'javascript',name:'JavaScript',description:description$2,createQuery:createQuery$2,executeQuery:executeQuery$2};exports.javascriptQueryLanguage=javascriptQueryLanguage;function createQuery$2(json,queryOptions){var filter=queryOptions.filter,sort=queryOptions.sort,projection=queryOptions.projection;var queryParts=[];if(filter&&filter.path&&filter.relation&&filter.value){// Note that the comparisons embrace type coercion,
// so a filter value like '5' (text) will match numbers like 5 too.
var actualValueGetter="item => item".concat(createPropertySelector(filter.path));var filterValue=parseString(filter.value);var filterValueStr=typeof filterValue==='string'?"'".concat(filter.value,"'"):isInteger$1(filter.value)&&!Number.isSafeInteger(filterValue)?"".concat(filter.value,"n")// bigint
:filter.value;queryParts.push("  data = data.filter(".concat(actualValueGetter," ").concat(filter.relation," ").concat(filterValueStr,")\n"));}if(sort&&sort.path&&sort.direction){if(sort.direction==='desc'){queryParts.push("  data = data.slice().sort((a, b) => {\n"+"    // sort descending\n"+"    const valueA = a".concat(createPropertySelector(sort.path),"\n")+"    const valueB = b".concat(createPropertySelector(sort.path),"\n")+"    return valueA > valueB ? -1 : valueA < valueB ? 1 : 0\n"+"  })\n");}else{// sort direction 'asc'
queryParts.push("  data = data.slice().sort((a, b) => {\n"+"    // sort ascending\n"+"    const valueA = a".concat(createPropertySelector(sort.path),"\n")+"    const valueB = b".concat(createPropertySelector(sort.path),"\n")+"    return valueA > valueB ? 1 : valueA < valueB ? -1 : 0\n"+"  })\n");}}if(projection&&projection.paths){// It is possible to make a util function "pickFlat"
// and use that when building the query to make it more readable.
if(projection.paths.length>1){var paths=projection.paths.map(function(path){var name=path[path.length-1]||'item';// 'item' in case of having selected the whole item
var item="item".concat(createPropertySelector(path));return"    ".concat(JSON.stringify(name),": ").concat(item);});queryParts.push("  data = data.map(item => ({\n".concat(paths.join(',\n'),"})\n  )\n"));}else{var item="item".concat(createPropertySelector(projection.paths[0]));queryParts.push("  data = data.map(item => ".concat(item,")\n"));}}queryParts.push('  return data\n');return"function query (data) {\n".concat(queryParts.join(''),"}");}function executeQuery$2(json,query){// FIXME: replace unsafe new Function with a JS based query language
//  As long as we don't persist or fetch queries, there is no security risk.
// TODO: only import the most relevant subset of lodash instead of the full library?
// eslint-disable-next-line no-new-func
var queryFn=new Function('"use strict";\n'+'\n'+query+'\n'+'\n'+'if (typeof query !== "function") {\n'+'  throw new Error("Cannot execute query: expecting a function named \'query\' but is undefined")\n'+'}\n'+'\n'+'return query;\n')();var output=queryFn(json);return output!==undefined?output:null;}/* src/lib/plugins/value/components/BooleanToggle.svelte generated by Svelte v3.51.0 */function add_css$h(target){append_styles(target,"svelte-zs5o25",".jse-boolean-toggle.svelte-zs5o25{color:var(--jse-value-color-boolean);position:relative;padding-left:calc(0.5 * var(--jse-padding));padding-top:1px;height:var(--jse-line-height)}");}function create_fragment$j(ctx){var div;var icon;var div_title_value;var current;var mounted;var dispose;icon=new Icon({props:{data:/*value*/ctx[0]===true?faCheckSquare:faSquare}});return{c:function c(){div=element("div");create_component(icon.$$.fragment);attr(div,"class","jse-boolean-toggle svelte-zs5o25");attr(div,"title",div_title_value=!/*readOnly*/ctx[1]?'Click to toggle this boolean value':"Boolean value ".concat(/*value*/ctx[0]));},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(icon,div,null);current=true;if(!mounted){dispose=listen(div,"mousedown",/*toggleBooleanValue*/ctx[2]);mounted=true;}},p:function p(ctx,_ref148){var _ref149=_slicedToArray(_ref148,1),dirty=_ref149[0];var icon_changes={};if(dirty&/*value*/1)icon_changes.data=/*value*/ctx[0]===true?faCheckSquare:faSquare;icon.$set(icon_changes);if(!current||dirty&/*readOnly, value*/3&&div_title_value!==(div_title_value=!/*readOnly*/ctx[1]?'Click to toggle this boolean value':"Boolean value ".concat(/*value*/ctx[0]))){attr(div,"title",div_title_value);}},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(icon);mounted=false;dispose();}};}function instance$j($$self,$$props,$$invalidate){var path=$$props.path;var value=$$props.value;var readOnly=$$props.readOnly;var onPatch=$$props.onPatch;var focus=$$props.focus;function toggleBooleanValue(event){event.stopPropagation();if(readOnly){return;}onPatch([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:!value}]);setTimeout(focus);}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(3,path=$$props.path);if('value'in $$props)$$invalidate(0,value=$$props.value);if('readOnly'in $$props)$$invalidate(1,readOnly=$$props.readOnly);if('onPatch'in $$props)$$invalidate(4,onPatch=$$props.onPatch);if('focus'in $$props)$$invalidate(5,focus=$$props.focus);};return[value,readOnly,toggleBooleanValue,path,onPatch,focus];}var BooleanToggle=/*#__PURE__*/function(_SvelteComponent39){_inherits(BooleanToggle,_SvelteComponent39);var _super80=_createSuper(BooleanToggle);function BooleanToggle(options){var _this134;_classCallCheck(this,BooleanToggle);_this134=_super80.call(this);init(_assertThisInitialized(_this134),options,instance$j,create_fragment$j,not_equal,{path:3,value:0,readOnly:1,onPatch:4,focus:5},add_css$h);return _this134;}return _createClass(BooleanToggle);}(SvelteComponent);var BooleanToggle$1=BooleanToggle;/* src/lib/components/controls/ColorPickerPopup.svelte generated by Svelte v3.51.0 */exports.BooleanToggle=BooleanToggle$1;function add_css$g(target){append_styles(target,"svelte-1gn8yt9",".jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup,.jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup .picker_arrow::before,.jse-color-picker-popup.svelte-1gn8yt9 .picker_wrapper.popup .picker_arrow::after{background:var(--jse-color-picker-background);line-height:normal}.jse-color-picker-popup.svelte-1gn8yt9 .picker_slider,.jse-color-picker-popup.svelte-1gn8yt9 .picker_sl,.jse-color-picker-popup.svelte-1gn8yt9 .picker_editor input,.jse-color-picker-popup.svelte-1gn8yt9 .picker_sample,.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button{box-shadow:var(--jse-color-picker-border-box-shadow)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_editor input{background:var(--jse-background-color);color:var(--jse-text-color)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button{background:var(--jse-button-background);color:var(--jse-button-color)}.jse-color-picker-popup.svelte-1gn8yt9 .picker_done button:hover{background:var(--jse-button-background-highlight)}");}function create_fragment$i(ctx){var div;return{c:function c(){div=element("div");attr(div,"class","jse-color-picker-popup svelte-1gn8yt9");},m:function m(target,anchor){insert$2(target,div,anchor);/*div_binding*/ctx[4](div);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);/*div_binding*/ctx[4](null);}};}function instance$i($$self,$$props,$$invalidate){var color=$$props.color;var onChange=$$props.onChange;var showOnTop=$$props.showOnTop;var ref;var colorPicker;onMount(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee16(){var VanillaPicker;return _regeneratorRuntime().wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:_context16.next=2;return Promise.resolve().then(function(){return vanillaPicker;});case 2:VanillaPicker=_context16.sent["default"];colorPicker=new VanillaPicker({parent:ref,color:color,popup:showOnTop?'top':'bottom',onDone:function onDone(color){var alpha=color.rgba[3];var hex=alpha===1?color.hex.substring(0,7):color.hex;// return #RRGGBB
// return #RRGGBBAA
onChange(hex);}});colorPicker.show();case 5:case"end":return _context16.stop();}}},_callee16);})));onDestroy(function(){if(colorPicker){colorPicker.destroy();}});function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){ref=$$value;$$invalidate(0,ref);});}$$self.$$set=function($$props){if('color'in $$props)$$invalidate(1,color=$$props.color);if('onChange'in $$props)$$invalidate(2,onChange=$$props.onChange);if('showOnTop'in $$props)$$invalidate(3,showOnTop=$$props.showOnTop);};return[ref,color,onChange,showOnTop,div_binding];}var ColorPickerPopup=/*#__PURE__*/function(_SvelteComponent40){_inherits(ColorPickerPopup,_SvelteComponent40);var _super81=_createSuper(ColorPickerPopup);function ColorPickerPopup(options){var _this135;_classCallCheck(this,ColorPickerPopup);_this135=_super81.call(this);init(_assertThisInitialized(_this135),options,instance$i,create_fragment$i,safe_not_equal,{color:1,onChange:2,showOnTop:3},add_css$g);return _this135;}return _createClass(ColorPickerPopup);}(SvelteComponent);var ColorPickerPopup$1=ColorPickerPopup;/* src/lib/plugins/value/components/ColorPicker.svelte generated by Svelte v3.51.0 */function add_css$f(target){append_styles(target,"svelte-fk1u9y",".jse-color-picker-button.svelte-fk1u9y{font-size:var(--jse-font-size-mono);width:var(--jse-color-picker-button-size);height:var(--jse-color-picker-button-size);box-sizing:border-box;padding:0;margin:2px;border:1px solid var(--jse-text-color);border-radius:2px;background:inherit;outline:none;cursor:pointer}");}function create_fragment$h(ctx){var button;var button_title_value;var mounted;var dispose;return{c:function c(){button=element("button");attr(button,"type","button");attr(button,"class","jse-color-picker-button svelte-fk1u9y");set_style(button,"background",/*color*/ctx[2]);attr(button,"title",button_title_value=!/*readOnly*/ctx[1]?'Click to open a color picker':"Color ".concat(/*value*/ctx[0]));},m:function m(target,anchor){insert$2(target,button,anchor);if(!mounted){dispose=listen(button,"click",/*openColorPicker*/ctx[3]);mounted=true;}},p:function p(ctx,_ref151){var _ref152=_slicedToArray(_ref151,1),dirty=_ref152[0];if(dirty&/*color*/4){set_style(button,"background",/*color*/ctx[2]);}if(dirty&/*readOnly, value*/3&&button_title_value!==(button_title_value=!/*readOnly*/ctx[1]?'Click to open a color picker':"Color ".concat(/*value*/ctx[0]))){attr(button,"title",button_title_value);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(button);mounted=false;dispose();}};}function instance$h($$self,$$props,$$invalidate){var color;var _getContext7=getContext('absolute-popup'),openAbsolutePopup=_getContext7.openAbsolutePopup;var path=$$props.path;var value=$$props.value;var readOnly=$$props.readOnly;var onPatch=$$props.onPatch;var focus=$$props.focus;function onChange(color){onPatch([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:color}]);onClose();}function onClose(){focus();}function openColorPicker(event){if(readOnly){return;}// estimate of the color picker height
// we'll render the color picker on top
// when there is not enough space below, and there is enough space above
var height=300;var top=event.target.getBoundingClientRect().top;var windowHeight=_getWindow(event.target).innerHeight;var showOnTop=windowHeight-top<height&&top>height;var props={color:value,onChange:onChange,showOnTop:showOnTop};openAbsolutePopup(ColorPickerPopup$1,props,{anchor:event.target,closeOnOuterClick:true,onClose:onClose,offsetTop:18,offsetLeft:-8,height:height});}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(4,path=$$props.path);if('value'in $$props)$$invalidate(0,value=$$props.value);if('readOnly'in $$props)$$invalidate(1,readOnly=$$props.readOnly);if('onPatch'in $$props)$$invalidate(5,onPatch=$$props.onPatch);if('focus'in $$props)$$invalidate(6,focus=$$props.focus);};$$self.$$.update=function(){if($$self.$$.dirty&/*value*/1){$$invalidate(2,color=getColorCSS(value));}};return[value,readOnly,color,openColorPicker,path,onPatch,focus];}var ColorPicker=/*#__PURE__*/function(_SvelteComponent41){_inherits(ColorPicker,_SvelteComponent41);var _super82=_createSuper(ColorPicker);function ColorPicker(options){var _this136;_classCallCheck(this,ColorPicker);_this136=_super82.call(this);init(_assertThisInitialized(_this136),options,instance$h,create_fragment$h,not_equal,{path:4,value:0,readOnly:1,onPatch:5,focus:6},add_css$f);return _this136;}return _createClass(ColorPicker);}(SvelteComponent);var ColorPicker$1=ColorPicker;exports.ColorPicker=ColorPicker$1;function getValueClass(value,parser){var type=valueType(value,parser);return classnames('jse-value','jse-'+type,{'jse-url':isUrl(value),'jse-empty':typeof value==='string'&&value.length===0});}/* src/lib/plugins/value/components/EditableValue.svelte generated by Svelte v3.51.0 */function create_fragment$g(ctx){var editablediv;var current;editablediv=new EditableDiv$1({props:{value:/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]),onChange:/*handleChangeValue*/ctx[3],onCancel:/*handleCancelChange*/ctx[4],onPaste:/*handlePaste*/ctx[5],onFind:/*onFind*/ctx[2],onValueClass:/*handleOnValueClass*/ctx[6]}});return{c:function c(){create_component(editablediv.$$.fragment);},m:function m(target,anchor){mount_component(editablediv,target,anchor);current=true;},p:function p(ctx,_ref153){var _ref154=_slicedToArray(_ref153,1),dirty=_ref154[0];var editablediv_changes={};if(dirty&/*normalization, value*/3)editablediv_changes.value=/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]);if(dirty&/*onFind*/4)editablediv_changes.onFind=/*onFind*/ctx[2];editablediv.$set(editablediv_changes);},i:function i(local){if(current)return;transition_in(editablediv.$$.fragment,local);current=true;},o:function o(local){transition_out(editablediv.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(editablediv,detaching);}};}function instance$g($$self,$$props,$$invalidate){var path=$$props.path;var value=$$props.value;var parser=$$props.parser;var normalization=$$props.normalization;var enforceString=$$props.enforceString;var onPatch=$$props.onPatch;var onPasteJson=$$props.onPasteJson;var onSelect=$$props.onSelect;var onFind=$$props.onFind;var focus=$$props.focus;function convert(value){return enforceString?value:stringConvert(value,parser);}function handleChangeValue(newValue,updateSelection){onPatch([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:convert(normalization.unescapeValue(newValue))}],function(patchedJson,patchedState){var selection=updateSelection===UPDATE_SELECTION.NEXT_INSIDE?getSelectionNextInside(patchedJson,patchedState,path)||patchedState.selection:createValueSelection(path,false);return{state:_objectSpread2(_objectSpread2({},patchedState),{},{selection:selection})};});if(updateSelection!==UPDATE_SELECTION.SELF){focus();}}function handleCancelChange(){onSelect(createValueSelection(path,false));focus();}function handlePaste(pastedText){try{var pastedJson=parser.parse(pastedText);if(isObjectOrArray(pastedJson)){onPasteJson({path:path,contents:pastedJson});}}catch(err){}// silently ignore: thee pasted text is no valid JSON object or array,
}function handleOnValueClass(value){return getValueClass(convert(normalization.unescapeValue(value)),parser);}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(7,path=$$props.path);if('value'in $$props)$$invalidate(0,value=$$props.value);if('parser'in $$props)$$invalidate(8,parser=$$props.parser);if('normalization'in $$props)$$invalidate(1,normalization=$$props.normalization);if('enforceString'in $$props)$$invalidate(9,enforceString=$$props.enforceString);if('onPatch'in $$props)$$invalidate(10,onPatch=$$props.onPatch);if('onPasteJson'in $$props)$$invalidate(11,onPasteJson=$$props.onPasteJson);if('onSelect'in $$props)$$invalidate(12,onSelect=$$props.onSelect);if('onFind'in $$props)$$invalidate(2,onFind=$$props.onFind);if('focus'in $$props)$$invalidate(13,focus=$$props.focus);};return[value,normalization,onFind,handleChangeValue,handleCancelChange,handlePaste,handleOnValueClass,path,parser,enforceString,onPatch,onPasteJson,onSelect,focus];}var EditableValue=/*#__PURE__*/function(_SvelteComponent42){_inherits(EditableValue,_SvelteComponent42);var _super83=_createSuper(EditableValue);function EditableValue(options){var _this137;_classCallCheck(this,EditableValue);_this137=_super83.call(this);init(_assertThisInitialized(_this137),options,instance$g,create_fragment$g,not_equal,{path:7,value:0,parser:8,normalization:1,enforceString:9,onPatch:10,onPasteJson:11,onSelect:12,onFind:2,focus:13});return _this137;}return _createClass(EditableValue);}(SvelteComponent);var EditableValue$1=EditableValue;/* src/lib/plugins/value/components/ReadonlyValue.svelte generated by Svelte v3.51.0 */exports.EditableValue=EditableValue$1;function add_css$e(target){append_styles(target,"svelte-6ci2p7",".jse-value.jse-string.svelte-6ci2p7{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-6ci2p7,.jse-value.jse-array.svelte-6ci2p7{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-6ci2p7{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-6ci2p7{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-6ci2p7{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-6ci2p7{color:var(--jse-text-color)}.jse-value.jse-url.svelte-6ci2p7{color:var(--jse-value-color-url);text-decoration:underline}.jse-value.svelte-6ci2p7{min-width:2em;padding:0 5px;box-sizing:border-box;outline:none;border-radius:1px;vertical-align:top;word-break:normal;overflow-wrap:anywhere;white-space:pre-wrap}.jse-value.svelte-6ci2p7:hover{background:var(--jse-hover-background-color)}.jse-value.jse-empty.svelte-6ci2p7{min-width:4em;outline:1px dotted var(--jse-tag-background);-moz-outline-radius:2px}.jse-value.jse-empty.svelte-6ci2p7::after{pointer-events:none;color:var(--jse-tag-background);content:\"value\"}");}// (40:2) {:else}
function create_else_block$5(ctx){var t_value=addNewLineSuffix(/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]))+"";var t;return{c:function c(){t=text(t_value);},m:function m(target,anchor){insert$2(target,t,anchor);},p:function p(ctx,dirty){if(dirty&/*normalization, value*/3&&t_value!==(t_value=addNewLineSuffix(/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]))+""))set_data(t,t_value);},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(t);}};}// (38:2) {#if searchResultItems}
function create_if_block$8(ctx){var searchresulthighlighter;var current;searchresulthighlighter=new SearchResultHighlighter$1({props:{text:/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]),searchResultItems:/*searchResultItems*/ctx[3]}});return{c:function c(){create_component(searchresulthighlighter.$$.fragment);},m:function m(target,anchor){mount_component(searchresulthighlighter,target,anchor);current=true;},p:function p(ctx,dirty){var searchresulthighlighter_changes={};if(dirty&/*normalization, value*/3)searchresulthighlighter_changes.text=/*normalization*/ctx[1].escapeValue(/*value*/ctx[0]);if(dirty&/*searchResultItems*/8)searchresulthighlighter_changes.searchResultItems=/*searchResultItems*/ctx[3];searchresulthighlighter.$set(searchresulthighlighter_changes);},i:function i(local){if(current)return;transition_in(searchresulthighlighter.$$.fragment,local);current=true;},o:function o(local){transition_out(searchresulthighlighter.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(searchresulthighlighter,detaching);}};}function create_fragment$f(ctx){var div;var current_block_type_index;var if_block;var div_class_value;var div_title_value;var current;var mounted;var dispose;var if_block_creators=[create_if_block$8,create_else_block$5];var if_blocks=[];function select_block_type(ctx,dirty){if(/*searchResultItems*/ctx[3])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if_block.c();attr(div,"data-type","selectable-value");attr(div,"class",div_class_value=""+(null_to_empty(getValueClass(/*value*/ctx[0],/*parser*/ctx[2]))+" svelte-6ci2p7"));attr(div,"title",div_title_value=/*valueIsUrl*/ctx[4]?'Ctrl+Click or Ctrl+Enter to open url in new window':null);},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);current=true;if(!mounted){dispose=[listen(div,"click",/*handleValueClick*/ctx[5]),listen(div,"dblclick",/*handleValueDoubleClick*/ctx[6])];mounted=true;}},p:function p(ctx,_ref155){var _ref156=_slicedToArray(_ref155,1),dirty=_ref156[0];var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,null);}if(!current||dirty&/*value, parser*/5&&div_class_value!==(div_class_value=""+(null_to_empty(getValueClass(/*value*/ctx[0],/*parser*/ctx[2]))+" svelte-6ci2p7"))){attr(div,"class",div_class_value);}if(!current||dirty&/*valueIsUrl*/16&&div_title_value!==(div_title_value=/*valueIsUrl*/ctx[4]?'Ctrl+Click or Ctrl+Enter to open url in new window':null)){attr(div,"title",div_title_value);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();mounted=false;run_all(dispose);}};}function instance$f($$self,$$props,$$invalidate){var valueIsUrl;var path=$$props.path;var value=$$props.value;var readOnly=$$props.readOnly;var normalization=$$props.normalization;var parser=$$props.parser;var onSelect=$$props.onSelect;var searchResultItems=$$props.searchResultItems;function handleValueClick(event){if(typeof value==='string'&&valueIsUrl&&event.ctrlKey){event.preventDefault();event.stopPropagation();window.open(value,'_blank');}}function handleValueDoubleClick(event){if(!readOnly){event.preventDefault();onSelect(createValueSelection(path,true));}}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(7,path=$$props.path);if('value'in $$props)$$invalidate(0,value=$$props.value);if('readOnly'in $$props)$$invalidate(8,readOnly=$$props.readOnly);if('normalization'in $$props)$$invalidate(1,normalization=$$props.normalization);if('parser'in $$props)$$invalidate(2,parser=$$props.parser);if('onSelect'in $$props)$$invalidate(9,onSelect=$$props.onSelect);if('searchResultItems'in $$props)$$invalidate(3,searchResultItems=$$props.searchResultItems);};$$self.$$.update=function(){if($$self.$$.dirty&/*value*/1){$$invalidate(4,valueIsUrl=isUrl(value));}};return[value,normalization,parser,searchResultItems,valueIsUrl,handleValueClick,handleValueDoubleClick,path,readOnly,onSelect];}var ReadonlyValue=/*#__PURE__*/function(_SvelteComponent43){_inherits(ReadonlyValue,_SvelteComponent43);var _super84=_createSuper(ReadonlyValue);function ReadonlyValue(options){var _this138;_classCallCheck(this,ReadonlyValue);_this138=_super84.call(this);init(_assertThisInitialized(_this138),options,instance$f,create_fragment$f,not_equal,{path:7,value:0,readOnly:8,normalization:1,parser:2,onSelect:9,searchResultItems:3},add_css$e);return _this138;}return _createClass(ReadonlyValue);}(SvelteComponent);var ReadonlyValue$1=ReadonlyValue;/* src/lib/plugins/value/components/TimestampTag.svelte generated by Svelte v3.51.0 */exports.ReadonlyValue=ReadonlyValue$1;function add_css$d(target){append_styles(target,"svelte-1u00zub",".jse-timestamp.svelte-1u00zub{padding:0;margin:0;height:var(--jse-line-height);color:var(--jse-value-color-number);border-radius:3px}");}function create_fragment$e(ctx){var div;var icon;var tooltip_action;var current;var mounted;var dispose;icon=new Icon({props:{data:faClock}});return{c:function c(){div=element("div");create_component(icon.$$.fragment);attr(div,"class","jse-timestamp svelte-1u00zub");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(icon,div,null);current=true;if(!mounted){dispose=action_destroyer(tooltip_action=tooltip.call(null,div,_objectSpread2({text:/*text*/ctx[0]},/*absolutePopupContext*/ctx[1])));mounted=true;}},p:function p(ctx,_ref157){var _ref158=_slicedToArray(_ref157,1),dirty=_ref158[0];if(tooltip_action&&is_function(tooltip_action.update)&&dirty&/*text*/1)tooltip_action.update.call(null,_objectSpread2({text:/*text*/ctx[0]},/*absolutePopupContext*/ctx[1]));},i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(icon);mounted=false;dispose();}};}function instance$e($$self,$$props,$$invalidate){var text;var absolutePopupContext=getContext('absolute-popup');var value=$$props.value;$$self.$$set=function($$props){if('value'in $$props)$$invalidate(2,value=$$props.value);};$$self.$$.update=function(){if($$self.$$.dirty&/*value*/4){$$invalidate(0,text="Time: ".concat(new Date(value).toString()));}};return[text,absolutePopupContext,value];}var TimestampTag=/*#__PURE__*/function(_SvelteComponent44){_inherits(TimestampTag,_SvelteComponent44);var _super85=_createSuper(TimestampTag);function TimestampTag(options){var _this139;_classCallCheck(this,TimestampTag);_this139=_super85.call(this);init(_assertThisInitialized(_this139),options,instance$e,create_fragment$e,not_equal,{value:2},add_css$d);return _this139;}return _createClass(TimestampTag);}(SvelteComponent);var TimestampTag$1=TimestampTag;exports.TimestampTag=TimestampTag$1;function renderValue(_ref159){var path=_ref159.path,value=_ref159.value,readOnly=_ref159.readOnly,enforceString=_ref159.enforceString,searchResultItems=_ref159.searchResultItems,isEditing=_ref159.isEditing,parser=_ref159.parser,normalization=_ref159.normalization,onPatch=_ref159.onPatch,onPasteJson=_ref159.onPasteJson,onSelect=_ref159.onSelect,onFind=_ref159.onFind,focus=_ref159.focus;var renderers=[];if(!isEditing&&isBoolean$1(value)){renderers.push({component:BooleanToggle$1,props:{path:path,value:value,readOnly:readOnly,onPatch:onPatch,focus:focus}});}if(!isEditing&&isColor(value)){renderers.push({component:ColorPicker$1,props:{path:path,value:value,readOnly:readOnly,onPatch:onPatch,focus:focus}});}if(isEditing){renderers.push({component:EditableValue$1,props:{path:path,value:value,enforceString:enforceString,parser:parser,normalization:normalization,onPatch:onPatch,onPasteJson:onPasteJson,onSelect:onSelect,onFind:onFind,focus:focus}});}if(!isEditing){renderers.push({component:ReadonlyValue$1,props:{path:path,value:value,readOnly:readOnly,parser:parser,normalization:normalization,searchResultItems:searchResultItems,onSelect:onSelect}});}if(!isEditing&&isTimestamp(value)){renderers.push({component:TimestampTag$1,props:{value:value}});}return renderers;}var transformModalState={};function isOutOfViewport(parent,container){var parentBounding=parent.getBoundingClientRect();var boundingContainer=container.getBoundingClientRect();var out={};out.top=parentBounding.top<0;out.left=parentBounding.left<0;out.bottom=parentBounding.bottom+boundingContainer.height>(window.innerHeight||document.documentElement.clientHeight);out.right=parentBounding.right>(window.innerWidth||document.documentElement.clientWidth);out.any=out.top||out.left||out.bottom||out.right;return out;}/* node_modules/svelte-select/src/Item.svelte generated by Svelte v3.51.0 */function add_css$c(target){append_styles(target,"svelte-3e0qet",".item.svelte-3e0qet{cursor:default;height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--itemPadding, 0 20px);color:var(--itemColor, inherit);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.groupHeader.svelte-3e0qet{text-transform:var(--groupTitleTextTransform, uppercase)}.groupItem.svelte-3e0qet{padding-left:var(--groupItemPaddingLeft, 40px)}.item.svelte-3e0qet:active{background:var(--itemActiveBackground, #b9daff)}.item.active.svelte-3e0qet{background:var(--itemIsActiveBG, #007aff);color:var(--itemIsActiveColor, #fff)}.item.notSelectable.svelte-3e0qet{color:var(--itemIsNotSelectableColor, #999)}.item.first.svelte-3e0qet{border-radius:var(--itemFirstBorderRadius, 4px 4px 0 0)}.item.hover.svelte-3e0qet:not(.active){background:var(--itemHoverBG, #e7f2ff);color:var(--itemHoverColor, inherit)}");}function create_fragment$d(ctx){var div;var raw_value=/*getOptionLabel*/ctx[0](/*item*/ctx[1],/*filterText*/ctx[2])+"";var div_class_value;return{c:function c(){div=element("div");attr(div,"class",div_class_value="item "+/*itemClasses*/ctx[3]+" svelte-3e0qet");},m:function m(target,anchor){insert$2(target,div,anchor);div.innerHTML=raw_value;},p:function p(ctx,_ref160){var _ref161=_slicedToArray(_ref160,1),dirty=_ref161[0];if(dirty&/*getOptionLabel, item, filterText*/7&&raw_value!==(raw_value=/*getOptionLabel*/ctx[0](/*item*/ctx[1],/*filterText*/ctx[2])+""))div.innerHTML=raw_value;if(dirty&/*itemClasses*/8&&div_class_value!==(div_class_value="item "+/*itemClasses*/ctx[3]+" svelte-3e0qet")){attr(div,"class",div_class_value);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}function instance$d($$self,$$props,$$invalidate){var _$$props$isActive=$$props.isActive,isActive=_$$props$isActive===void 0?false:_$$props$isActive;var _$$props$isFirst=$$props.isFirst,isFirst=_$$props$isFirst===void 0?false:_$$props$isFirst;var _$$props$isHover=$$props.isHover,isHover=_$$props$isHover===void 0?false:_$$props$isHover;var _$$props$isSelectable=$$props.isSelectable,isSelectable=_$$props$isSelectable===void 0?false:_$$props$isSelectable;var _$$props$getOptionLab=$$props.getOptionLabel,getOptionLabel=_$$props$getOptionLab===void 0?undefined:_$$props$getOptionLab;var _$$props$item=$$props.item,item=_$$props$item===void 0?undefined:_$$props$item;var _$$props$filterText=$$props.filterText,filterText=_$$props$filterText===void 0?'':_$$props$filterText;var itemClasses='';$$self.$$set=function($$props){if('isActive'in $$props)$$invalidate(4,isActive=$$props.isActive);if('isFirst'in $$props)$$invalidate(5,isFirst=$$props.isFirst);if('isHover'in $$props)$$invalidate(6,isHover=$$props.isHover);if('isSelectable'in $$props)$$invalidate(7,isSelectable=$$props.isSelectable);if('getOptionLabel'in $$props)$$invalidate(0,getOptionLabel=$$props.getOptionLabel);if('item'in $$props)$$invalidate(1,item=$$props.item);if('filterText'in $$props)$$invalidate(2,filterText=$$props.filterText);};$$self.$$.update=function(){if($$self.$$.dirty&/*isActive, isFirst, isHover, item, isSelectable*/242){{var classes=[];if(isActive){classes.push('active');}if(isFirst){classes.push('first');}if(isHover){classes.push('hover');}if(item.isGroupHeader){classes.push('groupHeader');}if(item.isGroupItem){classes.push('groupItem');}if(!isSelectable){classes.push('notSelectable');}$$invalidate(3,itemClasses=classes.join(' '));}}};return[getOptionLabel,item,filterText,itemClasses,isActive,isFirst,isHover,isSelectable];}var Item=/*#__PURE__*/function(_SvelteComponent45){_inherits(Item,_SvelteComponent45);var _super86=_createSuper(Item);function Item(options){var _this140;_classCallCheck(this,Item);_this140=_super86.call(this);init(_assertThisInitialized(_this140),options,instance$d,create_fragment$d,safe_not_equal,{isActive:4,isFirst:5,isHover:6,isSelectable:7,getOptionLabel:0,item:1,filterText:2},add_css$c);return _this140;}return _createClass(Item);}(SvelteComponent);/* node_modules/svelte-select/src/List.svelte generated by Svelte v3.51.0 */function add_css$b(target){append_styles(target,"svelte-1uyqfml",".listContainer.svelte-1uyqfml{box-shadow:var(--listShadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));border-radius:var(--listBorderRadius, 4px);max-height:var(--listMaxHeight, 250px);overflow-y:auto;background:var(--listBackground, #fff);border:var(--listBorder, none);position:var(--listPosition, absolute);z-index:var(--listZIndex, 2);width:100%;left:var(--listLeft, 0);right:var(--listRight, 0)}.virtualList.svelte-1uyqfml{height:var(--virtualListHeight, 200px)}.listGroupTitle.svelte-1uyqfml{color:var(--groupTitleColor, #8f8f8f);cursor:default;font-size:var(--groupTitleFontSize, 12px);font-weight:var(--groupTitleFontWeight, 600);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--groupTitlePadding, 0 20px);text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap;text-transform:var(--groupTitleTextTransform, uppercase)}.empty.svelte-1uyqfml{text-align:var(--listEmptyTextAlign, center);padding:var(--listEmptyPadding, 20px 0);color:var(--listEmptyColor, #78848f)}");}function get_each_context$5(ctx,list,i){var child_ctx=ctx.slice();child_ctx[41]=list[i];child_ctx[42]=i;return child_ctx;}// (309:4) {:else}
function create_else_block$4(ctx){var each_1_anchor;var current;var each_value=/*items*/ctx[1];var each_blocks=[];for(var _i291=0;_i291<each_value.length;_i291+=1){each_blocks[_i291]=create_each_block$5(get_each_context$5(ctx,each_value,_i291));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};var each_1_else=null;if(!each_value.length){each_1_else=create_else_block_2(ctx);}return{c:function c(){for(var _i292=0;_i292<each_blocks.length;_i292+=1){each_blocks[_i292].c();}each_1_anchor=empty$1();if(each_1_else){each_1_else.c();}},m:function m(target,anchor){for(var _i293=0;_i293<each_blocks.length;_i293+=1){each_blocks[_i293].m(target,anchor);}insert$2(target,each_1_anchor,anchor);if(each_1_else){each_1_else.m(target,anchor);}current=true;},p:function p(ctx,dirty){if(dirty[0]&/*getGroupHeaderLabel, items, handleHover, handleClick, Item, filterText, getOptionLabel, value, optionIdentifier, hoverItemIndex, noOptionsMessage, hideEmptyState*/114390){each_value=/*items*/ctx[1];var _i294;for(_i294=0;_i294<each_value.length;_i294+=1){var child_ctx=get_each_context$5(ctx,each_value,_i294);if(each_blocks[_i294]){each_blocks[_i294].p(child_ctx,dirty);transition_in(each_blocks[_i294],1);}else{each_blocks[_i294]=create_each_block$5(child_ctx);each_blocks[_i294].c();transition_in(each_blocks[_i294],1);each_blocks[_i294].m(each_1_anchor.parentNode,each_1_anchor);}}group_outros();for(_i294=each_value.length;_i294<each_blocks.length;_i294+=1){out(_i294);}check_outros();if(!each_value.length&&each_1_else){each_1_else.p(ctx,dirty);}else if(!each_value.length){each_1_else=create_else_block_2(ctx);each_1_else.c();each_1_else.m(each_1_anchor.parentNode,each_1_anchor);}else if(each_1_else){each_1_else.d(1);each_1_else=null;}}},i:function i(local){if(current)return;for(var _i295=0;_i295<each_value.length;_i295+=1){transition_in(each_blocks[_i295]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i296=0;_i296<each_blocks.length;_i296+=1){transition_out(each_blocks[_i296]);}current=false;},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);if(each_1_else)each_1_else.d(detaching);}};}// (286:4) {#if isVirtualList}
function create_if_block$7(ctx){var switch_instance;var switch_instance_anchor;var current;var switch_value=/*VirtualList*/ctx[3];function switch_props(ctx){return{props:{items:/*items*/ctx[1],itemHeight:/*itemHeight*/ctx[8],$$slots:{"default":[create_default_slot$2,function(_ref162){var item=_ref162.item,i=_ref162.i;return{41:item,42:i};},function(_ref163){var item=_ref163.item,i=_ref163.i;return[0,(item?1024:0)|(i?2048:0)];}]},$$scope:{ctx:ctx}}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){var switch_instance_changes={};if(dirty[0]&/*items*/2)switch_instance_changes.items=/*items*/ctx[1];if(dirty[0]&/*itemHeight*/256)switch_instance_changes.itemHeight=/*itemHeight*/ctx[8];if(dirty[0]&/*Item, filterText, getOptionLabel, value, optionIdentifier, hoverItemIndex, items*/9814|dirty[1]&/*$$scope, i, item*/11264){switch_instance_changes.$$scope={dirty:dirty,ctx:ctx};}if(switch_value!==(switch_value=/*VirtualList*/ctx[3])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}// (331:8) {:else}
function create_else_block_2(ctx){var if_block_anchor;var if_block=!/*hideEmptyState*/ctx[11]&&create_if_block_2$2(ctx);return{c:function c(){if(if_block)if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if(if_block)if_block.m(target,anchor);insert$2(target,if_block_anchor,anchor);},p:function p(ctx,dirty){if(!/*hideEmptyState*/ctx[11]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block_2$2(ctx);if_block.c();if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){if_block.d(1);if_block=null;}},d:function d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (332:12) {#if !hideEmptyState}
function create_if_block_2$2(ctx){var div;var t;return{c:function c(){div=element("div");t=text(/*noOptionsMessage*/ctx[12]);attr(div,"class","empty svelte-1uyqfml");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t);},p:function p(ctx,dirty){if(dirty[0]&/*noOptionsMessage*/4096)set_data(t,/*noOptionsMessage*/ctx[12]);},d:function d(detaching){if(detaching)detach(div);}};}// (313:12) {:else}
function create_else_block_1$1(ctx){var div;var switch_instance;var t;var current;var mounted;var dispose;var switch_value=/*Item*/ctx[4];function switch_props(ctx){return{props:{item:/*item*/ctx[41],filterText:/*filterText*/ctx[13],getOptionLabel:/*getOptionLabel*/ctx[6],isFirst:isItemFirst(/*i*/ctx[42]),isActive:isItemActive(/*item*/ctx[41],/*value*/ctx[9],/*optionIdentifier*/ctx[10]),isHover:isItemHover(/*hoverItemIndex*/ctx[2],/*item*/ctx[41],/*i*/ctx[42],/*items*/ctx[1]),isSelectable:isItemSelectable(/*item*/ctx[41])}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));}function mouseover_handler_1(){return(/*mouseover_handler_1*/ctx[29](/*i*/ctx[42]));}function focus_handler_1(){return(/*focus_handler_1*/ctx[30](/*i*/ctx[42]));}function click_handler_1(){var _ctx;for(var _len8=arguments.length,args=new Array(_len8),_key10=0;_key10<_len8;_key10++){args[_key10]=arguments[_key10];}return(/*click_handler_1*/(_ctx=ctx)[31].apply(_ctx,[/*item*/ctx[41],/*i*/ctx[42]].concat(args)));}return{c:function c(){div=element("div");if(switch_instance)create_component(switch_instance.$$.fragment);t=space();attr(div,"class","listItem");attr(div,"tabindex","-1");},m:function m(target,anchor){insert$2(target,div,anchor);if(switch_instance)mount_component(switch_instance,div,null);append$1(div,t);current=true;if(!mounted){dispose=[listen(div,"mouseover",mouseover_handler_1),listen(div,"focus",focus_handler_1),listen(div,"click",click_handler_1)];mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;var switch_instance_changes={};if(dirty[0]&/*items*/2)switch_instance_changes.item=/*item*/ctx[41];if(dirty[0]&/*filterText*/8192)switch_instance_changes.filterText=/*filterText*/ctx[13];if(dirty[0]&/*getOptionLabel*/64)switch_instance_changes.getOptionLabel=/*getOptionLabel*/ctx[6];if(dirty[0]&/*items, value, optionIdentifier*/1538)switch_instance_changes.isActive=isItemActive(/*item*/ctx[41],/*value*/ctx[9],/*optionIdentifier*/ctx[10]);if(dirty[0]&/*hoverItemIndex, items*/6)switch_instance_changes.isHover=isItemHover(/*hoverItemIndex*/ctx[2],/*item*/ctx[41],/*i*/ctx[42],/*items*/ctx[1]);if(dirty[0]&/*items*/2)switch_instance_changes.isSelectable=isItemSelectable(/*item*/ctx[41]);if(switch_value!==(switch_value=/*Item*/ctx[4])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,t);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);if(switch_instance)destroy_component(switch_instance);mounted=false;run_all(dispose);}};}// (311:12) {#if item.isGroupHeader && !item.isSelectable}
function create_if_block_1$3(ctx){var div;var t_value=/*getGroupHeaderLabel*/ctx[7](/*item*/ctx[41])+"";var t;return{c:function c(){div=element("div");t=text(t_value);attr(div,"class","listGroupTitle svelte-1uyqfml");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t);},p:function p(ctx,dirty){if(dirty[0]&/*getGroupHeaderLabel, items*/130&&t_value!==(t_value=/*getGroupHeaderLabel*/ctx[7](/*item*/ctx[41])+""))set_data(t,t_value);},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (310:8) {#each items as item, i}
function create_each_block$5(ctx){var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block_1$3,create_else_block_1$1];var if_blocks=[];function select_block_type_1(ctx,dirty){if(/*item*/ctx[41].isGroupHeader&&!/*item*/ctx[41].isSelectable)return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (287:8) <svelte:component             this={VirtualList}             {items}             {itemHeight}             let:item             let:i>
function create_default_slot$2(ctx){var div;var switch_instance;var current;var mounted;var dispose;var switch_value=/*Item*/ctx[4];function switch_props(ctx){return{props:{item:/*item*/ctx[41],filterText:/*filterText*/ctx[13],getOptionLabel:/*getOptionLabel*/ctx[6],isFirst:isItemFirst(/*i*/ctx[42]),isActive:isItemActive(/*item*/ctx[41],/*value*/ctx[9],/*optionIdentifier*/ctx[10]),isHover:isItemHover(/*hoverItemIndex*/ctx[2],/*item*/ctx[41],/*i*/ctx[42],/*items*/ctx[1]),isSelectable:isItemSelectable(/*item*/ctx[41])}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));}function mouseover_handler(){return(/*mouseover_handler*/ctx[26](/*i*/ctx[42]));}function focus_handler(){return(/*focus_handler*/ctx[27](/*i*/ctx[42]));}function click_handler(){var _ctx2;for(var _len9=arguments.length,args=new Array(_len9),_key11=0;_key11<_len9;_key11++){args[_key11]=arguments[_key11];}return(/*click_handler*/(_ctx2=ctx)[28].apply(_ctx2,[/*item*/ctx[41],/*i*/ctx[42]].concat(args)));}return{c:function c(){div=element("div");if(switch_instance)create_component(switch_instance.$$.fragment);attr(div,"class","listItem");},m:function m(target,anchor){insert$2(target,div,anchor);if(switch_instance)mount_component(switch_instance,div,null);current=true;if(!mounted){dispose=[listen(div,"mouseover",mouseover_handler),listen(div,"focus",focus_handler),listen(div,"click",click_handler)];mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;var switch_instance_changes={};if(dirty[1]&/*item*/1024)switch_instance_changes.item=/*item*/ctx[41];if(dirty[0]&/*filterText*/8192)switch_instance_changes.filterText=/*filterText*/ctx[13];if(dirty[0]&/*getOptionLabel*/64)switch_instance_changes.getOptionLabel=/*getOptionLabel*/ctx[6];if(dirty[1]&/*i*/2048)switch_instance_changes.isFirst=isItemFirst(/*i*/ctx[42]);if(dirty[0]&/*value, optionIdentifier*/1536|dirty[1]&/*item*/1024)switch_instance_changes.isActive=isItemActive(/*item*/ctx[41],/*value*/ctx[9],/*optionIdentifier*/ctx[10]);if(dirty[0]&/*hoverItemIndex, items*/6|dirty[1]&/*item, i*/3072)switch_instance_changes.isHover=isItemHover(/*hoverItemIndex*/ctx[2],/*item*/ctx[41],/*i*/ctx[42],/*items*/ctx[1]);if(dirty[1]&/*item*/1024)switch_instance_changes.isSelectable=isItemSelectable(/*item*/ctx[41]);if(switch_value!==(switch_value=/*Item*/ctx[4])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,null);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);if(switch_instance)destroy_component(switch_instance);mounted=false;run_all(dispose);}};}function create_fragment$c(ctx){var div;var current_block_type_index;var if_block;var current;var mounted;var dispose;var if_block_creators=[create_if_block$7,create_else_block$4];var if_blocks=[];function select_block_type(ctx,dirty){if(/*isVirtualList*/ctx[5])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){div=element("div");if_block.c();attr(div,"class","listContainer svelte-1uyqfml");attr(div,"style",/*listStyle*/ctx[14]);toggle_class(div,"virtualList",/*isVirtualList*/ctx[5]);},m:function m(target,anchor){insert$2(target,div,anchor);if_blocks[current_block_type_index].m(div,null);/*div_binding*/ctx[32](div);current=true;if(!mounted){dispose=[listen(window,"keydown",/*handleKeyDown*/ctx[17]),listen(window,"resize",/*computePlacement*/ctx[18])];mounted=true;}},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(div,null);}if(!current||dirty[0]&/*listStyle*/16384){attr(div,"style",/*listStyle*/ctx[14]);}if(!current||dirty[0]&/*isVirtualList*/32){toggle_class(div,"virtualList",/*isVirtualList*/ctx[5]);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();/*div_binding*/ctx[32](null);mounted=false;run_all(dispose);}};}function isItemActive(item,value,optionIdentifier){return value&&value[optionIdentifier]===item[optionIdentifier];}function isItemFirst(itemIndex){return itemIndex===0;}function isItemHover(hoverItemIndex,item,itemIndex,items){return isItemSelectable(item)&&(hoverItemIndex===itemIndex||items.length===1);}function isItemSelectable(item){return item.isGroupHeader&&item.isSelectable||item.selectable||!item.hasOwnProperty('selectable');// Default; if `selectable` was not specified, the object is selectable
}function instance$c($$self,$$props,$$invalidate){var dispatch=createEventDispatcher();var _$$props$container=$$props.container,container=_$$props$container===void 0?undefined:_$$props$container;var _$$props$VirtualList=$$props.VirtualList,VirtualList=_$$props$VirtualList===void 0?null:_$$props$VirtualList;var _$$props$Item=$$props.Item,Item$1=_$$props$Item===void 0?Item:_$$props$Item;var _$$props$isVirtualLis=$$props.isVirtualList,isVirtualList=_$$props$isVirtualLis===void 0?false:_$$props$isVirtualLis;var _$$props$items3=$$props.items,items=_$$props$items3===void 0?[]:_$$props$items3;var _$$props$labelIdentif=$$props.labelIdentifier,labelIdentifier=_$$props$labelIdentif===void 0?'label':_$$props$labelIdentif;var _$$props$getOptionLab2=$$props.getOptionLabel,getOptionLabel=_$$props$getOptionLab2===void 0?function(option,filterText){if(option)return option.isCreator?"Create \"".concat(filterText,"\""):option[labelIdentifier];}:_$$props$getOptionLab2;var _$$props$getGroupHead=$$props.getGroupHeaderLabel,getGroupHeaderLabel=_$$props$getGroupHead===void 0?null:_$$props$getGroupHead;var _$$props$itemHeight=$$props.itemHeight,itemHeight=_$$props$itemHeight===void 0?40:_$$props$itemHeight;var _$$props$hoverItemInd=$$props.hoverItemIndex,hoverItemIndex=_$$props$hoverItemInd===void 0?0:_$$props$hoverItemInd;var _$$props$value=$$props.value,value=_$$props$value===void 0?undefined:_$$props$value;var _$$props$optionIdenti=$$props.optionIdentifier,optionIdentifier=_$$props$optionIdenti===void 0?'value':_$$props$optionIdenti;var _$$props$hideEmptySta=$$props.hideEmptyState,hideEmptyState=_$$props$hideEmptySta===void 0?false:_$$props$hideEmptySta;var _$$props$noOptionsMes=$$props.noOptionsMessage,noOptionsMessage=_$$props$noOptionsMes===void 0?'No options':_$$props$noOptionsMes;var _$$props$isMulti=$$props.isMulti,isMulti=_$$props$isMulti===void 0?false:_$$props$isMulti;var _$$props$activeItemIn=$$props.activeItemIndex,activeItemIndex=_$$props$activeItemIn===void 0?0:_$$props$activeItemIn;var _$$props$filterText2=$$props.filterText,filterText=_$$props$filterText2===void 0?'':_$$props$filterText2;var _$$props$parent=$$props.parent,parent=_$$props$parent===void 0?null:_$$props$parent;var _$$props$listPlacemen=$$props.listPlacement,listPlacement=_$$props$listPlacemen===void 0?null:_$$props$listPlacemen;var _$$props$listAutoWidt=$$props.listAutoWidth,listAutoWidth=_$$props$listAutoWidt===void 0?null:_$$props$listAutoWidt;var _$$props$listOffset=$$props.listOffset,listOffset=_$$props$listOffset===void 0?5:_$$props$listOffset;var isScrollingTimer=0;var isScrolling=false;var prev_items;onMount(function(){if(items.length>0&&!isMulti&&value){var _hoverItemIndex=items.findIndex(function(item){return item[optionIdentifier]===value[optionIdentifier];});if(_hoverItemIndex){$$invalidate(2,hoverItemIndex=_hoverItemIndex);}}scrollToActiveItem('active');container.addEventListener('scroll',function(){clearTimeout(isScrollingTimer);isScrollingTimer=setTimeout(function(){isScrolling=false;},100);},false);});beforeUpdate(function(){if(!items)$$invalidate(1,items=[]);if(items!==prev_items&&items.length>0){$$invalidate(2,hoverItemIndex=0);}prev_items=items;});function handleSelect(item){if(item.isCreator)return;dispatch('itemSelected',item);}function handleHover(i){if(isScrolling)return;$$invalidate(2,hoverItemIndex=i);}function handleClick(args){var item=args.item,i=args.i,event=args.event;event.stopPropagation();if(value&&!isMulti&&value[optionIdentifier]===item[optionIdentifier])return closeList();if(item.isCreator){dispatch('itemCreated',filterText);}else if(isItemSelectable(item)){$$invalidate(19,activeItemIndex=i);$$invalidate(2,hoverItemIndex=i);handleSelect(item);}}function closeList(){dispatch('closeList');}function updateHoverItem(_x11){return _updateHoverItem.apply(this,arguments);}function _updateHoverItem(){_updateHoverItem=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee17(increment){var isNonSelectableItem;return _regeneratorRuntime().wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:if(!isVirtualList){_context17.next=2;break;}return _context17.abrupt("return");case 2:isNonSelectableItem=true;while(isNonSelectableItem){if(increment>0&&hoverItemIndex===items.length-1){$$invalidate(2,hoverItemIndex=0);}else if(increment<0&&hoverItemIndex===0){$$invalidate(2,hoverItemIndex=items.length-1);}else{$$invalidate(2,hoverItemIndex=hoverItemIndex+increment);}isNonSelectableItem=!isItemSelectable(items[hoverItemIndex]);}_context17.next=6;return tick();case 6:scrollToActiveItem('hover');case 7:case"end":return _context17.stop();}}},_callee17);}));return _updateHoverItem.apply(this,arguments);}function handleKeyDown(e){switch(e.key){case'Escape':e.preventDefault();closeList();break;case'ArrowDown':e.preventDefault();items.length&&updateHoverItem(1);break;case'ArrowUp':e.preventDefault();items.length&&updateHoverItem(-1);break;case'Enter':e.preventDefault();if(items.length===0)break;var hoverItem=items[hoverItemIndex];if(value&&!isMulti&&value[optionIdentifier]===hoverItem[optionIdentifier]){closeList();break;}if(hoverItem.isCreator){dispatch('itemCreated',filterText);}else{$$invalidate(19,activeItemIndex=hoverItemIndex);handleSelect(items[hoverItemIndex]);}break;case'Tab':e.preventDefault();if(items.length===0){return closeList();}if(value&&value[optionIdentifier]===items[hoverItemIndex][optionIdentifier])return closeList();$$invalidate(19,activeItemIndex=hoverItemIndex);handleSelect(items[hoverItemIndex]);break;}}function scrollToActiveItem(className){if(isVirtualList||!container)return;var offsetBounding;var focusedElemBounding=container.querySelector(".listItem .".concat(className));if(focusedElemBounding){offsetBounding=container.getBoundingClientRect().bottom-focusedElemBounding.getBoundingClientRect().bottom;}$$invalidate(0,container.scrollTop-=offsetBounding,container);}var listStyle;function computePlacement(){var _parent$getBoundingCl=parent.getBoundingClientRect(),height=_parent$getBoundingCl.height,width=_parent$getBoundingCl.width;$$invalidate(14,listStyle='');$$invalidate(14,listStyle+="min-width:".concat(width,"px;width:").concat(listAutoWidth?'auto':'100%',";"));if(listPlacement==='top'||listPlacement==='auto'&&isOutOfViewport(parent,container).bottom){$$invalidate(14,listStyle+="bottom:".concat(height+listOffset,"px;"));}else{$$invalidate(14,listStyle+="top:".concat(height+listOffset,"px;"));}}var mouseover_handler=function mouseover_handler(i){return handleHover(i);};var focus_handler=function focus_handler(i){return handleHover(i);};var click_handler=function click_handler(item,i,event){return handleClick({item:item,i:i,event:event});};var mouseover_handler_1=function mouseover_handler_1(i){return handleHover(i);};var focus_handler_1=function focus_handler_1(i){return handleHover(i);};var click_handler_1=function click_handler_1(item,i,event){return handleClick({item:item,i:i,event:event});};function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){container=$$value;$$invalidate(0,container);});}$$self.$$set=function($$props){if('container'in $$props)$$invalidate(0,container=$$props.container);if('VirtualList'in $$props)$$invalidate(3,VirtualList=$$props.VirtualList);if('Item'in $$props)$$invalidate(4,Item$1=$$props.Item);if('isVirtualList'in $$props)$$invalidate(5,isVirtualList=$$props.isVirtualList);if('items'in $$props)$$invalidate(1,items=$$props.items);if('labelIdentifier'in $$props)$$invalidate(20,labelIdentifier=$$props.labelIdentifier);if('getOptionLabel'in $$props)$$invalidate(6,getOptionLabel=$$props.getOptionLabel);if('getGroupHeaderLabel'in $$props)$$invalidate(7,getGroupHeaderLabel=$$props.getGroupHeaderLabel);if('itemHeight'in $$props)$$invalidate(8,itemHeight=$$props.itemHeight);if('hoverItemIndex'in $$props)$$invalidate(2,hoverItemIndex=$$props.hoverItemIndex);if('value'in $$props)$$invalidate(9,value=$$props.value);if('optionIdentifier'in $$props)$$invalidate(10,optionIdentifier=$$props.optionIdentifier);if('hideEmptyState'in $$props)$$invalidate(11,hideEmptyState=$$props.hideEmptyState);if('noOptionsMessage'in $$props)$$invalidate(12,noOptionsMessage=$$props.noOptionsMessage);if('isMulti'in $$props)$$invalidate(21,isMulti=$$props.isMulti);if('activeItemIndex'in $$props)$$invalidate(19,activeItemIndex=$$props.activeItemIndex);if('filterText'in $$props)$$invalidate(13,filterText=$$props.filterText);if('parent'in $$props)$$invalidate(22,parent=$$props.parent);if('listPlacement'in $$props)$$invalidate(23,listPlacement=$$props.listPlacement);if('listAutoWidth'in $$props)$$invalidate(24,listAutoWidth=$$props.listAutoWidth);if('listOffset'in $$props)$$invalidate(25,listOffset=$$props.listOffset);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*parent, container*/4194305){{if(parent&&container)computePlacement();}}};return[container,items,hoverItemIndex,VirtualList,Item$1,isVirtualList,getOptionLabel,getGroupHeaderLabel,itemHeight,value,optionIdentifier,hideEmptyState,noOptionsMessage,filterText,listStyle,handleHover,handleClick,handleKeyDown,computePlacement,activeItemIndex,labelIdentifier,isMulti,parent,listPlacement,listAutoWidth,listOffset,mouseover_handler,focus_handler,click_handler,mouseover_handler_1,focus_handler_1,click_handler_1,div_binding];}var List=/*#__PURE__*/function(_SvelteComponent46){_inherits(List,_SvelteComponent46);var _super87=_createSuper(List);function List(options){var _this141;_classCallCheck(this,List);_this141=_super87.call(this);init(_assertThisInitialized(_this141),options,instance$c,create_fragment$c,safe_not_equal,{container:0,VirtualList:3,Item:4,isVirtualList:5,items:1,labelIdentifier:20,getOptionLabel:6,getGroupHeaderLabel:7,itemHeight:8,hoverItemIndex:2,value:9,optionIdentifier:10,hideEmptyState:11,noOptionsMessage:12,isMulti:21,activeItemIndex:19,filterText:13,parent:22,listPlacement:23,listAutoWidth:24,listOffset:25},add_css$b,[-1,-1]);return _this141;}return _createClass(List);}(SvelteComponent);/* node_modules/svelte-select/src/Selection.svelte generated by Svelte v3.51.0 */function add_css$a(target){append_styles(target,"svelte-pu1q1n",".selection.svelte-pu1q1n{text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap}");}function create_fragment$b(ctx){var div;var raw_value=/*getSelectionLabel*/ctx[0](/*item*/ctx[1])+"";return{c:function c(){div=element("div");attr(div,"class","selection svelte-pu1q1n");},m:function m(target,anchor){insert$2(target,div,anchor);div.innerHTML=raw_value;},p:function p(ctx,_ref164){var _ref165=_slicedToArray(_ref164,1),dirty=_ref165[0];if(dirty&/*getSelectionLabel, item*/3&&raw_value!==(raw_value=/*getSelectionLabel*/ctx[0](/*item*/ctx[1])+""))div.innerHTML=raw_value;},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}function instance$b($$self,$$props,$$invalidate){var _$$props$getSelection=$$props.getSelectionLabel,getSelectionLabel=_$$props$getSelection===void 0?undefined:_$$props$getSelection;var _$$props$item2=$$props.item,item=_$$props$item2===void 0?undefined:_$$props$item2;$$self.$$set=function($$props){if('getSelectionLabel'in $$props)$$invalidate(0,getSelectionLabel=$$props.getSelectionLabel);if('item'in $$props)$$invalidate(1,item=$$props.item);};return[getSelectionLabel,item];}var Selection=/*#__PURE__*/function(_SvelteComponent47){_inherits(Selection,_SvelteComponent47);var _super88=_createSuper(Selection);function Selection(options){var _this142;_classCallCheck(this,Selection);_this142=_super88.call(this);init(_assertThisInitialized(_this142),options,instance$b,create_fragment$b,safe_not_equal,{getSelectionLabel:0,item:1},add_css$a);return _this142;}return _createClass(Selection);}(SvelteComponent);/* node_modules/svelte-select/src/MultiSelection.svelte generated by Svelte v3.51.0 */function add_css$9(target){append_styles(target,"svelte-liu9pa",".multiSelectItem.svelte-liu9pa.svelte-liu9pa{background:var(--multiItemBG, #ebedef);margin:var(--multiItemMargin, 5px 5px 0 0);border-radius:var(--multiItemBorderRadius, 16px);height:var(--multiItemHeight, 32px);line-height:var(--multiItemHeight, 32px);display:flex;cursor:default;padding:var(--multiItemPadding, 0 10px 0 15px);max-width:100%}.multiSelectItem_label.svelte-liu9pa.svelte-liu9pa{margin:var(--multiLabelMargin, 0 5px 0 0);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.multiSelectItem.svelte-liu9pa.svelte-liu9pa:hover,.multiSelectItem.active.svelte-liu9pa.svelte-liu9pa{background-color:var(--multiItemActiveBG, #006fff);color:var(--multiItemActiveColor, #fff)}.multiSelectItem.disabled.svelte-liu9pa.svelte-liu9pa:hover{background:var(--multiItemDisabledHoverBg, #ebedef);color:var(--multiItemDisabledHoverColor, #c1c6cc)}.multiSelectItem_clear.svelte-liu9pa.svelte-liu9pa{border-radius:var(--multiClearRadius, 50%);background:var(--multiClearBG, #52616f);min-width:var(--multiClearWidth, 16px);max-width:var(--multiClearWidth, 16px);height:var(--multiClearHeight, 16px);position:relative;top:var(--multiClearTop, 8px);text-align:var(--multiClearTextAlign, center);padding:var(--multiClearPadding, 1px)}.multiSelectItem_clear.svelte-liu9pa.svelte-liu9pa:hover,.active.svelte-liu9pa .multiSelectItem_clear.svelte-liu9pa{background:var(--multiClearHoverBG, #fff)}.multiSelectItem_clear.svelte-liu9pa:hover svg.svelte-liu9pa,.active.svelte-liu9pa .multiSelectItem_clear svg.svelte-liu9pa{fill:var(--multiClearHoverFill, #006fff)}.multiSelectItem_clear.svelte-liu9pa svg.svelte-liu9pa{fill:var(--multiClearFill, #ebedef);vertical-align:top}");}function get_each_context$4(ctx,list,i){var child_ctx=ctx.slice();child_ctx[9]=list[i];child_ctx[11]=i;return child_ctx;}// (87:8) {#if !isDisabled && !multiFullItemClearable}
function create_if_block$6(ctx){var div;var mounted;var dispose;function click_handler(){var _ctx3;for(var _len10=arguments.length,args=new Array(_len10),_key12=0;_key12<_len10;_key12++){args[_key12]=arguments[_key12];}return(/*click_handler*/(_ctx3=ctx)[6].apply(_ctx3,[/*i*/ctx[11]].concat(args)));}return{c:function c(){div=element("div");div.innerHTML="<svg width=\"100%\" height=\"100%\" viewBox=\"-2 -2 50 50\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\" class=\"svelte-liu9pa\"><path d=\"M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124 l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z\"></path></svg>";attr(div,"class","multiSelectItem_clear svelte-liu9pa");},m:function m(target,anchor){insert$2(target,div,anchor);if(!mounted){dispose=listen(div,"click",click_handler);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;},d:function d(detaching){if(detaching)detach(div);mounted=false;dispose();}};}// (77:0) {#each value as item, i}
function create_each_block$4(ctx){var div1;var div0;var raw_value=/*getSelectionLabel*/ctx[4](/*item*/ctx[9])+"";var t0;var t1;var div1_class_value;var mounted;var dispose;var if_block=!/*isDisabled*/ctx[2]&&!/*multiFullItemClearable*/ctx[3]&&create_if_block$6(ctx);function click_handler_1(){var _ctx4;for(var _len11=arguments.length,args=new Array(_len11),_key13=0;_key13<_len11;_key13++){args[_key13]=arguments[_key13];}return(/*click_handler_1*/(_ctx4=ctx)[7].apply(_ctx4,[/*i*/ctx[11]].concat(args)));}return{c:function c(){div1=element("div");div0=element("div");t0=space();if(if_block)if_block.c();t1=space();attr(div0,"class","multiSelectItem_label svelte-liu9pa");attr(div1,"class",div1_class_value="multiSelectItem "+(/*activeValue*/ctx[1]===/*i*/ctx[11]?'active':'')+" "+(/*isDisabled*/ctx[2]?'disabled':'')+" svelte-liu9pa");},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);div0.innerHTML=raw_value;append$1(div1,t0);if(if_block)if_block.m(div1,null);append$1(div1,t1);if(!mounted){dispose=listen(div1,"click",click_handler_1);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;if(dirty&/*getSelectionLabel, value*/17&&raw_value!==(raw_value=/*getSelectionLabel*/ctx[4](/*item*/ctx[9])+""))div0.innerHTML=raw_value;if(!/*isDisabled*/ctx[2]&&!/*multiFullItemClearable*/ctx[3]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block$6(ctx);if_block.c();if_block.m(div1,t1);}}else if(if_block){if_block.d(1);if_block=null;}if(dirty&/*activeValue, isDisabled*/6&&div1_class_value!==(div1_class_value="multiSelectItem "+(/*activeValue*/ctx[1]===/*i*/ctx[11]?'active':'')+" "+(/*isDisabled*/ctx[2]?'disabled':'')+" svelte-liu9pa")){attr(div1,"class",div1_class_value);}},d:function d(detaching){if(detaching)detach(div1);if(if_block)if_block.d();mounted=false;dispose();}};}function create_fragment$a(ctx){var each_1_anchor;var each_value=/*value*/ctx[0];var each_blocks=[];for(var _i297=0;_i297<each_value.length;_i297+=1){each_blocks[_i297]=create_each_block$4(get_each_context$4(ctx,each_value,_i297));}return{c:function c(){for(var _i298=0;_i298<each_blocks.length;_i298+=1){each_blocks[_i298].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i299=0;_i299<each_blocks.length;_i299+=1){each_blocks[_i299].m(target,anchor);}insert$2(target,each_1_anchor,anchor);},p:function p(ctx,_ref166){var _ref167=_slicedToArray(_ref166,1),dirty=_ref167[0];if(dirty&/*activeValue, isDisabled, multiFullItemClearable, handleClear, getSelectionLabel, value*/63){each_value=/*value*/ctx[0];var _i300;for(_i300=0;_i300<each_value.length;_i300+=1){var child_ctx=get_each_context$4(ctx,each_value,_i300);if(each_blocks[_i300]){each_blocks[_i300].p(child_ctx,dirty);}else{each_blocks[_i300]=create_each_block$4(child_ctx);each_blocks[_i300].c();each_blocks[_i300].m(each_1_anchor.parentNode,each_1_anchor);}}for(;_i300<each_blocks.length;_i300+=1){each_blocks[_i300].d(1);}each_blocks.length=each_value.length;}},i:noop$2,o:noop$2,d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}function instance$a($$self,$$props,$$invalidate){var dispatch=createEventDispatcher();var _$$props$value2=$$props.value,value=_$$props$value2===void 0?[]:_$$props$value2;var _$$props$activeValue=$$props.activeValue,activeValue=_$$props$activeValue===void 0?undefined:_$$props$activeValue;var _$$props$isDisabled=$$props.isDisabled,isDisabled=_$$props$isDisabled===void 0?false:_$$props$isDisabled;var _$$props$multiFullIte=$$props.multiFullItemClearable,multiFullItemClearable=_$$props$multiFullIte===void 0?false:_$$props$multiFullIte;var _$$props$getSelection2=$$props.getSelectionLabel,getSelectionLabel=_$$props$getSelection2===void 0?undefined:_$$props$getSelection2;function handleClear(i,event){event.stopPropagation();dispatch('multiItemClear',{i:i});}var click_handler=function click_handler(i,event){return handleClear(i,event);};var click_handler_1=function click_handler_1(i,event){return multiFullItemClearable?handleClear(i,event):{};};$$self.$$set=function($$props){if('value'in $$props)$$invalidate(0,value=$$props.value);if('activeValue'in $$props)$$invalidate(1,activeValue=$$props.activeValue);if('isDisabled'in $$props)$$invalidate(2,isDisabled=$$props.isDisabled);if('multiFullItemClearable'in $$props)$$invalidate(3,multiFullItemClearable=$$props.multiFullItemClearable);if('getSelectionLabel'in $$props)$$invalidate(4,getSelectionLabel=$$props.getSelectionLabel);};return[value,activeValue,isDisabled,multiFullItemClearable,getSelectionLabel,handleClear,click_handler,click_handler_1];}var MultiSelection=/*#__PURE__*/function(_SvelteComponent48){_inherits(MultiSelection,_SvelteComponent48);var _super89=_createSuper(MultiSelection);function MultiSelection(options){var _this143;_classCallCheck(this,MultiSelection);_this143=_super89.call(this);init(_assertThisInitialized(_this143),options,instance$a,create_fragment$a,safe_not_equal,{value:0,activeValue:1,isDisabled:2,multiFullItemClearable:3,getSelectionLabel:4},add_css$9);return _this143;}return _createClass(MultiSelection);}(SvelteComponent);/* node_modules/svelte-select/src/VirtualList.svelte generated by Svelte v3.51.0 */function add_css$8(target){append_styles(target,"svelte-g2cagw","svelte-virtual-list-viewport.svelte-g2cagw{position:relative;overflow-y:auto;-webkit-overflow-scrolling:touch;display:block}svelte-virtual-list-contents.svelte-g2cagw,svelte-virtual-list-row.svelte-g2cagw{display:block}svelte-virtual-list-row.svelte-g2cagw{overflow:hidden}");}function get_each_context$3(ctx,list,i){var child_ctx=ctx.slice();child_ctx[23]=list[i];return child_ctx;}var get_default_slot_changes=function get_default_slot_changes(dirty){return{item:dirty&/*visible*/32,i:dirty&/*visible*/32,hoverItemIndex:dirty&/*hoverItemIndex*/2};};var get_default_slot_context=function get_default_slot_context(ctx){return{item:/*row*/ctx[23].data,i:/*row*/ctx[23].index,hoverItemIndex:/*hoverItemIndex*/ctx[1]};};// (154:69) Missing template
function fallback_block(ctx){var t;return{c:function c(){t=text("Missing template");},m:function m(target,anchor){insert$2(target,t,anchor);},d:function d(detaching){if(detaching)detach(t);}};}// (152:8) {#each visible as row (row.index)}
function create_each_block$3(key_1,ctx){var svelte_virtual_list_row;var t;var current;var default_slot_template=/*#slots*/ctx[15]["default"];var default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[14],get_default_slot_context);var default_slot_or_fallback=default_slot||fallback_block();return{key:key_1,first:null,c:function c(){svelte_virtual_list_row=element("svelte-virtual-list-row");if(default_slot_or_fallback)default_slot_or_fallback.c();t=space();set_custom_element_data(svelte_virtual_list_row,"class","svelte-g2cagw");this.first=svelte_virtual_list_row;},m:function m(target,anchor){insert$2(target,svelte_virtual_list_row,anchor);if(default_slot_or_fallback){default_slot_or_fallback.m(svelte_virtual_list_row,null);}append$1(svelte_virtual_list_row,t);current=true;},p:function p(new_ctx,dirty){ctx=new_ctx;if(default_slot){if(default_slot.p&&(!current||dirty&/*$$scope, visible, hoverItemIndex*/16418)){update_slot_base(default_slot,default_slot_template,ctx,/*$$scope*/ctx[14],!current?get_all_dirty_from_scope(/*$$scope*/ctx[14]):get_slot_changes(default_slot_template,/*$$scope*/ctx[14],dirty,get_default_slot_changes),get_default_slot_context);}}},i:function i(local){if(current)return;transition_in(default_slot_or_fallback,local);current=true;},o:function o(local){transition_out(default_slot_or_fallback,local);current=false;},d:function d(detaching){if(detaching)detach(svelte_virtual_list_row);if(default_slot_or_fallback)default_slot_or_fallback.d(detaching);}};}function create_fragment$9(ctx){var svelte_virtual_list_viewport;var svelte_virtual_list_contents;var each_blocks=[];var each_1_lookup=new Map();var svelte_virtual_list_viewport_resize_listener;var current;var mounted;var dispose;var each_value=/*visible*/ctx[5];var get_key=function get_key(ctx){return(/*row*/ctx[23].index);};for(var _i301=0;_i301<each_value.length;_i301+=1){var child_ctx=get_each_context$3(ctx,each_value,_i301);var key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[_i301]=create_each_block$3(key,child_ctx));}return{c:function c(){svelte_virtual_list_viewport=element("svelte-virtual-list-viewport");svelte_virtual_list_contents=element("svelte-virtual-list-contents");for(var _i302=0;_i302<each_blocks.length;_i302+=1){each_blocks[_i302].c();}set_style(svelte_virtual_list_contents,"padding-top",/*top*/ctx[6]+"px");set_style(svelte_virtual_list_contents,"padding-bottom",/*bottom*/ctx[7]+"px");set_custom_element_data(svelte_virtual_list_contents,"class","svelte-g2cagw");set_style(svelte_virtual_list_viewport,"height",/*height*/ctx[0]);set_custom_element_data(svelte_virtual_list_viewport,"class","svelte-g2cagw");add_render_callback(function(){return(/*svelte_virtual_list_viewport_elementresize_handler*/ctx[18].call(svelte_virtual_list_viewport));});},m:function m(target,anchor){insert$2(target,svelte_virtual_list_viewport,anchor);append$1(svelte_virtual_list_viewport,svelte_virtual_list_contents);for(var _i303=0;_i303<each_blocks.length;_i303+=1){each_blocks[_i303].m(svelte_virtual_list_contents,null);}/*svelte_virtual_list_contents_binding*/ctx[16](svelte_virtual_list_contents);/*svelte_virtual_list_viewport_binding*/ctx[17](svelte_virtual_list_viewport);svelte_virtual_list_viewport_resize_listener=add_resize_listener(svelte_virtual_list_viewport,/*svelte_virtual_list_viewport_elementresize_handler*/ctx[18].bind(svelte_virtual_list_viewport));current=true;if(!mounted){dispose=listen(svelte_virtual_list_viewport,"scroll",/*handle_scroll*/ctx[8]);mounted=true;}},p:function p(ctx,_ref168){var _ref169=_slicedToArray(_ref168,1),dirty=_ref169[0];if(dirty&/*$$scope, visible, hoverItemIndex*/16418){each_value=/*visible*/ctx[5];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,svelte_virtual_list_contents,outro_and_destroy_block,create_each_block$3,null,get_each_context$3);check_outros();}if(!current||dirty&/*top*/64){set_style(svelte_virtual_list_contents,"padding-top",/*top*/ctx[6]+"px");}if(!current||dirty&/*bottom*/128){set_style(svelte_virtual_list_contents,"padding-bottom",/*bottom*/ctx[7]+"px");}if(!current||dirty&/*height*/1){set_style(svelte_virtual_list_viewport,"height",/*height*/ctx[0]);}},i:function i(local){if(current)return;for(var _i304=0;_i304<each_value.length;_i304+=1){transition_in(each_blocks[_i304]);}current=true;},o:function o(local){for(var _i305=0;_i305<each_blocks.length;_i305+=1){transition_out(each_blocks[_i305]);}current=false;},d:function d(detaching){if(detaching)detach(svelte_virtual_list_viewport);for(var _i306=0;_i306<each_blocks.length;_i306+=1){each_blocks[_i306].d();}/*svelte_virtual_list_contents_binding*/ctx[16](null);/*svelte_virtual_list_viewport_binding*/ctx[17](null);svelte_virtual_list_viewport_resize_listener();mounted=false;dispose();}};}function instance$9($$self,$$props,$$invalidate){var _$$props$$$slots8=$$props.$$slots,slots=_$$props$$$slots8===void 0?{}:_$$props$$$slots8,$$scope=$$props.$$scope;var _$$props$items4=$$props.items,items=_$$props$items4===void 0?undefined:_$$props$items4;var _$$props$height=$$props.height,height=_$$props$height===void 0?'100%':_$$props$height;var _$$props$itemHeight2=$$props.itemHeight,itemHeight=_$$props$itemHeight2===void 0?40:_$$props$itemHeight2;var _$$props$hoverItemInd2=$$props.hoverItemIndex,hoverItemIndex=_$$props$hoverItemInd2===void 0?0:_$$props$hoverItemInd2;var _$$props$start=$$props.start,start=_$$props$start===void 0?0:_$$props$start;var _$$props$end=$$props.end,end=_$$props$end===void 0?0:_$$props$end;var height_map=[];var rows;var viewport;var contents;var viewport_height=0;var visible;var mounted;var top=0;var bottom=0;var average_height;function refresh(_x12,_x13,_x14){return _refresh.apply(this,arguments);}function _refresh(){_refresh=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee18(items,viewport_height,itemHeight){var _viewport,scrollTop,content_height,i,row,row_height,remaining;return _regeneratorRuntime().wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_viewport=viewport,scrollTop=_viewport.scrollTop;_context18.next=3;return tick();case 3:content_height=top-scrollTop;i=start;case 5:if(!(content_height<viewport_height&&i<items.length)){_context18.next=17;break;}row=rows[i-start];if(row){_context18.next=12;break;}$$invalidate(10,end=i+1);_context18.next=11;return tick();case 11:row=rows[i-start];case 12:row_height=height_map[i]=itemHeight||row.offsetHeight;content_height+=row_height;i+=1;_context18.next=5;break;case 17:$$invalidate(10,end=i);remaining=items.length-end;average_height=(top+content_height)/end;$$invalidate(7,bottom=remaining*average_height);height_map.length=items.length;if(viewport)$$invalidate(3,viewport.scrollTop=0,viewport);case 23:case"end":return _context18.stop();}}},_callee18);}));return _refresh.apply(this,arguments);}function handle_scroll(){return _handle_scroll.apply(this,arguments);}function _handle_scroll(){_handle_scroll=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee19(){var _viewport2,scrollTop,old_start,v,i,y,row_height,remaining,expected_height,actual_height,_i307,d;return _regeneratorRuntime().wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:_viewport2=viewport,scrollTop=_viewport2.scrollTop;old_start=start;for(v=0;v<rows.length;v+=1){height_map[start+v]=itemHeight||rows[v].offsetHeight;}i=0;y=0;case 5:if(!(i<items.length)){_context19.next=15;break;}row_height=height_map[i]||average_height;if(!(y+row_height>scrollTop)){_context19.next=11;break;}$$invalidate(9,start=i);$$invalidate(6,top=y);return _context19.abrupt("break",15);case 11:y+=row_height;i+=1;_context19.next=5;break;case 15:if(!(i<items.length)){_context19.next=22;break;}y+=height_map[i]||average_height;i+=1;if(!(y>scrollTop+viewport_height)){_context19.next=20;break;}return _context19.abrupt("break",22);case 20:_context19.next=15;break;case 22:$$invalidate(10,end=i);remaining=items.length-end;average_height=y/end;while(i<items.length){height_map[i++]=average_height;}$$invalidate(7,bottom=remaining*average_height);if(!(start<old_start)){_context19.next=35;break;}_context19.next=30;return tick();case 30:expected_height=0;actual_height=0;for(_i307=start;_i307<old_start;_i307+=1){if(rows[_i307-start]){expected_height+=height_map[_i307];actual_height+=itemHeight||rows[_i307-start].offsetHeight;}}d=actual_height-expected_height;viewport.scrollTo(0,scrollTop+d);case 35:case"end":return _context19.stop();}}},_callee19);}));return _handle_scroll.apply(this,arguments);}onMount(function(){rows=contents.getElementsByTagName('svelte-virtual-list-row');$$invalidate(13,mounted=true);});function svelte_virtual_list_contents_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){contents=$$value;$$invalidate(4,contents);});}function svelte_virtual_list_viewport_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){viewport=$$value;$$invalidate(3,viewport);});}function svelte_virtual_list_viewport_elementresize_handler(){viewport_height=this.offsetHeight;$$invalidate(2,viewport_height);}$$self.$$set=function($$props){if('items'in $$props)$$invalidate(11,items=$$props.items);if('height'in $$props)$$invalidate(0,height=$$props.height);if('itemHeight'in $$props)$$invalidate(12,itemHeight=$$props.itemHeight);if('hoverItemIndex'in $$props)$$invalidate(1,hoverItemIndex=$$props.hoverItemIndex);if('start'in $$props)$$invalidate(9,start=$$props.start);if('end'in $$props)$$invalidate(10,end=$$props.end);if('$$scope'in $$props)$$invalidate(14,$$scope=$$props.$$scope);};$$self.$$.update=function(){if($$self.$$.dirty&/*items, start, end*/3584){$$invalidate(5,visible=items.slice(start,end).map(function(data,i){return{index:i+start,data:data};}));}if($$self.$$.dirty&/*mounted, items, viewport_height, itemHeight*/14340){if(mounted)refresh(items,viewport_height,itemHeight);}};return[height,hoverItemIndex,viewport_height,viewport,contents,visible,top,bottom,handle_scroll,start,end,items,itemHeight,mounted,$$scope,slots,svelte_virtual_list_contents_binding,svelte_virtual_list_viewport_binding,svelte_virtual_list_viewport_elementresize_handler];}var VirtualList=/*#__PURE__*/function(_SvelteComponent49){_inherits(VirtualList,_SvelteComponent49);var _super90=_createSuper(VirtualList);function VirtualList(options){var _this144;_classCallCheck(this,VirtualList);_this144=_super90.call(this);init(_assertThisInitialized(_this144),options,instance$9,create_fragment$9,safe_not_equal,{items:11,height:0,itemHeight:12,hoverItemIndex:1,start:9,end:10},add_css$8);return _this144;}return _createClass(VirtualList);}(SvelteComponent);/* node_modules/svelte-select/src/ClearIcon.svelte generated by Svelte v3.51.0 */function create_fragment$8(ctx){var svg;var path;return{c:function c(){svg=svg_element("svg");path=svg_element("path");attr(path,"fill","currentColor");attr(path,"d","M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124\n    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z");attr(svg,"width","100%");attr(svg,"height","100%");attr(svg,"viewBox","-2 -2 50 50");attr(svg,"focusable","false");attr(svg,"aria-hidden","true");attr(svg,"role","presentation");},m:function m(target,anchor){insert$2(target,svg,anchor);append$1(svg,path);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(svg);}};}var ClearIcon=/*#__PURE__*/function(_SvelteComponent50){_inherits(ClearIcon,_SvelteComponent50);var _super91=_createSuper(ClearIcon);function ClearIcon(options){var _this145;_classCallCheck(this,ClearIcon);_this145=_super91.call(this);init(_assertThisInitialized(_this145),options,null,create_fragment$8,safe_not_equal,{});return _this145;}return _createClass(ClearIcon);}(SvelteComponent);function debounce(func,wait,immediate){var timeout;return function executedFunction(){var context=this;var args=arguments;var later=function later(){timeout=null;if(!immediate)func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};}/* node_modules/svelte-select/src/Select.svelte generated by Svelte v3.51.0 */function add_css$7(target){append_styles(target,"svelte-17l1npl",".selectContainer.svelte-17l1npl.svelte-17l1npl{--internalPadding:0 16px;border:var(--border, 1px solid #d8dbdf);border-radius:var(--borderRadius, 3px);box-sizing:border-box;height:var(--height, 42px);position:relative;display:flex;align-items:center;padding:var(--padding, var(--internalPadding));background:var(--background, #fff);margin:var(--margin, 0)}.selectContainer.svelte-17l1npl input.svelte-17l1npl{cursor:default;border:none;color:var(--inputColor, #3f4f5f);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--inputPadding, var(--padding, var(--internalPadding)));width:100%;background:transparent;font-size:var(--inputFontSize, 14px);letter-spacing:var(--inputLetterSpacing, -0.08px);position:absolute;left:var(--inputLeft, 0);margin:var(--inputMargin, 0)}.selectContainer.svelte-17l1npl input.svelte-17l1npl::placeholder{color:var(--placeholderColor, #78848f);opacity:var(--placeholderOpacity, 1)}.selectContainer.svelte-17l1npl input.svelte-17l1npl:focus{outline:none}.selectContainer.svelte-17l1npl.svelte-17l1npl:hover{border-color:var(--borderHoverColor, #b2b8bf)}.selectContainer.focused.svelte-17l1npl.svelte-17l1npl{border-color:var(--borderFocusColor, #006fe8)}.selectContainer.disabled.svelte-17l1npl.svelte-17l1npl{background:var(--disabledBackground, #ebedef);border-color:var(--disabledBorderColor, #ebedef);color:var(--disabledColor, #c1c6cc)}.selectContainer.disabled.svelte-17l1npl input.svelte-17l1npl::placeholder{color:var(--disabledPlaceholderColor, #c1c6cc);opacity:var(--disabledPlaceholderOpacity, 1)}.selectedItem.svelte-17l1npl.svelte-17l1npl{line-height:var(--height, 42px);height:var(--height, 42px);overflow-x:hidden;padding:var(--selectedItemPadding, 0 20px 0 0)}.selectedItem.svelte-17l1npl.svelte-17l1npl:focus{outline:none}.clearSelect.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--clearSelectRight, 10px);top:var(--clearSelectTop, 11px);bottom:var(--clearSelectBottom, 11px);width:var(--clearSelectWidth, 20px);color:var(--clearSelectColor, #c5cacf);flex:none !important}.clearSelect.svelte-17l1npl.svelte-17l1npl:hover{color:var(--clearSelectHoverColor, #2c3e50)}.selectContainer.focused.svelte-17l1npl .clearSelect.svelte-17l1npl{color:var(--clearSelectFocusColor, #3f4f5f)}.indicator.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--indicatorRight, 10px);top:var(--indicatorTop, 11px);width:var(--indicatorWidth, 20px);height:var(--indicatorHeight, 20px);color:var(--indicatorColor, #c5cacf)}.indicator.svelte-17l1npl svg.svelte-17l1npl{display:inline-block;fill:var(--indicatorFill, currentcolor);line-height:1;stroke:var(--indicatorStroke, currentcolor);stroke-width:0}.spinner.svelte-17l1npl.svelte-17l1npl{position:absolute;right:var(--spinnerRight, 10px);top:var(--spinnerLeft, 11px);width:var(--spinnerWidth, 20px);height:var(--spinnerHeight, 20px);color:var(--spinnerColor, #51ce6c);animation:svelte-17l1npl-rotate 0.75s linear infinite}.spinner_icon.svelte-17l1npl.svelte-17l1npl{display:block;height:100%;transform-origin:center center;width:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;-webkit-transform:none}.spinner_path.svelte-17l1npl.svelte-17l1npl{stroke-dasharray:90;stroke-linecap:round}.multiSelect.svelte-17l1npl.svelte-17l1npl{display:flex;padding:var(--multiSelectPadding, 0 35px 0 16px);height:auto;flex-wrap:wrap;align-items:stretch}.multiSelect.svelte-17l1npl>.svelte-17l1npl{flex:1 1 50px}.selectContainer.multiSelect.svelte-17l1npl input.svelte-17l1npl{padding:var(--multiSelectInputPadding, 0);position:relative;margin:var(--multiSelectInputMargin, 0)}.hasError.svelte-17l1npl.svelte-17l1npl{border:var(--errorBorder, 1px solid #ff2d55);background:var(--errorBackground, #fff)}.a11yText.svelte-17l1npl.svelte-17l1npl{z-index:9999;border:0px;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0px;white-space:nowrap}@keyframes svelte-17l1npl-rotate{100%{transform:rotate(360deg)}}");}function get_each_context$2(ctx,list,i){var child_ctx=ctx.slice();child_ctx[103]=list[i];return child_ctx;}// (876:8) {#if isFocused}
function create_if_block_10(ctx){var span0;var t0;var t1;var span1;var t2;return{c:function c(){span0=element("span");t0=text(/*ariaSelection*/ctx[33]);t1=space();span1=element("span");t2=text(/*ariaContext*/ctx[32]);attr(span0,"id","aria-selection");attr(span1,"id","aria-context");},m:function m(target,anchor){insert$2(target,span0,anchor);append$1(span0,t0);insert$2(target,t1,anchor);insert$2(target,span1,anchor);append$1(span1,t2);},p:function p(ctx,dirty){if(dirty[1]&/*ariaSelection*/4)set_data(t0,/*ariaSelection*/ctx[33]);if(dirty[1]&/*ariaContext*/2)set_data(t2,/*ariaContext*/ctx[32]);},d:function d(detaching){if(detaching)detach(span0);if(detaching)detach(t1);if(detaching)detach(span1);}};}// (884:4) {#if Icon}
function create_if_block_9(ctx){var switch_instance;var switch_instance_anchor;var current;var switch_instance_spread_levels=[/*iconProps*/ctx[18]];var switch_value=/*Icon*/ctx[17];function switch_props(ctx){var switch_instance_props={};for(var _i308=0;_i308<switch_instance_spread_levels.length;_i308+=1){switch_instance_props=assign$1(switch_instance_props,switch_instance_spread_levels[_i308]);}return{props:switch_instance_props};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){var switch_instance_changes=dirty[0]&/*iconProps*/262144?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*iconProps*/ctx[18])]):{};if(switch_value!==(switch_value=/*Icon*/ctx[17])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}// (888:4) {#if showMultiSelect}
function create_if_block_8(ctx){var switch_instance;var switch_instance_anchor;var current;var switch_value=/*MultiSelection*/ctx[26];function switch_props(ctx){return{props:{value:/*value*/ctx[2],getSelectionLabel:/*getSelectionLabel*/ctx[12],activeValue:/*activeValue*/ctx[30],isDisabled:/*isDisabled*/ctx[9],multiFullItemClearable:/*multiFullItemClearable*/ctx[8]}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));switch_instance.$on("multiItemClear",/*handleMultiItemClear*/ctx[38]);switch_instance.$on("focus",/*handleFocus*/ctx[40]);}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){var switch_instance_changes={};if(dirty[0]&/*value*/4)switch_instance_changes.value=/*value*/ctx[2];if(dirty[0]&/*getSelectionLabel*/4096)switch_instance_changes.getSelectionLabel=/*getSelectionLabel*/ctx[12];if(dirty[0]&/*activeValue*/1073741824)switch_instance_changes.activeValue=/*activeValue*/ctx[30];if(dirty[0]&/*isDisabled*/512)switch_instance_changes.isDisabled=/*isDisabled*/ctx[9];if(dirty[0]&/*multiFullItemClearable*/256)switch_instance_changes.multiFullItemClearable=/*multiFullItemClearable*/ctx[8];if(switch_value!==(switch_value=/*MultiSelection*/ctx[26])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));switch_instance.$on("multiItemClear",/*handleMultiItemClear*/ctx[38]);switch_instance.$on("focus",/*handleFocus*/ctx[40]);create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}// (910:4) {#if !isMulti && showSelectedItem}
function create_if_block_7(ctx){var div;var switch_instance;var current;var mounted;var dispose;var switch_value=/*Selection*/ctx[25];function switch_props(ctx){return{props:{item:/*value*/ctx[2],getSelectionLabel:/*getSelectionLabel*/ctx[12]}};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));}return{c:function c(){div=element("div");if(switch_instance)create_component(switch_instance.$$.fragment);attr(div,"class","selectedItem svelte-17l1npl");},m:function m(target,anchor){insert$2(target,div,anchor);if(switch_instance)mount_component(switch_instance,div,null);current=true;if(!mounted){dispose=listen(div,"focus",/*handleFocus*/ctx[40]);mounted=true;}},p:function p(ctx,dirty){var switch_instance_changes={};if(dirty[0]&/*value*/4)switch_instance_changes.item=/*value*/ctx[2];if(dirty[0]&/*getSelectionLabel*/4096)switch_instance_changes.getSelectionLabel=/*getSelectionLabel*/ctx[12];if(switch_value!==(switch_value=/*Selection*/ctx[25])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,null);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);if(switch_instance)destroy_component(switch_instance);mounted=false;dispose();}};}// (919:4) {#if showClearIcon}
function create_if_block_6(ctx){var div;var switch_instance;var current;var mounted;var dispose;var switch_value=/*ClearIcon*/ctx[23];function switch_props(ctx){return{};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());}return{c:function c(){div=element("div");if(switch_instance)create_component(switch_instance.$$.fragment);attr(div,"class","clearSelect svelte-17l1npl");attr(div,"aria-hidden","true");},m:function m(target,anchor){insert$2(target,div,anchor);if(switch_instance)mount_component(switch_instance,div,null);current=true;if(!mounted){dispose=listen(div,"click",prevent_default(/*handleClear*/ctx[27]));mounted=true;}},p:function p(ctx,dirty){if(switch_value!==(switch_value=/*ClearIcon*/ctx[23])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,null);}else{switch_instance=null;}}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);if(switch_instance)destroy_component(switch_instance);mounted=false;dispose();}};}// (928:4) {#if !showClearIcon && (showIndicator || (showChevron && !value) || (!isSearchable && !isDisabled && !isWaiting && ((showSelectedItem && !isClearable) || !showSelectedItem)))}
function create_if_block_4(ctx){var div;function select_block_type(ctx,dirty){if(/*indicatorSvg*/ctx[22])return create_if_block_5;return create_else_block$3;}var current_block_type=select_block_type(ctx);var if_block=current_block_type(ctx);return{c:function c(){div=element("div");if_block.c();attr(div,"class","indicator svelte-17l1npl");attr(div,"aria-hidden","true");},m:function m(target,anchor){insert$2(target,div,anchor);if_block.m(div,null);},p:function p(ctx,dirty){if(current_block_type===(current_block_type=select_block_type(ctx))&&if_block){if_block.p(ctx,dirty);}else{if_block.d(1);if_block=current_block_type(ctx);if(if_block){if_block.c();if_block.m(div,null);}}},d:function d(detaching){if(detaching)detach(div);if_block.d();}};}// (932:12) {:else}
function create_else_block$3(ctx){var svg;var path;return{c:function c(){svg=svg_element("svg");path=svg_element("path");attr(path,"d","M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747\n          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0\n          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502\n          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0\n          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z");attr(svg,"width","100%");attr(svg,"height","100%");attr(svg,"viewBox","0 0 20 20");attr(svg,"focusable","false");attr(svg,"aria-hidden","true");attr(svg,"class","svelte-17l1npl");},m:function m(target,anchor){insert$2(target,svg,anchor);append$1(svg,path);},p:noop$2,d:function d(detaching){if(detaching)detach(svg);}};}// (930:12) {#if indicatorSvg}
function create_if_block_5(ctx){var html_tag;var html_anchor;return{c:function c(){html_tag=new HtmlTag(false);html_anchor=empty$1();html_tag.a=html_anchor;},m:function m(target,anchor){html_tag.m(/*indicatorSvg*/ctx[22],target,anchor);insert$2(target,html_anchor,anchor);},p:function p(ctx,dirty){if(dirty[0]&/*indicatorSvg*/4194304)html_tag.p(/*indicatorSvg*/ctx[22]);},d:function d(detaching){if(detaching)detach(html_anchor);if(detaching)html_tag.d();}};}// (950:4) {#if isWaiting}
function create_if_block_3$1(ctx){var div;return{c:function c(){div=element("div");div.innerHTML="<svg class=\"spinner_icon svelte-17l1npl\" viewBox=\"25 25 50 50\"><circle class=\"spinner_path svelte-17l1npl\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"5\" stroke-miterlimit=\"10\"></circle></svg>";attr(div,"class","spinner svelte-17l1npl");},m:function m(target,anchor){insert$2(target,div,anchor);},d:function d(detaching){if(detaching)detach(div);}};}// (966:4) {#if listOpen}
function create_if_block_2$1(ctx){var switch_instance;var updating_hoverItemIndex;var switch_instance_anchor;var current;var switch_instance_spread_levels=[/*listProps*/ctx[34]];function switch_instance_hoverItemIndex_binding(value){/*switch_instance_hoverItemIndex_binding*/ctx[84](value);}var switch_value=/*List*/ctx[24];function switch_props(ctx){var switch_instance_props={};for(var _i309=0;_i309<switch_instance_spread_levels.length;_i309+=1){switch_instance_props=assign$1(switch_instance_props,switch_instance_spread_levels[_i309]);}if(/*hoverItemIndex*/ctx[28]!==void 0){switch_instance_props.hoverItemIndex=/*hoverItemIndex*/ctx[28];}return{props:switch_instance_props};}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));binding_callbacks.push(function(){return bind$2(switch_instance,'hoverItemIndex',switch_instance_hoverItemIndex_binding);});switch_instance.$on("itemSelected",/*itemSelected*/ctx[43]);switch_instance.$on("itemCreated",/*itemCreated*/ctx[44]);switch_instance.$on("closeList",/*closeList*/ctx[45]);}return{c:function c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty$1();},m:function m(target,anchor){if(switch_instance)mount_component(switch_instance,target,anchor);insert$2(target,switch_instance_anchor,anchor);current=true;},p:function p(ctx,dirty){var switch_instance_changes=dirty[1]&/*listProps*/8?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*listProps*/ctx[34])]):{};if(!updating_hoverItemIndex&&dirty[0]&/*hoverItemIndex*/268435456){updating_hoverItemIndex=true;switch_instance_changes.hoverItemIndex=/*hoverItemIndex*/ctx[28];add_flush_callback(function(){return updating_hoverItemIndex=false;});}if(switch_value!==(switch_value=/*List*/ctx[24])){if(switch_instance){group_outros();var old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,function(){destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=construct_svelte_component(switch_value,switch_props(ctx));binding_callbacks.push(function(){return bind$2(switch_instance,'hoverItemIndex',switch_instance_hoverItemIndex_binding);});switch_instance.$on("itemSelected",/*itemSelected*/ctx[43]);switch_instance.$on("itemCreated",/*itemCreated*/ctx[44]);switch_instance.$on("closeList",/*closeList*/ctx[45]);create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i:function i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o:function o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}// (976:4) {#if !isMulti || (isMulti && !showMultiSelect)}
function create_if_block_1$2(ctx){var input_1;var input_1_name_value;var input_1_value_value;return{c:function c(){input_1=element("input");attr(input_1,"name",input_1_name_value=/*inputAttributes*/ctx[16].name);attr(input_1,"type","hidden");input_1.value=input_1_value_value=/*value*/ctx[2]?/*getSelectionLabel*/ctx[12](/*value*/ctx[2]):null;attr(input_1,"class","svelte-17l1npl");},m:function m(target,anchor){insert$2(target,input_1,anchor);},p:function p(ctx,dirty){if(dirty[0]&/*inputAttributes*/65536&&input_1_name_value!==(input_1_name_value=/*inputAttributes*/ctx[16].name)){attr(input_1,"name",input_1_name_value);}if(dirty[0]&/*value, getSelectionLabel*/4100&&input_1_value_value!==(input_1_value_value=/*value*/ctx[2]?/*getSelectionLabel*/ctx[12](/*value*/ctx[2]):null)){input_1.value=input_1_value_value;}},d:function d(detaching){if(detaching)detach(input_1);}};}// (983:4) {#if isMulti && showMultiSelect}
function create_if_block$5(ctx){var each_1_anchor;var each_value=/*value*/ctx[2];var each_blocks=[];for(var _i310=0;_i310<each_value.length;_i310+=1){each_blocks[_i310]=create_each_block$2(get_each_context$2(ctx,each_value,_i310));}return{c:function c(){for(var _i311=0;_i311<each_blocks.length;_i311+=1){each_blocks[_i311].c();}each_1_anchor=empty$1();},m:function m(target,anchor){for(var _i312=0;_i312<each_blocks.length;_i312+=1){each_blocks[_i312].m(target,anchor);}insert$2(target,each_1_anchor,anchor);},p:function p(ctx,dirty){if(dirty[0]&/*inputAttributes, value, getSelectionLabel*/69636){each_value=/*value*/ctx[2];var _i313;for(_i313=0;_i313<each_value.length;_i313+=1){var child_ctx=get_each_context$2(ctx,each_value,_i313);if(each_blocks[_i313]){each_blocks[_i313].p(child_ctx,dirty);}else{each_blocks[_i313]=create_each_block$2(child_ctx);each_blocks[_i313].c();each_blocks[_i313].m(each_1_anchor.parentNode,each_1_anchor);}}for(;_i313<each_blocks.length;_i313+=1){each_blocks[_i313].d(1);}each_blocks.length=each_value.length;}},d:function d(detaching){destroy_each(each_blocks,detaching);if(detaching)detach(each_1_anchor);}};}// (984:8) {#each value as item}
function create_each_block$2(ctx){var input_1;var input_1_name_value;var input_1_value_value;return{c:function c(){input_1=element("input");attr(input_1,"name",input_1_name_value=/*inputAttributes*/ctx[16].name);attr(input_1,"type","hidden");input_1.value=input_1_value_value=/*item*/ctx[103]?/*getSelectionLabel*/ctx[12](/*item*/ctx[103]):null;attr(input_1,"class","svelte-17l1npl");},m:function m(target,anchor){insert$2(target,input_1,anchor);},p:function p(ctx,dirty){if(dirty[0]&/*inputAttributes*/65536&&input_1_name_value!==(input_1_name_value=/*inputAttributes*/ctx[16].name)){attr(input_1,"name",input_1_name_value);}if(dirty[0]&/*value, getSelectionLabel*/4100&&input_1_value_value!==(input_1_value_value=/*item*/ctx[103]?/*getSelectionLabel*/ctx[12](/*item*/ctx[103]):null)){input_1.value=input_1_value_value;}},d:function d(detaching){if(detaching)detach(input_1);}};}function create_fragment$7(ctx){var div;var span;var t0;var t1;var t2;var input_1;var input_1_readonly_value;var t3;var t4;var t5;var t6;var t7;var t8;var t9;var div_class_value;var current;var mounted;var dispose;var if_block0=/*isFocused*/ctx[1]&&create_if_block_10(ctx);var if_block1=/*Icon*/ctx[17]&&create_if_block_9(ctx);var if_block2=/*showMultiSelect*/ctx[35]&&create_if_block_8(ctx);var input_1_levels=[{readOnly:input_1_readonly_value=!/*isSearchable*/ctx[13]},/*_inputAttributes*/ctx[31],{placeholder:/*placeholderText*/ctx[36]},{style:/*inputStyles*/ctx[14]},{disabled:/*isDisabled*/ctx[9]}];var input_1_data={};for(var _i314=0;_i314<input_1_levels.length;_i314+=1){input_1_data=assign$1(input_1_data,input_1_levels[_i314]);}var if_block3=!/*isMulti*/ctx[7]&&/*showSelectedItem*/ctx[29]&&create_if_block_7(ctx);var if_block4=/*showClearIcon*/ctx[37]&&create_if_block_6(ctx);var if_block5=!/*showClearIcon*/ctx[37]&&(/*showIndicator*/ctx[20]||/*showChevron*/ctx[19]&&!/*value*/ctx[2]||!/*isSearchable*/ctx[13]&&!/*isDisabled*/ctx[9]&&!/*isWaiting*/ctx[4]&&(/*showSelectedItem*/ctx[29]&&!/*isClearable*/ctx[15]||!/*showSelectedItem*/ctx[29]))&&create_if_block_4(ctx);var if_block6=/*isWaiting*/ctx[4]&&create_if_block_3$1();var if_block7=/*listOpen*/ctx[5]&&create_if_block_2$1(ctx);var if_block8=(!/*isMulti*/ctx[7]||/*isMulti*/ctx[7]&&!/*showMultiSelect*/ctx[35])&&create_if_block_1$2(ctx);var if_block9=/*isMulti*/ctx[7]&&/*showMultiSelect*/ctx[35]&&create_if_block$5(ctx);return{c:function c(){div=element("div");span=element("span");if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if(if_block2)if_block2.c();t2=space();input_1=element("input");t3=space();if(if_block3)if_block3.c();t4=space();if(if_block4)if_block4.c();t5=space();if(if_block5)if_block5.c();t6=space();if(if_block6)if_block6.c();t7=space();if(if_block7)if_block7.c();t8=space();if(if_block8)if_block8.c();t9=space();if(if_block9)if_block9.c();attr(span,"aria-live","polite");attr(span,"aria-atomic","false");attr(span,"aria-relevant","additions text");attr(span,"class","a11yText svelte-17l1npl");set_attributes(input_1,input_1_data);toggle_class(input_1,"svelte-17l1npl",true);attr(div,"class",div_class_value="selectContainer "+/*containerClasses*/ctx[21]+" svelte-17l1npl");attr(div,"style",/*containerStyles*/ctx[11]);toggle_class(div,"hasError",/*hasError*/ctx[10]);toggle_class(div,"multiSelect",/*isMulti*/ctx[7]);toggle_class(div,"disabled",/*isDisabled*/ctx[9]);toggle_class(div,"focused",/*isFocused*/ctx[1]);},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,span);if(if_block0)if_block0.m(span,null);append$1(div,t0);if(if_block1)if_block1.m(div,null);append$1(div,t1);if(if_block2)if_block2.m(div,null);append$1(div,t2);append$1(div,input_1);if(input_1.autofocus)input_1.focus();/*input_1_binding*/ctx[82](input_1);set_input_value(input_1,/*filterText*/ctx[3]);append$1(div,t3);if(if_block3)if_block3.m(div,null);append$1(div,t4);if(if_block4)if_block4.m(div,null);append$1(div,t5);if(if_block5)if_block5.m(div,null);append$1(div,t6);if(if_block6)if_block6.m(div,null);append$1(div,t7);if(if_block7)if_block7.m(div,null);append$1(div,t8);if(if_block8)if_block8.m(div,null);append$1(div,t9);if(if_block9)if_block9.m(div,null);/*div_binding*/ctx[85](div);current=true;if(!mounted){dispose=[listen(window,"click",/*handleWindowEvent*/ctx[41]),listen(window,"focusin",/*handleWindowEvent*/ctx[41]),listen(window,"keydown",/*handleKeyDown*/ctx[39]),listen(input_1,"focus",/*handleFocus*/ctx[40]),listen(input_1,"input",/*input_1_input_handler*/ctx[83]),listen(div,"click",/*handleClick*/ctx[42])];mounted=true;}},p:function p(ctx,dirty){if(/*isFocused*/ctx[1]){if(if_block0){if_block0.p(ctx,dirty);}else{if_block0=create_if_block_10(ctx);if_block0.c();if_block0.m(span,null);}}else if(if_block0){if_block0.d(1);if_block0=null;}if(/*Icon*/ctx[17]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*Icon*/131072){transition_in(if_block1,1);}}else{if_block1=create_if_block_9(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div,t1);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(/*showMultiSelect*/ctx[35]){if(if_block2){if_block2.p(ctx,dirty);if(dirty[1]&/*showMultiSelect*/16){transition_in(if_block2,1);}}else{if_block2=create_if_block_8(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(div,t2);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,function(){if_block2=null;});check_outros();}set_attributes(input_1,input_1_data=get_spread_update(input_1_levels,[(!current||dirty[0]&/*isSearchable*/8192&&input_1_readonly_value!==(input_1_readonly_value=!/*isSearchable*/ctx[13]))&&{readOnly:input_1_readonly_value},dirty[1]&/*_inputAttributes*/1&&/*_inputAttributes*/ctx[31],(!current||dirty[1]&/*placeholderText*/32)&&{placeholder:/*placeholderText*/ctx[36]},(!current||dirty[0]&/*inputStyles*/16384)&&{style:/*inputStyles*/ctx[14]},(!current||dirty[0]&/*isDisabled*/512)&&{disabled:/*isDisabled*/ctx[9]}]));if(dirty[0]&/*filterText*/8&&input_1.value!==/*filterText*/ctx[3]){set_input_value(input_1,/*filterText*/ctx[3]);}toggle_class(input_1,"svelte-17l1npl",true);if(!/*isMulti*/ctx[7]&&/*showSelectedItem*/ctx[29]){if(if_block3){if_block3.p(ctx,dirty);if(dirty[0]&/*isMulti, showSelectedItem*/536871040){transition_in(if_block3,1);}}else{if_block3=create_if_block_7(ctx);if_block3.c();transition_in(if_block3,1);if_block3.m(div,t4);}}else if(if_block3){group_outros();transition_out(if_block3,1,1,function(){if_block3=null;});check_outros();}if(/*showClearIcon*/ctx[37]){if(if_block4){if_block4.p(ctx,dirty);if(dirty[1]&/*showClearIcon*/64){transition_in(if_block4,1);}}else{if_block4=create_if_block_6(ctx);if_block4.c();transition_in(if_block4,1);if_block4.m(div,t5);}}else if(if_block4){group_outros();transition_out(if_block4,1,1,function(){if_block4=null;});check_outros();}if(!/*showClearIcon*/ctx[37]&&(/*showIndicator*/ctx[20]||/*showChevron*/ctx[19]&&!/*value*/ctx[2]||!/*isSearchable*/ctx[13]&&!/*isDisabled*/ctx[9]&&!/*isWaiting*/ctx[4]&&(/*showSelectedItem*/ctx[29]&&!/*isClearable*/ctx[15]||!/*showSelectedItem*/ctx[29]))){if(if_block5){if_block5.p(ctx,dirty);}else{if_block5=create_if_block_4(ctx);if_block5.c();if_block5.m(div,t6);}}else if(if_block5){if_block5.d(1);if_block5=null;}if(/*isWaiting*/ctx[4]){if(if_block6);else{if_block6=create_if_block_3$1();if_block6.c();if_block6.m(div,t7);}}else if(if_block6){if_block6.d(1);if_block6=null;}if(/*listOpen*/ctx[5]){if(if_block7){if_block7.p(ctx,dirty);if(dirty[0]&/*listOpen*/32){transition_in(if_block7,1);}}else{if_block7=create_if_block_2$1(ctx);if_block7.c();transition_in(if_block7,1);if_block7.m(div,t8);}}else if(if_block7){group_outros();transition_out(if_block7,1,1,function(){if_block7=null;});check_outros();}if(!/*isMulti*/ctx[7]||/*isMulti*/ctx[7]&&!/*showMultiSelect*/ctx[35]){if(if_block8){if_block8.p(ctx,dirty);}else{if_block8=create_if_block_1$2(ctx);if_block8.c();if_block8.m(div,t9);}}else if(if_block8){if_block8.d(1);if_block8=null;}if(/*isMulti*/ctx[7]&&/*showMultiSelect*/ctx[35]){if(if_block9){if_block9.p(ctx,dirty);}else{if_block9=create_if_block$5(ctx);if_block9.c();if_block9.m(div,null);}}else if(if_block9){if_block9.d(1);if_block9=null;}if(!current||dirty[0]&/*containerClasses*/2097152&&div_class_value!==(div_class_value="selectContainer "+/*containerClasses*/ctx[21]+" svelte-17l1npl")){attr(div,"class",div_class_value);}if(!current||dirty[0]&/*containerStyles*/2048){attr(div,"style",/*containerStyles*/ctx[11]);}if(!current||dirty[0]&/*containerClasses, hasError*/2098176){toggle_class(div,"hasError",/*hasError*/ctx[10]);}if(!current||dirty[0]&/*containerClasses, isMulti*/2097280){toggle_class(div,"multiSelect",/*isMulti*/ctx[7]);}if(!current||dirty[0]&/*containerClasses, isDisabled*/2097664){toggle_class(div,"disabled",/*isDisabled*/ctx[9]);}if(!current||dirty[0]&/*containerClasses, isFocused*/2097154){toggle_class(div,"focused",/*isFocused*/ctx[1]);}},i:function i(local){if(current)return;transition_in(if_block1);transition_in(if_block2);transition_in(if_block3);transition_in(if_block4);transition_in(if_block7);current=true;},o:function o(local){transition_out(if_block1);transition_out(if_block2);transition_out(if_block3);transition_out(if_block4);transition_out(if_block7);current=false;},d:function d(detaching){if(detaching)detach(div);if(if_block0)if_block0.d();if(if_block1)if_block1.d();if(if_block2)if_block2.d();/*input_1_binding*/ctx[82](null);if(if_block3)if_block3.d();if(if_block4)if_block4.d();if(if_block5)if_block5.d();if(if_block6)if_block6.d();if(if_block7)if_block7.d();if(if_block8)if_block8.d();if(if_block9)if_block9.d();/*div_binding*/ctx[85](null);mounted=false;run_all(dispose);}};}function convertStringItemsToObjects(_items){return _items.map(function(item,index){return{index:index,value:item,label:"".concat(item)};});}function instance$8($$self,$$props,$$invalidate){var filteredItems;var showSelectedItem;var showClearIcon;var placeholderText;var showMultiSelect;var listProps;var ariaSelection;var ariaContext;var dispatch=createEventDispatcher();var _$$props$id=$$props.id,id=_$$props$id===void 0?null:_$$props$id;var _$$props$container2=$$props.container,container=_$$props$container2===void 0?undefined:_$$props$container2;var _$$props$input=$$props.input,input=_$$props$input===void 0?undefined:_$$props$input;var _$$props$isMulti2=$$props.isMulti,isMulti=_$$props$isMulti2===void 0?false:_$$props$isMulti2;var _$$props$multiFullIte2=$$props.multiFullItemClearable,multiFullItemClearable=_$$props$multiFullIte2===void 0?false:_$$props$multiFullIte2;var _$$props$isDisabled2=$$props.isDisabled,isDisabled=_$$props$isDisabled2===void 0?false:_$$props$isDisabled2;var _$$props$isCreatable=$$props.isCreatable,isCreatable=_$$props$isCreatable===void 0?false:_$$props$isCreatable;var _$$props$isFocused=$$props.isFocused,isFocused=_$$props$isFocused===void 0?false:_$$props$isFocused;var _$$props$value3=$$props.value,value=_$$props$value3===void 0?null:_$$props$value3;var _$$props$filterText3=$$props.filterText,filterText=_$$props$filterText3===void 0?'':_$$props$filterText3;var _$$props$placeholder=$$props.placeholder,placeholder=_$$props$placeholder===void 0?'Select...':_$$props$placeholder;var _$$props$placeholderA=$$props.placeholderAlwaysShow,placeholderAlwaysShow=_$$props$placeholderA===void 0?false:_$$props$placeholderA;var _$$props$items5=$$props.items,items=_$$props$items5===void 0?null:_$$props$items5;var _$$props$itemFilter=$$props.itemFilter,itemFilter=_$$props$itemFilter===void 0?function(label,filterText,option){return"".concat(label).toLowerCase().includes(filterText.toLowerCase());}:_$$props$itemFilter;var _$$props$groupBy=$$props.groupBy,groupBy=_$$props$groupBy===void 0?undefined:_$$props$groupBy;var _$$props$groupFilter=$$props.groupFilter,groupFilter=_$$props$groupFilter===void 0?function(groups){return groups;}:_$$props$groupFilter;var _$$props$isGroupHeade=$$props.isGroupHeaderSelectable,isGroupHeaderSelectable=_$$props$isGroupHeade===void 0?false:_$$props$isGroupHeade;var _$$props$getGroupHead2=$$props.getGroupHeaderLabel,getGroupHeaderLabel=_$$props$getGroupHead2===void 0?function(option){return option[labelIdentifier]||option.id;}:_$$props$getGroupHead2;var _$$props$labelIdentif2=$$props.labelIdentifier,labelIdentifier=_$$props$labelIdentif2===void 0?'label':_$$props$labelIdentif2;var _$$props$getOptionLab3=$$props.getOptionLabel,getOptionLabel=_$$props$getOptionLab3===void 0?function(option,filterText){return option.isCreator?"Create \"".concat(filterText,"\""):option[labelIdentifier];}:_$$props$getOptionLab3;var _$$props$optionIdenti2=$$props.optionIdentifier,optionIdentifier=_$$props$optionIdenti2===void 0?'value':_$$props$optionIdenti2;var _$$props$loadOptions=$$props.loadOptions,loadOptions=_$$props$loadOptions===void 0?undefined:_$$props$loadOptions;var _$$props$hasError=$$props.hasError,hasError=_$$props$hasError===void 0?false:_$$props$hasError;var _$$props$containerSty=$$props.containerStyles,containerStyles=_$$props$containerSty===void 0?'':_$$props$containerSty;var _$$props$getSelection3=$$props.getSelectionLabel,getSelectionLabel=_$$props$getSelection3===void 0?function(option){if(option)return option[labelIdentifier];else return null;}:_$$props$getSelection3;var _$$props$createGroupH=$$props.createGroupHeaderItem,createGroupHeaderItem=_$$props$createGroupH===void 0?function(groupValue){return{value:groupValue,label:groupValue};}:_$$props$createGroupH;var _$$props$createItem=$$props.createItem,createItem=_$$props$createItem===void 0?function(filterText){return{value:filterText,label:filterText};}:_$$props$createItem;var getFilteredItems=function getFilteredItems(){return filteredItems;};var _$$props$isSearchable=$$props.isSearchable,isSearchable=_$$props$isSearchable===void 0?true:_$$props$isSearchable;var _$$props$inputStyles=$$props.inputStyles,inputStyles=_$$props$inputStyles===void 0?'':_$$props$inputStyles;var _$$props$isClearable=$$props.isClearable,isClearable=_$$props$isClearable===void 0?true:_$$props$isClearable;var _$$props$isWaiting=$$props.isWaiting,isWaiting=_$$props$isWaiting===void 0?false:_$$props$isWaiting;var _$$props$listPlacemen2=$$props.listPlacement,listPlacement=_$$props$listPlacemen2===void 0?'auto':_$$props$listPlacemen2;var _$$props$listOpen=$$props.listOpen,listOpen=_$$props$listOpen===void 0?false:_$$props$listOpen;var _$$props$isVirtualLis2=$$props.isVirtualList,isVirtualList=_$$props$isVirtualLis2===void 0?false:_$$props$isVirtualLis2;var _$$props$loadOptionsI=$$props.loadOptionsInterval,loadOptionsInterval=_$$props$loadOptionsI===void 0?300:_$$props$loadOptionsI;var _$$props$noOptionsMes2=$$props.noOptionsMessage,noOptionsMessage=_$$props$noOptionsMes2===void 0?'No options':_$$props$noOptionsMes2;var _$$props$hideEmptySta2=$$props.hideEmptyState,hideEmptyState=_$$props$hideEmptySta2===void 0?false:_$$props$hideEmptySta2;var _$$props$inputAttribu=$$props.inputAttributes,inputAttributes=_$$props$inputAttribu===void 0?{}:_$$props$inputAttribu;var _$$props$listAutoWidt2=$$props.listAutoWidth,listAutoWidth=_$$props$listAutoWidt2===void 0?true:_$$props$listAutoWidt2;var _$$props$itemHeight3=$$props.itemHeight,itemHeight=_$$props$itemHeight3===void 0?40:_$$props$itemHeight3;var _$$props$Icon=$$props.Icon,Icon=_$$props$Icon===void 0?undefined:_$$props$Icon;var _$$props$iconProps=$$props.iconProps,iconProps=_$$props$iconProps===void 0?{}:_$$props$iconProps;var _$$props$showChevron=$$props.showChevron,showChevron=_$$props$showChevron===void 0?false:_$$props$showChevron;var _$$props$showIndicato=$$props.showIndicator,showIndicator=_$$props$showIndicato===void 0?false:_$$props$showIndicato;var _$$props$containerCla=$$props.containerClasses,containerClasses=_$$props$containerCla===void 0?'':_$$props$containerCla;var _$$props$indicatorSvg=$$props.indicatorSvg,indicatorSvg=_$$props$indicatorSvg===void 0?undefined:_$$props$indicatorSvg;var _$$props$listOffset2=$$props.listOffset,listOffset=_$$props$listOffset2===void 0?5:_$$props$listOffset2;var _$$props$ClearIcon=$$props.ClearIcon,ClearIcon$1=_$$props$ClearIcon===void 0?ClearIcon:_$$props$ClearIcon;var _$$props$Item2=$$props.Item,Item$1=_$$props$Item2===void 0?Item:_$$props$Item2;var _$$props$List=$$props.List,List$1=_$$props$List===void 0?List:_$$props$List;var _$$props$Selection=$$props.Selection,Selection$1=_$$props$Selection===void 0?Selection:_$$props$Selection;var _$$props$MultiSelecti=$$props.MultiSelection,MultiSelection$1=_$$props$MultiSelecti===void 0?MultiSelection:_$$props$MultiSelecti;var _$$props$VirtualList2=$$props.VirtualList,VirtualList$1=_$$props$VirtualList2===void 0?VirtualList:_$$props$VirtualList2;function filterMethod(args){if(args.loadOptions&&args.filterText.length>0)return;if(!args.items)return[];if(args.items&&args.items.length>0&&_typeof2(args.items[0])!=='object'){args.items=convertStringItemsToObjects(args.items);}var filterResults=args.items.filter(function(item){var matchesFilter=itemFilter(getOptionLabel(item,args.filterText),args.filterText,item);if(matchesFilter&&args.isMulti&&args.value&&Array.isArray(args.value)){matchesFilter=!args.value.some(function(x){return x[args.optionIdentifier]===item[args.optionIdentifier];});}return matchesFilter;});if(args.groupBy){filterResults=filterGroupedItems(filterResults);}if(args.isCreatable){filterResults=addCreatableItem(filterResults,args.filterText);}return filterResults;}function addCreatableItem(_items,_filterText){if(_filterText.length===0)return _items;var itemToCreate=createItem(_filterText);if(_items[0]&&_filterText===_items[0][labelIdentifier])return _items;itemToCreate.isCreator=true;return[].concat(_toConsumableArray2(_items),[itemToCreate]);}var _$$props$selectedValu=$$props.selectedValue,selectedValue=_$$props$selectedValu===void 0?null:_$$props$selectedValu;var activeValue;var prev_value;var prev_filterText;var prev_isFocused;var prev_isMulti;var hoverItemIndex;var getItems=debounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee20(){var res;return _regeneratorRuntime().wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:$$invalidate(4,isWaiting=true);_context20.next=3;return loadOptions(filterText)["catch"](function(err){console.warn('svelte-select loadOptions error :>> ',err);dispatch('error',{type:'loadOptions',details:err});});case 3:res=_context20.sent;if(res&&!res.cancelled){if(res){if(res&&res.length>0&&_typeof2(res[0])!=='object'){res=convertStringItemsToObjects(res);}$$invalidate(81,filteredItems=_toConsumableArray2(res));dispatch('loaded',{items:filteredItems});}else{$$invalidate(81,filteredItems=[]);}if(isCreatable){$$invalidate(81,filteredItems=addCreatableItem(filteredItems,filterText));}$$invalidate(4,isWaiting=false);$$invalidate(1,isFocused=true);$$invalidate(5,listOpen=true);}case 5:case"end":return _context20.stop();}}},_callee20);})),loadOptionsInterval);function setValue(){if(typeof value==='string'){var _value4;$$invalidate(2,value=(_value4={},_defineProperty2(_value4,optionIdentifier,value),_defineProperty2(_value4,"label",value),_value4));}else if(isMulti&&Array.isArray(value)&&value.length>0){$$invalidate(2,value=value.map(function(item){return typeof item==='string'?{value:item,label:item}:item;}));}}var _inputAttributes;function assignInputAttributes(){$$invalidate(31,_inputAttributes=Object.assign({autocapitalize:'none',autocomplete:'off',autocorrect:'off',spellcheck:false,tabindex:0,type:'text','aria-autocomplete':'list'},inputAttributes));if(id){$$invalidate(31,_inputAttributes.id=id,_inputAttributes);}if(!isSearchable){$$invalidate(31,_inputAttributes.readonly=true,_inputAttributes);}}function filterGroupedItems(_items){var groupValues=[];var groups={};_items.forEach(function(item){var groupValue=groupBy(item);if(!groupValues.includes(groupValue)){groupValues.push(groupValue);groups[groupValue]=[];if(groupValue){groups[groupValue].push(Object.assign(createGroupHeaderItem(groupValue,item),{id:groupValue,isGroupHeader:true,isSelectable:isGroupHeaderSelectable}));}}groups[groupValue].push(Object.assign({isGroupItem:!!groupValue},item));});var sortedGroupedItems=[];groupFilter(groupValues).forEach(function(groupValue){sortedGroupedItems.push.apply(sortedGroupedItems,_toConsumableArray2(groups[groupValue]));});return sortedGroupedItems;}function dispatchSelectedItem(){if(isMulti){if(JSON.stringify(value)!==JSON.stringify(prev_value)){if(checkValueForDuplicates()){dispatch('select',value);}}return;}if(!prev_value||JSON.stringify(value[optionIdentifier])!==JSON.stringify(prev_value[optionIdentifier])){dispatch('select',value);}}function setupFocus(){if(isFocused||listOpen){handleFocus();}else{if(input)input.blur();}}function setupMulti(){if(value){if(Array.isArray(value)){$$invalidate(2,value=_toConsumableArray2(value));}else{$$invalidate(2,value=[value]);}}}function setupSingle(){if(value)$$invalidate(2,value=null);}function setupFilterText(){if(filterText.length===0)return;$$invalidate(1,isFocused=true);$$invalidate(5,listOpen=true);if(loadOptions){getItems();}else{$$invalidate(5,listOpen=true);if(isMulti){$$invalidate(30,activeValue=undefined);}}}beforeUpdate(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee21(){return _regeneratorRuntime().wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:$$invalidate(77,prev_value=value);$$invalidate(78,prev_filterText=filterText);$$invalidate(79,prev_isFocused=isFocused);$$invalidate(80,prev_isMulti=isMulti);case 4:case"end":return _context21.stop();}}},_callee21);})));function checkValueForDuplicates(){var noDuplicates=true;if(value){var ids=[];var uniqueValues=[];value.forEach(function(val){if(!ids.includes(val[optionIdentifier])){ids.push(val[optionIdentifier]);uniqueValues.push(val);}else{noDuplicates=false;}});if(!noDuplicates)$$invalidate(2,value=uniqueValues);}return noDuplicates;}function findItem(selection){var matchTo=selection?selection[optionIdentifier]:value[optionIdentifier];return items.find(function(item){return item[optionIdentifier]===matchTo;});}function updateValueDisplay(items){if(!items||items.length===0||items.some(function(item){return _typeof2(item)!=='object';}))return;if(!value||(isMulti?value.some(function(selection){return!selection||!selection[optionIdentifier];}):!value[optionIdentifier]))return;if(Array.isArray(value)){$$invalidate(2,value=value.map(function(selection){return findItem(selection)||selection;}));}else{$$invalidate(2,value=findItem()||value);}}function handleMultiItemClear(event){var detail=event.detail;var itemToRemove=value[detail?detail.i:value.length-1];if(value.length===1){$$invalidate(2,value=undefined);}else{$$invalidate(2,value=value.filter(function(item){return item!==itemToRemove;}));}dispatch('clear',itemToRemove);}function handleKeyDown(e){if(!isFocused)return;switch(e.key){case'ArrowDown':e.preventDefault();$$invalidate(5,listOpen=true);$$invalidate(30,activeValue=undefined);break;case'ArrowUp':e.preventDefault();$$invalidate(5,listOpen=true);$$invalidate(30,activeValue=undefined);break;case'Tab':if(!listOpen)$$invalidate(1,isFocused=false);break;case'Backspace':if(!isMulti||filterText.length>0)return;if(isMulti&&value&&value.length>0){handleMultiItemClear(activeValue!==undefined?activeValue:value.length-1);if(activeValue===0||activeValue===undefined)break;$$invalidate(30,activeValue=value.length>activeValue?activeValue-1:undefined);}break;case'ArrowLeft':if(!isMulti||filterText.length>0)return;if(activeValue===undefined){$$invalidate(30,activeValue=value.length-1);}else if(value.length>activeValue&&activeValue!==0){$$invalidate(30,activeValue-=1);}break;case'ArrowRight':if(!isMulti||filterText.length>0||activeValue===undefined)return;if(activeValue===value.length-1){$$invalidate(30,activeValue=undefined);}else if(activeValue<value.length-1){$$invalidate(30,activeValue+=1);}break;}}function handleFocus(){$$invalidate(1,isFocused=true);if(input)input.focus();}function handleWindowEvent(event){if(!container)return;var eventTarget=event.path&&event.path.length>0?event.path[0]:event.target;if(container.contains(eventTarget)||container.contains(event.relatedTarget)){return;}$$invalidate(1,isFocused=false);$$invalidate(5,listOpen=false);$$invalidate(30,activeValue=undefined);if(input)input.blur();}function handleClick(){if(isDisabled)return;$$invalidate(1,isFocused=true);$$invalidate(5,listOpen=!listOpen);}function handleClear(){$$invalidate(2,value=undefined);$$invalidate(5,listOpen=false);dispatch('clear',value);handleFocus();}onMount(function(){if(isFocused&&input)input.focus();});function itemSelected(event){var detail=event.detail;if(detail){$$invalidate(3,filterText='');var item=Object.assign({},detail);if(!item.isGroupHeader||item.isSelectable){if(isMulti){$$invalidate(2,value=value?value.concat([item]):[item]);}else{$$invalidate(2,value=item);}$$invalidate(2,value);setTimeout(function(){$$invalidate(5,listOpen=false);$$invalidate(30,activeValue=undefined);});}}}function itemCreated(event){var detail=event.detail;if(isMulti){$$invalidate(2,value=value||[]);$$invalidate(2,value=[].concat(_toConsumableArray2(value),[createItem(detail)]));}else{$$invalidate(2,value=createItem(detail));}dispatch('itemCreated',detail);$$invalidate(3,filterText='');$$invalidate(5,listOpen=false);$$invalidate(30,activeValue=undefined);}function closeList(){$$invalidate(3,filterText='');$$invalidate(5,listOpen=false);}var _$$props$ariaValues=$$props.ariaValues,ariaValues=_$$props$ariaValues===void 0?function(values){return"Option ".concat(values,", selected.");}:_$$props$ariaValues;var _$$props$ariaListOpen=$$props.ariaListOpen,ariaListOpen=_$$props$ariaListOpen===void 0?function(label,count){return"You are currently focused on option ".concat(label,". There are ").concat(count," results available.");}:_$$props$ariaListOpen;var _$$props$ariaFocused=$$props.ariaFocused,ariaFocused=_$$props$ariaFocused===void 0?function(){return"Select is focused, type to refine list, press down to open the menu.";}:_$$props$ariaFocused;function handleAriaSelection(){var selected=undefined;if(isMulti&&value.length>0){selected=value.map(function(v){return getSelectionLabel(v);}).join(', ');}else{selected=getSelectionLabel(value);}return ariaValues(selected);}function handleAriaContent(){if(!isFocused||!filteredItems||filteredItems.length===0)return'';var _item=filteredItems[hoverItemIndex];if(listOpen&&_item){var label=getSelectionLabel(_item);var count=filteredItems?filteredItems.length:0;return ariaListOpen(label,count);}else{return ariaFocused();}}function input_1_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){input=$$value;$$invalidate(6,input);});}function input_1_input_handler(){filterText=this.value;$$invalidate(3,filterText);}function switch_instance_hoverItemIndex_binding(value){hoverItemIndex=value;$$invalidate(28,hoverItemIndex);}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){container=$$value;$$invalidate(0,container);});}$$self.$$set=function($$props){if('id'in $$props)$$invalidate(46,id=$$props.id);if('container'in $$props)$$invalidate(0,container=$$props.container);if('input'in $$props)$$invalidate(6,input=$$props.input);if('isMulti'in $$props)$$invalidate(7,isMulti=$$props.isMulti);if('multiFullItemClearable'in $$props)$$invalidate(8,multiFullItemClearable=$$props.multiFullItemClearable);if('isDisabled'in $$props)$$invalidate(9,isDisabled=$$props.isDisabled);if('isCreatable'in $$props)$$invalidate(47,isCreatable=$$props.isCreatable);if('isFocused'in $$props)$$invalidate(1,isFocused=$$props.isFocused);if('value'in $$props)$$invalidate(2,value=$$props.value);if('filterText'in $$props)$$invalidate(3,filterText=$$props.filterText);if('placeholder'in $$props)$$invalidate(48,placeholder=$$props.placeholder);if('placeholderAlwaysShow'in $$props)$$invalidate(49,placeholderAlwaysShow=$$props.placeholderAlwaysShow);if('items'in $$props)$$invalidate(50,items=$$props.items);if('itemFilter'in $$props)$$invalidate(51,itemFilter=$$props.itemFilter);if('groupBy'in $$props)$$invalidate(52,groupBy=$$props.groupBy);if('groupFilter'in $$props)$$invalidate(53,groupFilter=$$props.groupFilter);if('isGroupHeaderSelectable'in $$props)$$invalidate(54,isGroupHeaderSelectable=$$props.isGroupHeaderSelectable);if('getGroupHeaderLabel'in $$props)$$invalidate(55,getGroupHeaderLabel=$$props.getGroupHeaderLabel);if('labelIdentifier'in $$props)$$invalidate(56,labelIdentifier=$$props.labelIdentifier);if('getOptionLabel'in $$props)$$invalidate(57,getOptionLabel=$$props.getOptionLabel);if('optionIdentifier'in $$props)$$invalidate(58,optionIdentifier=$$props.optionIdentifier);if('loadOptions'in $$props)$$invalidate(59,loadOptions=$$props.loadOptions);if('hasError'in $$props)$$invalidate(10,hasError=$$props.hasError);if('containerStyles'in $$props)$$invalidate(11,containerStyles=$$props.containerStyles);if('getSelectionLabel'in $$props)$$invalidate(12,getSelectionLabel=$$props.getSelectionLabel);if('createGroupHeaderItem'in $$props)$$invalidate(60,createGroupHeaderItem=$$props.createGroupHeaderItem);if('createItem'in $$props)$$invalidate(61,createItem=$$props.createItem);if('isSearchable'in $$props)$$invalidate(13,isSearchable=$$props.isSearchable);if('inputStyles'in $$props)$$invalidate(14,inputStyles=$$props.inputStyles);if('isClearable'in $$props)$$invalidate(15,isClearable=$$props.isClearable);if('isWaiting'in $$props)$$invalidate(4,isWaiting=$$props.isWaiting);if('listPlacement'in $$props)$$invalidate(63,listPlacement=$$props.listPlacement);if('listOpen'in $$props)$$invalidate(5,listOpen=$$props.listOpen);if('isVirtualList'in $$props)$$invalidate(64,isVirtualList=$$props.isVirtualList);if('loadOptionsInterval'in $$props)$$invalidate(65,loadOptionsInterval=$$props.loadOptionsInterval);if('noOptionsMessage'in $$props)$$invalidate(66,noOptionsMessage=$$props.noOptionsMessage);if('hideEmptyState'in $$props)$$invalidate(67,hideEmptyState=$$props.hideEmptyState);if('inputAttributes'in $$props)$$invalidate(16,inputAttributes=$$props.inputAttributes);if('listAutoWidth'in $$props)$$invalidate(68,listAutoWidth=$$props.listAutoWidth);if('itemHeight'in $$props)$$invalidate(69,itemHeight=$$props.itemHeight);if('Icon'in $$props)$$invalidate(17,Icon=$$props.Icon);if('iconProps'in $$props)$$invalidate(18,iconProps=$$props.iconProps);if('showChevron'in $$props)$$invalidate(19,showChevron=$$props.showChevron);if('showIndicator'in $$props)$$invalidate(20,showIndicator=$$props.showIndicator);if('containerClasses'in $$props)$$invalidate(21,containerClasses=$$props.containerClasses);if('indicatorSvg'in $$props)$$invalidate(22,indicatorSvg=$$props.indicatorSvg);if('listOffset'in $$props)$$invalidate(70,listOffset=$$props.listOffset);if('ClearIcon'in $$props)$$invalidate(23,ClearIcon$1=$$props.ClearIcon);if('Item'in $$props)$$invalidate(71,Item$1=$$props.Item);if('List'in $$props)$$invalidate(24,List$1=$$props.List);if('Selection'in $$props)$$invalidate(25,Selection$1=$$props.Selection);if('MultiSelection'in $$props)$$invalidate(26,MultiSelection$1=$$props.MultiSelection);if('VirtualList'in $$props)$$invalidate(72,VirtualList$1=$$props.VirtualList);if('selectedValue'in $$props)$$invalidate(73,selectedValue=$$props.selectedValue);if('ariaValues'in $$props)$$invalidate(74,ariaValues=$$props.ariaValues);if('ariaListOpen'in $$props)$$invalidate(75,ariaListOpen=$$props.ariaListOpen);if('ariaFocused'in $$props)$$invalidate(76,ariaFocused=$$props.ariaFocused);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*filterText, value, isMulti*/140|$$self.$$.dirty[1]&/*loadOptions, items, optionIdentifier, groupBy, isCreatable*/405340160){$$invalidate(81,filteredItems=filterMethod({loadOptions:loadOptions,filterText:filterText,items:items,value:value,isMulti:isMulti,optionIdentifier:optionIdentifier,groupBy:groupBy,isCreatable:isCreatable}));}if($$self.$$.dirty[2]&/*selectedValue*/2048){{if(selectedValue)console.warn('selectedValue is no longer used. Please use value instead.');}}if($$self.$$.dirty[1]&/*items*/524288){updateValueDisplay(items);}if($$self.$$.dirty[0]&/*value*/4){{if(value)setValue();}}if($$self.$$.dirty[0]&/*inputAttributes, isSearchable*/73728){{if(inputAttributes||!isSearchable)assignInputAttributes();}}if($$self.$$.dirty[0]&/*isMulti*/128|$$self.$$.dirty[2]&/*prev_isMulti*/262144){{if(isMulti){setupMulti();}if(prev_isMulti&&!isMulti){setupSingle();}}}if($$self.$$.dirty[0]&/*isMulti, value*/132){{if(isMulti&&value&&value.length>1){checkValueForDuplicates();}}}if($$self.$$.dirty[0]&/*value*/4){{if(value)dispatchSelectedItem();}}if($$self.$$.dirty[0]&/*value, isMulti*/132|$$self.$$.dirty[2]&/*prev_value*/32768){{if(!value&&isMulti&&prev_value){dispatch('select',value);}}}if($$self.$$.dirty[0]&/*isFocused*/2|$$self.$$.dirty[2]&/*prev_isFocused*/131072){{if(isFocused!==prev_isFocused){setupFocus();}}}if($$self.$$.dirty[0]&/*filterText*/8|$$self.$$.dirty[2]&/*prev_filterText*/65536){{if(filterText!==prev_filterText){setupFilterText();}}}if($$self.$$.dirty[0]&/*value, filterText*/12){$$invalidate(29,showSelectedItem=value&&filterText.length===0);}if($$self.$$.dirty[0]&/*showSelectedItem, isClearable, isDisabled, isWaiting*/536904208){$$invalidate(37,showClearIcon=showSelectedItem&&isClearable&&!isDisabled&&!isWaiting);}if($$self.$$.dirty[0]&/*isMulti, value*/132|$$self.$$.dirty[1]&/*placeholderAlwaysShow, placeholder*/393216){$$invalidate(36,placeholderText=placeholderAlwaysShow&&isMulti?placeholder:value?'':placeholder);}if($$self.$$.dirty[0]&/*isMulti, value*/132){$$invalidate(35,showMultiSelect=isMulti&&value&&value.length>0);}if($$self.$$.dirty[0]&/*filterText, value, isMulti, container*/141|$$self.$$.dirty[1]&/*optionIdentifier, getGroupHeaderLabel, getOptionLabel*/218103808|$$self.$$.dirty[2]&/*Item, noOptionsMessage, hideEmptyState, isVirtualList, VirtualList, filteredItems, itemHeight, listPlacement, listAutoWidth, listOffset*/526326){$$invalidate(34,listProps={Item:Item$1,filterText:filterText,optionIdentifier:optionIdentifier,noOptionsMessage:noOptionsMessage,hideEmptyState:hideEmptyState,isVirtualList:isVirtualList,VirtualList:VirtualList$1,value:value,isMulti:isMulti,getGroupHeaderLabel:getGroupHeaderLabel,items:filteredItems,itemHeight:itemHeight,getOptionLabel:getOptionLabel,listPlacement:listPlacement,parent:container,listAutoWidth:listAutoWidth,listOffset:listOffset});}if($$self.$$.dirty[0]&/*value, isMulti*/132){$$invalidate(33,ariaSelection=value?handleAriaSelection():'');}if($$self.$$.dirty[0]&/*hoverItemIndex, isFocused, listOpen*/268435490|$$self.$$.dirty[2]&/*filteredItems*/524288){$$invalidate(32,ariaContext=handleAriaContent());}};return[container,isFocused,value,filterText,isWaiting,listOpen,input,isMulti,multiFullItemClearable,isDisabled,hasError,containerStyles,getSelectionLabel,isSearchable,inputStyles,isClearable,inputAttributes,Icon,iconProps,showChevron,showIndicator,containerClasses,indicatorSvg,ClearIcon$1,List$1,Selection$1,MultiSelection$1,handleClear,hoverItemIndex,showSelectedItem,activeValue,_inputAttributes,ariaContext,ariaSelection,listProps,showMultiSelect,placeholderText,showClearIcon,handleMultiItemClear,handleKeyDown,handleFocus,handleWindowEvent,handleClick,itemSelected,itemCreated,closeList,id,isCreatable,placeholder,placeholderAlwaysShow,items,itemFilter,groupBy,groupFilter,isGroupHeaderSelectable,getGroupHeaderLabel,labelIdentifier,getOptionLabel,optionIdentifier,loadOptions,createGroupHeaderItem,createItem,getFilteredItems,listPlacement,isVirtualList,loadOptionsInterval,noOptionsMessage,hideEmptyState,listAutoWidth,itemHeight,listOffset,Item$1,VirtualList$1,selectedValue,ariaValues,ariaListOpen,ariaFocused,prev_value,prev_filterText,prev_isFocused,prev_isMulti,filteredItems,input_1_binding,input_1_input_handler,switch_instance_hoverItemIndex_binding,div_binding];}var Select=/*#__PURE__*/function(_SvelteComponent51){_inherits(Select,_SvelteComponent51);var _super92=_createSuper(Select);function Select(options){var _this146;_classCallCheck(this,Select);_this146=_super92.call(this);init(_assertThisInitialized(_this146),options,instance$8,create_fragment$7,safe_not_equal,{id:46,container:0,input:6,isMulti:7,multiFullItemClearable:8,isDisabled:9,isCreatable:47,isFocused:1,value:2,filterText:3,placeholder:48,placeholderAlwaysShow:49,items:50,itemFilter:51,groupBy:52,groupFilter:53,isGroupHeaderSelectable:54,getGroupHeaderLabel:55,labelIdentifier:56,getOptionLabel:57,optionIdentifier:58,loadOptions:59,hasError:10,containerStyles:11,getSelectionLabel:12,createGroupHeaderItem:60,createItem:61,getFilteredItems:62,isSearchable:13,inputStyles:14,isClearable:15,isWaiting:4,listPlacement:63,listOpen:5,isVirtualList:64,loadOptionsInterval:65,noOptionsMessage:66,hideEmptyState:67,inputAttributes:16,listAutoWidth:68,itemHeight:69,Icon:17,iconProps:18,showChevron:19,showIndicator:20,containerClasses:21,indicatorSvg:22,listOffset:70,ClearIcon:23,Item:71,List:24,Selection:25,MultiSelection:26,VirtualList:72,selectedValue:73,handleClear:27,ariaValues:74,ariaListOpen:75,ariaFocused:76},add_css$7,[-1,-1,-1,-1]);return _this146;}_createClass(Select,[{key:"getFilteredItems",get:function get(){return this.$$.ctx[62];}},{key:"handleClear",get:function get(){return this.$$.ctx[27];}}]);return Select;}(SvelteComponent);/* src/lib/components/modals/TransformWizard.svelte generated by Svelte v3.51.0 */function add_css$6(target){append_styles(target,"svelte-13taczd","table.jse-transform-wizard.svelte-13taczd.svelte-13taczd{border-collapse:collapse;border-spacing:0;width:100%}table.jse-transform-wizard.svelte-13taczd input.svelte-13taczd{font-family:inherit;font-size:inherit}table.jse-transform-wizard.svelte-13taczd tr th.svelte-13taczd{font-weight:normal;text-align:left;width:60px}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd{width:100%;display:flex;flex-direction:row;margin-bottom:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer.jse-filter-path{flex:4;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer.jse-filter-relation{flex:1.5;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer.jse-sort-path{flex:3;margin-right:calc(0.5 * var(--jse-padding))}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer.jse-sort-direction{flex:1}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer.jse-projection-paths{flex:1}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal.svelte-13taczd .selectContainer input{box-sizing:border-box}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal .jse-filter-value.svelte-13taczd{flex:4;padding:4px 8px;border:var(--jse-input-border);border-radius:var(--jse-input-radius);outline:none;background:var(--jse-input-background);color:inherit}table.jse-transform-wizard.svelte-13taczd tr td .jse-horizontal .jse-filter-value.svelte-13taczd:focus{border:var(--jse-input-border-focus)}");}function create_fragment$6(ctx){var table;var tr0;var th0;var t1;var td0;var div0;var select0;var updating_value;var t2;var select1;var updating_value_1;var t3;var input;var t4;var tr1;var th1;var t6;var td1;var div1;var select2;var updating_value_2;var t7;var select3;var updating_value_3;var t8;var tr2;var th2;var t10;var td2;var div2;var select4;var updating_value_4;var current;var mounted;var dispose;function select0_value_binding(value){/*select0_value_binding*/ctx[16](value);}var select0_props={containerClasses:"jse-filter-path",showIndicator:true,items:/*fieldOptions*/ctx[6]};if(/*filterPath*/ctx[0]!==void 0){select0_props.value=/*filterPath*/ctx[0];}select0=new Select({props:select0_props});binding_callbacks.push(function(){return bind$2(select0,'value',select0_value_binding);});function select1_value_binding(value){/*select1_value_binding*/ctx[17](value);}var select1_props={containerClasses:"jse-filter-relation",showIndicator:true,items:/*filterRelationOptions*/ctx[8]};if(/*filterRelation*/ctx[1]!==void 0){select1_props.value=/*filterRelation*/ctx[1];}select1=new Select({props:select1_props});binding_callbacks.push(function(){return bind$2(select1,'value',select1_value_binding);});function select2_value_binding(value){/*select2_value_binding*/ctx[19](value);}var select2_props={containerClasses:"jse-sort-path",showIndicator:true,items:/*fieldOptions*/ctx[6]};if(/*sortPath*/ctx[3]!==void 0){select2_props.value=/*sortPath*/ctx[3];}select2=new Select({props:select2_props});binding_callbacks.push(function(){return bind$2(select2,'value',select2_value_binding);});function select3_value_binding(value){/*select3_value_binding*/ctx[20](value);}var select3_props={containerClasses:"jse-sort-direction",showIndicator:true,items:/*sortDirectionOptions*/ctx[9]};if(/*sortDirection*/ctx[4]!==void 0){select3_props.value=/*sortDirection*/ctx[4];}select3=new Select({props:select3_props});binding_callbacks.push(function(){return bind$2(select3,'value',select3_value_binding);});function select4_value_binding(value){/*select4_value_binding*/ctx[21](value);}var select4_props={containerClasses:"jse-projection-paths",isMulti:true,showIndicator:true,items:/*projectionOptions*/ctx[7]};if(/*projectionPaths*/ctx[5]!==void 0){select4_props.value=/*projectionPaths*/ctx[5];}select4=new Select({props:select4_props});binding_callbacks.push(function(){return bind$2(select4,'value',select4_value_binding);});return{c:function c(){table=element("table");tr0=element("tr");th0=element("th");th0.textContent="Filter";t1=space();td0=element("td");div0=element("div");create_component(select0.$$.fragment);t2=space();create_component(select1.$$.fragment);t3=space();input=element("input");t4=space();tr1=element("tr");th1=element("th");th1.textContent="Sort";t6=space();td1=element("td");div1=element("div");create_component(select2.$$.fragment);t7=space();create_component(select3.$$.fragment);t8=space();tr2=element("tr");th2=element("th");th2.textContent="Pick";t10=space();td2=element("td");div2=element("div");create_component(select4.$$.fragment);attr(th0,"class","svelte-13taczd");attr(input,"class","jse-filter-value svelte-13taczd");attr(div0,"class","jse-horizontal svelte-13taczd");attr(th1,"class","svelte-13taczd");attr(div1,"class","jse-horizontal svelte-13taczd");attr(th2,"class","svelte-13taczd");attr(div2,"class","jse-horizontal svelte-13taczd");attr(table,"class","jse-transform-wizard svelte-13taczd");},m:function m(target,anchor){insert$2(target,table,anchor);append$1(table,tr0);append$1(tr0,th0);append$1(tr0,t1);append$1(tr0,td0);append$1(td0,div0);mount_component(select0,div0,null);append$1(div0,t2);mount_component(select1,div0,null);append$1(div0,t3);append$1(div0,input);set_input_value(input,/*filterValue*/ctx[2]);append$1(table,t4);append$1(table,tr1);append$1(tr1,th1);append$1(tr1,t6);append$1(tr1,td1);append$1(td1,div1);mount_component(select2,div1,null);append$1(div1,t7);mount_component(select3,div1,null);append$1(table,t8);append$1(table,tr2);append$1(tr2,th2);append$1(tr2,t10);append$1(tr2,td2);append$1(td2,div2);mount_component(select4,div2,null);current=true;if(!mounted){dispose=listen(input,"input",/*input_input_handler*/ctx[18]);mounted=true;}},p:function p(ctx,_ref172){var _ref173=_slicedToArray(_ref172,1),dirty=_ref173[0];var select0_changes={};if(dirty&/*fieldOptions*/64)select0_changes.items=/*fieldOptions*/ctx[6];if(!updating_value&&dirty&/*filterPath*/1){updating_value=true;select0_changes.value=/*filterPath*/ctx[0];add_flush_callback(function(){return updating_value=false;});}select0.$set(select0_changes);var select1_changes={};if(!updating_value_1&&dirty&/*filterRelation*/2){updating_value_1=true;select1_changes.value=/*filterRelation*/ctx[1];add_flush_callback(function(){return updating_value_1=false;});}select1.$set(select1_changes);if(dirty&/*filterValue*/4&&input.value!==/*filterValue*/ctx[2]){set_input_value(input,/*filterValue*/ctx[2]);}var select2_changes={};if(dirty&/*fieldOptions*/64)select2_changes.items=/*fieldOptions*/ctx[6];if(!updating_value_2&&dirty&/*sortPath*/8){updating_value_2=true;select2_changes.value=/*sortPath*/ctx[3];add_flush_callback(function(){return updating_value_2=false;});}select2.$set(select2_changes);var select3_changes={};if(!updating_value_3&&dirty&/*sortDirection*/16){updating_value_3=true;select3_changes.value=/*sortDirection*/ctx[4];add_flush_callback(function(){return updating_value_3=false;});}select3.$set(select3_changes);var select4_changes={};if(dirty&/*projectionOptions*/128)select4_changes.items=/*projectionOptions*/ctx[7];if(!updating_value_4&&dirty&/*projectionPaths*/32){updating_value_4=true;select4_changes.value=/*projectionPaths*/ctx[5];add_flush_callback(function(){return updating_value_4=false;});}select4.$set(select4_changes);},i:function i(local){if(current)return;transition_in(select0.$$.fragment,local);transition_in(select1.$$.fragment,local);transition_in(select2.$$.fragment,local);transition_in(select3.$$.fragment,local);transition_in(select4.$$.fragment,local);current=true;},o:function o(local){transition_out(select0.$$.fragment,local);transition_out(select1.$$.fragment,local);transition_out(select2.$$.fragment,local);transition_out(select3.$$.fragment,local);transition_out(select4.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(table);destroy_component(select0);destroy_component(select1);destroy_component(select2);destroy_component(select3);destroy_component(select4);mounted=false;dispose();}};}function instance$7($$self,$$props,$$invalidate){var _queryOptions,_queryOptions$filter,_queryOptions2,_queryOptions2$filter,_queryOptions3,_queryOptions3$filter,_queryOptions4,_queryOptions4$sort,_queryOptions5,_queryOptions5$sort,_queryOptions6,_queryOptions6$projec;var jsonIsArray;var paths;var pathsIncludingObjects;var fieldOptions;var projectionOptions;var debug=createDebug('jsoneditor:TransformWizard');var json=$$props.json;var _$$props$queryOptions=$$props.queryOptions,queryOptions=_$$props$queryOptions===void 0?{}:_$$props$queryOptions;var onChange=$$props.onChange;var filterRelationOptions=['==','!=','<','<=','>','>='].map(function(relation){return{value:relation,label:relation};});var sortDirectionOptions=[{value:'asc',label:'ascending'},{value:'desc',label:'descending'}];// TODO: the binding with the select boxes is very cumbersome. Can we simplify this?
var filterPath=(_queryOptions=queryOptions)!==null&&_queryOptions!==void 0&&(_queryOptions$filter=_queryOptions.filter)!==null&&_queryOptions$filter!==void 0&&_queryOptions$filter.path?pathToOption(queryOptions.filter.path):null;var filterRelation=(_queryOptions2=queryOptions)!==null&&_queryOptions2!==void 0&&(_queryOptions2$filter=_queryOptions2.filter)!==null&&_queryOptions2$filter!==void 0&&_queryOptions2$filter.relation?filterRelationOptions.find(function(option){return option.value===queryOptions.filter.relation;}):null;var filterValue=((_queryOptions3=queryOptions)===null||_queryOptions3===void 0?void 0:(_queryOptions3$filter=_queryOptions3.filter)===null||_queryOptions3$filter===void 0?void 0:_queryOptions3$filter.value)||'';var sortPath=(_queryOptions4=queryOptions)!==null&&_queryOptions4!==void 0&&(_queryOptions4$sort=_queryOptions4.sort)!==null&&_queryOptions4$sort!==void 0&&_queryOptions4$sort.path?pathToOption(queryOptions.sort.path):null;var sortDirection=(_queryOptions5=queryOptions)!==null&&_queryOptions5!==void 0&&(_queryOptions5$sort=_queryOptions5.sort)!==null&&_queryOptions5$sort!==void 0&&_queryOptions5$sort.direction?sortDirectionOptions.find(function(option){return option.value===queryOptions.sort.direction;}):null;var projectionPaths=(_queryOptions6=queryOptions)!==null&&_queryOptions6!==void 0&&(_queryOptions6$projec=_queryOptions6.projection)!==null&&_queryOptions6$projec!==void 0&&_queryOptions6$projec.paths?queryOptions.projection.paths.map(pathToOption):null;function changeFilterPath(path){var _queryOptions7,_queryOptions7$filter;if(!isEqual$1((_queryOptions7=queryOptions)===null||_queryOptions7===void 0?void 0:(_queryOptions7$filter=_queryOptions7.filter)===null||_queryOptions7$filter===void 0?void 0:_queryOptions7$filter.path,path)){debug('changeFilterPath',path);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['filter','path'],path,true));onChange(queryOptions);}}function changeFilterRelation(relation){var _queryOptions8,_queryOptions8$filter;if(!isEqual$1((_queryOptions8=queryOptions)===null||_queryOptions8===void 0?void 0:(_queryOptions8$filter=_queryOptions8.filter)===null||_queryOptions8$filter===void 0?void 0:_queryOptions8$filter.relation,relation)){debug('changeFilterRelation',relation);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['filter','relation'],relation,true));onChange(queryOptions);}}function changeFilterValue(value){var _queryOptions9,_queryOptions9$filter;if(!isEqual$1((_queryOptions9=queryOptions)===null||_queryOptions9===void 0?void 0:(_queryOptions9$filter=_queryOptions9.filter)===null||_queryOptions9$filter===void 0?void 0:_queryOptions9$filter.value,value)){debug('changeFilterValue',value);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['filter','value'],value,true));onChange(queryOptions);}}function changeSortPath(path){var _queryOptions10,_queryOptions10$sort;if(!isEqual$1((_queryOptions10=queryOptions)===null||_queryOptions10===void 0?void 0:(_queryOptions10$sort=_queryOptions10.sort)===null||_queryOptions10$sort===void 0?void 0:_queryOptions10$sort.path,path)){debug('changeSortPath',path);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['sort','path'],path,true));onChange(queryOptions);}}function changeSortDirection(direction){var _queryOptions11,_queryOptions11$sort;if(!isEqual$1((_queryOptions11=queryOptions)===null||_queryOptions11===void 0?void 0:(_queryOptions11$sort=_queryOptions11.sort)===null||_queryOptions11$sort===void 0?void 0:_queryOptions11$sort.direction,direction)){debug('changeSortDirection',direction);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['sort','direction'],direction,true));onChange(queryOptions);}}function changeProjectionPaths(paths){var _queryOptions12,_queryOptions12$proje;if(!isEqual$1((_queryOptions12=queryOptions)===null||_queryOptions12===void 0?void 0:(_queryOptions12$proje=_queryOptions12.projection)===null||_queryOptions12$proje===void 0?void 0:_queryOptions12$proje.paths,paths)){debug('changeProjectionPaths',paths);$$invalidate(10,queryOptions=immutableJSONPatch.exports.setIn(queryOptions,['projection','paths'],paths,true));onChange(queryOptions);}}function select0_value_binding(value){filterPath=value;$$invalidate(0,filterPath);}function select1_value_binding(value){filterRelation=value;$$invalidate(1,filterRelation);}function input_input_handler(){filterValue=this.value;$$invalidate(2,filterValue);}function select2_value_binding(value){sortPath=value;$$invalidate(3,sortPath);}function select3_value_binding(value){sortDirection=value;$$invalidate(4,sortDirection);}function select4_value_binding(value){projectionPaths=value;$$invalidate(5,projectionPaths);}$$self.$$set=function($$props){if('json'in $$props)$$invalidate(11,json=$$props.json);if('queryOptions'in $$props)$$invalidate(10,queryOptions=$$props.queryOptions);if('onChange'in $$props)$$invalidate(12,onChange=$$props.onChange);};$$self.$$.update=function(){if($$self.$$.dirty&/*json*/2048){// options
$$invalidate(15,jsonIsArray=Array.isArray(json));}if($$self.$$.dirty&/*jsonIsArray, json*/34816){$$invalidate(14,paths=jsonIsArray?getNestedPaths(json):[]);}if($$self.$$.dirty&/*jsonIsArray, json*/34816){$$invalidate(13,pathsIncludingObjects=jsonIsArray?getNestedPaths(json,true):[]);}if($$self.$$.dirty&/*paths*/16384){$$invalidate(6,fieldOptions=paths.map(pathToOption));}if($$self.$$.dirty&/*pathsIncludingObjects*/8192){$$invalidate(7,projectionOptions=pathsIncludingObjects?pathsIncludingObjects.map(pathToOption):[]);}if($$self.$$.dirty&/*queryOptions, fieldOptions*/1088){var _queryOptions13,_queryOptions13$filte;(_queryOptions13=queryOptions)!==null&&_queryOptions13!==void 0&&(_queryOptions13$filte=_queryOptions13.filter)!==null&&_queryOptions13$filte!==void 0&&_queryOptions13$filte.path?fieldOptions.find(function(option){var _queryOptions14,_queryOptions14$filte;return isEqual$1(option.value,(_queryOptions14=queryOptions)===null||_queryOptions14===void 0?void 0:(_queryOptions14$filte=_queryOptions14.filter)===null||_queryOptions14$filte===void 0?void 0:_queryOptions14$filte.path);}):null;}if($$self.$$.dirty&/*filterPath*/1){var _filterPath;changeFilterPath(((_filterPath=filterPath)===null||_filterPath===void 0?void 0:_filterPath.value)||null);}if($$self.$$.dirty&/*filterRelation*/2){var _filterRelation;changeFilterRelation(((_filterRelation=filterRelation)===null||_filterRelation===void 0?void 0:_filterRelation.value)||null);}if($$self.$$.dirty&/*filterValue*/4){changeFilterValue(filterValue||null);}if($$self.$$.dirty&/*sortPath*/8){var _sortPath;changeSortPath(((_sortPath=sortPath)===null||_sortPath===void 0?void 0:_sortPath.value)||null);}if($$self.$$.dirty&/*sortDirection*/16){var _sortDirection;changeSortDirection(((_sortDirection=sortDirection)===null||_sortDirection===void 0?void 0:_sortDirection.value)||null);}if($$self.$$.dirty&/*projectionPaths*/32){changeProjectionPaths(projectionPaths?projectionPaths.map(function(item){return item.value;}):null);}};return[filterPath,filterRelation,filterValue,sortPath,sortDirection,projectionPaths,fieldOptions,projectionOptions,filterRelationOptions,sortDirectionOptions,queryOptions,json,onChange,pathsIncludingObjects,paths,jsonIsArray,select0_value_binding,select1_value_binding,input_input_handler,select2_value_binding,select3_value_binding,select4_value_binding];}var TransformWizard=/*#__PURE__*/function(_SvelteComponent52){_inherits(TransformWizard,_SvelteComponent52);var _super93=_createSuper(TransformWizard);function TransformWizard(options){var _this147;_classCallCheck(this,TransformWizard);_this147=_super93.call(this);init(_assertThisInitialized(_this147),options,instance$7,create_fragment$6,not_equal,{json:11,queryOptions:10,onChange:12},add_css$6);return _this147;}return _createClass(TransformWizard);}(SvelteComponent);var TransformWizard$1=TransformWizard;/* src/lib/components/controls/selectQueryLanguage/SelectQueryLanguage.svelte generated by Svelte v3.51.0 */function add_css$5(target){append_styles(target,"svelte-19cxesy",".jse-select-query-language.svelte-19cxesy.svelte-19cxesy{position:relative;width:32px}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container.svelte-19cxesy{position:absolute;top:0;right:0;display:flex;flex-direction:column;box-shadow:var(--jse-controls-box-shadow)}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container .jse-query-language.svelte-19cxesy{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;text-align:left;padding:var(--jse-padding) calc(2 * var(--jse-padding));white-space:nowrap;color:var(--jse-context-menu-color);background:var(--jse-context-menu-background)}.jse-select-query-language.svelte-19cxesy .jse-select-query-language-container .jse-query-language.svelte-19cxesy:hover{background:var(--jse-context-menu-background-highlight)}");}function get_each_context$1(ctx,list,i){var child_ctx=ctx.slice();child_ctx[5]=list[i];return child_ctx;}// (24:8) {:else}
function create_else_block$2(ctx){var icon;var current;icon=new Icon({props:{data:faSquare}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (22:8) {#if queryLanguage.id === queryLanguageId}
function create_if_block$4(ctx){var icon;var current;icon=new Icon({props:{data:faCheckSquare}});return{c:function c(){create_component(icon.$$.fragment);},m:function m(target,anchor){mount_component(icon,target,anchor);current=true;},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(icon,detaching);}};}// (14:4) {#each queryLanguages as queryLanguage}
function create_each_block$1(ctx){var button;var current_block_type_index;var if_block;var t0;var t1_value=/*queryLanguage*/ctx[5].name+"";var t1;var t2;var button_title_value;var current;var mounted;var dispose;var if_block_creators=[create_if_block$4,create_else_block$2];var if_blocks=[];function select_block_type(ctx,dirty){if(/*queryLanguage*/ctx[5].id===/*queryLanguageId*/ctx[0])return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);function click_handler(){return(/*click_handler*/ctx[4](/*queryLanguage*/ctx[5]));}return{c:function c(){button=element("button");if_block.c();t0=space();t1=text(t1_value);t2=space();attr(button,"type","button");attr(button,"class","jse-query-language svelte-19cxesy");attr(button,"title",button_title_value="Select ".concat(/*queryLanguage*/ctx[5].name," as query language"));toggle_class(button,"selected",/*queryLanguage*/ctx[5].id===/*queryLanguageId*/ctx[0]);},m:function m(target,anchor){insert$2(target,button,anchor);if_blocks[current_block_type_index].m(button,null);append$1(button,t0);append$1(button,t1);append$1(button,t2);current=true;if(!mounted){dispose=listen(button,"click",click_handler);mounted=true;}},p:function p(new_ctx,dirty){ctx=new_ctx;var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(button,t0);}if((!current||dirty&/*queryLanguages*/2)&&t1_value!==(t1_value=/*queryLanguage*/ctx[5].name+""))set_data(t1,t1_value);if(!current||dirty&/*queryLanguages*/2&&button_title_value!==(button_title_value="Select ".concat(/*queryLanguage*/ctx[5].name," as query language"))){attr(button,"title",button_title_value);}if(!current||dirty&/*queryLanguages, queryLanguageId*/3){toggle_class(button,"selected",/*queryLanguage*/ctx[5].id===/*queryLanguageId*/ctx[0]);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if(detaching)detach(button);if_blocks[current_block_type_index].d();mounted=false;dispose();}};}function create_fragment$5(ctx){var div1;var div0;var current;var each_value=/*queryLanguages*/ctx[1];var each_blocks=[];for(var _i315=0;_i315<each_value.length;_i315+=1){each_blocks[_i315]=create_each_block$1(get_each_context$1(ctx,each_value,_i315));}var out=function out(i){return transition_out(each_blocks[i],1,1,function(){each_blocks[i]=null;});};return{c:function c(){div1=element("div");div0=element("div");for(var _i316=0;_i316<each_blocks.length;_i316+=1){each_blocks[_i316].c();}attr(div0,"class","jse-select-query-language-container svelte-19cxesy");attr(div1,"class","jse-select-query-language svelte-19cxesy");},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);for(var _i317=0;_i317<each_blocks.length;_i317+=1){each_blocks[_i317].m(div0,null);}current=true;},p:function p(ctx,_ref174){var _ref175=_slicedToArray(_ref174,1),dirty=_ref175[0];if(dirty&/*queryLanguages, queryLanguageId, handleChangeQueryLanguage, faCheckSquare, faSquare*/7){each_value=/*queryLanguages*/ctx[1];var _i318;for(_i318=0;_i318<each_value.length;_i318+=1){var child_ctx=get_each_context$1(ctx,each_value,_i318);if(each_blocks[_i318]){each_blocks[_i318].p(child_ctx,dirty);transition_in(each_blocks[_i318],1);}else{each_blocks[_i318]=create_each_block$1(child_ctx);each_blocks[_i318].c();transition_in(each_blocks[_i318],1);each_blocks[_i318].m(div0,null);}}group_outros();for(_i318=each_value.length;_i318<each_blocks.length;_i318+=1){out(_i318);}check_outros();}},i:function i(local){if(current)return;for(var _i319=0;_i319<each_value.length;_i319+=1){transition_in(each_blocks[_i319]);}current=true;},o:function o(local){each_blocks=each_blocks.filter(Boolean);for(var _i320=0;_i320<each_blocks.length;_i320+=1){transition_out(each_blocks[_i320]);}current=false;},d:function d(detaching){if(detaching)detach(div1);destroy_each(each_blocks,detaching);}};}function instance$6($$self,$$props,$$invalidate){var queryLanguages=$$props.queryLanguages;var queryLanguageId=$$props.queryLanguageId;var onChangeQueryLanguage=$$props.onChangeQueryLanguage;function handleChangeQueryLanguage(newQueryLanguageId){$$invalidate(0,queryLanguageId=newQueryLanguageId);onChangeQueryLanguage(newQueryLanguageId);}var click_handler=function click_handler(queryLanguage){return handleChangeQueryLanguage(queryLanguage.id);};$$self.$$set=function($$props){if('queryLanguages'in $$props)$$invalidate(1,queryLanguages=$$props.queryLanguages);if('queryLanguageId'in $$props)$$invalidate(0,queryLanguageId=$$props.queryLanguageId);if('onChangeQueryLanguage'in $$props)$$invalidate(3,onChangeQueryLanguage=$$props.onChangeQueryLanguage);};return[queryLanguageId,queryLanguages,handleChangeQueryLanguage,onChangeQueryLanguage,click_handler];}var SelectQueryLanguage=/*#__PURE__*/function(_SvelteComponent53){_inherits(SelectQueryLanguage,_SvelteComponent53);var _super94=_createSuper(SelectQueryLanguage);function SelectQueryLanguage(options){var _this148;_classCallCheck(this,SelectQueryLanguage);_this148=_super94.call(this);init(_assertThisInitialized(_this148),options,instance$6,create_fragment$5,safe_not_equal,{queryLanguages:1,queryLanguageId:0,onChangeQueryLanguage:3},add_css$5);return _this148;}return _createClass(SelectQueryLanguage);}(SvelteComponent);var SelectQueryLanguage$1=SelectQueryLanguage;/* src/lib/components/modals/TransformModalHeader.svelte generated by Svelte v3.51.0 */function add_css$4(target){append_styles(target,"svelte-d01h2s",".jse-header.svelte-d01h2s.svelte-d01h2s{display:flex;background:var(--jse-theme-color);color:var(--jse-menu-color)}.jse-header.svelte-d01h2s .jse-title.svelte-d01h2s{flex:1;padding:5px;vertical-align:middle}.jse-header.svelte-d01h2s button.svelte-d01h2s{border:none;background:transparent;min-width:32px;color:inherit;cursor:pointer}.jse-header.svelte-d01h2s button.svelte-d01h2s:hover{background:rgba(255, 255, 255, 0.1)}");}// (35:2) {#if queryLanguages.length > 1}
function create_if_block$3(ctx){var button;var icon;var current;var mounted;var dispose;icon=new Icon({props:{data:faCog}});return{c:function c(){button=element("button");create_component(icon.$$.fragment);attr(button,"type","button");attr(button,"class","jse-config svelte-d01h2s");attr(button,"title","Select a query language");},m:function m(target,anchor){insert$2(target,button,anchor);mount_component(icon,button,null);/*button_binding*/ctx[6](button);current=true;if(!mounted){dispose=listen(button,"click",/*openConfig*/ctx[3]);mounted=true;}},p:noop$2,i:function i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(button);destroy_component(icon);/*button_binding*/ctx[6](null);mounted=false;dispose();}};}function create_fragment$4(ctx){var div1;var div0;var t1;var t2;var button;var icon;var current;var mounted;var dispose;var if_block=/*queryLanguages*/ctx[0].length>1&&create_if_block$3(ctx);icon=new Icon({props:{data:faTimes}});return{c:function c(){div1=element("div");div0=element("div");div0.textContent="Transform";t1=space();if(if_block)if_block.c();t2=space();button=element("button");create_component(icon.$$.fragment);attr(div0,"class","jse-title svelte-d01h2s");attr(button,"type","button");attr(button,"class","jse-close svelte-d01h2s");attr(div1,"class","jse-header svelte-d01h2s");},m:function m(target,anchor){insert$2(target,div1,anchor);append$1(div1,div0);append$1(div1,t1);if(if_block)if_block.m(div1,null);append$1(div1,t2);append$1(div1,button);mount_component(icon,button,null);current=true;if(!mounted){dispose=listen(button,"click",/*close*/ctx[2]);mounted=true;}},p:function p(ctx,_ref176){var _ref177=_slicedToArray(_ref176,1),dirty=_ref177[0];if(/*queryLanguages*/ctx[0].length>1){if(if_block){if_block.p(ctx,dirty);if(dirty&/*queryLanguages*/1){transition_in(if_block,1);}}else{if_block=create_if_block$3(ctx);if_block.c();transition_in(if_block,1);if_block.m(div1,t2);}}else if(if_block){group_outros();transition_out(if_block,1,1,function(){if_block=null;});check_outros();}},i:function i(local){if(current)return;transition_in(if_block);transition_in(icon.$$.fragment,local);current=true;},o:function o(local){transition_out(if_block);transition_out(icon.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div1);if(if_block)if_block.d();destroy_component(icon);mounted=false;dispose();}};}function instance$5($$self,$$props,$$invalidate){var queryLanguages=$$props.queryLanguages;var queryLanguageId=$$props.queryLanguageId;var _onChangeQueryLanguage=$$props.onChangeQueryLanguage;var refConfigButton;var popupId;var _getContext8=getContext('simple-modal'),close=_getContext8.close;var _getContext9=getContext('absolute-popup'),openAbsolutePopup=_getContext9.openAbsolutePopup,closeAbsolutePopup=_getContext9.closeAbsolutePopup;function openConfig(){var props={queryLanguages:queryLanguages,queryLanguageId:queryLanguageId,onChangeQueryLanguage:function onChangeQueryLanguage(selectedQueryLanguage){closeAbsolutePopup(popupId);_onChangeQueryLanguage(selectedQueryLanguage);}};popupId=openAbsolutePopup(SelectQueryLanguage$1,props,{position:'bottom',offsetTop:-2,offsetLeft:0,anchor:refConfigButton,closeOnOuterClick:true});}function button_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refConfigButton=$$value;$$invalidate(1,refConfigButton);});}$$self.$$set=function($$props){if('queryLanguages'in $$props)$$invalidate(0,queryLanguages=$$props.queryLanguages);if('queryLanguageId'in $$props)$$invalidate(4,queryLanguageId=$$props.queryLanguageId);if('onChangeQueryLanguage'in $$props)$$invalidate(5,_onChangeQueryLanguage=$$props.onChangeQueryLanguage);};return[queryLanguages,refConfigButton,close,openConfig,queryLanguageId,_onChangeQueryLanguage,button_binding];}var TransformModalHeader=/*#__PURE__*/function(_SvelteComponent54){_inherits(TransformModalHeader,_SvelteComponent54);var _super95=_createSuper(TransformModalHeader);function TransformModalHeader(options){var _this149;_classCallCheck(this,TransformModalHeader);_this149=_super95.call(this);init(_assertThisInitialized(_this149),options,instance$5,create_fragment$4,not_equal,{queryLanguages:0,queryLanguageId:4,onChangeQueryLanguage:5},add_css$4);return _this149;}return _createClass(TransformModalHeader);}(SvelteComponent);var TransformModalHeader$1=TransformModalHeader;/* src/lib/components/modals/TransformModal.svelte generated by Svelte v3.51.0 */function add_css$3(target){append_styles(target,"svelte-15uz9w0",".jse-modal.svelte-15uz9w0.svelte-15uz9w0{--height:36px;--multiItemHeight:28px;--multiItemMargin:2px;--multiItemPadding:2px 8px;--multiClearTop:5px;--multiItemBorderRadius:6px;--clearSelectTop:2px;--clearSelectBottom:2px;--indicatorTop:8px;flex:1;display:flex;flex-direction:column;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-15uz9w0 .jse-contents.svelte-15uz9w0{padding:20px;overflow:auto}.jse-modal.svelte-15uz9w0 .jse-contents .jse-actions.svelte-15uz9w0{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-15uz9w0 .jse-contents .jse-actions button.svelte-15uz9w0{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-15uz9w0 .jse-contents .jse-actions button.svelte-15uz9w0:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-15uz9w0 .jse-contents .jse-actions button.svelte-15uz9w0:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents.svelte-15uz9w0{flex:1;display:flex;flex-direction:column;color:inherit;min-height:0;padding:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents.svelte-15uz9w0{flex:1;display:flex;gap:calc(2 * var(--jse-padding));min-height:0;box-sizing:border-box;padding:0 calc(2 * var(--jse-padding)) var(--jse-padding)}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents.svelte-15uz9w0{flex:1;display:flex;flex-direction:column}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents .jse-description.svelte-15uz9w0 p{margin:var(--jse-padding) 0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents .jse-description.svelte-15uz9w0 p:first-child{margin-top:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents .jse-description.svelte-15uz9w0 p:last-child{margin-bottom:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents .jse-description.svelte-15uz9w0 code{background:var(--jse-modal-code-background);font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono)}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents textarea.jse-query.svelte-15uz9w0{flex:1;outline:none;resize:vertical}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents.svelte-15uz9w0{flex:1;display:flex;flex-direction:column;gap:calc(2 * var(--jse-padding))}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents .jse-original-data.svelte-15uz9w0{flex:1;display:flex;flex-direction:column;min-height:0;box-sizing:border-box}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents .jse-original-data.jse-hide.svelte-15uz9w0{flex:none}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents .jse-preview-data.svelte-15uz9w0{flex:1;display:flex;flex-direction:column;min-height:0;box-sizing:border-box}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents.jse-hide-original-data.svelte-15uz9w0{flex-direction:column;gap:0;margin-bottom:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-actions.svelte-15uz9w0{padding:var(--jse-padding) calc(2 * var(--jse-padding)) calc(2 * var(--jse-padding))}@media screen and (max-width: 1200px){.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents.svelte-15uz9w0{flex-direction:column;overflow:auto}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-query-contents textarea.jse-query.svelte-15uz9w0{min-height:150px;flex:none}.jse-modal.jse-transform.svelte-15uz9w0 .jse-contents .jse-main-contents .jse-data-contents.svelte-15uz9w0 .jse-tree-mode{height:300px;flex:none}}.jse-modal.jse-transform.svelte-15uz9w0 .jse-label.svelte-15uz9w0{font-weight:bold;display:block;box-sizing:border-box}.jse-modal.jse-transform.svelte-15uz9w0 .jse-label .jse-label-inner.svelte-15uz9w0{margin-top:calc(2 * var(--jse-padding));margin-bottom:calc(0.5 * var(--jse-padding));box-sizing:border-box}.jse-modal.jse-transform.svelte-15uz9w0 .jse-label .jse-label-inner button.svelte-15uz9w0{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;font-weight:bold;padding:0}.jse-modal.jse-transform.svelte-15uz9w0 .jse-tree-mode{flex:1;background:var(--jse-input-background-readonly);box-shadow:none;box-sizing:border-box;--jse-main-border:var(--jse-input-border)}.jse-modal.jse-transform.svelte-15uz9w0 input.svelte-15uz9w0,.jse-modal.jse-transform.svelte-15uz9w0 textarea.svelte-15uz9w0{border:var(--jse-input-border);outline:none;box-sizing:border-box;padding:calc(0.5 * var(--jse-padding));font-family:var(--jse-font-family-mono);font-size:var(--jse-font-size-mono);color:inherit;background:var(--jse-input-background)}.jse-modal.jse-transform.svelte-15uz9w0 input.svelte-15uz9w0:focus,.jse-modal.jse-transform.svelte-15uz9w0 textarea.svelte-15uz9w0:focus{border:var(--jse-input-border-focus)}.jse-modal.jse-transform.svelte-15uz9w0 input.svelte-15uz9w0:read-only,.jse-modal.jse-transform.svelte-15uz9w0 textarea.svelte-15uz9w0:read-only{background:var(--jse-input-background-readonly)}.jse-modal.jse-transform.svelte-15uz9w0 .jse-preview.jse-error.svelte-15uz9w0{flex:1;background:var(--jse-input-background-readonly);border:var(--jse-input-border);color:var(--jse-error-color);padding:calc(0.5 * var(--jse-padding))}.jse-modal.jse-transform.svelte-15uz9w0 a{color:var(--jse-a-color)}.jse-modal.jse-transform.svelte-15uz9w0 a:hover{color:var(--jse-a-color-highlight)}");}// (168:10) {#if showWizard}
function create_if_block_2(ctx){var show_if;var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block_3,create_else_block_1];var if_blocks=[];function select_block_type(ctx,dirty){if(dirty[0]&/*selectedJson*/1024)show_if=null;if(show_if==null)show_if=!!Array.isArray(/*selectedJson*/ctx[10]);if(show_if)return 0;return 1;}current_block_type_index=select_block_type(ctx,[-1,-1]);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx,dirty);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (171:12) {:else}
function create_else_block_1(ctx){var t;return{c:function c(){t=text("(Only available for arrays, not for objects)");},m:function m(target,anchor){insert$2(target,t,anchor);},p:noop$2,i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(t);}};}// (169:12) {#if Array.isArray(selectedJson)}
function create_if_block_3(ctx){var transformwizard;var current;transformwizard=new TransformWizard$1({props:{queryOptions:/*queryOptions*/ctx[8],json:/*selectedJson*/ctx[10],onChange:/*updateQueryByWizard*/ctx[17]}});return{c:function c(){create_component(transformwizard.$$.fragment);},m:function m(target,anchor){mount_component(transformwizard,target,anchor);current=true;},p:function p(ctx,dirty){var transformwizard_changes={};if(dirty[0]&/*queryOptions*/256)transformwizard_changes.queryOptions=/*queryOptions*/ctx[8];if(dirty[0]&/*selectedJson*/1024)transformwizard_changes.json=/*selectedJson*/ctx[10];transformwizard.$set(transformwizard_changes);},i:function i(local){if(current)return;transition_in(transformwizard.$$.fragment,local);current=true;},o:function o(local){transition_out(transformwizard.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(transformwizard,detaching);}};}// (196:12) {#if showOriginal}
function create_if_block_1$1(ctx){var treemode;var current;treemode=new TreeMode$1({props:{externalContent:/*selectedContent*/ctx[15],readOnly:true,mainMenuBar:false,navigationBar:false,escapeControlCharacters:/*escapeControlCharacters*/ctx[2],escapeUnicodeCharacters:/*escapeUnicodeCharacters*/ctx[3],parser:/*parser*/ctx[4],onRenderValue:/*onRenderValue*/ctx[6],onError:console.error,onChange:noop,onFocus:noop,onBlur:noop,onSortModal:noop,onTransformModal:noop,onClassName:/*onClassName*/ctx[7]}});return{c:function c(){create_component(treemode.$$.fragment);},m:function m(target,anchor){mount_component(treemode,target,anchor);current=true;},p:function p(ctx,dirty){var treemode_changes={};if(dirty[0]&/*selectedContent*/32768)treemode_changes.externalContent=/*selectedContent*/ctx[15];if(dirty[0]&/*escapeControlCharacters*/4)treemode_changes.escapeControlCharacters=/*escapeControlCharacters*/ctx[2];if(dirty[0]&/*escapeUnicodeCharacters*/8)treemode_changes.escapeUnicodeCharacters=/*escapeUnicodeCharacters*/ctx[3];if(dirty[0]&/*parser*/16)treemode_changes.parser=/*parser*/ctx[4];if(dirty[0]&/*onRenderValue*/64)treemode_changes.onRenderValue=/*onRenderValue*/ctx[6];if(dirty[0]&/*onClassName*/128)treemode_changes.onClassName=/*onClassName*/ctx[7];treemode.$set(treemode_changes);},i:function i(local){if(current)return;transition_in(treemode.$$.fragment,local);current=true;},o:function o(local){transition_out(treemode.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(treemode,detaching);}};}// (238:12) {:else}
function create_else_block$1(ctx){var div;var t_value=/*previewError*/ctx[13].toString()+"";var t;return{c:function c(){div=element("div");t=text(t_value);attr(div,"class","jse-preview jse-error svelte-15uz9w0");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t);},p:function p(ctx,dirty){if(dirty[0]&/*previewError*/8192&&t_value!==(t_value=/*previewError*/ctx[13].toString()+""))set_data(t,t_value);},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(div);}};}// (220:12) {#if !previewError}
function create_if_block$2(ctx){var treemode;var current;treemode=new TreeMode$1({props:{externalContent:/*previewContent*/ctx[14],readOnly:true,mainMenuBar:false,navigationBar:false,escapeControlCharacters:/*escapeControlCharacters*/ctx[2],escapeUnicodeCharacters:/*escapeUnicodeCharacters*/ctx[3],parser:/*parser*/ctx[4],onRenderValue:/*onRenderValue*/ctx[6],onError:console.error,onChange:noop,onFocus:noop,onBlur:noop,onSortModal:noop,onTransformModal:noop,onClassName:/*onClassName*/ctx[7]}});return{c:function c(){create_component(treemode.$$.fragment);},m:function m(target,anchor){mount_component(treemode,target,anchor);current=true;},p:function p(ctx,dirty){var treemode_changes={};if(dirty[0]&/*previewContent*/16384)treemode_changes.externalContent=/*previewContent*/ctx[14];if(dirty[0]&/*escapeControlCharacters*/4)treemode_changes.escapeControlCharacters=/*escapeControlCharacters*/ctx[2];if(dirty[0]&/*escapeUnicodeCharacters*/8)treemode_changes.escapeUnicodeCharacters=/*escapeUnicodeCharacters*/ctx[3];if(dirty[0]&/*parser*/16)treemode_changes.parser=/*parser*/ctx[4];if(dirty[0]&/*onRenderValue*/64)treemode_changes.onRenderValue=/*onRenderValue*/ctx[6];if(dirty[0]&/*onClassName*/128)treemode_changes.onClassName=/*onClassName*/ctx[7];treemode.$set(treemode_changes);},i:function i(local){if(current)return;transition_in(treemode.$$.fragment,local);current=true;},o:function o(local){transition_out(treemode.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(treemode,detaching);}};}// (133:2) <AbsolutePopup>
function create_default_slot$1(ctx){var transformmodalheader;var t0;var div19;var div17;var div9;var div1;var t2;var div2;var raw_value=/*getSelectedQueryLanguage*/ctx[16](/*queryLanguageId*/ctx[0]).description+"";var t3;var div4;var t5;var input;var input_value_value;var t6;var div6;var div5;var button0;var icon0;var t7;var t8;var t9;var div8;var t11;var textarea;var t12;var div16;var div12;var div11;var div10;var button1;var icon1;var t13;var t14;var t15;var div15;var div14;var t17;var current_block_type_index;var if_block2;var t18;var div18;var button2;var t19;var button2_disabled_value;var current;var mounted;var dispose;transformmodalheader=new TransformModalHeader$1({props:{queryLanguages:/*queryLanguages*/ctx[5],queryLanguageId:/*queryLanguageId*/ctx[0],onChangeQueryLanguage:/*handleChangeQueryLanguage*/ctx[22]}});icon0=new Icon({props:{data:/*showWizard*/ctx[11]?faCaretDown:faCaretRight}});var if_block0=/*showWizard*/ctx[11]&&create_if_block_2(ctx);icon1=new Icon({props:{data:/*showOriginal*/ctx[12]?faCaretDown:faCaretRight}});var if_block1=/*showOriginal*/ctx[12]&&create_if_block_1$1(ctx);var if_block_creators=[create_if_block$2,create_else_block$1];var if_blocks=[];function select_block_type_1(ctx,dirty){if(!/*previewError*/ctx[13])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){create_component(transformmodalheader.$$.fragment);t0=space();div19=element("div");div17=element("div");div9=element("div");div1=element("div");div1.innerHTML="<div class=\"jse-label-inner svelte-15uz9w0\">Language</div>";t2=space();div2=element("div");t3=space();div4=element("div");div4.innerHTML="<div class=\"jse-label-inner svelte-15uz9w0\">Path</div>";t5=space();input=element("input");t6=space();div6=element("div");div5=element("div");button0=element("button");create_component(icon0.$$.fragment);t7=text("\n                Wizard");t8=space();if(if_block0)if_block0.c();t9=space();div8=element("div");div8.innerHTML="<div class=\"jse-label-inner svelte-15uz9w0\">Query</div>";t11=space();textarea=element("textarea");t12=space();div16=element("div");div12=element("div");div11=element("div");div10=element("div");button1=element("button");create_component(icon1.$$.fragment);t13=text("\n                  Original");t14=space();if(if_block1)if_block1.c();t15=space();div15=element("div");div14=element("div");div14.innerHTML="<div class=\"jse-label-inner svelte-15uz9w0\">Preview</div>";t17=space();if_block2.c();t18=space();div18=element("div");button2=element("button");t19=text("Transform");attr(div1,"class","jse-label svelte-15uz9w0");attr(div2,"class","jse-description svelte-15uz9w0");attr(div4,"class","jse-label svelte-15uz9w0");attr(input,"class","jse-path svelte-15uz9w0");attr(input,"type","text");input.readOnly=true;attr(input,"title","Selected path");input.value=input_value_value=!isEmpty(/*selectedPath*/ctx[1])?stringifyJSONPath(/*selectedPath*/ctx[1]):'(whole document)';attr(button0,"type","button");attr(button0,"class","svelte-15uz9w0");attr(div5,"class","jse-label-inner svelte-15uz9w0");attr(div6,"class","jse-label svelte-15uz9w0");attr(div8,"class","jse-label svelte-15uz9w0");attr(textarea,"class","jse-query svelte-15uz9w0");attr(textarea,"spellcheck","false");textarea.value=/*query*/ctx[9];attr(div9,"class","jse-query-contents svelte-15uz9w0");attr(button1,"type","button");attr(button1,"class","svelte-15uz9w0");attr(div10,"class","jse-label-inner svelte-15uz9w0");attr(div11,"class","jse-label svelte-15uz9w0");attr(div12,"class","jse-original-data svelte-15uz9w0");toggle_class(div12,"jse-hide",!/*showOriginal*/ctx[12]);attr(div14,"class","jse-label svelte-15uz9w0");attr(div15,"class","jse-preview-data svelte-15uz9w0");attr(div16,"class","jse-data-contents svelte-15uz9w0");toggle_class(div16,"jse-hide-original-data",!/*showOriginal*/ctx[12]);attr(div17,"class","jse-main-contents svelte-15uz9w0");attr(button2,"type","button");attr(button2,"class","jse-primary svelte-15uz9w0");button2.disabled=button2_disabled_value=!!/*previewError*/ctx[13];attr(div18,"class","jse-actions svelte-15uz9w0");attr(div19,"class","jse-contents svelte-15uz9w0");},m:function m(target,anchor){mount_component(transformmodalheader,target,anchor);insert$2(target,t0,anchor);insert$2(target,div19,anchor);append$1(div19,div17);append$1(div17,div9);append$1(div9,div1);append$1(div9,t2);append$1(div9,div2);div2.innerHTML=raw_value;append$1(div9,t3);append$1(div9,div4);append$1(div9,t5);append$1(div9,input);append$1(div9,t6);append$1(div9,div6);append$1(div6,div5);append$1(div5,button0);mount_component(icon0,button0,null);append$1(button0,t7);append$1(div9,t8);if(if_block0)if_block0.m(div9,null);append$1(div9,t9);append$1(div9,div8);append$1(div9,t11);append$1(div9,textarea);append$1(div17,t12);append$1(div17,div16);append$1(div16,div12);append$1(div12,div11);append$1(div11,div10);append$1(div10,button1);mount_component(icon1,button1,null);append$1(button1,t13);append$1(div12,t14);if(if_block1)if_block1.m(div12,null);append$1(div16,t15);append$1(div16,div15);append$1(div15,div14);append$1(div15,t17);if_blocks[current_block_type_index].m(div15,null);append$1(div19,t18);append$1(div19,div18);append$1(div18,button2);append$1(button2,t19);current=true;if(!mounted){dispose=[listen(button0,"click",/*toggleShowWizard*/ctx[20]),listen(textarea,"input",/*handleChangeQuery*/ctx[18]),listen(button1,"click",/*toggleShowOriginal*/ctx[21]),listen(button2,"click",/*handleTransform*/ctx[19]),action_destroyer(focus$1.call(null,button2))];mounted=true;}},p:function p(ctx,dirty){var transformmodalheader_changes={};if(dirty[0]&/*queryLanguages*/32)transformmodalheader_changes.queryLanguages=/*queryLanguages*/ctx[5];if(dirty[0]&/*queryLanguageId*/1)transformmodalheader_changes.queryLanguageId=/*queryLanguageId*/ctx[0];transformmodalheader.$set(transformmodalheader_changes);if((!current||dirty[0]&/*queryLanguageId*/1)&&raw_value!==(raw_value=/*getSelectedQueryLanguage*/ctx[16](/*queryLanguageId*/ctx[0]).description+""))div2.innerHTML=raw_value;if(!current||dirty[0]&/*selectedPath*/2&&input_value_value!==(input_value_value=!isEmpty(/*selectedPath*/ctx[1])?stringifyJSONPath(/*selectedPath*/ctx[1]):'(whole document)')&&input.value!==input_value_value){input.value=input_value_value;}var icon0_changes={};if(dirty[0]&/*showWizard*/2048)icon0_changes.data=/*showWizard*/ctx[11]?faCaretDown:faCaretRight;icon0.$set(icon0_changes);if(/*showWizard*/ctx[11]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*showWizard*/2048){transition_in(if_block0,1);}}else{if_block0=create_if_block_2(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div9,t9);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}if(!current||dirty[0]&/*query*/512){textarea.value=/*query*/ctx[9];}var icon1_changes={};if(dirty[0]&/*showOriginal*/4096)icon1_changes.data=/*showOriginal*/ctx[12]?faCaretDown:faCaretRight;icon1.$set(icon1_changes);if(/*showOriginal*/ctx[12]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*showOriginal*/4096){transition_in(if_block1,1);}}else{if_block1=create_if_block_1$1(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div12,null);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,function(){if_block1=null;});check_outros();}if(!current||dirty[0]&/*showOriginal*/4096){toggle_class(div12,"jse-hide",!/*showOriginal*/ctx[12]);}var previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block2=if_blocks[current_block_type_index];if(!if_block2){if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block2.c();}else{if_block2.p(ctx,dirty);}transition_in(if_block2,1);if_block2.m(div15,null);}if(!current||dirty[0]&/*showOriginal*/4096){toggle_class(div16,"jse-hide-original-data",!/*showOriginal*/ctx[12]);}if(!current||dirty[0]&/*previewError*/8192&&button2_disabled_value!==(button2_disabled_value=!!/*previewError*/ctx[13])){button2.disabled=button2_disabled_value;}},i:function i(local){if(current)return;transition_in(transformmodalheader.$$.fragment,local);transition_in(icon0.$$.fragment,local);transition_in(if_block0);transition_in(icon1.$$.fragment,local);transition_in(if_block1);transition_in(if_block2);current=true;},o:function o(local){transition_out(transformmodalheader.$$.fragment,local);transition_out(icon0.$$.fragment,local);transition_out(if_block0);transition_out(icon1.$$.fragment,local);transition_out(if_block1);transition_out(if_block2);current=false;},d:function d(detaching){destroy_component(transformmodalheader,detaching);if(detaching)detach(t0);if(detaching)detach(div19);destroy_component(icon0);if(if_block0)if_block0.d();destroy_component(icon1);if(if_block1)if_block1.d();if_blocks[current_block_type_index].d();mounted=false;run_all(dispose);}};}function create_fragment$3(ctx){var div;var absolutepopup;var current;absolutepopup=new AbsolutePopup$1({props:{$$slots:{"default":[create_default_slot$1]},$$scope:{ctx:ctx}}});return{c:function c(){div=element("div");create_component(absolutepopup.$$.fragment);attr(div,"class","jse-modal jse-transform svelte-15uz9w0");},m:function m(target,anchor){insert$2(target,div,anchor);mount_component(absolutepopup,div,null);current=true;},p:function p(ctx,dirty){var absolutepopup_changes={};if(dirty[0]&/*previewError, showOriginal, previewContent, escapeControlCharacters, escapeUnicodeCharacters, parser, onRenderValue, onClassName, selectedContent, query, queryOptions, selectedJson, showWizard, selectedPath, queryLanguageId, queryLanguages*/65535|dirty[1]&/*$$scope*/16){absolutepopup_changes.$$scope={dirty:dirty,ctx:ctx};}absolutepopup.$set(absolutepopup_changes);},i:function i(local){if(current)return;transition_in(absolutepopup.$$.fragment,local);current=true;},o:function o(local){transition_out(absolutepopup.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div);destroy_component(absolutepopup);}};}function focus$1(element){element.focus();}function instance$4($$self,$$props,$$invalidate){var selectedJson;var selectedContent;var debug=createDebug('jsoneditor:TransformModal');var _$$props$id2=$$props.id,id=_$$props$id2===void 0?'transform-modal-'+uniqueId$1():_$$props$id2;var json=$$props.json;var _$$props$selectedPath=$$props.selectedPath,selectedPath=_$$props$selectedPath===void 0?[]:_$$props$selectedPath;var escapeControlCharacters=$$props.escapeControlCharacters;var escapeUnicodeCharacters=$$props.escapeUnicodeCharacters;var parser=$$props.parser;var queryLanguages=$$props.queryLanguages;var queryLanguageId=$$props.queryLanguageId;var onChangeQueryLanguage=$$props.onChangeQueryLanguage;var onRenderValue=$$props.onRenderValue;var onClassName=$$props.onClassName;var onTransform=$$props.onTransform;var _getContext10=getContext('simple-modal'),close=_getContext10.close;var stateId="".concat(id,":").concat(immutableJSONPatch.exports.compileJSONPointer(selectedPath));var state=transformModalState[stateId]||{};// showWizard is not stored inside a stateId
var showWizard=transformModalState.showWizard!==false;var showOriginal=transformModalState.showOriginal!==false;var queryOptions=state.queryOptions||{};var query=queryLanguageId===state.queryLanguageId&&state.query?state.query:getSelectedQueryLanguage(queryLanguageId).createQuery(json,state.queryOptions||{});var isManual=state.isManual||false;var previewError=undefined;var previewContent={text:''};function getSelectedQueryLanguage(queryLanguageId){return queryLanguages.find(function(item){return item.id===queryLanguageId;})||queryLanguages[0];}function updateQueryByWizard(newQueryOptions){$$invalidate(8,queryOptions=newQueryOptions);$$invalidate(9,query=getSelectedQueryLanguage(queryLanguageId).createQuery(json,newQueryOptions));$$invalidate(28,isManual=false);debug('updateQueryByWizard',{queryOptions:queryOptions,query:query,isManual:isManual});}function handleChangeQuery(event){$$invalidate(9,query=event.target.value);$$invalidate(28,isManual=true);debug('handleChangeQuery',{query:query,isManual:isManual});}function previewTransform(json,query){try{debug('previewTransform',{query:query});var jsonTransformed=getSelectedQueryLanguage(queryLanguageId).executeQuery(json,query);$$invalidate(14,previewContent={json:jsonTransformed});$$invalidate(13,previewError=undefined);}catch(err){$$invalidate(14,previewContent={text:''});$$invalidate(13,previewError=err);}}var previewTransformDebounced=debounce$1(previewTransform,DEBOUNCE_DELAY);function handleTransform(){try{debug('handleTransform',{query:query});var jsonTransformed=getSelectedQueryLanguage(queryLanguageId).executeQuery(selectedJson,query);onTransform([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(selectedPath),value:jsonTransformed}]);close();}catch(err){// this should never occur since we can only press the Transform
// button when creating a preview was successful
console.error(err);$$invalidate(14,previewContent={text:''});$$invalidate(13,previewError=err.toString());}}function toggleShowWizard(){$$invalidate(11,showWizard=!showWizard);// not stored inside a stateId
$$invalidate(27,transformModalState.showWizard=showWizard,transformModalState);}function toggleShowOriginal(){$$invalidate(12,showOriginal=!showOriginal);// not stored inside a stateId
$$invalidate(27,transformModalState.showOriginal=showOriginal,transformModalState);}function handleChangeQueryLanguage(newQueryLanguageId){debug('handleChangeQueryLanguage',newQueryLanguageId);$$invalidate(0,queryLanguageId=newQueryLanguageId);onChangeQueryLanguage(newQueryLanguageId);var newSelectedQueryLanguage=getSelectedQueryLanguage(queryLanguageId);$$invalidate(9,query=newSelectedQueryLanguage.createQuery(json,queryOptions));$$invalidate(28,isManual=false);}$$self.$$set=function($$props){if('id'in $$props)$$invalidate(23,id=$$props.id);if('json'in $$props)$$invalidate(24,json=$$props.json);if('selectedPath'in $$props)$$invalidate(1,selectedPath=$$props.selectedPath);if('escapeControlCharacters'in $$props)$$invalidate(2,escapeControlCharacters=$$props.escapeControlCharacters);if('escapeUnicodeCharacters'in $$props)$$invalidate(3,escapeUnicodeCharacters=$$props.escapeUnicodeCharacters);if('parser'in $$props)$$invalidate(4,parser=$$props.parser);if('queryLanguages'in $$props)$$invalidate(5,queryLanguages=$$props.queryLanguages);if('queryLanguageId'in $$props)$$invalidate(0,queryLanguageId=$$props.queryLanguageId);if('onChangeQueryLanguage'in $$props)$$invalidate(25,onChangeQueryLanguage=$$props.onChangeQueryLanguage);if('onRenderValue'in $$props)$$invalidate(6,onRenderValue=$$props.onRenderValue);if('onClassName'in $$props)$$invalidate(7,onClassName=$$props.onClassName);if('onTransform'in $$props)$$invalidate(26,onTransform=$$props.onTransform);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*json, selectedPath*/16777218){$$invalidate(10,selectedJson=immutableJSONPatch.exports.getIn(json,selectedPath));}if($$self.$$.dirty[0]&/*selectedJson*/1024){$$invalidate(15,selectedContent={json:selectedJson});}if($$self.$$.dirty[0]&/*selectedJson, query*/1536){{previewTransformDebounced(selectedJson,query);}}if($$self.$$.dirty[0]&/*queryOptions, query, queryLanguageId, isManual, transformModalState*/402653953){{// remember the selected values for the next time we open the SortModal
// just in memory, not persisted
$$invalidate(27,transformModalState[stateId]={queryOptions:queryOptions,query:query,queryLanguageId:queryLanguageId,isManual:isManual},transformModalState);debug('store state in memory',stateId,transformModalState[stateId]);}}};return[queryLanguageId,selectedPath,escapeControlCharacters,escapeUnicodeCharacters,parser,queryLanguages,onRenderValue,onClassName,queryOptions,query,selectedJson,showWizard,showOriginal,previewError,previewContent,selectedContent,getSelectedQueryLanguage,updateQueryByWizard,handleChangeQuery,handleTransform,toggleShowWizard,toggleShowOriginal,handleChangeQueryLanguage,id,json,onChangeQueryLanguage,onTransform,transformModalState,isManual];}var TransformModal=/*#__PURE__*/function(_SvelteComponent55){_inherits(TransformModal,_SvelteComponent55);var _super96=_createSuper(TransformModal);function TransformModal(options){var _this150;_classCallCheck(this,TransformModal);_this150=_super96.call(this);init(_assertThisInitialized(_this150),options,instance$4,create_fragment$3,not_equal,{id:23,json:24,selectedPath:1,escapeControlCharacters:2,escapeUnicodeCharacters:3,parser:4,queryLanguages:5,queryLanguageId:0,onChangeQueryLanguage:25,onRenderValue:6,onClassName:7,onTransform:26},add_css$3,[-1,-1]);return _this150;}return _createClass(TransformModal);}(SvelteComponent);var TransformModal$1=TransformModal;exports.TransformModal=TransformModal$1;var sortModalState={};/* src/lib/components/modals/SortModal.svelte generated by Svelte v3.51.0 */function add_css$2(target){append_styles(target,"svelte-120r9gh",".jse-modal.svelte-120r9gh.svelte-120r9gh{--height:36px;--multiItemHeight:28px;--multiItemMargin:2px;--multiItemPadding:2px 8px;--multiClearTop:5px;--multiItemBorderRadius:6px;--clearSelectTop:2px;--clearSelectBottom:2px;--indicatorTop:8px;flex:1;display:flex;flex-direction:column;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;background:var(--jse-modal-background);color:var(--jse-text-color)}.jse-modal.svelte-120r9gh .jse-contents.svelte-120r9gh{padding:20px;overflow:auto}.jse-modal.svelte-120r9gh .jse-contents .jse-actions.svelte-120r9gh{display:flex;flex-direction:row;justify-content:flex-end;padding-top:var(--jse-padding)}.jse-modal.svelte-120r9gh .jse-contents .jse-actions button.svelte-120r9gh{border:none;background:transparent;color:inherit;cursor:pointer;font-family:var(--jse-font-family);font-size:var(--jse-font-size);padding:5px;margin:0;background:var(--jse-button-primary-background);color:var(--jse-button-primary-color);padding:var(--jse-padding) calc(2 * var(--jse-padding));border-radius:3px}.jse-modal.svelte-120r9gh .jse-contents .jse-actions button.svelte-120r9gh:hover{background:var(--jse-button-primary-background-highlight)}.jse-modal.svelte-120r9gh .jse-contents .jse-actions button.svelte-120r9gh:disabled{background:var(--jse-button-primary-background-disabled)}.bg.jse-modal-bg{width:100%;height:100%;top:0;left:0;background:var(--jse-modal-overlay-background)}.bg.jse-modal-bg .jse-modal-window-wrap{margin:0}.bg.jse-modal-bg .jse-modal-window{max-width:90%;margin:4rem auto 2rem auto;border-radius:2px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-sort{width:400px}.bg.jse-modal-bg .jse-modal-window.jse-modal-window-transform{width:1200px;height:1200px;max-height:80%;display:flex}.bg.jse-modal-bg .jse-modal-content{flex:1;display:flex;max-height:calc(100vh - 6rem);padding:0}.jse-modal.jse-sort.svelte-120r9gh table.svelte-120r9gh{width:100%;border-collapse:collapse;border-spacing:0}.jse-modal.jse-sort.svelte-120r9gh table th.svelte-120r9gh,.jse-modal.jse-sort.svelte-120r9gh table td.svelte-120r9gh{text-align:left;vertical-align:middle;font-weight:normal;padding-bottom:var(--jse-padding)}.jse-modal.jse-sort.svelte-120r9gh table th input.jse-path.svelte-120r9gh,.jse-modal.jse-sort.svelte-120r9gh table td input.jse-path.svelte-120r9gh{width:100%;box-sizing:border-box;padding:6px 16px;border:var(--jse-input-border);border-radius:var(--jse-input-radius);font-family:inherit;font-size:inherit;background:inherit;color:inherit;outline:none}.jse-modal.jse-sort.svelte-120r9gh table th input.jse-path.svelte-120r9gh:read-only,.jse-modal.jse-sort.svelte-120r9gh table td input.jse-path.svelte-120r9gh:read-only{background:var(--jse-input-background-readonly)}.jse-modal.jse-sort.svelte-120r9gh table th.svelte-120r9gh .selectContainer input,.jse-modal.jse-sort.svelte-120r9gh table td.svelte-120r9gh .selectContainer input{box-sizing:border-box}.jse-modal.jse-sort.svelte-120r9gh .jse-space.svelte-120r9gh{height:200px}.jse-modal.jse-sort.svelte-120r9gh .jse-space .jse-error.svelte-120r9gh{color:var(--jse-error-color)}");}// (105:8) {#if jsonIsArray && (properties.length > 1 || selectedProperty === undefined)}
function create_if_block_1(ctx){var tr;var th;var t1;var td;var select;var updating_value;var current;function select_value_binding(value){/*select_value_binding*/ctx[13](value);}var select_props={showIndicator:true,items:/*properties*/ctx[4]};if(/*selectedProperty*/ctx[1]!==void 0){select_props.value=/*selectedProperty*/ctx[1];}select=new Select({props:select_props});binding_callbacks.push(function(){return bind$2(select,'value',select_value_binding);});return{c:function c(){tr=element("tr");th=element("th");th.textContent="Property";t1=space();td=element("td");create_component(select.$$.fragment);attr(th,"class","svelte-120r9gh");attr(td,"class","svelte-120r9gh");},m:function m(target,anchor){insert$2(target,tr,anchor);append$1(tr,th);append$1(tr,t1);append$1(tr,td);mount_component(select,td,null);current=true;},p:function p(ctx,dirty){var select_changes={};if(dirty&/*properties*/16)select_changes.items=/*properties*/ctx[4];if(!updating_value&&dirty&/*selectedProperty*/2){updating_value=true;select_changes.value=/*selectedProperty*/ctx[1];add_flush_callback(function(){return updating_value=false;});}select.$set(select_changes);},i:function i(local){if(current)return;transition_in(select.$$.fragment,local);current=true;},o:function o(local){transition_out(select.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(tr);destroy_component(select);}};}// (128:6) {#if sortError}
function create_if_block$1(ctx){var div;var t;return{c:function c(){div=element("div");t=text(/*sortError*/ctx[5]);attr(div,"class","jse-error svelte-120r9gh");},m:function m(target,anchor){insert$2(target,div,anchor);append$1(div,t);},p:function p(ctx,dirty){if(dirty&/*sortError*/32)set_data(t,/*sortError*/ctx[5]);},d:function d(detaching){if(detaching)detach(div);}};}function create_fragment$2(ctx){var div3;var header;var t0;var div2;var table;var colgroup;var t2;var tbody;var tr0;var th0;var t4;var td0;var input;var input_value_value;var t5;var t6;var tr1;var th1;var t8;var td1;var select;var updating_value;var t9;var div0;var t10;var div1;var button;var t11;var button_disabled_value;var current;var mounted;var dispose;header=new Header$1({props:{title:/*jsonIsArray*/ctx[3]?'Sort array items':'Sort object keys'}});var if_block0=/*jsonIsArray*/ctx[3]&&(/*properties*/ctx[4].length>1||/*selectedProperty*/ctx[1]===undefined)&&create_if_block_1(ctx);function select_value_binding_1(value){/*select_value_binding_1*/ctx[14](value);}var select_props={showIndicator:true,items:/*directions*/ctx[6],isClearable:false};if(/*selectedDirection*/ctx[2]!==void 0){select_props.value=/*selectedDirection*/ctx[2];}select=new Select({props:select_props});binding_callbacks.push(function(){return bind$2(select,'value',select_value_binding_1);});var if_block1=/*sortError*/ctx[5]&&create_if_block$1(ctx);return{c:function c(){div3=element("div");create_component(header.$$.fragment);t0=space();div2=element("div");table=element("table");colgroup=element("colgroup");colgroup.innerHTML="<col width=\"25%\"/> \n        <col width=\"75%\"/>";t2=space();tbody=element("tbody");tr0=element("tr");th0=element("th");th0.textContent="Path";t4=space();td0=element("td");input=element("input");t5=space();if(if_block0)if_block0.c();t6=space();tr1=element("tr");th1=element("th");th1.textContent="Direction";t8=space();td1=element("td");create_component(select.$$.fragment);t9=space();div0=element("div");if(if_block1)if_block1.c();t10=space();div1=element("div");button=element("button");t11=text("Sort");attr(th0,"class","svelte-120r9gh");attr(input,"class","jse-path svelte-120r9gh");attr(input,"type","text");input.readOnly=true;attr(input,"title","Selected path");input.value=input_value_value=!isEmpty(/*selectedPath*/ctx[0])?stringifyJSONPath(/*selectedPath*/ctx[0]):'(whole document)';attr(td0,"class","svelte-120r9gh");attr(th1,"class","svelte-120r9gh");attr(td1,"class","svelte-120r9gh");attr(table,"class","svelte-120r9gh");attr(div0,"class","jse-space svelte-120r9gh");attr(button,"type","button");attr(button,"class","jse-primary svelte-120r9gh");button.disabled=button_disabled_value=/*jsonIsArray*/ctx[3]?!/*selectedProperty*/ctx[1]:false;attr(div1,"class","jse-actions svelte-120r9gh");attr(div2,"class","jse-contents svelte-120r9gh");attr(div3,"class","jse-modal jse-sort svelte-120r9gh");},m:function m(target,anchor){insert$2(target,div3,anchor);mount_component(header,div3,null);append$1(div3,t0);append$1(div3,div2);append$1(div2,table);append$1(table,colgroup);append$1(table,t2);append$1(table,tbody);append$1(tbody,tr0);append$1(tr0,th0);append$1(tr0,t4);append$1(tr0,td0);append$1(td0,input);append$1(tbody,t5);if(if_block0)if_block0.m(tbody,null);append$1(tbody,t6);append$1(tbody,tr1);append$1(tr1,th1);append$1(tr1,t8);append$1(tr1,td1);mount_component(select,td1,null);append$1(div2,t9);append$1(div2,div0);if(if_block1)if_block1.m(div0,null);append$1(div2,t10);append$1(div2,div1);append$1(div1,button);append$1(button,t11);current=true;if(!mounted){dispose=[listen(button,"click",/*handleSort*/ctx[7]),action_destroyer(focus.call(null,button))];mounted=true;}},p:function p(ctx,_ref178){var _ref179=_slicedToArray(_ref178,1),dirty=_ref179[0];var header_changes={};if(dirty&/*jsonIsArray*/8)header_changes.title=/*jsonIsArray*/ctx[3]?'Sort array items':'Sort object keys';header.$set(header_changes);if(!current||dirty&/*selectedPath*/1&&input_value_value!==(input_value_value=!isEmpty(/*selectedPath*/ctx[0])?stringifyJSONPath(/*selectedPath*/ctx[0]):'(whole document)')&&input.value!==input_value_value){input.value=input_value_value;}if(/*jsonIsArray*/ctx[3]&&(/*properties*/ctx[4].length>1||/*selectedProperty*/ctx[1]===undefined)){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*jsonIsArray, properties, selectedProperty*/26){transition_in(if_block0,1);}}else{if_block0=create_if_block_1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(tbody,t6);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,function(){if_block0=null;});check_outros();}var select_changes={};if(!updating_value&&dirty&/*selectedDirection*/4){updating_value=true;select_changes.value=/*selectedDirection*/ctx[2];add_flush_callback(function(){return updating_value=false;});}select.$set(select_changes);if(/*sortError*/ctx[5]){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block$1(ctx);if_block1.c();if_block1.m(div0,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty&/*jsonIsArray, selectedProperty*/10&&button_disabled_value!==(button_disabled_value=/*jsonIsArray*/ctx[3]?!/*selectedProperty*/ctx[1]:false)){button.disabled=button_disabled_value;}},i:function i(local){if(current)return;transition_in(header.$$.fragment,local);transition_in(if_block0);transition_in(select.$$.fragment,local);current=true;},o:function o(local){transition_out(header.$$.fragment,local);transition_out(if_block0);transition_out(select.$$.fragment,local);current=false;},d:function d(detaching){if(detaching)detach(div3);destroy_component(header);if(if_block0)if_block0.d();destroy_component(select);if(if_block1)if_block1.d();mounted=false;run_all(dispose);}};}function focus(element){element.focus();}function instance$3($$self,$$props,$$invalidate){var jsonIsArray;var paths;var properties;var debug=createDebug('jsoneditor:SortModal');var id=$$props.id;var json=$$props.json;var selectedPath=$$props.selectedPath;var onSort=$$props.onSort;var _getContext11=getContext('simple-modal'),close=_getContext11.close;var stateId="".concat(id,":").concat(immutableJSONPatch.exports.compileJSONPointer(selectedPath));var selectedJson=immutableJSONPatch.exports.getIn(json,selectedPath);var asc={value:1,label:'ascending'};var desc={value:-1,label:'descending'};var directions=[asc,desc];var selectedProperty=sortModalState[stateId]&&sortModalState[stateId].selectedProperty||undefined;var selectedDirection=sortModalState[stateId]&&sortModalState[stateId].selectedDirection||asc;var sortError=undefined;function handleSort(){try{$$invalidate(5,sortError=undefined);if(jsonIsArray){if(!selectedProperty){return;}var _property=selectedProperty.value;var direction=selectedDirection.value;var operations=sortArray(json,selectedPath,_property,direction);onSort(operations);}else if(isObject$1(selectedJson)){var _direction=selectedDirection.value;var _operations6=sortObjectKeys(json,selectedPath,_direction);onSort(_operations6);}else{console.error('Cannot sort: no array or object');}close();}catch(err){$$invalidate(5,sortError=err.toString());}}function select_value_binding(value){selectedProperty=value;(($$invalidate(1,selectedProperty),$$invalidate(4,properties)),$$invalidate(12,paths)),$$invalidate(3,jsonIsArray);}function select_value_binding_1(value){selectedDirection=value;$$invalidate(2,selectedDirection);}$$self.$$set=function($$props){if('id'in $$props)$$invalidate(8,id=$$props.id);if('json'in $$props)$$invalidate(9,json=$$props.json);if('selectedPath'in $$props)$$invalidate(0,selectedPath=$$props.selectedPath);if('onSort'in $$props)$$invalidate(10,onSort=$$props.onSort);};$$self.$$.update=function(){if($$self.$$.dirty&/*jsonIsArray*/8){$$invalidate(12,paths=jsonIsArray?getNestedPaths(selectedJson):undefined);}if($$self.$$.dirty&/*paths*/4096){$$invalidate(4,properties=paths?paths.map(pathToOption):undefined);}if($$self.$$.dirty&/*selectedProperty, properties*/18){{// if there is only one option, select it and do not render the select box
if(selectedProperty===undefined&&properties&&properties.length===1){$$invalidate(1,selectedProperty=properties[0]);}}}if($$self.$$.dirty&/*selectedProperty, selectedDirection, sortModalState*/2054){{// remember the selected values for the next time we open the SortModal
// just in memory, not persisted
$$invalidate(11,sortModalState[stateId]={selectedProperty:selectedProperty,selectedDirection:selectedDirection},sortModalState);debug('store state in memory',stateId,sortModalState[stateId]);}}};$$invalidate(3,jsonIsArray=Array.isArray(selectedJson));return[selectedPath,selectedProperty,selectedDirection,jsonIsArray,properties,sortError,directions,handleSort,id,json,onSort,sortModalState,paths,select_value_binding,select_value_binding_1];}var SortModal=/*#__PURE__*/function(_SvelteComponent56){_inherits(SortModal,_SvelteComponent56);var _super97=_createSuper(SortModal);function SortModal(options){var _this151;_classCallCheck(this,SortModal);_this151=_super97.call(this);init(_assertThisInitialized(_this151),options,instance$3,create_fragment$2,not_equal,{id:8,json:9,selectedPath:0,onSort:10},add_css$2);return _this151;}return _createClass(SortModal);}(SvelteComponent);var SortModal$1=SortModal;/* src/lib/components/modals/ModalRef.svelte generated by Svelte v3.51.0 */exports.SortModal=SortModal$1;function instance$2($$self,$$props,$$invalidate){var context=getContext('simple-modal');var open=context.open;var close=context.close;return[open,close];}var ModalRef=/*#__PURE__*/function(_SvelteComponent57){_inherits(ModalRef,_SvelteComponent57);var _super98=_createSuper(ModalRef);function ModalRef(options){var _this152;_classCallCheck(this,ModalRef);_this152=_super98.call(this);init(_assertThisInitialized(_this152),options,instance$2,null,not_equal,{open:0,close:1});return _this152;}_createClass(ModalRef,[{key:"open",get:function get(){return this.$$.ctx[0];}},{key:"close",get:function get(){return this.$$.ctx[1];}}]);return ModalRef;}(SvelteComponent);var ModalRef$1=ModalRef;/* src/lib/components/JSONEditor.svelte generated by Svelte v3.51.0 */function add_css$1(target){append_styles(target,"svelte-qi4kho",":root{--jse-font-family:-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen-Sans, Ubuntu,\n    Cantarell, \"Helvetica Neue\", sans-serif;--jse-font-family-mono:consolas, menlo, monaco, \"Ubuntu Mono\", \"source-code-pro\", monospace;--jse-font-size-mono:14px;--jse-font-size:16px;--jse-font-size-text-mode-search:80%;--jse-line-height:calc(1em + 4px);--jse-indent-size:calc(1em + 4px);--jse-color-picker-button-size:1em;--jse-padding:10px;--jse-theme-color:#3883fa;--jse-theme-color-highlight:#5f9dff;--jse-background-color:#fff;--jse-text-color:#4d4d4d;--jse-text-color-inverse:#fff;--jse-error-color:#ee5341;--jse-warning-color:#fdc539;--jse-main-border:1px solid #d7d7d7;--jse-menu-color:var(--jse-text-color-inverse);--jse-menu-button-size:32px;--jse-modal-background:#f5f5f5;--jse-modal-overlay-background:rgba(0, 0, 0, 0.3);--jse-modal-code-background:rgba(0, 0, 0, 0.05);--jse-tooltip-color:var(--jse-text-color);--jse-tooltip-background:var(--jse-modal-background);--jse-tooltip-border:var(--jse-main-border);--jse-tooltip-action-button-color:var(--jse-text-color-inverse);--jse-tooltip-action-button-background:#4d4d4d;--jse-panel-background:#ebebeb;--jse-panel-color:var(--jse-text-color);--jse-panel-color-readonly:#b2b2b2;--jse-panel-border:var(--jse-main-border);--jse-panel-button-color:inherit;--jse-panel-button-background:transparent;--jse-panel-button-color-highlight:var(--jse-text-color);--jse-panel-button-background-highlight:#e0e0e0;--jse-navigation-bar-background:var(--jse-background-color);--jse-navigation-bar-background-highlight:#e5e5e5;--jse-navigation-bar-dropdown-color:#656565;--jse-context-menu-background:#656565;--jse-context-menu-background-highlight:#7a7a7a;--jse-context-menu-color:var(--jse-text-color-inverse);--jse-context-menu-color-disabled:#9d9d9d;--jse-context-menu-separator-color:#7a7a7a;--jse-context-menu-button-background:var(--jse-context-menu-background);--jse-context-menu-button-background-highlight:var(--jse-context-menu-background-highlight);--jse-context-menu-button-color:var(--jse-context-menu-color);--jse-context-menu-button-size:calc(1em + 4px);--jse-context-menu-tip-background:rgba(255, 255, 255, 0.2);--jse-context-menu-tip-color:inherit;--jse-key-color:#1a1a1a;--jse-value-color:#1a1a1a;--jse-value-color-number:#ee422e;--jse-value-color-boolean:#ff8c00;--jse-value-color-null:#004ed0;--jse-value-color-string:#008000;--jse-value-color-url:#008000;--jse-delimiter-color:rgba(0, 0, 0, 0.38);--jse-edit-outline:2px solid #656565;--jse-hover-background-color:rgba(0, 0, 0, 0.06);--jse-selection-background-color:#d3d3d3;--jse-selection-background-light-color:#e8e8e8;--jse-collapsed-items-background-color:#f5f5f5;--jse-collapsed-items-selected-background-color:#c2c2c2;--jse-collapsed-items-link-color:rgba(0, 0, 0, 0.38);--jse-collapsed-items-link-color-highlight:#ee5341;--jse-search-match-color:#ffe665;--jse-search-match-outline:1px solid #ffd700;--jse-search-match-active-color:#ffd700;--jse-search-match-active-outline:1px solid #e1be00;--jse-tag-background:rgba(0, 0, 0, 0.2);--jse-tag-color:var(--jse-text-color-inverse);--jse-controls-box-shadow:0 2px 6px 0 rgba(0, 0, 0, 0.24);--jse-input-background:var(--jse-background-color);--jse-input-background-readonly:transparent;--jse-input-border:1px solid #d8dbdf;--jse-input-border-focus:1px solid var(--jse-theme-color);--jse-input-radius:3px;--jse-button-background:#e0e0e0;--jse-button-background-highlight:#e7e7e7;--jse-button-color:var(--jse-text-color);--jse-button-primary-background:var(--jse-theme-color);--jse-button-primary-background-highlight:var(--jse-theme-color-highlight);--jse-button-primary-background-disabled:#9d9d9d;--jse-button-primary-color:var(--jse-text-color-inverse);--jse-a-color:#156fc5;--jse-a-color-highlight:#0f508d;--jse-message-error-background:var(--jse-error-color);--jse-message-error-color:var(--jse-text-color-inverse);--jse-message-warning-background:#ffde5c;--jse-message-warning-color:var(--jse-text-color);--jse-message-success-background:#9ac45d;--jse-message-success-color:var(--jse-text-color-inverse);--jse-message-info-background:#9d9d9d;--jse-message-info-color:var(--jse-text-color-inverse);--jse-message-action-background:rgba(255, 255, 255, 0.2);--jse-message-action-background-highlight:rgba(255, 255, 255, 0.3);--itemIsActiveBG:#3883fa;--border:1px solid #d8dbdf;--borderRadius:3px;--background:#fff;--jse-color-picker-background:var(--jse-panel-background);--jse-color-picker-border-box-shadow:#cbcbcb 0 0 0 1px}.jse-main.svelte-qi4kho{width:100%;height:100%;min-width:0;min-height:150px;font-family:var(--jse-font-family);font-size:var(--jse-font-size);line-height:normal;position:relative;display:flex;flex-direction:row}");}// (357:8) {:else}
function create_else_block(ctx){var treemode;var current;var treemode_props={readOnly:/*readOnly*/ctx[2],indentation:/*indentation*/ctx[3],externalContent:/*content*/ctx[0],mainMenuBar:/*mainMenuBar*/ctx[5],navigationBar:/*navigationBar*/ctx[6],escapeControlCharacters:/*escapeControlCharacters*/ctx[8],escapeUnicodeCharacters:/*escapeUnicodeCharacters*/ctx[9],parser:/*parser*/ctx[10],validator:/*validator*/ctx[11],validationParser:/*validationParser*/ctx[12],pathParser:/*pathParser*/ctx[13],onError:/*onError*/ctx[16],onChange:/*handleChange*/ctx[24],onRequestRepair:/*handleRequestRepair*/ctx[25],onRenderValue:/*onRenderValue*/ctx[14],onClassName:/*onClassName*/ctx[15],onFocus:/*handleFocus*/ctx[27],onBlur:/*handleBlur*/ctx[28],onRenderMenu:/*handleRenderMenu*/ctx[23],onSortModal:/*onSortModal*/ctx[30],onTransformModal:/*onTransformModal*/ctx[29]};treemode=new TreeMode$1({props:treemode_props});/*treemode_binding*/ctx[57](treemode);return{c:function c(){create_component(treemode.$$.fragment);},m:function m(target,anchor){mount_component(treemode,target,anchor);current=true;},p:function p(ctx,dirty){var treemode_changes={};if(dirty[0]&/*readOnly*/4)treemode_changes.readOnly=/*readOnly*/ctx[2];if(dirty[0]&/*indentation*/8)treemode_changes.indentation=/*indentation*/ctx[3];if(dirty[0]&/*content*/1)treemode_changes.externalContent=/*content*/ctx[0];if(dirty[0]&/*mainMenuBar*/32)treemode_changes.mainMenuBar=/*mainMenuBar*/ctx[5];if(dirty[0]&/*navigationBar*/64)treemode_changes.navigationBar=/*navigationBar*/ctx[6];if(dirty[0]&/*escapeControlCharacters*/256)treemode_changes.escapeControlCharacters=/*escapeControlCharacters*/ctx[8];if(dirty[0]&/*escapeUnicodeCharacters*/512)treemode_changes.escapeUnicodeCharacters=/*escapeUnicodeCharacters*/ctx[9];if(dirty[0]&/*parser*/1024)treemode_changes.parser=/*parser*/ctx[10];if(dirty[0]&/*validator*/2048)treemode_changes.validator=/*validator*/ctx[11];if(dirty[0]&/*validationParser*/4096)treemode_changes.validationParser=/*validationParser*/ctx[12];if(dirty[0]&/*pathParser*/8192)treemode_changes.pathParser=/*pathParser*/ctx[13];if(dirty[0]&/*onError*/65536)treemode_changes.onError=/*onError*/ctx[16];if(dirty[0]&/*onRenderValue*/16384)treemode_changes.onRenderValue=/*onRenderValue*/ctx[14];if(dirty[0]&/*onClassName*/32768)treemode_changes.onClassName=/*onClassName*/ctx[15];if(dirty[0]&/*handleRenderMenu*/8388608)treemode_changes.onRenderMenu=/*handleRenderMenu*/ctx[23];treemode.$set(treemode_changes);},i:function i(local){if(current)return;transition_in(treemode.$$.fragment,local);current=true;},o:function o(local){transition_out(treemode.$$.fragment,local);current=false;},d:function d(detaching){/*treemode_binding*/ctx[57](null);destroy_component(treemode,detaching);}};}// (335:8) {#if mode === Mode.text || mode === 'code'}
function create_if_block(ctx){var textmode;var current;var textmode_props={externalContent:/*content*/ctx[0],readOnly:/*readOnly*/ctx[2],indentation:/*indentation*/ctx[3],tabSize:/*tabSize*/ctx[4],mainMenuBar:/*mainMenuBar*/ctx[5],statusBar:/*statusBar*/ctx[7],escapeUnicodeCharacters:/*escapeUnicodeCharacters*/ctx[9],parser:/*parser*/ctx[10],validator:/*validator*/ctx[11],validationParser:/*validationParser*/ctx[12],onChange:/*handleChange*/ctx[24],onSwitchToTreeMode:/*handleSwitchToTreeMode*/ctx[26],onError:/*onError*/ctx[16],onFocus:/*handleFocus*/ctx[27],onBlur:/*handleBlur*/ctx[28],onRenderMenu:/*handleRenderMenu*/ctx[23],onSortModal:/*onSortModal*/ctx[30],onTransformModal:/*onTransformModal*/ctx[29]};textmode=new TextMode$1({props:textmode_props});/*textmode_binding*/ctx[56](textmode);return{c:function c(){create_component(textmode.$$.fragment);},m:function m(target,anchor){mount_component(textmode,target,anchor);current=true;},p:function p(ctx,dirty){var textmode_changes={};if(dirty[0]&/*content*/1)textmode_changes.externalContent=/*content*/ctx[0];if(dirty[0]&/*readOnly*/4)textmode_changes.readOnly=/*readOnly*/ctx[2];if(dirty[0]&/*indentation*/8)textmode_changes.indentation=/*indentation*/ctx[3];if(dirty[0]&/*tabSize*/16)textmode_changes.tabSize=/*tabSize*/ctx[4];if(dirty[0]&/*mainMenuBar*/32)textmode_changes.mainMenuBar=/*mainMenuBar*/ctx[5];if(dirty[0]&/*statusBar*/128)textmode_changes.statusBar=/*statusBar*/ctx[7];if(dirty[0]&/*escapeUnicodeCharacters*/512)textmode_changes.escapeUnicodeCharacters=/*escapeUnicodeCharacters*/ctx[9];if(dirty[0]&/*parser*/1024)textmode_changes.parser=/*parser*/ctx[10];if(dirty[0]&/*validator*/2048)textmode_changes.validator=/*validator*/ctx[11];if(dirty[0]&/*validationParser*/4096)textmode_changes.validationParser=/*validationParser*/ctx[12];if(dirty[0]&/*onError*/65536)textmode_changes.onError=/*onError*/ctx[16];if(dirty[0]&/*handleRenderMenu*/8388608)textmode_changes.onRenderMenu=/*handleRenderMenu*/ctx[23];textmode.$set(textmode_changes);},i:function i(local){if(current)return;transition_in(textmode.$$.fragment,local);current=true;},o:function o(local){transition_out(textmode.$$.fragment,local);current=false;},d:function d(detaching){/*textmode_binding*/ctx[56](null);destroy_component(textmode,detaching);}};}// (333:6) {#key instanceId}
function create_key_block(ctx){var current_block_type_index;var if_block;var if_block_anchor;var current;var if_block_creators=[create_if_block,create_else_block];var if_blocks=[];function select_block_type(ctx,dirty){if(/*mode*/ctx[1]===Mode.text||/*mode*/ctx[1]==='code')return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c:function c(){if_block.c();if_block_anchor=empty$1();},m:function m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert$2(target,if_block_anchor,anchor);current=true;},p:function p(ctx,dirty){var previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,function(){if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}else{if_block.p(ctx,dirty);}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i:function i(local){if(current)return;transition_in(if_block);current=true;},o:function o(local){transition_out(if_block);current=false;},d:function d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (331:2) <AbsolutePopup>
function create_default_slot_1(ctx){var div;var previous_key=/*instanceId*/ctx[17];var current;var key_block=create_key_block(ctx);return{c:function c(){div=element("div");key_block.c();attr(div,"class","jse-main svelte-qi4kho");toggle_class(div,"jse-focus",/*hasFocus*/ctx[18]);},m:function m(target,anchor){insert$2(target,div,anchor);key_block.m(div,null);/*div_binding*/ctx[58](div);current=true;},p:function p(ctx,dirty){if(dirty[0]&/*instanceId*/131072&&not_equal(previous_key,previous_key=/*instanceId*/ctx[17])){group_outros();transition_out(key_block,1,1,noop$2);check_outros();key_block=create_key_block(ctx);key_block.c();transition_in(key_block,1);key_block.m(div,null);}else{key_block.p(ctx,dirty);}if(!current||dirty[0]&/*hasFocus*/262144){toggle_class(div,"jse-focus",/*hasFocus*/ctx[18]);}},i:function i(local){if(current)return;transition_in(key_block);current=true;},o:function o(local){transition_out(key_block);current=false;},d:function d(detaching){if(detaching)detach(div);key_block.d(detaching);/*div_binding*/ctx[58](null);}};}// (329:0) <Modal>
function create_default_slot(ctx){var modalref;var updating_open;var t;var absolutepopup;var current;function modalref_open_binding(value){/*modalref_open_binding*/ctx[55](value);}var modalref_props={};if(/*open*/ctx[22]!==void 0){modalref_props.open=/*open*/ctx[22];}modalref=new ModalRef$1({props:modalref_props});binding_callbacks.push(function(){return bind$2(modalref,'open',modalref_open_binding);});absolutepopup=new AbsolutePopup$1({props:{$$slots:{"default":[create_default_slot_1]},$$scope:{ctx:ctx}}});return{c:function c(){create_component(modalref.$$.fragment);t=space();create_component(absolutepopup.$$.fragment);},m:function m(target,anchor){mount_component(modalref,target,anchor);insert$2(target,t,anchor);mount_component(absolutepopup,target,anchor);current=true;},p:function p(ctx,dirty){var modalref_changes={};if(!updating_open&&dirty[0]&/*open*/4194304){updating_open=true;modalref_changes.open=/*open*/ctx[22];add_flush_callback(function(){return updating_open=false;});}modalref.$set(modalref_changes);var absolutepopup_changes={};if(dirty[0]&/*refJSONEditor, hasFocus, instanceId, content, readOnly, indentation, tabSize, mainMenuBar, statusBar, escapeUnicodeCharacters, parser, validator, validationParser, onError, handleRenderMenu, refTextMode, mode, navigationBar, escapeControlCharacters, pathParser, onRenderValue, onClassName, refTreeMode*/12582911|dirty[2]&/*$$scope*/2){absolutepopup_changes.$$scope={dirty:dirty,ctx:ctx};}absolutepopup.$set(absolutepopup_changes);},i:function i(local){if(current)return;transition_in(modalref.$$.fragment,local);transition_in(absolutepopup.$$.fragment,local);current=true;},o:function o(local){transition_out(modalref.$$.fragment,local);transition_out(absolutepopup.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(modalref,detaching);if(detaching)detach(t);destroy_component(absolutepopup,detaching);}};}function create_fragment$1(ctx){var modal;var current;modal=new Modal({props:{$$slots:{"default":[create_default_slot]},$$scope:{ctx:ctx}}});return{c:function c(){create_component(modal.$$.fragment);},m:function m(target,anchor){mount_component(modal,target,anchor);current=true;},p:function p(ctx,dirty){var modal_changes={};if(dirty[0]&/*refJSONEditor, hasFocus, instanceId, content, readOnly, indentation, tabSize, mainMenuBar, statusBar, escapeUnicodeCharacters, parser, validator, validationParser, onError, handleRenderMenu, refTextMode, mode, navigationBar, escapeControlCharacters, pathParser, onRenderValue, onClassName, refTreeMode, open*/16777215|dirty[2]&/*$$scope*/2){modal_changes.$$scope={dirty:dirty,ctx:ctx};}modal.$set(modal_changes);},i:function i(local){if(current)return;transition_in(modal.$$.fragment,local);current=true;},o:function o(local){transition_out(modal.$$.fragment,local);current=false;},d:function d(detaching){destroy_component(modal,detaching);}};}function updateProps(props){this.$set(props);}function destroy(){this.$destroy();}function instance$1($$self,$$props,$$invalidate){var handleRenderMenu;var debug=createDebug('jsoneditor:Main');var _$$props$content=$$props.content,content=_$$props$content===void 0?{text:''}:_$$props$content;var _$$props$readOnly4=$$props.readOnly,readOnly=_$$props$readOnly4===void 0?false:_$$props$readOnly4;var _$$props$indentation=$$props.indentation,indentation=_$$props$indentation===void 0?2:_$$props$indentation;var _$$props$tabSize=$$props.tabSize,tabSize=_$$props$tabSize===void 0?4:_$$props$tabSize;var _$$props$mode=$$props.mode,mode=_$$props$mode===void 0?Mode.tree:_$$props$mode;var _$$props$mainMenuBar=$$props.mainMenuBar,mainMenuBar=_$$props$mainMenuBar===void 0?true:_$$props$mainMenuBar;var _$$props$navigationBa=$$props.navigationBar,navigationBar=_$$props$navigationBa===void 0?true:_$$props$navigationBa;var _$$props$statusBar=$$props.statusBar,statusBar=_$$props$statusBar===void 0?true:_$$props$statusBar;var _$$props$escapeContro=$$props.escapeControlCharacters,escapeControlCharacters=_$$props$escapeContro===void 0?false:_$$props$escapeContro;var _$$props$escapeUnicod=$$props.escapeUnicodeCharacters,escapeUnicodeCharacters=_$$props$escapeUnicod===void 0?false:_$$props$escapeUnicod;var _$$props$parser=$$props.parser,parser=_$$props$parser===void 0?JSON:_$$props$parser;var _$$props$validator=$$props.validator,validator=_$$props$validator===void 0?null:_$$props$validator;var _$$props$validationPa=$$props.validationParser,validationParser=_$$props$validationPa===void 0?JSON:_$$props$validationPa;var _$$props$pathParser=$$props.pathParser,pathParser=_$$props$pathParser===void 0?{parse:parseJSONPath,stringify:stringifyJSONPath}:_$$props$pathParser;var _$$props$queryLanguag=$$props.queryLanguages,queryLanguages=_$$props$queryLanguag===void 0?[javascriptQueryLanguage]:_$$props$queryLanguag;var _$$props$queryLanguag2=$$props.queryLanguageId,queryLanguageId=_$$props$queryLanguag2===void 0?queryLanguages[0].id:_$$props$queryLanguag2;var _$$props$onChangeQuer=$$props.onChangeQueryLanguage,onChangeQueryLanguage=_$$props$onChangeQuer===void 0?noop:_$$props$onChangeQuer;var _$$props$onChange3=$$props.onChange,onChange=_$$props$onChange3===void 0?null:_$$props$onChange3;var _$$props$onRenderValu=$$props.onRenderValue,onRenderValue=_$$props$onRenderValu===void 0?renderValue:_$$props$onRenderValu;var _$$props$onClassName=$$props.onClassName,onClassName=_$$props$onClassName===void 0?function(){return undefined;}:_$$props$onClassName;var _$$props$onRenderMenu4=$$props.onRenderMenu,onRenderMenu=_$$props$onRenderMenu4===void 0?noop:_$$props$onRenderMenu4;var _$$props$onChangeMode=$$props.onChangeMode,onChangeMode=_$$props$onChangeMode===void 0?noop:_$$props$onChangeMode;var _$$props$onError=$$props.onError,onError=_$$props$onError===void 0?function(err){console.error(err);alert(err.toString());// TODO: create a nice alert modal
}:_$$props$onError;var _$$props$onFocus=$$props.onFocus,onFocus=_$$props$onFocus===void 0?noop:_$$props$onFocus;var _$$props$onBlur=$$props.onBlur,onBlur=_$$props$onBlur===void 0?noop:_$$props$onBlur;var instanceId=uniqueId$1();var hasFocus=false;var refJSONEditor;var refTreeMode;var refTextMode;var open;// svelte-simple-modal context open(...)
// rerender the full editor when the parser changes. This is needed because
// numeric state is hold at many places in the editor.
var previousParser=parser;function get(){return content;}function set(newContent){debug('set');var contentError=validateContentType(newContent);if(contentError){throw new Error(contentError);}// new editor id -> will re-create the editor
$$invalidate(17,instanceId=uniqueId$1());$$invalidate(0,content=newContent);}function update(updatedContent){debug('update');var contentError=validateContentType(updatedContent);if(contentError){throw new Error(contentError);}$$invalidate(0,content=updatedContent);}function patch(operations){if(isTextContent(content)){try{$$invalidate(0,content={json:parser.parse(content.text),text:undefined});}catch(err){throw new Error('Cannot apply patch: current document contains invalid JSON');}}if(refTreeMode){// Note that tree mode has an optional afterPatch callback.
// right now we don's support this in the public API.
return refTreeMode.patch(operations);}if(refTextMode){return refTextMode.patch(operations);}}function expand(callback){if(refTreeMode){return refTreeMode.expand(callback);}else{throw new Error("Method expand is not available in mode \"".concat(mode,"\""));}}function transform(options){if(refTextMode){refTextMode.openTransformModal(options);}else if(refTreeMode){refTreeMode.openTransformModal(options);}else{throw new Error("Method transform is not available in mode \"".concat(mode,"\""));}}function validate(){if(refTextMode){return refTextMode.validate();}else if(refTreeMode){return refTreeMode.validate();}else{throw new Error("Method validate is not available in mode \"".concat(mode,"\""));}}function acceptAutoRepair(){if(refTreeMode){return refTreeMode.acceptAutoRepair();}else{return content;}}function scrollTo(path){if(refTreeMode){return refTreeMode.scrollTo(path);}else{// TODO: implement scrollTo for text mode
throw new Error("Method scrollTo is not available in mode \"".concat(mode,"\""));}}function findElement(path){if(refTreeMode){return refTreeMode.findElement(path);}else{throw new Error("Method findElement is not available in mode \"".concat(mode,"\""));}}function focus(){if(refTextMode){refTextMode.focus();}else if(refTreeMode){refTreeMode.focus();}}function refresh(){if(refTextMode){refTextMode.refresh();}// nothing to do in tree mode (also: don't throw an exception or so,
// that annoying having to reckon with that when using .refresh()).
}function handleChange(updatedContent,previousContent,status){$$invalidate(0,content=updatedContent);if(onChange){onChange(updatedContent,previousContent,status);}}function handleRequestRepair(){return _handleRequestRepair.apply(this,arguments);}function _handleRequestRepair(){_handleRequestRepair=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee22(){return _regeneratorRuntime().wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:$$invalidate(1,mode=Mode.text);_context22.next=3;return tick();case 3:onChangeMode(Mode.text);case 4:case"end":return _context22.stop();}}},_callee22);}));return _handleRequestRepair.apply(this,arguments);}function handleSwitchToTreeMode(){return _handleSwitchToTreeMode.apply(this,arguments);}function _handleSwitchToTreeMode(){_handleSwitchToTreeMode=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee23(){return _regeneratorRuntime().wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:$$invalidate(1,mode=Mode.tree);_context23.next=3;return tick();case 3:onChangeMode(Mode.tree);case 4:case"end":return _context23.stop();}}},_callee23);}));return _handleSwitchToTreeMode.apply(this,arguments);}function handleFocus(){$$invalidate(18,hasFocus=true);if(onFocus){onFocus();}}function handleBlur(){$$invalidate(18,hasFocus=false);if(onBlur){onBlur();}}function toggleMode(_x15){return _toggleMode.apply(this,arguments);}function _toggleMode(){_toggleMode=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee24(newMode){return _regeneratorRuntime().wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:if(!(mode===newMode)){_context24.next=2;break;}return _context24.abrupt("return");case 2:$$invalidate(1,mode=newMode);_context24.next=5;return tick();case 5:focus();onChangeMode(newMode);case 7:case"end":return _context24.stop();}}},_callee24);}));return _toggleMode.apply(this,arguments);}var modeMenuItems;var separatorMenuItem={separator:true};function handleChangeQueryLanguage(newQueryLanguageId){debug('handleChangeQueryLanguage',newQueryLanguageId);$$invalidate(31,queryLanguageId=newQueryLanguageId);onChangeQueryLanguage(newQueryLanguageId);}// The onTransformModal method is located in JSONEditor to prevent circular references:
//     TreeMode -> TransformModal -> TreeMode
function onTransformModal(_ref180){var id=_ref180.id,json=_ref180.json,selectedPath=_ref180.selectedPath,onTransform=_ref180.onTransform,onClose=_ref180.onClose;if(readOnly){return;}open(TransformModal$1,{id:id,json:json,selectedPath:selectedPath,escapeControlCharacters:escapeControlCharacters,escapeUnicodeCharacters:escapeUnicodeCharacters,parser:parser,queryLanguages:queryLanguages,queryLanguageId:queryLanguageId,onChangeQueryLanguage:handleChangeQueryLanguage,onRenderValue:onRenderValue,onClassName:onClassName,onTransform:onTransform},TRANSFORM_MODAL_OPTIONS,{onClose:onClose});}// The onSortModal is positioned here for consistency with TransformModal
function onSortModal(_ref181){var id=_ref181.id,json=_ref181.json,selectedPath=_ref181.selectedPath,onSort=_ref181.onSort,onClose=_ref181.onClose;if(readOnly){return;}open(SortModal$1,{id:id,json:json,selectedPath:selectedPath,onSort:onSort},SORT_MODAL_OPTIONS,{onClose:onClose});}function modalref_open_binding(value){open=value;$$invalidate(22,open);}function textmode_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refTextMode=$$value;$$invalidate(21,refTextMode);});}function treemode_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refTreeMode=$$value;$$invalidate(20,refTreeMode);});}function div_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refJSONEditor=$$value;$$invalidate(19,refJSONEditor);});}$$self.$$set=function($$props){if('content'in $$props)$$invalidate(0,content=$$props.content);if('readOnly'in $$props)$$invalidate(2,readOnly=$$props.readOnly);if('indentation'in $$props)$$invalidate(3,indentation=$$props.indentation);if('tabSize'in $$props)$$invalidate(4,tabSize=$$props.tabSize);if('mode'in $$props)$$invalidate(1,mode=$$props.mode);if('mainMenuBar'in $$props)$$invalidate(5,mainMenuBar=$$props.mainMenuBar);if('navigationBar'in $$props)$$invalidate(6,navigationBar=$$props.navigationBar);if('statusBar'in $$props)$$invalidate(7,statusBar=$$props.statusBar);if('escapeControlCharacters'in $$props)$$invalidate(8,escapeControlCharacters=$$props.escapeControlCharacters);if('escapeUnicodeCharacters'in $$props)$$invalidate(9,escapeUnicodeCharacters=$$props.escapeUnicodeCharacters);if('parser'in $$props)$$invalidate(10,parser=$$props.parser);if('validator'in $$props)$$invalidate(11,validator=$$props.validator);if('validationParser'in $$props)$$invalidate(12,validationParser=$$props.validationParser);if('pathParser'in $$props)$$invalidate(13,pathParser=$$props.pathParser);if('queryLanguages'in $$props)$$invalidate(32,queryLanguages=$$props.queryLanguages);if('queryLanguageId'in $$props)$$invalidate(31,queryLanguageId=$$props.queryLanguageId);if('onChangeQueryLanguage'in $$props)$$invalidate(33,onChangeQueryLanguage=$$props.onChangeQueryLanguage);if('onChange'in $$props)$$invalidate(34,onChange=$$props.onChange);if('onRenderValue'in $$props)$$invalidate(14,onRenderValue=$$props.onRenderValue);if('onClassName'in $$props)$$invalidate(15,onClassName=$$props.onClassName);if('onRenderMenu'in $$props)$$invalidate(35,onRenderMenu=$$props.onRenderMenu);if('onChangeMode'in $$props)$$invalidate(36,onChangeMode=$$props.onChangeMode);if('onError'in $$props)$$invalidate(16,onError=$$props.onError);if('onFocus'in $$props)$$invalidate(37,onFocus=$$props.onFocus);if('onBlur'in $$props)$$invalidate(38,onBlur=$$props.onBlur);};$$self.$$.update=function(){if($$self.$$.dirty[0]&/*content*/1){{var contentError=validateContentType(content);if(contentError){console.error('Error: '+contentError);}}}if($$self.$$.dirty[0]&/*parser*/1024|$$self.$$.dirty[1]&/*previousParser*/4194304){{if(!isEqualParser(parser,previousParser)){debug('parser changed, recreate editor');$$invalidate(53,previousParser=parser);// new editor id -> will re-create the editor
$$invalidate(17,instanceId=uniqueId$1());}}}if($$self.$$.dirty[0]&/*mode*/2){$$invalidate(54,modeMenuItems=[{text:'text',title:"Switch to text mode (current mode: ".concat(mode,")"),// check for 'code' mode is here for backward compatibility (deprecated since v0.4.0)
className:'jse-group-button jse-first'+(mode===Mode.text||mode==='code'?' jse-selected':''),onClick:function onClick(){return toggleMode(Mode.text);}},{text:'tree',title:"Switch to tree mode (current mode: ".concat(mode,")"),className:'jse-group-button jse-last'+(mode===Mode.tree?' jse-selected':''),onClick:function onClick(){return toggleMode(Mode.tree);}}]);}if($$self.$$.dirty[1]&/*modeMenuItems, onRenderMenu*/8388624){$$invalidate(23,handleRenderMenu=function handleRenderMenu(mode,items){var updatedItems=isMenuSpaceItem(items[0])?modeMenuItems.concat(items):modeMenuItems.concat(separatorMenuItem,items);// menu is empty, readOnly mode
return onRenderMenu(mode,updatedItems)||updatedItems;});}if($$self.$$.dirty[0]&/*mode*/2){{debug('mode changed to',mode);if(mode==='code'){// check for 'code' is here for backward compatibility (deprecated since v0.4.0)
console.warn('Deprecation warning: "code" mode is renamed to "text". Please use mode="text" instead.');}}}};return[content,mode,readOnly,indentation,tabSize,mainMenuBar,navigationBar,statusBar,escapeControlCharacters,escapeUnicodeCharacters,parser,validator,validationParser,pathParser,onRenderValue,onClassName,onError,instanceId,hasFocus,refJSONEditor,refTreeMode,refTextMode,open,handleRenderMenu,handleChange,handleRequestRepair,handleSwitchToTreeMode,handleFocus,handleBlur,onTransformModal,onSortModal,queryLanguageId,queryLanguages,onChangeQueryLanguage,onChange,onRenderMenu,onChangeMode,onFocus,onBlur,get,set,update,patch,expand,transform,validate,acceptAutoRepair,scrollTo,findElement,focus,refresh,updateProps,destroy,previousParser,modeMenuItems,modalref_open_binding,textmode_binding,treemode_binding,div_binding];}var JSONEditor=/*#__PURE__*/function(_SvelteComponent58){_inherits(JSONEditor,_SvelteComponent58);var _super99=_createSuper(JSONEditor);function JSONEditor(options){var _this153;_classCallCheck(this,JSONEditor);_this153=_super99.call(this);init(_assertThisInitialized(_this153),options,instance$1,create_fragment$1,not_equal,{content:0,readOnly:2,indentation:3,tabSize:4,mode:1,mainMenuBar:5,navigationBar:6,statusBar:7,escapeControlCharacters:8,escapeUnicodeCharacters:9,parser:10,validator:11,validationParser:12,pathParser:13,queryLanguages:32,queryLanguageId:31,onChangeQueryLanguage:33,onChange:34,onRenderValue:14,onClassName:15,onRenderMenu:35,onChangeMode:36,onError:16,onFocus:37,onBlur:38,get:39,set:40,update:41,patch:42,expand:43,transform:44,validate:45,acceptAutoRepair:46,scrollTo:47,findElement:48,focus:49,refresh:50,updateProps:51,destroy:52},add_css$1,[-1,-1,-1]);return _this153;}_createClass(JSONEditor,[{key:"get",get:function get(){return this.$$.ctx[39];}},{key:"set",get:function get(){return this.$$.ctx[40];}},{key:"update",get:function get(){return this.$$.ctx[41];}},{key:"patch",get:function get(){return this.$$.ctx[42];}},{key:"expand",get:function get(){return this.$$.ctx[43];}},{key:"transform",get:function get(){return this.$$.ctx[44];}},{key:"validate",get:function get(){return this.$$.ctx[45];}},{key:"acceptAutoRepair",get:function get(){return this.$$.ctx[46];}},{key:"scrollTo",get:function get(){return this.$$.ctx[47];}},{key:"findElement",get:function get(){return this.$$.ctx[48];}},{key:"focus",get:function get(){return this.$$.ctx[49];}},{key:"refresh",get:function get(){return this.$$.ctx[50];}},{key:"updateProps",get:function get(){return updateProps;}},{key:"destroy",get:function get(){return destroy;}}]);return JSONEditor;}(SvelteComponent);var JSONEditor$1=JSONEditor;/* src/lib/plugins/value/components/EnumValue.svelte generated by Svelte v3.51.0 */exports.JSONEditor=JSONEditor$1;function add_css(target){append_styles(target,"svelte-rc6e9m",".jse-value.jse-string.svelte-rc6e9m{color:var(--jse-value-color-string)}.jse-value.jse-object.svelte-rc6e9m,.jse-value.jse-array.svelte-rc6e9m{min-width:16px;color:var(--jse-delimiter-color)}.jse-value.jse-number.svelte-rc6e9m{color:var(--jse-value-color-number)}.jse-value.jse-boolean.svelte-rc6e9m{color:var(--jse-value-color-boolean)}.jse-value.jse-null.svelte-rc6e9m{color:var(--jse-value-color-null)}.jse-value.jse-invalid.svelte-rc6e9m{color:var(--jse-text-color)}.jse-value.jse-url.svelte-rc6e9m{color:var(--jse-value-color-url);text-decoration:underline}.jse-enum-value.svelte-rc6e9m{background:var(--jse-hover-background-color);border:none;padding:0;font-family:inherit;font-size:inherit;cursor:pointer;outline:none}.jse-enum-value.jse-selected.svelte-rc6e9m{background:var(--jse-selection-background-color);color:inherit}.jse-enum-value.jse-value.svelte-rc6e9m:focus{color:var(--jse-text-color)}.jse-json-node.jse-selected .jse-enum-value.svelte-rc6e9m{background:transparent}");}function get_each_context(ctx,list,i){var child_ctx=ctx.slice();child_ctx[13]=list[i];return child_ctx;}// (50:2) {#each options as option}
function create_each_block(ctx){var option;var t_value=/*option*/ctx[13].text+"";var t;var option_value_value;return{c:function c(){option=element("option");t=text(t_value);option.__value=option_value_value=/*option*/ctx[13].value;option.value=option.__value;},m:function m(target,anchor){insert$2(target,option,anchor);append$1(option,t);},p:function p(ctx,dirty){if(dirty&/*options*/4&&t_value!==(t_value=/*option*/ctx[13].text+""))set_data(t,t_value);if(dirty&/*options*/4&&option_value_value!==(option_value_value=/*option*/ctx[13].value)){option.__value=option_value_value;option.value=option.__value;}},d:function d(detaching){if(detaching)detach(option);}};}function create_fragment(ctx){var select;var select_class_value;var mounted;var dispose;var each_value=/*options*/ctx[2];var each_blocks=[];for(var _i321=0;_i321<each_value.length;_i321+=1){each_blocks[_i321]=create_each_block(get_each_context(ctx,each_value,_i321));}return{c:function c(){select=element("select");for(var _i322=0;_i322<each_blocks.length;_i322+=1){each_blocks[_i322].c();}attr(select,"class",select_class_value=""+(null_to_empty("jse-enum-value ".concat(getValueClass(/*bindValue*/ctx[4],/*parser*/ctx[0])))+" svelte-rc6e9m"));if(/*bindValue*/ctx[4]===void 0)add_render_callback(function(){return(/*select_change_handler*/ctx[10].call(select));});toggle_class(select,"jse-selected",/*isSelected*/ctx[1]);},m:function m(target,anchor){insert$2(target,select,anchor);for(var _i323=0;_i323<each_blocks.length;_i323+=1){each_blocks[_i323].m(select,null);}select_option(select,/*bindValue*/ctx[4]);/*select_binding*/ctx[11](select);if(!mounted){dispose=[listen(select,"change",/*select_change_handler*/ctx[10]),listen(select,"change",/*handleSelect*/ctx[5]),listen(select,"mousedown",handleMouseDown)];mounted=true;}},p:function p(ctx,_ref182){var _ref183=_slicedToArray(_ref182,1),dirty=_ref183[0];if(dirty&/*options*/4){each_value=/*options*/ctx[2];var _i324;for(_i324=0;_i324<each_value.length;_i324+=1){var child_ctx=get_each_context(ctx,each_value,_i324);if(each_blocks[_i324]){each_blocks[_i324].p(child_ctx,dirty);}else{each_blocks[_i324]=create_each_block(child_ctx);each_blocks[_i324].c();each_blocks[_i324].m(select,null);}}for(;_i324<each_blocks.length;_i324+=1){each_blocks[_i324].d(1);}each_blocks.length=each_value.length;}if(dirty&/*bindValue, parser*/17&&select_class_value!==(select_class_value=""+(null_to_empty("jse-enum-value ".concat(getValueClass(/*bindValue*/ctx[4],/*parser*/ctx[0])))+" svelte-rc6e9m"))){attr(select,"class",select_class_value);}if(dirty&/*bindValue*/16){select_option(select,/*bindValue*/ctx[4]);}if(dirty&/*bindValue, parser, isSelected*/19){toggle_class(select,"jse-selected",/*isSelected*/ctx[1]);}},i:noop$2,o:noop$2,d:function d(detaching){if(detaching)detach(select);destroy_each(each_blocks,detaching);/*select_binding*/ctx[11](null);mounted=false;run_all(dispose);}};}function handleMouseDown(event){// stop propagation to prevent selecting the whole line
event.stopPropagation();}function instance($$self,$$props,$$invalidate){var path=$$props.path;var value=$$props.value;var parser=$$props.parser;var readOnly=$$props.readOnly;var isSelected=$$props.isSelected;var onPatch=$$props.onPatch;var options=$$props.options;var refSelect;var bindValue=value;function applyFocus(isSelected){if(isSelected){if(refSelect){refSelect.focus();}}}function handleSelect(event){event.stopPropagation();if(readOnly){return;}onPatch([{op:'replace',path:immutableJSONPatch.exports.compileJSONPointer(path),value:bindValue}]);}function select_change_handler(){bindValue=select_value(this);$$invalidate(4,bindValue),$$invalidate(7,value);}function select_binding($$value){binding_callbacks[$$value?'unshift':'push'](function(){refSelect=$$value;$$invalidate(3,refSelect);$$invalidate(2,options);});}$$self.$$set=function($$props){if('path'in $$props)$$invalidate(6,path=$$props.path);if('value'in $$props)$$invalidate(7,value=$$props.value);if('parser'in $$props)$$invalidate(0,parser=$$props.parser);if('readOnly'in $$props)$$invalidate(8,readOnly=$$props.readOnly);if('isSelected'in $$props)$$invalidate(1,isSelected=$$props.isSelected);if('onPatch'in $$props)$$invalidate(9,onPatch=$$props.onPatch);if('options'in $$props)$$invalidate(2,options=$$props.options);};$$self.$$.update=function(){if($$self.$$.dirty&/*value*/128){$$invalidate(4,bindValue=value);}if($$self.$$.dirty&/*isSelected*/2){applyFocus(isSelected);}};return[parser,isSelected,options,refSelect,bindValue,handleSelect,path,value,readOnly,onPatch,select_change_handler,select_binding];}var EnumValue=/*#__PURE__*/function(_SvelteComponent59){_inherits(EnumValue,_SvelteComponent59);var _super100=_createSuper(EnumValue);function EnumValue(options){var _this154;_classCallCheck(this,EnumValue);_this154=_super100.call(this);init(_assertThisInitialized(_this154),options,instance,create_fragment,not_equal,{path:6,value:7,parser:0,readOnly:8,isSelected:1,onPatch:9,options:2},add_css);return _this154;}return _createClass(EnumValue);}(SvelteComponent);var EnumValue$1=EnumValue;/**
 * Find enum options for given path in a JSONSchema
 * @param {JSON} schema
 * @param {JSON} [schemaDefinitions=undefined]
 * @param {Path} path
 * @returns {Array<any> | null}
 */exports.EnumValue=EnumValue$1;function getJSONSchemaOptions(schema,schemaDefinitions,path){var schemaForPath=findSchema(schema,schemaDefinitions||{},path);return schemaForPath?findEnum(schemaForPath):null;}/**
 * find an enum definition in a JSON schema, as property `enum` or inside
 * one of the schemas composites (`oneOf`, `anyOf`, `allOf`)
 *
 * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js
 *
 * @param  {Object} schema
 * @return {Array | null} Returns the enum when found, null otherwise.
 * @private
 */function findEnum(schema){if(schema["enum"]){return schema["enum"];}var composite=schema.oneOf||schema.anyOf||schema.allOf;if(composite){var match=composite.filter(function(entry){return entry["enum"];});if(match.length>0){return match[0]["enum"];}}return null;}/**
 * Return the part of a JSON schema matching given path.
 *
 * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js
 *
 * @param {JSON} topLevelSchema
 * @param {JSON} schemaDefinitions
 * @param {Array.<string | number>} path
 * @param {Object} currentSchema
 * @return {Object | null}
 * @private
 */function findSchema(topLevelSchema,schemaDefinitions,path){var currentSchema=arguments.length>3&&arguments[3]!==undefined?arguments[3]:topLevelSchema;var nextPath=path.slice(1,path.length);var nextKey=path[0];var possibleSchemas=[currentSchema];for(var _i325=0,_arr4=[currentSchema.oneOf,currentSchema.anyOf,currentSchema.allOf];_i325<_arr4.length;_i325++){var subSchemas=_arr4[_i325];if(Array.isArray(subSchemas)){possibleSchemas=possibleSchemas.concat(subSchemas);}}var _iterator216=_createForOfIteratorHelper(possibleSchemas),_step216;try{for(_iterator216.s();!(_step216=_iterator216.n()).done;){var schema=_step216.value;currentSchema=schema;if('$ref'in currentSchema&&typeof currentSchema.$ref==='string'){var _ref$match;var ref=currentSchema.$ref;if(ref in schemaDefinitions){currentSchema=schemaDefinitions[ref];}else if(ref.startsWith('#/')){var refPath=ref.substring(2).split('/');currentSchema=topLevelSchema;var _iterator217=_createForOfIteratorHelper(refPath),_step217;try{for(_iterator217.s();!(_step217=_iterator217.n()).done;){var segment=_step217.value;if(segment in currentSchema){currentSchema=currentSchema[segment];}else{throw Error("Unable to resovle reference ".concat(ref));}}}catch(err){_iterator217.e(err);}finally{_iterator217.f();}}else if(((_ref$match=ref.match(/#\//g))===null||_ref$match===void 0?void 0:_ref$match.length)===1){var _ref$split=ref.split('#/'),_ref$split2=_slicedToArray(_ref$split,2),schemaUrl=_ref$split2[0],relativePath=_ref$split2[1];if(schemaUrl in schemaDefinitions){var referencedSchema=schemaDefinitions[schemaUrl];var reference={$ref:'#/'.concat(relativePath)};var auxNextPath=[];auxNextPath.push(nextKey);if(nextPath.length>0){auxNextPath.push.apply(auxNextPath,_toConsumableArray2(nextPath));}return findSchema(referencedSchema,schemaDefinitions,auxNextPath,reference);}else{throw Error("Unable to resolve reference ".concat(ref));}}else{throw Error("Unable to resolve reference ".concat(ref));}}// We have no more path segments to resolve, return the currently found schema
// We do this here, after resolving references, in case of the leaf schema beeing a reference
if(nextKey===undefined){return currentSchema;}if(typeof nextKey==='string'){if(_typeof2(currentSchema.properties)==='object'&&currentSchema.properties!==null&&nextKey in currentSchema.properties){currentSchema=currentSchema.properties[nextKey];return findSchema(topLevelSchema,schemaDefinitions,nextPath,currentSchema);}if(_typeof2(currentSchema.patternProperties)==='object'&&currentSchema.patternProperties!==null){for(var prop in currentSchema.patternProperties){if(nextKey.match(prop)){currentSchema=currentSchema.patternProperties[prop];return findSchema(topLevelSchema,schemaDefinitions,nextPath,currentSchema);}}}if(_typeof2(currentSchema.additionalProperties)==='object'){currentSchema=currentSchema.additionalProperties;return findSchema(topLevelSchema,schemaDefinitions,nextPath,currentSchema);}continue;}if(typeof nextKey==='number'&&_typeof2(currentSchema.items)==='object'&&currentSchema.items!==null){currentSchema=currentSchema.items;return findSchema(topLevelSchema,schemaDefinitions,nextPath,currentSchema);}}}catch(err){_iterator216.e(err);}finally{_iterator216.f();}return null;}/**
 * Search the JSON schema for enums defined at given props.path. If found,
 * return an EnumValue renderer. If not found, return null. In that case you
 * have to fallback on the default valueRender function
 */function renderJSONSchemaEnum(props,schema,schemaDefinitions){var enumValues=getJSONSchemaOptions(schema,schemaDefinitions,props.path);if(enumValues){var value=props.value,path=props.path,_readOnly=props.readOnly,onPatch=props.onPatch,isSelected=props.isSelected;var options=enumValues.map(function(enumValue){return{value:enumValue,text:enumValue};});// make sure the current value is also added as one of the options,
// else it would look as if the first option is the current value
var optionsWithValue=enumValues.includes(props.value)?options:[{value:value,text:value}].concat(options);return[{component:EnumValue$1,props:{value:value,path:path,readOnly:_readOnly,onPatch:onPatch,isSelected:isSelected,options:optionsWithValue}}];}return null;}function commonjsRequire(path){throw new Error('Could not dynamically require "'+path+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');}var ajv7_min={exports:{}};/* ajv 8.11.0 (ajv7): Another JSON Schema Validator */(function(module,exports){!function(e){module.exports=e();}(function(){return function e(t,r,o){function s(n,i){if(!r[n]){if(!t[n]){var c="function"==typeof commonjsRequire&&commonjsRequire;if(!i&&c)return c(n,!0);if(a)return a(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l;}var d=r[n]={exports:{}};t[n][0].call(d.exports,function(e){return s(t[n][1][e]||e);},d,d.exports,e,t,r,o);}return r[n].exports;}for(var a="function"==typeof commonjsRequire&&commonjsRequire,n=0;n<o.length;n++){s(o[n]);}return s;}({1:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.regexpCode=r.getEsmExportName=r.getProperty=r.safeStringify=r.stringify=r.strConcat=r.addCodeArg=r.str=r._=r.nil=r._Code=r.Name=r.IDENTIFIER=r._CodeOrName=void 0;var o=/*#__PURE__*/_createClass(function o(){_classCallCheck(this,o);});r._CodeOrName=o,r.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var s=/*#__PURE__*/function(_o){_inherits(s,_o);var _super101=_createSuper(s);function s(e){var _this155;_classCallCheck(this,s);if(_this155=_super101.call(this),!r.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");_this155.str=e;return _possibleConstructorReturn(_this155);}_createClass(s,[{key:"toString",value:function toString(){return this.str;}},{key:"emptyStr",value:function emptyStr(){return!1;}},{key:"names",get:function get(){return _defineProperty2({},this.str,1);}}]);return s;}(o);r.Name=s;var a=/*#__PURE__*/function(_o2){_inherits(a,_o2);var _super102=_createSuper(a);function a(e){var _this156;_classCallCheck(this,a);_this156=_super102.call(this),_this156._items="string"==typeof e?[e]:e;return _this156;}_createClass(a,[{key:"toString",value:function toString(){return this.str;}},{key:"emptyStr",value:function emptyStr(){if(this._items.length>1)return!1;var e=this._items[0];return""===e||'""'===e;}},{key:"str",get:function get(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce(function(e,t){return"".concat(e).concat(t);},"");}},{key:"names",get:function get(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce(function(e,t){return t instanceof s&&(e[t.str]=(e[t.str]||0)+1),e;},{});}}]);return a;}(o);function n(e){var r=[e[0]];var o=0;for(var _len12=arguments.length,t=new Array(_len12>1?_len12-1:0),_key14=1;_key14<_len12;_key14++){t[_key14-1]=arguments[_key14];}for(;o<t.length;){l(r,t[o]),r.push(e[++o]);}return new a(r);}r._Code=a,r.nil=new a(""),r._=n;var i=new a("+");function c(e){var r=[u(e[0])];var o=0;for(var _len13=arguments.length,t=new Array(_len13>1?_len13-1:0),_key15=1;_key15<_len13;_key15++){t[_key15-1]=arguments[_key15];}for(;o<t.length;){r.push(i),l(r,t[o]),r.push(i,u(e[++o]));}return function(e){var t=1;for(;t<e.length-1;){if(e[t]===i){var _r15=d(e[t-1],e[t+1]);if(void 0!==_r15){e.splice(t-1,3,_r15);continue;}e[t++]="+";}t++;}}(r),new a(r);}function l(e,t){var r;t instanceof a?e.push.apply(e,_toConsumableArray2(t._items)):e.push(t instanceof s?t:"number"==typeof(r=t)||"boolean"==typeof r||null===r?r:u(Array.isArray(r)?r.join(","):r));}function d(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof s||'"'!==e[e.length-1])return;return"string"!=typeof t?"".concat(e.slice(0,-1)).concat(t,"\""):'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0;}return"string"!=typeof t||'"'!==t[0]||e instanceof s?void 0:"\"".concat(e).concat(t.slice(1));}function u(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");}r.str=c,r.addCodeArg=l,r.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:c(_templateObject||(_templateObject=_taggedTemplateLiteral(["","",""])),e,t);},r.stringify=function(e){return new a(u(e));},r.safeStringify=u,r.getProperty=function(e){return"string"==typeof e&&r.IDENTIFIER.test(e)?new a(".".concat(e)):n(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["[","]"])),e);},r.getEsmExportName=function(e){if("string"==typeof e&&r.IDENTIFIER.test(e))return new a("".concat(e));throw new Error("CodeGen: invalid export name: ".concat(e,", use explicit $id name mapping"));},r.regexpCode=function(e){return new a(e.toString());};},{}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.or=r.and=r.not=r.CodeGen=r.operators=r.varKinds=r.ValueScopeName=r.ValueScope=r.Scope=r.Name=r.regexpCode=r.stringify=r.getProperty=r.nil=r.strConcat=r.str=r._=void 0;var o=e("./code"),s=e("./scope");var a=e("./code");Object.defineProperty(r,"_",{enumerable:!0,get:function get(){return a._;}}),Object.defineProperty(r,"str",{enumerable:!0,get:function get(){return a.str;}}),Object.defineProperty(r,"strConcat",{enumerable:!0,get:function get(){return a.strConcat;}}),Object.defineProperty(r,"nil",{enumerable:!0,get:function get(){return a.nil;}}),Object.defineProperty(r,"getProperty",{enumerable:!0,get:function get(){return a.getProperty;}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function get(){return a.stringify;}}),Object.defineProperty(r,"regexpCode",{enumerable:!0,get:function get(){return a.regexpCode;}}),Object.defineProperty(r,"Name",{enumerable:!0,get:function get(){return a.Name;}});var n=e("./scope");Object.defineProperty(r,"Scope",{enumerable:!0,get:function get(){return n.Scope;}}),Object.defineProperty(r,"ValueScope",{enumerable:!0,get:function get(){return n.ValueScope;}}),Object.defineProperty(r,"ValueScopeName",{enumerable:!0,get:function get(){return n.ValueScopeName;}}),Object.defineProperty(r,"varKinds",{enumerable:!0,get:function get(){return n.varKinds;}}),r.operators={GT:new o._Code(">"),GTE:new o._Code(">="),LT:new o._Code("<"),LTE:new o._Code("<="),EQ:new o._Code("==="),NEQ:new o._Code("!=="),NOT:new o._Code("!"),OR:new o._Code("||"),AND:new o._Code("&&"),ADD:new o._Code("+")};var i=/*#__PURE__*/function(){function i(){_classCallCheck(this,i);}_createClass(i,[{key:"optimizeNodes",value:function optimizeNodes(){return this;}},{key:"optimizeNames",value:function optimizeNames(e,t){return this;}}]);return i;}();var c=/*#__PURE__*/function(_i326){_inherits(c,_i326);var _super103=_createSuper(c);function c(e,t,r){var _this157;_classCallCheck(this,c);_this157=_super103.call(this),_this157.varKind=e,_this157.name=t,_this157.rhs=r;return _this157;}_createClass(c,[{key:"render",value:function render(_ref185){var e=_ref185.es5,t=_ref185._n;return"".concat(e?s.varKinds["var"]:this.varKind," ").concat(this.name).concat(void 0===this.rhs?"":" = ".concat(this.rhs),";")+t;}},{key:"optimizeNames",value:function optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=x(this.rhs,e,t)),this;}},{key:"names",get:function get(){return this.rhs instanceof o._CodeOrName?this.rhs.names:{};}}]);return c;}(i);var l=/*#__PURE__*/function(_i327){_inherits(l,_i327);var _super104=_createSuper(l);function l(e,t,r){var _this158;_classCallCheck(this,l);_this158=_super104.call(this),_this158.lhs=e,_this158.rhs=t,_this158.sideEffects=r;return _this158;}_createClass(l,[{key:"render",value:function render(_ref186){var e=_ref186._n;return"".concat(this.lhs," = ").concat(this.rhs,";")+e;}},{key:"optimizeNames",value:function optimizeNames(e,t){if(!(this.lhs instanceof o.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=x(this.rhs,e,t),this;}},{key:"names",get:function get(){return O(this.lhs instanceof o.Name?{}:_objectSpread2({},this.lhs.names),this.rhs);}}]);return l;}(i);var d=/*#__PURE__*/function(_l4){_inherits(d,_l4);var _super105=_createSuper(d);function d(e,t,r,o){var _this159;_classCallCheck(this,d);_this159=_super105.call(this,e,r,o),_this159.op=t;return _this159;}_createClass(d,[{key:"render",value:function render(_ref187){var e=_ref187._n;return"".concat(this.lhs," ").concat(this.op,"= ").concat(this.rhs,";")+e;}}]);return d;}(l);var u=/*#__PURE__*/function(_i328){_inherits(u,_i328);var _super106=_createSuper(u);function u(e){var _this160;_classCallCheck(this,u);_this160=_super106.call(this),_this160.label=e,_this160.names={};return _this160;}_createClass(u,[{key:"render",value:function render(_ref188){var e=_ref188._n;return"".concat(this.label,":")+e;}}]);return u;}(i);var f=/*#__PURE__*/function(_i329){_inherits(f,_i329);var _super107=_createSuper(f);function f(e){var _this161;_classCallCheck(this,f);_this161=_super107.call(this),_this161.label=e,_this161.names={};return _this161;}_createClass(f,[{key:"render",value:function render(_ref189){var e=_ref189._n;return"break".concat(this.label?" ".concat(this.label):"",";")+e;}}]);return f;}(i);var p=/*#__PURE__*/function(_i330){_inherits(p,_i330);var _super108=_createSuper(p);function p(e){var _this162;_classCallCheck(this,p);_this162=_super108.call(this),_this162.error=e;return _this162;}_createClass(p,[{key:"render",value:function render(_ref190){var e=_ref190._n;return"throw ".concat(this.error,";")+e;}},{key:"names",get:function get(){return this.error.names;}}]);return p;}(i);var m=/*#__PURE__*/function(_i331){_inherits(m,_i331);var _super109=_createSuper(m);function m(e){var _this163;_classCallCheck(this,m);_this163=_super109.call(this),_this163.code=e;return _this163;}_createClass(m,[{key:"render",value:function render(_ref191){var e=_ref191._n;return"".concat(this.code,";")+e;}},{key:"optimizeNodes",value:function optimizeNodes(){return"".concat(this.code)?this:void 0;}},{key:"optimizeNames",value:function optimizeNames(e,t){return this.code=x(this.code,e,t),this;}},{key:"names",get:function get(){return this.code instanceof o._CodeOrName?this.code.names:{};}}]);return m;}(i);var h=/*#__PURE__*/function(_i332){_inherits(h,_i332);var _super110=_createSuper(h);function h(){var _this164;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,h);_this164=_super110.call(this),_this164.nodes=e;return _this164;}_createClass(h,[{key:"render",value:function render(e){return this.nodes.reduce(function(t,r){return t+r.render(e);},"");}},{key:"optimizeNodes",value:function optimizeNodes(){var e=this.nodes;var t=e.length;for(;t--;){var _r16=e[t].optimizeNodes();Array.isArray(_r16)?e.splice.apply(e,[t,1].concat(_toConsumableArray2(_r16))):_r16?e[t]=_r16:e.splice(t,1);}return e.length>0?this:void 0;}},{key:"optimizeNames",value:function optimizeNames(e,t){var r=this.nodes;var o=r.length;for(;o--;){var _s3=r[o];_s3.optimizeNames(e,t)||(T(e,_s3.names),r.splice(o,1));}return r.length>0?this:void 0;}},{key:"names",get:function get(){return this.nodes.reduce(function(e,t){return C(e,t.names);},{});}}]);return h;}(i);var y=/*#__PURE__*/function(_h){_inherits(y,_h);var _super111=_createSuper(y);function y(){_classCallCheck(this,y);return _super111.apply(this,arguments);}_createClass(y,[{key:"render",value:function render(e){return"{"+e._n+_get(_getPrototypeOf(y.prototype),"render",this).call(this,e)+"}"+e._n;}}]);return y;}(h);var v=/*#__PURE__*/function(_h2){_inherits(v,_h2);var _super112=_createSuper(v);function v(){_classCallCheck(this,v);return _super112.apply(this,arguments);}return _createClass(v);}(h);var g=/*#__PURE__*/function(_y){_inherits(g,_y);var _super113=_createSuper(g);function g(){_classCallCheck(this,g);return _super113.apply(this,arguments);}return _createClass(g);}(y);g.kind="else";var $=/*#__PURE__*/function(_y2){_inherits($,_y2);var _super114=_createSuper($);function $(e,t){var _this165;_classCallCheck(this,$);_this165=_super114.call(this,t),_this165.condition=e;return _this165;}_createClass($,[{key:"render",value:function render(e){var t="if(".concat(this.condition,")")+_get(_getPrototypeOf($.prototype),"render",this).call(this,e);return this["else"]&&(t+="else "+this["else"].render(e)),t;}},{key:"optimizeNodes",value:function optimizeNodes(){_get(_getPrototypeOf($.prototype),"optimizeNodes",this).call(this);var e=this.condition;if(!0===e)return this.nodes;var t=this["else"];if(t){var _e3=t.optimizeNodes();t=this["else"]=Array.isArray(_e3)?new g(_e3):_e3;}return t?!1===e?t instanceof $?t:t.nodes:this.nodes.length?this:new $(I(e),t instanceof $?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0;}},{key:"optimizeNames",value:function optimizeNames(e,t){var r;if(this["else"]=null===(r=this["else"])||void 0===r?void 0:r.optimizeNames(e,t),_get(_getPrototypeOf($.prototype),"optimizeNames",this).call(this,e,t)||this["else"])return this.condition=x(this.condition,e,t),this;}},{key:"names",get:function get(){var e=_get(_getPrototypeOf($.prototype),"names",this);return O(e,this.condition),this["else"]&&C(e,this["else"].names),e;}}]);return $;}(y);$.kind="if";var _=/*#__PURE__*/function(_y3){_inherits(_,_y3);var _super115=_createSuper(_);function _(){_classCallCheck(this,_);return _super115.apply(this,arguments);}return _createClass(_);}(y);_.kind="for";var w=/*#__PURE__*/function(_ref192){_inherits(w,_ref192);var _super116=_createSuper(w);function w(e){var _this166;_classCallCheck(this,w);_this166=_super116.call(this),_this166.iteration=e;return _this166;}_createClass(w,[{key:"render",value:function render(e){return"for(".concat(this.iteration,")")+_get(_getPrototypeOf(w.prototype),"render",this).call(this,e);}},{key:"optimizeNames",value:function optimizeNames(e,t){if(_get(_getPrototypeOf(w.prototype),"optimizeNames",this).call(this,e,t))return this.iteration=x(this.iteration,e,t),this;}},{key:"names",get:function get(){return C(_get(_getPrototypeOf(w.prototype),"names",this),this.iteration.names);}}]);return w;}(_);var b=/*#__PURE__*/function(_ref193){_inherits(b,_ref193);var _super117=_createSuper(b);function b(e,t,r,o){var _this167;_classCallCheck(this,b);_this167=_super117.call(this),_this167.varKind=e,_this167.name=t,_this167.from=r,_this167.to=o;return _this167;}_createClass(b,[{key:"render",value:function render(e){var t=e.es5?s.varKinds["var"]:this.varKind,r=this.name,o=this.from,a=this.to;return"for(".concat(t," ").concat(r,"=").concat(o,"; ").concat(r,"<").concat(a,"; ").concat(r,"++)")+_get(_getPrototypeOf(b.prototype),"render",this).call(this,e);}},{key:"names",get:function get(){var e=O(_get(_getPrototypeOf(b.prototype),"names",this),this.from);return O(e,this.to);}}]);return b;}(_);var E=/*#__PURE__*/function(_ref194){_inherits(E,_ref194);var _super118=_createSuper(E);function E(e,t,r,o){var _this168;_classCallCheck(this,E);_this168=_super118.call(this),_this168.loop=e,_this168.varKind=t,_this168.name=r,_this168.iterable=o;return _this168;}_createClass(E,[{key:"render",value:function render(e){return"for(".concat(this.varKind," ").concat(this.name," ").concat(this.loop," ").concat(this.iterable,")")+_get(_getPrototypeOf(E.prototype),"render",this).call(this,e);}},{key:"optimizeNames",value:function optimizeNames(e,t){if(_get(_getPrototypeOf(E.prototype),"optimizeNames",this).call(this,e,t))return this.iterable=x(this.iterable,e,t),this;}},{key:"names",get:function get(){return C(_get(_getPrototypeOf(E.prototype),"names",this),this.iterable.names);}}]);return E;}(_);var P=/*#__PURE__*/function(_y4){_inherits(P,_y4);var _super119=_createSuper(P);function P(e,t,r){var _this169;_classCallCheck(this,P);_this169=_super119.call(this),_this169.name=e,_this169.args=t,_this169.async=r;return _this169;}_createClass(P,[{key:"render",value:function render(e){return"".concat(this.async?"async ":"","function ").concat(this.name,"(").concat(this.args,")")+_get(_getPrototypeOf(P.prototype),"render",this).call(this,e);}}]);return P;}(y);P.kind="func";var S=/*#__PURE__*/function(_h3){_inherits(S,_h3);var _super120=_createSuper(S);function S(){_classCallCheck(this,S);return _super120.apply(this,arguments);}_createClass(S,[{key:"render",value:function render(e){return"return "+_get(_getPrototypeOf(S.prototype),"render",this).call(this,e);}}]);return S;}(h);S.kind="return";var N=/*#__PURE__*/function(_y5){_inherits(N,_y5);var _super121=_createSuper(N);function N(){_classCallCheck(this,N);return _super121.apply(this,arguments);}_createClass(N,[{key:"render",value:function render(e){var t="try"+_get(_getPrototypeOf(N.prototype),"render",this).call(this,e);return this["catch"]&&(t+=this["catch"].render(e)),this["finally"]&&(t+=this["finally"].render(e)),t;}},{key:"optimizeNodes",value:function optimizeNodes(){var e,t;return _get(_getPrototypeOf(N.prototype),"optimizeNodes",this).call(this),null===(e=this["catch"])||void 0===e||e.optimizeNodes(),null===(t=this["finally"])||void 0===t||t.optimizeNodes(),this;}},{key:"optimizeNames",value:function optimizeNames(e,t){var r,o;return _get(_getPrototypeOf(N.prototype),"optimizeNames",this).call(this,e,t),null===(r=this["catch"])||void 0===r||r.optimizeNames(e,t),null===(o=this["finally"])||void 0===o||o.optimizeNames(e,t),this;}},{key:"names",get:function get(){var e=_get(_getPrototypeOf(N.prototype),"names",this);return this["catch"]&&C(e,this["catch"].names),this["finally"]&&C(e,this["finally"].names),e;}}]);return N;}(y);var k=/*#__PURE__*/function(_y6){_inherits(k,_y6);var _super122=_createSuper(k);function k(e){var _this170;_classCallCheck(this,k);_this170=_super122.call(this),_this170.error=e;return _this170;}_createClass(k,[{key:"render",value:function render(e){return"catch(".concat(this.error,")")+_get(_getPrototypeOf(k.prototype),"render",this).call(this,e);}}]);return k;}(y);k.kind="catch";var j=/*#__PURE__*/function(_y7){_inherits(j,_y7);var _super123=_createSuper(j);function j(){_classCallCheck(this,j);return _super123.apply(this,arguments);}_createClass(j,[{key:"render",value:function render(e){return"finally"+_get(_getPrototypeOf(j.prototype),"render",this).call(this,e);}}]);return j;}(y);j.kind="finally";function C(e,t){for(var _r17 in t){e[_r17]=(e[_r17]||0)+(t[_r17]||0);}return e;}function O(e,t){return t instanceof o._CodeOrName?C(e,t.names):e;}function x(e,t,r){return e instanceof o.Name?a(e):(s=e)instanceof o._Code&&s._items.some(function(e){return e instanceof o.Name&&1===t[e.str]&&void 0!==r[e.str];})?new o._Code(e._items.reduce(function(e,t){return t instanceof o.Name&&(t=a(t)),t instanceof o._Code?e.push.apply(e,_toConsumableArray2(t._items)):e.push(t),e;},[])):e;var s;function a(e){var o=r[e.str];return void 0===o||1!==t[e.str]?e:(delete t[e.str],o);}}function T(e,t){for(var _r18 in t){e[_r18]=(e[_r18]||0)-(t[_r18]||0);}}function I(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:o._(_templateObject3||(_templateObject3=_taggedTemplateLiteral(["!",""])),M(e));}r.CodeGen=/*#__PURE__*/function(){function _class18(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,_class18);this._values={},this._blockStarts=[],this._constants={},this.opts=_objectSpread2(_objectSpread2({},t),{},{_n:t.lines?"\n":""}),this._extScope=e,this._scope=new s.Scope({parent:e}),this._nodes=[new v()];}_createClass(_class18,[{key:"toString",value:function toString(){return this._root.render(this.opts);}},{key:"name",value:function name(e){return this._scope.name(e);}},{key:"scopeName",value:function scopeName(e){return this._extScope.name(e);}},{key:"scopeValue",value:function scopeValue(e,t){var r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set())).add(r),r;}},{key:"getScopeValue",value:function getScopeValue(e,t){return this._extScope.getValue(e,t);}},{key:"scopeRefs",value:function scopeRefs(e){return this._extScope.scopeRefs(e,this._values);}},{key:"scopeCode",value:function scopeCode(){return this._extScope.scopeCode(this._values);}},{key:"_def",value:function _def(e,t,r,o){var s=this._scope.toName(t);return void 0!==r&&o&&(this._constants[s.str]=r),this._leafNode(new c(e,s,r)),s;}},{key:"const",value:function _const(e,t,r){return this._def(s.varKinds["const"],e,t,r);}},{key:"let",value:function _let(e,t,r){return this._def(s.varKinds["let"],e,t,r);}},{key:"var",value:function _var(e,t,r){return this._def(s.varKinds["var"],e,t,r);}},{key:"assign",value:function assign(e,t,r){return this._leafNode(new l(e,t,r));}},{key:"add",value:function add(e,t){return this._leafNode(new d(e,r.operators.ADD,t));}},{key:"code",value:function code(e){return"function"==typeof e?e():e!==o.nil&&this._leafNode(new m(e)),this;}},{key:"object",value:function object(){var t=["{"];for(var _len14=arguments.length,e=new Array(_len14),_key16=0;_key16<_len14;_key16++){e[_key16]=arguments[_key16];}for(var _i333=0,_e4=e;_i333<_e4.length;_i333++){var _e4$_i=_slicedToArray(_e4[_i333],2),_r19=_e4$_i[0],_s4=_e4$_i[1];t.length>1&&t.push(","),t.push(_r19),(_r19!==_s4||this.opts.es5)&&(t.push(":"),(0,o.addCodeArg)(t,_s4));}return t.push("}"),new o._Code(t);}},{key:"if",value:function _if(e,t,r){if(this._blockNode(new $(e)),t&&r)this.code(t)["else"]().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this;}},{key:"elseIf",value:function elseIf(e){return this._elseNode(new $(e));}},{key:"else",value:function _else(){return this._elseNode(new g());}},{key:"endIf",value:function endIf(){return this._endBlockNode($,g);}},{key:"_for",value:function _for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this;}},{key:"for",value:function _for(e,t){return this._for(new w(e),t);}},{key:"forRange",value:function forRange(e,t,r,o){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:this.opts.es5?s.varKinds["var"]:s.varKinds["let"];var n=this._scope.toName(e);return this._for(new b(a,n,t,r),function(){return o(n);});}},{key:"forOf",value:function forOf(e,t,r){var _this171=this;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:s.varKinds["const"];var n=this._scope.toName(e);if(this.opts.es5){var _e5=t instanceof o.Name?t:this["var"]("_arr",t);return this.forRange("_i",0,o._(_templateObject4||(_templateObject4=_taggedTemplateLiteral(["",".length"])),_e5),function(t){_this171["var"](n,o._(_templateObject5||(_templateObject5=_taggedTemplateLiteral(["","[","]"])),_e5,t)),r(n);});}return this._for(new E("of",a,n,t),function(){return r(n);});}},{key:"forIn",value:function forIn(e,t,r){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:this.opts.es5?s.varKinds["var"]:s.varKinds["const"];if(this.opts.ownProperties)return this.forOf(e,o._(_templateObject6||(_templateObject6=_taggedTemplateLiteral(["Object.keys(",")"])),t),r);var n=this._scope.toName(e);return this._for(new E("in",a,n,t),function(){return r(n);});}},{key:"endFor",value:function endFor(){return this._endBlockNode(_);}},{key:"label",value:function label(e){return this._leafNode(new u(e));}},{key:"break",value:function _break(e){return this._leafNode(new f(e));}},{key:"return",value:function _return(e){var t=new S();if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(S);}},{key:"try",value:function _try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');var o=new N();if(this._blockNode(o),this.code(e),t){var _e6=this.name("e");this._currNode=o["catch"]=new k(_e6),t(_e6);}return r&&(this._currNode=o["finally"]=new j(),this.code(r)),this._endBlockNode(k,j);}},{key:"throw",value:function _throw(e){return this._leafNode(new p(e));}},{key:"block",value:function block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this;}},{key:"endBlock",value:function endBlock(e){var t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");var r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error("CodeGen: wrong number of nodes: ".concat(r," vs ").concat(e," expected"));return this._nodes.length=t,this;}},{key:"func",value:function func(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:o.nil;var r=arguments.length>2?arguments[2]:undefined;var s=arguments.length>3?arguments[3]:undefined;return this._blockNode(new P(e,t,r)),s&&this.code(s).endFunc(),this;}},{key:"endFunc",value:function endFunc(){return this._endBlockNode(P);}},{key:"optimize",value:function optimize(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;for(;e-->0;){this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants);}}},{key:"_leafNode",value:function _leafNode(e){return this._currNode.nodes.push(e),this;}},{key:"_blockNode",value:function _blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e);}},{key:"_endBlockNode",value:function _endBlockNode(e,t){var r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error("CodeGen: not in block \"".concat(t?"".concat(e.kind,"/").concat(t.kind):e.kind,"\""));}},{key:"_elseNode",value:function _elseNode(e){var t=this._currNode;if(!(t instanceof $))throw new Error('CodeGen: "else" without "if"');return this._currNode=t["else"]=e,this;}},{key:"_root",get:function get(){return this._nodes[0];}},{key:"_currNode",get:function get(){var e=this._nodes;return e[e.length-1];},set:function set(e){var t=this._nodes;t[t.length-1]=e;}}]);return _class18;}(),r.not=I;var R=A(r.operators.AND);r.and=function(){for(var _len15=arguments.length,e=new Array(_len15),_key17=0;_key17<_len15;_key17++){e[_key17]=arguments[_key17];}return e.reduce(R);};var D=A(r.operators.OR);function A(e){return function(t,r){return t===o.nil?r:r===o.nil?t:o._(_templateObject7||(_templateObject7=_taggedTemplateLiteral([""," "," ",""])),M(t),e,M(r));};}function M(e){return e instanceof o.Name?e:o._(_templateObject8||(_templateObject8=_taggedTemplateLiteral(["(",")"])),e);}r.or=function(){for(var _len16=arguments.length,e=new Array(_len16),_key18=0;_key18<_len16;_key18++){e[_key18]=arguments[_key18];}return e.reduce(D);};},{"./code":1,"./scope":3}],3:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ValueScope=r.ValueScopeName=r.Scope=r.varKinds=r.UsedValueState=void 0;var o=e("./code");var s=/*#__PURE__*/function(_Error){_inherits(s,_Error);var _super124=_createSuper(s);function s(e){var _this172;_classCallCheck(this,s);_this172=_super124.call(this,"CodeGen: \"code\" for ".concat(e," not defined")),_this172.value=e.value;return _this172;}return _createClass(s);}(/*#__PURE__*/_wrapNativeSuper(Error));var a;!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed";}(a=r.UsedValueState||(r.UsedValueState={})),r.varKinds={"const":new o.Name("const"),"let":new o.Name("let"),"var":new o.Name("var")};var n=/*#__PURE__*/function(){function n(){var _ref195=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=_ref195.prefixes,t=_ref195.parent;_classCallCheck(this,n);this._names={},this._prefixes=e,this._parent=t;}_createClass(n,[{key:"toName",value:function toName(e){return e instanceof o.Name?e:this.name(e);}},{key:"name",value:function name(e){return new o.Name(this._newName(e));}},{key:"_newName",value:function _newName(e){return"".concat(e).concat((this._names[e]||this._nameGroup(e)).index++);}},{key:"_nameGroup",value:function _nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error("CodeGen: prefix \"".concat(e,"\" is not allowed in this scope"));return this._names[e]={prefix:e,index:0};}}]);return n;}();r.Scope=n;var i=/*#__PURE__*/function(_o$Name){_inherits(i,_o$Name);var _super125=_createSuper(i);function i(e,t){var _this173;_classCallCheck(this,i);_this173=_super125.call(this,t),_this173.prefix=e;return _this173;}_createClass(i,[{key:"setValue",value:function setValue(e,_ref196){var t=_ref196.property,r=_ref196.itemIndex;this.value=e,this.scopePath=o._(_templateObject9||(_templateObject9=_taggedTemplateLiteral([".","[","]"])),new o.Name(t),r);}}]);return i;}(o.Name);r.ValueScopeName=i;var c=o._(_templateObject10||(_templateObject10=_taggedTemplateLiteral(["\n"],["\\n"])));r.ValueScope=/*#__PURE__*/function(_n2){_inherits(_class19,_n2);var _super126=_createSuper(_class19);function _class19(e){var _this174;_classCallCheck(this,_class19);_this174=_super126.call(this,e),_this174._values={},_this174._scope=e.scope,_this174.opts=_objectSpread2(_objectSpread2({},e),{},{_n:e.lines?c:o.nil});return _this174;}_createClass(_class19,[{key:"get",value:function get(){return this._scope;}},{key:"name",value:function name(e){return new i(e,this._newName(e));}},{key:"value",value:function value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");var o=this.toName(e),s=o.prefix,a=null!==(r=t.key)&&void 0!==r?r:t.ref;var n=this._values[s];if(n){var _e7=n.get(a);if(_e7)return _e7;}else n=this._values[s]=new Map();n.set(a,o);var i=this._scope[s]||(this._scope[s]=[]),c=i.length;return i[c]=t.ref,o.setValue(t,{property:s,itemIndex:c}),o;}},{key:"getValue",value:function getValue(e,t){var r=this._values[e];if(r)return r.get(t);}},{key:"scopeRefs",value:function scopeRefs(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._values;return this._reduceValues(t,function(t){if(void 0===t.scopePath)throw new Error("CodeGen: name \"".concat(t,"\" has no value"));return o._(_templateObject11||(_templateObject11=_taggedTemplateLiteral(["","",""])),e,t.scopePath);});}},{key:"scopeCode",value:function scopeCode(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._values;var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2?arguments[2]:undefined;return this._reduceValues(e,function(e){if(void 0===e.value)throw new Error("CodeGen: name \"".concat(e,"\" has no value"));return e.value.code;},t,r);}},{key:"_reduceValues",value:function _reduceValues(e,t){var _this175=this;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=arguments.length>3?arguments[3]:undefined;var c=o.nil;var _loop19=function _loop19(l){var d=e[l];if(!d)return"continue";var u=n[l]=n[l]||new Map();d.forEach(function(e){if(u.has(e))return;u.set(e,a.Started);var n=t(e);if(n){c=o._(_templateObject12||(_templateObject12=_taggedTemplateLiteral(["",""," "," = ",";",""])),c,_this175.opts.es5?r.varKinds["var"]:r.varKinds["const"],e,n,_this175.opts._n);}else{if(!(n=null==i?void 0:i(e)))throw new s(e);c=o._(_templateObject13||(_templateObject13=_taggedTemplateLiteral(["","","",""])),c,n,_this175.opts._n);}u.set(e,a.Completed);});};for(var l in e){var _ret5=_loop19(l);if(_ret5==="continue")continue;}return c;}}]);return _class19;}(n);},{"./code":1}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.extendErrors=r.resetErrorsCount=r.reportExtraError=r.reportError=r.keyword$DataError=r.keywordError=void 0;var o=e("./codegen"),s=e("./util"),a=e("./names");function n(e,t){var r=e["const"]("err",t);e["if"](o._(_templateObject14||(_templateObject14=_taggedTemplateLiteral([""," === null"])),a["default"].vErrors),function(){return e.assign(a["default"].vErrors,o._(_templateObject15||(_templateObject15=_taggedTemplateLiteral(["[","]"])),r));},o._(_templateObject16||(_templateObject16=_taggedTemplateLiteral(["",".push(",")"])),a["default"].vErrors,r)),e.code(o._(_templateObject17||(_templateObject17=_taggedTemplateLiteral(["","++"])),a["default"].errors));}function i(e,t){var r=e.gen,s=e.validateName,a=e.schemaEnv;a.$async?r["throw"](o._(_templateObject18||(_templateObject18=_taggedTemplateLiteral(["new ","(",")"])),e.ValidationError,t)):(r.assign(o._(_templateObject19||(_templateObject19=_taggedTemplateLiteral(["",".errors"])),s),t),r["return"](!1));}r.keywordError={message:function message(_ref197){var e=_ref197.keyword;return o.str(_templateObject20||(_templateObject20=_taggedTemplateLiteral(["must pass \"","\" keyword validation"])),e);}},r.keyword$DataError={message:function message(_ref198){var e=_ref198.keyword,t=_ref198.schemaType;return t?o.str(_templateObject21||(_templateObject21=_taggedTemplateLiteral(["\"","\" keyword must be "," ($data)"])),e,t):o.str(_templateObject22||(_templateObject22=_taggedTemplateLiteral(["\"","\" keyword is invalid ($data)"])),e);}},r.reportError=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:r.keywordError;var s=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3?arguments[3]:undefined;var c=e.it,d=c.gen,u=c.compositeRule,f=c.allErrors,p=l(e,t,s);(null!=a?a:u||f)?n(d,p):i(c,o._(_templateObject23||(_templateObject23=_taggedTemplateLiteral(["[","]"])),p));},r.reportExtraError=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:r.keywordError;var o=arguments.length>2?arguments[2]:undefined;var s=e.it,c=s.gen,d=s.compositeRule,u=s.allErrors;n(c,l(e,t,o)),d||u||i(s,a["default"].vErrors);},r.resetErrorsCount=function(e,t){e.assign(a["default"].errors,t),e["if"](o._(_templateObject24||(_templateObject24=_taggedTemplateLiteral([""," !== null"])),a["default"].vErrors),function(){return e["if"](t,function(){return e.assign(o._(_templateObject25||(_templateObject25=_taggedTemplateLiteral(["",".length"])),a["default"].vErrors),t);},function(){return e.assign(a["default"].vErrors,null);});});},r.extendErrors=function(_ref199){var e=_ref199.gen,t=_ref199.keyword,r=_ref199.schemaValue,s=_ref199.data,n=_ref199.errsCount,i=_ref199.it;if(void 0===n)throw new Error("ajv implementation error");var c=e.name("err");e.forRange("i",n,a["default"].errors,function(n){e["const"](c,o._(_templateObject26||(_templateObject26=_taggedTemplateLiteral(["","[","]"])),a["default"].vErrors,n)),e["if"](o._(_templateObject27||(_templateObject27=_taggedTemplateLiteral(["",".instancePath === undefined"])),c),function(){return e.assign(o._(_templateObject28||(_templateObject28=_taggedTemplateLiteral(["",".instancePath"])),c),(0,o.strConcat)(a["default"].instancePath,i.errorPath));}),e.assign(o._(_templateObject29||(_templateObject29=_taggedTemplateLiteral(["",".schemaPath"])),c),o.str(_templateObject30||(_templateObject30=_taggedTemplateLiteral(["","/",""])),i.errSchemaPath,t)),i.opts.verbose&&(e.assign(o._(_templateObject31||(_templateObject31=_taggedTemplateLiteral(["",".schema"])),c),r),e.assign(o._(_templateObject32||(_templateObject32=_taggedTemplateLiteral(["",".data"])),c),s));});};var c={keyword:new o.Name("keyword"),schemaPath:new o.Name("schemaPath"),params:new o.Name("params"),propertyName:new o.Name("propertyName"),message:new o.Name("message"),schema:new o.Name("schema"),parentSchema:new o.Name("parentSchema")};function l(e,t,r){var s=e.it.createErrors;return!1===s?o._(_templateObject33||(_templateObject33=_taggedTemplateLiteral(["{}"]))):function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=e.gen,n=e.it,i=[d(n,r),u(e,r)];return function(e,_ref200,s){var t=_ref200.params,r=_ref200.message;var n=e.keyword,i=e.data,l=e.schemaValue,d=e.it,u=d.opts,f=d.propertyName,p=d.topSchemaRef,m=d.schemaPath;s.push([c.keyword,n],[c.params,"function"==typeof t?t(e):t||o._(_templateObject34||(_templateObject34=_taggedTemplateLiteral(["{}"])))]),u.messages&&s.push([c.message,"function"==typeof r?r(e):r]);u.verbose&&s.push([c.schema,l],[c.parentSchema,o._(_templateObject35||(_templateObject35=_taggedTemplateLiteral(["","",""])),p,m)],[a["default"].data,i]);f&&s.push([c.propertyName,f]);}(e,t,i),s.object.apply(s,i);}(e,t,r);}function d(_ref201,_ref202){var e=_ref201.errorPath;var t=_ref202.instancePath;var r=t?o.str(_templateObject36||(_templateObject36=_taggedTemplateLiteral(["","",""])),e,(0,s.getErrorPath)(t,s.Type.Str)):e;return[a["default"].instancePath,(0,o.strConcat)(a["default"].instancePath,r)];}function u(_ref203,_ref204){var e=_ref203.keyword,t=_ref203.it.errSchemaPath;var r=_ref204.schemaPath,a=_ref204.parentSchema;var n=a?t:o.str(_templateObject37||(_templateObject37=_taggedTemplateLiteral(["","/",""])),t,e);return r&&(n=o.str(_templateObject38||(_templateObject38=_taggedTemplateLiteral(["","",""])),n,(0,s.getErrorPath)(r,s.Type.Str))),[c.schemaPath,n];}},{"./codegen":2,"./names":6,"./util":10}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.resolveSchema=r.getCompilingSchema=r.resolveRef=r.compileSchema=r.SchemaEnv=void 0;var o=e("./codegen"),s=e("../runtime/validation_error"),a=e("./names"),n=e("./resolve"),i=e("./util"),c=e("./validate");var l=/*#__PURE__*/_createClass(function l(e){_classCallCheck(this,l);var t;var r;this.refs={},this.dynamicAnchors={},"object"==_typeof2(e.schema)&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,n.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={};});function d(e){var t=f.call(this,e);if(t)return t;var r=(0,n.getFullPath)(this.opts.uriResolver,e.root.baseId),_this$opts$code=this.opts.code,i=_this$opts$code.es5,l=_this$opts$code.lines,d=this.opts.ownProperties,u=new o.CodeGen(this.scope,{es5:i,lines:l,ownProperties:d});var p;e.$async&&(p=u.scopeValue("Error",{ref:s["default"],code:o._(_templateObject39||(_templateObject39=_taggedTemplateLiteral(["require(\"ajv/dist/runtime/validation_error\").default"])))}));var m=u.scopeName("validate");e.validateName=m;var h={gen:u,allErrors:this.opts.allErrors,data:a["default"].data,parentData:a["default"].parentData,parentDataProperty:a["default"].parentDataProperty,dataNames:[a["default"].data],dataPathArr:[o.nil],dataLevel:0,dataTypes:[],definedProperties:new Set(),topSchemaRef:u.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,o.stringify)(e.schema)}:{ref:e.schema}),validateName:m,ValidationError:p,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:o.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:o._(_templateObject40||(_templateObject40=_taggedTemplateLiteral(["\"\""]))),opts:this.opts,self:this};var y;try{this._compilations.add(e),(0,c.validateFunctionCode)(h),u.optimize(this.opts.code.optimize);var _t8=u.toString();y="".concat(u.scopeRefs(a["default"].scope),"return ").concat(_t8),this.opts.code.process&&(y=this.opts.code.process(y,e));var _r20=new Function("".concat(a["default"].self),"".concat(a["default"].scope),y)(this,this.scope.get());if(this.scope.value(m,{ref:_r20}),_r20.errors=null,_r20.schema=e.schema,_r20.schemaEnv=e,e.$async&&(_r20.$async=!0),!0===this.opts.code.source&&(_r20.source={validateName:m,validateCode:_t8,scopeValues:u._values}),this.opts.unevaluated){var _e8=h.props,_t9=h.items;_r20.evaluated={props:_e8 instanceof o.Name?void 0:_e8,items:_t9 instanceof o.Name?void 0:_t9,dynamicProps:_e8 instanceof o.Name,dynamicItems:_t9 instanceof o.Name},_r20.source&&(_r20.source.evaluated=(0,o.stringify)(_r20.evaluated));}return e.validate=_r20,e;}catch(t){throw delete e.validate,delete e.validateName,y&&this.logger.error("Error compiling schema, function code:",y),t;}finally{this._compilations["delete"](e);}}function u(e){return(0,n.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:d.call(this,e);}function f(e){var _iterator218=_createForOfIteratorHelper(this._compilations),_step218;try{for(_iterator218.s();!(_step218=_iterator218.n()).done;){var _o3=_step218.value;if((t=_o3).schema===(r=e).schema&&t.root===r.root&&t.baseId===r.baseId)return _o3;}}catch(err){_iterator218.e(err);}finally{_iterator218.f();}var t,r;}function p(e,t){var r;for(;"string"==typeof(r=this.refs[t]);){t=r;}return r||this.schemas[t]||m.call(this,e,t);}function m(e,t){var r=this.opts.uriResolver.parse(t),o=(0,n._getFullPath)(this.opts.uriResolver,r);var s=(0,n.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&o===s)return y.call(this,r,e);var a=(0,n.normalizeId)(o),i=this.refs[a]||this.schemas[a];if("string"==typeof i){var _t10=m.call(this,e,i);if("object"!=_typeof2(null==_t10?void 0:_t10.schema))return;return y.call(this,r,_t10);}if("object"==_typeof2(null==i?void 0:i.schema)){if(i.validate||d.call(this,i),a===(0,n.normalizeId)(t)){var _t11=i.schema,_r21=this.opts.schemaId,_o4=_t11[_r21];return _o4&&(s=(0,n.resolveUrl)(this.opts.uriResolver,s,_o4)),new l({schema:_t11,schemaId:_r21,root:e,baseId:s});}return y.call(this,r,i);}}r.SchemaEnv=l,r.compileSchema=d,r.resolveRef=function(e,t,r){var o;r=(0,n.resolveUrl)(this.opts.uriResolver,t,r);var s=e.refs[r];if(s)return s;var a=p.call(this,e,r);if(void 0===a){var _s5=null===(o=e.localRefs)||void 0===o?void 0:o[r],_n3=this.opts.schemaId;_s5&&(a=new l({schema:_s5,schemaId:_n3,root:e,baseId:t}));}return void 0!==a?e.refs[r]=u.call(this,a):void 0;},r.getCompilingSchema=f,r.resolveSchema=m;var h=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function y(e,_ref205){var t=_ref205.baseId,r=_ref205.schema,o=_ref205.root;var s;if("/"!==(null===(s=e.fragment)||void 0===s?void 0:s[0]))return;var _iterator219=_createForOfIteratorHelper(e.fragment.slice(1).split("/")),_step219;try{for(_iterator219.s();!(_step219=_iterator219.n()).done;){var _o5=_step219.value;if("boolean"==typeof r)return;var _e10=r[(0,i.unescapeFragment)(_o5)];if(void 0===_e10)return;var _s6="object"==_typeof2(r=_e10)&&r[this.opts.schemaId];!h.has(_o5)&&_s6&&(t=(0,n.resolveUrl)(this.opts.uriResolver,t,_s6));}}catch(err){_iterator219.e(err);}finally{_iterator219.f();}var a;if("boolean"!=typeof r&&r.$ref&&!(0,i.schemaHasRulesButRef)(r,this.RULES)){var _e9=(0,n.resolveUrl)(this.opts.uriResolver,t,r.$ref);a=m.call(this,o,_e9);}var c=this.opts.schemaId;return a=a||new l({schema:r,schemaId:c,root:o,baseId:t}),a.schema!==a.root.schema?a:void 0;}},{"../runtime/validation_error":24,"./codegen":2,"./names":6,"./resolve":8,"./util":10,"./validate":15}],6:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./codegen"),s={data:new o.Name("data"),valCxt:new o.Name("valCxt"),instancePath:new o.Name("instancePath"),parentData:new o.Name("parentData"),parentDataProperty:new o.Name("parentDataProperty"),rootData:new o.Name("rootData"),dynamicAnchors:new o.Name("dynamicAnchors"),vErrors:new o.Name("vErrors"),errors:new o.Name("errors"),"this":new o.Name("this"),self:new o.Name("self"),scope:new o.Name("scope"),json:new o.Name("json"),jsonPos:new o.Name("jsonPos"),jsonLen:new o.Name("jsonLen"),jsonPart:new o.Name("jsonPart")};r["default"]=s;},{"./codegen":2}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./resolve");var s=/*#__PURE__*/function(_Error2){_inherits(s,_Error2);var _super127=_createSuper(s);function s(e,t,r,_s7){var _this176;_classCallCheck(this,s);_this176=_super127.call(this,_s7||"can't resolve reference ".concat(r," from id ").concat(t)),_this176.missingRef=(0,o.resolveUrl)(e,t,r),_this176.missingSchema=(0,o.normalizeId)((0,o.getFullPath)(e,_this176.missingRef));return _this176;}return _createClass(s);}(/*#__PURE__*/_wrapNativeSuper(Error));r["default"]=s;},{"./resolve":8}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSchemaRefs=r.resolveUrl=r.normalizeId=r._getFullPath=r.getFullPath=r.inlineRef=void 0;var o=e("./util"),s=e("fast-deep-equal"),a=e("json-schema-traverse"),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);r.inlineRef=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;return"boolean"==typeof e||(!0===t?!c(e):!!t&&l(e)<=t);};var i=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function c(e){for(var _t12 in e){if(i.has(_t12))return!0;var _r22=e[_t12];if(Array.isArray(_r22)&&_r22.some(c))return!0;if("object"==_typeof2(_r22)&&c(_r22))return!0;}return!1;}function l(e){var t=0;for(var _r23 in e){if("$ref"===_r23)return Infinity;if(t++,!n.has(_r23)&&("object"==_typeof2(e[_r23])&&(0,o.eachItem)(e[_r23],function(e){return t+=l(e);}),Infinity===t))return Infinity;}return t;}function d(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var r=arguments.length>2?arguments[2]:undefined;!1!==r&&(t=p(t));var o=e.parse(t);return u(e,o);}function u(e,t){return e.serialize(t).split("#")[0]+"#";}r.getFullPath=d,r._getFullPath=u;var f=/#\/?$/;function p(e){return e?e.replace(f,""):"";}r.normalizeId=p,r.resolveUrl=function(e,t,r){return r=p(r),e.resolve(t,r);};var m=/^[a-z_][-a-z0-9._]*$/i;r.getSchemaRefs=function(e,t){var _this177=this;if("boolean"==typeof e)return{};var _this$opts=this.opts,r=_this$opts.schemaId,o=_this$opts.uriResolver,n=p(e[r]||t),i={"":n},c=d(o,n,!1),l={},u=new Set();return a(e,{allKeys:!0},function(e,t,o,s){if(void 0===s)return;var a=c+t;var n=i[s];function d(t){if(t=p(n?(0,this.opts.uriResolver.resolve)(n,t):t),u.has(t))throw h(t);u.add(t);var r=this.refs[t];return"string"==typeof r&&(r=this.refs[r]),"object"==_typeof2(r)?f(e,r.schema,t):t!==p(a)&&("#"===t[0]?(f(e,l[t],t),l[t]=e):this.refs[t]=a),t;}function y(e){if("string"==typeof e){if(!m.test(e))throw new Error("invalid anchor \"".concat(e,"\""));d.call(this,"#".concat(e));}}"string"==typeof e[r]&&(n=d.call(_this177,e[r])),y.call(_this177,e.$anchor),y.call(_this177,e.$dynamicAnchor),i[t]=n;}),l;function f(e,t,r){if(void 0!==t&&!s(e,t))throw h(r);}function h(e){return new Error("reference \"".concat(e,"\" resolves to more than one schema"));}};},{"./util":10,"fast-deep-equal":63,"json-schema-traverse":64}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getRules=r.isJSONType=void 0;var o=new Set(["string","number","integer","boolean","null","object","array"]);r.isJSONType=function(e){return"string"==typeof e&&o.has(e);},r.getRules=function(){var e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:_objectSpread2(_objectSpread2({},e),{},{integer:!0,"boolean":!0,"null":!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}};};},{}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.checkStrictMode=r.getErrorPath=r.Type=r.useFunc=r.setEvaluated=r.evaluatedPropsToName=r.mergeEvaluated=r.eachItem=r.unescapeJsonPointer=r.escapeJsonPointer=r.escapeFragment=r.unescapeFragment=r.schemaRefOrVal=r.schemaHasRulesButRef=r.schemaHasRules=r.checkUnknownRules=r.alwaysValidSchema=r.toHash=void 0;var o=e("./codegen"),s=e("./codegen/code");function a(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e.schema;var r=e.opts,o=e.self;if(!r.strictSchema)return;if("boolean"==typeof t)return;var s=o.RULES.keywords;for(var _r24 in t){s[_r24]||m(e,"unknown keyword: \"".concat(_r24,"\""));}}function n(e,t){if("boolean"==typeof e)return!e;for(var _r25 in e){if(t[_r25])return!0;}return!1;}function i(e){return"number"==typeof e?"".concat(e):e.replace(/~/g,"~0").replace(/\//g,"~1");}function c(e){return e.replace(/~1/g,"/").replace(/~0/g,"~");}function l(_ref206){var e=_ref206.mergeNames,t=_ref206.mergeToName,r=_ref206.mergeValues,s=_ref206.resultToName;return function(a,n,i,c){var l=void 0===i?n:i instanceof o.Name?(n instanceof o.Name?e(a,n,i):t(a,n,i),i):n instanceof o.Name?(t(a,i,n),n):r(n,i);return c!==o.Name||l instanceof o.Name?l:s(a,l);};}function d(e,t){if(!0===t)return e["var"]("props",!0);var r=e["var"]("props",o._(_templateObject41||(_templateObject41=_taggedTemplateLiteral(["{}"]))));return void 0!==t&&u(e,r,t),r;}function u(e,t,r){Object.keys(r).forEach(function(r){return e.assign(o._(_templateObject42||(_templateObject42=_taggedTemplateLiteral(["","",""])),t,(0,o.getProperty)(r)),!0);});}r.toHash=function(e){var t={};var _iterator220=_createForOfIteratorHelper(e),_step220;try{for(_iterator220.s();!(_step220=_iterator220.n()).done;){var _r26=_step220.value;t[_r26]=!0;}}catch(err){_iterator220.e(err);}finally{_iterator220.f();}return t;},r.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(a(e,t),!n(t,e.self.RULES.all));},r.checkUnknownRules=a,r.schemaHasRules=n,r.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(var _r27 in e){if("$ref"!==_r27&&t.all[_r27])return!0;}return!1;},r.schemaRefOrVal=function(_ref207,r,s,a){var e=_ref207.topSchemaRef,t=_ref207.schemaPath;if(!a){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return o._(_templateObject43||(_templateObject43=_taggedTemplateLiteral(["",""])),r);}return o._(_templateObject44||(_templateObject44=_taggedTemplateLiteral(["","","",""])),e,t,(0,o.getProperty)(s));},r.unescapeFragment=function(e){return c(decodeURIComponent(e));},r.escapeFragment=function(e){return encodeURIComponent(i(e));},r.escapeJsonPointer=i,r.unescapeJsonPointer=c,r.eachItem=function(e,t){if(Array.isArray(e)){var _iterator221=_createForOfIteratorHelper(e),_step221;try{for(_iterator221.s();!(_step221=_iterator221.n()).done;){var _r28=_step221.value;t(_r28);}}catch(err){_iterator221.e(err);}finally{_iterator221.f();}}else t(e);},r.mergeEvaluated={props:l({mergeNames:function mergeNames(e,t,r){return e["if"](o._(_templateObject45||(_templateObject45=_taggedTemplateLiteral([""," !== true && "," !== undefined"])),r,t),function(){e["if"](o._(_templateObject46||(_templateObject46=_taggedTemplateLiteral([""," === true"])),t),function(){return e.assign(r,!0);},function(){return e.assign(r,o._(_templateObject47||(_templateObject47=_taggedTemplateLiteral([""," || {}"])),r)).code(o._(_templateObject48||(_templateObject48=_taggedTemplateLiteral(["Object.assign(",", ",")"])),r,t));});});},mergeToName:function mergeToName(e,t,r){return e["if"](o._(_templateObject49||(_templateObject49=_taggedTemplateLiteral([""," !== true"])),r),function(){!0===t?e.assign(r,!0):(e.assign(r,o._(_templateObject50||(_templateObject50=_taggedTemplateLiteral([""," || {}"])),r)),u(e,r,t));});},mergeValues:function mergeValues(e,t){return!0===e||_objectSpread2(_objectSpread2({},e),t);},resultToName:d}),items:l({mergeNames:function mergeNames(e,t,r){return e["if"](o._(_templateObject51||(_templateObject51=_taggedTemplateLiteral([""," !== true && "," !== undefined"])),r,t),function(){return e.assign(r,o._(_templateObject52||(_templateObject52=_taggedTemplateLiteral([""," === true ? true : "," > "," ? "," : ",""])),t,r,t,r,t));});},mergeToName:function mergeToName(e,t,r){return e["if"](o._(_templateObject53||(_templateObject53=_taggedTemplateLiteral([""," !== true"])),r),function(){return e.assign(r,!0===t||o._(_templateObject54||(_templateObject54=_taggedTemplateLiteral([""," > "," ? "," : ",""])),r,t,r,t));});},mergeValues:function mergeValues(e,t){return!0===e||Math.max(e,t);},resultToName:function resultToName(e,t){return e["var"]("items",t);}})},r.evaluatedPropsToName=d,r.setEvaluated=u;var f={};var p;function m(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.opts.strictSchema;if(r){if(t="strict mode: ".concat(t),!0===r)throw new Error(t);e.self.logger.warn(t);}}r.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:f[t.code]||(f[t.code]=new s._Code(t.code))});},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str";}(p=r.Type||(r.Type={})),r.getErrorPath=function(e,t,r){if(e instanceof o.Name){var _s8=t===p.Num;return r?_s8?o._(_templateObject55||(_templateObject55=_taggedTemplateLiteral(["\"[\" + "," + \"]\""])),e):o._(_templateObject56||(_templateObject56=_taggedTemplateLiteral(["\"['\" + "," + \"']\""])),e):_s8?o._(_templateObject57||(_templateObject57=_taggedTemplateLiteral(["\"/\" + ",""])),e):o._(_templateObject58||(_templateObject58=_taggedTemplateLiteral(["\"/\" + ",".replace(/~/g, \"~0\").replace(/\\//g, \"~1\")"],["\"/\" + ",".replace(/~/g, \"~0\").replace(/\\\\//g, \"~1\")"])),e);}return r?(0,o.getProperty)(e).toString():"/"+i(e);},r.checkStrictMode=m;},{"./codegen":2,"./codegen/code":1}],11:[function(e,t,r){function o(e,t){return t.rules.some(function(t){return s(e,t);});}function s(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition["implements"])||void 0===r?void 0:r.some(function(t){return void 0!==e[t];}));}Object.defineProperty(r,"__esModule",{value:!0}),r.shouldUseRule=r.shouldUseGroup=r.schemaHasRulesForType=void 0,r.schemaHasRulesForType=function(_ref208,r){var e=_ref208.schema,t=_ref208.self;var s=t.RULES.types[r];return s&&!0!==s&&o(e,s);},r.shouldUseGroup=o,r.shouldUseRule=s;},{}],12:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.boolOrEmptySchema=r.topBoolOrEmptySchema=void 0;var o=e("../errors"),s=e("../codegen"),a=e("../names"),n={message:"boolean schema is false"};function i(e,t){var r=e.gen,s=e.data;(0,o.reportError)({gen:r,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e},n,void 0,t);}r.topBoolOrEmptySchema=function(e){var t=e.gen,r=e.schema,o=e.validateName;!1===r?i(e,!1):"object"==_typeof2(r)&&!0===r.$async?t["return"](a["default"].data):(t.assign(s._(_templateObject59||(_templateObject59=_taggedTemplateLiteral(["",".errors"])),o),null),t["return"](!0));},r.boolOrEmptySchema=function(e,t){var r=e.gen,o=e.schema;!1===o?(r["var"](t,!1),i(e)):r["var"](t,!0);};},{"../codegen":2,"../errors":4,"../names":6}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.reportTypeError=r.checkDataTypes=r.checkDataType=r.coerceAndCheckDataType=r.getJSONTypes=r.getSchemaTypes=r.DataType=void 0;var o=e("../rules"),s=e("./applicability"),a=e("../errors"),n=e("../codegen"),i=e("../util");var c;function l(e){var t=Array.isArray(e)?e:e?[e]:[];if(t.every(o.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","));}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong";}(c=r.DataType||(r.DataType={})),r.getSchemaTypes=function(e){var t=l(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false");}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null");}return t;},r.getJSONTypes=l,r.coerceAndCheckDataType=function(e,t){var r=e.gen,o=e.data,a=e.opts,i=function(e,t){return t?e.filter(function(e){return d.has(e)||"array"===t&&"array"===e;}):[];}(t,a.coerceTypes),l=t.length>0&&!(0===i.length&&1===t.length&&(0,s.schemaHasRulesForType)(e,t[0]));if(l){var _s9=f(t,o,a.strictNumbers,c.Wrong);r["if"](_s9,function(){i.length?function(e,t,r){var o=e.gen,s=e.data,a=e.opts,i=o["let"]("dataType",n._(_templateObject60||(_templateObject60=_taggedTemplateLiteral(["typeof ",""])),s)),c=o["let"]("coerced",n._(_templateObject61||(_templateObject61=_taggedTemplateLiteral(["undefined"]))));"array"===a.coerceTypes&&o["if"](n._(_templateObject62||(_templateObject62=_taggedTemplateLiteral([""," == 'object' && Array.isArray(",") && ",".length == 1"])),i,s,s),function(){return o.assign(s,n._(_templateObject63||(_templateObject63=_taggedTemplateLiteral(["","[0]"])),s)).assign(i,n._(_templateObject64||(_templateObject64=_taggedTemplateLiteral(["typeof ",""])),s))["if"](f(t,s,a.strictNumbers),function(){return o.assign(c,s);});});o["if"](n._(_templateObject65||(_templateObject65=_taggedTemplateLiteral([""," !== undefined"])),c));var _iterator222=_createForOfIteratorHelper(r),_step222;try{for(_iterator222.s();!(_step222=_iterator222.n()).done;){var _e11=_step222.value;(d.has(_e11)||"array"===_e11&&"array"===a.coerceTypes)&&l(_e11);}}catch(err){_iterator222.e(err);}finally{_iterator222.f();}function l(e){switch(e){case"string":return void o.elseIf(n._(_templateObject66||(_templateObject66=_taggedTemplateLiteral([""," == \"number\" || "," == \"boolean\""])),i,i)).assign(c,n._(_templateObject67||(_templateObject67=_taggedTemplateLiteral(["\"\" + ",""])),s)).elseIf(n._(_templateObject68||(_templateObject68=_taggedTemplateLiteral([""," === null"])),s)).assign(c,n._(_templateObject69||(_templateObject69=_taggedTemplateLiteral(["\"\""]))));case"number":return void o.elseIf(n._(_templateObject70||(_templateObject70=_taggedTemplateLiteral([""," == \"boolean\" || "," === null\n              || ("," == \"string\" && "," && "," == +",")"])),i,s,i,s,s,s)).assign(c,n._(_templateObject71||(_templateObject71=_taggedTemplateLiteral(["+",""])),s));case"integer":return void o.elseIf(n._(_templateObject72||(_templateObject72=_taggedTemplateLiteral([""," === \"boolean\" || "," === null\n              || ("," === \"string\" && "," && "," == +"," && !("," % 1))"])),i,s,i,s,s,s,s)).assign(c,n._(_templateObject73||(_templateObject73=_taggedTemplateLiteral(["+",""])),s));case"boolean":return void o.elseIf(n._(_templateObject74||(_templateObject74=_taggedTemplateLiteral([""," === \"false\" || "," === 0 || "," === null"])),s,s,s)).assign(c,!1).elseIf(n._(_templateObject75||(_templateObject75=_taggedTemplateLiteral([""," === \"true\" || "," === 1"])),s,s)).assign(c,!0);case"null":return o.elseIf(n._(_templateObject76||(_templateObject76=_taggedTemplateLiteral([""," === \"\" || "," === 0 || "," === false"])),s,s,s)),void o.assign(c,null);case"array":o.elseIf(n._(_templateObject77||(_templateObject77=_taggedTemplateLiteral([""," === \"string\" || "," === \"number\"\n              || "," === \"boolean\" || "," === null"])),i,i,i,s)).assign(c,n._(_templateObject78||(_templateObject78=_taggedTemplateLiteral(["[","]"])),s));}}o["else"](),m(e),o.endIf(),o["if"](n._(_templateObject79||(_templateObject79=_taggedTemplateLiteral([""," !== undefined"])),c),function(){o.assign(s,c),function(_ref209,o){var e=_ref209.gen,t=_ref209.parentData,r=_ref209.parentDataProperty;e["if"](n._(_templateObject80||(_templateObject80=_taggedTemplateLiteral([""," !== undefined"])),t),function(){return e.assign(n._(_templateObject81||(_templateObject81=_taggedTemplateLiteral(["","[","]"])),t,r),o);});}(e,c);});}(e,t,i):m(e);});}return l;};var d=new Set(["string","number","integer","boolean","null"]);function u(e,t,r){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:c.Correct;var s=o===c.Correct?n.operators.EQ:n.operators.NEQ;var a;switch(e){case"null":return n._(_templateObject82||(_templateObject82=_taggedTemplateLiteral([""," "," null"])),t,s);case"array":a=n._(_templateObject83||(_templateObject83=_taggedTemplateLiteral(["Array.isArray(",")"])),t);break;case"object":a=n._(_templateObject84||(_templateObject84=_taggedTemplateLiteral([""," && typeof "," == \"object\" && !Array.isArray(",")"])),t,t,t);break;case"integer":a=i(n._(_templateObject85||(_templateObject85=_taggedTemplateLiteral(["!("," % 1) && !isNaN(",")"])),t,t));break;case"number":a=i();break;default:return n._(_templateObject86||(_templateObject86=_taggedTemplateLiteral(["typeof "," "," ",""])),t,s,e);}return o===c.Correct?a:(0,n.not)(a);function i(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:n.nil;return(0,n.and)(n._(_templateObject87||(_templateObject87=_taggedTemplateLiteral(["typeof "," == \"number\""])),t),e,r?n._(_templateObject88||(_templateObject88=_taggedTemplateLiteral(["isFinite(",")"])),t):n.nil);}}function f(e,t,r,o){if(1===e.length)return u(e[0],t,r,o);var s;var a=(0,i.toHash)(e);if(a.array&&a.object){var _e12=n._(_templateObject89||(_templateObject89=_taggedTemplateLiteral(["typeof "," != \"object\""])),t);s=a["null"]?_e12:n._(_templateObject90||(_templateObject90=_taggedTemplateLiteral(["!"," || ",""])),t,_e12),delete a["null"],delete a.array,delete a.object;}else s=n.nil;a.number&&delete a.integer;for(var _e13 in a){s=(0,n.and)(s,u(_e13,t,r,o));}return s;}r.checkDataType=u,r.checkDataTypes=f;var p={message:function message(_ref210){var e=_ref210.schema;return"must be ".concat(e);},params:function params(_ref211){var e=_ref211.schema,t=_ref211.schemaValue;return"string"==typeof e?n._(_templateObject91||(_templateObject91=_taggedTemplateLiteral(["{type: ","}"])),e):n._(_templateObject92||(_templateObject92=_taggedTemplateLiteral(["{type: ","}"])),t);}};function m(e){var t=function(e){var t=e.gen,r=e.data,o=e.schema,s=(0,i.schemaRefOrVal)(e,o,"type");return{gen:t,keyword:"type",data:r,schema:o.type,schemaCode:s,schemaValue:s,parentSchema:o,params:{},it:e};}(e);(0,a.reportError)(t,p);}r.reportTypeError=m;},{"../codegen":2,"../errors":4,"../rules":9,"../util":10,"./applicability":11}],14:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.assignDefaults=void 0;var o=e("../codegen"),s=e("../util");function a(e,t,r){var a=e.gen,n=e.compositeRule,i=e.data,c=e.opts;if(void 0===r)return;var l=o._(_templateObject93||(_templateObject93=_taggedTemplateLiteral(["","",""])),i,(0,o.getProperty)(t));if(n)return void(0,s.checkStrictMode)(e,"default is ignored for: ".concat(l));var d=o._(_templateObject94||(_templateObject94=_taggedTemplateLiteral([""," === undefined"])),l);"empty"===c.useDefaults&&(d=o._(_templateObject95||(_templateObject95=_taggedTemplateLiteral([""," || "," === null || "," === \"\""])),d,l,l)),a["if"](d,o._(_templateObject96||(_templateObject96=_taggedTemplateLiteral([""," = ",""])),l,(0,o.stringify)(r)));}r.assignDefaults=function(e,t){var _e$schema=e.schema,r=_e$schema.properties,o=_e$schema.items;if("object"===t&&r)for(var _t13 in r){a(e,_t13,r[_t13]["default"]);}else"array"===t&&Array.isArray(o)&&o.forEach(function(t,r){return a(e,r,t["default"]);});};},{"../codegen":2,"../util":10}],15:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getData=r.KeywordCxt=r.validateFunctionCode=void 0;var o=e("./boolSchema"),s=e("./dataType"),a=e("./applicability"),n=e("./dataType"),i=e("./defaults"),c=e("./keyword"),l=e("./subschema"),d=e("../codegen"),u=e("../names"),f=e("../resolve"),p=e("../util"),m=e("../errors");function h(_ref212,a){var e=_ref212.gen,t=_ref212.validateName,r=_ref212.schema,o=_ref212.schemaEnv,s=_ref212.opts;s.code.es5?e.func(t,d._(_templateObject97||(_templateObject97=_taggedTemplateLiteral(["",", ",""])),u["default"].data,u["default"].valCxt),o.$async,function(){e.code(d._(_templateObject98||(_templateObject98=_taggedTemplateLiteral(["\"use strict\"; ",""])),y(r,s))),function(e,t){e["if"](u["default"].valCxt,function(){e["var"](u["default"].instancePath,d._(_templateObject99||(_templateObject99=_taggedTemplateLiteral(["",".",""])),u["default"].valCxt,u["default"].instancePath)),e["var"](u["default"].parentData,d._(_templateObject100||(_templateObject100=_taggedTemplateLiteral(["",".",""])),u["default"].valCxt,u["default"].parentData)),e["var"](u["default"].parentDataProperty,d._(_templateObject101||(_templateObject101=_taggedTemplateLiteral(["",".",""])),u["default"].valCxt,u["default"].parentDataProperty)),e["var"](u["default"].rootData,d._(_templateObject102||(_templateObject102=_taggedTemplateLiteral(["",".",""])),u["default"].valCxt,u["default"].rootData)),t.dynamicRef&&e["var"](u["default"].dynamicAnchors,d._(_templateObject103||(_templateObject103=_taggedTemplateLiteral(["",".",""])),u["default"].valCxt,u["default"].dynamicAnchors));},function(){e["var"](u["default"].instancePath,d._(_templateObject104||(_templateObject104=_taggedTemplateLiteral(["\"\""])))),e["var"](u["default"].parentData,d._(_templateObject105||(_templateObject105=_taggedTemplateLiteral(["undefined"])))),e["var"](u["default"].parentDataProperty,d._(_templateObject106||(_templateObject106=_taggedTemplateLiteral(["undefined"])))),e["var"](u["default"].rootData,u["default"].data),t.dynamicRef&&e["var"](u["default"].dynamicAnchors,d._(_templateObject107||(_templateObject107=_taggedTemplateLiteral(["{}"]))));});}(e,s),e.code(a);}):e.func(t,d._(_templateObject108||(_templateObject108=_taggedTemplateLiteral(["",", ",""])),u["default"].data,function(e){return d._(_templateObject109||(_templateObject109=_taggedTemplateLiteral(["{","=\"\", ",", ",", ","=","","}={}"])),u["default"].instancePath,u["default"].parentData,u["default"].parentDataProperty,u["default"].rootData,u["default"].data,e.dynamicRef?d._(_templateObject110||(_templateObject110=_taggedTemplateLiteral([", ","={}"])),u["default"].dynamicAnchors):d.nil);}(s)),o.$async,function(){return e.code(y(r,s)).code(a);});}function y(e,t){var r="object"==_typeof2(e)&&e[t.schemaId];return r&&(t.code.source||t.code.process)?d._(_templateObject111||(_templateObject111=_taggedTemplateLiteral(["/*# sourceURL="," */"])),r):d.nil;}function v(e,t){$(e)&&(_(e),g(e))?function(e,t){var r=e.schema,o=e.gen,s=e.opts;s.$comment&&r.$comment&&b(e);(function(e){var t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,f.resolveUrl)(e.opts.uriResolver,e.baseId,t));})(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema");}(e);var a=o["const"]("_errs",u["default"].errors);w(e,a),o["var"](t,d._(_templateObject112||(_templateObject112=_taggedTemplateLiteral([""," === ",""])),a,u["default"].errors));}(e,t):(0,o.boolOrEmptySchema)(e,t);}function g(_ref213){var e=_ref213.schema,t=_ref213.self;if("boolean"==typeof e)return!e;for(var _r29 in e){if(t.RULES.all[_r29])return!0;}return!1;}function $(e){return"boolean"!=typeof e.schema;}function _(e){(0,p.checkUnknownRules)(e),function(e){var t=e.schema,r=e.errSchemaPath,o=e.opts,s=e.self;t.$ref&&o.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn("$ref: keywords ignored in schema at path \"".concat(r,"\""));}(e);}function w(e,t){if(e.opts.jtd)return E(e,[],!1,t);var r=(0,s.getSchemaTypes)(e.schema);E(e,r,!(0,s.coerceAndCheckDataType)(e,r),t);}function b(_ref214){var e=_ref214.gen,t=_ref214.schemaEnv,r=_ref214.schema,o=_ref214.errSchemaPath,s=_ref214.opts;var a=r.$comment;if(!0===s.$comment)e.code(d._(_templateObject113||(_templateObject113=_taggedTemplateLiteral(["",".logger.log(",")"])),u["default"].self,a));else if("function"==typeof s.$comment){var _r30=d.str(_templateObject114||(_templateObject114=_taggedTemplateLiteral(["","/$comment"])),o),_s10=e.scopeValue("root",{ref:t.root});e.code(d._(_templateObject115||(_templateObject115=_taggedTemplateLiteral(["",".opts.$comment(",", ",", ",".schema)"])),u["default"].self,a,_r30,_s10));}}function E(e,t,r,o){var s=e.gen,i=e.schema,c=e.data,l=e.allErrors,f=e.opts,m=e.self,h=m.RULES;function y(p){(0,a.shouldUseGroup)(i,p)&&(p.type?(s["if"]((0,n.checkDataType)(p.type,c,f.strictNumbers)),P(e,p),1===t.length&&t[0]===p.type&&r&&(s["else"](),(0,n.reportTypeError)(e)),s.endIf()):P(e,p),l||s["if"](d._(_templateObject116||(_templateObject116=_taggedTemplateLiteral([""," === ",""])),u["default"].errors,o||0)));}!i.$ref||!f.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(i,h)?(f.jtd||function(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;(function(e,t){if(!t.length)return;if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(function(t){N(e.dataTypes,t)||k(e,"type \"".concat(t,"\" not allowed by context \"").concat(e.dataTypes.join(","),"\""));}),e.dataTypes=e.dataTypes.filter(function(e){return N(t,e);});})(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&k(e,"use allowUnionTypes to allow union type keyword");}(e,t);!function(e,t){var r=e.self.RULES.all;for(var _o6 in r){var _s11=r[_o6];if("object"==_typeof2(_s11)&&(0,a.shouldUseRule)(e.schema,_s11)){var _r31=_s11.definition.type;_r31.length&&!_r31.some(function(e){return S(t,e);})&&k(e,"missing type \"".concat(_r31.join(","),"\" for keyword \"").concat(_o6,"\""));}}}(e,e.dataTypes);}(e,t),s.block(function(){var _iterator223=_createForOfIteratorHelper(h.rules),_step223;try{for(_iterator223.s();!(_step223=_iterator223.n()).done;){var _e14=_step223.value;y(_e14);}}catch(err){_iterator223.e(err);}finally{_iterator223.f();}y(h.post);})):s.block(function(){return C(e,"$ref",h.all.$ref.definition);});}function P(e,t){var r=e.gen,o=e.schema,s=e.opts.useDefaults;s&&(0,i.assignDefaults)(e,t.type),r.block(function(){var _iterator224=_createForOfIteratorHelper(t.rules),_step224;try{for(_iterator224.s();!(_step224=_iterator224.n()).done;){var _r32=_step224.value;(0,a.shouldUseRule)(o,_r32)&&C(e,_r32.keyword,_r32.definition,t.type);}}catch(err){_iterator224.e(err);}finally{_iterator224.f();}});}function S(e,t){return e.includes(t)||"number"===t&&e.includes("integer");}function N(e,t){return e.includes(t)||"integer"===t&&e.includes("number");}function k(e,t){(0,p.checkStrictMode)(e,t+=" at \"".concat(e.schemaEnv.baseId+e.errSchemaPath,"\" (strictTypes)"),e.opts.strictTypes);}r.validateFunctionCode=function(e){$(e)&&(_(e),g(e))?function(e){var t=e.schema,r=e.opts,o=e.gen;h(e,function(){r.$comment&&t.$comment&&b(e),function(e){var t=e.schema,r=e.opts;void 0!==t["default"]&&r.useDefaults&&r.strictSchema&&(0,p.checkStrictMode)(e,"default is ignored in the schema root");}(e),o["let"](u["default"].vErrors,null),o["let"](u["default"].errors,0),r.unevaluated&&function(e){var t=e.gen,r=e.validateName;e.evaluated=t["const"]("evaluated",d._(_templateObject117||(_templateObject117=_taggedTemplateLiteral(["",".evaluated"])),r)),t["if"](d._(_templateObject118||(_templateObject118=_taggedTemplateLiteral(["",".dynamicProps"])),e.evaluated),function(){return t.assign(d._(_templateObject119||(_templateObject119=_taggedTemplateLiteral(["",".props"])),e.evaluated),d._(_templateObject120||(_templateObject120=_taggedTemplateLiteral(["undefined"]))));}),t["if"](d._(_templateObject121||(_templateObject121=_taggedTemplateLiteral(["",".dynamicItems"])),e.evaluated),function(){return t.assign(d._(_templateObject122||(_templateObject122=_taggedTemplateLiteral(["",".items"])),e.evaluated),d._(_templateObject123||(_templateObject123=_taggedTemplateLiteral(["undefined"]))));});}(e),w(e),function(e){var t=e.gen,r=e.schemaEnv,o=e.validateName,s=e.ValidationError,a=e.opts;r.$async?t["if"](d._(_templateObject124||(_templateObject124=_taggedTemplateLiteral([""," === 0"])),u["default"].errors),function(){return t["return"](u["default"].data);},function(){return t["throw"](d._(_templateObject125||(_templateObject125=_taggedTemplateLiteral(["new ","(",")"])),s,u["default"].vErrors));}):(t.assign(d._(_templateObject126||(_templateObject126=_taggedTemplateLiteral(["",".errors"])),o),u["default"].vErrors),a.unevaluated&&function(_ref215){var e=_ref215.gen,t=_ref215.evaluated,r=_ref215.props,o=_ref215.items;r instanceof d.Name&&e.assign(d._(_templateObject127||(_templateObject127=_taggedTemplateLiteral(["",".props"])),t),r);o instanceof d.Name&&e.assign(d._(_templateObject128||(_templateObject128=_taggedTemplateLiteral(["",".items"])),t),o);}(e),t["return"](d._(_templateObject129||(_templateObject129=_taggedTemplateLiteral([""," === 0"])),u["default"].errors)));}(e);});}(e):h(e,function(){return(0,o.topBoolOrEmptySchema)(e);});};var j=/*#__PURE__*/function(){function j(e,t,r){_classCallCheck(this,j);if((0,c.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,p.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen["const"]("vSchema",T(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,c.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error("".concat(r," value must be ").concat(JSON.stringify(t.schemaType)));("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen["const"]("_errs",u["default"].errors));}_createClass(j,[{key:"result",value:function result(e,t,r){this.failResult((0,d.not)(e),t,r);}},{key:"failResult",value:function failResult(e,t,r){this.gen["if"](e),r?r():this.error(),t?(this.gen["else"](),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen["else"]();}},{key:"pass",value:function pass(e,t){this.failResult((0,d.not)(e),void 0,t);}},{key:"fail",value:function fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen["if"](!1));this.gen["if"](e),this.error(),this.allErrors?this.gen.endIf():this.gen["else"]();}},{key:"fail$data",value:function fail$data(e){if(!this.$data)return this.fail(e);var t=this.schemaCode;this.fail(d._(_templateObject130||(_templateObject130=_taggedTemplateLiteral([""," !== undefined && (",")"])),t,(0,d.or)(this.invalid$data(),e)));}},{key:"error",value:function error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r);}},{key:"_error",value:function _error(e,t){(e?m.reportExtraError:m.reportError)(this,this.def.error,t);}},{key:"$dataError",value:function $dataError(){(0,m.reportError)(this,this.def.$dataError||m.keyword$DataError);}},{key:"reset",value:function reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,m.resetErrorsCount)(this.gen,this.errsCount);}},{key:"ok",value:function ok(e){this.allErrors||this.gen["if"](e);}},{key:"setParams",value:function setParams(e,t){t?Object.assign(this.params,e):this.params=e;}},{key:"block$data",value:function block$data(e,t){var _this178=this;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:d.nil;this.gen.block(function(){_this178.check$data(e,r),t();});}},{key:"check$data",value:function check$data(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:d.nil;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:d.nil;if(!this.$data)return;var r=this.gen,o=this.schemaCode,s=this.schemaType,a=this.def;r["if"]((0,d.or)(d._(_templateObject131||(_templateObject131=_taggedTemplateLiteral([""," === undefined"])),o),t)),e!==d.nil&&r.assign(e,!0),(s.length||a.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==d.nil&&r.assign(e,!1)),r["else"]();}},{key:"invalid$data",value:function invalid$data(){var e=this.gen,t=this.schemaCode,r=this.schemaType,o=this.def,s=this.it;return(0,d.or)(function(){if(r.length){if(!(t instanceof d.Name))throw new Error("ajv implementation error");var _e15=Array.isArray(r)?r:[r];return d._(_templateObject132||(_templateObject132=_taggedTemplateLiteral(["",""])),(0,n.checkDataTypes)(_e15,t,s.opts.strictNumbers,n.DataType.Wrong));}return d.nil;}(),function(){if(o.validateSchema){var _r33=e.scopeValue("validate$data",{ref:o.validateSchema});return d._(_templateObject133||(_templateObject133=_taggedTemplateLiteral(["!","(",")"])),_r33,t);}return d.nil;}());}},{key:"subschema",value:function subschema(e,t){var r=(0,l.getSubschema)(this.it,e);(0,l.extendSubschemaData)(r,this.it,e),(0,l.extendSubschemaMode)(r,e);var o=_objectSpread2(_objectSpread2(_objectSpread2({},this.it),r),{},{items:void 0,props:void 0});return v(o,t),o;}},{key:"mergeEvaluated",value:function mergeEvaluated(e,t){var r=this.it,o=this.gen;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=p.mergeEvaluated.props(o,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=p.mergeEvaluated.items(o,e.items,r.items,t)));}},{key:"mergeValidEvaluated",value:function mergeValidEvaluated(e,t){var _this179=this;var r=this.it,o=this.gen;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return o["if"](t,function(){return _this179.mergeEvaluated(e,d.Name);}),!0;}}]);return j;}();function C(e,t,r,o){var s=new j(e,r,t);"code"in r?r.code(s,o):s.$data&&r.validate?(0,c.funcKeywordCode)(s,r):"macro"in r?(0,c.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,c.funcKeywordCode)(s,r);}r.KeywordCxt=j;var O=/^\/(?:[^~]|~0|~1)*$/,x=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function T(e,_ref216){var t=_ref216.dataLevel,r=_ref216.dataNames,o=_ref216.dataPathArr;var s,a;if(""===e)return u["default"].rootData;if("/"===e[0]){if(!O.test(e))throw new Error("Invalid JSON-pointer: ".concat(e));s=e,a=u["default"].rootData;}else{var _n4=x.exec(e);if(!_n4)throw new Error("Invalid JSON-pointer: ".concat(e));var _i334=+_n4[1];if(s=_n4[2],"#"===s){if(_i334>=t)throw new Error(c("property/index",_i334));return o[t-_i334];}if(_i334>t)throw new Error(c("data",_i334));if(a=r[t-_i334],!s)return a;}var n=a;var i=s.split("/");var _iterator225=_createForOfIteratorHelper(i),_step225;try{for(_iterator225.s();!(_step225=_iterator225.n()).done;){var _e16=_step225.value;_e16&&(a=d._(_templateObject134||(_templateObject134=_taggedTemplateLiteral(["","",""])),a,(0,d.getProperty)((0,p.unescapeJsonPointer)(_e16))),n=d._(_templateObject135||(_templateObject135=_taggedTemplateLiteral([""," && ",""])),n,a));}}catch(err){_iterator225.e(err);}finally{_iterator225.f();}return n;function c(e,r){return"Cannot access ".concat(e," ").concat(r," levels up, current level is ").concat(t);}}r.getData=T;},{"../codegen":2,"../errors":4,"../names":6,"../resolve":8,"../util":10,"./applicability":11,"./boolSchema":12,"./dataType":13,"./defaults":14,"./keyword":16,"./subschema":17}],16:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateKeywordUsage=r.validSchemaType=r.funcKeywordCode=r.macroKeywordCode=void 0;var o=e("../codegen"),s=e("../names"),a=e("../../vocabularies/code"),n=e("../errors");function i(e){var t=e.gen,r=e.data,s=e.it;t["if"](s.parentData,function(){return t.assign(r,o._(_templateObject136||(_templateObject136=_taggedTemplateLiteral(["","[","]"])),s.parentData,s.parentDataProperty));});}function c(e,t,r){if(void 0===r)throw new Error("keyword \"".concat(t,"\" failed to compile"));return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,o.stringify)(r)});}r.macroKeywordCode=function(e,t){var r=e.gen,s=e.keyword,a=e.schema,n=e.parentSchema,i=e.it,l=t.macro.call(i.self,a,n,i),d=c(r,s,l);!1!==i.opts.validateSchema&&i.self.validateSchema(l,!0);var u=r.name("valid");e.subschema({schema:l,schemaPath:o.nil,errSchemaPath:"".concat(i.errSchemaPath,"/").concat(s),topSchemaRef:d,compositeRule:!0},u),e.pass(u,function(){return e.error(!0);});},r.funcKeywordCode=function(e,t){var r;var l=e.gen,d=e.keyword,u=e.schema,f=e.parentSchema,p=e.$data,m=e.it;!function(_ref217,t){var e=_ref217.schemaEnv;if(t.async&&!e.$async)throw new Error("async keyword in sync schema");}(m,t);var h=!p&&t.compile?t.compile.call(m.self,u,f,m):t.validate,y=c(l,d,h),v=l["let"]("valid");function g(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:t.async?o._(_templateObject137||(_templateObject137=_taggedTemplateLiteral(["await "]))):o.nil;l.assign(v,o._(_templateObject138||(_templateObject138=_taggedTemplateLiteral(["","",""])),r,(0,a.callValidateCode)(e,y,m.opts.passContext?s["default"]["this"]:s["default"].self,!("compile"in t&&!p||!1===t.schema))),t.modifying);}function $(e){var r;l["if"]((0,o.not)(null!==(r=t.valid)&&void 0!==r?r:v),e);}e.block$data(v,function(){if(!1===t.errors)g(),t.modifying&&i(e),$(function(){return e.error();});else{var _r34=t.async?function(){var e=l["let"]("ruleErrs",null);return l["try"](function(){return g(o._(_templateObject139||(_templateObject139=_taggedTemplateLiteral(["await "]))));},function(t){return l.assign(v,!1)["if"](o._(_templateObject140||(_templateObject140=_taggedTemplateLiteral([""," instanceof ",""])),t,m.ValidationError),function(){return l.assign(e,o._(_templateObject141||(_templateObject141=_taggedTemplateLiteral(["",".errors"])),t));},function(){return l["throw"](t);});}),e;}():function(){var e=o._(_templateObject142||(_templateObject142=_taggedTemplateLiteral(["",".errors"])),y);return l.assign(e,null),g(o.nil),e;}();t.modifying&&i(e),$(function(){return function(e,t){var r=e.gen;r["if"](o._(_templateObject143||(_templateObject143=_taggedTemplateLiteral(["Array.isArray(",")"])),t),function(){r.assign(s["default"].vErrors,o._(_templateObject144||(_templateObject144=_taggedTemplateLiteral([""," === null ? "," : ",".concat(",")"])),s["default"].vErrors,t,s["default"].vErrors,t)).assign(s["default"].errors,o._(_templateObject145||(_templateObject145=_taggedTemplateLiteral(["",".length"])),s["default"].vErrors)),(0,n.extendErrors)(e);},function(){return e.error();});}(e,_r34);});}}),e.ok(null!==(r=t.valid)&&void 0!==r?r:v);},r.validSchemaType=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;return!t.length||t.some(function(t){return"array"===t?Array.isArray(e):"object"===t?e&&"object"==_typeof2(e)&&!Array.isArray(e):_typeof2(e)==t||r&&void 0===e;});},r.validateKeywordUsage=function(_ref218,s,a){var e=_ref218.schema,t=_ref218.opts,r=_ref218.self,o=_ref218.errSchemaPath;if(Array.isArray(s.keyword)?!s.keyword.includes(a):s.keyword!==a)throw new Error("ajv implementation error");var n=s.dependencies;if(null==n?void 0:n.some(function(t){return!Object.prototype.hasOwnProperty.call(e,t);}))throw new Error("parent schema must have dependencies of ".concat(a,": ").concat(n.join(",")));if(s.validateSchema){if(!s.validateSchema(e[a])){var _e17="keyword \"".concat(a,"\" value is invalid at path \"").concat(o,"\": ")+r.errorsText(s.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(_e17);r.logger.error(_e17);}}};},{"../../vocabularies/code":42,"../codegen":2,"../errors":4,"../names":6}],17:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.extendSubschemaMode=r.extendSubschemaData=r.getSubschema=void 0;var o=e("../codegen"),s=e("../util");r.getSubschema=function(e,_ref219){var t=_ref219.keyword,r=_ref219.schemaProp,a=_ref219.schema,n=_ref219.schemaPath,i=_ref219.errSchemaPath,c=_ref219.topSchemaRef;if(void 0!==t&&void 0!==a)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){var _a3=e.schema[t];return void 0===r?{schema:_a3,schemaPath:o._(_templateObject146||(_templateObject146=_taggedTemplateLiteral(["","",""])),e.schemaPath,(0,o.getProperty)(t)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(t)}:{schema:_a3[r],schemaPath:o._(_templateObject147||(_templateObject147=_taggedTemplateLiteral(["","","",""])),e.schemaPath,(0,o.getProperty)(t),(0,o.getProperty)(r)),errSchemaPath:"".concat(e.errSchemaPath,"/").concat(t,"/").concat((0,s.escapeFragment)(r))};}if(void 0!==a){if(void 0===n||void 0===i||void 0===c)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:a,schemaPath:n,topSchemaRef:c,errSchemaPath:i};}throw new Error('either "keyword" or "schema" must be passed');},r.extendSubschemaData=function(e,t,_ref220){var r=_ref220.dataProp,a=_ref220.dataPropType,n=_ref220.data,i=_ref220.dataTypes,c=_ref220.propertyName;if(void 0!==n&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');var l=t.gen;if(void 0!==r){var _n5=t.errorPath,_i335=t.dataPathArr,_c2=t.opts;d(l["let"]("data",o._(_templateObject148||(_templateObject148=_taggedTemplateLiteral(["","",""])),t.data,(0,o.getProperty)(r)),!0)),e.errorPath=o.str(_templateObject149||(_templateObject149=_taggedTemplateLiteral(["","",""])),_n5,(0,s.getErrorPath)(r,a,_c2.jsPropertySyntax)),e.parentDataProperty=o._(_templateObject150||(_templateObject150=_taggedTemplateLiteral(["",""])),r),e.dataPathArr=[].concat(_toConsumableArray2(_i335),[e.parentDataProperty]);}if(void 0!==n){d(n instanceof o.Name?n:l["let"]("data",n,!0)),void 0!==c&&(e.propertyName=c);}function d(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set(),e.parentData=t.data,e.dataNames=[].concat(_toConsumableArray2(t.dataNames),[r]);}i&&(e.dataTypes=i);},r.extendSubschemaMode=function(e,_ref221){var t=_ref221.jtdDiscriminator,r=_ref221.jtdMetadata,o=_ref221.compositeRule,s=_ref221.createErrors,a=_ref221.allErrors;void 0!==o&&(e.compositeRule=o),void 0!==s&&(e.createErrors=s),void 0!==a&&(e.allErrors=a),e.jtdDiscriminator=t,e.jtdMetadata=r;};},{"../codegen":2,"../util":10}],18:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CodeGen=r.Name=r.nil=r.stringify=r.str=r._=r.KeywordCxt=void 0;var o=e("./compile/validate");Object.defineProperty(r,"KeywordCxt",{enumerable:!0,get:function get(){return o.KeywordCxt;}});var s=e("./compile/codegen");Object.defineProperty(r,"_",{enumerable:!0,get:function get(){return s._;}}),Object.defineProperty(r,"str",{enumerable:!0,get:function get(){return s.str;}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function get(){return s.stringify;}}),Object.defineProperty(r,"nil",{enumerable:!0,get:function get(){return s.nil;}}),Object.defineProperty(r,"Name",{enumerable:!0,get:function get(){return s.Name;}}),Object.defineProperty(r,"CodeGen",{enumerable:!0,get:function get(){return s.CodeGen;}});var a=e("./runtime/validation_error"),n=e("./compile/ref_error"),i=e("./compile/rules"),c=e("./compile"),l=e("./compile/codegen"),d=e("./compile/resolve"),u=e("./compile/validate/dataType"),f=e("./compile/util"),p=e("./refs/data.json"),m=e("./runtime/uri"),h=function h(e,t){return new RegExp(e,t);};h.code="new RegExp";var y=["removeAdditional","useDefaults","coerceTypes"],v=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},$={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function _(e){var t,r,o,s,a,n,i,c,l,d,u,f,p,y,v,g,$,_,w,b,E,P,S,N,k;var j=e.strict,C=null===(t=e.code)||void 0===t?void 0:t.optimize,O=!0===C||void 0===C?1:C||0,x=null!==(o=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==o?o:h,T=null!==(s=e.uriResolver)&&void 0!==s?s:m["default"];return{strictSchema:null===(n=null!==(a=e.strictSchema)&&void 0!==a?a:j)||void 0===n||n,strictNumbers:null===(c=null!==(i=e.strictNumbers)&&void 0!==i?i:j)||void 0===c||c,strictTypes:null!==(d=null!==(l=e.strictTypes)&&void 0!==l?l:j)&&void 0!==d?d:"log",strictTuples:null!==(f=null!==(u=e.strictTuples)&&void 0!==u?u:j)&&void 0!==f?f:"log",strictRequired:null!==(y=null!==(p=e.strictRequired)&&void 0!==p?p:j)&&void 0!==y&&y,code:e.code?_objectSpread2(_objectSpread2({},e.code),{},{optimize:O,regExp:x}):{optimize:O,regExp:x},loopRequired:null!==(v=e.loopRequired)&&void 0!==v?v:200,loopEnum:null!==(g=e.loopEnum)&&void 0!==g?g:200,meta:null===($=e.meta)||void 0===$||$,messages:null===(_=e.messages)||void 0===_||_,inlineRefs:null===(w=e.inlineRefs)||void 0===w||w,schemaId:null!==(b=e.schemaId)&&void 0!==b?b:"$id",addUsedSchema:null===(E=e.addUsedSchema)||void 0===E||E,validateSchema:null===(P=e.validateSchema)||void 0===P||P,validateFormats:null===(S=e.validateFormats)||void 0===S||S,unicodeRegExp:null===(N=e.unicodeRegExp)||void 0===N||N,int32range:null===(k=e.int32range)||void 0===k||k,uriResolver:T};}var w=/*#__PURE__*/function(){function w(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,w);this.schemas={},this.refs={},this.formats={},this._compilations=new Set(),this._loading={},this._cache=new Map(),e=this.opts=_objectSpread2(_objectSpread2({},e),_(e));var _this$opts$code2=this.opts.code,t=_this$opts$code2.es5,r=_this$opts$code2.lines;this.scope=new l.ValueScope({scope:{},prefixes:v,es5:t,lines:r}),this.logger=function(e){if(!1===e)return j;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods");}(e.logger);var o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,i.getRules)(),b.call(this,g,e,"NOT SUPPORTED"),b.call(this,$,e,"DEPRECATED","warn"),this._metaOpts=k.call(this),e.formats&&S.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&N.call(this,e.keywords),"object"==_typeof2(e.meta)&&this.addMetaSchema(e.meta),P.call(this),e.validateFormats=o;}_createClass(w,[{key:"_addVocabularies",value:function _addVocabularies(){this.addKeyword("$async");}},{key:"_addDefaultMetaSchema",value:function _addDefaultMetaSchema(){var _this$opts2=this.opts,e=_this$opts2.$data,t=_this$opts2.meta,r=_this$opts2.schemaId;var o=p;"id"===r&&(o=_objectSpread2({},p),o.id=o.$id,delete o.$id),t&&e&&this.addMetaSchema(o,o[r],!1);}},{key:"defaultMeta",value:function defaultMeta(){var _this$opts3=this.opts,e=_this$opts3.meta,t=_this$opts3.schemaId;return this.opts.defaultMeta="object"==_typeof2(e)?e[t]||e:void 0;}},{key:"validate",value:function validate(e,t){var r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error("no schema with key or ref \"".concat(e,"\""));}else r=this.compile(e);var o=r(t);return"$async"in r||(this.errors=r.errors),o;}},{key:"compile",value:function compile(e,t){var r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r);}},{key:"compileAsync",value:function compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");var r=this.opts.loadSchema;return o.call(this,e,t);function o(_x16,_x17){return _o7.apply(this,arguments);}function _o7(){_o7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee25(e,t){var r;return _regeneratorRuntime().wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:_context25.next=2;return s.call(this,e.$schema);case 2:r=this._addSchema(e,t);return _context25.abrupt("return",r.validate||a.call(this,r));case 4:case"end":return _context25.stop();}}},_callee25,this);}));return _o7.apply(this,arguments);}function s(_x18){return _s12.apply(this,arguments);}function _s12(){_s12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee26(e){return _regeneratorRuntime().wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:_context26.t0=e&&!this.getSchema(e);if(!_context26.t0){_context26.next=4;break;}_context26.next=4;return o.call(this,{$ref:e},!0);case 4:case"end":return _context26.stop();}}},_callee26,this);}));return _s12.apply(this,arguments);}function a(_x19){return _a4.apply(this,arguments);}function _a4(){_a4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee27(e){return _regeneratorRuntime().wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:_context27.prev=0;return _context27.abrupt("return",this._compileSchemaEnv(e));case 4:_context27.prev=4;_context27.t0=_context27["catch"](0);if(_context27.t0 instanceof n["default"]){_context27.next=8;break;}throw _context27.t0;case 8:i.call(this,_context27.t0);_context27.next=11;return c.call(this,_context27.t0.missingSchema);case 11:return _context27.abrupt("return",a.call(this,e));case 12:case"end":return _context27.stop();}}},_callee27,this,[[0,4]]);}));return _a4.apply(this,arguments);}function i(_ref222){var e=_ref222.missingSchema,t=_ref222.missingRef;if(this.refs[e])throw new Error("AnySchema ".concat(e," is loaded but ").concat(t," cannot be resolved"));}function c(_x20){return _c3.apply(this,arguments);}function _c3(){_c3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee28(e){var r;return _regeneratorRuntime().wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:_context28.next=2;return l.call(this,e);case 2:r=_context28.sent;_context28.t0=this.refs[e];if(_context28.t0){_context28.next=7;break;}_context28.next=7;return s.call(this,r.$schema);case 7:this.refs[e]||this.addSchema(r,e,t);case 8:case"end":return _context28.stop();}}},_callee28,this);}));return _c3.apply(this,arguments);}function l(_x21){return _l5.apply(this,arguments);}function _l5(){_l5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee29(e){var t;return _regeneratorRuntime().wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:t=this._loading[e];if(!t){_context29.next=3;break;}return _context29.abrupt("return",t);case 3:_context29.prev=3;_context29.next=6;return this._loading[e]=r(e);case 6:return _context29.abrupt("return",_context29.sent);case 7:_context29.prev=7;delete this._loading[e];return _context29.finish(7);case 10:case"end":return _context29.stop();}}},_callee29,this,[[3,,7,10]]);}));return _l5.apply(this,arguments);}}},{key:"addSchema",value:function addSchema(e,t,r){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:this.opts.validateSchema;if(Array.isArray(e)){var _iterator226=_createForOfIteratorHelper(e),_step226;try{for(_iterator226.s();!(_step226=_iterator226.n()).done;){var _t14=_step226.value;this.addSchema(_t14,void 0,r,o);}}catch(err){_iterator226.e(err);}finally{_iterator226.f();}return this;}var s;if("object"==_typeof2(e)){var _t15=this.opts.schemaId;if(s=e[_t15],void 0!==s&&"string"!=typeof s)throw new Error("schema ".concat(_t15," must be string"));}return t=(0,d.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,o,!0),this;}},{key:"addMetaSchema",value:function addMetaSchema(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.opts.validateSchema;return this.addSchema(e,t,!0,r),this;}},{key:"validateSchema",value:function validateSchema(e,t){if("boolean"==typeof e)return!0;var r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var o=this.validate(r,e);if(!o&&t){var _e18="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(_e18);this.logger.error(_e18);}return o;}},{key:"getSchema",value:function getSchema(e){var t;for(;"string"==typeof(t=E.call(this,e));){e=t;}if(void 0===t){var _r35=this.opts.schemaId,_o8=new c.SchemaEnv({schema:{},schemaId:_r35});if(t=c.resolveSchema.call(this,_o8,e),!t)return;this.refs[e]=t;}return t.validate||this._compileSchemaEnv(t);}},{key:"removeSchema",value:function removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(_typeof2(e)){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{var _t16=E.call(this,e);return"object"==_typeof2(_t16)&&this._cache["delete"](_t16.schema),delete this.schemas[e],delete this.refs[e],this;}case"object":{this._cache["delete"](e);var _t17=e[this.opts.schemaId];return _t17&&(_t17=(0,d.normalizeId)(_t17),delete this.schemas[_t17],delete this.refs[_t17]),this;}default:throw new Error("ajv.removeSchema: invalid parameter");}}},{key:"addVocabulary",value:function addVocabulary(e){var _iterator227=_createForOfIteratorHelper(e),_step227;try{for(_iterator227.s();!(_step227=_iterator227.n()).done;){var _t18=_step227.value;this.addKeyword(_t18);}}catch(err){_iterator227.e(err);}finally{_iterator227.f();}return this;}},{key:"addKeyword",value:function addKeyword(e,t){var _this180=this;var r;if("string"==typeof e)r=e,"object"==_typeof2(t)&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=_typeof2(e)||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array");}if(O.call(this,r,t),!t)return(0,f.eachItem)(r,function(e){return x.call(_this180,e);}),this;I.call(this,t);var o=_objectSpread2(_objectSpread2({},t),{},{type:(0,u.getJSONTypes)(t.type),schemaType:(0,u.getJSONTypes)(t.schemaType)});return(0,f.eachItem)(r,0===o.type.length?function(e){return x.call(_this180,e,o);}:function(e){return o.type.forEach(function(t){return x.call(_this180,e,o,t);});}),this;}},{key:"getKeyword",value:function getKeyword(e){var t=this.RULES.all[e];return"object"==_typeof2(t)?t.definition:!!t;}},{key:"removeKeyword",value:function removeKeyword(e){var t=this.RULES;delete t.keywords[e],delete t.all[e];var _iterator228=_createForOfIteratorHelper(t.rules),_step228;try{for(_iterator228.s();!(_step228=_iterator228.n()).done;){var _r36=_step228.value;var _t19=_r36.rules.findIndex(function(t){return t.keyword===e;});_t19>=0&&_r36.rules.splice(_t19,1);}}catch(err){_iterator228.e(err);}finally{_iterator228.f();}return this;}},{key:"addFormat",value:function addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this;}},{key:"errorsText",value:function errorsText(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.errors;var _ref223=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref223$separator=_ref223.separator,t=_ref223$separator===void 0?", ":_ref223$separator,_ref223$dataVar=_ref223.dataVar,r=_ref223$dataVar===void 0?"data":_ref223$dataVar;return e&&0!==e.length?e.map(function(e){return"".concat(r).concat(e.instancePath," ").concat(e.message);}).reduce(function(e,r){return e+t+r;}):"No errors";}},{key:"$dataMetaSchema",value:function $dataMetaSchema(e,t){var r=this.RULES.all;e=JSON.parse(JSON.stringify(e));var _iterator229=_createForOfIteratorHelper(t),_step229;try{for(_iterator229.s();!(_step229=_iterator229.n()).done;){var _o9=_step229.value;var _t20=_o9.split("/").slice(1);var _s13=e;var _iterator230=_createForOfIteratorHelper(_t20),_step230;try{for(_iterator230.s();!(_step230=_iterator230.n()).done;){var _e20=_step230.value;_s13=_s13[_e20];}}catch(err){_iterator230.e(err);}finally{_iterator230.f();}for(var _e19 in r){var _t21=r[_e19];if("object"!=_typeof2(_t21))continue;var _o10=_t21.definition.$data,_a5=_s13[_e19];_o10&&_a5&&(_s13[_e19]=D(_a5));}}}catch(err){_iterator229.e(err);}finally{_iterator229.f();}return e;}},{key:"_removeAllSchemas",value:function _removeAllSchemas(e,t){for(var _r37 in e){var _o11=e[_r37];t&&!t.test(_r37)||("string"==typeof _o11?delete e[_r37]:_o11&&!_o11.meta&&(this._cache["delete"](_o11.schema),delete e[_r37]));}}},{key:"_addSchema",value:function _addSchema(e,t,r){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:this.opts.validateSchema;var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:this.opts.addUsedSchema;var a;var n=this.opts.schemaId;if("object"==_typeof2(e))a=e[n];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean");}var i=this._cache.get(e);if(void 0!==i)return i;r=(0,d.normalizeId)(a||r);var l=d.getSchemaRefs.call(this,e,r);return i=new c.SchemaEnv({schema:e,schemaId:n,meta:t,baseId:r,localRefs:l}),this._cache.set(i.schema,i),s&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=i),o&&this.validateSchema(e,!0),i;}},{key:"_checkUnique",value:function _checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error("schema with key or id \"".concat(e,"\" already exists"));}},{key:"_compileSchemaEnv",value:function _compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):c.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate;}},{key:"_compileMetaSchema",value:function _compileMetaSchema(e){var t=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,e);}finally{this.opts=t;}}}]);return w;}();function b(e,t,r){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"error";for(var _s14 in e){var _a6=_s14;_a6 in t&&this.logger[o]("".concat(r,": option ").concat(_s14,". ").concat(e[_a6]));}}function E(e){return e=(0,d.normalizeId)(e),this.schemas[e]||this.refs[e];}function P(){var e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(var _t22 in e){this.addSchema(e[_t22],_t22);}}function S(){for(var _e21 in this.opts.formats){var _t23=this.opts.formats[_e21];_t23&&this.addFormat(_e21,_t23);}}function N(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(var _t24 in e){var _r38=e[_t24];_r38.keyword||(_r38.keyword=_t24),this.addKeyword(_r38);}}}function k(){var e=_objectSpread2({},this.opts);var _iterator231=_createForOfIteratorHelper(y),_step231;try{for(_iterator231.s();!(_step231=_iterator231.n()).done;){var _t25=_step231.value;delete e[_t25];}}catch(err){_iterator231.e(err);}finally{_iterator231.f();}return e;}r["default"]=w,w.ValidationError=a["default"],w.MissingRefError=n["default"];var j={log:function log(){},warn:function warn(){},error:function error(){}};var C=/^[a-z_$][a-z0-9_$:-]*$/i;function O(e,t){var r=this.RULES;if((0,f.eachItem)(e,function(e){if(r.keywords[e])throw new Error("Keyword ".concat(e," is already defined"));if(!C.test(e))throw new Error("Keyword ".concat(e," has invalid name"));}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function');}function x(e,t,r){var _this181=this;var o;var s=null==t?void 0:t.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');var a=this.RULES;var n=s?a.post:a.rules.find(function(_ref224){var e=_ref224.type;return e===r;});if(n||(n={type:r,rules:[]},a.rules.push(n)),a.keywords[e]=!0,!t)return;var i={keyword:e,definition:_objectSpread2(_objectSpread2({},t),{},{type:(0,u.getJSONTypes)(t.type),schemaType:(0,u.getJSONTypes)(t.schemaType)})};t.before?T.call(this,n,i,t.before):n.rules.push(i),a.all[e]=i,null===(o=t["implements"])||void 0===o||o.forEach(function(e){return _this181.addKeyword(e);});}function T(e,t,r){var o=e.rules.findIndex(function(e){return e.keyword===r;});o>=0?e.rules.splice(o,0,t):(e.rules.push(t),this.logger.warn("rule ".concat(r," is not defined")));}function I(e){var t=e.metaSchema;void 0!==t&&(e.$data&&this.opts.$data&&(t=D(t)),e.validateSchema=this.compile(t,!0));}var R={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function D(e){return{anyOf:[e,R]};}},{"./compile":5,"./compile/codegen":2,"./compile/ref_error":7,"./compile/resolve":8,"./compile/rules":9,"./compile/util":10,"./compile/validate":15,"./compile/validate/dataType":13,"./refs/data.json":19,"./runtime/uri":23,"./runtime/validation_error":24}],19:[function(e,t,r){t.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};},{}],20:[function(e,t,r){t.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{"default":0}]},simpleTypes:{"enum":["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,"default":[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},"default":!0,readOnly:{type:"boolean","default":!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],"default":!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean","default":!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},"default":{}},properties:{type:"object",additionalProperties:{$ref:"#"},"default":{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},"default":{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},"const":!0,"enum":{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},"if":{$ref:"#"},then:{$ref:"#"},"else":{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},"default":!0};},{}],21:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("fast-deep-equal");o.code='require("ajv/dist/runtime/equal").default',r["default"]=o;},{"fast-deep-equal":63}],22:[function(e,t,r){function o(e){var t=e.length;var r,o=0,s=0;for(;s<t;){o++,r=e.charCodeAt(s++),r>=55296&&r<=56319&&s<t&&(r=e.charCodeAt(s),56320==(64512&r)&&s++);}return o;}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=o,o.code='require("ajv/dist/runtime/ucs2length").default';},{}],23:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("uri-js");o.code='require("ajv/dist/runtime/uri").default',r["default"]=o;},{"uri-js":65}],24:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=/*#__PURE__*/function(_Error3){_inherits(o,_Error3);var _super128=_createSuper(o);function o(e){var _this182;_classCallCheck(this,o);_this182=_super128.call(this,"validation failed"),_this182.errors=e,_this182.ajv=_this182.validation=!0;return _this182;}return _createClass(o);}(/*#__PURE__*/_wrapNativeSuper(Error));r["default"]=o;},{}],25:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateAdditionalItems=void 0;var o=e("../../compile/codegen"),s=e("../../compile/util"),a={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:function message(_ref225){var e=_ref225.params.len;return o.str(_templateObject151||(_templateObject151=_taggedTemplateLiteral(["must NOT have more than "," items"])),e);},params:function params(_ref226){var e=_ref226.params.len;return o._(_templateObject152||(_templateObject152=_taggedTemplateLiteral(["{limit: ","}"])),e);}},code:function code(e){var t=e.parentSchema,r=e.it,o=t.items;Array.isArray(o)?n(e,o):(0,s.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');}};function n(e,t){var r=e.gen,a=e.schema,n=e.data,i=e.keyword,c=e.it;c.items=!0;var l=r["const"]("len",o._(_templateObject153||(_templateObject153=_taggedTemplateLiteral(["",".length"])),n));if(!1===a)e.setParams({len:t.length}),e.pass(o._(_templateObject154||(_templateObject154=_taggedTemplateLiteral([""," <= ",""])),l,t.length));else if("object"==_typeof2(a)&&!(0,s.alwaysValidSchema)(c,a)){var _a7=r["var"]("valid",o._(_templateObject155||(_templateObject155=_taggedTemplateLiteral([""," <= ",""])),l,t.length));r["if"]((0,o.not)(_a7),function(){return function(a){r.forRange("i",t.length,l,function(t){e.subschema({keyword:i,dataProp:t,dataPropType:s.Type.Num},a),c.allErrors||r["if"]((0,o.not)(a),function(){return r["break"]();});});}(_a7);}),e.ok(_a7);}}r.validateAdditionalItems=n,r["default"]=a;},{"../../compile/codegen":2,"../../compile/util":10}],26:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../code"),s=e("../../compile/codegen"),a=e("../../compile/names"),n=e("../../compile/util");r["default"]={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:function params(_ref227){var e=_ref227.params;return s._(_templateObject156||(_templateObject156=_taggedTemplateLiteral(["{additionalProperty: ","}"])),e.additionalProperty);}},code:function code(e){var t=e.gen,r=e.schema,i=e.parentSchema,c=e.data,l=e.errsCount,d=e.it;if(!l)throw new Error("ajv implementation error");var u=d.allErrors,f=d.opts;if(d.props=!0,"all"!==f.removeAdditional&&(0,n.alwaysValidSchema)(d,r))return;var p=(0,o.allSchemaProperties)(i.properties),m=(0,o.allSchemaProperties)(i.patternProperties);function h(e){t.code(s._(_templateObject157||(_templateObject157=_taggedTemplateLiteral(["delete ","[","]"])),c,e));}function y(o){if("all"===f.removeAdditional||f.removeAdditional&&!1===r)h(o);else{if(!1===r)return e.setParams({additionalProperty:o}),e.error(),void(u||t["break"]());if("object"==_typeof2(r)&&!(0,n.alwaysValidSchema)(d,r)){var _r39=t.name("valid");"failing"===f.removeAdditional?(v(o,_r39,!1),t["if"]((0,s.not)(_r39),function(){e.reset(),h(o);})):(v(o,_r39),u||t["if"]((0,s.not)(_r39),function(){return t["break"]();}));}}}function v(t,r,o){var s={keyword:"additionalProperties",dataProp:t,dataPropType:n.Type.Str};!1===o&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r);}t.forIn("key",c,function(r){p.length||m.length?t["if"](function(r){var a;if(p.length>8){var _e22=(0,n.schemaRefOrVal)(d,i.properties,"properties");a=(0,o.isOwnProperty)(t,_e22,r);}else a=p.length?(0,s.or).apply(void 0,_toConsumableArray2(p.map(function(e){return s._(_templateObject158||(_templateObject158=_taggedTemplateLiteral([""," === ",""])),r,e);}))):s.nil;return m.length&&(a=(0,s.or).apply(void 0,[a].concat(_toConsumableArray2(m.map(function(t){return s._(_templateObject159||(_templateObject159=_taggedTemplateLiteral(["",".test(",")"])),(0,o.usePattern)(e,t),r);}))))),(0,s.not)(a);}(r),function(){return y(r);}):y(r);}),e.ok(s._(_templateObject160||(_templateObject160=_taggedTemplateLiteral([""," === ",""])),l,a["default"].errors));}};},{"../../compile/codegen":2,"../../compile/names":6,"../../compile/util":10,"../code":42}],27:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/util");r["default"]={keyword:"allOf",schemaType:"array",code:function code(e){var t=e.gen,r=e.schema,s=e.it;if(!Array.isArray(r))throw new Error("ajv implementation error");var a=t.name("valid");r.forEach(function(t,r){if((0,o.alwaysValidSchema)(s,t))return;var n=e.subschema({keyword:"allOf",schemaProp:r},a);e.ok(a),e.mergeEvaluated(n);});}};},{"../../compile/util":10}],28:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../code");r["default"]={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:o.validateUnion,error:{message:"must match a schema in anyOf"}};},{"../code":42}],29:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util");r["default"]={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:function message(_ref228){var _ref228$params=_ref228.params,e=_ref228$params.min,t=_ref228$params.max;return void 0===t?o.str(_templateObject161||(_templateObject161=_taggedTemplateLiteral(["must contain at least "," valid item(s)"])),e):o.str(_templateObject162||(_templateObject162=_taggedTemplateLiteral(["must contain at least "," and no more than "," valid item(s)"])),e,t);},params:function params(_ref229){var _ref229$params=_ref229.params,e=_ref229$params.min,t=_ref229$params.max;return void 0===t?o._(_templateObject163||(_templateObject163=_taggedTemplateLiteral(["{minContains: ","}"])),e):o._(_templateObject164||(_templateObject164=_taggedTemplateLiteral(["{minContains: ",", maxContains: ","}"])),e,t);}},code:function code(e){var t=e.gen,r=e.schema,a=e.parentSchema,n=e.data,i=e.it;var c,l;var d=a.minContains,u=a.maxContains;i.opts.next?(c=void 0===d?1:d,l=u):c=1;var f=t["const"]("len",o._(_templateObject165||(_templateObject165=_taggedTemplateLiteral(["",".length"])),n));if(e.setParams({min:c,max:l}),void 0===l&&0===c)return void(0,s.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==l&&c>l)return(0,s.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,s.alwaysValidSchema)(i,r)){var _t26=o._(_templateObject166||(_templateObject166=_taggedTemplateLiteral([""," >= ",""])),f,c);return void 0!==l&&(_t26=o._(_templateObject167||(_templateObject167=_taggedTemplateLiteral([""," && "," <= ",""])),_t26,f,l)),void e.pass(_t26);}i.items=!0;var p=t.name("valid");function m(){var e=t.name("_valid"),r=t["let"]("count",0);h(e,function(){return t["if"](e,function(){return function(e){t.code(o._(_templateObject168||(_templateObject168=_taggedTemplateLiteral(["","++"])),e)),void 0===l?t["if"](o._(_templateObject169||(_templateObject169=_taggedTemplateLiteral([""," >= ",""])),e,c),function(){return t.assign(p,!0)["break"]();}):(t["if"](o._(_templateObject170||(_templateObject170=_taggedTemplateLiteral([""," > ",""])),e,l),function(){return t.assign(p,!1)["break"]();}),1===c?t.assign(p,!0):t["if"](o._(_templateObject171||(_templateObject171=_taggedTemplateLiteral([""," >= ",""])),e,c),function(){return t.assign(p,!0);}));}(r);});});}function h(r,o){t.forRange("i",0,f,function(t){e.subschema({keyword:"contains",dataProp:t,dataPropType:s.Type.Num,compositeRule:!0},r),o();});}void 0===l&&1===c?h(p,function(){return t["if"](p,function(){return t["break"]();});}):0===c?(t["let"](p,!0),void 0!==l&&t["if"](o._(_templateObject172||(_templateObject172=_taggedTemplateLiteral(["",".length > 0"])),n),m)):(t["let"](p,!1),m()),e.result(p,function(){return e.reset();});}};},{"../../compile/codegen":2,"../../compile/util":10}],30:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateSchemaDeps=r.validatePropertyDeps=r.error=void 0;var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../code");r.error={message:function message(_ref230){var _ref230$params=_ref230.params,e=_ref230$params.property,t=_ref230$params.depsCount,r=_ref230$params.deps;return o.str(_templateObject173||(_templateObject173=_taggedTemplateLiteral(["must have "," "," when property "," is present"])),1===t?"property":"properties",r,e);},params:function params(_ref231){var _ref231$params=_ref231.params,e=_ref231$params.property,t=_ref231$params.depsCount,r=_ref231$params.deps,s=_ref231$params.missingProperty;return o._(_templateObject174||(_templateObject174=_taggedTemplateLiteral(["{property: ",",\n    missingProperty: ",",\n    depsCount: ",",\n    deps: ","}"])),e,s,t,r);}};var n={keyword:"dependencies",type:"object",schemaType:"object",error:r.error,code:function code(e){var _ref232=function(_ref234){var e=_ref234.schema;var t={},r={};for(var _o12 in e){if("__proto__"===_o12)continue;(Array.isArray(e[_o12])?t:r)[_o12]=e[_o12];}return[t,r];}(e),_ref233=_slicedToArray(_ref232,2),t=_ref233[0],r=_ref233[1];i(e,t),c(e,r);}};function i(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e.schema;var r=e.gen,s=e.data,n=e.it;if(0===Object.keys(t).length)return;var i=r["let"]("missing");var _loop20=function _loop20(_c4){var l=t[_c4];if(0===l.length)return"continue";var d=(0,a.propertyInData)(r,s,_c4,n.opts.ownProperties);e.setParams({property:_c4,depsCount:l.length,deps:l.join(", ")}),n.allErrors?r["if"](d,function(){var _iterator232=_createForOfIteratorHelper(l),_step232;try{for(_iterator232.s();!(_step232=_iterator232.n()).done;){var _t27=_step232.value;(0,a.checkReportMissingProp)(e,_t27);}}catch(err){_iterator232.e(err);}finally{_iterator232.f();}}):(r["if"](o._(_templateObject175||(_templateObject175=_taggedTemplateLiteral([""," && (",")"])),d,(0,a.checkMissingProp)(e,l,i))),(0,a.reportMissingProp)(e,i),r["else"]());};for(var _c4 in t){var _ret6=_loop20(_c4);if(_ret6==="continue")continue;}}function c(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e.schema;var r=e.gen,o=e.data,n=e.keyword,i=e.it,c=r.name("valid");var _loop21=function _loop21(l){(0,s.alwaysValidSchema)(i,t[l])||(r["if"]((0,a.propertyInData)(r,o,l,i.opts.ownProperties),function(){var t=e.subschema({keyword:n,schemaProp:l},c);e.mergeValidEvaluated(t,c);},function(){return r["var"](c,!0);}),e.ok(c));};for(var l in t){_loop21(l);}}r.validatePropertyDeps=i,r.validateSchemaDeps=c,r["default"]=n;},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],31:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util");function a(e,t){var r=e.schema[t];return void 0!==r&&!(0,s.alwaysValidSchema)(e,r);}r["default"]={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:function message(_ref235){var e=_ref235.params;return o.str(_templateObject176||(_templateObject176=_taggedTemplateLiteral(["must match \"","\" schema"])),e.ifClause);},params:function params(_ref236){var e=_ref236.params;return o._(_templateObject177||(_templateObject177=_taggedTemplateLiteral(["{failingKeyword: ","}"])),e.ifClause);}},code:function code(e){var t=e.gen,r=e.parentSchema,n=e.it;void 0===r.then&&void 0===r["else"]&&(0,s.checkStrictMode)(n,'"if" without "then" and "else" is ignored');var i=a(n,"then"),c=a(n,"else");if(!i&&!c)return;var l=t["let"]("valid",!0),d=t.name("_valid");if(function(){var t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},d);e.mergeEvaluated(t);}(),e.reset(),i&&c){var _r40=t["let"]("ifClause");e.setParams({ifClause:_r40}),t["if"](d,u("then",_r40),u("else",_r40));}else i?t["if"](d,u("then")):t["if"]((0,o.not)(d),u("else"));function u(r,s){return function(){var a=e.subschema({keyword:r},d);t.assign(l,d),e.mergeValidEvaluated(a,l),s?t.assign(s,o._(_templateObject178||(_templateObject178=_taggedTemplateLiteral(["",""])),r)):e.setParams({ifClause:r});};}e.pass(l,function(){return e.error(!0);});}};},{"../../compile/codegen":2,"../../compile/util":10}],32:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./additionalItems"),s=e("./prefixItems"),a=e("./items"),n=e("./items2020"),i=e("./contains"),c=e("./dependencies"),l=e("./propertyNames"),d=e("./additionalProperties"),u=e("./properties"),f=e("./patternProperties"),p=e("./not"),m=e("./anyOf"),h=e("./oneOf"),y=e("./allOf"),v=e("./if"),g=e("./thenElse");r["default"]=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var t=[p["default"],m["default"],h["default"],y["default"],v["default"],g["default"],l["default"],d["default"],c["default"],u["default"],f["default"]];return e?t.push(s["default"],n["default"]):t.push(o["default"],a["default"]),t.push(i["default"]),t;};},{"./additionalItems":25,"./additionalProperties":26,"./allOf":27,"./anyOf":28,"./contains":29,"./dependencies":30,"./if":31,"./items":33,"./items2020":34,"./not":35,"./oneOf":36,"./patternProperties":37,"./prefixItems":38,"./properties":39,"./propertyNames":40,"./thenElse":41}],33:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateTuple=void 0;var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../code"),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code:function code(e){var t=e.schema,r=e.it;if(Array.isArray(t))return i(e,"additionalItems",t);r.items=!0,(0,s.alwaysValidSchema)(r,t)||e.ok((0,a.validateArray)(e));}};function i(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e.schema;var a=e.gen,n=e.parentSchema,i=e.data,c=e.keyword,l=e.it;!function(e){var o=l.opts,a=l.errSchemaPath,n=r.length,i=n===e.minItems&&(n===e.maxItems||!1===e[t]);if(o.strictTuples&&!i){(0,s.checkStrictMode)(l,"\"".concat(c,"\" is ").concat(n,"-tuple, but minItems or maxItems/").concat(t," are not specified or different at path \"").concat(a,"\""),o.strictTuples);}}(n),l.opts.unevaluated&&r.length&&!0!==l.items&&(l.items=s.mergeEvaluated.items(a,r.length,l.items));var d=a.name("valid"),u=a["const"]("len",o._(_templateObject179||(_templateObject179=_taggedTemplateLiteral(["",".length"])),i));r.forEach(function(t,r){(0,s.alwaysValidSchema)(l,t)||(a["if"](o._(_templateObject180||(_templateObject180=_taggedTemplateLiteral([""," > ",""])),u,r),function(){return e.subschema({keyword:c,schemaProp:r,dataProp:r},d);}),e.ok(d));});}r.validateTuple=i,r["default"]=n;},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],34:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../code"),n=e("./additionalItems");r["default"]={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:function message(_ref237){var e=_ref237.params.len;return o.str(_templateObject181||(_templateObject181=_taggedTemplateLiteral(["must NOT have more than "," items"])),e);},params:function params(_ref238){var e=_ref238.params.len;return o._(_templateObject182||(_templateObject182=_taggedTemplateLiteral(["{limit: ","}"])),e);}},code:function code(e){var t=e.schema,r=e.parentSchema,o=e.it,i=r.prefixItems;o.items=!0,(0,s.alwaysValidSchema)(o,t)||(i?(0,n.validateAdditionalItems)(e,i):e.ok((0,a.validateArray)(e)));}};},{"../../compile/codegen":2,"../../compile/util":10,"../code":42,"./additionalItems":25}],35:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/util");r["default"]={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code:function code(e){var t=e.gen,r=e.schema,s=e.it;if((0,o.alwaysValidSchema)(s,r))return void e.fail();var a=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),e.failResult(a,function(){return e.reset();},function(){return e.error();});},error:{message:"must NOT be valid"}};},{"../../compile/util":10}],36:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util");r["default"]={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:function params(_ref239){var e=_ref239.params;return o._(_templateObject183||(_templateObject183=_taggedTemplateLiteral(["{passingSchemas: ","}"])),e.passing);}},code:function code(e){var t=e.gen,r=e.schema,a=e.parentSchema,n=e.it;if(!Array.isArray(r))throw new Error("ajv implementation error");if(n.opts.discriminator&&a.discriminator)return;var i=r,c=t["let"]("valid",!1),l=t["let"]("passing",null),d=t.name("_valid");e.setParams({passing:l}),t.block(function(){i.forEach(function(r,a){var i;(0,s.alwaysValidSchema)(n,r)?t["var"](d,!0):i=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},d),a>0&&t["if"](o._(_templateObject184||(_templateObject184=_taggedTemplateLiteral([""," && ",""])),d,c)).assign(c,!1).assign(l,o._(_templateObject185||(_templateObject185=_taggedTemplateLiteral(["[",", ","]"])),l,a))["else"](),t["if"](d,function(){t.assign(c,!0),t.assign(l,a),i&&e.mergeEvaluated(i,o.Name);});});}),e.result(c,function(){return e.reset();},function(){return e.error(!0);});}};},{"../../compile/codegen":2,"../../compile/util":10}],37:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../code"),s=e("../../compile/codegen"),a=e("../../compile/util"),n=e("../../compile/util");r["default"]={keyword:"patternProperties",type:"object",schemaType:"object",code:function code(e){var t=e.gen,r=e.schema,i=e.data,c=e.parentSchema,l=e.it,d=l.opts,u=(0,o.allSchemaProperties)(r),f=u.filter(function(e){return(0,a.alwaysValidSchema)(l,r[e]);});if(0===u.length||f.length===u.length&&(!l.opts.unevaluated||!0===l.props))return;var p=d.strictSchema&&!d.allowMatchingProperties&&c.properties,m=t.name("valid");!0===l.props||l.props instanceof s.Name||(l.props=(0,n.evaluatedPropsToName)(t,l.props));var h=l.props;function y(e){for(var _t28 in p){new RegExp(e).test(_t28)&&(0,a.checkStrictMode)(l,"property ".concat(_t28," matches pattern ").concat(e," (use allowMatchingProperties)"));}}function v(r){t.forIn("key",i,function(a){t["if"](s._(_templateObject186||(_templateObject186=_taggedTemplateLiteral(["",".test(",")"])),(0,o.usePattern)(e,r),a),function(){var o=f.includes(r);o||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:a,dataPropType:n.Type.Str},m),l.opts.unevaluated&&!0!==h?t.assign(s._(_templateObject187||(_templateObject187=_taggedTemplateLiteral(["","[","]"])),h,a),!0):o||l.allErrors||t["if"]((0,s.not)(m),function(){return t["break"]();});});});}!function(){var _iterator233=_createForOfIteratorHelper(u),_step233;try{for(_iterator233.s();!(_step233=_iterator233.n()).done;){var _e23=_step233.value;p&&y(_e23),l.allErrors?v(_e23):(t["var"](m,!0),v(_e23),t["if"](m));}}catch(err){_iterator233.e(err);}finally{_iterator233.f();}}();}};},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],38:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./items");r["default"]={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:function code(e){return(0,o.validateTuple)(e,"items");}};},{"./items":33}],39:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/validate"),s=e("../code"),a=e("../../compile/util"),n=e("./additionalProperties");r["default"]={keyword:"properties",type:"object",schemaType:"object",code:function code(e){var t=e.gen,r=e.schema,i=e.parentSchema,c=e.data,l=e.it;"all"===l.opts.removeAdditional&&void 0===i.additionalProperties&&n["default"].code(new o.KeywordCxt(l,n["default"],"additionalProperties"));var d=(0,s.allSchemaProperties)(r);var _iterator234=_createForOfIteratorHelper(d),_step234;try{for(_iterator234.s();!(_step234=_iterator234.n()).done;){var _e24=_step234.value;l.definedProperties.add(_e24);}}catch(err){_iterator234.e(err);}finally{_iterator234.f();}l.opts.unevaluated&&d.length&&!0!==l.props&&(l.props=a.mergeEvaluated.props(t,(0,a.toHash)(d),l.props));var u=d.filter(function(e){return!(0,a.alwaysValidSchema)(l,r[e]);});if(0===u.length)return;var f=t.name("valid");var _iterator235=_createForOfIteratorHelper(u),_step235;try{for(_iterator235.s();!(_step235=_iterator235.n()).done;){var _r41=_step235.value;p(_r41)?m(_r41):(t["if"]((0,s.propertyInData)(t,c,_r41,l.opts.ownProperties)),m(_r41),l.allErrors||t["else"]()["var"](f,!0),t.endIf()),e.it.definedProperties.add(_r41),e.ok(f);}}catch(err){_iterator235.e(err);}finally{_iterator235.f();}function p(e){return l.opts.useDefaults&&!l.compositeRule&&void 0!==r[e]["default"];}function m(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},f);}}};},{"../../compile/util":10,"../../compile/validate":15,"../code":42,"./additionalProperties":26}],40:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util");r["default"]={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:function params(_ref240){var e=_ref240.params;return o._(_templateObject188||(_templateObject188=_taggedTemplateLiteral(["{propertyName: ","}"])),e.propertyName);}},code:function code(e){var t=e.gen,r=e.schema,a=e.data,n=e.it;if((0,s.alwaysValidSchema)(n,r))return;var i=t.name("valid");t.forIn("key",a,function(r){e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},i),t["if"]((0,o.not)(i),function(){e.error(!0),n.allErrors||t["break"]();});}),e.ok(i);}};},{"../../compile/codegen":2,"../../compile/util":10}],41:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/util");r["default"]={keyword:["then","else"],schemaType:["object","boolean"],code:function code(_ref241){var e=_ref241.keyword,t=_ref241.parentSchema,r=_ref241.it;void 0===t["if"]&&(0,o.checkStrictMode)(r,"\"".concat(e,"\" without \"if\" is ignored"));}};},{"../../compile/util":10}],42:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateUnion=r.validateArray=r.usePattern=r.callValidateCode=r.schemaProperties=r.allSchemaProperties=r.noPropertyInData=r.propertyInData=r.isOwnProperty=r.hasPropFunc=r.reportMissingProp=r.checkMissingProp=r.checkReportMissingProp=void 0;var o=e("../compile/codegen"),s=e("../compile/util"),a=e("../compile/names"),n=e("../compile/util");function i(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:o._(_templateObject189||(_templateObject189=_taggedTemplateLiteral(["Object.prototype.hasOwnProperty"])))});}function c(e,t,r){return o._(_templateObject190||(_templateObject190=_taggedTemplateLiteral(["",".call(",", ",")"])),i(e),t,r);}function l(e,t,r,s){var a=o._(_templateObject191||(_templateObject191=_taggedTemplateLiteral(["",""," === undefined"])),t,(0,o.getProperty)(r));return s?(0,o.or)(a,(0,o.not)(c(e,t,r))):a;}function d(e){return e?Object.keys(e).filter(function(e){return"__proto__"!==e;}):[];}r.checkReportMissingProp=function(e,t){var r=e.gen,s=e.data,a=e.it;r["if"](l(r,s,t,a.opts.ownProperties),function(){e.setParams({missingProperty:o._(_templateObject192||(_templateObject192=_taggedTemplateLiteral(["",""])),t)},!0),e.error();});},r.checkMissingProp=function(_ref242,s,a){var e=_ref242.gen,t=_ref242.data,r=_ref242.it.opts;return(0,o.or).apply(void 0,_toConsumableArray2(s.map(function(s){return(0,o.and)(l(e,t,s,r.ownProperties),o._(_templateObject193||(_templateObject193=_taggedTemplateLiteral([""," = ",""])),a,s));})));},r.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error();},r.hasPropFunc=i,r.isOwnProperty=c,r.propertyInData=function(e,t,r,s){var a=o._(_templateObject194||(_templateObject194=_taggedTemplateLiteral(["",""," !== undefined"])),t,(0,o.getProperty)(r));return s?o._(_templateObject195||(_templateObject195=_taggedTemplateLiteral([""," && ",""])),a,c(e,t,r)):a;},r.noPropertyInData=l,r.allSchemaProperties=d,r.schemaProperties=function(e,t){return d(t).filter(function(r){return!(0,s.alwaysValidSchema)(e,t[r]);});},r.callValidateCode=function(_ref243,l,d,u){var e=_ref243.schemaCode,t=_ref243.data,_ref243$it=_ref243.it,r=_ref243$it.gen,s=_ref243$it.topSchemaRef,n=_ref243$it.schemaPath,i=_ref243$it.errorPath,c=_ref243.it;var f=u?o._(_templateObject196||(_templateObject196=_taggedTemplateLiteral(["",", ",", ","",""])),e,t,s,n):t,p=[[a["default"].instancePath,(0,o.strConcat)(a["default"].instancePath,i)],[a["default"].parentData,c.parentData],[a["default"].parentDataProperty,c.parentDataProperty],[a["default"].rootData,a["default"].rootData]];c.opts.dynamicRef&&p.push([a["default"].dynamicAnchors,a["default"].dynamicAnchors]);var m=o._(_templateObject197||(_templateObject197=_taggedTemplateLiteral(["",", ",""])),f,r.object.apply(r,p));return d!==o.nil?o._(_templateObject198||(_templateObject198=_taggedTemplateLiteral(["",".call(",", ",")"])),l,d,m):o._(_templateObject199||(_templateObject199=_taggedTemplateLiteral(["","(",")"])),l,m);};var u=o._(_templateObject200||(_templateObject200=_taggedTemplateLiteral(["new RegExp"])));r.usePattern=function(_ref244,r){var e=_ref244.gen,t=_ref244.it.opts;var s=t.unicodeRegExp?"u":"",a=t.code.regExp,i=a(r,s);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:o._(_templateObject201||(_templateObject201=_taggedTemplateLiteral(["","(",", ",")"])),"new RegExp"===a.code?u:(0,n.useFunc)(e,a),r,s)});},r.validateArray=function(e){var t=e.gen,r=e.data,a=e.keyword,n=e.it,i=t.name("valid");if(n.allErrors){var _e25=t["let"]("valid",!0);return c(function(){return t.assign(_e25,!1);}),_e25;}return t["var"](i,!0),c(function(){return t["break"]();}),i;function c(n){var c=t["const"]("len",o._(_templateObject202||(_templateObject202=_taggedTemplateLiteral(["",".length"])),r));t.forRange("i",0,c,function(r){e.subschema({keyword:a,dataProp:r,dataPropType:s.Type.Num},i),t["if"]((0,o.not)(i),n);});}},r.validateUnion=function(e){var t=e.gen,r=e.schema,a=e.keyword,n=e.it;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(function(e){return(0,s.alwaysValidSchema)(n,e);})&&!n.opts.unevaluated)return;var i=t["let"]("valid",!1),c=t.name("_valid");t.block(function(){return r.forEach(function(r,s){var n=e.subschema({keyword:a,schemaProp:s,compositeRule:!0},c);t.assign(i,o._(_templateObject203||(_templateObject203=_taggedTemplateLiteral([""," || ",""])),i,c));e.mergeValidEvaluated(n,c)||t["if"]((0,o.not)(i));});}),e.result(i,function(){return e.reset();},function(){return e.error(!0);});};},{"../compile/codegen":2,"../compile/names":6,"../compile/util":10}],43:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r["default"]={keyword:"id",code:function code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID');}};},{}],44:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./id"),s=e("./ref");r["default"]=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",o["default"],s["default"]];},{"./id":43,"./ref":45}],45:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.callRef=r.getValidate=void 0;var o=e("../../compile/ref_error"),s=e("../code"),a=e("../../compile/codegen"),n=e("../../compile/names"),i=e("../../compile"),c=e("../../compile/util"),l={keyword:"$ref",schemaType:"string",code:function code(e){var t=e.gen,r=e.schema,s=e.it,n=s.baseId,c=s.schemaEnv,l=s.validateName,f=s.opts,p=s.self,m=c.root;if(("#"===r||"#/"===r)&&n===m.baseId)return function(){if(c===m)return u(e,l,c,c.$async);var r=t.scopeValue("root",{ref:m});return u(e,a._(_templateObject204||(_templateObject204=_taggedTemplateLiteral(["",".validate"])),r),m,m.$async);}();var h=i.resolveRef.call(p,m,n,r);if(void 0===h)throw new o["default"](s.opts.uriResolver,n,r);return h instanceof i.SchemaEnv?function(t){var r=d(e,t);u(e,r,t,t.$async);}(h):function(o){var s=t.scopeValue("schema",!0===f.code.source?{ref:o,code:(0,a.stringify)(o)}:{ref:o}),n=t.name("valid"),i=e.subschema({schema:o,dataTypes:[],schemaPath:a.nil,topSchemaRef:s,errSchemaPath:r},n);e.mergeEvaluated(i),e.ok(n);}(h);}};function d(e,t){var r=e.gen;return t.validate?r.scopeValue("validate",{ref:t.validate}):a._(_templateObject205||(_templateObject205=_taggedTemplateLiteral(["",".validate"])),r.scopeValue("wrapper",{ref:t}));}function u(e,t,r,o){var i=e.gen,l=e.it,d=l.allErrors,u=l.schemaEnv,f=l.opts,p=f.passContext?n["default"]["this"]:a.nil;function m(e){var t=a._(_templateObject206||(_templateObject206=_taggedTemplateLiteral(["",".errors"])),e);i.assign(n["default"].vErrors,a._(_templateObject207||(_templateObject207=_taggedTemplateLiteral([""," === null ? "," : ",".concat(",")"])),n["default"].vErrors,t,n["default"].vErrors,t)),i.assign(n["default"].errors,a._(_templateObject208||(_templateObject208=_taggedTemplateLiteral(["",".length"])),n["default"].vErrors));}function h(e){var t;if(!l.opts.unevaluated)return;var o=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==l.props)if(o&&!o.dynamicProps)void 0!==o.props&&(l.props=c.mergeEvaluated.props(i,o.props,l.props));else{var _t29=i["var"]("props",a._(_templateObject209||(_templateObject209=_taggedTemplateLiteral(["",".evaluated.props"])),e));l.props=c.mergeEvaluated.props(i,_t29,l.props,a.Name);}if(!0!==l.items)if(o&&!o.dynamicItems)void 0!==o.items&&(l.items=c.mergeEvaluated.items(i,o.items,l.items));else{var _t30=i["var"]("items",a._(_templateObject210||(_templateObject210=_taggedTemplateLiteral(["",".evaluated.items"])),e));l.items=c.mergeEvaluated.items(i,_t30,l.items,a.Name);}}o?function(){if(!u.$async)throw new Error("async schema referenced by sync schema");var r=i["let"]("valid");i["try"](function(){i.code(a._(_templateObject211||(_templateObject211=_taggedTemplateLiteral(["await ",""])),(0,s.callValidateCode)(e,t,p))),h(t),d||i.assign(r,!0);},function(e){i["if"](a._(_templateObject212||(_templateObject212=_taggedTemplateLiteral(["!("," instanceof ",")"])),e,l.ValidationError),function(){return i["throw"](e);}),m(e),d||i.assign(r,!1);}),e.ok(r);}():e.result((0,s.callValidateCode)(e,t,p),function(){return h(t);},function(){return m(t);});}r.getValidate=d,r.callRef=u,r["default"]=l;},{"../../compile":5,"../../compile/codegen":2,"../../compile/names":6,"../../compile/ref_error":7,"../../compile/util":10,"../code":42}],46:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../discriminator/types"),a=e("../../compile"),n=e("../../compile/util");r["default"]={keyword:"discriminator",type:"object",schemaType:"object",error:{message:function message(_ref245){var _ref245$params=_ref245.params,e=_ref245$params.discrError,t=_ref245$params.tagName;return e===s.DiscrError.Tag?"tag \"".concat(t,"\" must be string"):"value of tag \"".concat(t,"\" must be in oneOf");},params:function params(_ref246){var _ref246$params=_ref246.params,e=_ref246$params.discrError,t=_ref246$params.tag,r=_ref246$params.tagName;return o._(_templateObject213||(_templateObject213=_taggedTemplateLiteral(["{error: ",", tag: ",", tagValue: ","}"])),e,r,t);}},code:function code(e){var t=e.gen,r=e.data,i=e.schema,c=e.parentSchema,l=e.it,d=c.oneOf;if(!l.opts.discriminator)throw new Error("discriminator: requires discriminator option");var u=i.propertyName;if("string"!=typeof u)throw new Error("discriminator: requires propertyName");if(i.mapping)throw new Error("discriminator: mapping is not supported");if(!d)throw new Error("discriminator: requires oneOf keyword");var f=t["let"]("valid",!1),p=t["const"]("tag",o._(_templateObject214||(_templateObject214=_taggedTemplateLiteral(["","",""])),r,(0,o.getProperty)(u)));function m(r){var s=t.name("valid"),a=e.subschema({keyword:"oneOf",schemaProp:r},s);return e.mergeEvaluated(a,o.Name),s;}t["if"](o._(_templateObject215||(_templateObject215=_taggedTemplateLiteral(["typeof "," == \"string\""])),p),function(){return function(){var r=function(){var e;var t={},r=s(c);var o=!0;for(var _t31=0;_t31<d.length;_t31++){var _c5=d[_t31];(null==_c5?void 0:_c5.$ref)&&!(0,n.schemaHasRulesButRef)(_c5,l.self.RULES)&&(_c5=a.resolveRef.call(l.self,l.schemaEnv.root,l.baseId,null==_c5?void 0:_c5.$ref),_c5 instanceof a.SchemaEnv&&(_c5=_c5.schema));var _f2=null===(e=null==_c5?void 0:_c5.properties)||void 0===e?void 0:e[u];if("object"!=_typeof2(_f2))throw new Error("discriminator: oneOf subschemas (or referenced schemas) must have \"properties/".concat(u,"\""));o=o&&(r||s(_c5)),i(_f2,_t31);}if(!o)throw new Error("discriminator: \"".concat(u,"\" must be required"));return t;function s(_ref247){var e=_ref247.required;return Array.isArray(e)&&e.includes(u);}function i(e,t){if(e["const"])f(e["const"],t);else{if(!e["enum"])throw new Error("discriminator: \"properties/".concat(u,"\" must have \"const\" or \"enum\""));var _iterator236=_createForOfIteratorHelper(e["enum"]),_step236;try{for(_iterator236.s();!(_step236=_iterator236.n()).done;){var _r42=_step236.value;f(_r42,t);}}catch(err){_iterator236.e(err);}finally{_iterator236.f();}}}function f(e,r){if("string"!=typeof e||e in t)throw new Error("discriminator: \"".concat(u,"\" values must be unique strings"));t[e]=r;}}();t["if"](!1);for(var _e26 in r){t.elseIf(o._(_templateObject216||(_templateObject216=_taggedTemplateLiteral([""," === ",""])),p,_e26)),t.assign(f,m(r[_e26]));}t["else"](),e.error(!1,{discrError:s.DiscrError.Mapping,tag:p,tagName:u}),t.endIf();}();},function(){return e.error(!1,{discrError:s.DiscrError.Tag,tag:p,tagName:u});}),e.ok(f);}};},{"../../compile":5,"../../compile/codegen":2,"../../compile/util":10,"../discriminator/types":47}],47:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping";}(r.DiscrError||(r.DiscrError={}));},{}],48:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./core"),s=e("./validation"),a=e("./applicator"),n=e("./format"),i=e("./metadata"),c=[o["default"],s["default"],(0,a["default"])(),n["default"],i.metadataVocabulary,i.contentVocabulary];r["default"]=c;},{"./applicator":32,"./core":44,"./format":50,"./metadata":51,"./validation":54}],49:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen");r["default"]={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:function message(_ref248){var e=_ref248.schemaCode;return o.str(_templateObject217||(_templateObject217=_taggedTemplateLiteral(["must match format \"","\""])),e);},params:function params(_ref249){var e=_ref249.schemaCode;return o._(_templateObject218||(_templateObject218=_taggedTemplateLiteral(["{format: ","}"])),e);}},code:function code(e,t){var r=e.gen,s=e.data,a=e.$data,n=e.schema,i=e.schemaCode,c=e.it,l=c.opts,d=c.errSchemaPath,u=c.schemaEnv,f=c.self;l.validateFormats&&(a?function(){var a=r.scopeValue("formats",{ref:f.formats,code:l.code.formats}),n=r["const"]("fDef",o._(_templateObject219||(_templateObject219=_taggedTemplateLiteral(["","[","]"])),a,i)),c=r["let"]("fType"),d=r["let"]("format");r["if"](o._(_templateObject220||(_templateObject220=_taggedTemplateLiteral(["typeof "," == \"object\" && !("," instanceof RegExp)"])),n,n),function(){return r.assign(c,o._(_templateObject221||(_templateObject221=_taggedTemplateLiteral(["",".type || \"string\""])),n)).assign(d,o._(_templateObject222||(_templateObject222=_taggedTemplateLiteral(["",".validate"])),n));},function(){return r.assign(c,o._(_templateObject223||(_templateObject223=_taggedTemplateLiteral(["\"string\""])))).assign(d,n);}),e.fail$data((0,o.or)(!1===l.strictSchema?o.nil:o._(_templateObject224||(_templateObject224=_taggedTemplateLiteral([""," && !",""])),i,d),function(){var e=u.$async?o._(_templateObject225||(_templateObject225=_taggedTemplateLiteral(["(",".async ? await ","(",") : ","(","))"])),n,d,s,d,s):o._(_templateObject226||(_templateObject226=_taggedTemplateLiteral(["","(",")"])),d,s),r=o._(_templateObject227||(_templateObject227=_taggedTemplateLiteral(["(typeof "," == \"function\" ? "," : ",".test(","))"])),d,e,d,s);return o._(_templateObject228||(_templateObject228=_taggedTemplateLiteral([""," && "," !== true && "," === "," && !",""])),d,d,c,t,r);}()));}():function(){var a=f.formats[n];if(!a)return void function(){if(!1===l.strictSchema)return void f.logger.warn(e());throw new Error(e());function e(){return"unknown format \"".concat(n,"\" ignored in schema at path \"").concat(d,"\"");}}();if(!0===a)return;var _ref250=function(e){var t=e instanceof RegExp?(0,o.regexpCode)(e):l.code.formats?o._(_templateObject229||(_templateObject229=_taggedTemplateLiteral(["","",""])),l.code.formats,(0,o.getProperty)(n)):void 0,s=r.scopeValue("formats",{key:n,ref:e,code:t});if("object"==_typeof2(e)&&!(e instanceof RegExp))return[e.type||"string",e.validate,o._(_templateObject230||(_templateObject230=_taggedTemplateLiteral(["",".validate"])),s)];return["string",e,s];}(a),_ref251=_slicedToArray(_ref250,3),i=_ref251[0],c=_ref251[1],p=_ref251[2];i===t&&e.pass(function(){if("object"==_typeof2(a)&&!(a instanceof RegExp)&&a.async){if(!u.$async)throw new Error("async format in sync schema");return o._(_templateObject231||(_templateObject231=_taggedTemplateLiteral(["await ","(",")"])),p,s);}return"function"==typeof c?o._(_templateObject232||(_templateObject232=_taggedTemplateLiteral(["","(",")"])),p,s):o._(_templateObject233||(_templateObject233=_taggedTemplateLiteral(["",".test(",")"])),p,s);}());}());}};},{"../../compile/codegen":2}],50:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./format");r["default"]=[o["default"]];},{"./format":49}],51:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.contentVocabulary=r.metadataVocabulary=void 0,r.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],r.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];},{}],52:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../../runtime/equal");r["default"]={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:function params(_ref252){var e=_ref252.schemaCode;return o._(_templateObject234||(_templateObject234=_taggedTemplateLiteral(["{allowedValue: ","}"])),e);}},code:function code(e){var t=e.gen,r=e.data,n=e.$data,i=e.schemaCode,c=e.schema;n||c&&"object"==_typeof2(c)?e.fail$data(o._(_templateObject235||(_templateObject235=_taggedTemplateLiteral(["!","(",", ",")"])),(0,s.useFunc)(t,a["default"]),r,i)):e.fail(o._(_templateObject236||(_templateObject236=_taggedTemplateLiteral([""," !== ",""])),c,r));}};},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/equal":21}],53:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../../runtime/equal");r["default"]={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:function params(_ref253){var e=_ref253.schemaCode;return o._(_templateObject237||(_templateObject237=_taggedTemplateLiteral(["{allowedValues: ","}"])),e);}},code:function code(e){var t=e.gen,r=e.data,n=e.$data,i=e.schema,c=e.schemaCode,l=e.it;if(!n&&0===i.length)throw new Error("enum must have non-empty array");var d;var u=function u(){return null!=d?d:d=(0,s.useFunc)(t,a["default"]);};var f;if(i.length>=l.opts.loopEnum||n)f=t["let"]("valid"),e.block$data(f,function(){t.assign(f,!1),t.forOf("v",c,function(e){return t["if"](o._(_templateObject238||(_templateObject238=_taggedTemplateLiteral(["","(",", ",")"])),u(),r,e),function(){return t.assign(f,!0)["break"]();});});});else{if(!Array.isArray(i))throw new Error("ajv implementation error");var _e27=t["const"]("vSchema",c);f=(0,o.or).apply(void 0,_toConsumableArray2(i.map(function(t,s){return function(e,t){var s=i[t];return"object"==_typeof2(s)&&null!==s?o._(_templateObject239||(_templateObject239=_taggedTemplateLiteral(["","(",", ","[","])"])),u(),r,e,t):o._(_templateObject240||(_templateObject240=_taggedTemplateLiteral([""," === ",""])),r,s);}(_e27,s);})));}e.pass(f);}};},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/equal":21}],54:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("./limitNumber"),s=e("./multipleOf"),a=e("./limitLength"),n=e("./pattern"),i=e("./limitProperties"),c=e("./required"),l=e("./limitItems"),d=e("./uniqueItems"),u=e("./const"),f=e("./enum");r["default"]=[o["default"],s["default"],a["default"],n["default"],i["default"],c["default"],l["default"],d["default"],{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},u["default"],f["default"]];},{"./const":52,"./enum":53,"./limitItems":55,"./limitLength":56,"./limitNumber":57,"./limitProperties":58,"./multipleOf":59,"./pattern":60,"./required":61,"./uniqueItems":62}],55:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen");r["default"]={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:function message(_ref254){var e=_ref254.keyword,t=_ref254.schemaCode;return o.str(_templateObject241||(_templateObject241=_taggedTemplateLiteral(["must NOT have "," than "," items"])),"maxItems"===e?"more":"fewer",t);},params:function params(_ref255){var e=_ref255.schemaCode;return o._(_templateObject242||(_templateObject242=_taggedTemplateLiteral(["{limit: ","}"])),e);}},code:function code(e){var t=e.keyword,r=e.data,s=e.schemaCode;e.fail$data(o._(_templateObject243||(_templateObject243=_taggedTemplateLiteral(["",".length "," ",""])),r,"maxItems"===t?o.operators.GT:o.operators.LT,s));}};},{"../../compile/codegen":2}],56:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=e("../../compile/util"),a=e("../../runtime/ucs2length");r["default"]={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:function message(_ref256){var e=_ref256.keyword,t=_ref256.schemaCode;return o.str(_templateObject244||(_templateObject244=_taggedTemplateLiteral(["must NOT have "," than "," characters"])),"maxLength"===e?"more":"fewer",t);},params:function params(_ref257){var e=_ref257.schemaCode;return o._(_templateObject245||(_templateObject245=_taggedTemplateLiteral(["{limit: ","}"])),e);}},code:function code(e){var t=e.keyword,r=e.data,n=e.schemaCode,i=e.it,c="maxLength"===t?o.operators.GT:o.operators.LT,l=!1===i.opts.unicode?o._(_templateObject246||(_templateObject246=_taggedTemplateLiteral(["",".length"])),r):o._(_templateObject247||(_templateObject247=_taggedTemplateLiteral(["","(",")"])),(0,s.useFunc)(e.gen,a["default"]),r);e.fail$data(o._(_templateObject248||(_templateObject248=_taggedTemplateLiteral([""," "," ",""])),l,c,n));}};},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/ucs2length":22}],57:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen"),s=o.operators,a={maximum:{okStr:"<=",ok:s.LTE,fail:s.GT},minimum:{okStr:">=",ok:s.GTE,fail:s.LT},exclusiveMaximum:{okStr:"<",ok:s.LT,fail:s.GTE},exclusiveMinimum:{okStr:">",ok:s.GT,fail:s.LTE}},n={message:function message(_ref258){var e=_ref258.keyword,t=_ref258.schemaCode;return o.str(_templateObject249||(_templateObject249=_taggedTemplateLiteral(["must be "," ",""])),a[e].okStr,t);},params:function params(_ref259){var e=_ref259.keyword,t=_ref259.schemaCode;return o._(_templateObject250||(_templateObject250=_taggedTemplateLiteral(["{comparison: ",", limit: ","}"])),a[e].okStr,t);}},i={keyword:Object.keys(a),type:"number",schemaType:"number",$data:!0,error:n,code:function code(e){var t=e.keyword,r=e.data,s=e.schemaCode;e.fail$data(o._(_templateObject251||(_templateObject251=_taggedTemplateLiteral([""," "," "," || isNaN(",")"])),r,a[t].fail,s,r));}};r["default"]=i;},{"../../compile/codegen":2}],58:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen");r["default"]={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:function message(_ref260){var e=_ref260.keyword,t=_ref260.schemaCode;return o.str(_templateObject252||(_templateObject252=_taggedTemplateLiteral(["must NOT have "," than "," properties"])),"maxProperties"===e?"more":"fewer",t);},params:function params(_ref261){var e=_ref261.schemaCode;return o._(_templateObject253||(_templateObject253=_taggedTemplateLiteral(["{limit: ","}"])),e);}},code:function code(e){var t=e.keyword,r=e.data,s=e.schemaCode;e.fail$data(o._(_templateObject254||(_templateObject254=_taggedTemplateLiteral(["Object.keys(",").length "," ",""])),r,"maxProperties"===t?o.operators.GT:o.operators.LT,s));}};},{"../../compile/codegen":2}],59:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/codegen");r["default"]={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:function message(_ref262){var e=_ref262.schemaCode;return o.str(_templateObject255||(_templateObject255=_taggedTemplateLiteral(["must be multiple of ",""])),e);},params:function params(_ref263){var e=_ref263.schemaCode;return o._(_templateObject256||(_templateObject256=_taggedTemplateLiteral(["{multipleOf: ","}"])),e);}},code:function code(e){var t=e.gen,r=e.data,s=e.schemaCode,a=e.it,n=a.opts.multipleOfPrecision,i=t["let"]("res"),c=n?o._(_templateObject257||(_templateObject257=_taggedTemplateLiteral(["Math.abs(Math.round(",") - ",") > 1e-",""])),i,i,n):o._(_templateObject258||(_templateObject258=_taggedTemplateLiteral([""," !== parseInt(",")"])),i,i);e.fail$data(o._(_templateObject259||(_templateObject259=_taggedTemplateLiteral(["("," === 0 || ("," = ","/",", ","))"])),s,i,r,s,c));}};},{"../../compile/codegen":2}],60:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../code"),s=e("../../compile/codegen");r["default"]={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:function message(_ref264){var e=_ref264.schemaCode;return s.str(_templateObject260||(_templateObject260=_taggedTemplateLiteral(["must match pattern \"","\""])),e);},params:function params(_ref265){var e=_ref265.schemaCode;return s._(_templateObject261||(_templateObject261=_taggedTemplateLiteral(["{pattern: ","}"])),e);}},code:function code(e){var t=e.data,r=e.$data,a=e.schema,n=e.schemaCode,i=e.it,c=r?s._(_templateObject262||(_templateObject262=_taggedTemplateLiteral(["(new RegExp(",", ","))"])),n,i.opts.unicodeRegExp?"u":""):(0,o.usePattern)(e,a);e.fail$data(s._(_templateObject263||(_templateObject263=_taggedTemplateLiteral(["!",".test(",")"])),c,t));}};},{"../../compile/codegen":2,"../code":42}],61:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../code"),s=e("../../compile/codegen"),a=e("../../compile/util");r["default"]={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:function message(_ref266){var e=_ref266.params.missingProperty;return s.str(_templateObject264||(_templateObject264=_taggedTemplateLiteral(["must have required property '","'"])),e);},params:function params(_ref267){var e=_ref267.params.missingProperty;return s._(_templateObject265||(_templateObject265=_taggedTemplateLiteral(["{missingProperty: ","}"])),e);}},code:function code(e){var t=e.gen,r=e.schema,n=e.schemaCode,i=e.data,c=e.$data,l=e.it,d=l.opts;if(!c&&0===r.length)return;var u=r.length>=d.loopRequired;if(l.allErrors?function(){if(u||c)e.block$data(s.nil,f);else{var _iterator237=_createForOfIteratorHelper(r),_step237;try{for(_iterator237.s();!(_step237=_iterator237.n()).done;){var _t32=_step237.value;(0,o.checkReportMissingProp)(e,_t32);}}catch(err){_iterator237.e(err);}finally{_iterator237.f();}}}():function(){var a=t["let"]("missing");if(u||c){var _r43=t["let"]("valid",!0);e.block$data(_r43,function(){return function(r,a){e.setParams({missingProperty:r}),t.forOf(r,n,function(){t.assign(a,(0,o.propertyInData)(t,i,r,d.ownProperties)),t["if"]((0,s.not)(a),function(){e.error(),t["break"]();});},s.nil);}(a,_r43);}),e.ok(_r43);}else t["if"]((0,o.checkMissingProp)(e,r,a)),(0,o.reportMissingProp)(e,a),t["else"]();}(),d.strictRequired){var _t33=e.parentSchema.properties,_o13=e.it.definedProperties;var _iterator238=_createForOfIteratorHelper(r),_step238;try{for(_iterator238.s();!(_step238=_iterator238.n()).done;){var _e28=_step238.value;if(void 0===(null==_t33?void 0:_t33[_e28])&&!_o13.has(_e28)){(0,a.checkStrictMode)(l,"required property \"".concat(_e28,"\" is not defined at \"").concat(l.schemaEnv.baseId+l.errSchemaPath,"\" (strictRequired)"),l.opts.strictRequired);}}}catch(err){_iterator238.e(err);}finally{_iterator238.f();}}function f(){t.forOf("prop",n,function(r){e.setParams({missingProperty:r}),t["if"]((0,o.noPropertyInData)(t,i,r,d.ownProperties),function(){return e.error();});});}}};},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],62:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=e("../../compile/validate/dataType"),s=e("../../compile/codegen"),a=e("../../compile/util"),n=e("../../runtime/equal");r["default"]={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:function message(_ref268){var _ref268$params=_ref268.params,e=_ref268$params.i,t=_ref268$params.j;return s.str(_templateObject266||(_templateObject266=_taggedTemplateLiteral(["must NOT have duplicate items (items ## "," and "," are identical)"])),t,e);},params:function params(_ref269){var _ref269$params=_ref269.params,e=_ref269$params.i,t=_ref269$params.j;return s._(_templateObject267||(_templateObject267=_taggedTemplateLiteral(["{i: ",", j: ","}"])),e,t);}},code:function code(e){var t=e.gen,r=e.data,i=e.$data,c=e.schema,l=e.parentSchema,d=e.schemaCode,u=e.it;if(!i&&!c)return;var f=t["let"]("valid"),p=l.items?(0,o.getSchemaTypes)(l.items):[];function m(a,n){var i=t.name("item"),c=(0,o.checkDataTypes)(p,i,u.opts.strictNumbers,o.DataType.Wrong),l=t["const"]("indices",s._(_templateObject268||(_templateObject268=_taggedTemplateLiteral(["{}"]))));t["for"](s._(_templateObject269||(_templateObject269=_taggedTemplateLiteral([";","--;"])),a),function(){t["let"](i,s._(_templateObject270||(_templateObject270=_taggedTemplateLiteral(["","[","]"])),r,a)),t["if"](c,s._(_templateObject271||(_templateObject271=_taggedTemplateLiteral(["continue"])))),p.length>1&&t["if"](s._(_templateObject272||(_templateObject272=_taggedTemplateLiteral(["typeof "," == \"string\""])),i),s._(_templateObject273||(_templateObject273=_taggedTemplateLiteral([""," += \"_\""])),i)),t["if"](s._(_templateObject274||(_templateObject274=_taggedTemplateLiteral(["typeof ","[","] == \"number\""])),l,i),function(){t.assign(n,s._(_templateObject275||(_templateObject275=_taggedTemplateLiteral(["","[","]"])),l,i)),e.error(),t.assign(f,!1)["break"]();}).code(s._(_templateObject276||(_templateObject276=_taggedTemplateLiteral(["","[","] = ",""])),l,i,a));});}function h(o,i){var c=(0,a.useFunc)(t,n["default"]),l=t.name("outer");t.label(l)["for"](s._(_templateObject277||(_templateObject277=_taggedTemplateLiteral([";","--;"])),o),function(){return t["for"](s._(_templateObject278||(_templateObject278=_taggedTemplateLiteral([""," = ","; ","--;"])),i,o,i),function(){return t["if"](s._(_templateObject279||(_templateObject279=_taggedTemplateLiteral(["","(","[","], ","[","])"])),c,r,o,r,i),function(){e.error(),t.assign(f,!1)["break"](l);});});});}e.block$data(f,function(){var o=t["let"]("i",s._(_templateObject280||(_templateObject280=_taggedTemplateLiteral(["",".length"])),r)),a=t["let"]("j");e.setParams({i:o,j:a}),t.assign(f,!0),t["if"](s._(_templateObject281||(_templateObject281=_taggedTemplateLiteral([""," > 1"])),o),function(){return(p.length>0&&!p.some(function(e){return"object"===e||"array"===e;})?m:h)(o,a);});},s._(_templateObject282||(_templateObject282=_taggedTemplateLiteral([""," === false"])),d)),e.ok(f);}};},{"../../compile/codegen":2,"../../compile/util":10,"../../compile/validate/dataType":13,"../../runtime/equal":21}],63:[function(e,t,r){t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==_typeof2(t)&&"object"==_typeof2(r)){if(t.constructor!==r.constructor)return!1;var o,s,a;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(s=o;0!=s--;){if(!e(t[s],r[s]))return!1;}return!0;}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=o;0!=s--;){if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;}for(s=o;0!=s--;){var n=a[s];if(!e(t[n],r[n]))return!1;}return!0;}return t!=t&&r!=r;};},{}],64:[function(e,t,r){var o=t.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),s(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e);};function s(e,t,r,a,n,i,c,l,d,u){if(a&&"object"==_typeof2(a)&&!Array.isArray(a)){for(var f in t(a,n,i,c,l,d,u),a){var p=a[f];if(Array.isArray(p)){if(f in o.arrayKeywords)for(var m=0;m<p.length;m++){s(e,t,r,p[m],n+"/"+f+"/"+m,i,n,f,a,m);}}else if(f in o.propsKeywords){if(p&&"object"==_typeof2(p))for(var h in p){s(e,t,r,p[h],n+"/"+f+"/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),i,n,f,a,h);}}else(f in o.keywords||e.allKeys&&!(f in o.skipKeywords))&&s(e,t,r,p,n+"/"+f,i,n,f,a);}r(a,n,i,c,l,d,u);}}o.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,"if":!0,then:!0,"else":!0},o.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},o.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},o.skipKeywords={"default":!0,"enum":!0,"const":!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};},{}],65:[function(e,t,r){/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */!function(e,o){o("object"==_typeof2(r)&&void 0!==t?r:e.URI=e.URI||{});}(this,function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r];}if(t.length>1){t[0]=t[0].slice(0,-1);for(var o=t.length-1,s=1;s<o;++s){t[s]=t[s].slice(1,-1);}return t[o]=t[o].slice(1),t.join("");}return t[0];}function r(e){return"(?:"+e+")";}function o(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase();}function s(e){return e.toUpperCase();}function a(e){var o="[A-Za-z]",s="[0-9]",a=t(s,"[A-Fa-f]"),n=r(r("%[EFef]"+a+"%"+a+a+"%"+a+a)+"|"+r("%[89A-Fa-f]"+a+"%"+a+a)+"|"+r("%"+a+a)),i="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",c=t("[\\:\\/\\?\\#\\[\\]\\@]",i),l=e?"[\\uE000-\\uF8FF]":"[]",d=t(o,s,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");r(o+t(o,s,"[\\+\\-\\.]")+"*");r(r(n+"|"+t(d,i,"[\\:]"))+"*");var p=r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?"+s),m=r(p+"\\."+p+"\\."+p+"\\."+p),h=r(a+"{1,4}"),y=r(r(h+"\\:"+h)+"|"+m),v=r(r(h+"\\:")+"{6}"+y),g=r("\\:\\:"+r(h+"\\:")+"{5}"+y),$=r(r(h)+"?\\:\\:"+r(h+"\\:")+"{4}"+y),_=r(r(r(h+"\\:")+"{0,1}"+h)+"?\\:\\:"+r(h+"\\:")+"{3}"+y),w=r(r(r(h+"\\:")+"{0,2}"+h)+"?\\:\\:"+r(h+"\\:")+"{2}"+y),b=r(r(r(h+"\\:")+"{0,3}"+h)+"?\\:\\:"+h+"\\:"+y),E=r(r(r(h+"\\:")+"{0,4}"+h)+"?\\:\\:"+y),P=r(r(r(h+"\\:")+"{0,5}"+h)+"?\\:\\:"+h),S=r(r(r(h+"\\:")+"{0,6}"+h)+"?\\:\\:"),N=r([v,g,$,_,w,b,E,P,S].join("|")),k=r(r(d+"|"+n)+"+");r("[vV]"+a+"+\\."+t(d,i,"[\\:]")+"+");r(r(n+"|"+t(d,i))+"*");var D=r(n+"|"+t(d,i,"[\\:\\@]"));r(r(n+"|"+t(d,i,"[\\@]"))+"+");r(r(D+"|"+t("[\\/\\?]",l))+"*");return{NOT_SCHEME:new RegExp(t("[^]",o,s,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",d,i),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",d,i),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",d,i),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",d,i),"g"),NOT_QUERY:new RegExp(t("[^\\%]",d,i,"[\\:\\@\\/\\?]",l),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",d,i,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",d,i),"g"),UNRESERVED:new RegExp(d,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",d,c),"g"),PCT_ENCODED:new RegExp(n,"g"),IPV4ADDRESS:new RegExp("^("+m+")$"),IPV6ADDRESS:new RegExp("^\\[?("+N+")"+r(r("\\%25|\\%(?!"+a+"{2})")+"("+k+")")+"?\\]?$")};}var n=a(!1),i=a(!0),c=function c(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,s=!1,a=void 0;try{for(var n,i=e[Symbol.iterator]();!(o=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0){;}}catch(e){s=!0,a=e;}finally{try{!o&&i["return"]&&i["return"]();}finally{if(s)throw a;}}return r;}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance");},l=2147483647,d=36,u=/^xn--/,f=/[^\0-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,y=String.fromCharCode;function v(e){throw new RangeError(m[e]);}function g(e,t){var r=e.split("@"),o="";r.length>1&&(o=r[0]+"@",e=r[1]);var s=function(e,t){for(var r=[],o=e.length;o--;){r[o]=t(e[o]);}return r;}((e=e.replace(p,".")).split("."),t).join(".");return o+s;}function $(e){for(var t=[],r=0,o=e.length;r<o;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<o){var a=e.charCodeAt(r++);56320==(64512&a)?t.push(((1023&s)<<10)+(1023&a)+65536):(t.push(s),r--);}else t.push(s);}return t;}var _=function _(e,t){return e+22+75*(e<26)-((0!=t)<<5);},w=function w(e,t,r){var o=0;for(e=r?h(e/700):e>>1,e+=h(e/t);e>455;o+=d){e=h(e/35);}return h(o+36*e/(e+38));},b=function b(e){var t,r=[],o=e.length,s=0,a=128,n=72,i=e.lastIndexOf("-");i<0&&(i=0);for(var c=0;c<i;++c){e.charCodeAt(c)>=128&&v("not-basic"),r.push(e.charCodeAt(c));}for(var u=i>0?i+1:0;u<o;){for(var f=s,p=1,m=d;;m+=d){u>=o&&v("invalid-input");var y=(t=e.charCodeAt(u++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:d;(y>=d||y>h((l-s)/p))&&v("overflow"),s+=y*p;var g=m<=n?1:m>=n+26?26:m-n;if(y<g)break;var $=d-g;p>h(l/$)&&v("overflow"),p*=$;}var _=r.length+1;n=w(s-f,_,0==f),h(s/_)>l-a&&v("overflow"),a+=h(s/_),s%=_,r.splice(s++,0,a);}return String.fromCodePoint.apply(String,r);},E=function E(e){var t=[],r=(e=$(e)).length,o=128,s=0,a=72,n=!0,i=!1,c=void 0;try{for(var u,f=e[Symbol.iterator]();!(n=(u=f.next()).done);n=!0){var p=u.value;p<128&&t.push(y(p));}}catch(e){i=!0,c=e;}finally{try{!n&&f["return"]&&f["return"]();}finally{if(i)throw c;}}var m=t.length,g=m;for(m&&t.push("-");g<r;){var b=l,E=!0,P=!1,S=void 0;try{for(var N,k=e[Symbol.iterator]();!(E=(N=k.next()).done);E=!0){var j=N.value;j>=o&&j<b&&(b=j);}}catch(e){P=!0,S=e;}finally{try{!E&&k["return"]&&k["return"]();}finally{if(P)throw S;}}var C=g+1;b-o>h((l-s)/C)&&v("overflow"),s+=(b-o)*C,o=b;var O=!0,x=!1,T=void 0;try{for(var I,R=e[Symbol.iterator]();!(O=(I=R.next()).done);O=!0){var D=I.value;if(D<o&&++s>l&&v("overflow"),D==o){for(var A=s,M=d;;M+=d){var V=M<=a?1:M>=a+26?26:M-a;if(A<V)break;var F=A-V,q=d-V;t.push(y(_(V+F%q,0))),A=h(F/q);}t.push(y(_(A,0))),a=w(s,C,g==m),s=0,++g;}}}catch(e){x=!0,T=e;}finally{try{!O&&R["return"]&&R["return"]();}finally{if(x)throw T;}}++s,++o;}return t.join("");},P=function P(e){return g(e,function(e){return f.test(e)?"xn--"+E(e):e;});},S=function S(e){return g(e,function(e){return u.test(e)?b(e.slice(4).toLowerCase()):e;});},N={};function k(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase();}function j(e){for(var t="",r=0,o=e.length;r<o;){var s=parseInt(e.substr(r+1,2),16);if(s<128)t+=String.fromCharCode(s),r+=3;else if(s>=194&&s<224){if(o-r>=6){var a=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&s)<<6|63&a);}else t+=e.substr(r,6);r+=6;}else if(s>=224){if(o-r>=9){var n=parseInt(e.substr(r+4,2),16),i=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&s)<<12|(63&n)<<6|63&i);}else t+=e.substr(r,9);r+=9;}else t+=e.substr(r,3),r+=3;}return t;}function C(e,t){function r(e){var r=j(e);return r.match(t.UNRESERVED)?r:e;}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,k).replace(t.PCT_ENCODED,s)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,k).replace(t.PCT_ENCODED,s)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,k).replace(t.PCT_ENCODED,s)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,k).replace(t.PCT_ENCODED,s)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,k).replace(t.PCT_ENCODED,s)),e;}function O(e){return e.replace(/^0*(.*)/,"$1")||"0";}function x(e,t){var r=e.match(t.IPV4ADDRESS)||[],o=c(r,2)[1];return o?o.split(".").map(O).join("."):e;}function T(e,t){var r=e.match(t.IPV6ADDRESS)||[],o=c(r,3),s=o[1],a=o[2];if(s){for(var n=s.toLowerCase().split("::").reverse(),i=c(n,2),l=i[0],d=i[1],u=d?d.split(":").map(O):[],f=l.split(":").map(O),p=t.IPV4ADDRESS.test(f[f.length-1]),m=p?7:8,h=f.length-m,y=Array(m),v=0;v<m;++v){y[v]=u[v]||f[h+v]||"";}p&&(y[m-1]=x(y[m-1],t));var g=y.reduce(function(e,t,r){if(!t||"0"===t){var o=e[e.length-1];o&&o.index+o.length===r?o.length++:e.push({index:r,length:1});}return e;},[]).sort(function(e,t){return t.length-e.length;})[0],$=void 0;if(g&&g.length>1){var _=y.slice(0,g.index),w=y.slice(g.index+g.length);$=_.join(":")+"::"+w.join(":");}else $=y.join(":");return a&&($+="%"+a),$;}return e;}var I=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,R=void 0==="".match(/(){0}/)[1];function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},o=!1!==t.iri?i:n;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var s=e.match(I);if(s){R?(r.scheme=s[1],r.userinfo=s[3],r.host=s[4],r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=s[7],r.fragment=s[8],isNaN(r.port)&&(r.port=s[5])):(r.scheme=s[1]||void 0,r.userinfo=-1!==e.indexOf("@")?s[3]:void 0,r.host=-1!==e.indexOf("//")?s[4]:void 0,r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=-1!==e.indexOf("?")?s[7]:void 0,r.fragment=-1!==e.indexOf("#")?s[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?s[4]:void 0)),r.host&&(r.host=T(x(r.host,o),o)),r.reference=void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?"relative":void 0===r.fragment?"absolute":"uri":"same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var a=N[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||a&&a.unicodeSupport)C(r,o);else{if(r.host&&(t.domainHost||a&&a.domainHost))try{r.host=P(r.host.replace(o.PCT_ENCODED,j).toLowerCase());}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e;}C(r,n);}a&&a.parse&&a.parse(r,t);}else r.error=r.error||"URI can not be parsed.";return r;}function A(e,t){var r=!1!==t.iri?i:n,o=[];return void 0!==e.userinfo&&(o.push(e.userinfo),o.push("@")),void 0!==e.host&&o.push(T(x(String(e.host),r),r).replace(r.IPV6ADDRESS,function(e,t,r){return"["+t+(r?"%25"+r:"")+"]";})),"number"!=typeof e.port&&"string"!=typeof e.port||(o.push(":"),o.push(String(e.port))),o.length?o.join(""):void 0;}var M=/^\.\.?\//,V=/^\/\.(\/|$)/,F=/^\/\.\.(\/|$)/,q=/^\/?(?:.|\n)*?(?=\/|$)/;function U(e){for(var t=[];e.length;){if(e.match(M))e=e.replace(M,"");else if(e.match(V))e=e.replace(V,"/");else if(e.match(F))e=e.replace(F,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(q);if(!r)throw new Error("Unexpected dot segment condition");var o=r[0];e=e.slice(o.length),t.push(o);}}return t.join("");}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?i:n,o=[],s=N[(t.scheme||e.scheme||"").toLowerCase()];if(s&&s.serialize&&s.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||s&&s.domainHost)try{e.host=t.iri?S(e.host):P(e.host.replace(r.PCT_ENCODED,j).toLowerCase());}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r;}C(e,r),"suffix"!==t.reference&&e.scheme&&(o.push(e.scheme),o.push(":"));var a=A(e,t);if(void 0!==a&&("suffix"!==t.reference&&o.push("//"),o.push(a),e.path&&"/"!==e.path.charAt(0)&&o.push("/")),void 0!==e.path){var c=e.path;t.absolutePath||s&&s.absolutePath||(c=U(c)),void 0===a&&(c=c.replace(/^\/\//,"/%2F")),o.push(c);}return void 0!==e.query&&(o.push("?"),o.push(e.query)),void 0!==e.fragment&&(o.push("#"),o.push(e.fragment)),o.join("");}function K(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],s={};return o||(e=D(z(e,r),r),t=D(z(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=U(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=U(t.path||""),s.query=t.query):(t.path?("/"===t.path.charAt(0)?s.path=U(t.path):(s.path=void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:t.path:"/"+t.path,s.path=U(s.path)),s.query=t.query):(s.path=e.path,s.query=void 0!==t.query?t.query:e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s;}function L(e,t){return e&&e.toString().replace(t&&t.iri?i.PCT_ENCODED:n.PCT_ENCODED,j);}var H={scheme:"http",domainHost:!0,parse:function parse(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e;},serialize:function serialize(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e;}},G={scheme:"https",domainHost:H.domainHost,parse:H.parse,serialize:H.serialize};function J(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase();}var B={scheme:"ws",domainHost:!0,parse:function parse(e,t){var r=e;return r.secure=J(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r;},serialize:function serialize(e,t){if(e.port!==(J(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),o=c(r,2),s=o[0],a=o[1];e.path=s&&"/"!==s?s:void 0,e.query=a,e.resourceName=void 0;}return e.fragment=void 0,e;}},W={scheme:"wss",domainHost:B.domainHost,parse:B.parse,serialize:B.serialize},Q={},Z="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Y="[0-9A-Fa-f]",X=r(r("%[EFef][0-9A-Fa-f]%"+Y+Y+"%"+Y+Y)+"|"+r("%[89A-Fa-f][0-9A-Fa-f]%"+Y+Y)+"|"+r("%"+Y+Y)),ee=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),te=new RegExp(Z,"g"),re=new RegExp(X,"g"),oe=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',ee),"g"),se=new RegExp(t("[^]",Z,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ae=se;function ne(e){var t=j(e);return t.match(te)?t:e;}var ie={scheme:"mailto",parse:function parse(e,t){var r=e,o=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var s=!1,a={},n=r.query.split("&"),i=0,c=n.length;i<c;++i){var l=n[i].split("=");switch(l[0]){case"to":for(var d=l[1].split(","),u=0,f=d.length;u<f;++u){o.push(d[u]);}break;case"subject":r.subject=L(l[1],t);break;case"body":r.body=L(l[1],t);break;default:s=!0,a[L(l[0],t)]=L(l[1],t);}}s&&(r.headers=a);}r.query=void 0;for(var p=0,m=o.length;p<m;++p){var h=o[p].split("@");if(h[0]=L(h[0]),t.unicodeSupport)h[1]=L(h[1],t).toLowerCase();else try{h[1]=P(L(h[1],t).toLowerCase());}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e;}o[p]=h.join("@");}return r;},serialize:function serialize(e,t){var r,o=e,a=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(a){for(var n=0,i=a.length;n<i;++n){var c=String(a[n]),l=c.lastIndexOf("@"),d=c.slice(0,l).replace(re,ne).replace(re,s).replace(oe,k),u=c.slice(l+1);try{u=t.iri?S(u):P(L(u,t).toLowerCase());}catch(e){o.error=o.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e;}a[n]=d+"@"+u;}o.path=a.join(",");}var f=e.headers=e.headers||{};e.subject&&(f.subject=e.subject),e.body&&(f.body=e.body);var p=[];for(var m in f){f[m]!==Q[m]&&p.push(m.replace(re,ne).replace(re,s).replace(se,k)+"="+f[m].replace(re,ne).replace(re,s).replace(ae,k));}return p.length&&(o.query=p.join("&")),o;}},ce=/^([^\:]+)\:(.*)/,le={scheme:"urn",parse:function parse(e,t){var r=e.path&&e.path.match(ce),o=e;if(r){var s=t.scheme||o.scheme||"urn",a=r[1].toLowerCase(),n=r[2],i=N[s+":"+(t.nid||a)];o.nid=a,o.nss=n,o.path=void 0,i&&(o=i.parse(o,t));}else o.error=o.error||"URN can not be parsed.";return o;},serialize:function serialize(e,t){var r=e.nid,o=N[(t.scheme||e.scheme||"urn")+":"+(t.nid||r)];o&&(e=o.serialize(e,t));var s=e;return s.path=(r||t.nid)+":"+e.nss,s;}},de=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ue={scheme:"urn:uuid",parse:function parse(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(de)||(r.error=r.error||"UUID is not valid."),r;},serialize:function serialize(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r;}};N[H.scheme]=H,N[G.scheme]=G,N[B.scheme]=B,N[W.scheme]=W,N[ie.scheme]=ie,N[le.scheme]=le,N[ue.scheme]=ue,e.SCHEMES=N,e.pctEncChar=k,e.pctDecChars=j,e.parse=D,e.removeDotSegments=U,e.serialize=z,e.resolveComponents=K,e.resolve=function(e,t,r){var o=function(e,t){var r=e;if(t)for(var o in t){r[o]=t[o];}return r;}({scheme:"null"},r);return z(K(D(e,o),D(t,o),o,!0),o);},e.normalize=function(e,t){return"string"==typeof e?e=z(D(e,t),t):"object"===o(e)&&(e=D(z(e,t),t)),e;},e.equal=function(e,t,r){return"string"==typeof e?e=z(D(e,r),r):"object"===o(e)&&(e=z(e,r)),"string"==typeof t?t=z(D(t,r),r):"object"===o(t)&&(t=z(t,r)),e===t;},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?i.ESCAPE:n.ESCAPE,k);},e.unescapeComponent=L,Object.defineProperty(e,"__esModule",{value:!0});});},{}],ajv:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CodeGen=r.Name=r.nil=r.stringify=r.str=r._=r.KeywordCxt=void 0;var o=e("./core"),s=e("./vocabularies/draft7"),a=e("./vocabularies/discriminator"),n=e("./refs/json-schema-draft-07.json"),i=["/properties"],c="http://json-schema.org/draft-07/schema";var l=/*#__PURE__*/function(_o$default){_inherits(l,_o$default);var _super129=_createSuper(l);function l(){_classCallCheck(this,l);return _super129.apply(this,arguments);}_createClass(l,[{key:"_addVocabularies",value:function _addVocabularies(){var _this183=this;_get(_getPrototypeOf(l.prototype),"_addVocabularies",this).call(this),s["default"].forEach(function(e){return _this183.addVocabulary(e);}),this.opts.discriminator&&this.addKeyword(a["default"]);}},{key:"_addDefaultMetaSchema",value:function _addDefaultMetaSchema(){if(_get(_getPrototypeOf(l.prototype),"_addDefaultMetaSchema",this).call(this),!this.opts.meta)return;var e=this.opts.$data?this.$dataMetaSchema(n,i):n;this.addMetaSchema(e,c,!1),this.refs["http://json-schema.org/schema"]=c;}},{key:"defaultMeta",value:function defaultMeta(){return this.opts.defaultMeta=_get(_getPrototypeOf(l.prototype),"defaultMeta",this).call(this)||(this.getSchema(c)?c:void 0);}}]);return l;}(o["default"]);t.exports=r=l,Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=l;var d=e("./compile/validate");Object.defineProperty(r,"KeywordCxt",{enumerable:!0,get:function get(){return d.KeywordCxt;}});var u=e("./compile/codegen");Object.defineProperty(r,"_",{enumerable:!0,get:function get(){return u._;}}),Object.defineProperty(r,"str",{enumerable:!0,get:function get(){return u.str;}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function get(){return u.stringify;}}),Object.defineProperty(r,"nil",{enumerable:!0,get:function get(){return u.nil;}}),Object.defineProperty(r,"Name",{enumerable:!0,get:function get(){return u.Name;}}),Object.defineProperty(r,"CodeGen",{enumerable:!0,get:function get(){return u.CodeGen;}});},{"./compile/codegen":2,"./compile/validate":15,"./core":18,"./refs/json-schema-draft-07.json":20,"./vocabularies/discriminator":46,"./vocabularies/draft7":48}]},{},[])("ajv");});})(ajv7_min);var Ajv=/*@__PURE__*/getDefaultExportFromCjs(ajv7_min.exports);/**
 * Create a JSON Schema validator powered by Ajv.
 * @param schema
 * @param [schemaDefinitions=undefined]
 *                    An object containing JSON Schema definitions
 *                    which can be referenced using $ref
 * @param [ajvOptions] Optional extra options for Ajv
 * @return Returns a validation function
 */function createAjvValidator(schema){var schemaDefinitions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;var ajvOptions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var ajv=new Ajv(_objectSpread2({allErrors:true,verbose:true,$data:true},ajvOptions));if(schemaDefinitions){Object.keys(schemaDefinitions).forEach(function(ref){ajv.addSchema(schemaDefinitions[ref],ref);});}var validateAjv=ajv.compile(schema);return function validate(json){validateAjv(json);var ajvErrors=validateAjv.errors||[];return ajvErrors.map(improveAjvError).map(function(error){return normalizeAjvError(json,error);});};}function normalizeAjvError(json,ajvError){return{path:immutableJSONPatch.exports.parsePath(json,ajvError.instancePath),message:ajvError.message,severity:ValidationSeverity.warning};}/**
 * Improve the error message of a JSON schema error,
 * for example list the available values of an enum.
 *
 * @param {Object} ajvError
 * @return {Object} Returns the error with improved message
 */function improveAjvError(ajvError){if(ajvError.keyword==='enum'&&Array.isArray(ajvError.schema)){var enums=ajvError.schema;if(enums){enums=enums.map(function(value){return JSON.stringify(value);});if(enums.length>5){var more=['('+(enums.length-5)+' more...)'];enums=enums.slice(0,5);enums.push(more);}ajvError.message='should be equal to one of: '+enums.join(', ');}}if(ajvError.keyword==='additionalProperties'){ajvError.message='should NOT have additional property: '+ajvError.params.additionalProperty;}return ajvError;}var description$1="\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n  You can use <a href=\"https://lodash.com\" target=\"_blank\" rel=\"noopener noreferrer\">Lodash</a>\n  functions like <code>_.map</code>, <code>_.filter</code>,\n  <code>_.orderBy</code>, <code>_.sortBy</code>, <code>_.groupBy</code>,\n  <code>_.pick</code>, <code>_.uniq</code>, <code>_.get</code>, etcetera.\n</p>\n";var lodashQueryLanguage={id:'lodash',name:'Lodash',description:description$1,createQuery:createQuery$1,executeQuery:executeQuery$1};exports.lodashQueryLanguage=lodashQueryLanguage;function createQuery$1(json,queryOptions){var filter=queryOptions.filter,sort=queryOptions.sort,projection=queryOptions.projection;var queryParts=[];if(filter&&filter.path&&filter.relation&&filter.value){// Note that the comparisons embrace type coercion,
// so a filter value like '5' (text) will match numbers like 5 too.
var actualValueGetter="item => item".concat(createPropertySelector(filter.path));var filterValue=parseString(filter.value);var filterValueStr=typeof filterValue==='string'?"'".concat(filter.value,"'"):isInteger$1(filter.value)&&!Number.isSafeInteger(filterValue)?"".concat(filter.value,"n")// bigint
:filter.value;queryParts.push("  data = _.filter(data, ".concat(actualValueGetter," ").concat(filter.relation," ").concat(filterValueStr,")\n"));}if(sort&&sort.path&&sort.direction){queryParts.push("  data = _.orderBy(data, [".concat(createLodashPropertySelector(sort.path),"], ['").concat(sort.direction,"'])\n"));}if(projection&&projection.paths){// It is possible to make a util function "pickFlat"
// and use that when building the query to make it more readable.
if(projection.paths.length>1){// Note that we do not use _.pick() here because this function doesn't flatten the results
var paths=projection.paths.map(function(path){var name=last(path)||'item';// 'item' in case of having selected the whole item
return"    ".concat(JSON.stringify(name),": item").concat(createPropertySelector(path));});queryParts.push("  data = _.map(data, item => ({\n".concat(paths.join(',\n'),"\n  }))\n"));}else{var path=projection.paths[0];queryParts.push("  data = _.map(data, item => item".concat(createPropertySelector(path),")\n"));}}queryParts.push('  return data\n');return"function query (data) {\n".concat(queryParts.join(''),"}");}function executeQuery$1(json,query){// FIXME: replace unsafe new Function with a JS based query language
//  As long as we don't persist or fetch queries, there is no security risk.
// TODO: only import the most relevant subset of lodash instead of the full library?
// eslint-disable-next-line no-new-func
var queryFn=new Function('_','"use strict";\n'+'\n'+query+'\n'+'\n'+'if (typeof query !== "function") {\n'+'  throw new Error("Cannot execute query: expecting a function named \'query\' but is undefined")\n'+'}\n'+'\n'+'return query;\n')(_);var output=queryFn(json);return output!==undefined?output:null;}var jmespath={};(function(exports){(function(exports){function isArray(obj){if(obj!==null){return Object.prototype.toString.call(obj)==="[object Array]";}else{return false;}}function isObject(obj){if(obj!==null){return Object.prototype.toString.call(obj)==="[object Object]";}else{return false;}}function strictDeepEqual(first,second){// Check the scalar case first.
if(first===second){return true;}// Check if they are the same type.
var firstType=Object.prototype.toString.call(first);if(firstType!==Object.prototype.toString.call(second)){return false;}// We know that first and second have the same type so we can just check the
// first type from now on.
if(isArray(first)===true){// Short circuit if they're not the same length;
if(first.length!==second.length){return false;}for(var i=0;i<first.length;i++){if(strictDeepEqual(first[i],second[i])===false){return false;}}return true;}if(isObject(first)===true){// An object is equal if it has the same key/value pairs.
var keysSeen={};for(var key in first){if(hasOwnProperty.call(first,key)){if(strictDeepEqual(first[key],second[key])===false){return false;}keysSeen[key]=true;}}// Now check that there aren't any keys in second that weren't
// in first.
for(var key2 in second){if(hasOwnProperty.call(second,key2)){if(keysSeen[key2]!==true){return false;}}}return true;}return false;}function isFalse(obj){// From the spec:
// A false value corresponds to the following values:
// Empty list
// Empty object
// Empty string
// False boolean
// null value
// First check the scalar values.
if(obj===""||obj===false||obj===null){return true;}else if(isArray(obj)&&obj.length===0){// Check for an empty array.
return true;}else if(isObject(obj)){// Check for an empty object.
for(var key in obj){// If there are any keys, then
// the object is not empty so the object
// is not false.
if(obj.hasOwnProperty(key)){return false;}}return true;}else{return false;}}function objValues(obj){var keys=Object.keys(obj);var values=[];for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}return values;}var trimLeft;if(typeof String.prototype.trimLeft==="function"){trimLeft=function trimLeft(str){return str.trimLeft();};}else{trimLeft=function trimLeft(str){return str.match(/^\s*(.*)/)[1];};}// Type constants used to define functions.
var TYPE_NUMBER=0;var TYPE_ANY=1;var TYPE_STRING=2;var TYPE_ARRAY=3;var TYPE_OBJECT=4;var TYPE_BOOLEAN=5;var TYPE_EXPREF=6;var TYPE_NULL=7;var TYPE_ARRAY_NUMBER=8;var TYPE_ARRAY_STRING=9;var TYPE_NAME_TABLE={0:'number',1:'any',2:'string',3:'array',4:'object',5:'boolean',6:'expression',7:'null',8:'Array<number>',9:'Array<string>'};var TOK_EOF="EOF";var TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier";var TOK_QUOTEDIDENTIFIER="QuotedIdentifier";var TOK_RBRACKET="Rbracket";var TOK_RPAREN="Rparen";var TOK_COMMA="Comma";var TOK_COLON="Colon";var TOK_RBRACE="Rbrace";var TOK_NUMBER="Number";var TOK_CURRENT="Current";var TOK_EXPREF="Expref";var TOK_PIPE="Pipe";var TOK_OR="Or";var TOK_AND="And";var TOK_EQ="EQ";var TOK_GT="GT";var TOK_LT="LT";var TOK_GTE="GTE";var TOK_LTE="LTE";var TOK_NE="NE";var TOK_FLATTEN="Flatten";var TOK_STAR="Star";var TOK_FILTER="Filter";var TOK_DOT="Dot";var TOK_NOT="Not";var TOK_LBRACE="Lbrace";var TOK_LBRACKET="Lbracket";var TOK_LPAREN="Lparen";var TOK_LITERAL="Literal";// The "&", "[", "<", ">" tokens
// are not in basicToken because
// there are two token variants
// ("&&", "[?", "<=", ">=").  This is specially handled
// below.
var basicTokens={".":TOK_DOT,"*":TOK_STAR,",":TOK_COMMA,":":TOK_COLON,"{":TOK_LBRACE,"}":TOK_RBRACE,"]":TOK_RBRACKET,"(":TOK_LPAREN,")":TOK_RPAREN,"@":TOK_CURRENT};var operatorStartToken={"<":true,">":true,"=":true,"!":true};var skipChars={" ":true,"\t":true,"\n":true};function isAlpha(ch){return ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"||ch==="_";}function isNum(ch){return ch>="0"&&ch<="9"||ch==="-";}function isAlphaNum(ch){return ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"||ch>="0"&&ch<="9"||ch==="_";}function Lexer(){}Lexer.prototype={tokenize:function tokenize(stream){var tokens=[];this._current=0;var start;var identifier;var token;while(this._current<stream.length){if(isAlpha(stream[this._current])){start=this._current;identifier=this._consumeUnquotedIdentifier(stream);tokens.push({type:TOK_UNQUOTEDIDENTIFIER,value:identifier,start:start});}else if(basicTokens[stream[this._current]]!==undefined){tokens.push({type:basicTokens[stream[this._current]],value:stream[this._current],start:this._current});this._current++;}else if(isNum(stream[this._current])){token=this._consumeNumber(stream);tokens.push(token);}else if(stream[this._current]==="["){// No need to increment this._current.  This happens
// in _consumeLBracket
token=this._consumeLBracket(stream);tokens.push(token);}else if(stream[this._current]==="\""){start=this._current;identifier=this._consumeQuotedIdentifier(stream);tokens.push({type:TOK_QUOTEDIDENTIFIER,value:identifier,start:start});}else if(stream[this._current]==="'"){start=this._current;identifier=this._consumeRawStringLiteral(stream);tokens.push({type:TOK_LITERAL,value:identifier,start:start});}else if(stream[this._current]==="`"){start=this._current;var literal=this._consumeLiteral(stream);tokens.push({type:TOK_LITERAL,value:literal,start:start});}else if(operatorStartToken[stream[this._current]]!==undefined){tokens.push(this._consumeOperator(stream));}else if(skipChars[stream[this._current]]!==undefined){// Ignore whitespace.
this._current++;}else if(stream[this._current]==="&"){start=this._current;this._current++;if(stream[this._current]==="&"){this._current++;tokens.push({type:TOK_AND,value:"&&",start:start});}else{tokens.push({type:TOK_EXPREF,value:"&",start:start});}}else if(stream[this._current]==="|"){start=this._current;this._current++;if(stream[this._current]==="|"){this._current++;tokens.push({type:TOK_OR,value:"||",start:start});}else{tokens.push({type:TOK_PIPE,value:"|",start:start});}}else{var error=new Error("Unknown character:"+stream[this._current]);error.name="LexerError";throw error;}}return tokens;},_consumeUnquotedIdentifier:function _consumeUnquotedIdentifier(stream){var start=this._current;this._current++;while(this._current<stream.length&&isAlphaNum(stream[this._current])){this._current++;}return stream.slice(start,this._current);},_consumeQuotedIdentifier:function _consumeQuotedIdentifier(stream){var start=this._current;this._current++;var maxLength=stream.length;while(stream[this._current]!=="\""&&this._current<maxLength){// You can escape a double quote and you can escape an escape.
var current=this._current;if(stream[current]==="\\"&&(stream[current+1]==="\\"||stream[current+1]==="\"")){current+=2;}else{current++;}this._current=current;}this._current++;return JSON.parse(stream.slice(start,this._current));},_consumeRawStringLiteral:function _consumeRawStringLiteral(stream){var start=this._current;this._current++;var maxLength=stream.length;while(stream[this._current]!=="'"&&this._current<maxLength){// You can escape a single quote and you can escape an escape.
var current=this._current;if(stream[current]==="\\"&&(stream[current+1]==="\\"||stream[current+1]==="'")){current+=2;}else{current++;}this._current=current;}this._current++;var literal=stream.slice(start+1,this._current-1);return literal.replace("\\'","'");},_consumeNumber:function _consumeNumber(stream){var start=this._current;this._current++;var maxLength=stream.length;while(isNum(stream[this._current])&&this._current<maxLength){this._current++;}var value=parseInt(stream.slice(start,this._current));return{type:TOK_NUMBER,value:value,start:start};},_consumeLBracket:function _consumeLBracket(stream){var start=this._current;this._current++;if(stream[this._current]==="?"){this._current++;return{type:TOK_FILTER,value:"[?",start:start};}else if(stream[this._current]==="]"){this._current++;return{type:TOK_FLATTEN,value:"[]",start:start};}else{return{type:TOK_LBRACKET,value:"[",start:start};}},_consumeOperator:function _consumeOperator(stream){var start=this._current;var startingChar=stream[start];this._current++;if(startingChar==="!"){if(stream[this._current]==="="){this._current++;return{type:TOK_NE,value:"!=",start:start};}else{return{type:TOK_NOT,value:"!",start:start};}}else if(startingChar==="<"){if(stream[this._current]==="="){this._current++;return{type:TOK_LTE,value:"<=",start:start};}else{return{type:TOK_LT,value:"<",start:start};}}else if(startingChar===">"){if(stream[this._current]==="="){this._current++;return{type:TOK_GTE,value:">=",start:start};}else{return{type:TOK_GT,value:">",start:start};}}else if(startingChar==="="){if(stream[this._current]==="="){this._current++;return{type:TOK_EQ,value:"==",start:start};}}},_consumeLiteral:function _consumeLiteral(stream){this._current++;var start=this._current;var maxLength=stream.length;var literal;while(stream[this._current]!=="`"&&this._current<maxLength){// You can escape a literal char or you can escape the escape.
var current=this._current;if(stream[current]==="\\"&&(stream[current+1]==="\\"||stream[current+1]==="`")){current+=2;}else{current++;}this._current=current;}var literalString=trimLeft(stream.slice(start,this._current));literalString=literalString.replace("\\`","`");if(this._looksLikeJSON(literalString)){literal=JSON.parse(literalString);}else{// Try to JSON parse it as "<literal>"
literal=JSON.parse("\""+literalString+"\"");}// +1 gets us to the ending "`", +1 to move on to the next char.
this._current++;return literal;},_looksLikeJSON:function _looksLikeJSON(literalString){var startingChars="[{\"";var jsonLiterals=["true","false","null"];var numberLooking="-0123456789";if(literalString===""){return false;}else if(startingChars.indexOf(literalString[0])>=0){return true;}else if(jsonLiterals.indexOf(literalString)>=0){return true;}else if(numberLooking.indexOf(literalString[0])>=0){try{JSON.parse(literalString);return true;}catch(ex){return false;}}else{return false;}}};var bindingPower={};bindingPower[TOK_EOF]=0;bindingPower[TOK_UNQUOTEDIDENTIFIER]=0;bindingPower[TOK_QUOTEDIDENTIFIER]=0;bindingPower[TOK_RBRACKET]=0;bindingPower[TOK_RPAREN]=0;bindingPower[TOK_COMMA]=0;bindingPower[TOK_RBRACE]=0;bindingPower[TOK_NUMBER]=0;bindingPower[TOK_CURRENT]=0;bindingPower[TOK_EXPREF]=0;bindingPower[TOK_PIPE]=1;bindingPower[TOK_OR]=2;bindingPower[TOK_AND]=3;bindingPower[TOK_EQ]=5;bindingPower[TOK_GT]=5;bindingPower[TOK_LT]=5;bindingPower[TOK_GTE]=5;bindingPower[TOK_LTE]=5;bindingPower[TOK_NE]=5;bindingPower[TOK_FLATTEN]=9;bindingPower[TOK_STAR]=20;bindingPower[TOK_FILTER]=21;bindingPower[TOK_DOT]=40;bindingPower[TOK_NOT]=45;bindingPower[TOK_LBRACE]=50;bindingPower[TOK_LBRACKET]=55;bindingPower[TOK_LPAREN]=60;function Parser(){}Parser.prototype={parse:function parse(expression){this._loadTokens(expression);this.index=0;var ast=this.expression(0);if(this._lookahead(0)!==TOK_EOF){var t=this._lookaheadToken(0);var error=new Error("Unexpected token type: "+t.type+", value: "+t.value);error.name="ParserError";throw error;}return ast;},_loadTokens:function _loadTokens(expression){var lexer=new Lexer();var tokens=lexer.tokenize(expression);tokens.push({type:TOK_EOF,value:"",start:expression.length});this.tokens=tokens;},expression:function expression(rbp){var leftToken=this._lookaheadToken(0);this._advance();var left=this.nud(leftToken);var currentToken=this._lookahead(0);while(rbp<bindingPower[currentToken]){this._advance();left=this.led(currentToken,left);currentToken=this._lookahead(0);}return left;},_lookahead:function _lookahead(number){return this.tokens[this.index+number].type;},_lookaheadToken:function _lookaheadToken(number){return this.tokens[this.index+number];},_advance:function _advance(){this.index++;},nud:function nud(token){var left;var right;var expression;switch(token.type){case TOK_LITERAL:return{type:"Literal",value:token.value};case TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:token.value};case TOK_QUOTEDIDENTIFIER:var node={type:"Field",name:token.value};if(this._lookahead(0)===TOK_LPAREN){throw new Error("Quoted identifier not allowed for function names.");}return node;case TOK_NOT:right=this.expression(bindingPower.Not);return{type:"NotExpression",children:[right]};case TOK_STAR:left={type:"Identity"};right=null;if(this._lookahead(0)===TOK_RBRACKET){// This can happen in a multiselect,
// [a, b, *]
right={type:"Identity"};}else{right=this._parseProjectionRHS(bindingPower.Star);}return{type:"ValueProjection",children:[left,right]};case TOK_FILTER:return this.led(token.type,{type:"Identity"});case TOK_LBRACE:return this._parseMultiselectHash();case TOK_FLATTEN:left={type:TOK_FLATTEN,children:[{type:"Identity"}]};right=this._parseProjectionRHS(bindingPower.Flatten);return{type:"Projection",children:[left,right]};case TOK_LBRACKET:if(this._lookahead(0)===TOK_NUMBER||this._lookahead(0)===TOK_COLON){right=this._parseIndexExpression();return this._projectIfSlice({type:"Identity"},right);}else if(this._lookahead(0)===TOK_STAR&&this._lookahead(1)===TOK_RBRACKET){this._advance();this._advance();right=this._parseProjectionRHS(bindingPower.Star);return{type:"Projection",children:[{type:"Identity"},right]};}return this._parseMultiselectList();case TOK_CURRENT:return{type:TOK_CURRENT};case TOK_EXPREF:expression=this.expression(bindingPower.Expref);return{type:"ExpressionReference",children:[expression]};case TOK_LPAREN:var args=[];while(this._lookahead(0)!==TOK_RPAREN){if(this._lookahead(0)===TOK_CURRENT){expression={type:TOK_CURRENT};this._advance();}else{expression=this.expression(0);}args.push(expression);}this._match(TOK_RPAREN);return args[0];default:this._errorToken(token);}},led:function led(tokenName,left){var right;switch(tokenName){case TOK_DOT:var rbp=bindingPower.Dot;if(this._lookahead(0)!==TOK_STAR){right=this._parseDotRHS(rbp);return{type:"Subexpression",children:[left,right]};}// Creating a projection.
this._advance();right=this._parseProjectionRHS(rbp);return{type:"ValueProjection",children:[left,right]};case TOK_PIPE:right=this.expression(bindingPower.Pipe);return{type:TOK_PIPE,children:[left,right]};case TOK_OR:right=this.expression(bindingPower.Or);return{type:"OrExpression",children:[left,right]};case TOK_AND:right=this.expression(bindingPower.And);return{type:"AndExpression",children:[left,right]};case TOK_LPAREN:var name=left.name;var args=[];var expression,node;while(this._lookahead(0)!==TOK_RPAREN){if(this._lookahead(0)===TOK_CURRENT){expression={type:TOK_CURRENT};this._advance();}else{expression=this.expression(0);}if(this._lookahead(0)===TOK_COMMA){this._match(TOK_COMMA);}args.push(expression);}this._match(TOK_RPAREN);node={type:"Function",name:name,children:args};return node;case TOK_FILTER:var condition=this.expression(0);this._match(TOK_RBRACKET);if(this._lookahead(0)===TOK_FLATTEN){right={type:"Identity"};}else{right=this._parseProjectionRHS(bindingPower.Filter);}return{type:"FilterProjection",children:[left,right,condition]};case TOK_FLATTEN:var leftNode={type:TOK_FLATTEN,children:[left]};var rightNode=this._parseProjectionRHS(bindingPower.Flatten);return{type:"Projection",children:[leftNode,rightNode]};case TOK_EQ:case TOK_NE:case TOK_GT:case TOK_GTE:case TOK_LT:case TOK_LTE:return this._parseComparator(left,tokenName);case TOK_LBRACKET:var token=this._lookaheadToken(0);if(token.type===TOK_NUMBER||token.type===TOK_COLON){right=this._parseIndexExpression();return this._projectIfSlice(left,right);}this._match(TOK_STAR);this._match(TOK_RBRACKET);right=this._parseProjectionRHS(bindingPower.Star);return{type:"Projection",children:[left,right]};default:this._errorToken(this._lookaheadToken(0));}},_match:function _match(tokenType){if(this._lookahead(0)===tokenType){this._advance();}else{var t=this._lookaheadToken(0);var error=new Error("Expected "+tokenType+", got: "+t.type);error.name="ParserError";throw error;}},_errorToken:function _errorToken(token){var error=new Error("Invalid token ("+token.type+"): \""+token.value+"\"");error.name="ParserError";throw error;},_parseIndexExpression:function _parseIndexExpression(){if(this._lookahead(0)===TOK_COLON||this._lookahead(1)===TOK_COLON){return this._parseSliceExpression();}else{var node={type:"Index",value:this._lookaheadToken(0).value};this._advance();this._match(TOK_RBRACKET);return node;}},_projectIfSlice:function _projectIfSlice(left,right){var indexExpr={type:"IndexExpression",children:[left,right]};if(right.type==="Slice"){return{type:"Projection",children:[indexExpr,this._parseProjectionRHS(bindingPower.Star)]};}else{return indexExpr;}},_parseSliceExpression:function _parseSliceExpression(){// [start:end:step] where each part is optional, as well as the last
// colon.
var parts=[null,null,null];var index=0;var currentToken=this._lookahead(0);while(currentToken!==TOK_RBRACKET&&index<3){if(currentToken===TOK_COLON){index++;this._advance();}else if(currentToken===TOK_NUMBER){parts[index]=this._lookaheadToken(0).value;this._advance();}else{var t=this._lookahead(0);var error=new Error("Syntax error, unexpected token: "+t.value+"("+t.type+")");error.name="Parsererror";throw error;}currentToken=this._lookahead(0);}this._match(TOK_RBRACKET);return{type:"Slice",children:parts};},_parseComparator:function _parseComparator(left,comparator){var right=this.expression(bindingPower[comparator]);return{type:"Comparator",name:comparator,children:[left,right]};},_parseDotRHS:function _parseDotRHS(rbp){var lookahead=this._lookahead(0);var exprTokens=[TOK_UNQUOTEDIDENTIFIER,TOK_QUOTEDIDENTIFIER,TOK_STAR];if(exprTokens.indexOf(lookahead)>=0){return this.expression(rbp);}else if(lookahead===TOK_LBRACKET){this._match(TOK_LBRACKET);return this._parseMultiselectList();}else if(lookahead===TOK_LBRACE){this._match(TOK_LBRACE);return this._parseMultiselectHash();}},_parseProjectionRHS:function _parseProjectionRHS(rbp){var right;if(bindingPower[this._lookahead(0)]<10){right={type:"Identity"};}else if(this._lookahead(0)===TOK_LBRACKET){right=this.expression(rbp);}else if(this._lookahead(0)===TOK_FILTER){right=this.expression(rbp);}else if(this._lookahead(0)===TOK_DOT){this._match(TOK_DOT);right=this._parseDotRHS(rbp);}else{var t=this._lookaheadToken(0);var error=new Error("Sytanx error, unexpected token: "+t.value+"("+t.type+")");error.name="ParserError";throw error;}return right;},_parseMultiselectList:function _parseMultiselectList(){var expressions=[];while(this._lookahead(0)!==TOK_RBRACKET){var expression=this.expression(0);expressions.push(expression);if(this._lookahead(0)===TOK_COMMA){this._match(TOK_COMMA);if(this._lookahead(0)===TOK_RBRACKET){throw new Error("Unexpected token Rbracket");}}}this._match(TOK_RBRACKET);return{type:"MultiSelectList",children:expressions};},_parseMultiselectHash:function _parseMultiselectHash(){var pairs=[];var identifierTypes=[TOK_UNQUOTEDIDENTIFIER,TOK_QUOTEDIDENTIFIER];var keyToken,keyName,value,node;for(;;){keyToken=this._lookaheadToken(0);if(identifierTypes.indexOf(keyToken.type)<0){throw new Error("Expecting an identifier token, got: "+keyToken.type);}keyName=keyToken.value;this._advance();this._match(TOK_COLON);value=this.expression(0);node={type:"KeyValuePair",name:keyName,value:value};pairs.push(node);if(this._lookahead(0)===TOK_COMMA){this._match(TOK_COMMA);}else if(this._lookahead(0)===TOK_RBRACE){this._match(TOK_RBRACE);break;}}return{type:"MultiSelectHash",children:pairs};}};function TreeInterpreter(runtime){this.runtime=runtime;}TreeInterpreter.prototype={search:function search(node,value){return this.visit(node,value);},visit:function visit(node,value){var matched,current,result,first,second,field,left,right,collected,i;switch(node.type){case"Field":if(value!==null&&isObject(value)){field=value[node.name];if(field===undefined){return null;}else{return field;}}return null;case"Subexpression":result=this.visit(node.children[0],value);for(i=1;i<node.children.length;i++){result=this.visit(node.children[1],result);if(result===null){return null;}}return result;case"IndexExpression":left=this.visit(node.children[0],value);right=this.visit(node.children[1],left);return right;case"Index":if(!isArray(value)){return null;}var index=node.value;if(index<0){index=value.length+index;}result=value[index];if(result===undefined){result=null;}return result;case"Slice":if(!isArray(value)){return null;}var sliceParams=node.children.slice(0);var computed=this.computeSliceParams(value.length,sliceParams);var start=computed[0];var stop=computed[1];var step=computed[2];result=[];if(step>0){for(i=start;i<stop;i+=step){result.push(value[i]);}}else{for(i=start;i>stop;i+=step){result.push(value[i]);}}return result;case"Projection":// Evaluate left child.
var base=this.visit(node.children[0],value);if(!isArray(base)){return null;}collected=[];for(i=0;i<base.length;i++){current=this.visit(node.children[1],base[i]);if(current!==null){collected.push(current);}}return collected;case"ValueProjection":// Evaluate left child.
base=this.visit(node.children[0],value);if(!isObject(base)){return null;}collected=[];var values=objValues(base);for(i=0;i<values.length;i++){current=this.visit(node.children[1],values[i]);if(current!==null){collected.push(current);}}return collected;case"FilterProjection":base=this.visit(node.children[0],value);if(!isArray(base)){return null;}var filtered=[];var finalResults=[];for(i=0;i<base.length;i++){matched=this.visit(node.children[2],base[i]);if(!isFalse(matched)){filtered.push(base[i]);}}for(var j=0;j<filtered.length;j++){current=this.visit(node.children[1],filtered[j]);if(current!==null){finalResults.push(current);}}return finalResults;case"Comparator":first=this.visit(node.children[0],value);second=this.visit(node.children[1],value);switch(node.name){case TOK_EQ:result=strictDeepEqual(first,second);break;case TOK_NE:result=!strictDeepEqual(first,second);break;case TOK_GT:result=first>second;break;case TOK_GTE:result=first>=second;break;case TOK_LT:result=first<second;break;case TOK_LTE:result=first<=second;break;default:throw new Error("Unknown comparator: "+node.name);}return result;case TOK_FLATTEN:var original=this.visit(node.children[0],value);if(!isArray(original)){return null;}var merged=[];for(i=0;i<original.length;i++){current=original[i];if(isArray(current)){merged.push.apply(merged,current);}else{merged.push(current);}}return merged;case"Identity":return value;case"MultiSelectList":if(value===null){return null;}collected=[];for(i=0;i<node.children.length;i++){collected.push(this.visit(node.children[i],value));}return collected;case"MultiSelectHash":if(value===null){return null;}collected={};var child;for(i=0;i<node.children.length;i++){child=node.children[i];collected[child.name]=this.visit(child.value,value);}return collected;case"OrExpression":matched=this.visit(node.children[0],value);if(isFalse(matched)){matched=this.visit(node.children[1],value);}return matched;case"AndExpression":first=this.visit(node.children[0],value);if(isFalse(first)===true){return first;}return this.visit(node.children[1],value);case"NotExpression":first=this.visit(node.children[0],value);return isFalse(first);case"Literal":return node.value;case TOK_PIPE:left=this.visit(node.children[0],value);return this.visit(node.children[1],left);case TOK_CURRENT:return value;case"Function":var resolvedArgs=[];for(i=0;i<node.children.length;i++){resolvedArgs.push(this.visit(node.children[i],value));}return this.runtime.callFunction(node.name,resolvedArgs);case"ExpressionReference":var refNode=node.children[0];// Tag the node with a specific attribute so the type
// checker verify the type.
refNode.jmespathType=TOK_EXPREF;return refNode;default:throw new Error("Unknown node type: "+node.type);}},computeSliceParams:function computeSliceParams(arrayLength,sliceParams){var start=sliceParams[0];var stop=sliceParams[1];var step=sliceParams[2];var computed=[null,null,null];if(step===null){step=1;}else if(step===0){var error=new Error("Invalid slice, step cannot be 0");error.name="RuntimeError";throw error;}var stepValueNegative=step<0?true:false;if(start===null){start=stepValueNegative?arrayLength-1:0;}else{start=this.capSliceRange(arrayLength,start,step);}if(stop===null){stop=stepValueNegative?-1:arrayLength;}else{stop=this.capSliceRange(arrayLength,stop,step);}computed[0]=start;computed[1]=stop;computed[2]=step;return computed;},capSliceRange:function capSliceRange(arrayLength,actualValue,step){if(actualValue<0){actualValue+=arrayLength;if(actualValue<0){actualValue=step<0?-1:0;}}else if(actualValue>=arrayLength){actualValue=step<0?arrayLength-1:arrayLength;}return actualValue;}};function Runtime(interpreter){this._interpreter=interpreter;this.functionTable={// name: [function, <signature>]
// The <signature> can be:
//
// {
//   args: [[type1, type2], [type1, type2]],
//   variadic: true|false
// }
//
// Each arg in the arg list is a list of valid types
// (if the function is overloaded and supports multiple
// types.  If the type is "any" then no type checking
// occurs on the argument.  Variadic is optional
// and if not provided is assumed to be false.
abs:{_func:this._functionAbs,_signature:[{types:[TYPE_NUMBER]}]},avg:{_func:this._functionAvg,_signature:[{types:[TYPE_ARRAY_NUMBER]}]},ceil:{_func:this._functionCeil,_signature:[{types:[TYPE_NUMBER]}]},contains:{_func:this._functionContains,_signature:[{types:[TYPE_STRING,TYPE_ARRAY]},{types:[TYPE_ANY]}]},"ends_with":{_func:this._functionEndsWith,_signature:[{types:[TYPE_STRING]},{types:[TYPE_STRING]}]},floor:{_func:this._functionFloor,_signature:[{types:[TYPE_NUMBER]}]},length:{_func:this._functionLength,_signature:[{types:[TYPE_STRING,TYPE_ARRAY,TYPE_OBJECT]}]},map:{_func:this._functionMap,_signature:[{types:[TYPE_EXPREF]},{types:[TYPE_ARRAY]}]},max:{_func:this._functionMax,_signature:[{types:[TYPE_ARRAY_NUMBER,TYPE_ARRAY_STRING]}]},"merge":{_func:this._functionMerge,_signature:[{types:[TYPE_OBJECT],variadic:true}]},"max_by":{_func:this._functionMaxBy,_signature:[{types:[TYPE_ARRAY]},{types:[TYPE_EXPREF]}]},sum:{_func:this._functionSum,_signature:[{types:[TYPE_ARRAY_NUMBER]}]},"starts_with":{_func:this._functionStartsWith,_signature:[{types:[TYPE_STRING]},{types:[TYPE_STRING]}]},min:{_func:this._functionMin,_signature:[{types:[TYPE_ARRAY_NUMBER,TYPE_ARRAY_STRING]}]},"min_by":{_func:this._functionMinBy,_signature:[{types:[TYPE_ARRAY]},{types:[TYPE_EXPREF]}]},type:{_func:this._functionType,_signature:[{types:[TYPE_ANY]}]},keys:{_func:this._functionKeys,_signature:[{types:[TYPE_OBJECT]}]},values:{_func:this._functionValues,_signature:[{types:[TYPE_OBJECT]}]},sort:{_func:this._functionSort,_signature:[{types:[TYPE_ARRAY_STRING,TYPE_ARRAY_NUMBER]}]},"sort_by":{_func:this._functionSortBy,_signature:[{types:[TYPE_ARRAY]},{types:[TYPE_EXPREF]}]},join:{_func:this._functionJoin,_signature:[{types:[TYPE_STRING]},{types:[TYPE_ARRAY_STRING]}]},reverse:{_func:this._functionReverse,_signature:[{types:[TYPE_STRING,TYPE_ARRAY]}]},"to_array":{_func:this._functionToArray,_signature:[{types:[TYPE_ANY]}]},"to_string":{_func:this._functionToString,_signature:[{types:[TYPE_ANY]}]},"to_number":{_func:this._functionToNumber,_signature:[{types:[TYPE_ANY]}]},"not_null":{_func:this._functionNotNull,_signature:[{types:[TYPE_ANY],variadic:true}]}};}Runtime.prototype={callFunction:function callFunction(name,resolvedArgs){var functionEntry=this.functionTable[name];if(functionEntry===undefined){throw new Error("Unknown function: "+name+"()");}this._validateArgs(name,resolvedArgs,functionEntry._signature);return functionEntry._func.call(this,resolvedArgs);},_validateArgs:function _validateArgs(name,args,signature){// Validating the args requires validating
// the correct arity and the correct type of each arg.
// If the last argument is declared as variadic, then we need
// a minimum number of args to be required.  Otherwise it has to
// be an exact amount.
var pluralized;if(signature[signature.length-1].variadic){if(args.length<signature.length){pluralized=signature.length===1?" argument":" arguments";throw new Error("ArgumentError: "+name+"() "+"takes at least"+signature.length+pluralized+" but received "+args.length);}}else if(args.length!==signature.length){pluralized=signature.length===1?" argument":" arguments";throw new Error("ArgumentError: "+name+"() "+"takes "+signature.length+pluralized+" but received "+args.length);}var currentSpec;var actualType;var typeMatched;for(var i=0;i<signature.length;i++){typeMatched=false;currentSpec=signature[i].types;actualType=this._getTypeName(args[i]);for(var j=0;j<currentSpec.length;j++){if(this._typeMatches(actualType,currentSpec[j],args[i])){typeMatched=true;break;}}if(!typeMatched){var expected=currentSpec.map(function(typeIdentifier){return TYPE_NAME_TABLE[typeIdentifier];}).join(',');throw new Error("TypeError: "+name+"() "+"expected argument "+(i+1)+" to be type "+expected+" but received type "+TYPE_NAME_TABLE[actualType]+" instead.");}}},_typeMatches:function _typeMatches(actual,expected,argValue){if(expected===TYPE_ANY){return true;}if(expected===TYPE_ARRAY_STRING||expected===TYPE_ARRAY_NUMBER||expected===TYPE_ARRAY){// The expected type can either just be array,
// or it can require a specific subtype (array of numbers).
//
// The simplest case is if "array" with no subtype is specified.
if(expected===TYPE_ARRAY){return actual===TYPE_ARRAY;}else if(actual===TYPE_ARRAY){// Otherwise we need to check subtypes.
// I think this has potential to be improved.
var subtype;if(expected===TYPE_ARRAY_NUMBER){subtype=TYPE_NUMBER;}else if(expected===TYPE_ARRAY_STRING){subtype=TYPE_STRING;}for(var i=0;i<argValue.length;i++){if(!this._typeMatches(this._getTypeName(argValue[i]),subtype,argValue[i])){return false;}}return true;}}else{return actual===expected;}},_getTypeName:function _getTypeName(obj){switch(Object.prototype.toString.call(obj)){case"[object String]":return TYPE_STRING;case"[object Number]":return TYPE_NUMBER;case"[object Array]":return TYPE_ARRAY;case"[object Boolean]":return TYPE_BOOLEAN;case"[object Null]":return TYPE_NULL;case"[object Object]":// Check if it's an expref.  If it has, it's been
// tagged with a jmespathType attr of 'Expref';
if(obj.jmespathType===TOK_EXPREF){return TYPE_EXPREF;}else{return TYPE_OBJECT;}}},_functionStartsWith:function _functionStartsWith(resolvedArgs){return resolvedArgs[0].lastIndexOf(resolvedArgs[1])===0;},_functionEndsWith:function _functionEndsWith(resolvedArgs){var searchStr=resolvedArgs[0];var suffix=resolvedArgs[1];return searchStr.indexOf(suffix,searchStr.length-suffix.length)!==-1;},_functionReverse:function _functionReverse(resolvedArgs){var typeName=this._getTypeName(resolvedArgs[0]);if(typeName===TYPE_STRING){var originalStr=resolvedArgs[0];var reversedStr="";for(var i=originalStr.length-1;i>=0;i--){reversedStr+=originalStr[i];}return reversedStr;}else{var reversedArray=resolvedArgs[0].slice(0);reversedArray.reverse();return reversedArray;}},_functionAbs:function _functionAbs(resolvedArgs){return Math.abs(resolvedArgs[0]);},_functionCeil:function _functionCeil(resolvedArgs){return Math.ceil(resolvedArgs[0]);},_functionAvg:function _functionAvg(resolvedArgs){var sum=0;var inputArray=resolvedArgs[0];for(var i=0;i<inputArray.length;i++){sum+=inputArray[i];}return sum/inputArray.length;},_functionContains:function _functionContains(resolvedArgs){return resolvedArgs[0].indexOf(resolvedArgs[1])>=0;},_functionFloor:function _functionFloor(resolvedArgs){return Math.floor(resolvedArgs[0]);},_functionLength:function _functionLength(resolvedArgs){if(!isObject(resolvedArgs[0])){return resolvedArgs[0].length;}else{// As far as I can tell, there's no way to get the length
// of an object without O(n) iteration through the object.
return Object.keys(resolvedArgs[0]).length;}},_functionMap:function _functionMap(resolvedArgs){var mapped=[];var interpreter=this._interpreter;var exprefNode=resolvedArgs[0];var elements=resolvedArgs[1];for(var i=0;i<elements.length;i++){mapped.push(interpreter.visit(exprefNode,elements[i]));}return mapped;},_functionMerge:function _functionMerge(resolvedArgs){var merged={};for(var i=0;i<resolvedArgs.length;i++){var current=resolvedArgs[i];for(var key in current){merged[key]=current[key];}}return merged;},_functionMax:function _functionMax(resolvedArgs){if(resolvedArgs[0].length>0){var typeName=this._getTypeName(resolvedArgs[0][0]);if(typeName===TYPE_NUMBER){return Math.max.apply(Math,resolvedArgs[0]);}else{var elements=resolvedArgs[0];var maxElement=elements[0];for(var i=1;i<elements.length;i++){if(maxElement.localeCompare(elements[i])<0){maxElement=elements[i];}}return maxElement;}}else{return null;}},_functionMin:function _functionMin(resolvedArgs){if(resolvedArgs[0].length>0){var typeName=this._getTypeName(resolvedArgs[0][0]);if(typeName===TYPE_NUMBER){return Math.min.apply(Math,resolvedArgs[0]);}else{var elements=resolvedArgs[0];var minElement=elements[0];for(var i=1;i<elements.length;i++){if(elements[i].localeCompare(minElement)<0){minElement=elements[i];}}return minElement;}}else{return null;}},_functionSum:function _functionSum(resolvedArgs){var sum=0;var listToSum=resolvedArgs[0];for(var i=0;i<listToSum.length;i++){sum+=listToSum[i];}return sum;},_functionType:function _functionType(resolvedArgs){switch(this._getTypeName(resolvedArgs[0])){case TYPE_NUMBER:return"number";case TYPE_STRING:return"string";case TYPE_ARRAY:return"array";case TYPE_OBJECT:return"object";case TYPE_BOOLEAN:return"boolean";case TYPE_EXPREF:return"expref";case TYPE_NULL:return"null";}},_functionKeys:function _functionKeys(resolvedArgs){return Object.keys(resolvedArgs[0]);},_functionValues:function _functionValues(resolvedArgs){var obj=resolvedArgs[0];var keys=Object.keys(obj);var values=[];for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}return values;},_functionJoin:function _functionJoin(resolvedArgs){var joinChar=resolvedArgs[0];var listJoin=resolvedArgs[1];return listJoin.join(joinChar);},_functionToArray:function _functionToArray(resolvedArgs){if(this._getTypeName(resolvedArgs[0])===TYPE_ARRAY){return resolvedArgs[0];}else{return[resolvedArgs[0]];}},_functionToString:function _functionToString(resolvedArgs){if(this._getTypeName(resolvedArgs[0])===TYPE_STRING){return resolvedArgs[0];}else{return JSON.stringify(resolvedArgs[0]);}},_functionToNumber:function _functionToNumber(resolvedArgs){var typeName=this._getTypeName(resolvedArgs[0]);var convertedValue;if(typeName===TYPE_NUMBER){return resolvedArgs[0];}else if(typeName===TYPE_STRING){convertedValue=+resolvedArgs[0];if(!isNaN(convertedValue)){return convertedValue;}}return null;},_functionNotNull:function _functionNotNull(resolvedArgs){for(var i=0;i<resolvedArgs.length;i++){if(this._getTypeName(resolvedArgs[i])!==TYPE_NULL){return resolvedArgs[i];}}return null;},_functionSort:function _functionSort(resolvedArgs){var sortedArray=resolvedArgs[0].slice(0);sortedArray.sort();return sortedArray;},_functionSortBy:function _functionSortBy(resolvedArgs){var sortedArray=resolvedArgs[0].slice(0);if(sortedArray.length===0){return sortedArray;}var interpreter=this._interpreter;var exprefNode=resolvedArgs[1];var requiredType=this._getTypeName(interpreter.visit(exprefNode,sortedArray[0]));if([TYPE_NUMBER,TYPE_STRING].indexOf(requiredType)<0){throw new Error("TypeError");}var that=this;// In order to get a stable sort out of an unstable
// sort algorithm, we decorate/sort/undecorate (DSU)
// by creating a new list of [index, element] pairs.
// In the cmp function, if the evaluated elements are
// equal, then the index will be used as the tiebreaker.
// After the decorated list has been sorted, it will be
// undecorated to extract the original elements.
var decorated=[];for(var i=0;i<sortedArray.length;i++){decorated.push([i,sortedArray[i]]);}decorated.sort(function(a,b){var exprA=interpreter.visit(exprefNode,a[1]);var exprB=interpreter.visit(exprefNode,b[1]);if(that._getTypeName(exprA)!==requiredType){throw new Error("TypeError: expected "+requiredType+", received "+that._getTypeName(exprA));}else if(that._getTypeName(exprB)!==requiredType){throw new Error("TypeError: expected "+requiredType+", received "+that._getTypeName(exprB));}if(exprA>exprB){return 1;}else if(exprA<exprB){return-1;}else{// If they're equal compare the items by their
// order to maintain relative order of equal keys
// (i.e. to get a stable sort).
return a[0]-b[0];}});// Undecorate: extract out the original list elements.
for(var j=0;j<decorated.length;j++){sortedArray[j]=decorated[j][1];}return sortedArray;},_functionMaxBy:function _functionMaxBy(resolvedArgs){var exprefNode=resolvedArgs[1];var resolvedArray=resolvedArgs[0];var keyFunction=this.createKeyFunction(exprefNode,[TYPE_NUMBER,TYPE_STRING]);var maxNumber=-Infinity;var maxRecord;var current;for(var i=0;i<resolvedArray.length;i++){current=keyFunction(resolvedArray[i]);if(current>maxNumber){maxNumber=current;maxRecord=resolvedArray[i];}}return maxRecord;},_functionMinBy:function _functionMinBy(resolvedArgs){var exprefNode=resolvedArgs[1];var resolvedArray=resolvedArgs[0];var keyFunction=this.createKeyFunction(exprefNode,[TYPE_NUMBER,TYPE_STRING]);var minNumber=Infinity;var minRecord;var current;for(var i=0;i<resolvedArray.length;i++){current=keyFunction(resolvedArray[i]);if(current<minNumber){minNumber=current;minRecord=resolvedArray[i];}}return minRecord;},createKeyFunction:function createKeyFunction(exprefNode,allowedTypes){var that=this;var interpreter=this._interpreter;var keyFunc=function keyFunc(x){var current=interpreter.visit(exprefNode,x);if(allowedTypes.indexOf(that._getTypeName(current))<0){var msg="TypeError: expected one of "+allowedTypes+", received "+that._getTypeName(current);throw new Error(msg);}return current;};return keyFunc;}};function compile(stream){var parser=new Parser();var ast=parser.parse(stream);return ast;}function tokenize(stream){var lexer=new Lexer();return lexer.tokenize(stream);}function search(data,expression){var parser=new Parser();// This needs to be improved.  Both the interpreter and runtime depend on
// each other.  The runtime needs the interpreter to support exprefs.
// There's likely a clean way to avoid the cyclic dependency.
var runtime=new Runtime();var interpreter=new TreeInterpreter(runtime);runtime._interpreter=interpreter;var node=parser.parse(expression);return interpreter.search(node,data);}exports.tokenize=tokenize;exports.compile=compile;exports.search=search;exports.strictDeepEqual=strictDeepEqual;})(exports);})(jmespath);var description="\n<p>\n  Enter a <a href=\"https://jmespath.org\" target=\"_blank\" rel=\"noopener noreferrer\">JMESPath</a> query \n  to filter, sort, or transform the JSON data.\n To learn JMESPath, go to <a href=\"https://jmespath.org/tutorial.html\" target=\"_blank\" rel=\"noopener noreferrer\">the interactive tutorial</a>.\n</p>\n";var jmespathQueryLanguage={id:'jmespath',name:'JMESPath',description:description,createQuery:createQuery,executeQuery:executeQuery};/**
 * Build a JMESPath query based on query options coming from the wizard
 * @param json   The JSON document for which to build the query.
 *                      Used for context information like determining
 *                      the type of values (string or number)
 * @param queryOptions
 * @return Returns a query (as string)
 */exports.jmespathQueryLanguage=jmespathQueryLanguage;function createQuery(json,queryOptions){var sort=queryOptions.sort,filter=queryOptions.filter,projection=queryOptions.projection;var query='';if(filter&&filter.path&&filter.relation&&filter.value){var examplePath=['0'].concat(filter.path);var exampleValue=immutableJSONPatch.exports.getIn(json,examplePath);var filterValue=parseString(filter.value);var filterValueStr=typeof exampleValue==='string'&&filterValue!==null&&filterValue!==undefined?"\"".concat(filter.value,"\""):filterValue;query+='[? '+stringifyPathForJmespath(filter.path)+' '+filter.relation+' '+'`'+filterValueStr+'`'+']';}else{query+=Array.isArray(json)?'[*]':'@';}if(sort&&sort.path&&sort.direction){if(sort.direction==='desc'){query+=' | reverse(sort_by(@, &'+stringifyPathForJmespath(sort.path)+'))';}else{query+=' | sort_by(@, &'+stringifyPathForJmespath(sort.path)+')';}}if(projection&&projection.paths){if(query[query.length-1]!==']'){query+=' | [*]';}if(projection.paths.length===1){var path=projection.paths[0];query+=path.length===0?''// edge case, selecting projection of "whole item"
:'.'+stringifyPathForJmespath(path);}else if(projection.paths.length>1){query+='.{'+projection.paths.map(function(path){var name=path[path.length-1];return name+': '+stringifyPathForJmespath(path);}).join(', ')+'}';}else;}return query;}/**
 * Execute a JMESPath query, returns the transformed JSON
 */function executeQuery(json,query){return jmespath.search(json,query);}// TODO: unit test stringifyPathForJmespath
// TODO: Isn't there a helper function exposed by the JMESPath library?
function stringifyPathForJmespath(path){if(path.length===0){return'@';}var str=path.map(function(prop){if(typeof prop==='number'){return'['+prop+']';}else if(typeof prop==='string'&&prop.match(/^[A-Za-z\d_$]+$/)){return'.'+prop;}else{return'."'+String(prop)+'"';}}).join('');return str[0]==='.'?str.slice(1)// remove first dot
:str;}/*!
 * vanilla-picker v2.12.1
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2021 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */var classCallCheck=function classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();String.prototype.startsWith=String.prototype.startsWith||function(needle){return this.indexOf(needle)===0;};String.prototype.padStart=String.prototype.padStart||function(len,pad){var str=this;while(str.length<len){str=pad+str;}return str;};var colorNames={cb:'0f8ff',tqw:'aebd7',q:'-ffff',qmrn:'7fffd4',zr:'0ffff',bg:'5f5dc',bsq:'e4c4',bck:'---',nch:'ebcd',b:'--ff',bvt:'8a2be2',brwn:'a52a2a',brw:'deb887',ctb:'5f9ea0',hrt:'7fff-',chcT:'d2691e',cr:'7f50',rnw:'6495ed',crns:'8dc',crms:'dc143c',cn:'-ffff',Db:'--8b',Dcn:'-8b8b',Dgnr:'b8860b',Dgr:'a9a9a9',Dgrn:'-64-',Dkhk:'bdb76b',Dmgn:'8b-8b',Dvgr:'556b2f',Drng:'8c-',Drch:'9932cc',Dr:'8b--',Dsmn:'e9967a',Dsgr:'8fbc8f',DsTb:'483d8b',DsTg:'2f4f4f',Dtrq:'-ced1',Dvt:'94-d3',ppnk:'1493',pskb:'-bfff',mgr:'696969',grb:'1e90ff',rbrc:'b22222',rwht:'af0',stg:'228b22',chs:'-ff',gnsb:'dcdcdc',st:'8f8ff',g:'d7-',gnr:'daa520',gr:'808080',grn:'-8-0',grnw:'adff2f',hnw:'0fff0',htpn:'69b4',nnr:'cd5c5c',ng:'4b-82',vr:'0',khk:'0e68c',vnr:'e6e6fa',nrb:'0f5',wngr:'7cfc-',mnch:'acd',Lb:'add8e6',Lcr:'08080',Lcn:'e0ffff',Lgnr:'afad2',Lgr:'d3d3d3',Lgrn:'90ee90',Lpnk:'b6c1',Lsmn:'a07a',Lsgr:'20b2aa',Lskb:'87cefa',LsTg:'778899',Lstb:'b0c4de',Lw:'e0',m:'-ff-',mgrn:'32cd32',nn:'af0e6',mgnt:'-ff',mrn:'8--0',mqm:'66cdaa',mmb:'--cd',mmrc:'ba55d3',mmpr:'9370db',msg:'3cb371',mmsT:'7b68ee','':'-fa9a',mtr:'48d1cc',mmvt:'c71585',mnLb:'191970',ntc:'5fffa',mstr:'e4e1',mccs:'e4b5',vjw:'dead',nv:'--80',c:'df5e6',v:'808-0',vrb:'6b8e23',rng:'a5-',rngr:'45-',rch:'da70d6',pgnr:'eee8aa',pgrn:'98fb98',ptrq:'afeeee',pvtr:'db7093',ppwh:'efd5',pchp:'dab9',pr:'cd853f',pnk:'c0cb',pm:'dda0dd',pwrb:'b0e0e6',prp:'8-080',cc:'663399',r:'--',sbr:'bc8f8f',rb:'4169e1',sbrw:'8b4513',smn:'a8072',nbr:'4a460',sgrn:'2e8b57',ssh:'5ee',snn:'a0522d',svr:'c0c0c0',skb:'87ceeb',sTb:'6a5acd',sTgr:'708090',snw:'afa',n:'-ff7f',stb:'4682b4',tn:'d2b48c',t:'-8080',thst:'d8bfd8',tmT:'6347',trqs:'40e0d0',vt:'ee82ee',whT:'5deb3',wht:'',hts:'5f5f5',w:'-',wgrn:'9acd32'};function printNum(num){var decs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var str=decs>0?num.toFixed(decs).replace(/0+$/,'').replace(/\.$/,''):num.toString();return str||'0';}var Color=function(){function Color(r,g,b,a){classCallCheck(this,Color);var that=this;function parseString(input){if(input.startsWith('hsl')){var _input$match$map=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map2=slicedToArray(_input$match$map,4),h=_input$match$map2[0],s=_input$match$map2[1],l=_input$match$map2[2],_a=_input$match$map2[3];if(_a===undefined){_a=1;}h/=360;s/=100;l/=100;that.hsla=[h,s,l,_a];}else if(input.startsWith('rgb')){var _input$match$map3=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map4=slicedToArray(_input$match$map3,4),_r=_input$match$map4[0],_g=_input$match$map4[1],_b=_input$match$map4[2],_a2=_input$match$map4[3];if(_a2===undefined){_a2=1;}that.rgba=[_r,_g,_b,_a2];}else{if(input.startsWith('#')){that.rgba=Color.hexToRgb(input);}else{that.rgba=Color.nameToRgb(input)||Color.hexToRgb(input);}}}if(r===undefined);else if(Array.isArray(r)){this.rgba=r;}else if(b===undefined){var color=r&&''+r;if(color){parseString(color.toLowerCase());}}else{this.rgba=[r,g,b,a===undefined?1:a];}}createClass(Color,[{key:'printRGB',value:function printRGB(alpha){var rgb=alpha?this.rgba:this.rgba.slice(0,3),vals=rgb.map(function(x,i){return printNum(x,i===3?3:0);});return alpha?'rgba('+vals+')':'rgb('+vals+')';}},{key:'printHSL',value:function printHSL(alpha){var mults=[360,100,100,1],suff=['','%','%',''];var hsl=alpha?this.hsla:this.hsla.slice(0,3),vals=hsl.map(function(x,i){return printNum(x*mults[i],i===3?3:1)+suff[i];});return alpha?'hsla('+vals+')':'hsl('+vals+')';}},{key:'printHex',value:function printHex(alpha){var hex=this.hex;return alpha?hex:hex.substring(0,7);}},{key:'rgba',get:function get(){if(this._rgba){return this._rgba;}if(!this._hsla){throw new Error('No color is set');}return this._rgba=Color.hslToRgb(this._hsla);},set:function set(rgb){if(rgb.length===3){rgb[3]=1;}this._rgba=rgb;this._hsla=null;}},{key:'rgbString',get:function get(){return this.printRGB();}},{key:'rgbaString',get:function get(){return this.printRGB(true);}},{key:'hsla',get:function get(){if(this._hsla){return this._hsla;}if(!this._rgba){throw new Error('No color is set');}return this._hsla=Color.rgbToHsl(this._rgba);},set:function set(hsl){if(hsl.length===3){hsl[3]=1;}this._hsla=hsl;this._rgba=null;}},{key:'hslString',get:function get(){return this.printHSL();}},{key:'hslaString',get:function get(){return this.printHSL(true);}},{key:'hex',get:function get(){var rgb=this.rgba,hex=rgb.map(function(x,i){return i<3?x.toString(16):Math.round(x*255).toString(16);});return'#'+hex.map(function(x){return x.padStart(2,'0');}).join('');},set:function set(hex){this.rgba=Color.hexToRgb(hex);}}],[{key:'hexToRgb',value:function hexToRgb(input){var hex=(input.startsWith('#')?input.slice(1):input).replace(/^(\w{3})$/,'$1F').replace(/^(\w)(\w)(\w)(\w)$/,'$1$1$2$2$3$3$4$4').replace(/^(\w{6})$/,'$1FF');if(!hex.match(/^([0-9a-fA-F]{8})$/)){throw new Error('Unknown hex color; '+input);}var rgba=hex.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(x){return parseInt(x,16);});rgba[3]=rgba[3]/255;return rgba;}},{key:'nameToRgb',value:function nameToRgb(input){var hash=input.toLowerCase().replace('at','T').replace(/[aeiouyldf]/g,'').replace('ght','L').replace('rk','D').slice(-5,4),hex=colorNames[hash];return hex===undefined?hex:Color.hexToRgb(hex.replace(/\-/g,'00').padStart(6,'f'));}},{key:'rgbToHsl',value:function rgbToHsl(_ref){var _ref2=slicedToArray(_ref,4),r=_ref2[0],g=_ref2[1],b=_ref2[2],a=_ref2[3];r/=255;g/=255;b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h=void 0,s=void 0,l=(max+min)/2;if(max===min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}return[h,s,l,a];}},{key:'hslToRgb',value:function hslToRgb(_ref3){var _ref4=slicedToArray(_ref3,4),h=_ref4[0],s=_ref4[1],l=_ref4[2],a=_ref4[3];var r=void 0,g=void 0,b=void 0;if(s===0){r=g=b=l;}else{var hue2rgb=function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;};var q=l<0.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}var rgba=[r*255,g*255,b*255].map(Math.round);rgba[3]=a;return rgba;}}]);return Color;}();var EventBucket=function(){function EventBucket(){classCallCheck(this,EventBucket);this._events=[];}createClass(EventBucket,[{key:'add',value:function add(target,type,handler){target.addEventListener(type,handler,false);this._events.push({target:target,type:type,handler:handler});}},{key:'remove',value:function remove(target,type,handler){this._events=this._events.filter(function(e){var isMatch=true;if(target&&target!==e.target){isMatch=false;}if(type&&type!==e.type){isMatch=false;}if(handler&&handler!==e.handler){isMatch=false;}if(isMatch){EventBucket._doRemove(e.target,e.type,e.handler);}return!isMatch;});}},{key:'destroy',value:function destroy(){this._events.forEach(function(e){return EventBucket._doRemove(e.target,e.type,e.handler);});this._events=[];}}],[{key:'_doRemove',value:function _doRemove(target,type,handler){target.removeEventListener(type,handler,false);}}]);return EventBucket;}();function parseHTML(htmlString){var div=document.createElement('div');div.innerHTML=htmlString;return div.firstElementChild;}function dragTrack(eventBucket,area,callback){var dragging=false;function clamp(val,min,max){return Math.max(min,Math.min(val,max));}function onMove(e,info,starting){if(starting){dragging=true;}if(!dragging){return;}e.preventDefault();var bounds=area.getBoundingClientRect(),w=bounds.width,h=bounds.height,x=info.clientX,y=info.clientY;var relX=clamp(x-bounds.left,0,w),relY=clamp(y-bounds.top,0,h);callback(relX/w,relY/h);}function onMouse(e,starting){var button=e.buttons===undefined?e.which:e.buttons;if(button===1){onMove(e,e,starting);}else{dragging=false;}}function onTouch(e,starting){if(e.touches.length===1){onMove(e,e.touches[0],starting);}else{dragging=false;}}eventBucket.add(area,'mousedown',function(e){onMouse(e,true);});eventBucket.add(area,'touchstart',function(e){onTouch(e,true);});eventBucket.add(window,'mousemove',onMouse);eventBucket.add(area,'touchmove',onTouch);eventBucket.add(window,'mouseup',function(e){dragging=false;});eventBucket.add(area,'touchend',function(e){dragging=false;});eventBucket.add(area,'touchcancel',function(e){dragging=false;});}var BG_TRANSP='linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em';var HUES=360;var EVENT_KEY='keydown',EVENT_CLICK_OUTSIDE='mousedown',EVENT_TAB_MOVE='focusin';function $(selector,context){return(context||document).querySelector(selector);}function stopEvent(e){e.preventDefault();e.stopPropagation();}function onKey(bucket,target,keys,handler,stop){bucket.add(target,EVENT_KEY,function(e){if(keys.indexOf(e.key)>=0){if(stop){stopEvent(e);}handler(e);}});}var Picker=function(){function Picker(options){classCallCheck(this,Picker);this.settings={popup:'right',layout:'default',alpha:true,editor:true,editorFormat:'hex',cancelButton:false,defaultColor:'#0cf'};this._events=new EventBucket();this.onChange=null;this.onDone=null;this.onOpen=null;this.onClose=null;this.setOptions(options);}createClass(Picker,[{key:'setOptions',value:function setOptions(options){var _this=this;if(!options){return;}var settings=this.settings;function transfer(source,target,skipKeys){for(var key in source){if(skipKeys&&skipKeys.indexOf(key)>=0){continue;}target[key]=source[key];}}if(options instanceof HTMLElement){settings.parent=options;}else{if(settings.parent&&options.parent&&settings.parent!==options.parent){this._events.remove(settings.parent);this._popupInited=false;}transfer(options,settings);if(options.onChange){this.onChange=options.onChange;}if(options.onDone){this.onDone=options.onDone;}if(options.onOpen){this.onOpen=options.onOpen;}if(options.onClose){this.onClose=options.onClose;}var col=options.color||options.colour;if(col){this._setColor(col);}}var parent=settings.parent;if(parent&&settings.popup&&!this._popupInited){var openProxy=function openProxy(e){return _this.openHandler(e);};this._events.add(parent,'click',openProxy);onKey(this._events,parent,[' ','Spacebar','Enter'],openProxy);this._popupInited=true;}else if(options.parent&&!settings.popup){this.show();}}},{key:'openHandler',value:function openHandler(e){if(this.show()){e&&e.preventDefault();this.settings.parent.style.pointerEvents='none';var toFocus=e&&e.type===EVENT_KEY?this._domEdit:this.domElement;setTimeout(function(){return toFocus.focus();},100);if(this.onOpen){this.onOpen(this.colour);}}}},{key:'closeHandler',value:function closeHandler(e){var event=e&&e.type;var doHide=false;if(!e){doHide=true;}else if(event===EVENT_CLICK_OUTSIDE||event===EVENT_TAB_MOVE){var knownTime=(this.__containedEvent||0)+100;if(e.timeStamp>knownTime){doHide=true;}}else{stopEvent(e);doHide=true;}if(doHide&&this.hide()){this.settings.parent.style.pointerEvents='';if(event!==EVENT_CLICK_OUTSIDE){this.settings.parent.focus();}if(this.onClose){this.onClose(this.colour);}}}},{key:'movePopup',value:function movePopup(options,open){this.closeHandler();this.setOptions(options);if(open){this.openHandler();}}},{key:'setColor',value:function setColor(color,silent){this._setColor(color,{silent:silent});}},{key:'_setColor',value:function _setColor(color,flags){if(typeof color==='string'){color=color.trim();}if(!color){return;}flags=flags||{};var c=void 0;try{c=new Color(color);}catch(ex){if(flags.failSilently){return;}throw ex;}if(!this.settings.alpha){var hsla=c.hsla;hsla[3]=1;c.hsla=hsla;}this.colour=this.color=c;this._setHSLA(null,null,null,null,flags);}},{key:'setColour',value:function setColour(colour,silent){this.setColor(colour,silent);}},{key:'show',value:function show(){var parent=this.settings.parent;if(!parent){return false;}if(this.domElement){var toggled=this._toggleDOM(true);this._setPosition();return toggled;}var html=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>';var wrapper=parseHTML(html);this.domElement=wrapper;this._domH=$('.picker_hue',wrapper);this._domSL=$('.picker_sl',wrapper);this._domA=$('.picker_alpha',wrapper);this._domEdit=$('.picker_editor input',wrapper);this._domSample=$('.picker_sample',wrapper);this._domOkay=$('.picker_done button',wrapper);this._domCancel=$('.picker_cancel button',wrapper);wrapper.classList.add('layout_'+this.settings.layout);if(!this.settings.alpha){wrapper.classList.add('no_alpha');}if(!this.settings.editor){wrapper.classList.add('no_editor');}if(!this.settings.cancelButton){wrapper.classList.add('no_cancel');}this._ifPopup(function(){return wrapper.classList.add('popup');});this._setPosition();if(this.colour){this._updateUI();}else{this._setColor(this.settings.defaultColor);}this._bindEvents();return true;}},{key:'hide',value:function hide(){return this._toggleDOM(false);}},{key:'destroy',value:function destroy(){this._events.destroy();if(this.domElement){this.settings.parent.removeChild(this.domElement);}}},{key:'_bindEvents',value:function _bindEvents(){var _this2=this;var that=this,dom=this.domElement,events=this._events;function addEvent(target,type,handler){events.add(target,type,handler);}addEvent(dom,'click',function(e){return e.preventDefault();});dragTrack(events,this._domH,function(x,y){return that._setHSLA(x);});dragTrack(events,this._domSL,function(x,y){return that._setHSLA(null,x,1-y);});if(this.settings.alpha){dragTrack(events,this._domA,function(x,y){return that._setHSLA(null,null,null,1-y);});}var editInput=this._domEdit;{addEvent(editInput,'input',function(e){that._setColor(this.value,{fromEditor:true,failSilently:true});});addEvent(editInput,'focus',function(e){var input=this;if(input.selectionStart===input.selectionEnd){input.select();}});}this._ifPopup(function(){var popupCloseProxy=function popupCloseProxy(e){return _this2.closeHandler(e);};addEvent(window,EVENT_CLICK_OUTSIDE,popupCloseProxy);addEvent(window,EVENT_TAB_MOVE,popupCloseProxy);onKey(events,dom,['Esc','Escape'],popupCloseProxy);var timeKeeper=function timeKeeper(e){_this2.__containedEvent=e.timeStamp;};addEvent(dom,EVENT_CLICK_OUTSIDE,timeKeeper);addEvent(dom,EVENT_TAB_MOVE,timeKeeper);addEvent(_this2._domCancel,'click',popupCloseProxy);});var onDoneProxy=function onDoneProxy(e){_this2._ifPopup(function(){return _this2.closeHandler(e);});if(_this2.onDone){_this2.onDone(_this2.colour);}};addEvent(this._domOkay,'click',onDoneProxy);onKey(events,dom,['Enter'],onDoneProxy);}},{key:'_setPosition',value:function _setPosition(){var parent=this.settings.parent,elm=this.domElement;if(parent!==elm.parentNode){parent.appendChild(elm);}this._ifPopup(function(popup){if(getComputedStyle(parent).position==='static'){parent.style.position='relative';}var cssClass=popup===true?'popup_right':'popup_'+popup;['popup_top','popup_bottom','popup_left','popup_right'].forEach(function(c){if(c===cssClass){elm.classList.add(c);}else{elm.classList.remove(c);}});elm.classList.add(cssClass);});}},{key:'_setHSLA',value:function _setHSLA(h,s,l,a,flags){flags=flags||{};var col=this.colour,hsla=col.hsla;[h,s,l,a].forEach(function(x,i){if(x||x===0){hsla[i]=x;}});col.hsla=hsla;this._updateUI(flags);if(this.onChange&&!flags.silent){this.onChange(col);}}},{key:'_updateUI',value:function _updateUI(flags){if(!this.domElement){return;}flags=flags||{};var col=this.colour,hsl=col.hsla,cssHue='hsl('+hsl[0]*HUES+', 100%, 50%)',cssHSL=col.hslString,cssHSLA=col.hslaString;var uiH=this._domH,uiSL=this._domSL,uiA=this._domA,thumbH=$('.picker_selector',uiH),thumbSL=$('.picker_selector',uiSL),thumbA=$('.picker_selector',uiA);function posX(parent,child,relX){child.style.left=relX*100+'%';}function posY(parent,child,relY){child.style.top=relY*100+'%';}posX(uiH,thumbH,hsl[0]);this._domSL.style.backgroundColor=this._domH.style.color=cssHue;posX(uiSL,thumbSL,hsl[1]);posY(uiSL,thumbSL,1-hsl[2]);uiSL.style.color=cssHSL;posY(uiA,thumbA,1-hsl[3]);var opaque=cssHSL,transp=opaque.replace('hsl','hsla').replace(')',', 0)'),bg='linear-gradient('+[opaque,transp]+')';this._domA.style.background=bg+', '+BG_TRANSP;if(!flags.fromEditor){var format=this.settings.editorFormat,alpha=this.settings.alpha;var value=void 0;switch(format){case'rgb':value=col.printRGB(alpha);break;case'hsl':value=col.printHSL(alpha);break;default:value=col.printHex(alpha);}this._domEdit.value=value;}this._domSample.style.color=cssHSLA;}},{key:'_ifPopup',value:function _ifPopup(actionIf,actionElse){if(this.settings.parent&&this.settings.popup){actionIf&&actionIf(this.settings.popup);}else{actionElse&&actionElse();}}},{key:'_toggleDOM',value:function _toggleDOM(toVisible){var dom=this.domElement;if(!dom){return false;}var displayStyle=toVisible?'':'none',toggle=dom.style.display!==displayStyle;if(toggle){dom.style.display=displayStyle;}return toggle;}}]);return Picker;}();{var style=document.createElement('style');style.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}';document.documentElement.firstElementChild.appendChild(style);Picker.StyleElement=style;}var vanillaPicker=/*#__PURE__*/Object.freeze({__proto__:null,'default':Picker});var compileJSONPointer=immutableJSONPatch.exports.compileJSONPointer;exports.compileJSONPointer=compileJSONPointer;var compileJSONPointerProp=immutableJSONPatch.exports.compileJSONPointerProp;exports.compileJSONPointerProp=compileJSONPointerProp;var deleteIn=immutableJSONPatch.exports.deleteIn;exports.deleteIn=deleteIn;var existsIn=immutableJSONPatch.exports.existsIn;exports.existsIn=existsIn;var getIn=immutableJSONPatch.exports.getIn;exports.getIn=getIn;var immutableJSONPatch$1=immutableJSONPatch.exports.immutableJSONPatch;exports.immutableJSONPatch=immutableJSONPatch$1;var insertAt=immutableJSONPatch.exports.insertAt;exports.insertAt=insertAt;var parseFrom=immutableJSONPatch.exports.parseFrom;exports.parseFrom=parseFrom;var parseJSONPointer=immutableJSONPatch.exports.parseJSONPointer;exports.parseJSONPointer=parseJSONPointer;var parsePath=immutableJSONPatch.exports.parsePath;exports.parsePath=parsePath;var revertJSONPatch=immutableJSONPatch.exports.revertJSONPatch;exports.revertJSONPatch=revertJSONPatch;var setIn=immutableJSONPatch.exports.setIn;exports.setIn=setIn;var updateIn=immutableJSONPatch.exports.updateIn;exports.updateIn=updateIn;

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":1}]},{},[2])(2)
});
